"use strict";var Web5Dids=(()=>{var tx=Object.create;var Ua=Object.defineProperty;var rx=Object.getOwnPropertyDescriptor;var nx=Object.getOwnPropertyNames;var ix=Object.getPrototypeOf,ox=Object.prototype.hasOwnProperty;var N=(r,e)=>()=>(e||r((e={exports:{}}).exports,e),e.exports),is=(r,e)=>{for(var t in e)Ua(r,t,{get:e[t],enumerable:!0})},np=(r,e,t,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of nx(e))!ox.call(r,i)&&i!==t&&Ua(r,i,{get:()=>e[i],enumerable:!(n=rx(e,i))||n.enumerable});return r};var l=(r,e,t)=>(t=r!=null?tx(ix(r)):{},np(e||!r||!r.__esModule?Ua(t,"default",{value:r,enumerable:!0}):t,r)),sx=r=>np(Ua({},"__esModule",{value:!0}),r);var sp=N(Ca=>{"use strict";var tB=l(f());Ca.byteLength=cx;Ca.toByteArray=dx;Ca.fromByteArray=hx;var mr=[],Vt=[],ax=typeof Uint8Array<"u"?Uint8Array:Array,Wu="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(Qn=0,ip=Wu.length;Qn<ip;++Qn)mr[Qn]=Wu[Qn],Vt[Wu.charCodeAt(Qn)]=Qn;var Qn,ip;Vt[45]=62;Vt[95]=63;function op(r){var e=r.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var t=r.indexOf("=");t===-1&&(t=e);var n=t===e?0:4-t%4;return[t,n]}function cx(r){var e=op(r),t=e[0],n=e[1];return(t+n)*3/4-n}function ux(r,e,t){return(e+t)*3/4-t}function dx(r){var e,t=op(r),n=t[0],i=t[1],o=new ax(ux(r,n,i)),s=0,a=i>0?n-4:n,c;for(c=0;c<a;c+=4)e=Vt[r.charCodeAt(c)]<<18|Vt[r.charCodeAt(c+1)]<<12|Vt[r.charCodeAt(c+2)]<<6|Vt[r.charCodeAt(c+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=Vt[r.charCodeAt(c)]<<2|Vt[r.charCodeAt(c+1)]>>4,o[s++]=e&255),i===1&&(e=Vt[r.charCodeAt(c)]<<10|Vt[r.charCodeAt(c+1)]<<4|Vt[r.charCodeAt(c+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function lx(r){return mr[r>>18&63]+mr[r>>12&63]+mr[r>>6&63]+mr[r&63]}function fx(r,e,t){for(var n,i=[],o=e;o<t;o+=3)n=(r[o]<<16&16711680)+(r[o+1]<<8&65280)+(r[o+2]&255),i.push(lx(n));return i.join("")}function hx(r){for(var e,t=r.length,n=t%3,i=[],o=16383,s=0,a=t-n;s<a;s+=o)i.push(fx(r,s,s+o>a?a:s+o));return n===1?(e=r[t-1],i.push(mr[e>>2]+mr[e<<4&63]+"==")):n===2&&(e=(r[t-2]<<8)+r[t-1],i.push(mr[e>>10]+mr[e>>4&63]+mr[e<<2&63]+"=")),i.join("")}});var ap=N(zu=>{var nB=l(f());zu.read=function(r,e,t,n,i){var o,s,a=i*8-n-1,c=(1<<a)-1,d=c>>1,u=-7,h=t?i-1:0,m=t?-1:1,w=r[e+h];for(h+=m,o=w&(1<<-u)-1,w>>=-u,u+=a;u>0;o=o*256+r[e+h],h+=m,u-=8);for(s=o&(1<<-u)-1,o>>=-u,u+=n;u>0;s=s*256+r[e+h],h+=m,u-=8);if(o===0)o=1-d;else{if(o===c)return s?NaN:(w?-1:1)*(1/0);s=s+Math.pow(2,n),o=o-d}return(w?-1:1)*s*Math.pow(2,o-n)};zu.write=function(r,e,t,n,i,o){var s,a,c,d=o*8-i-1,u=(1<<d)-1,h=u>>1,m=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,w=n?0:o-1,p=n?1:-1,b=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=u):(s=Math.floor(Math.log(e)/Math.LN2),e*(c=Math.pow(2,-s))<1&&(s--,c*=2),s+h>=1?e+=m/c:e+=m*Math.pow(2,1-h),e*c>=2&&(s++,c/=2),s+h>=u?(a=0,s=u):s+h>=1?(a=(e*c-1)*Math.pow(2,i),s=s+h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;r[t+w]=a&255,w+=p,a/=256,i-=8);for(s=s<<i|a,d+=i;d>0;r[t+w]=s&255,w+=p,s/=256,d-=8);r[t+w-p]|=b*128}});var xt=N(Qi=>{"use strict";var sB=l(f());var Gu=sp(),Xi=ap(),cp=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Qi.Buffer=T;Qi.SlowBuffer=bx;Qi.INSPECT_MAX_BYTES=50;var ka=2147483647;Qi.kMaxLength=ka;T.TYPED_ARRAY_SUPPORT=px();!T.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function px(){try{let r=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(r,e),r.foo()===42}catch{return!1}}Object.defineProperty(T.prototype,"parent",{enumerable:!0,get:function(){if(T.isBuffer(this))return this.buffer}});Object.defineProperty(T.prototype,"offset",{enumerable:!0,get:function(){if(T.isBuffer(this))return this.byteOffset}});function Hr(r){if(r>ka)throw new RangeError('The value "'+r+'" is invalid for option "size"');let e=new Uint8Array(r);return Object.setPrototypeOf(e,T.prototype),e}function T(r,e,t){if(typeof r=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return Zu(r)}return fp(r,e,t)}T.poolSize=8192;function fp(r,e,t){if(typeof r=="string")return mx(r,e);if(ArrayBuffer.isView(r))return gx(r);if(r==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r);if(gr(r,ArrayBuffer)||r&&gr(r.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(gr(r,SharedArrayBuffer)||r&&gr(r.buffer,SharedArrayBuffer)))return Yu(r,e,t);if(typeof r=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=r.valueOf&&r.valueOf();if(n!=null&&n!==r)return T.from(n,e,t);let i=wx(r);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof r[Symbol.toPrimitive]=="function")return T.from(r[Symbol.toPrimitive]("string"),e,t);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof r)}T.from=function(r,e,t){return fp(r,e,t)};Object.setPrototypeOf(T.prototype,Uint8Array.prototype);Object.setPrototypeOf(T,Uint8Array);function hp(r){if(typeof r!="number")throw new TypeError('"size" argument must be of type number');if(r<0)throw new RangeError('The value "'+r+'" is invalid for option "size"')}function yx(r,e,t){return hp(r),r<=0?Hr(r):e!==void 0?typeof t=="string"?Hr(r).fill(e,t):Hr(r).fill(e):Hr(r)}T.alloc=function(r,e,t){return yx(r,e,t)};function Zu(r){return hp(r),Hr(r<0?0:Qu(r)|0)}T.allocUnsafe=function(r){return Zu(r)};T.allocUnsafeSlow=function(r){return Zu(r)};function mx(r,e){if((typeof e!="string"||e==="")&&(e="utf8"),!T.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let t=pp(r,e)|0,n=Hr(t),i=n.write(r,e);return i!==t&&(n=n.slice(0,i)),n}function Ju(r){let e=r.length<0?0:Qu(r.length)|0,t=Hr(e);for(let n=0;n<e;n+=1)t[n]=r[n]&255;return t}function gx(r){if(gr(r,Uint8Array)){let e=new Uint8Array(r);return Yu(e.buffer,e.byteOffset,e.byteLength)}return Ju(r)}function Yu(r,e,t){if(e<0||r.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(r.byteLength<e+(t||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&t===void 0?n=new Uint8Array(r):t===void 0?n=new Uint8Array(r,e):n=new Uint8Array(r,e,t),Object.setPrototypeOf(n,T.prototype),n}function wx(r){if(T.isBuffer(r)){let e=Qu(r.length)|0,t=Hr(e);return t.length===0||r.copy(t,0,0,e),t}if(r.length!==void 0)return typeof r.length!="number"||td(r.length)?Hr(0):Ju(r);if(r.type==="Buffer"&&Array.isArray(r.data))return Ju(r.data)}function Qu(r){if(r>=ka)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+ka.toString(16)+" bytes");return r|0}function bx(r){return+r!=r&&(r=0),T.alloc(+r)}T.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==T.prototype};T.compare=function(e,t){if(gr(e,Uint8Array)&&(e=T.from(e,e.offset,e.byteLength)),gr(t,Uint8Array)&&(t=T.from(t,t.offset,t.byteLength)),!T.isBuffer(e)||!T.isBuffer(t))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===t)return 0;let n=e.length,i=t.length;for(let o=0,s=Math.min(n,i);o<s;++o)if(e[o]!==t[o]){n=e[o],i=t[o];break}return n<i?-1:i<n?1:0};T.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};T.concat=function(e,t){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return T.alloc(0);let n;if(t===void 0)for(t=0,n=0;n<e.length;++n)t+=e[n].length;let i=T.allocUnsafe(t),o=0;for(n=0;n<e.length;++n){let s=e[n];if(gr(s,Uint8Array))o+s.length>i.length?(T.isBuffer(s)||(s=T.from(s)),s.copy(i,o)):Uint8Array.prototype.set.call(i,s,o);else if(T.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};function pp(r,e){if(T.isBuffer(r))return r.length;if(ArrayBuffer.isView(r)||gr(r,ArrayBuffer))return r.byteLength;if(typeof r!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof r);let t=r.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&t===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return t;case"utf8":case"utf-8":return Xu(r).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return t*2;case"hex":return t>>>1;case"base64":return Sp(r).length;default:if(i)return n?-1:Xu(r).length;e=(""+e).toLowerCase(),i=!0}}T.byteLength=pp;function xx(r,e,t){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((t===void 0||t>this.length)&&(t=this.length),t<=0)||(t>>>=0,e>>>=0,t<=e))return"";for(r||(r="utf8");;)switch(r){case"hex":return Rx(this,e,t);case"utf8":case"utf-8":return mp(this,e,t);case"ascii":return Dx(this,e,t);case"latin1":case"binary":return Bx(this,e,t);case"base64":return Tx(this,e,t);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Ox(this,e,t);default:if(n)throw new TypeError("Unknown encoding: "+r);r=(r+"").toLowerCase(),n=!0}}T.prototype._isBuffer=!0;function ei(r,e,t){let n=r[e];r[e]=r[t],r[t]=n}T.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let t=0;t<e;t+=2)ei(this,t,t+1);return this};T.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let t=0;t<e;t+=4)ei(this,t,t+3),ei(this,t+1,t+2);return this};T.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let t=0;t<e;t+=8)ei(this,t,t+7),ei(this,t+1,t+6),ei(this,t+2,t+5),ei(this,t+3,t+4);return this};T.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?mp(this,0,e):xx.apply(this,arguments)};T.prototype.toLocaleString=T.prototype.toString;T.prototype.equals=function(e){if(!T.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:T.compare(this,e)===0};T.prototype.inspect=function(){let e="",t=Qi.INSPECT_MAX_BYTES;return e=this.toString("hex",0,t).replace(/(.{2})/g,"$1 ").trim(),this.length>t&&(e+=" ... "),"<Buffer "+e+">"};cp&&(T.prototype[cp]=T.prototype.inspect);T.prototype.compare=function(e,t,n,i,o){if(gr(e,Uint8Array)&&(e=T.from(e,e.offset,e.byteLength)),!T.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(t===void 0&&(t=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),t<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&t>=n)return 0;if(i>=o)return-1;if(t>=n)return 1;if(t>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;let s=o-i,a=n-t,c=Math.min(s,a),d=this.slice(i,o),u=e.slice(t,n);for(let h=0;h<c;++h)if(d[h]!==u[h]){s=d[h],a=u[h];break}return s<a?-1:a<s?1:0};function yp(r,e,t,n,i){if(r.length===0)return-1;if(typeof t=="string"?(n=t,t=0):t>2147483647?t=2147483647:t<-2147483648&&(t=-2147483648),t=+t,td(t)&&(t=i?0:r.length-1),t<0&&(t=r.length+t),t>=r.length){if(i)return-1;t=r.length-1}else if(t<0)if(i)t=0;else return-1;if(typeof e=="string"&&(e=T.from(e,n)),T.isBuffer(e))return e.length===0?-1:up(r,e,t,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(r,e,t):Uint8Array.prototype.lastIndexOf.call(r,e,t):up(r,[e],t,n,i);throw new TypeError("val must be string, number or Buffer")}function up(r,e,t,n,i){let o=1,s=r.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(r.length<2||e.length<2)return-1;o=2,s/=2,a/=2,t/=2}function c(u,h){return o===1?u[h]:u.readUInt16BE(h*o)}let d;if(i){let u=-1;for(d=t;d<s;d++)if(c(r,d)===c(e,u===-1?0:d-u)){if(u===-1&&(u=d),d-u+1===a)return u*o}else u!==-1&&(d-=d-u),u=-1}else for(t+a>s&&(t=s-a),d=t;d>=0;d--){let u=!0;for(let h=0;h<a;h++)if(c(r,d+h)!==c(e,h)){u=!1;break}if(u)return d}return-1}T.prototype.includes=function(e,t,n){return this.indexOf(e,t,n)!==-1};T.prototype.indexOf=function(e,t,n){return yp(this,e,t,n,!0)};T.prototype.lastIndexOf=function(e,t,n){return yp(this,e,t,n,!1)};function Ex(r,e,t,n){t=Number(t)||0;let i=r.length-t;n?(n=Number(n),n>i&&(n=i)):n=i;let o=e.length;n>o/2&&(n=o/2);let s;for(s=0;s<n;++s){let a=parseInt(e.substr(s*2,2),16);if(td(a))return s;r[t+s]=a}return s}function vx(r,e,t,n){return Pa(Xu(e,r.length-t),r,t,n)}function Sx(r,e,t,n){return Pa(Px(e),r,t,n)}function Ax(r,e,t,n){return Pa(Sp(e),r,t,n)}function _x(r,e,t,n){return Pa(Kx(e,r.length-t),r,t,n)}T.prototype.write=function(e,t,n,i){if(t===void 0)i="utf8",n=this.length,t=0;else if(n===void 0&&typeof t=="string")i=t,n=this.length,t=0;else if(isFinite(t))t=t>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-t;if((n===void 0||n>o)&&(n=o),e.length>0&&(n<0||t<0)||t>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return Ex(this,e,t,n);case"utf8":case"utf-8":return vx(this,e,t,n);case"ascii":case"latin1":case"binary":return Sx(this,e,t,n);case"base64":return Ax(this,e,t,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return _x(this,e,t,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};T.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function Tx(r,e,t){return e===0&&t===r.length?Gu.fromByteArray(r):Gu.fromByteArray(r.slice(e,t))}function mp(r,e,t){t=Math.min(r.length,t);let n=[],i=e;for(;i<t;){let o=r[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=t){let c,d,u,h;switch(a){case 1:o<128&&(s=o);break;case 2:c=r[i+1],(c&192)===128&&(h=(o&31)<<6|c&63,h>127&&(s=h));break;case 3:c=r[i+1],d=r[i+2],(c&192)===128&&(d&192)===128&&(h=(o&15)<<12|(c&63)<<6|d&63,h>2047&&(h<55296||h>57343)&&(s=h));break;case 4:c=r[i+1],d=r[i+2],u=r[i+3],(c&192)===128&&(d&192)===128&&(u&192)===128&&(h=(o&15)<<18|(c&63)<<12|(d&63)<<6|u&63,h>65535&&h<1114112&&(s=h))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=a}return Ix(n)}var dp=4096;function Ix(r){let e=r.length;if(e<=dp)return String.fromCharCode.apply(String,r);let t="",n=0;for(;n<e;)t+=String.fromCharCode.apply(String,r.slice(n,n+=dp));return t}function Dx(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]&127);return n}function Bx(r,e,t){let n="";t=Math.min(r.length,t);for(let i=e;i<t;++i)n+=String.fromCharCode(r[i]);return n}function Rx(r,e,t){let n=r.length;(!e||e<0)&&(e=0),(!t||t<0||t>n)&&(t=n);let i="";for(let o=e;o<t;++o)i+=Lx[r[o]];return i}function Ox(r,e,t){let n=r.slice(e,t),i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}T.prototype.slice=function(e,t){let n=this.length;e=~~e,t=t===void 0?n:~~t,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),t<0?(t+=n,t<0&&(t=0)):t>n&&(t=n),t<e&&(t=e);let i=this.subarray(e,t);return Object.setPrototypeOf(i,T.prototype),i};function et(r,e,t){if(r%1!==0||r<0)throw new RangeError("offset is not uint");if(r+e>t)throw new RangeError("Trying to access beyond buffer length")}T.prototype.readUintLE=T.prototype.readUIntLE=function(e,t,n){e=e>>>0,t=t>>>0,n||et(e,t,this.length);let i=this[e],o=1,s=0;for(;++s<t&&(o*=256);)i+=this[e+s]*o;return i};T.prototype.readUintBE=T.prototype.readUIntBE=function(e,t,n){e=e>>>0,t=t>>>0,n||et(e,t,this.length);let i=this[e+--t],o=1;for(;t>0&&(o*=256);)i+=this[e+--t]*o;return i};T.prototype.readUint8=T.prototype.readUInt8=function(e,t){return e=e>>>0,t||et(e,1,this.length),this[e]};T.prototype.readUint16LE=T.prototype.readUInt16LE=function(e,t){return e=e>>>0,t||et(e,2,this.length),this[e]|this[e+1]<<8};T.prototype.readUint16BE=T.prototype.readUInt16BE=function(e,t){return e=e>>>0,t||et(e,2,this.length),this[e]<<8|this[e+1]};T.prototype.readUint32LE=T.prototype.readUInt32LE=function(e,t){return e=e>>>0,t||et(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};T.prototype.readUint32BE=T.prototype.readUInt32BE=function(e,t){return e=e>>>0,t||et(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};T.prototype.readBigUInt64LE=En(function(e){e=e>>>0,Zi(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&os(e,this.length-8);let i=t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,o=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))});T.prototype.readBigUInt64BE=En(function(e){e=e>>>0,Zi(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&os(e,this.length-8);let i=t*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],o=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(o)});T.prototype.readIntLE=function(e,t,n){e=e>>>0,t=t>>>0,n||et(e,t,this.length);let i=this[e],o=1,s=0;for(;++s<t&&(o*=256);)i+=this[e+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*t)),i};T.prototype.readIntBE=function(e,t,n){e=e>>>0,t=t>>>0,n||et(e,t,this.length);let i=t,o=1,s=this[e+--i];for(;i>0&&(o*=256);)s+=this[e+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*t)),s};T.prototype.readInt8=function(e,t){return e=e>>>0,t||et(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};T.prototype.readInt16LE=function(e,t){e=e>>>0,t||et(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};T.prototype.readInt16BE=function(e,t){e=e>>>0,t||et(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};T.prototype.readInt32LE=function(e,t){return e=e>>>0,t||et(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};T.prototype.readInt32BE=function(e,t){return e=e>>>0,t||et(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};T.prototype.readBigInt64LE=En(function(e){e=e>>>0,Zi(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&os(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(t+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});T.prototype.readBigInt64BE=En(function(e){e=e>>>0,Zi(e,"offset");let t=this[e],n=this[e+7];(t===void 0||n===void 0)&&os(e,this.length-8);let i=(t<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});T.prototype.readFloatLE=function(e,t){return e=e>>>0,t||et(e,4,this.length),Xi.read(this,e,!0,23,4)};T.prototype.readFloatBE=function(e,t){return e=e>>>0,t||et(e,4,this.length),Xi.read(this,e,!1,23,4)};T.prototype.readDoubleLE=function(e,t){return e=e>>>0,t||et(e,8,this.length),Xi.read(this,e,!0,52,8)};T.prototype.readDoubleBE=function(e,t){return e=e>>>0,t||et(e,8,this.length),Xi.read(this,e,!1,52,8)};function bt(r,e,t,n,i,o){if(!T.isBuffer(r))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(t+n>r.length)throw new RangeError("Index out of range")}T.prototype.writeUintLE=T.prototype.writeUIntLE=function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;bt(this,e,t,n,a,0)}let o=1,s=0;for(this[t]=e&255;++s<n&&(o*=256);)this[t+s]=e/o&255;return t+n};T.prototype.writeUintBE=T.prototype.writeUIntBE=function(e,t,n,i){if(e=+e,t=t>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;bt(this,e,t,n,a,0)}let o=n-1,s=1;for(this[t+o]=e&255;--o>=0&&(s*=256);)this[t+o]=e/s&255;return t+n};T.prototype.writeUint8=T.prototype.writeUInt8=function(e,t,n){return e=+e,t=t>>>0,n||bt(this,e,t,1,255,0),this[t]=e&255,t+1};T.prototype.writeUint16LE=T.prototype.writeUInt16LE=function(e,t,n){return e=+e,t=t>>>0,n||bt(this,e,t,2,65535,0),this[t]=e&255,this[t+1]=e>>>8,t+2};T.prototype.writeUint16BE=T.prototype.writeUInt16BE=function(e,t,n){return e=+e,t=t>>>0,n||bt(this,e,t,2,65535,0),this[t]=e>>>8,this[t+1]=e&255,t+2};T.prototype.writeUint32LE=T.prototype.writeUInt32LE=function(e,t,n){return e=+e,t=t>>>0,n||bt(this,e,t,4,4294967295,0),this[t+3]=e>>>24,this[t+2]=e>>>16,this[t+1]=e>>>8,this[t]=e&255,t+4};T.prototype.writeUint32BE=T.prototype.writeUInt32BE=function(e,t,n){return e=+e,t=t>>>0,n||bt(this,e,t,4,4294967295,0),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};function gp(r,e,t,n,i){vp(e,n,i,r,t,7);let o=Number(e&BigInt(4294967295));r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o,o=o>>8,r[t++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,s=s>>8,r[t++]=s,t}function wp(r,e,t,n,i){vp(e,n,i,r,t,7);let o=Number(e&BigInt(4294967295));r[t+7]=o,o=o>>8,r[t+6]=o,o=o>>8,r[t+5]=o,o=o>>8,r[t+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return r[t+3]=s,s=s>>8,r[t+2]=s,s=s>>8,r[t+1]=s,s=s>>8,r[t]=s,t+8}T.prototype.writeBigUInt64LE=En(function(e,t=0){return gp(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});T.prototype.writeBigUInt64BE=En(function(e,t=0){return wp(this,e,t,BigInt(0),BigInt("0xffffffffffffffff"))});T.prototype.writeIntLE=function(e,t,n,i){if(e=+e,t=t>>>0,!i){let c=Math.pow(2,8*n-1);bt(this,e,t,n,c-1,-c)}let o=0,s=1,a=0;for(this[t]=e&255;++o<n&&(s*=256);)e<0&&a===0&&this[t+o-1]!==0&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n};T.prototype.writeIntBE=function(e,t,n,i){if(e=+e,t=t>>>0,!i){let c=Math.pow(2,8*n-1);bt(this,e,t,n,c-1,-c)}let o=n-1,s=1,a=0;for(this[t+o]=e&255;--o>=0&&(s*=256);)e<0&&a===0&&this[t+o+1]!==0&&(a=1),this[t+o]=(e/s>>0)-a&255;return t+n};T.prototype.writeInt8=function(e,t,n){return e=+e,t=t>>>0,n||bt(this,e,t,1,127,-128),e<0&&(e=255+e+1),this[t]=e&255,t+1};T.prototype.writeInt16LE=function(e,t,n){return e=+e,t=t>>>0,n||bt(this,e,t,2,32767,-32768),this[t]=e&255,this[t+1]=e>>>8,t+2};T.prototype.writeInt16BE=function(e,t,n){return e=+e,t=t>>>0,n||bt(this,e,t,2,32767,-32768),this[t]=e>>>8,this[t+1]=e&255,t+2};T.prototype.writeInt32LE=function(e,t,n){return e=+e,t=t>>>0,n||bt(this,e,t,4,2147483647,-2147483648),this[t]=e&255,this[t+1]=e>>>8,this[t+2]=e>>>16,this[t+3]=e>>>24,t+4};T.prototype.writeInt32BE=function(e,t,n){return e=+e,t=t>>>0,n||bt(this,e,t,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[t]=e>>>24,this[t+1]=e>>>16,this[t+2]=e>>>8,this[t+3]=e&255,t+4};T.prototype.writeBigInt64LE=En(function(e,t=0){return gp(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});T.prototype.writeBigInt64BE=En(function(e,t=0){return wp(this,e,t,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function bp(r,e,t,n,i,o){if(t+n>r.length)throw new RangeError("Index out of range");if(t<0)throw new RangeError("Index out of range")}function xp(r,e,t,n,i){return e=+e,t=t>>>0,i||bp(r,e,t,4,34028234663852886e22,-34028234663852886e22),Xi.write(r,e,t,n,23,4),t+4}T.prototype.writeFloatLE=function(e,t,n){return xp(this,e,t,!0,n)};T.prototype.writeFloatBE=function(e,t,n){return xp(this,e,t,!1,n)};function Ep(r,e,t,n,i){return e=+e,t=t>>>0,i||bp(r,e,t,8,17976931348623157e292,-17976931348623157e292),Xi.write(r,e,t,n,52,8),t+8}T.prototype.writeDoubleLE=function(e,t,n){return Ep(this,e,t,!0,n)};T.prototype.writeDoubleBE=function(e,t,n){return Ep(this,e,t,!1,n)};T.prototype.copy=function(e,t,n,i){if(!T.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),t>=e.length&&(t=e.length),t||(t=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(t<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-t<i-n&&(i=e.length-t+n);let o=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(t,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),t),o};T.prototype.fill=function(e,t,n,i){if(typeof e=="string"){if(typeof t=="string"?(i=t,t=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!T.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let s=e.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(t<0||this.length<t||this.length<n)throw new RangeError("Out of range index");if(n<=t)return this;t=t>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let o;if(typeof e=="number")for(o=t;o<n;++o)this[o]=e;else{let s=T.isBuffer(e)?e:T.from(e,i),a=s.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-t;++o)this[o+t]=s[o%a]}return this};var Yi={};function ed(r,e,t){Yi[r]=class extends t{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${r}]`,this.stack,delete this.name}get code(){return r}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${r}]: ${this.message}`}}}ed("ERR_BUFFER_OUT_OF_BOUNDS",function(r){return r?`${r} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);ed("ERR_INVALID_ARG_TYPE",function(r,e){return`The "${r}" argument must be of type number. Received type ${typeof e}`},TypeError);ed("ERR_OUT_OF_RANGE",function(r,e,t){let n=`The value of "${r}" is out of range.`,i=t;return Number.isInteger(t)&&Math.abs(t)>2**32?i=lp(String(t)):typeof t=="bigint"&&(i=String(t),(t>BigInt(2)**BigInt(32)||t<-(BigInt(2)**BigInt(32)))&&(i=lp(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function lp(r){let e="",t=r.length,n=r[0]==="-"?1:0;for(;t>=n+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function Ux(r,e,t){Zi(e,"offset"),(r[e]===void 0||r[e+t]===void 0)&&os(e,r.length-(t+1))}function vp(r,e,t,n,i,o){if(r>t||r<e){let s=typeof e=="bigint"?"n":"",a;throw o>3?e===0||e===BigInt(0)?a=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:a=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:a=`>= ${e}${s} and <= ${t}${s}`,new Yi.ERR_OUT_OF_RANGE("value",a,r)}Ux(n,i,o)}function Zi(r,e){if(typeof r!="number")throw new Yi.ERR_INVALID_ARG_TYPE(e,"number",r)}function os(r,e,t){throw Math.floor(r)!==r?(Zi(r,t),new Yi.ERR_OUT_OF_RANGE(t||"offset","an integer",r)):e<0?new Yi.ERR_BUFFER_OUT_OF_BOUNDS:new Yi.ERR_OUT_OF_RANGE(t||"offset",`>= ${t?1:0} and <= ${e}`,r)}var Cx=/[^+/0-9A-Za-z-_]/g;function kx(r){if(r=r.split("=")[0],r=r.trim().replace(Cx,""),r.length<2)return"";for(;r.length%4!==0;)r=r+"=";return r}function Xu(r,e){e=e||1/0;let t,n=r.length,i=null,o=[];for(let s=0;s<n;++s){if(t=r.charCodeAt(s),t>55295&&t<57344){if(!i){if(t>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=t;continue}if(t<56320){(e-=3)>-1&&o.push(239,191,189),i=t;continue}t=(i-55296<<10|t-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,t<128){if((e-=1)<0)break;o.push(t)}else if(t<2048){if((e-=2)<0)break;o.push(t>>6|192,t&63|128)}else if(t<65536){if((e-=3)<0)break;o.push(t>>12|224,t>>6&63|128,t&63|128)}else if(t<1114112){if((e-=4)<0)break;o.push(t>>18|240,t>>12&63|128,t>>6&63|128,t&63|128)}else throw new Error("Invalid code point")}return o}function Px(r){let e=[];for(let t=0;t<r.length;++t)e.push(r.charCodeAt(t)&255);return e}function Kx(r,e){let t,n,i,o=[];for(let s=0;s<r.length&&!((e-=2)<0);++s)t=r.charCodeAt(s),n=t>>8,i=t%256,o.push(i),o.push(n);return o}function Sp(r){return Gu.toByteArray(kx(r))}function Pa(r,e,t,n){let i;for(i=0;i<n&&!(i+t>=e.length||i>=r.length);++i)e[i+t]=r[i];return i}function gr(r,e){return r instanceof e||r!=null&&r.constructor!=null&&r.constructor.name!=null&&r.constructor.name===e.name}function td(r){return r!==r}var Lx=function(){let r="0123456789abcdef",e=new Array(256);for(let t=0;t<16;++t){let n=t*16;for(let i=0;i<16;++i)e[n+i]=r[t]+r[i]}return e}();function En(r){return typeof BigInt>"u"?Mx:r}function Mx(){throw new Error("BigInt not supported")}});var f=N(()=>{"use strict";var Ap=xt().Buffer,{Buffer:Nx}=xt();Ap.prototype.writeBigUInt64BE=Nx.prototype.writeBigUInt64BE;globalThis.Buffer=Ap});var id=N((gB,_p)=>{var wB=l(f()),$x=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,Ka=()=>$x.now(),qx=r=>r&&r===Math.floor(r)&&r>0&&isFinite(r),rd=r=>r===1/0||qx(r),nd=class r{constructor({max:e=1/0,ttl:t,updateAgeOnGet:n=!1,checkAgeOnGet:i=!1,noUpdateTTL:o=!1,dispose:s,noDisposeOnSet:a=!1}={}){if(this.expirations=Object.create(null),this.data=new Map,this.expirationMap=new Map,t!==void 0&&!rd(t))throw new TypeError("ttl must be positive integer or Infinity if set");if(!rd(e))throw new TypeError("max must be positive integer or Infinity");if(this.ttl=t,this.max=e,this.updateAgeOnGet=!!n,this.checkAgeOnGet=!!i,this.noUpdateTTL=!!o,this.noDisposeOnSet=!!a,s!==void 0){if(typeof s!="function")throw new TypeError("dispose must be function if set");this.dispose=s}this.timer=void 0,this.timerExpiration=void 0}setTimer(e,t){if(this.timerExpiration<e)return;this.timer&&clearTimeout(this.timer);let n=setTimeout(()=>{this.timer=void 0,this.timerExpiration=void 0,this.purgeStale();for(let i in this.expirations){this.setTimer(i,i-Ka());break}},t);n.unref&&n.unref(),this.timerExpiration=e,this.timer=n}cancelTimer(){this.timer&&(clearTimeout(this.timer),this.timerExpiration=void 0,this.timer=void 0)}cancelTimers(){return process.emitWarning('TTLCache.cancelTimers has been renamed to TTLCache.cancelTimer (no "s"), and will be removed in the next major version update'),this.cancelTimer()}clear(){let e=this.dispose!==r.prototype.dispose?[...this]:[];this.data.clear(),this.expirationMap.clear(),this.cancelTimer(),this.expirations=Object.create(null);for(let[t,n]of e)this.dispose(n,t,"delete")}setTTL(e,t=this.ttl){let n=this.expirationMap.get(e);if(n!==void 0){let i=this.expirations[n];!i||i.length<=1?delete this.expirations[n]:this.expirations[n]=i.filter(o=>o!==e)}if(t!==1/0){let i=Math.floor(Ka()+t);this.expirationMap.set(e,i),this.expirations[i]||(this.expirations[i]=[],this.setTimer(i,t)),this.expirations[i].push(e)}else this.expirationMap.set(e,1/0)}set(e,t,{ttl:n=this.ttl,noUpdateTTL:i=this.noUpdateTTL,noDisposeOnSet:o=this.noDisposeOnSet}={}){if(!rd(n))throw new TypeError("ttl must be positive integer or Infinity");if(this.expirationMap.has(e)){i||this.setTTL(e,n);let s=this.data.get(e);s!==t&&(this.data.set(e,t),o||this.dispose(s,e,"set"))}else this.setTTL(e,n),this.data.set(e,t);for(;this.size>this.max;)this.purgeToCapacity();return this}has(e){return this.data.has(e)}getRemainingTTL(e){let t=this.expirationMap.get(e);return t===1/0?t:t!==void 0?Math.max(0,Math.ceil(t-Ka())):0}get(e,{updateAgeOnGet:t=this.updateAgeOnGet,ttl:n=this.ttl,checkAgeOnGet:i=this.checkAgeOnGet}={}){let o=this.data.get(e);if(i&&this.getRemainingTTL(e)===0){this.delete(e);return}return t&&this.setTTL(e,n),o}dispose(e,t){}delete(e){let t=this.expirationMap.get(e);if(t!==void 0){let n=this.data.get(e);this.data.delete(e),this.expirationMap.delete(e);let i=this.expirations[t];return i&&(i.length<=1?delete this.expirations[t]:this.expirations[t]=i.filter(o=>o!==e)),this.dispose(n,e,"delete"),this.size===0&&this.cancelTimer(),!0}return!1}purgeToCapacity(){for(let e in this.expirations){let t=this.expirations[e];if(this.size-t.length>=this.max){delete this.expirations[e];let n=[];for(let i of t)n.push([i,this.data.get(i)]),this.data.delete(i),this.expirationMap.delete(i);for(let[i,o]of n)this.dispose(o,i,"evict")}else{let n=this.size-this.max,i=[];for(let o of t.splice(0,n))i.push([o,this.data.get(o)]),this.data.delete(o),this.expirationMap.delete(o);for(let[o,s]of i)this.dispose(s,o,"evict");return}}}get size(){return this.data.size}purgeStale(){let e=Math.ceil(Ka());for(let t in this.expirations){if(t==="Infinity"||t>e)return;let n=[...this.expirations[t]||[]],i=[];delete this.expirations[t];for(let o of n)i.push([o,this.data.get(o)]),this.data.delete(o),this.expirationMap.delete(o);for(let[o,s]of i)this.dispose(s,o,"stale")}this.size===0&&this.cancelTimer()}*entries(){for(let e in this.expirations)for(let t of this.expirations[e])yield[t,this.data.get(t)]}*keys(){for(let e in this.expirations)for(let t of this.expirations[e])yield t}*values(){for(let e in this.expirations)for(let t of this.expirations[e])yield this.data.get(t)}[Symbol.iterator](){return this.entries()}};_p.exports=nd});var Fp=N(qp=>{"use strict";var L8=l(f());qp.supports=function(...e){let t=e.reduce((n,i)=>Object.assign(n,i),{});return Object.assign(t,{snapshots:t.snapshots||!1,permanence:t.permanence||!1,seek:t.seek||!1,clear:t.clear||!1,getMany:t.getMany||!1,keyIterator:t.keyIterator||!1,valueIterator:t.valueIterator||!1,iteratorNextv:t.iteratorNextv||!1,iteratorAll:t.iteratorAll||!1,status:t.status||!1,createIfMissing:t.createIfMissing||!1,errorIfExists:t.errorIfExists||!1,deferredOpen:t.deferredOpen||!1,promises:t.promises||!1,streams:t.streams||!1,encodings:Object.assign({},t.encodings),events:Object.assign({},t.events),additionalMethods:Object.assign({},t.additionalMethods)})}});var tr=N((N8,Vp)=>{"use strict";var $8=l(f());Vp.exports=class extends Error{constructor(e,t){super(e||""),typeof t=="object"&&t!==null&&(t.code&&(this.code=String(t.code)),t.expected&&(this.expected=!0),t.transient&&(this.transient=!0),t.cause&&(this.cause=t.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}});var wd=N((q8,Hp)=>{"use strict";var F8=l(f()),gd=null;Hp.exports=function(){return gd===null&&(gd={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),gd}});var Ed=N(jp=>{"use strict";var H8=l(f()),bd=tr(),bE=new Set(["buffer","view","utf8"]),xd=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!bE.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new bd(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new bd(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new bd(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};jp.Encoding=xd});var _d=N(Na=>{"use strict";var W8=l(f()),{Buffer:Sd}=xt()||{},{Encoding:Ad}=Ed(),xE=wd(),ds=class extends Ad{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new ls({encode:this.encode,decode:e=>this.decode(Sd.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},ls=class extends Ad{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new ds({encode:e=>{let t=this.encode(e);return Sd.from(t.buffer,t.byteOffset,t.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},vd=class extends Ad{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new ds({encode:e=>Sd.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){let{textEncoder:e,textDecoder:t}=xE();return new ls({encode:n=>e.encode(this.encode(n)),decode:n=>this.decode(t.decode(n)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};Na.BufferFormat=ds;Na.ViewFormat=ls;Na.UTF8Format=vd});var Jp=N(oi=>{"use strict";var G8=l(f()),{Buffer:ut}=xt()||{Buffer:{isBuffer:()=>!1}},{textEncoder:zp,textDecoder:Wp}=wd()(),{BufferFormat:fs,ViewFormat:Td,UTF8Format:Gp}=_d(),$a=r=>r;oi.utf8=new Gp({encode:function(r){return ut.isBuffer(r)?r.toString("utf8"):ArrayBuffer.isView(r)?Wp.decode(r):String(r)},decode:$a,name:"utf8",createViewTranscoder(){return new Td({encode:function(r){return ArrayBuffer.isView(r)?r:zp.encode(r)},decode:function(r){return Wp.decode(r)},name:`${this.name}+view`})},createBufferTranscoder(){return new fs({encode:function(r){return ut.isBuffer(r)?r:ArrayBuffer.isView(r)?ut.from(r.buffer,r.byteOffset,r.byteLength):ut.from(String(r),"utf8")},decode:function(r){return r.toString("utf8")},name:`${this.name}+buffer`})}});oi.json=new Gp({encode:JSON.stringify,decode:JSON.parse,name:"json"});oi.buffer=new fs({encode:function(r){return ut.isBuffer(r)?r:ArrayBuffer.isView(r)?ut.from(r.buffer,r.byteOffset,r.byteLength):ut.from(String(r),"utf8")},decode:$a,name:"buffer",createViewTranscoder(){return new Td({encode:function(r){return ArrayBuffer.isView(r)?r:ut.from(String(r),"utf8")},decode:function(r){return ut.from(r.buffer,r.byteOffset,r.byteLength)},name:`${this.name}+view`})}});oi.view=new Td({encode:function(r){return ArrayBuffer.isView(r)?r:zp.encode(r)},decode:$a,name:"view",createBufferTranscoder(){return new fs({encode:function(r){return ut.isBuffer(r)?r:ArrayBuffer.isView(r)?ut.from(r.buffer,r.byteOffset,r.byteLength):ut.from(String(r),"utf8")},decode:$a,name:`${this.name}+buffer`})}});oi.hex=new fs({encode:function(r){return ut.isBuffer(r)?r:ut.from(String(r),"hex")},decode:function(r){return r.toString("hex")},name:"hex"});oi.base64=new fs({encode:function(r){return ut.isBuffer(r)?r:ut.from(String(r),"base64")},decode:function(r){return r.toString("base64")},name:"base64"})});var Zp=N(Xp=>{"use strict";var Y8=l(f()),Yp=tr(),Fa=Jp(),{Encoding:EE}=Ed(),{BufferFormat:vE,ViewFormat:SE,UTF8Format:AE}=_d(),hs=Symbol("formats"),qa=Symbol("encodings"),_E=new Set(["buffer","view","utf8"]),Id=class{constructor(e){if(Array.isArray(e)){if(!e.every(t=>_E.has(t)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[qa]=new Map,this[hs]=new Set(e);for(let t in Fa)try{this.encoding(t)}catch(n){if(n.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw n}}encodings(){return Array.from(new Set(this[qa].values()))}encoding(e){let t=this[qa].get(e);if(t===void 0){if(typeof e=="string"&&e!==""){if(t=BE[e],!t)throw new Yp(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof e!="object"||e===null)throw new TypeError("First argument 'encoding' must be a string or object");t=TE(e)}let{name:n,format:i}=t;if(!this[hs].has(i))if(this[hs].has("view"))t=t.createViewTranscoder();else if(this[hs].has("buffer"))t=t.createBufferTranscoder();else if(this[hs].has("utf8"))t=t.createUTF8Transcoder();else throw new Yp(`Encoding '${n}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(let o of[e,n,t.name,t.commonName])this[qa].set(o,t)}return t}};Xp.Transcoder=Id;function TE(r){if(r instanceof EE)return r;let e="type"in r&&typeof r.type=="string"?r.type:void 0,t=r.name||e||`anonymous-${RE++}`;switch(IE(r)){case"view":return new SE({...r,name:t});case"utf8":return new AE({...r,name:t});case"buffer":return new vE({...r,name:t});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function IE(r){return"format"in r&&r.format!==void 0?r.format:"buffer"in r&&typeof r.buffer=="boolean"?r.buffer?"buffer":"utf8":"code"in r&&Number.isInteger(r.code)?"view":"buffer"}var DE={binary:Fa.buffer,"utf-8":Fa.utf8},BE={...Fa,...DE},RE=0});var ps=N((X8,Dd)=>{"use strict";var Z8=l(f()),no=typeof Reflect=="object"?Reflect:null,Qp=no&&typeof no.apply=="function"?no.apply:function(e,t,n){return Function.prototype.apply.call(e,t,n)},Va;no&&typeof no.ownKeys=="function"?Va=no.ownKeys:Object.getOwnPropertySymbols?Va=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:Va=function(e){return Object.getOwnPropertyNames(e)};function OE(r){console&&console.warn&&console.warn(r)}var ty=Number.isNaN||function(e){return e!==e};function be(){be.init.call(this)}Dd.exports=be;Dd.exports.once=PE;be.EventEmitter=be;be.prototype._events=void 0;be.prototype._eventsCount=0;be.prototype._maxListeners=void 0;var ey=10;function Ha(r){if(typeof r!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof r)}Object.defineProperty(be,"defaultMaxListeners",{enumerable:!0,get:function(){return ey},set:function(r){if(typeof r!="number"||r<0||ty(r))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+r+".");ey=r}});be.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};be.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||ty(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function ry(r){return r._maxListeners===void 0?be.defaultMaxListeners:r._maxListeners}be.prototype.getMaxListeners=function(){return ry(this)};be.prototype.emit=function(e){for(var t=[],n=1;n<arguments.length;n++)t.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(t.length>0&&(s=t[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var c=o[e];if(c===void 0)return!1;if(typeof c=="function")Qp(c,this,t);else for(var d=c.length,u=ay(c,d),n=0;n<d;++n)Qp(u[n],this,t);return!0};function ny(r,e,t,n){var i,o,s;if(Ha(t),o=r._events,o===void 0?(o=r._events=Object.create(null),r._eventsCount=0):(o.newListener!==void 0&&(r.emit("newListener",e,t.listener?t.listener:t),o=r._events),s=o[e]),s===void 0)s=o[e]=t,++r._eventsCount;else if(typeof s=="function"?s=o[e]=n?[t,s]:[s,t]:n?s.unshift(t):s.push(t),i=ry(r),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=r,a.type=e,a.count=s.length,OE(a)}return r}be.prototype.addListener=function(e,t){return ny(this,e,t,!1)};be.prototype.on=be.prototype.addListener;be.prototype.prependListener=function(e,t){return ny(this,e,t,!0)};function UE(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function iy(r,e,t){var n={fired:!1,wrapFn:void 0,target:r,type:e,listener:t},i=UE.bind(n);return i.listener=t,n.wrapFn=i,i}be.prototype.once=function(e,t){return Ha(t),this.on(e,iy(this,e,t)),this};be.prototype.prependOnceListener=function(e,t){return Ha(t),this.prependListener(e,iy(this,e,t)),this};be.prototype.removeListener=function(e,t){var n,i,o,s,a;if(Ha(t),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===t||n.listener===t)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===t||n[s].listener===t){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():CE(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||t)}return this};be.prototype.off=be.prototype.removeListener;be.prototype.removeAllListeners=function(e){var t,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(t=n[e],typeof t=="function")this.removeListener(e,t);else if(t!==void 0)for(i=t.length-1;i>=0;i--)this.removeListener(e,t[i]);return this};function oy(r,e,t){var n=r._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?t?[i.listener||i]:[i]:t?kE(i):ay(i,i.length)}be.prototype.listeners=function(e){return oy(this,e,!0)};be.prototype.rawListeners=function(e){return oy(this,e,!1)};be.listenerCount=function(r,e){return typeof r.listenerCount=="function"?r.listenerCount(e):sy.call(r,e)};be.prototype.listenerCount=sy;function sy(r){var e=this._events;if(e!==void 0){var t=e[r];if(typeof t=="function")return 1;if(t!==void 0)return t.length}return 0}be.prototype.eventNames=function(){return this._eventsCount>0?Va(this._events):[]};function ay(r,e){for(var t=new Array(e),n=0;n<e;++n)t[n]=r[n];return t}function CE(r,e){for(;e+1<r.length;e++)r[e]=r[e+1];r.pop()}function kE(r){for(var e=new Array(r.length),t=0;t<e.length;++t)e[t]=r[t].listener||r[t];return e}function PE(r,e){return new Promise(function(t,n){function i(s){r.removeListener(e,o),n(s)}function o(){typeof r.removeListener=="function"&&r.removeListener("error",i),t([].slice.call(arguments))}cy(r,e,o,{once:!0}),e!=="error"&&KE(r,i,{once:!0})})}function KE(r,e,t){typeof r.on=="function"&&cy(r,"error",e,t)}function cy(r,e,t,n){if(typeof r.on=="function")n.once?r.once(e,t):r.on(e,t);else if(typeof r.addEventListener=="function")r.addEventListener(e,function i(o){n.once&&r.removeEventListener(e,i),t(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof r)}});var dy=N((Q8,uy)=>{var eR=l(f());uy.exports=typeof queueMicrotask=="function"?queueMicrotask:r=>Promise.resolve().then(r)});var ys=N(Bd=>{"use strict";var rR=l(f()),ly=dy();Bd.fromCallback=function(r,e){if(r===void 0){var t=new Promise(function(n,i){r=function(o,s){o?i(o):n(s)}});r[e!==void 0?e:"promise"]=t}else if(typeof r!="function")throw new TypeError("Callback must be a function");return r};Bd.fromPromise=function(r,e){if(e===void 0)return r;r.then(function(t){ly(()=>e(null,t))}).catch(function(t){ly(()=>e(t))})}});var ja=N(Rd=>{"use strict";var iR=l(f());Rd.getCallback=function(r,e){return typeof r=="function"?r:e};Rd.getOptions=function(r,e){return typeof r=="object"&&r!==null?r:e!==void 0?e:{}}});var In=N(Ja=>{"use strict";var sR=l(f()),{fromCallback:Od}=ys(),Ot=tr(),{getOptions:Ud,getCallback:fy}=ja(),si=Symbol("promise"),io=Symbol("callback"),xr=Symbol("working"),ai=Symbol("handleOne"),zr=Symbol("handleMany"),Cd=Symbol("autoClose"),_n=Symbol("finishWork"),Er=Symbol("returnMany"),vn=Symbol("closing"),ms=Symbol("handleClose"),Wa=Symbol("closed"),gs=Symbol("closeCallbacks"),An=Symbol("keyEncoding"),ci=Symbol("valueEncoding"),kd=Symbol("abortOnClose"),za=Symbol("legacy"),Pd=Symbol("keys"),Kd=Symbol("values"),Sn=Symbol("limit"),Ht=Symbol("count"),Ga=Object.freeze({}),LE=()=>{},hy=!1,ws=class{constructor(e,t,n){if(typeof e!="object"||e===null){let i=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${i}`)}if(typeof t!="object"||t===null)throw new TypeError("The second argument must be an options object");this[Wa]=!1,this[gs]=[],this[xr]=!1,this[vn]=!1,this[Cd]=!1,this[io]=null,this[ai]=this[ai].bind(this),this[zr]=this[zr].bind(this),this[ms]=this[ms].bind(this),this[An]=t[An],this[ci]=t[ci],this[za]=n,this[Sn]=Number.isInteger(t.limit)&&t.limit>=0?t.limit:1/0,this[Ht]=0,this[kd]=!!t.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[Ht]}get limit(){return this[Sn]}next(e){let t;if(e===void 0)t=new Promise((n,i)=>{e=(o,s,a)=>{o?i(o):this[za]?s===void 0&&a===void 0?n():n([s,a]):n(s)}});else if(typeof e!="function")throw new TypeError("Callback must be a function");return this[vn]?this.nextTick(e,new Ot("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[xr]?this.nextTick(e,new Ot("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[xr]=!0,this[io]=e,this[Ht]>=this[Sn]?this.nextTick(this[ai],null):this._next(this[ai])),t}_next(e){this.nextTick(e)}nextv(e,t,n){return n=fy(t,n),n=Od(n,si),t=Ud(t,Ga),Number.isInteger(e)?(this[vn]?this.nextTick(n,new Ot("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[xr]?this.nextTick(n,new Ot("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[Sn]<1/0&&(e=Math.min(e,this[Sn]-this[Ht])),this[xr]=!0,this[io]=n,e<=0?this.nextTick(this[zr],null,[]):this._nextv(e,t,this[zr])),n[si]):(this.nextTick(n,new TypeError("The first argument 'size' must be an integer")),n[si])}_nextv(e,t,n){let i=[],o=(s,a,c)=>{if(s)return n(s);if(this[za]?a===void 0&&c===void 0:a===void 0)return n(null,i);i.push(this[za]?[a,c]:a),i.length===e?n(null,i):this._next(o)};this._next(o)}all(e,t){return t=fy(e,t),t=Od(t,si),e=Ud(e,Ga),this[vn]?this.nextTick(t,new Ot("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[xr]?this.nextTick(t,new Ot("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[xr]=!0,this[io]=t,this[Cd]=!0,this[Ht]>=this[Sn]?this.nextTick(this[zr],null,[]):this._all(e,this[zr])),t[si]}_all(e,t){let n=this[Ht],i=[],o=()=>{let a=this[Sn]<1/0?Math.min(1e3,this[Sn]-n):1e3;a<=0?this.nextTick(t,null,i):this._nextv(a,Ga,s)},s=(a,c)=>{a?t(a):c.length===0?t(null,i):(i.push.apply(i,c),n+=c.length,o())};o()}[_n](){let e=this[io];return this[kd]&&e===null?LE:(this[xr]=!1,this[io]=null,this[vn]&&this._close(this[ms]),e)}[Er](e,t,n){this[Cd]?this.close(e.bind(null,t,n)):e(t,n)}seek(e,t){if(t=Ud(t,Ga),!this[vn]){if(this[xr])throw new Ot("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{let n=this.db.keyEncoding(t.keyEncoding||this[An]),i=n.format;t.keyEncoding!==i&&(t={...t,keyEncoding:i});let o=this.db.prefixKey(n.encode(e),i);this._seek(o,t)}}}_seek(e,t){throw new Ot("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){return e=Od(e,si),this[Wa]?this.nextTick(e):this[vn]?this[gs].push(e):(this[vn]=!0,this[gs].push(e),this[xr]?this[kd]&&this[_n]()(new Ot("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[ms])),e[si]}_close(e){this.nextTick(e)}[ms](){this[Wa]=!0,this.db.detachResource(this);let e=this[gs];this[gs]=[];for(let t of e)t()}async*[Symbol.asyncIterator](){try{let e;for(;(e=await this.next())!==void 0;)yield e}finally{this[Wa]||await this.close()}}},oo=class extends ws{constructor(e,t){super(e,t,!0),this[Pd]=t.keys!==!1,this[Kd]=t.values!==!1}[ai](e,t,n){let i=this[_n]();if(e)return i(e);try{t=this[Pd]&&t!==void 0?this[An].decode(t):void 0,n=this[Kd]&&n!==void 0?this[ci].decode(n):void 0}catch(o){return i(new Tn("entry",o))}t===void 0&&n===void 0||this[Ht]++,i(null,t,n)}[zr](e,t){let n=this[_n]();if(e)return this[Er](n,e);try{for(let i of t){let o=i[0],s=i[1];i[0]=this[Pd]&&o!==void 0?this[An].decode(o):void 0,i[1]=this[Kd]&&s!==void 0?this[ci].decode(s):void 0}}catch(i){return this[Er](n,new Tn("entries",i))}this[Ht]+=t.length,this[Er](n,null,t)}end(e){return!hy&&typeof console<"u"&&(hy=!0,console.warn(new Ot("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}},Ld=class extends ws{constructor(e,t){super(e,t,!1)}[ai](e,t){let n=this[_n]();if(e)return n(e);try{t=t!==void 0?this[An].decode(t):void 0}catch(i){return n(new Tn("key",i))}t!==void 0&&this[Ht]++,n(null,t)}[zr](e,t){let n=this[_n]();if(e)return this[Er](n,e);try{for(let i=0;i<t.length;i++){let o=t[i];t[i]=o!==void 0?this[An].decode(o):void 0}}catch(i){return this[Er](n,new Tn("keys",i))}this[Ht]+=t.length,this[Er](n,null,t)}},Md=class extends ws{constructor(e,t){super(e,t,!1)}[ai](e,t){let n=this[_n]();if(e)return n(e);try{t=t!==void 0?this[ci].decode(t):void 0}catch(i){return n(new Tn("value",i))}t!==void 0&&this[Ht]++,n(null,t)}[zr](e,t){let n=this[_n]();if(e)return this[Er](n,e);try{for(let i=0;i<t.length;i++){let o=t[i];t[i]=o!==void 0?this[ci].decode(o):void 0}}catch(i){return this[Er](n,new Tn("values",i))}this[Ht]+=t.length,this[Er](n,null,t)}},Tn=class extends Ot{constructor(e,t){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:t})}};for(let r of["_ended property","_nexting property","_end method"])Object.defineProperty(oo.prototype,r.split(" ")[0],{get(){throw new Ot(`The ${r} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new Ot(`The ${r} has been removed`,{code:"LEVEL_LEGACY"})}});oo.keyEncoding=An;oo.valueEncoding=ci;Ja.AbstractIterator=oo;Ja.AbstractKeyIterator=Ld;Ja.AbstractValueIterator=Md});var py=N(Nd=>{"use strict";var cR=l(f()),{AbstractKeyIterator:ME,AbstractValueIterator:NE}=In(),ui=Symbol("iterator"),bs=Symbol("callback"),so=Symbol("handleOne"),di=Symbol("handleMany"),xs=class extends ME{constructor(e,t){super(e,t),this[ui]=e.iterator({...t,keys:!0,values:!1}),this[so]=this[so].bind(this),this[di]=this[di].bind(this)}},Ya=class extends NE{constructor(e,t){super(e,t),this[ui]=e.iterator({...t,keys:!1,values:!0}),this[so]=this[so].bind(this),this[di]=this[di].bind(this)}};for(let r of[xs,Ya]){let e=r===xs,t=e?n=>n[0]:n=>n[1];r.prototype._next=function(n){this[bs]=n,this[ui].next(this[so])},r.prototype[so]=function(n,i,o){let s=this[bs];n?s(n):s(null,e?i:o)},r.prototype._nextv=function(n,i,o){this[bs]=o,this[ui].nextv(n,i,this[di])},r.prototype._all=function(n,i){this[bs]=i,this[ui].all(n,this[di])},r.prototype[di]=function(n,i){let o=this[bs];n?o(n):o(null,i.map(t))},r.prototype._seek=function(n,i){this[ui].seek(n,i)},r.prototype._close=function(n){this[ui].close(n)}}Nd.DefaultKeyIterator=xs;Nd.DefaultValueIterator=Ya});var yy=N(rc=>{"use strict";var dR=l(f()),{AbstractIterator:$E,AbstractKeyIterator:qE,AbstractValueIterator:FE}=In(),$d=tr(),vt=Symbol("nut"),ec=Symbol("undefer"),tc=Symbol("factory"),Xa=class extends $E{constructor(e,t){super(e,t),this[vt]=null,this[tc]=()=>e.iterator(t),this.db.defer(()=>this[ec]())}},Za=class extends qE{constructor(e,t){super(e,t),this[vt]=null,this[tc]=()=>e.keys(t),this.db.defer(()=>this[ec]())}},Qa=class extends FE{constructor(e,t){super(e,t),this[vt]=null,this[tc]=()=>e.values(t),this.db.defer(()=>this[ec]())}};for(let r of[Xa,Za,Qa])r.prototype[ec]=function(){this.db.status==="open"&&(this[vt]=this[tc]())},r.prototype._next=function(e){this[vt]!==null?this[vt].next(e):this.db.status==="opening"?this.db.defer(()=>this._next(e)):this.nextTick(e,new $d("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},r.prototype._nextv=function(e,t,n){this[vt]!==null?this[vt].nextv(e,t,n):this.db.status==="opening"?this.db.defer(()=>this._nextv(e,t,n)):this.nextTick(n,new $d("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},r.prototype._all=function(e,t){this[vt]!==null?this[vt].all(t):this.db.status==="opening"?this.db.defer(()=>this._all(e,t)):this.nextTick(t,new $d("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},r.prototype._seek=function(e,t){this[vt]!==null?this[vt]._seek(e,t):this.db.status==="opening"&&this.db.defer(()=>this._seek(e,t))},r.prototype._close=function(e){this[vt]!==null?this[vt].close(e):this.db.status==="opening"?this.db.defer(()=>this._close(e)):this.nextTick(e)};rc.DeferredIterator=Xa;rc.DeferredKeyIterator=Za;rc.DeferredValueIterator=Qa});var Fd=N(gy=>{"use strict";var fR=l(f()),{fromCallback:my}=ys(),nc=tr(),{getCallback:VE,getOptions:HE}=ja(),ic=Symbol("promise"),jt=Symbol("status"),ao=Symbol("operations"),Es=Symbol("finishClose"),co=Symbol("closeCallbacks"),qd=class{constructor(e){if(typeof e!="object"||e===null){let t=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${t}`)}this[ao]=[],this[co]=[],this[jt]="open",this[Es]=this[Es].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[ao].length}put(e,t,n){if(this[jt]!=="open")throw new nc("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});let i=this.db._checkKey(e)||this.db._checkValue(t);if(i)throw i;let o=n&&n.sublevel!=null?n.sublevel:this.db,s=n,a=o.keyEncoding(n&&n.keyEncoding),c=o.valueEncoding(n&&n.valueEncoding),d=a.format;n={...n,keyEncoding:d,valueEncoding:c.format},o!==this.db&&(n.sublevel=null);let u=o.prefixKey(a.encode(e),d),h=c.encode(t);return this._put(u,h,n),this[ao].push({...s,type:"put",key:e,value:t}),this}_put(e,t,n){}del(e,t){if(this[jt]!=="open")throw new nc("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});let n=this.db._checkKey(e);if(n)throw n;let i=t&&t.sublevel!=null?t.sublevel:this.db,o=t,s=i.keyEncoding(t&&t.keyEncoding),a=s.format;return t={...t,keyEncoding:a},i!==this.db&&(t.sublevel=null),this._del(i.prefixKey(s.encode(e),a),t),this[ao].push({...o,type:"del",key:e}),this}_del(e,t){}clear(){if(this[jt]!=="open")throw new nc("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[ao]=[],this}_clear(){}write(e,t){return t=VE(e,t),t=my(t,ic),e=HE(e),this[jt]!=="open"?this.nextTick(t,new nc("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(t):(this[jt]="writing",this._write(e,n=>{this[jt]="closing",this[co].push(()=>t(n)),n||this.db.emit("batch",this[ao]),this._close(this[Es])})),t[ic]}_write(e,t){}close(e){return e=my(e,ic),this[jt]==="closing"?this[co].push(e):this[jt]==="closed"?this.nextTick(e):(this[co].push(e),this[jt]!=="writing"&&(this[jt]="closing",this._close(this[Es]))),e[ic]}_close(e){this.nextTick(e)}[Es](){this[jt]="closed",this.db.detachResource(this);let e=this[co];this[co]=[];for(let t of e)t()}};gy.AbstractChainedBatch=qd});var by=N(wy=>{"use strict";var pR=l(f()),{AbstractChainedBatch:jE}=Fd(),WE=tr(),uo=Symbol("encoded"),Vd=class extends jE{constructor(e){super(e),this[uo]=[]}_put(e,t,n){this[uo].push({...n,type:"put",key:e,value:t})}_del(e,t){this[uo].push({...t,type:"del",key:e})}_clear(){this[uo]=[]}_write(e,t){this.db.status==="opening"?this.db.defer(()=>this._write(e,t)):this.db.status==="open"?this[uo].length===0?this.nextTick(t):this.db._batch(this[uo],e,t):this.nextTick(t,new WE("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};wy.DefaultChainedBatch=Vd});var vy=N((yR,Ey)=>{"use strict";var mR=l(f()),xy=tr(),zE=Object.prototype.hasOwnProperty,GE=new Set(["lt","lte","gt","gte"]);Ey.exports=function(r,e){let t={};for(let n in r)if(zE.call(r,n)&&!(n==="keyEncoding"||n==="valueEncoding")){if(n==="start"||n==="end")throw new xy(`The legacy range option '${n}' has been removed`,{code:"LEVEL_LEGACY"});if(n==="encoding")throw new xy("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});GE.has(n)?t[n]=e.encode(r[n]):t[n]=r[n]}return t.reverse=!!t.reverse,t.limit=Number.isInteger(t.limit)&&t.limit>=0?t.limit:-1,t}});var Hd=N((gR,Ay)=>{var wR=l(f());var Sy;Ay.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:globalThis):r=>(Sy||(Sy=Promise.resolve())).then(r).catch(e=>setTimeout(()=>{throw e},0))});var Iy=N((bR,Ty)=>{"use strict";var xR=l(f()),_y=Hd();Ty.exports=function(r,...e){e.length===0?_y(r):_y(()=>r(...e))}});var Dy=N(oc=>{"use strict";var vR=l(f()),{AbstractIterator:JE,AbstractKeyIterator:YE,AbstractValueIterator:XE}=In(),lo=Symbol("unfix"),rr=Symbol("iterator"),li=Symbol("handleOne"),Dn=Symbol("handleMany"),Gr=Symbol("callback"),vs=class extends JE{constructor(e,t,n,i){super(e,t),this[rr]=n,this[lo]=i,this[li]=this[li].bind(this),this[Dn]=this[Dn].bind(this),this[Gr]=null}[li](e,t,n){let i=this[Gr];if(e)return i(e);t!==void 0&&(t=this[lo](t)),i(e,t,n)}[Dn](e,t){let n=this[Gr];if(e)return n(e);for(let i of t){let o=i[0];o!==void 0&&(i[0]=this[lo](o))}n(e,t)}},Ss=class extends YE{constructor(e,t,n,i){super(e,t),this[rr]=n,this[lo]=i,this[li]=this[li].bind(this),this[Dn]=this[Dn].bind(this),this[Gr]=null}[li](e,t){let n=this[Gr];if(e)return n(e);t!==void 0&&(t=this[lo](t)),n(e,t)}[Dn](e,t){let n=this[Gr];if(e)return n(e);for(let i=0;i<t.length;i++){let o=t[i];o!==void 0&&(t[i]=this[lo](o))}n(e,t)}},As=class extends XE{constructor(e,t,n){super(e,t),this[rr]=n}};for(let r of[vs,Ss])r.prototype._next=function(e){this[Gr]=e,this[rr].next(this[li])},r.prototype._nextv=function(e,t,n){this[Gr]=n,this[rr].nextv(e,t,this[Dn])},r.prototype._all=function(e,t){this[Gr]=t,this[rr].all(e,this[Dn])};for(let r of[As])r.prototype._next=function(e){this[rr].next(e)},r.prototype._nextv=function(e,t,n){this[rr].nextv(e,t,n)},r.prototype._all=function(e,t){this[rr].all(e,t)};for(let r of[vs,Ss,As])r.prototype._seek=function(e,t){this[rr].seek(e,t)},r.prototype._close=function(e){this[rr].close(e)};oc.AbstractSublevelIterator=vs;oc.AbstractSublevelKeyIterator=Ss;oc.AbstractSublevelValueIterator=As});var Uy=N((SR,Oy)=>{"use strict";var AR=l(f()),jd=tr(),{Buffer:Gd}=xt()||{},{AbstractSublevelIterator:ZE,AbstractSublevelKeyIterator:QE,AbstractSublevelValueIterator:ev}=Dy(),Jr=Symbol("prefix"),By=Symbol("upperBound"),_s=Symbol("prefixRange"),Ut=Symbol("parent"),Wd=Symbol("unfix"),Ry=new TextEncoder,tv={separator:"!"};Oy.exports=function({AbstractLevel:r}){class e extends r{static defaults(n){if(typeof n=="string")throw new jd("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(n&&n.open)throw new jd("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return n==null?tv:n.separator?n:{...n,separator:"!"}}constructor(n,i,o){let{separator:s,manifest:a,...c}=e.defaults(o);i=nv(i,s);let d=s.charCodeAt(0)+1,u=n[Ut]||n;if(!Ry.encode(i).every(w=>w>d&&w<127))throw new jd(`Prefix must use bytes > ${d} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(rv(u,a),c);let h=(n.prefix||"")+s+i+s,m=h.slice(0,-1)+String.fromCharCode(d);this[Ut]=u,this[Jr]=new sc(h),this[By]=new sc(m),this[Wd]=new Jd,this.nextTick=u.nextTick}prefixKey(n,i){if(i==="utf8")return this[Jr].utf8+n;if(n.byteLength===0)return this[Jr][i];if(i==="view"){let o=this[Jr].view,s=new Uint8Array(o.byteLength+n.byteLength);return s.set(o,0),s.set(n,o.byteLength),s}else{let o=this[Jr].buffer;return Gd.concat([o,n],o.byteLength+n.byteLength)}}[_s](n,i){n.gte!==void 0?n.gte=this.prefixKey(n.gte,i):n.gt!==void 0?n.gt=this.prefixKey(n.gt,i):n.gte=this[Jr][i],n.lte!==void 0?n.lte=this.prefixKey(n.lte,i):n.lt!==void 0?n.lt=this.prefixKey(n.lt,i):n.lte=this[By][i]}get prefix(){return this[Jr].utf8}get db(){return this[Ut]}_open(n,i){this[Ut].open({passive:!0},i)}_put(n,i,o,s){this[Ut].put(n,i,o,s)}_get(n,i,o){this[Ut].get(n,i,o)}_getMany(n,i,o){this[Ut].getMany(n,i,o)}_del(n,i,o){this[Ut].del(n,i,o)}_batch(n,i,o){this[Ut].batch(n,i,o)}_clear(n,i){this[_s](n,n.keyEncoding),this[Ut].clear(n,i)}_iterator(n){this[_s](n,n.keyEncoding);let i=this[Ut].iterator(n),o=this[Wd].get(this[Jr].utf8.length,n.keyEncoding);return new ZE(this,n,i,o)}_keys(n){this[_s](n,n.keyEncoding);let i=this[Ut].keys(n),o=this[Wd].get(this[Jr].utf8.length,n.keyEncoding);return new QE(this,n,i,o)}_values(n){this[_s](n,n.keyEncoding);let i=this[Ut].values(n);return new ev(this,n,i)}}return{AbstractSublevel:e}};var rv=function(r,e){return{...r.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...e,encodings:{utf8:zd(r,"utf8"),buffer:zd(r,"buffer"),view:zd(r,"view")}}},zd=function(r,e){return r.supports.encodings[e]?r.keyEncoding(e).name===e:!1},sc=class{constructor(e){this.utf8=e,this.view=Ry.encode(e),this.buffer=Gd?Gd.from(this.view.buffer,0,this.view.byteLength):{}}},Jd=class{constructor(){this.cache=new Map}get(e,t){let n=this.cache.get(t);return n===void 0&&(t==="view"?n=(function(i,o){return o.subarray(i)}).bind(null,e):n=(function(i,o){return o.slice(i)}).bind(null,e),this.cache.set(t,n)),n}},nv=function(r,e){let t=0,n=r.length;for(;t<n&&r[t]===e;)t++;for(;n>t&&r[n-1]===e;)n--;return r.slice(t,n)}});var el=N(Qd=>{"use strict";var TR=l(f()),{supports:iv}=Fp(),{Transcoder:ov}=Zp(),{EventEmitter:sv}=ps(),{fromCallback:Bn}=ys(),nr=tr(),{AbstractIterator:fi}=In(),{DefaultKeyIterator:av,DefaultValueIterator:cv}=py(),{DeferredIterator:uv,DeferredKeyIterator:dv,DeferredValueIterator:lv}=yy(),{DefaultChainedBatch:Cy}=by(),{getCallback:hi,getOptions:Rn}=ja(),ac=vy(),ae=Symbol("promise"),Yr=Symbol("landed"),pi=Symbol("resources"),Yd=Symbol("closeResources"),Ts=Symbol("operations"),Is=Symbol("undefer"),cc=Symbol("deferOpen"),ky=Symbol("options"),ue=Symbol("status"),yi=Symbol("defaultOptions"),fo=Symbol("transcoder"),uc=Symbol("keyEncoding"),Xd=Symbol("valueEncoding"),fv=()=>{},Ds=class extends sv{constructor(e,t){if(super(),typeof e!="object"||e===null)throw new TypeError("The first argument 'manifest' must be an object");t=Rn(t);let{keyEncoding:n,valueEncoding:i,passive:o,...s}=t;this[pi]=new Set,this[Ts]=[],this[cc]=!0,this[ky]=s,this[ue]="opening",this.supports=iv(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:e.snapshots!==!1,permanence:e.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[fo]=new ov(hv(this)),this[uc]=this[fo].encoding(n||"utf8"),this[Xd]=this[fo].encoding(i||"utf8");for(let a of this[fo].encodings())this.supports.encodings[a.commonName]||(this.supports.encodings[a.commonName]=!0);this[yi]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[uc].commonName,valueEncoding:this[Xd].commonName}),key:Object.freeze({keyEncoding:this[uc].commonName})},this.nextTick(()=>{this[cc]&&this.open({passive:!1},fv)})}get status(){return this[ue]}keyEncoding(e){return this[fo].encoding(e??this[uc])}valueEncoding(e){return this[fo].encoding(e??this[Xd])}open(e,t){t=hi(e,t),t=Bn(t,ae),e={...this[ky],...Rn(e)},e.createIfMissing=e.createIfMissing!==!1,e.errorIfExists=!!e.errorIfExists;let n=i=>{this[ue]==="closing"||this[ue]==="opening"?this.once(Yr,i?()=>n(i):n):this[ue]!=="open"?t(new nr("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:i})):t()};return e.passive?this[ue]==="opening"?this.once(Yr,n):this.nextTick(n):this[ue]==="closed"||this[cc]?(this[cc]=!1,this[ue]="opening",this.emit("opening"),this._open(e,i=>{if(i){this[ue]="closed",this[Yd](()=>{this.emit(Yr),n(i)}),this[Is]();return}this[ue]="open",this[Is](),this.emit(Yr),this[ue]==="open"&&this.emit("open"),this[ue]==="open"&&this.emit("ready"),n()})):this[ue]==="open"?this.nextTick(n):this.once(Yr,()=>this.open(e,t)),t[ae]}_open(e,t){this.nextTick(t)}close(e){e=Bn(e,ae);let t=n=>{this[ue]==="opening"||this[ue]==="closing"?this.once(Yr,n?t(n):t):this[ue]!=="closed"?e(new nr("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:n})):e()};if(this[ue]==="open"){this[ue]="closing",this.emit("closing");let n=i=>{this[ue]="open",this[Is](),this.emit(Yr),t(i)};this[Yd](()=>{this._close(i=>{if(i)return n(i);this[ue]="closed",this[Is](),this.emit(Yr),this[ue]==="closed"&&this.emit("closed"),t()})})}else this[ue]==="closed"?this.nextTick(t):this.once(Yr,()=>this.close(e));return e[ae]}[Yd](e){if(this[pi].size===0)return this.nextTick(e);let t=this[pi].size,n=!0,i=()=>{--t===0&&(n?this.nextTick(e):e())};for(let o of this[pi])o.close(i);n=!1,this[pi].clear()}_close(e){this.nextTick(e)}get(e,t,n){if(n=hi(t,n),n=Bn(n,ae),t=Rn(t,this[yi].entry),this[ue]==="opening")return this.defer(()=>this.get(e,t,n)),n[ae];if(ho(this,n))return n[ae];let i=this._checkKey(e);if(i)return this.nextTick(n,i),n[ae];let o=this.keyEncoding(t.keyEncoding),s=this.valueEncoding(t.valueEncoding),a=o.format,c=s.format;return(t.keyEncoding!==a||t.valueEncoding!==c)&&(t=Object.assign({},t,{keyEncoding:a,valueEncoding:c})),this._get(this.prefixKey(o.encode(e),a),t,(d,u)=>{if(d)return(d.code==="LEVEL_NOT_FOUND"||d.notFound||/NotFound/i.test(d))&&(d.code||(d.code="LEVEL_NOT_FOUND"),d.notFound||(d.notFound=!0),d.status||(d.status=404)),n(d);try{u=s.decode(u)}catch(h){return n(new nr("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:h}))}n(null,u)}),n[ae]}_get(e,t,n){this.nextTick(n,new Error("NotFound"))}getMany(e,t,n){if(n=hi(t,n),n=Bn(n,ae),t=Rn(t,this[yi].entry),this[ue]==="opening")return this.defer(()=>this.getMany(e,t,n)),n[ae];if(ho(this,n))return n[ae];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'keys' must be an array")),n[ae];if(e.length===0)return this.nextTick(n,null,[]),n[ae];let i=this.keyEncoding(t.keyEncoding),o=this.valueEncoding(t.valueEncoding),s=i.format,a=o.format;(t.keyEncoding!==s||t.valueEncoding!==a)&&(t=Object.assign({},t,{keyEncoding:s,valueEncoding:a}));let c=new Array(e.length);for(let d=0;d<e.length;d++){let u=e[d],h=this._checkKey(u);if(h)return this.nextTick(n,h),n[ae];c[d]=this.prefixKey(i.encode(u),s)}return this._getMany(c,t,(d,u)=>{if(d)return n(d);try{for(let h=0;h<u.length;h++)u[h]!==void 0&&(u[h]=o.decode(u[h]))}catch(h){return n(new nr(`Could not decode one or more of ${u.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:h}))}n(null,u)}),n[ae]}_getMany(e,t,n){this.nextTick(n,null,new Array(e.length).fill(void 0))}put(e,t,n,i){if(i=hi(n,i),i=Bn(i,ae),n=Rn(n,this[yi].entry),this[ue]==="opening")return this.defer(()=>this.put(e,t,n,i)),i[ae];if(ho(this,i))return i[ae];let o=this._checkKey(e)||this._checkValue(t);if(o)return this.nextTick(i,o),i[ae];let s=this.keyEncoding(n.keyEncoding),a=this.valueEncoding(n.valueEncoding),c=s.format,d=a.format;(n.keyEncoding!==c||n.valueEncoding!==d)&&(n=Object.assign({},n,{keyEncoding:c,valueEncoding:d}));let u=this.prefixKey(s.encode(e),c),h=a.encode(t);return this._put(u,h,n,m=>{if(m)return i(m);this.emit("put",e,t),i()}),i[ae]}_put(e,t,n,i){this.nextTick(i)}del(e,t,n){if(n=hi(t,n),n=Bn(n,ae),t=Rn(t,this[yi].key),this[ue]==="opening")return this.defer(()=>this.del(e,t,n)),n[ae];if(ho(this,n))return n[ae];let i=this._checkKey(e);if(i)return this.nextTick(n,i),n[ae];let o=this.keyEncoding(t.keyEncoding),s=o.format;return t.keyEncoding!==s&&(t=Object.assign({},t,{keyEncoding:s})),this._del(this.prefixKey(o.encode(e),s),t,a=>{if(a)return n(a);this.emit("del",e),n()}),n[ae]}_del(e,t,n){this.nextTick(n)}batch(e,t,n){if(!arguments.length){if(this[ue]==="opening")return new Cy(this);if(this[ue]!=="open")throw new nr("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof e=="function"?n=e:n=hi(t,n),n=Bn(n,ae),t=Rn(t,this[yi].empty),this[ue]==="opening")return this.defer(()=>this.batch(e,t,n)),n[ae];if(ho(this,n))return n[ae];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'operations' must be an array")),n[ae];if(e.length===0)return this.nextTick(n),n[ae];let i=new Array(e.length),{keyEncoding:o,valueEncoding:s,...a}=t;for(let c=0;c<e.length;c++){if(typeof e[c]!="object"||e[c]===null)return this.nextTick(n,new TypeError("A batch operation must be an object")),n[ae];let d=Object.assign({},e[c]);if(d.type!=="put"&&d.type!=="del")return this.nextTick(n,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),n[ae];let u=this._checkKey(d.key);if(u)return this.nextTick(n,u),n[ae];let h=d.sublevel!=null?d.sublevel:this,m=h.keyEncoding(d.keyEncoding||o),w=m.format;if(d.key=h.prefixKey(m.encode(d.key),w),d.keyEncoding=w,d.type==="put"){let p=this._checkValue(d.value);if(p)return this.nextTick(n,p),n[ae];let b=h.valueEncoding(d.valueEncoding||s);d.value=b.encode(d.value),d.valueEncoding=b.format}h!==this&&(d.sublevel=null),i[c]=d}return this._batch(i,a,c=>{if(c)return n(c);this.emit("batch",e),n()}),n[ae]}_batch(e,t,n){this.nextTick(n)}sublevel(e,t){return this._sublevel(e,Zd.defaults(t))}_sublevel(e,t){return new Zd(this,e,t)}prefixKey(e,t){return e}clear(e,t){if(t=hi(e,t),t=Bn(t,ae),e=Rn(e,this[yi].empty),this[ue]==="opening")return this.defer(()=>this.clear(e,t)),t[ae];if(ho(this,t))return t[ae];let n=e,i=this.keyEncoding(e.keyEncoding);return e=ac(e,i),e.keyEncoding=i.format,e.limit===0?this.nextTick(t):this._clear(e,o=>{if(o)return t(o);this.emit("clear",n),t()}),t[ae]}_clear(e,t){this.nextTick(t)}iterator(e){let t=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=ac(e,t),e.keys=e.keys!==!1,e.values=e.values!==!1,e[fi.keyEncoding]=t,e[fi.valueEncoding]=n,e.keyEncoding=t.format,e.valueEncoding=n.format,this[ue]==="opening")return new uv(this,e);if(this[ue]!=="open")throw new nr("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new fi(this,e)}keys(e){let t=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=ac(e,t),e[fi.keyEncoding]=t,e[fi.valueEncoding]=n,e.keyEncoding=t.format,e.valueEncoding=n.format,this[ue]==="opening")return new dv(this,e);if(this[ue]!=="open")throw new nr("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new av(this,e)}values(e){let t=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=ac(e,t),e[fi.keyEncoding]=t,e[fi.valueEncoding]=n,e.keyEncoding=t.format,e.valueEncoding=n.format,this[ue]==="opening")return new lv(this,e);if(this[ue]!=="open")throw new nr("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new cv(this,e)}defer(e){if(typeof e!="function")throw new TypeError("The first argument must be a function");this[Ts].push(e)}[Is](){if(this[Ts].length===0)return;let e=this[Ts];this[Ts]=[];for(let t of e)t()}attachResource(e){if(typeof e!="object"||e===null||typeof e.close!="function")throw new TypeError("The first argument must be a resource object");this[pi].add(e)}detachResource(e){this[pi].delete(e)}_chainedBatch(){return new Cy(this)}_checkKey(e){if(e==null)return new nr("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(e==null)return new nr("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};Ds.prototype.nextTick=Iy();var{AbstractSublevel:Zd}=Uy()({AbstractLevel:Ds});Qd.AbstractLevel=Ds;Qd.AbstractSublevel=Zd;var ho=function(r,e){return r[ue]!=="open"?(r.nextTick(e,new nr("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},hv=function(r){return Object.keys(r.supports.encodings).filter(e=>!!r.supports.encodings[e])}});var tl=N(mi=>{"use strict";var DR=l(f());mi.AbstractLevel=el().AbstractLevel;mi.AbstractSublevel=el().AbstractSublevel;mi.AbstractIterator=In().AbstractIterator;mi.AbstractKeyIterator=In().AbstractKeyIterator;mi.AbstractValueIterator=In().AbstractValueIterator;mi.AbstractChainedBatch=Fd().AbstractChainedBatch});var Ky=N((BR,Py)=>{var RR=l(f());Py.exports=yv;var pv=Hd();function yv(r,e,t){if(typeof e!="number")throw new Error("second argument must be a Number");let n,i,o,s,a,c=!0,d;Array.isArray(r)?(n=[],o=i=r.length):(s=Object.keys(r),n={},o=i=s.length);function u(m){function w(){t&&t(m,n),t=null}c?pv(w):w()}function h(m,w,p){if(n[m]=p,w&&(a=!0),--o===0||w)u(w);else if(!a&&d<i){let b;s?(b=s[d],d+=1,r[b](function(v,S){h(b,v,S)})):(b=d,d+=1,r[b](function(v,S){h(b,v,S)}))}}d=e,o?s?s.some(function(m,w){return r[m](function(p,b){h(m,p,b)}),w===e-1}):r.some(function(m,w){return m(function(p,b){h(w,p,b)}),w===e-1}):u(null),c=!1}});var rl=N((OR,Ly)=>{"use strict";var UR=l(f());Ly.exports=function(e){let t=e.gte!==void 0?e.gte:e.gt!==void 0?e.gt:void 0,n=e.lte!==void 0?e.lte:e.lt!==void 0?e.lt:void 0,i=e.gte===void 0,o=e.lte===void 0;return t!==void 0&&n!==void 0?IDBKeyRange.bound(t,n,i,o):t!==void 0?IDBKeyRange.lowerBound(t,i):n!==void 0?IDBKeyRange.upperBound(n,o):null}});var nl=N((CR,My)=>{"use strict";var kR=l(f()),mv=new TextEncoder;My.exports=function(r){return r instanceof Uint8Array?r:r instanceof ArrayBuffer?new Uint8Array(r):mv.encode(r)}});var Vy=N(Fy=>{"use strict";var KR=l(f()),{AbstractIterator:gv}=tl(),Ny=rl(),dc=nl(),vr=Symbol("cache"),Xr=Symbol("finished"),Ct=Symbol("options"),Zr=Symbol("currentOptions"),gi=Symbol("position"),il=Symbol("location"),po=Symbol("first"),$y={},ol=class extends gv{constructor(e,t,n){super(e,n),this[vr]=[],this[Xr]=this.limit===0,this[Ct]=n,this[Zr]={...n},this[gi]=void 0,this[il]=t,this[po]=!0}_nextv(e,t,n){if(this[po]=!1,this[Xr])return this.nextTick(n,null,[]);if(this[vr].length>0)return e=Math.min(e,this[vr].length),this.nextTick(n,null,this[vr].splice(0,e));this[gi]!==void 0&&(this[Ct].reverse?(this[Zr].lt=this[gi],this[Zr].lte=void 0):(this[Zr].gt=this[gi],this[Zr].gte=void 0));let i;try{i=Ny(this[Zr])}catch{return this[Xr]=!0,this.nextTick(n,null,[])}let o=this.db.db.transaction([this[il]],"readonly"),s=o.objectStore(this[il]),a=[];if(this[Ct].reverse){let c=!this[Ct].values&&s.openKeyCursor?"openKeyCursor":"openCursor";s[c](i,"prev").onsuccess=d=>{let u=d.target.result;if(u){let{key:h,value:m}=u;this[gi]=h,a.push([this[Ct].keys&&h!==void 0?dc(h):void 0,this[Ct].values&&m!==void 0?dc(m):void 0]),a.length<e?u.continue():qy(o)}else this[Xr]=!0}}else{let c,d,u=()=>{if(c===void 0||d===void 0)return;let h=Math.max(c.length,d.length);h===0||e===1/0?this[Xr]=!0:this[gi]=c[h-1],a.length=h;for(let m=0;m<h;m++){let w=c[m],p=d[m];a[m]=[this[Ct].keys&&w!==void 0?dc(w):void 0,this[Ct].values&&p!==void 0?dc(p):void 0]}qy(o)};this[Ct].keys||e<1/0?s.getAllKeys(i,e<1/0?e:void 0).onsuccess=h=>{c=h.target.result,u()}:(c=[],this.nextTick(u)),this[Ct].values?s.getAll(i,e<1/0?e:void 0).onsuccess=h=>{d=h.target.result,u()}:(d=[],this.nextTick(u))}o.onabort=()=>{n(o.error||new Error("aborted by user")),n=null},o.oncomplete=()=>{n(null,a),n=null}}_next(e){if(this[vr].length>0){let[t,n]=this[vr].shift();this.nextTick(e,null,t,n)}else if(this[Xr])this.nextTick(e);else{let t=Math.min(100,this.limit-this.count);this[po]&&(this[po]=!1,t=1),this._nextv(t,$y,(n,i)=>{if(n)return e(n);this[vr]=i,this._next(e)})}}_all(e,t){this[po]=!1;let n=this[vr].splice(0,this[vr].length),i=this.limit-this.count-n.length;if(i<=0)return this.nextTick(t,null,n);this._nextv(i,$y,(o,s)=>{if(o)return t(o);n.length>0&&(s=n.concat(s)),t(null,s)})}_seek(e,t){this[po]=!0,this[vr]=[],this[Xr]=!1,this[gi]=void 0,this[Zr]={...this[Ct]};let n;try{n=Ny(this[Ct])}catch{this[Xr]=!0;return}n!==null&&!n.includes(e)?this[Xr]=!0:this[Ct].reverse?this[Zr].lte=e:this[Zr].gte=e}};Fy.Iterator=ol;function qy(r){typeof r.commit=="function"&&r.commit()}});var jy=N((LR,Hy)=>{"use strict";var MR=l(f());Hy.exports=function(e,t,n,i,o){if(i.limit===0)return e.nextTick(o);let s=e.db.transaction([t],"readwrite"),a=s.objectStore(t),c=0;s.oncomplete=function(){o()},s.onabort=function(){o(s.error||new Error("aborted by user"))};let d=a.openKeyCursor?"openKeyCursor":"openCursor",u=i.reverse?"prev":"next";a[d](n,u).onsuccess=function(h){let m=h.target.result;m&&(a.delete(m.key).onsuccess=function(){(i.limit<=0||++c<i.limit)&&m.continue()})}}});var cl=N(Yy=>{"use strict";var $R=l(f()),{AbstractLevel:wv}=tl(),Wy=tr(),bv=Ky(),{fromCallback:xv}=ys(),{Iterator:Ev}=Vy(),zy=nl(),vv=jy(),Sv=rl(),Jy="level-js-",Bs=Symbol("idb"),sl=Symbol("namePrefix"),Qr=Symbol("location"),al=Symbol("version"),wi=Symbol("store"),Rs=Symbol("onComplete"),Gy=Symbol("promise"),lc=class extends wv{constructor(e,t,n){if(typeof t=="function"||typeof n=="function")throw new Wy("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});let{prefix:i,version:o,...s}=t||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},s),typeof e!="string")throw new Error("constructor requires a location string argument");this[Qr]=e,this[sl]=i??Jy,this[al]=parseInt(o||1,10),this[Bs]=null}get location(){return this[Qr]}get namePrefix(){return this[sl]}get version(){return this[al]}get db(){return this[Bs]}get type(){return"browser-level"}_open(e,t){let n=indexedDB.open(this[sl]+this[Qr],this[al]);n.onerror=function(){t(n.error||new Error("unknown error"))},n.onsuccess=()=>{this[Bs]=n.result,t()},n.onupgradeneeded=i=>{let o=i.target.result;o.objectStoreNames.contains(this[Qr])||o.createObjectStore(this[Qr])}}[wi](e){return this[Bs].transaction([this[Qr]],e).objectStore(this[Qr])}[Rs](e,t){let n=e.transaction;n.onabort=function(){t(n.error||new Error("aborted by user"))},n.oncomplete=function(){t(null,e.result)}}_get(e,t,n){let i=this[wi]("readonly"),o;try{o=i.get(e)}catch(s){return this.nextTick(n,s)}this[Rs](o,function(s,a){if(s)return n(s);if(a===void 0)return n(new Wy("Entry not found",{code:"LEVEL_NOT_FOUND"}));n(null,zy(a))})}_getMany(e,t,n){let i=this[wi]("readonly"),o=e.map(s=>a=>{let c;try{c=i.get(s)}catch(d){return a(d)}c.onsuccess=()=>{let d=c.result;a(null,d===void 0?d:zy(d))},c.onerror=d=>{d.stopPropagation(),a(c.error)}});bv(o,16,n)}_del(e,t,n){let i=this[wi]("readwrite"),o;try{o=i.delete(e)}catch(s){return this.nextTick(n,s)}this[Rs](o,n)}_put(e,t,n,i){let o=this[wi]("readwrite"),s;try{s=o.put(t,e)}catch(a){return this.nextTick(i,a)}this[Rs](s,i)}_iterator(e){return new Ev(this,this[Qr],e)}_batch(e,t,n){let i=this[wi]("readwrite"),o=i.transaction,s=0,a;o.onabort=function(){n(a||o.error||new Error("aborted by user"))},o.oncomplete=function(){n()};function c(){let d=e[s++],u=d.key,h;try{h=d.type==="del"?i.delete(u):i.put(d.value,u)}catch(m){a=m,o.abort();return}s<e.length?h.onsuccess=c:typeof o.commit=="function"&&o.commit()}c()}_clear(e,t){let n,i;try{n=Sv(e)}catch{return this.nextTick(t)}if(e.limit>=0)return vv(this,this[Qr],n,e,t);try{let o=this[wi]("readwrite");i=n?o.delete(n):o.clear()}catch(o){return this.nextTick(t,o)}this[Rs](i,t)}_close(e){this[Bs].close(),this.nextTick(e)}};lc.destroy=function(r,e,t){typeof e=="function"&&(t=e,e=Jy),t=xv(t,Gy);let n=indexedDB.deleteDatabase(e+r);return n.onsuccess=function(){t()},n.onerror=function(i){t(i)},t[Gy]};Yy.BrowserLevel=lc});var ul=N(Xy=>{var FR=l(f());Xy.Level=cl().BrowserLevel});var He=N((GR,Zy)=>{"use strict";var JR=l(f());Zy.exports={ArrayIsArray(r){return Array.isArray(r)},ArrayPrototypeIncludes(r,e){return r.includes(e)},ArrayPrototypeIndexOf(r,e){return r.indexOf(e)},ArrayPrototypeJoin(r,e){return r.join(e)},ArrayPrototypeMap(r,e){return r.map(e)},ArrayPrototypePop(r,e){return r.pop(e)},ArrayPrototypePush(r,e){return r.push(e)},ArrayPrototypeSlice(r,e,t){return r.slice(e,t)},Error,FunctionPrototypeCall(r,e,...t){return r.call(e,...t)},FunctionPrototypeSymbolHasInstance(r,e){return Function.prototype[Symbol.hasInstance].call(r,e)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(r,e){return Object.defineProperties(r,e)},ObjectDefineProperty(r,e,t){return Object.defineProperty(r,e,t)},ObjectGetOwnPropertyDescriptor(r,e){return Object.getOwnPropertyDescriptor(r,e)},ObjectKeys(r){return Object.keys(r)},ObjectSetPrototypeOf(r,e){return Object.setPrototypeOf(r,e)},Promise,PromisePrototypeCatch(r,e){return r.catch(e)},PromisePrototypeThen(r,e,t){return r.then(e,t)},PromiseReject(r){return Promise.reject(r)},ReflectApply:Reflect.apply,RegExpPrototypeTest(r,e){return r.test(e)},SafeSet:Set,String,StringPrototypeSlice(r,e,t){return r.slice(e,t)},StringPrototypeToLowerCase(r){return r.toLowerCase()},StringPrototypeToUpperCase(r){return r.toUpperCase()},StringPrototypeTrim(r){return r.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(r,e,t){return r.set(e,t)},Uint8Array}});var Sr=N((YR,ll)=>{"use strict";var XR=l(f()),_v=xt(),Tv=Object.getPrototypeOf(async function(){}).constructor,Qy=globalThis.Blob||_v.Blob,Iv=typeof Qy<"u"?function(e){return e instanceof Qy}:function(e){return!1},dl=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);let t="";for(let n=0;n<e.length;n++)t+=`    ${e[n].stack}
`;super(t),this.name="AggregateError",this.errors=e}};ll.exports={AggregateError:dl,kEmptyObject:Object.freeze({}),once(r){let e=!1;return function(...t){e||(e=!0,r.apply(this,t))}},createDeferredPromise:function(){let r,e;return{promise:new Promise((n,i)=>{r=n,e=i}),resolve:r,reject:e}},promisify(r){return new Promise((e,t)=>{r((n,...i)=>n?t(n):e(...i))})},debuglog(){return function(){}},format(r,...e){return r.replace(/%([sdifj])/g,function(...[t,n]){let i=e.shift();return n==="f"?i.toFixed(6):n==="j"?JSON.stringify(i):n==="s"&&typeof i=="object"?`${i.constructor!==Object?i.constructor.name:""} {}`.trim():i.toString()})},inspect(r){switch(typeof r){case"string":if(r.includes("'"))if(r.includes('"')){if(!r.includes("`")&&!r.includes("${"))return`\`${r}\``}else return`"${r}"`;return`'${r}'`;case"number":return isNaN(r)?"NaN":Object.is(r,-0)?String(r):r;case"bigint":return`${String(r)}n`;case"boolean":case"undefined":return String(r);case"object":return"{}"}},types:{isAsyncFunction(r){return r instanceof Tv},isArrayBufferView(r){return ArrayBuffer.isView(r)}},isBlob:Iv};ll.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")});var pc=N((ZR,hc)=>{"use strict";var QR=l(f()),{AbortController:em,AbortSignal:Dv}=typeof self<"u"?self:typeof window<"u"?window:void 0;hc.exports=em;hc.exports.AbortSignal=Dv;hc.exports.default=em});var ht=N((e6,nm)=>{"use strict";var t6=l(f()),{format:Bv,inspect:yc,AggregateError:Rv}=Sr(),Ov=globalThis.AggregateError||Rv,Uv=Symbol("kIsNodeError"),Cv=["string","function","number","object","Function","Object","boolean","bigint","symbol"],kv=/^([A-Z][a-z0-9]*)+$/,Pv="__node_internal_",mc={};function xi(r,e){if(!r)throw new mc.ERR_INTERNAL_ASSERTION(e)}function tm(r){let e="",t=r.length,n=r[0]==="-"?1:0;for(;t>=n+4;t-=3)e=`_${r.slice(t-3,t)}${e}`;return`${r.slice(0,t)}${e}`}function Kv(r,e,t){if(typeof e=="function")return xi(e.length<=t.length,`Code: ${r}; The provided arguments length (${t.length}) does not match the required ones (${e.length}).`),e(...t);let n=(e.match(/%[dfijoOs]/g)||[]).length;return xi(n===t.length,`Code: ${r}; The provided arguments length (${t.length}) does not match the required ones (${n}).`),t.length===0?e:Bv(e,...t)}function it(r,e,t){t||(t=Error);class n extends t{constructor(...o){super(Kv(r,e,o))}toString(){return`${this.name} [${r}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:t.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${r}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=r,n.prototype[Uv]=!0,mc[r]=n}function rm(r){let e=Pv+r.name;return Object.defineProperty(r,"name",{value:e}),r}function Lv(r,e){if(r&&e&&r!==e){if(Array.isArray(e.errors))return e.errors.push(r),e;let t=new Ov([e,r],e.message);return t.code=e.code,t}return r||e}var fl=class extends Error{constructor(e="The operation was aborted",t=void 0){if(t!==void 0&&typeof t!="object")throw new mc.ERR_INVALID_ARG_TYPE("options","Object",t);super(e,t),this.code="ABORT_ERR",this.name="AbortError"}};it("ERR_ASSERTION","%s",Error);it("ERR_INVALID_ARG_TYPE",(r,e,t)=>{xi(typeof r=="string","'name' must be a string"),Array.isArray(e)||(e=[e]);let n="The ";r.endsWith(" argument")?n+=`${r} `:n+=`"${r}" ${r.includes(".")?"property":"argument"} `,n+="must be ";let i=[],o=[],s=[];for(let c of e)xi(typeof c=="string","All expected entries have to be of type string"),Cv.includes(c)?i.push(c.toLowerCase()):kv.test(c)?o.push(c):(xi(c!=="object",'The value "object" should be written as "Object"'),s.push(c));if(o.length>0){let c=i.indexOf("object");c!==-1&&(i.splice(i,c,1),o.push("Object"))}if(i.length>0){switch(i.length){case 1:n+=`of type ${i[0]}`;break;case 2:n+=`one of type ${i[0]} or ${i[1]}`;break;default:{let c=i.pop();n+=`one of type ${i.join(", ")}, or ${c}`}}(o.length>0||s.length>0)&&(n+=" or ")}if(o.length>0){switch(o.length){case 1:n+=`an instance of ${o[0]}`;break;case 2:n+=`an instance of ${o[0]} or ${o[1]}`;break;default:{let c=o.pop();n+=`an instance of ${o.join(", ")}, or ${c}`}}s.length>0&&(n+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(n+="an "),n+=`${s[0]}`;break;case 2:n+=`one of ${s[0]} or ${s[1]}`;break;default:{let c=s.pop();n+=`one of ${s.join(", ")}, or ${c}`}}if(t==null)n+=`. Received ${t}`;else if(typeof t=="function"&&t.name)n+=`. Received function ${t.name}`;else if(typeof t=="object"){var a;if((a=t.constructor)!==null&&a!==void 0&&a.name)n+=`. Received an instance of ${t.constructor.name}`;else{let c=yc(t,{depth:-1});n+=`. Received ${c}`}}else{let c=yc(t,{colors:!1});c.length>25&&(c=`${c.slice(0,25)}...`),n+=`. Received type ${typeof t} (${c})`}return n},TypeError);it("ERR_INVALID_ARG_VALUE",(r,e,t="is invalid")=>{let n=yc(e);return n.length>128&&(n=n.slice(0,128)+"..."),`The ${r.includes(".")?"property":"argument"} '${r}' ${t}. Received ${n}`},TypeError);it("ERR_INVALID_RETURN_VALUE",(r,e,t)=>{var n;let i=t!=null&&(n=t.constructor)!==null&&n!==void 0&&n.name?`instance of ${t.constructor.name}`:`type ${typeof t}`;return`Expected ${r} to be returned from the "${e}" function but got ${i}.`},TypeError);it("ERR_MISSING_ARGS",(...r)=>{xi(r.length>0,"At least one arg needs to be specified");let e,t=r.length;switch(r=(Array.isArray(r)?r:[r]).map(n=>`"${n}"`).join(" or "),t){case 1:e+=`The ${r[0]} argument`;break;case 2:e+=`The ${r[0]} and ${r[1]} arguments`;break;default:{let n=r.pop();e+=`The ${r.join(", ")}, and ${n} arguments`}break}return`${e} must be specified`},TypeError);it("ERR_OUT_OF_RANGE",(r,e,t)=>{xi(e,'Missing "range" argument');let n;return Number.isInteger(t)&&Math.abs(t)>2**32?n=tm(String(t)):typeof t=="bigint"?(n=String(t),(t>2n**32n||t<-(2n**32n))&&(n=tm(n)),n+="n"):n=yc(t),`The value of "${r}" is out of range. It must be ${e}. Received ${n}`},RangeError);it("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);it("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);it("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);it("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);it("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);it("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);it("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);it("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);it("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);it("ERR_STREAM_WRITE_AFTER_END","write after end",Error);it("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);nm.exports={AbortError:fl,aggregateTwoErrors:rm(Lv),hideStackFrames:rm,codes:mc}});var Os=N((r6,fm)=>{"use strict";var n6=l(f()),{ArrayIsArray:pl,ArrayPrototypeIncludes:am,ArrayPrototypeJoin:cm,ArrayPrototypeMap:Mv,NumberIsInteger:yl,NumberIsNaN:Nv,NumberMAX_SAFE_INTEGER:$v,NumberMIN_SAFE_INTEGER:qv,NumberParseInt:Fv,ObjectPrototypeHasOwnProperty:Vv,RegExpPrototypeExec:um,String:Hv,StringPrototypeToUpperCase:jv,StringPrototypeTrim:Wv}=He(),{hideStackFrames:Wt,codes:{ERR_SOCKET_BAD_PORT:zv,ERR_INVALID_ARG_TYPE:pt,ERR_INVALID_ARG_VALUE:yo,ERR_OUT_OF_RANGE:Ei,ERR_UNKNOWN_SIGNAL:im}}=ht(),{normalizeEncoding:Gv}=Sr(),{isAsyncFunction:Jv,isArrayBufferView:Yv}=Sr().types,om={};function Xv(r){return r===(r|0)}function Zv(r){return r===r>>>0}var Qv=/^[0-7]+$/,e1="must be a 32-bit unsigned integer or an octal string";function t1(r,e,t){if(typeof r>"u"&&(r=t),typeof r=="string"){if(um(Qv,r)===null)throw new yo(e,r,e1);r=Fv(r,8)}return dm(r,e),r}var r1=Wt((r,e,t=qv,n=$v)=>{if(typeof r!="number")throw new pt(e,"number",r);if(!yl(r))throw new Ei(e,"an integer",r);if(r<t||r>n)throw new Ei(e,`>= ${t} && <= ${n}`,r)}),n1=Wt((r,e,t=-2147483648,n=2147483647)=>{if(typeof r!="number")throw new pt(e,"number",r);if(!yl(r))throw new Ei(e,"an integer",r);if(r<t||r>n)throw new Ei(e,`>= ${t} && <= ${n}`,r)}),dm=Wt((r,e,t=!1)=>{if(typeof r!="number")throw new pt(e,"number",r);if(!yl(r))throw new Ei(e,"an integer",r);let n=t?1:0,i=4294967295;if(r<n||r>i)throw new Ei(e,`>= ${n} && <= ${i}`,r)});function ml(r,e){if(typeof r!="string")throw new pt(e,"string",r)}function i1(r,e,t=void 0,n){if(typeof r!="number")throw new pt(e,"number",r);if(t!=null&&r<t||n!=null&&r>n||(t!=null||n!=null)&&Nv(r))throw new Ei(e,`${t!=null?`>= ${t}`:""}${t!=null&&n!=null?" && ":""}${n!=null?`<= ${n}`:""}`,r)}var o1=Wt((r,e,t)=>{if(!am(t,r)){let i="must be one of: "+cm(Mv(t,o=>typeof o=="string"?`'${o}'`:Hv(o)),", ");throw new yo(e,r,i)}});function lm(r,e){if(typeof r!="boolean")throw new pt(e,"boolean",r)}function hl(r,e,t){return r==null||!Vv(r,e)?t:r[e]}var s1=Wt((r,e,t=null)=>{let n=hl(t,"allowArray",!1),i=hl(t,"allowFunction",!1);if(!hl(t,"nullable",!1)&&r===null||!n&&pl(r)||typeof r!="object"&&(!i||typeof r!="function"))throw new pt(e,"Object",r)}),a1=Wt((r,e)=>{if(r!=null&&typeof r!="object"&&typeof r!="function")throw new pt(e,"a dictionary",r)}),gl=Wt((r,e,t=0)=>{if(!pl(r))throw new pt(e,"Array",r);if(r.length<t){let n=`must be longer than ${t}`;throw new yo(e,r,n)}});function c1(r,e){gl(r,e);for(let t=0;t<r.length;t++)ml(r[t],`${e}[${t}]`)}function u1(r,e){gl(r,e);for(let t=0;t<r.length;t++)lm(r[t],`${e}[${t}]`)}function d1(r,e="signal"){if(ml(r,e),om[r]===void 0)throw om[jv(r)]!==void 0?new im(r+" (signals must use all capital letters)"):new im(r)}var l1=Wt((r,e="buffer")=>{if(!Yv(r))throw new pt(e,["Buffer","TypedArray","DataView"],r)});function f1(r,e){let t=Gv(e),n=r.length;if(t==="hex"&&n%2!==0)throw new yo("encoding",e,`is invalid for data of length ${n}`)}function h1(r,e="Port",t=!0){if(typeof r!="number"&&typeof r!="string"||typeof r=="string"&&Wv(r).length===0||+r!==+r>>>0||r>65535||r===0&&!t)throw new zv(e,r,t);return r|0}var p1=Wt((r,e)=>{if(r!==void 0&&(r===null||typeof r!="object"||!("aborted"in r)))throw new pt(e,"AbortSignal",r)}),y1=Wt((r,e)=>{if(typeof r!="function")throw new pt(e,"Function",r)}),m1=Wt((r,e)=>{if(typeof r!="function"||Jv(r))throw new pt(e,"Function",r)}),g1=Wt((r,e)=>{if(r!==void 0)throw new pt(e,"undefined",r)});function w1(r,e,t){if(!am(t,r))throw new pt(e,`('${cm(t,"|")}')`,r)}var b1=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function sm(r,e){if(typeof r>"u"||!um(b1,r))throw new yo(e,r,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function x1(r){if(typeof r=="string")return sm(r,"hints"),r;if(pl(r)){let e=r.length,t="";if(e===0)return t;for(let n=0;n<e;n++){let i=r[n];sm(i,"hints"),t+=i,n!==e-1&&(t+=", ")}return t}throw new yo("hints",r,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}fm.exports={isInt32:Xv,isUint32:Zv,parseFileMode:t1,validateArray:gl,validateStringArray:c1,validateBooleanArray:u1,validateBoolean:lm,validateBuffer:l1,validateDictionary:a1,validateEncoding:f1,validateFunction:y1,validateInt32:n1,validateInteger:r1,validateNumber:i1,validateObject:s1,validateOneOf:o1,validatePlainFunction:m1,validatePort:h1,validateSignalName:d1,validateString:ml,validateUint32:dm,validateUndefined:g1,validateUnion:w1,validateAbortSignal:p1,validateLinkHeaderValue:x1}});var On=N((i6,mm)=>{var o6=l(f()),Le=mm.exports={},Ar,_r;function wl(){throw new Error("setTimeout has not been defined")}function bl(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Ar=setTimeout:Ar=wl}catch{Ar=wl}try{typeof clearTimeout=="function"?_r=clearTimeout:_r=bl}catch{_r=bl}})();function hm(r){if(Ar===setTimeout)return setTimeout(r,0);if((Ar===wl||!Ar)&&setTimeout)return Ar=setTimeout,setTimeout(r,0);try{return Ar(r,0)}catch{try{return Ar.call(null,r,0)}catch{return Ar.call(this,r,0)}}}function E1(r){if(_r===clearTimeout)return clearTimeout(r);if((_r===bl||!_r)&&clearTimeout)return _r=clearTimeout,clearTimeout(r);try{return _r(r)}catch{try{return _r.call(null,r)}catch{return _r.call(this,r)}}}var en=[],mo=!1,vi,gc=-1;function v1(){!mo||!vi||(mo=!1,vi.length?en=vi.concat(en):gc=-1,en.length&&pm())}function pm(){if(!mo){var r=hm(v1);mo=!0;for(var e=en.length;e;){for(vi=en,en=[];++gc<e;)vi&&vi[gc].run();gc=-1,e=en.length}vi=null,mo=!1,E1(r)}}Le.nextTick=function(r){var e=new Array(arguments.length-1);if(arguments.length>1)for(var t=1;t<arguments.length;t++)e[t-1]=arguments[t];en.push(new ym(r,e)),en.length===1&&!mo&&hm(pm)};function ym(r,e){this.fun=r,this.array=e}ym.prototype.run=function(){this.fun.apply(null,this.array)};Le.title="browser";Le.browser=!0;Le.env={};Le.argv=[];Le.version="";Le.versions={};function tn(){}Le.on=tn;Le.addListener=tn;Le.once=tn;Le.off=tn;Le.removeListener=tn;Le.removeAllListeners=tn;Le.emit=tn;Le.prependListener=tn;Le.prependOnceListener=tn;Le.listeners=function(r){return[]};Le.binding=function(r){throw new Error("process.binding is not supported")};Le.cwd=function(){return"/"};Le.chdir=function(r){throw new Error("process.chdir is not supported")};Le.umask=function(){return 0}});var Ir=N((s6,Um)=>{"use strict";var a6=l(f()),{Symbol:wc,SymbolAsyncIterator:gm,SymbolIterator:wm,SymbolFor:bm}=He(),xm=wc("kDestroyed"),Em=wc("kIsErrored"),xl=wc("kIsReadable"),vm=wc("kIsDisturbed"),S1=bm("nodejs.webstream.isClosedPromise"),A1=bm("nodejs.webstream.controllerErrorFunction");function bc(r,e=!1){var t;return!!(r&&typeof r.pipe=="function"&&typeof r.on=="function"&&(!e||typeof r.pause=="function"&&typeof r.resume=="function")&&(!r._writableState||((t=r._readableState)===null||t===void 0?void 0:t.readable)!==!1)&&(!r._writableState||r._readableState))}function xc(r){var e;return!!(r&&typeof r.write=="function"&&typeof r.on=="function"&&(!r._readableState||((e=r._writableState)===null||e===void 0?void 0:e.writable)!==!1))}function _1(r){return!!(r&&typeof r.pipe=="function"&&r._readableState&&typeof r.on=="function"&&typeof r.write=="function")}function Tr(r){return r&&(r._readableState||r._writableState||typeof r.write=="function"&&typeof r.on=="function"||typeof r.pipe=="function"&&typeof r.on=="function")}function Sm(r){return!!(r&&!Tr(r)&&typeof r.pipeThrough=="function"&&typeof r.getReader=="function"&&typeof r.cancel=="function")}function Am(r){return!!(r&&!Tr(r)&&typeof r.getWriter=="function"&&typeof r.abort=="function")}function _m(r){return!!(r&&!Tr(r)&&typeof r.readable=="object"&&typeof r.writable=="object")}function T1(r){return Sm(r)||Am(r)||_m(r)}function I1(r,e){return r==null?!1:e===!0?typeof r[gm]=="function":e===!1?typeof r[wm]=="function":typeof r[gm]=="function"||typeof r[wm]=="function"}function Ec(r){if(!Tr(r))return null;let e=r._writableState,t=r._readableState,n=e||t;return!!(r.destroyed||r[xm]||n!=null&&n.destroyed)}function Tm(r){if(!xc(r))return null;if(r.writableEnded===!0)return!0;let e=r._writableState;return e!=null&&e.errored?!1:typeof e?.ended!="boolean"?null:e.ended}function D1(r,e){if(!xc(r))return null;if(r.writableFinished===!0)return!0;let t=r._writableState;return t!=null&&t.errored?!1:typeof t?.finished!="boolean"?null:!!(t.finished||e===!1&&t.ended===!0&&t.length===0)}function B1(r){if(!bc(r))return null;if(r.readableEnded===!0)return!0;let e=r._readableState;return!e||e.errored?!1:typeof e?.ended!="boolean"?null:e.ended}function Im(r,e){if(!bc(r))return null;let t=r._readableState;return t!=null&&t.errored?!1:typeof t?.endEmitted!="boolean"?null:!!(t.endEmitted||e===!1&&t.ended===!0&&t.length===0)}function Dm(r){return r&&r[xl]!=null?r[xl]:typeof r?.readable!="boolean"?null:Ec(r)?!1:bc(r)&&r.readable&&!Im(r)}function Bm(r){return typeof r?.writable!="boolean"?null:Ec(r)?!1:xc(r)&&r.writable&&!Tm(r)}function R1(r,e){return Tr(r)?Ec(r)?!0:!(e?.readable!==!1&&Dm(r)||e?.writable!==!1&&Bm(r)):null}function O1(r){var e,t;return Tr(r)?r.writableErrored?r.writableErrored:(e=(t=r._writableState)===null||t===void 0?void 0:t.errored)!==null&&e!==void 0?e:null:null}function U1(r){var e,t;return Tr(r)?r.readableErrored?r.readableErrored:(e=(t=r._readableState)===null||t===void 0?void 0:t.errored)!==null&&e!==void 0?e:null:null}function C1(r){if(!Tr(r))return null;if(typeof r.closed=="boolean")return r.closed;let e=r._writableState,t=r._readableState;return typeof e?.closed=="boolean"||typeof t?.closed=="boolean"?e?.closed||t?.closed:typeof r._closed=="boolean"&&Rm(r)?r._closed:null}function Rm(r){return typeof r._closed=="boolean"&&typeof r._defaultKeepAlive=="boolean"&&typeof r._removedConnection=="boolean"&&typeof r._removedContLen=="boolean"}function Om(r){return typeof r._sent100=="boolean"&&Rm(r)}function k1(r){var e;return typeof r._consuming=="boolean"&&typeof r._dumped=="boolean"&&((e=r.req)===null||e===void 0?void 0:e.upgradeOrConnect)===void 0}function P1(r){if(!Tr(r))return null;let e=r._writableState,t=r._readableState,n=e||t;return!n&&Om(r)||!!(n&&n.autoDestroy&&n.emitClose&&n.closed===!1)}function K1(r){var e;return!!(r&&((e=r[vm])!==null&&e!==void 0?e:r.readableDidRead||r.readableAborted))}function L1(r){var e,t,n,i,o,s,a,c,d,u;return!!(r&&((e=(t=(n=(i=(o=(s=r[Em])!==null&&s!==void 0?s:r.readableErrored)!==null&&o!==void 0?o:r.writableErrored)!==null&&i!==void 0?i:(a=r._readableState)===null||a===void 0?void 0:a.errorEmitted)!==null&&n!==void 0?n:(c=r._writableState)===null||c===void 0?void 0:c.errorEmitted)!==null&&t!==void 0?t:(d=r._readableState)===null||d===void 0?void 0:d.errored)!==null&&e!==void 0?e:!((u=r._writableState)===null||u===void 0)&&u.errored))}Um.exports={kDestroyed:xm,isDisturbed:K1,kIsDisturbed:vm,isErrored:L1,kIsErrored:Em,isReadable:Dm,kIsReadable:xl,kIsClosedPromise:S1,kControllerErrorFunction:A1,isClosed:C1,isDestroyed:Ec,isDuplexNodeStream:_1,isFinished:R1,isIterable:I1,isReadableNodeStream:bc,isReadableStream:Sm,isReadableEnded:B1,isReadableFinished:Im,isReadableErrored:U1,isNodeStream:Tr,isWebStream:T1,isWritable:Bm,isWritableNodeStream:xc,isWritableStream:Am,isWritableEnded:Tm,isWritableFinished:D1,isWritableErrored:O1,isServerRequest:k1,isServerResponse:Om,willEmitClose:P1,isTransformStream:_m}});var rn=N((c6,_l)=>{var u6=l(f()),Un=On(),{AbortError:qm,codes:M1}=ht(),{ERR_INVALID_ARG_TYPE:N1,ERR_STREAM_PREMATURE_CLOSE:Cm}=M1,{kEmptyObject:vl,once:Sl}=Sr(),{validateAbortSignal:$1,validateFunction:q1,validateObject:F1,validateBoolean:V1}=Os(),{Promise:H1,PromisePrototypeThen:j1}=He(),{isClosed:W1,isReadable:km,isReadableNodeStream:El,isReadableStream:z1,isReadableFinished:Pm,isReadableErrored:Km,isWritable:Lm,isWritableNodeStream:Mm,isWritableStream:G1,isWritableFinished:Nm,isWritableErrored:$m,isNodeStream:J1,willEmitClose:Y1,kIsClosedPromise:X1}=Ir();function Z1(r){return r.setHeader&&typeof r.abort=="function"}var Al=()=>{};function Fm(r,e,t){var n,i;if(arguments.length===2?(t=e,e=vl):e==null?e=vl:F1(e,"options"),q1(t,"callback"),$1(e.signal,"options.signal"),t=Sl(t),z1(r)||G1(r))return Q1(r,e,t);if(!J1(r))throw new N1("stream",["ReadableStream","WritableStream","Stream"],r);let o=(n=e.readable)!==null&&n!==void 0?n:El(r),s=(i=e.writable)!==null&&i!==void 0?i:Mm(r),a=r._writableState,c=r._readableState,d=()=>{r.writable||m()},u=Y1(r)&&El(r)===o&&Mm(r)===s,h=Nm(r,!1),m=()=>{h=!0,r.destroyed&&(u=!1),!(u&&(!r.readable||o))&&(!o||w)&&t.call(r)},w=Pm(r,!1),p=()=>{w=!0,r.destroyed&&(u=!1),!(u&&(!r.writable||s))&&(!s||h)&&t.call(r)},b=I=>{t.call(r,I)},v=W1(r),S=()=>{v=!0;let I=$m(r)||Km(r);if(I&&typeof I!="boolean")return t.call(r,I);if(o&&!w&&El(r,!0)&&!Pm(r,!1))return t.call(r,new Cm);if(s&&!h&&!Nm(r,!1))return t.call(r,new Cm);t.call(r)},D=()=>{v=!0;let I=$m(r)||Km(r);if(I&&typeof I!="boolean")return t.call(r,I);t.call(r)},E=()=>{r.req.on("finish",m)};Z1(r)?(r.on("complete",m),u||r.on("abort",S),r.req?E():r.on("request",E)):s&&!a&&(r.on("end",d),r.on("close",d)),!u&&typeof r.aborted=="boolean"&&r.on("aborted",S),r.on("end",p),r.on("finish",m),e.error!==!1&&r.on("error",b),r.on("close",S),v?Un.nextTick(S):a!=null&&a.errorEmitted||c!=null&&c.errorEmitted?u||Un.nextTick(D):(!o&&(!u||km(r))&&(h||Lm(r)===!1)||!s&&(!u||Lm(r))&&(w||km(r)===!1)||c&&r.req&&r.aborted)&&Un.nextTick(D);let R=()=>{t=Al,r.removeListener("aborted",S),r.removeListener("complete",m),r.removeListener("abort",S),r.removeListener("request",E),r.req&&r.req.removeListener("finish",m),r.removeListener("end",d),r.removeListener("close",d),r.removeListener("finish",m),r.removeListener("end",p),r.removeListener("error",b),r.removeListener("close",S)};if(e.signal&&!v){let I=()=>{let O=t;R(),O.call(r,new qm(void 0,{cause:e.signal.reason}))};if(e.signal.aborted)Un.nextTick(I);else{let O=t;t=Sl((...C)=>{e.signal.removeEventListener("abort",I),O.apply(r,C)}),e.signal.addEventListener("abort",I)}}return R}function Q1(r,e,t){let n=!1,i=Al;if(e.signal)if(i=()=>{n=!0,t.call(r,new qm(void 0,{cause:e.signal.reason}))},e.signal.aborted)Un.nextTick(i);else{let s=t;t=Sl((...a)=>{e.signal.removeEventListener("abort",i),s.apply(r,a)}),e.signal.addEventListener("abort",i)}let o=(...s)=>{n||Un.nextTick(()=>t.apply(r,s))};return j1(r[X1].promise,o,o),Al}function e2(r,e){var t;let n=!1;return e===null&&(e=vl),(t=e)!==null&&t!==void 0&&t.cleanup&&(V1(e.cleanup,"cleanup"),n=e.cleanup),new H1((i,o)=>{let s=Fm(r,e,a=>{n&&s(),a?o(a):i()})})}_l.exports=Fm;_l.exports.finished=e2});var Si=N((d6,Ym)=>{"use strict";var l6=l(f()),Dr=On(),{aggregateTwoErrors:t2,codes:{ERR_MULTIPLE_CALLBACK:r2},AbortError:n2}=ht(),{Symbol:jm}=He(),{kDestroyed:i2,isDestroyed:o2,isFinished:s2,isServerRequest:a2}=Ir(),Wm=jm("kDestroy"),Tl=jm("kConstruct");function zm(r,e,t){r&&(r.stack,e&&!e.errored&&(e.errored=r),t&&!t.errored&&(t.errored=r))}function c2(r,e){let t=this._readableState,n=this._writableState,i=n||t;return n!=null&&n.destroyed||t!=null&&t.destroyed?(typeof e=="function"&&e(),this):(zm(r,n,t),n&&(n.destroyed=!0),t&&(t.destroyed=!0),i.constructed?Vm(this,r,e):this.once(Wm,function(o){Vm(this,t2(o,r),e)}),this)}function Vm(r,e,t){let n=!1;function i(o){if(n)return;n=!0;let s=r._readableState,a=r._writableState;zm(o,a,s),a&&(a.closed=!0),s&&(s.closed=!0),typeof t=="function"&&t(o),o?Dr.nextTick(u2,r,o):Dr.nextTick(Gm,r)}try{r._destroy(e||null,i)}catch(o){i(o)}}function u2(r,e){Il(r,e),Gm(r)}function Gm(r){let e=r._readableState,t=r._writableState;t&&(t.closeEmitted=!0),e&&(e.closeEmitted=!0),(t!=null&&t.emitClose||e!=null&&e.emitClose)&&r.emit("close")}function Il(r,e){let t=r._readableState,n=r._writableState;n!=null&&n.errorEmitted||t!=null&&t.errorEmitted||(n&&(n.errorEmitted=!0),t&&(t.errorEmitted=!0),r.emit("error",e))}function d2(){let r=this._readableState,e=this._writableState;r&&(r.constructed=!0,r.closed=!1,r.closeEmitted=!1,r.destroyed=!1,r.errored=null,r.errorEmitted=!1,r.reading=!1,r.ended=r.readable===!1,r.endEmitted=r.readable===!1),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=e.writable===!1,e.ending=e.writable===!1,e.finished=e.writable===!1)}function Dl(r,e,t){let n=r._readableState,i=r._writableState;if(i!=null&&i.destroyed||n!=null&&n.destroyed)return this;n!=null&&n.autoDestroy||i!=null&&i.autoDestroy?r.destroy(e):e&&(e.stack,i&&!i.errored&&(i.errored=e),n&&!n.errored&&(n.errored=e),t?Dr.nextTick(Il,r,e):Il(r,e))}function l2(r,e){if(typeof r._construct!="function")return;let t=r._readableState,n=r._writableState;t&&(t.constructed=!1),n&&(n.constructed=!1),r.once(Tl,e),!(r.listenerCount(Tl)>1)&&Dr.nextTick(f2,r)}function f2(r){let e=!1;function t(n){if(e){Dl(r,n??new r2);return}e=!0;let i=r._readableState,o=r._writableState,s=o||i;i&&(i.constructed=!0),o&&(o.constructed=!0),s.destroyed?r.emit(Wm,n):n?Dl(r,n,!0):Dr.nextTick(h2,r)}try{r._construct(n=>{Dr.nextTick(t,n)})}catch(n){Dr.nextTick(t,n)}}function h2(r){r.emit(Tl)}function Hm(r){return r?.setHeader&&typeof r.abort=="function"}function Jm(r){r.emit("close")}function p2(r,e){r.emit("error",e),Dr.nextTick(Jm,r)}function y2(r,e){!r||o2(r)||(!e&&!s2(r)&&(e=new n2),a2(r)?(r.socket=null,r.destroy(e)):Hm(r)?r.abort():Hm(r.req)?r.req.abort():typeof r.destroy=="function"?r.destroy(e):typeof r.close=="function"?r.close():e?Dr.nextTick(p2,r,e):Dr.nextTick(Jm,r),r.destroyed||(r[i2]=!0))}Ym.exports={construct:l2,destroyer:y2,destroy:c2,undestroy:d2,errorOrDestroy:Dl}});var Ac=N((f6,Zm)=>{"use strict";var h6=l(f()),{ArrayIsArray:m2,ObjectSetPrototypeOf:Xm}=He(),{EventEmitter:vc}=ps();function Sc(r){vc.call(this,r)}Xm(Sc.prototype,vc.prototype);Xm(Sc,vc);Sc.prototype.pipe=function(r,e){let t=this;function n(u){r.writable&&r.write(u)===!1&&t.pause&&t.pause()}t.on("data",n);function i(){t.readable&&t.resume&&t.resume()}r.on("drain",i),!r._isStdio&&(!e||e.end!==!1)&&(t.on("end",s),t.on("close",a));let o=!1;function s(){o||(o=!0,r.end())}function a(){o||(o=!0,typeof r.destroy=="function"&&r.destroy())}function c(u){d(),vc.listenerCount(this,"error")===0&&this.emit("error",u)}Bl(t,"error",c),Bl(r,"error",c);function d(){t.removeListener("data",n),r.removeListener("drain",i),t.removeListener("end",s),t.removeListener("close",a),t.removeListener("error",c),r.removeListener("error",c),t.removeListener("end",d),t.removeListener("close",d),r.removeListener("close",d)}return t.on("end",d),t.on("close",d),r.on("close",d),r.emit("pipe",t),r};function Bl(r,e,t){if(typeof r.prependListener=="function")return r.prependListener(e,t);!r._events||!r._events[e]?r.on(e,t):m2(r._events[e])?r._events[e].unshift(t):r._events[e]=[t,r._events[e]]}Zm.exports={Stream:Sc,prependListener:Bl}});var Us=N((p6,_c)=>{"use strict";var y6=l(f()),{AbortError:Qm,codes:g2}=ht(),{isNodeStream:e0,isWebStream:w2,kControllerErrorFunction:b2}=Ir(),x2=rn(),{ERR_INVALID_ARG_TYPE:t0}=g2,E2=(r,e)=>{if(typeof r!="object"||!("aborted"in r))throw new t0(e,"AbortSignal",r)};_c.exports.addAbortSignal=function(e,t){if(E2(e,"signal"),!e0(t)&&!w2(t))throw new t0("stream",["ReadableStream","WritableStream","Stream"],t);return _c.exports.addAbortSignalNoValidate(e,t)};_c.exports.addAbortSignalNoValidate=function(r,e){if(typeof r!="object"||!("aborted"in r))return e;let t=e0(e)?()=>{e.destroy(new Qm(void 0,{cause:r.reason}))}:()=>{e[b2](new Qm(void 0,{cause:r.reason}))};return r.aborted?t():(r.addEventListener("abort",t),x2(e,()=>r.removeEventListener("abort",t))),e}});var i0=N((g6,n0)=>{"use strict";var w6=l(f()),{StringPrototypeSlice:r0,SymbolIterator:v2,TypedArrayPrototypeSet:Tc,Uint8Array:S2}=He(),{Buffer:Rl}=xt(),{inspect:A2}=Sr();n0.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){let t={data:e,next:null};this.length>0?this.tail.next=t:this.head=t,this.tail=t,++this.length}unshift(e){let t={data:e,next:this.head};this.length===0&&(this.tail=t),this.head=t,++this.length}shift(){if(this.length===0)return;let e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let t=this.head,n=""+t.data;for(;(t=t.next)!==null;)n+=e+t.data;return n}concat(e){if(this.length===0)return Rl.alloc(0);let t=Rl.allocUnsafe(e>>>0),n=this.head,i=0;for(;n;)Tc(t,n.data,i),i+=n.data.length,n=n.next;return t}consume(e,t){let n=this.head.data;if(e<n.length){let i=n.slice(0,e);return this.head.data=n.slice(e),i}return e===n.length?this.shift():t?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[v2](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let t="",n=this.head,i=0;do{let o=n.data;if(e>o.length)t+=o,e-=o.length;else{e===o.length?(t+=o,++i,n.next?this.head=n.next:this.head=this.tail=null):(t+=r0(o,0,e),this.head=n,n.data=r0(o,e));break}++i}while((n=n.next)!==null);return this.length-=i,t}_getBuffer(e){let t=Rl.allocUnsafe(e),n=e,i=this.head,o=0;do{let s=i.data;if(e>s.length)Tc(t,s,n-e),e-=s.length;else{e===s.length?(Tc(t,s,n-e),++o,i.next?this.head=i.next:this.head=this.tail=null):(Tc(t,new S2(s.buffer,s.byteOffset,e),n-e),this.head=i,i.data=s.slice(e));break}++o}while((i=i.next)!==null);return this.length-=o,t}[Symbol.for("nodejs.util.inspect.custom")](e,t){return A2(this,{...t,depth:0,customInspect:!1})}}});var Ic=N((b6,s0)=>{"use strict";var x6=l(f()),{MathFloor:_2,NumberIsInteger:T2}=He(),{ERR_INVALID_ARG_VALUE:I2}=ht().codes;function D2(r,e,t){return r.highWaterMark!=null?r.highWaterMark:e?r[t]:null}function o0(r){return r?16:16*1024}function B2(r,e,t,n){let i=D2(e,n,t);if(i!=null){if(!T2(i)||i<0){let o=n?`options.${t}`:"options.highWaterMark";throw new I2(o,i)}return _2(i)}return o0(r.objectMode)}s0.exports={getHighWaterMark:B2,getDefaultHighWaterMark:o0}});var u0=N((Ol,c0)=>{var E6=l(f());var Dc=xt(),Br=Dc.Buffer;function a0(r,e){for(var t in r)e[t]=r[t]}Br.from&&Br.alloc&&Br.allocUnsafe&&Br.allocUnsafeSlow?c0.exports=Dc:(a0(Dc,Ol),Ol.Buffer=Ai);function Ai(r,e,t){return Br(r,e,t)}Ai.prototype=Object.create(Br.prototype);a0(Br,Ai);Ai.from=function(r,e,t){if(typeof r=="number")throw new TypeError("Argument must not be a number");return Br(r,e,t)};Ai.alloc=function(r,e,t){if(typeof r!="number")throw new TypeError("Argument must be a number");var n=Br(r);return e!==void 0?typeof t=="string"?n.fill(e,t):n.fill(e):n.fill(0),n};Ai.allocUnsafe=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Br(r)};Ai.allocUnsafeSlow=function(r){if(typeof r!="number")throw new TypeError("Argument must be a number");return Dc.SlowBuffer(r)}});var f0=N(l0=>{"use strict";var S6=l(f()),Cl=u0().Buffer,d0=Cl.isEncoding||function(r){switch(r=""+r,r&&r.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function R2(r){if(!r)return"utf8";for(var e;;)switch(r){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return r;default:if(e)return;r=(""+r).toLowerCase(),e=!0}}function O2(r){var e=R2(r);if(typeof e!="string"&&(Cl.isEncoding===d0||!d0(r)))throw new Error("Unknown encoding: "+r);return e||r}l0.StringDecoder=Cs;function Cs(r){this.encoding=O2(r);var e;switch(this.encoding){case"utf16le":this.text=L2,this.end=M2,e=4;break;case"utf8":this.fillLast=k2,e=4;break;case"base64":this.text=N2,this.end=$2,e=3;break;default:this.write=q2,this.end=F2;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=Cl.allocUnsafe(e)}Cs.prototype.write=function(r){if(r.length===0)return"";var e,t;if(this.lastNeed){if(e=this.fillLast(r),e===void 0)return"";t=this.lastNeed,this.lastNeed=0}else t=0;return t<r.length?e?e+this.text(r,t):this.text(r,t):e||""};Cs.prototype.end=K2;Cs.prototype.text=P2;Cs.prototype.fillLast=function(r){if(this.lastNeed<=r.length)return r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,this.lastTotal-this.lastNeed,0,r.length),this.lastNeed-=r.length};function Ul(r){return r<=127?0:r>>5===6?2:r>>4===14?3:r>>3===30?4:r>>6===2?-1:-2}function U2(r,e,t){var n=e.length-1;if(n<t)return 0;var i=Ul(e[n]);return i>=0?(i>0&&(r.lastNeed=i-1),i):--n<t||i===-2?0:(i=Ul(e[n]),i>=0?(i>0&&(r.lastNeed=i-2),i):--n<t||i===-2?0:(i=Ul(e[n]),i>=0?(i>0&&(i===2?i=0:r.lastNeed=i-3),i):0))}function C2(r,e,t){if((e[0]&192)!==128)return r.lastNeed=0,"\uFFFD";if(r.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return r.lastNeed=1,"\uFFFD";if(r.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return r.lastNeed=2,"\uFFFD"}}function k2(r){var e=this.lastTotal-this.lastNeed,t=C2(this,r,e);if(t!==void 0)return t;if(this.lastNeed<=r.length)return r.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);r.copy(this.lastChar,e,0,r.length),this.lastNeed-=r.length}function P2(r,e){var t=U2(this,r,e);if(!this.lastNeed)return r.toString("utf8",e);this.lastTotal=t;var n=r.length-(t-this.lastNeed);return r.copy(this.lastChar,0,n),r.toString("utf8",e,n)}function K2(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+"\uFFFD":e}function L2(r,e){if((r.length-e)%2===0){var t=r.toString("utf16le",e);if(t){var n=t.charCodeAt(t.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1],t.slice(0,-1)}return t}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=r[r.length-1],r.toString("utf16le",e,r.length-1)}function M2(r){var e=r&&r.length?this.write(r):"";if(this.lastNeed){var t=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,t)}return e}function N2(r,e){var t=(r.length-e)%3;return t===0?r.toString("base64",e):(this.lastNeed=3-t,this.lastTotal=3,t===1?this.lastChar[0]=r[r.length-1]:(this.lastChar[0]=r[r.length-2],this.lastChar[1]=r[r.length-1]),r.toString("base64",e,r.length-t))}function $2(r){var e=r&&r.length?this.write(r):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function q2(r){return r.toString(this.encoding)}function F2(r){return r&&r.length?this.write(r):""}});var kl=N((A6,m0)=>{"use strict";var _6=l(f()),h0=On(),{PromisePrototypeThen:V2,SymbolAsyncIterator:p0,SymbolIterator:y0}=He(),{Buffer:H2}=xt(),{ERR_INVALID_ARG_TYPE:j2,ERR_STREAM_NULL_VALUES:W2}=ht().codes;function z2(r,e,t){let n;if(typeof e=="string"||e instanceof H2)return new r({objectMode:!0,...t,read(){this.push(e),this.push(null)}});let i;if(e&&e[p0])i=!0,n=e[p0]();else if(e&&e[y0])i=!1,n=e[y0]();else throw new j2("iterable",["Iterable"],e);let o=new r({objectMode:!0,highWaterMark:1,...t}),s=!1;o._read=function(){s||(s=!0,c())},o._destroy=function(d,u){V2(a(d),()=>h0.nextTick(u,d),h=>h0.nextTick(u,h||d))};async function a(d){let u=d!=null,h=typeof n.throw=="function";if(u&&h){let{value:m,done:w}=await n.throw(d);if(await m,w)return}if(typeof n.return=="function"){let{value:m}=await n.return();await m}}async function c(){for(;;){try{let{value:d,done:u}=i?await n.next():n.next();if(u)o.push(null);else{let h=d&&typeof d.then=="function"?await d:d;if(h===null)throw s=!1,new W2;if(o.push(h))continue;s=!1}}catch(d){o.destroy(d)}break}}return o}m0.exports=z2});var ks=N((T6,B0)=>{var I6=l(f()),ir=On(),{ArrayPrototypeIndexOf:G2,NumberIsInteger:J2,NumberIsNaN:Y2,NumberParseInt:X2,ObjectDefineProperties:b0,ObjectKeys:Z2,ObjectSetPrototypeOf:x0,Promise:Q2,SafeSet:eS,SymbolAsyncIterator:tS,Symbol:rS}=He();B0.exports=ce;ce.ReadableState=$l;var{EventEmitter:nS}=ps(),{Stream:Cn,prependListener:iS}=Ac(),{Buffer:Pl}=xt(),{addAbortSignal:oS}=Us(),sS=rn(),le=Sr().debuglog("stream",r=>{le=r}),aS=i0(),wo=Si(),{getHighWaterMark:cS,getDefaultHighWaterMark:uS}=Ic(),{aggregateTwoErrors:g0,codes:{ERR_INVALID_ARG_TYPE:dS,ERR_METHOD_NOT_IMPLEMENTED:lS,ERR_OUT_OF_RANGE:fS,ERR_STREAM_PUSH_AFTER_EOF:hS,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:pS}}=ht(),{validateObject:yS}=Os(),_i=rS("kPaused"),{StringDecoder:E0}=f0(),mS=kl();x0(ce.prototype,Cn.prototype);x0(ce,Cn);var Kl=()=>{},{errorOrDestroy:go}=wo;function $l(r,e,t){typeof t!="boolean"&&(t=e instanceof Rr()),this.objectMode=!!(r&&r.objectMode),t&&(this.objectMode=this.objectMode||!!(r&&r.readableObjectMode)),this.highWaterMark=r?cS(this,r,"readableHighWaterMark",t):uS(!1),this.buffer=new aS,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[_i]=null,this.errorEmitted=!1,this.emitClose=!r||r.emitClose!==!1,this.autoDestroy=!r||r.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=r&&r.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,r&&r.encoding&&(this.decoder=new E0(r.encoding),this.encoding=r.encoding)}function ce(r){if(!(this instanceof ce))return new ce(r);let e=this instanceof Rr();this._readableState=new $l(r,this,e),r&&(typeof r.read=="function"&&(this._read=r.read),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.construct=="function"&&(this._construct=r.construct),r.signal&&!e&&oS(r.signal,this)),Cn.call(this,r),wo.construct(this,()=>{this._readableState.needReadable&&Bc(this,this._readableState)})}ce.prototype.destroy=wo.destroy;ce.prototype._undestroy=wo.undestroy;ce.prototype._destroy=function(r,e){e(r)};ce.prototype[nS.captureRejectionSymbol]=function(r){this.destroy(r)};ce.prototype.push=function(r,e){return v0(this,r,e,!1)};ce.prototype.unshift=function(r,e){return v0(this,r,e,!0)};function v0(r,e,t,n){le("readableAddChunk",e);let i=r._readableState,o;if(i.objectMode||(typeof e=="string"?(t=t||i.defaultEncoding,i.encoding!==t&&(n&&i.encoding?e=Pl.from(e,t).toString(i.encoding):(e=Pl.from(e,t),t=""))):e instanceof Pl?t="":Cn._isUint8Array(e)?(e=Cn._uint8ArrayToBuffer(e),t=""):e!=null&&(o=new dS("chunk",["string","Buffer","Uint8Array"],e))),o)go(r,o);else if(e===null)i.reading=!1,bS(r,i);else if(i.objectMode||e&&e.length>0)if(n)if(i.endEmitted)go(r,new pS);else{if(i.destroyed||i.errored)return!1;Ll(r,i,e,!0)}else if(i.ended)go(r,new hS);else{if(i.destroyed||i.errored)return!1;i.reading=!1,i.decoder&&!t?(e=i.decoder.write(e),i.objectMode||e.length!==0?Ll(r,i,e,!1):Bc(r,i)):Ll(r,i,e,!1)}else n||(i.reading=!1,Bc(r,i));return!i.ended&&(i.length<i.highWaterMark||i.length===0)}function Ll(r,e,t,n){e.flowing&&e.length===0&&!e.sync&&r.listenerCount("data")>0?(e.multiAwaitDrain?e.awaitDrainWriters.clear():e.awaitDrainWriters=null,e.dataEmitted=!0,r.emit("data",t)):(e.length+=e.objectMode?1:t.length,n?e.buffer.unshift(t):e.buffer.push(t),e.needReadable&&Rc(r)),Bc(r,e)}ce.prototype.isPaused=function(){let r=this._readableState;return r[_i]===!0||r.flowing===!1};ce.prototype.setEncoding=function(r){let e=new E0(r);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;let t=this._readableState.buffer,n="";for(let i of t)n+=e.write(i);return t.clear(),n!==""&&t.push(n),this._readableState.length=n.length,this};var gS=1073741824;function wS(r){if(r>gS)throw new fS("size","<= 1GiB",r);return r--,r|=r>>>1,r|=r>>>2,r|=r>>>4,r|=r>>>8,r|=r>>>16,r++,r}function w0(r,e){return r<=0||e.length===0&&e.ended?0:e.objectMode?1:Y2(r)?e.flowing&&e.length?e.buffer.first().length:e.length:r<=e.length?r:e.ended?e.length:0}ce.prototype.read=function(r){le("read",r),r===void 0?r=NaN:J2(r)||(r=X2(r,10));let e=this._readableState,t=r;if(r>e.highWaterMark&&(e.highWaterMark=wS(r)),r!==0&&(e.emittedReadable=!1),r===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return le("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?Ml(this):Rc(this),null;if(r=w0(r,e),r===0&&e.ended)return e.length===0&&Ml(this),null;let n=e.needReadable;if(le("need readable",n),(e.length===0||e.length-r<e.highWaterMark)&&(n=!0,le("length less than watermark",n)),e.ended||e.reading||e.destroyed||e.errored||!e.constructed)n=!1,le("reading, ended or constructing",n);else if(n){le("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0);try{this._read(e.highWaterMark)}catch(o){go(this,o)}e.sync=!1,e.reading||(r=w0(t,e))}let i;return r>0?i=I0(r,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,r=0):(e.length-=r,e.multiAwaitDrain?e.awaitDrainWriters.clear():e.awaitDrainWriters=null),e.length===0&&(e.ended||(e.needReadable=!0),t!==r&&e.ended&&Ml(this)),i!==null&&!e.errorEmitted&&!e.closeEmitted&&(e.dataEmitted=!0,this.emit("data",i)),i};function bS(r,e){if(le("onEofChunk"),!e.ended){if(e.decoder){let t=e.decoder.end();t&&t.length&&(e.buffer.push(t),e.length+=e.objectMode?1:t.length)}e.ended=!0,e.sync?Rc(r):(e.needReadable=!1,e.emittedReadable=!0,S0(r))}}function Rc(r){let e=r._readableState;le("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(le("emitReadable",e.flowing),e.emittedReadable=!0,ir.nextTick(S0,r))}function S0(r){let e=r._readableState;le("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&!e.errored&&(e.length||e.ended)&&(r.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,_0(r)}function Bc(r,e){!e.readingMore&&e.constructed&&(e.readingMore=!0,ir.nextTick(xS,r,e))}function xS(r,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){let t=e.length;if(le("maybeReadMore read 0"),r.read(0),t===e.length)break}e.readingMore=!1}ce.prototype._read=function(r){throw new lS("_read()")};ce.prototype.pipe=function(r,e){let t=this,n=this._readableState;n.pipes.length===1&&(n.multiAwaitDrain||(n.multiAwaitDrain=!0,n.awaitDrainWriters=new eS(n.awaitDrainWriters?[n.awaitDrainWriters]:[]))),n.pipes.push(r),le("pipe count=%d opts=%j",n.pipes.length,e);let o=(!e||e.end!==!1)&&r!==ir.stdout&&r!==ir.stderr?a:v;n.endEmitted?ir.nextTick(o):t.once("end",o),r.on("unpipe",s);function s(S,D){le("onunpipe"),S===t&&D&&D.hasUnpiped===!1&&(D.hasUnpiped=!0,u())}function a(){le("onend"),r.end()}let c,d=!1;function u(){le("cleanup"),r.removeListener("close",p),r.removeListener("finish",b),c&&r.removeListener("drain",c),r.removeListener("error",w),r.removeListener("unpipe",s),t.removeListener("end",a),t.removeListener("end",v),t.removeListener("data",m),d=!0,c&&n.awaitDrainWriters&&(!r._writableState||r._writableState.needDrain)&&c()}function h(){d||(n.pipes.length===1&&n.pipes[0]===r?(le("false write response, pause",0),n.awaitDrainWriters=r,n.multiAwaitDrain=!1):n.pipes.length>1&&n.pipes.includes(r)&&(le("false write response, pause",n.awaitDrainWriters.size),n.awaitDrainWriters.add(r)),t.pause()),c||(c=ES(t,r),r.on("drain",c))}t.on("data",m);function m(S){le("ondata");let D=r.write(S);le("dest.write",D),D===!1&&h()}function w(S){if(le("onerror",S),v(),r.removeListener("error",w),r.listenerCount("error")===0){let D=r._writableState||r._readableState;D&&!D.errorEmitted?go(r,S):r.emit("error",S)}}iS(r,"error",w);function p(){r.removeListener("finish",b),v()}r.once("close",p);function b(){le("onfinish"),r.removeListener("close",p),v()}r.once("finish",b);function v(){le("unpipe"),t.unpipe(r)}return r.emit("pipe",t),r.writableNeedDrain===!0?n.flowing&&h():n.flowing||(le("pipe resume"),t.resume()),r};function ES(r,e){return function(){let n=r._readableState;n.awaitDrainWriters===e?(le("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(le("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(e)),(!n.awaitDrainWriters||n.awaitDrainWriters.size===0)&&r.listenerCount("data")&&r.resume()}}ce.prototype.unpipe=function(r){let e=this._readableState,t={hasUnpiped:!1};if(e.pipes.length===0)return this;if(!r){let i=e.pipes;e.pipes=[],this.pause();for(let o=0;o<i.length;o++)i[o].emit("unpipe",this,{hasUnpiped:!1});return this}let n=G2(e.pipes,r);return n===-1?this:(e.pipes.splice(n,1),e.pipes.length===0&&this.pause(),r.emit("unpipe",this,t),this)};ce.prototype.on=function(r,e){let t=Cn.prototype.on.call(this,r,e),n=this._readableState;return r==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):r==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,le("on readable",n.length,n.reading),n.length?Rc(this):n.reading||ir.nextTick(vS,this)),t};ce.prototype.addListener=ce.prototype.on;ce.prototype.removeListener=function(r,e){let t=Cn.prototype.removeListener.call(this,r,e);return r==="readable"&&ir.nextTick(A0,this),t};ce.prototype.off=ce.prototype.removeListener;ce.prototype.removeAllListeners=function(r){let e=Cn.prototype.removeAllListeners.apply(this,arguments);return(r==="readable"||r===void 0)&&ir.nextTick(A0,this),e};function A0(r){let e=r._readableState;e.readableListening=r.listenerCount("readable")>0,e.resumeScheduled&&e[_i]===!1?e.flowing=!0:r.listenerCount("data")>0?r.resume():e.readableListening||(e.flowing=null)}function vS(r){le("readable nexttick read 0"),r.read(0)}ce.prototype.resume=function(){let r=this._readableState;return r.flowing||(le("resume"),r.flowing=!r.readableListening,SS(this,r)),r[_i]=!1,this};function SS(r,e){e.resumeScheduled||(e.resumeScheduled=!0,ir.nextTick(AS,r,e))}function AS(r,e){le("resume",e.reading),e.reading||r.read(0),e.resumeScheduled=!1,r.emit("resume"),_0(r),e.flowing&&!e.reading&&r.read(0)}ce.prototype.pause=function(){return le("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(le("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[_i]=!0,this};function _0(r){let e=r._readableState;for(le("flow",e.flowing);e.flowing&&r.read()!==null;);}ce.prototype.wrap=function(r){let e=!1;r.on("data",n=>{!this.push(n)&&r.pause&&(e=!0,r.pause())}),r.on("end",()=>{this.push(null)}),r.on("error",n=>{go(this,n)}),r.on("close",()=>{this.destroy()}),r.on("destroy",()=>{this.destroy()}),this._read=()=>{e&&r.resume&&(e=!1,r.resume())};let t=Z2(r);for(let n=1;n<t.length;n++){let i=t[n];this[i]===void 0&&typeof r[i]=="function"&&(this[i]=r[i].bind(r))}return this};ce.prototype[tS]=function(){return T0(this)};ce.prototype.iterator=function(r){return r!==void 0&&yS(r,"options"),T0(this,r)};function T0(r,e){typeof r.read!="function"&&(r=ce.wrap(r,{objectMode:!0}));let t=_S(r,e);return t.stream=r,t}async function*_S(r,e){let t=Kl;function n(s){this===r?(t(),t=Kl):t=s}r.on("readable",n);let i,o=sS(r,{writable:!1},s=>{i=s?g0(i,s):null,t(),t=Kl});try{for(;;){let s=r.destroyed?null:r.read();if(s!==null)yield s;else{if(i)throw i;if(i===null)return;await new Q2(n)}}}catch(s){throw i=g0(i,s),i}finally{(i||e?.destroyOnReturn!==!1)&&(i===void 0||r._readableState.autoDestroy)?wo.destroyer(r,null):(r.off("readable",n),o())}}b0(ce.prototype,{readable:{__proto__:null,get(){let r=this._readableState;return!!r&&r.readable!==!1&&!r.destroyed&&!r.errorEmitted&&!r.endEmitted},set(r){this._readableState&&(this._readableState.readable=!!r)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(r){this._readableState&&(this._readableState.flowing=r)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(r){this._readableState&&(this._readableState.destroyed=r)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}});b0($l.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[_i]!==!1},set(r){this[_i]=!!r}}});ce._fromList=I0;function I0(r,e){if(e.length===0)return null;let t;return e.objectMode?t=e.buffer.shift():!r||r>=e.length?(e.decoder?t=e.buffer.join(""):e.buffer.length===1?t=e.buffer.first():t=e.buffer.concat(e.length),e.buffer.clear()):t=e.buffer.consume(r,e.decoder),t}function Ml(r){let e=r._readableState;le("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,ir.nextTick(TS,e,r))}function TS(r,e){if(le("endReadableNT",r.endEmitted,r.length),!r.errored&&!r.closeEmitted&&!r.endEmitted&&r.length===0){if(r.endEmitted=!0,e.emit("end"),e.writable&&e.allowHalfOpen===!1)ir.nextTick(IS,e);else if(r.autoDestroy){let t=e._writableState;(!t||t.autoDestroy&&(t.finished||t.writable===!1))&&e.destroy()}}}function IS(r){r.writable&&!r.writableEnded&&!r.destroyed&&r.end()}ce.from=function(r,e){return mS(ce,r,e)};var Nl;function D0(){return Nl===void 0&&(Nl={}),Nl}ce.fromWeb=function(r,e){return D0().newStreamReadableFromReadableStream(r,e)};ce.toWeb=function(r,e){return D0().newReadableStreamFromStreamReadable(r,e)};ce.wrap=function(r,e){var t,n;return new ce({objectMode:(t=(n=r.readableObjectMode)!==null&&n!==void 0?n:r.objectMode)!==null&&t!==void 0?t:!0,...e,destroy(i,o){wo.destroyer(r,i),o(i)}}).wrap(r)}});var zl=N((D6,q0)=>{var B6=l(f()),Ti=On(),{ArrayPrototypeSlice:U0,Error:DS,FunctionPrototypeSymbolHasInstance:C0,ObjectDefineProperty:k0,ObjectDefineProperties:BS,ObjectSetPrototypeOf:P0,StringPrototypeToLowerCase:RS,Symbol:OS,SymbolHasInstance:US}=He();q0.exports=ke;ke.WritableState=Ls;var{EventEmitter:CS}=ps(),Ps=Ac().Stream,{Buffer:Oc}=xt(),kc=Si(),{addAbortSignal:kS}=Us(),{getHighWaterMark:PS,getDefaultHighWaterMark:KS}=Ic(),{ERR_INVALID_ARG_TYPE:LS,ERR_METHOD_NOT_IMPLEMENTED:MS,ERR_MULTIPLE_CALLBACK:K0,ERR_STREAM_CANNOT_PIPE:NS,ERR_STREAM_DESTROYED:Ks,ERR_STREAM_ALREADY_FINISHED:$S,ERR_STREAM_NULL_VALUES:qS,ERR_STREAM_WRITE_AFTER_END:FS,ERR_UNKNOWN_ENCODING:L0}=ht().codes,{errorOrDestroy:bo}=kc;P0(ke.prototype,Ps.prototype);P0(ke,Ps);function Vl(){}var xo=OS("kOnFinished");function Ls(r,e,t){typeof t!="boolean"&&(t=e instanceof Rr()),this.objectMode=!!(r&&r.objectMode),t&&(this.objectMode=this.objectMode||!!(r&&r.writableObjectMode)),this.highWaterMark=r?PS(this,r,"writableHighWaterMark",t):KS(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let n=!!(r&&r.decodeStrings===!1);this.decodeStrings=!n,this.defaultEncoding=r&&r.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=HS.bind(void 0,e),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,Cc(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!r||r.emitClose!==!1,this.autoDestroy=!r||r.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[xo]=[]}function Cc(r){r.buffered=[],r.bufferedIndex=0,r.allBuffers=!0,r.allNoop=!0}Ls.prototype.getBuffer=function(){return U0(this.buffered,this.bufferedIndex)};k0(Ls.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function ke(r){let e=this instanceof Rr();if(!e&&!C0(ke,this))return new ke(r);this._writableState=new Ls(r,this,e),r&&(typeof r.write=="function"&&(this._write=r.write),typeof r.writev=="function"&&(this._writev=r.writev),typeof r.destroy=="function"&&(this._destroy=r.destroy),typeof r.final=="function"&&(this._final=r.final),typeof r.construct=="function"&&(this._construct=r.construct),r.signal&&kS(r.signal,this)),Ps.call(this,r),kc.construct(this,()=>{let t=this._writableState;t.writing||jl(this,t),Wl(this,t)})}k0(ke,US,{__proto__:null,value:function(r){return C0(this,r)?!0:this!==ke?!1:r&&r._writableState instanceof Ls}});ke.prototype.pipe=function(){bo(this,new NS)};function M0(r,e,t,n){let i=r._writableState;if(typeof t=="function")n=t,t=i.defaultEncoding;else{if(!t)t=i.defaultEncoding;else if(t!=="buffer"&&!Oc.isEncoding(t))throw new L0(t);typeof n!="function"&&(n=Vl)}if(e===null)throw new qS;if(!i.objectMode)if(typeof e=="string")i.decodeStrings!==!1&&(e=Oc.from(e,t),t="buffer");else if(e instanceof Oc)t="buffer";else if(Ps._isUint8Array(e))e=Ps._uint8ArrayToBuffer(e),t="buffer";else throw new LS("chunk",["string","Buffer","Uint8Array"],e);let o;return i.ending?o=new FS:i.destroyed&&(o=new Ks("write")),o?(Ti.nextTick(n,o),bo(r,o,!0),o):(i.pendingcb++,VS(r,i,e,t,n))}ke.prototype.write=function(r,e,t){return M0(this,r,e,t)===!0};ke.prototype.cork=function(){this._writableState.corked++};ke.prototype.uncork=function(){let r=this._writableState;r.corked&&(r.corked--,r.writing||jl(this,r))};ke.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=RS(e)),!Oc.isEncoding(e))throw new L0(e);return this._writableState.defaultEncoding=e,this};function VS(r,e,t,n,i){let o=e.objectMode?1:t.length;e.length+=o;let s=e.length<e.highWaterMark;return s||(e.needDrain=!0),e.writing||e.corked||e.errored||!e.constructed?(e.buffered.push({chunk:t,encoding:n,callback:i}),e.allBuffers&&n!=="buffer"&&(e.allBuffers=!1),e.allNoop&&i!==Vl&&(e.allNoop=!1)):(e.writelen=o,e.writecb=i,e.writing=!0,e.sync=!0,r._write(t,n,e.onwrite),e.sync=!1),s&&!e.errored&&!e.destroyed}function R0(r,e,t,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new Ks("write")):t?r._writev(i,e.onwrite):r._write(i,o,e.onwrite),e.sync=!1}function O0(r,e,t,n){--e.pendingcb,n(t),Hl(e),bo(r,t)}function HS(r,e){let t=r._writableState,n=t.sync,i=t.writecb;if(typeof i!="function"){bo(r,new K0);return}t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0,e?(e.stack,t.errored||(t.errored=e),r._readableState&&!r._readableState.errored&&(r._readableState.errored=e),n?Ti.nextTick(O0,r,t,e,i):O0(r,t,e,i)):(t.buffered.length>t.bufferedIndex&&jl(r,t),n?t.afterWriteTickInfo!==null&&t.afterWriteTickInfo.cb===i?t.afterWriteTickInfo.count++:(t.afterWriteTickInfo={count:1,cb:i,stream:r,state:t},Ti.nextTick(jS,t.afterWriteTickInfo)):N0(r,t,1,i))}function jS({stream:r,state:e,count:t,cb:n}){return e.afterWriteTickInfo=null,N0(r,e,t,n)}function N0(r,e,t,n){for(!e.ending&&!r.destroyed&&e.length===0&&e.needDrain&&(e.needDrain=!1,r.emit("drain"));t-- >0;)e.pendingcb--,n();e.destroyed&&Hl(e),Wl(r,e)}function Hl(r){if(r.writing)return;for(let i=r.bufferedIndex;i<r.buffered.length;++i){var e;let{chunk:o,callback:s}=r.buffered[i],a=r.objectMode?1:o.length;r.length-=a,s((e=r.errored)!==null&&e!==void 0?e:new Ks("write"))}let t=r[xo].splice(0);for(let i=0;i<t.length;i++){var n;t[i]((n=r.errored)!==null&&n!==void 0?n:new Ks("end"))}Cc(r)}function jl(r,e){if(e.corked||e.bufferProcessing||e.destroyed||!e.constructed)return;let{buffered:t,bufferedIndex:n,objectMode:i}=e,o=t.length-n;if(!o)return;let s=n;if(e.bufferProcessing=!0,o>1&&r._writev){e.pendingcb-=o-1;let a=e.allNoop?Vl:d=>{for(let u=s;u<t.length;++u)t[u].callback(d)},c=e.allNoop&&s===0?t:U0(t,s);c.allBuffers=e.allBuffers,R0(r,e,!0,e.length,c,"",a),Cc(e)}else{do{let{chunk:a,encoding:c,callback:d}=t[s];t[s++]=null;let u=i?1:a.length;R0(r,e,!1,u,a,c,d)}while(s<t.length&&!e.writing);s===t.length?Cc(e):s>256?(t.splice(0,s),e.bufferedIndex=0):e.bufferedIndex=s}e.bufferProcessing=!1}ke.prototype._write=function(r,e,t){if(this._writev)this._writev([{chunk:r,encoding:e}],t);else throw new MS("_write()")};ke.prototype._writev=null;ke.prototype.end=function(r,e,t){let n=this._writableState;typeof r=="function"?(t=r,r=null,e=null):typeof e=="function"&&(t=e,e=null);let i;if(r!=null){let o=M0(this,r,e);o instanceof DS&&(i=o)}return n.corked&&(n.corked=1,this.uncork()),i||(!n.errored&&!n.ending?(n.ending=!0,Wl(this,n,!0),n.ended=!0):n.finished?i=new $S("end"):n.destroyed&&(i=new Ks("end"))),typeof t=="function"&&(i||n.finished?Ti.nextTick(t,i):n[xo].push(t)),this};function Uc(r){return r.ending&&!r.destroyed&&r.constructed&&r.length===0&&!r.errored&&r.buffered.length===0&&!r.finished&&!r.writing&&!r.errorEmitted&&!r.closeEmitted}function WS(r,e){let t=!1;function n(i){if(t){bo(r,i??K0());return}if(t=!0,e.pendingcb--,i){let o=e[xo].splice(0);for(let s=0;s<o.length;s++)o[s](i);bo(r,i,e.sync)}else Uc(e)&&(e.prefinished=!0,r.emit("prefinish"),e.pendingcb++,Ti.nextTick(Fl,r,e))}e.sync=!0,e.pendingcb++;try{r._final(n)}catch(i){n(i)}e.sync=!1}function zS(r,e){!e.prefinished&&!e.finalCalled&&(typeof r._final=="function"&&!e.destroyed?(e.finalCalled=!0,WS(r,e)):(e.prefinished=!0,r.emit("prefinish")))}function Wl(r,e,t){Uc(e)&&(zS(r,e),e.pendingcb===0&&(t?(e.pendingcb++,Ti.nextTick((n,i)=>{Uc(i)?Fl(n,i):i.pendingcb--},r,e)):Uc(e)&&(e.pendingcb++,Fl(r,e))))}function Fl(r,e){e.pendingcb--,e.finished=!0;let t=e[xo].splice(0);for(let n=0;n<t.length;n++)t[n]();if(r.emit("finish"),e.autoDestroy){let n=r._readableState;(!n||n.autoDestroy&&(n.endEmitted||n.readable===!1))&&r.destroy()}}BS(ke.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(r){this._writableState&&(this._writableState.destroyed=r)}},writable:{__proto__:null,get(){let r=this._writableState;return!!r&&r.writable!==!1&&!r.destroyed&&!r.errored&&!r.ending&&!r.ended},set(r){this._writableState&&(this._writableState.writable=!!r)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){let r=this._writableState;return r?!r.destroyed&&!r.ending&&r.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});var GS=kc.destroy;ke.prototype.destroy=function(r,e){let t=this._writableState;return!t.destroyed&&(t.bufferedIndex<t.buffered.length||t[xo].length)&&Ti.nextTick(Hl,t),GS.call(this,r,e),this};ke.prototype._undestroy=kc.undestroy;ke.prototype._destroy=function(r,e){e(r)};ke.prototype[CS.captureRejectionSymbol]=function(r){this.destroy(r)};var ql;function $0(){return ql===void 0&&(ql={}),ql}ke.fromWeb=function(r,e){return $0().newStreamWritableFromWritableStream(r,e)};ke.toWeb=function(r){return $0().newWritableStreamFromStreamWritable(r)}});var Q0=N((R6,Z0)=>{var O6=l(f()),Gl=On(),JS=xt(),{isReadable:YS,isWritable:XS,isIterable:F0,isNodeStream:ZS,isReadableNodeStream:V0,isWritableNodeStream:H0,isDuplexNodeStream:QS}=Ir(),j0=rn(),{AbortError:X0,codes:{ERR_INVALID_ARG_TYPE:eA,ERR_INVALID_RETURN_VALUE:W0}}=ht(),{destroyer:Eo}=Si(),tA=Rr(),rA=ks(),{createDeferredPromise:z0}=Sr(),G0=kl(),J0=globalThis.Blob||JS.Blob,nA=typeof J0<"u"?function(e){return e instanceof J0}:function(e){return!1},iA=globalThis.AbortController||pc().AbortController,{FunctionPrototypeCall:Y0}=He(),Ii=class extends tA{constructor(e){super(e),e?.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),e?.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};Z0.exports=function r(e,t){if(QS(e))return e;if(V0(e))return Pc({readable:e});if(H0(e))return Pc({writable:e});if(ZS(e))return Pc({writable:!1,readable:!1});if(typeof e=="function"){let{value:i,write:o,final:s,destroy:a}=oA(e);if(F0(i))return G0(Ii,i,{objectMode:!0,write:o,final:s,destroy:a});let c=i?.then;if(typeof c=="function"){let d,u=Y0(c,i,h=>{if(h!=null)throw new W0("nully","body",h)},h=>{Eo(d,h)});return d=new Ii({objectMode:!0,readable:!1,write:o,final(h){s(async()=>{try{await u,Gl.nextTick(h,null)}catch(m){Gl.nextTick(h,m)}})},destroy:a})}throw new W0("Iterable, AsyncIterable or AsyncFunction",t,i)}if(nA(e))return r(e.arrayBuffer());if(F0(e))return G0(Ii,e,{objectMode:!0,writable:!1});if(typeof e?.writable=="object"||typeof e?.readable=="object"){let i=e!=null&&e.readable?V0(e?.readable)?e?.readable:r(e.readable):void 0,o=e!=null&&e.writable?H0(e?.writable)?e?.writable:r(e.writable):void 0;return Pc({readable:i,writable:o})}let n=e?.then;if(typeof n=="function"){let i;return Y0(n,e,o=>{o!=null&&i.push(o),i.push(null)},o=>{Eo(i,o)}),i=new Ii({objectMode:!0,writable:!1,read(){}})}throw new eA(t,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],e)};function oA(r){let{promise:e,resolve:t}=z0(),n=new iA,i=n.signal;return{value:r(async function*(){for(;;){let s=e;e=null;let{chunk:a,done:c,cb:d}=await s;if(Gl.nextTick(d),c)return;if(i.aborted)throw new X0(void 0,{cause:i.reason});({promise:e,resolve:t}=z0()),yield a}}(),{signal:i}),write(s,a,c){let d=t;t=null,d({chunk:s,done:!1,cb:c})},final(s){let a=t;t=null,a({done:!0,cb:s})},destroy(s,a){n.abort(),a(s)}}}function Pc(r){let e=r.readable&&typeof r.readable.read!="function"?rA.wrap(r.readable):r.readable,t=r.writable,n=!!YS(e),i=!!XS(t),o,s,a,c,d;function u(h){let m=c;c=null,m?m(h):h&&d.destroy(h)}return d=new Ii({readableObjectMode:!!(e!=null&&e.readableObjectMode),writableObjectMode:!!(t!=null&&t.writableObjectMode),readable:n,writable:i}),i&&(j0(t,h=>{i=!1,h&&Eo(e,h),u(h)}),d._write=function(h,m,w){t.write(h,m)?w():o=w},d._final=function(h){t.end(),s=h},t.on("drain",function(){if(o){let h=o;o=null,h()}}),t.on("finish",function(){if(s){let h=s;s=null,h()}})),n&&(j0(e,h=>{n=!1,h&&Eo(e,h),u(h)}),e.on("readable",function(){if(a){let h=a;a=null,h()}}),e.on("end",function(){d.push(null)}),d._read=function(){for(;;){let h=e.read();if(h===null){a=d._read;return}if(!d.push(h))return}}),d._destroy=function(h,m){!h&&c!==null&&(h=new X0),a=null,o=null,s=null,c===null?m(h):(c=m,Eo(t,h),Eo(e,h))},d}});var Rr=N((U6,rg)=>{"use strict";var C6=l(f()),{ObjectDefineProperties:sA,ObjectGetOwnPropertyDescriptor:nn,ObjectKeys:aA,ObjectSetPrototypeOf:eg}=He();rg.exports=or;var Xl=ks(),zt=zl();eg(or.prototype,Xl.prototype);eg(or,Xl);{let r=aA(zt.prototype);for(let e=0;e<r.length;e++){let t=r[e];or.prototype[t]||(or.prototype[t]=zt.prototype[t])}}function or(r){if(!(this instanceof or))return new or(r);Xl.call(this,r),zt.call(this,r),r?(this.allowHalfOpen=r.allowHalfOpen!==!1,r.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),r.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}sA(or.prototype,{writable:{__proto__:null,...nn(zt.prototype,"writable")},writableHighWaterMark:{__proto__:null,...nn(zt.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...nn(zt.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...nn(zt.prototype,"writableBuffer")},writableLength:{__proto__:null,...nn(zt.prototype,"writableLength")},writableFinished:{__proto__:null,...nn(zt.prototype,"writableFinished")},writableCorked:{__proto__:null,...nn(zt.prototype,"writableCorked")},writableEnded:{__proto__:null,...nn(zt.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...nn(zt.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(r){this._readableState&&this._writableState&&(this._readableState.destroyed=r,this._writableState.destroyed=r)}}});var Jl;function tg(){return Jl===void 0&&(Jl={}),Jl}or.fromWeb=function(r,e){return tg().newStreamDuplexFromReadableWritablePair(r,e)};or.toWeb=function(r){return tg().newReadableWritablePairFromDuplex(r)};var Yl;or.from=function(r){return Yl||(Yl=Q0()),Yl(r,"body")}});var ef=N((k6,ig)=>{"use strict";var P6=l(f()),{ObjectSetPrototypeOf:ng,Symbol:cA}=He();ig.exports=on;var{ERR_METHOD_NOT_IMPLEMENTED:uA}=ht().codes,Ql=Rr(),{getHighWaterMark:dA}=Ic();ng(on.prototype,Ql.prototype);ng(on,Ql);var Ms=cA("kCallback");function on(r){if(!(this instanceof on))return new on(r);let e=r?dA(this,r,"readableHighWaterMark",!0):null;e===0&&(r={...r,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:r.writableHighWaterMark||0}),Ql.call(this,r),this._readableState.sync=!1,this[Ms]=null,r&&(typeof r.transform=="function"&&(this._transform=r.transform),typeof r.flush=="function"&&(this._flush=r.flush)),this.on("prefinish",lA)}function Zl(r){typeof this._flush=="function"&&!this.destroyed?this._flush((e,t)=>{if(e){r?r(e):this.destroy(e);return}t!=null&&this.push(t),this.push(null),r&&r()}):(this.push(null),r&&r())}function lA(){this._final!==Zl&&Zl.call(this)}on.prototype._final=Zl;on.prototype._transform=function(r,e,t){throw new uA("_transform()")};on.prototype._write=function(r,e,t){let n=this._readableState,i=this._writableState,o=n.length;this._transform(r,e,(s,a)=>{if(s){t(s);return}a!=null&&this.push(a),i.ended||o===n.length||n.length<n.highWaterMark?t():this[Ms]=t})};on.prototype._read=function(){if(this[Ms]){let r=this[Ms];this[Ms]=null,r()}}});var rf=N((K6,sg)=>{"use strict";var L6=l(f()),{ObjectSetPrototypeOf:og}=He();sg.exports=vo;var tf=ef();og(vo.prototype,tf.prototype);og(vo,tf);function vo(r){if(!(this instanceof vo))return new vo(r);tf.call(this,r)}vo.prototype._transform=function(r,e,t){t(null,r)}});var Nc=N((M6,lg)=>{var N6=l(f()),Ns=On(),{ArrayIsArray:fA,Promise:hA,SymbolAsyncIterator:pA}=He(),Mc=rn(),{once:yA}=Sr(),mA=Si(),ag=Rr(),{aggregateTwoErrors:gA,codes:{ERR_INVALID_ARG_TYPE:lf,ERR_INVALID_RETURN_VALUE:nf,ERR_MISSING_ARGS:wA,ERR_STREAM_DESTROYED:bA,ERR_STREAM_PREMATURE_CLOSE:xA},AbortError:EA}=ht(),{validateFunction:vA,validateAbortSignal:SA}=Os(),{isIterable:Di,isReadable:of,isReadableNodeStream:Lc,isNodeStream:cg,isTransformStream:So,isWebStream:AA,isReadableStream:sf,isReadableEnded:_A}=Ir(),TA=globalThis.AbortController||pc().AbortController,af,cf;function ug(r,e,t){let n=!1;r.on("close",()=>{n=!0});let i=Mc(r,{readable:e,writable:t},o=>{n=!o});return{destroy:o=>{n||(n=!0,mA.destroyer(r,o||new bA("pipe")))},cleanup:i}}function IA(r){return vA(r[r.length-1],"streams[stream.length - 1]"),r.pop()}function uf(r){if(Di(r))return r;if(Lc(r))return DA(r);throw new lf("val",["Readable","Iterable","AsyncIterable"],r)}async function*DA(r){cf||(cf=ks()),yield*cf.prototype[pA].call(r)}async function Kc(r,e,t,{end:n}){let i,o=null,s=d=>{if(d&&(i=d),o){let u=o;o=null,u()}},a=()=>new hA((d,u)=>{i?u(i):o=()=>{i?u(i):d()}});e.on("drain",s);let c=Mc(e,{readable:!1},s);try{e.writableNeedDrain&&await a();for await(let d of r)e.write(d)||await a();n&&e.end(),await a(),t()}catch(d){t(i!==d?gA(i,d):d)}finally{c(),e.off("drain",s)}}async function df(r,e,t,{end:n}){So(e)&&(e=e.writable);let i=e.getWriter();try{for await(let o of r)await i.ready,i.write(o).catch(()=>{});await i.ready,n&&await i.close(),t()}catch(o){try{await i.abort(o),t(o)}catch(s){t(s)}}}function BA(...r){return dg(r,yA(IA(r)))}function dg(r,e,t){if(r.length===1&&fA(r[0])&&(r=r[0]),r.length<2)throw new wA("streams");let n=new TA,i=n.signal,o=t?.signal,s=[];SA(o,"options.signal");function a(){w(new EA)}o?.addEventListener("abort",a);let c,d,u=[],h=0;function m(D){w(D,--h===0)}function w(D,E){if(D&&(!c||c.code==="ERR_STREAM_PREMATURE_CLOSE")&&(c=D),!(!c&&!E)){for(;u.length;)u.shift()(c);o?.removeEventListener("abort",a),n.abort(),E&&(c||s.forEach(R=>R()),Ns.nextTick(e,c,d))}}let p;for(let D=0;D<r.length;D++){let E=r[D],R=D<r.length-1,I=D>0,O=R||t?.end!==!1,C=D===r.length-1;if(cg(E)){let U=function(V){V&&V.name!=="AbortError"&&V.code!=="ERR_STREAM_PREMATURE_CLOSE"&&m(V)};var S=U;if(O){let{destroy:V,cleanup:H}=ug(E,R,I);u.push(V),of(E)&&C&&s.push(H)}E.on("error",U),of(E)&&C&&s.push(()=>{E.removeListener("error",U)})}if(D===0)if(typeof E=="function"){if(p=E({signal:i}),!Di(p))throw new nf("Iterable, AsyncIterable or Stream","source",p)}else Di(E)||Lc(E)||So(E)?p=E:p=ag.from(E);else if(typeof E=="function"){if(So(p)){var b;p=uf((b=p)===null||b===void 0?void 0:b.readable)}else p=uf(p);if(p=E(p,{signal:i}),R){if(!Di(p,!0))throw new nf("AsyncIterable",`transform[${D-1}]`,p)}else{var v;af||(af=rf());let U=new af({objectMode:!0}),V=(v=p)===null||v===void 0?void 0:v.then;if(typeof V=="function")h++,V.call(p,Q=>{d=Q,Q!=null&&U.write(Q),O&&U.end(),Ns.nextTick(m)},Q=>{U.destroy(Q),Ns.nextTick(m,Q)});else if(Di(p,!0))h++,Kc(p,U,m,{end:O});else if(sf(p)||So(p)){let Q=p.readable||p;h++,Kc(Q,U,m,{end:O})}else throw new nf("AsyncIterable or Promise","destination",p);p=U;let{destroy:H,cleanup:W}=ug(p,!1,!0);u.push(H),C&&s.push(W)}}else if(cg(E)){if(Lc(p)){h+=2;let U=RA(p,E,m,{end:O});of(E)&&C&&s.push(U)}else if(So(p)||sf(p)){let U=p.readable||p;h++,Kc(U,E,m,{end:O})}else if(Di(p))h++,Kc(p,E,m,{end:O});else throw new lf("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],p);p=E}else if(AA(E)){if(Lc(p))h++,df(uf(p),E,m,{end:O});else if(sf(p)||Di(p))h++,df(p,E,m,{end:O});else if(So(p))h++,df(p.readable,E,m,{end:O});else throw new lf("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],p);p=E}else p=ag.from(E)}return(i!=null&&i.aborted||o!=null&&o.aborted)&&Ns.nextTick(a),p}function RA(r,e,t,{end:n}){let i=!1;if(e.on("close",()=>{i||t(new xA)}),r.pipe(e,{end:!1}),n){let s=function(){i=!0,e.end()};var o=s;_A(r)?Ns.nextTick(s):r.once("end",s)}else t();return Mc(r,{readable:!0,writable:!1},s=>{let a=r._readableState;s&&s.code==="ERR_STREAM_PREMATURE_CLOSE"&&a&&a.ended&&!a.errored&&!a.errorEmitted?r.once("end",t).once("error",t):t(s)}),Mc(e,{readable:!1,writable:!0},t)}lg.exports={pipelineImpl:dg,pipeline:BA}});var hf=N(($6,gg)=>{"use strict";var q6=l(f()),{pipeline:OA}=Nc(),$c=Rr(),{destroyer:UA}=Si(),{isNodeStream:qc,isReadable:fg,isWritable:hg,isWebStream:ff,isTransformStream:Bi,isWritableStream:pg,isReadableStream:yg}=Ir(),{AbortError:CA,codes:{ERR_INVALID_ARG_VALUE:mg,ERR_MISSING_ARGS:kA}}=ht(),PA=rn();gg.exports=function(...e){if(e.length===0)throw new kA("streams");if(e.length===1)return $c.from(e[0]);let t=[...e];if(typeof e[0]=="function"&&(e[0]=$c.from(e[0])),typeof e[e.length-1]=="function"){let w=e.length-1;e[w]=$c.from(e[w])}for(let w=0;w<e.length;++w)if(!(!qc(e[w])&&!ff(e[w]))){if(w<e.length-1&&!(fg(e[w])||yg(e[w])||Bi(e[w])))throw new mg(`streams[${w}]`,t[w],"must be readable");if(w>0&&!(hg(e[w])||pg(e[w])||Bi(e[w])))throw new mg(`streams[${w}]`,t[w],"must be writable")}let n,i,o,s,a;function c(w){let p=s;s=null,p?p(w):w?a.destroy(w):!m&&!h&&a.destroy()}let d=e[0],u=OA(e,c),h=!!(hg(d)||pg(d)||Bi(d)),m=!!(fg(u)||yg(u)||Bi(u));if(a=new $c({writableObjectMode:!!(d!=null&&d.writableObjectMode),readableObjectMode:!!(u!=null&&u.writableObjectMode),writable:h,readable:m}),h){if(qc(d))a._write=function(p,b,v){d.write(p,b)?v():n=v},a._final=function(p){d.end(),i=p},d.on("drain",function(){if(n){let p=n;n=null,p()}});else if(ff(d)){let b=(Bi(d)?d.writable:d).getWriter();a._write=async function(v,S,D){try{await b.ready,b.write(v).catch(()=>{}),D()}catch(E){D(E)}},a._final=async function(v){try{await b.ready,b.close().catch(()=>{}),i=v}catch(S){v(S)}}}let w=Bi(u)?u.readable:u;PA(w,()=>{if(i){let p=i;i=null,p()}})}if(m){if(qc(u))u.on("readable",function(){if(o){let w=o;o=null,w()}}),u.on("end",function(){a.push(null)}),a._read=function(){for(;;){let w=u.read();if(w===null){o=a._read;return}if(!a.push(w))return}};else if(ff(u)){let p=(Bi(u)?u.readable:u).getReader();a._read=async function(){for(;;)try{let{value:b,done:v}=await p.read();if(!a.push(b))return;if(v){a.push(null);return}}catch{return}}}}return a._destroy=function(w,p){!w&&s!==null&&(w=new CA),o=null,n=null,i=null,s===null?p(w):(s=p,qc(u)&&UA(u,w))},a}});var _g=N((F6,mf)=>{"use strict";var V6=l(f()),Eg=globalThis.AbortController||pc().AbortController,{codes:{ERR_INVALID_ARG_VALUE:KA,ERR_INVALID_ARG_TYPE:$s,ERR_MISSING_ARGS:LA,ERR_OUT_OF_RANGE:MA},AbortError:Or}=ht(),{validateAbortSignal:Ri,validateInteger:NA,validateObject:Oi}=Os(),$A=He().Symbol("kWeak"),{finished:qA}=rn(),FA=hf(),{addAbortSignalNoValidate:VA}=Us(),{isWritable:HA,isNodeStream:jA}=Ir(),{ArrayPrototypePush:WA,MathFloor:zA,Number:GA,NumberIsNaN:JA,Promise:wg,PromiseReject:bg,PromisePrototypeThen:YA,Symbol:vg}=He(),Fc=vg("kEmpty"),xg=vg("kEof");function XA(r,e){if(e!=null&&Oi(e,"options"),e?.signal!=null&&Ri(e.signal,"options.signal"),jA(r)&&!HA(r))throw new KA("stream",r,"must be writable");let t=FA(this,r);return e!=null&&e.signal&&VA(e.signal,t),t}function Vc(r,e){if(typeof r!="function")throw new $s("fn",["Function","AsyncFunction"],r);e!=null&&Oi(e,"options"),e?.signal!=null&&Ri(e.signal,"options.signal");let t=1;return e?.concurrency!=null&&(t=zA(e.concurrency)),NA(t,"concurrency",1),(async function*(){var i,o;let s=new Eg,a=this,c=[],d=s.signal,u={signal:d},h=()=>s.abort();e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted&&h(),e==null||(o=e.signal)===null||o===void 0||o.addEventListener("abort",h);let m,w,p=!1;function b(){p=!0}async function v(){try{for await(let E of a){var S;if(p)return;if(d.aborted)throw new Or;try{E=r(E,u)}catch(R){E=bg(R)}E!==Fc&&(typeof((S=E)===null||S===void 0?void 0:S.catch)=="function"&&E.catch(b),c.push(E),m&&(m(),m=null),!p&&c.length&&c.length>=t&&await new wg(R=>{w=R}))}c.push(xg)}catch(E){let R=bg(E);YA(R,void 0,b),c.push(R)}finally{var D;p=!0,m&&(m(),m=null),e==null||(D=e.signal)===null||D===void 0||D.removeEventListener("abort",h)}}v();try{for(;;){for(;c.length>0;){let S=await c[0];if(S===xg)return;if(d.aborted)throw new Or;S!==Fc&&(yield S),c.shift(),w&&(w(),w=null)}await new wg(S=>{m=S})}}finally{s.abort(),p=!0,w&&(w(),w=null)}}).call(this)}function ZA(r=void 0){return r!=null&&Oi(r,"options"),r?.signal!=null&&Ri(r.signal,"options.signal"),(async function*(){let t=0;for await(let i of this){var n;if(r!=null&&(n=r.signal)!==null&&n!==void 0&&n.aborted)throw new Or({cause:r.signal.reason});yield[t++,i]}}).call(this)}async function Sg(r,e=void 0){for await(let t of yf.call(this,r,e))return!0;return!1}async function QA(r,e=void 0){if(typeof r!="function")throw new $s("fn",["Function","AsyncFunction"],r);return!await Sg.call(this,async(...t)=>!await r(...t),e)}async function e_(r,e){for await(let t of yf.call(this,r,e))return t}async function t_(r,e){if(typeof r!="function")throw new $s("fn",["Function","AsyncFunction"],r);async function t(n,i){return await r(n,i),Fc}for await(let n of Vc.call(this,t,e));}function yf(r,e){if(typeof r!="function")throw new $s("fn",["Function","AsyncFunction"],r);async function t(n,i){return await r(n,i)?n:Fc}return Vc.call(this,t,e)}var pf=class extends LA{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function r_(r,e,t){var n;if(typeof r!="function")throw new $s("reducer",["Function","AsyncFunction"],r);t!=null&&Oi(t,"options"),t?.signal!=null&&Ri(t.signal,"options.signal");let i=arguments.length>1;if(t!=null&&(n=t.signal)!==null&&n!==void 0&&n.aborted){let d=new Or(void 0,{cause:t.signal.reason});throw this.once("error",()=>{}),await qA(this.destroy(d)),d}let o=new Eg,s=o.signal;if(t!=null&&t.signal){let d={once:!0,[$A]:this};t.signal.addEventListener("abort",()=>o.abort(),d)}let a=!1;try{for await(let d of this){var c;if(a=!0,t!=null&&(c=t.signal)!==null&&c!==void 0&&c.aborted)throw new Or;i?e=await r(e,d,{signal:s}):(e=d,i=!0)}if(!a&&!i)throw new pf}finally{o.abort()}return e}async function n_(r){r!=null&&Oi(r,"options"),r?.signal!=null&&Ri(r.signal,"options.signal");let e=[];for await(let n of this){var t;if(r!=null&&(t=r.signal)!==null&&t!==void 0&&t.aborted)throw new Or(void 0,{cause:r.signal.reason});WA(e,n)}return e}function i_(r,e){let t=Vc.call(this,r,e);return(async function*(){for await(let i of t)yield*i}).call(this)}function Ag(r){if(r=GA(r),JA(r))return 0;if(r<0)throw new MA("number",">= 0",r);return r}function o_(r,e=void 0){return e!=null&&Oi(e,"options"),e?.signal!=null&&Ri(e.signal,"options.signal"),r=Ag(r),(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Or;for await(let o of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new Or;r--<=0&&(yield o)}}).call(this)}function s_(r,e=void 0){return e!=null&&Oi(e,"options"),e?.signal!=null&&Ri(e.signal,"options.signal"),r=Ag(r),(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Or;for await(let o of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new Or;if(r-- >0)yield o;else return}}).call(this)}mf.exports.streamReturningOperators={asIndexedPairs:ZA,drop:o_,filter:yf,flatMap:i_,map:Vc,take:s_,compose:XA};mf.exports.promiseReturningOperators={every:QA,forEach:t_,reduce:r_,toArray:n_,some:Sg,find:e_}});var gf=N((H6,Tg)=>{"use strict";var j6=l(f()),{ArrayPrototypePop:a_,Promise:c_}=He(),{isIterable:u_,isNodeStream:d_,isWebStream:l_}=Ir(),{pipelineImpl:f_}=Nc(),{finished:h_}=rn();wf();function p_(...r){return new c_((e,t)=>{let n,i,o=r[r.length-1];if(o&&typeof o=="object"&&!d_(o)&&!u_(o)&&!l_(o)){let s=a_(r);n=s.signal,i=s.end}f_(r,(s,a)=>{s?t(s):e(a)},{signal:n,end:i})})}Tg.exports={finished:h_,pipeline:p_}});var wf=N((W6,Pg)=>{var z6=l(f()),{Buffer:y_}=xt(),{ObjectDefineProperty:sn,ObjectKeys:Bg,ReflectApply:Rg}=He(),{promisify:{custom:Og}}=Sr(),{streamReturningOperators:Ig,promiseReturningOperators:Dg}=_g(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:Ug}}=ht(),m_=hf(),{pipeline:Cg}=Nc(),{destroyer:g_}=Si(),kg=rn(),bf=gf(),xf=Ir(),Me=Pg.exports=Ac().Stream;Me.isDisturbed=xf.isDisturbed;Me.isErrored=xf.isErrored;Me.isReadable=xf.isReadable;Me.Readable=ks();for(let r of Bg(Ig)){let t=function(...n){if(new.target)throw Ug();return Me.Readable.from(Rg(e,this,n))};Ef=t;let e=Ig[r];sn(t,"name",{__proto__:null,value:e.name}),sn(t,"length",{__proto__:null,value:e.length}),sn(Me.Readable.prototype,r,{__proto__:null,value:t,enumerable:!1,configurable:!0,writable:!0})}var Ef;for(let r of Bg(Dg)){let t=function(...i){if(new.target)throw Ug();return Rg(e,this,i)};Ef=t;let e=Dg[r];sn(t,"name",{__proto__:null,value:e.name}),sn(t,"length",{__proto__:null,value:e.length}),sn(Me.Readable.prototype,r,{__proto__:null,value:t,enumerable:!1,configurable:!0,writable:!0})}var Ef;Me.Writable=zl();Me.Duplex=Rr();Me.Transform=ef();Me.PassThrough=rf();Me.pipeline=Cg;var{addAbortSignal:w_}=Us();Me.addAbortSignal=w_;Me.finished=kg;Me.destroy=g_;Me.compose=m_;sn(Me,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return bf}});sn(Cg,Og,{__proto__:null,enumerable:!0,get(){return bf.pipeline}});sn(kg,Og,{__proto__:null,enumerable:!0,get(){return bf.finished}});Me.Stream=Me;Me._isUint8Array=function(e){return e instanceof Uint8Array};Me._uint8ArrayToBuffer=function(e){return y_.from(e.buffer,e.byteOffset,e.byteLength)}});var qs=N((G6,Ne)=>{"use strict";var J6=l(f()),ze=wf(),b_=gf(),x_=ze.Readable.destroy;Ne.exports=ze.Readable;Ne.exports._uint8ArrayToBuffer=ze._uint8ArrayToBuffer;Ne.exports._isUint8Array=ze._isUint8Array;Ne.exports.isDisturbed=ze.isDisturbed;Ne.exports.isErrored=ze.isErrored;Ne.exports.isReadable=ze.isReadable;Ne.exports.Readable=ze.Readable;Ne.exports.Writable=ze.Writable;Ne.exports.Duplex=ze.Duplex;Ne.exports.Transform=ze.Transform;Ne.exports.PassThrough=ze.PassThrough;Ne.exports.addAbortSignal=ze.addAbortSignal;Ne.exports.finished=ze.finished;Ne.exports.destroy=ze.destroy;Ne.exports.destroy=x_;Ne.exports.pipeline=ze.pipeline;Ne.exports.compose=ze.compose;Object.defineProperty(ze,"promises",{configurable:!0,enumerable:!0,get(){return b_}});Ne.exports.Stream=ze.Stream;Ne.exports.default=Ne.exports});var Kw=N(Pw=>{var kP=l(f());Pw.Level=cl().BrowserLevel});var gb=N((ku,mb)=>{var HL=l(f());(function(r,e){typeof ku=="object"&&typeof mb<"u"?e(ku):typeof define=="function"&&define.amd?define(["exports"],e):e(r.URI=r.URI||{})})(ku,function(r){"use strict";function e(){for(var g=arguments.length,y=Array(g),x=0;x<g;x++)y[x]=arguments[x];if(y.length>1){y[0]=y[0].slice(0,-1);for(var A=y.length-1,_=1;_<A;++_)y[_]=y[_].slice(1,-1);return y[A]=y[A].slice(1),y.join("")}else return y[0]}function t(g){return"(?:"+g+")"}function n(g){return g===void 0?"undefined":g===null?"null":Object.prototype.toString.call(g).split(" ").pop().split("]").shift().toLowerCase()}function i(g){return g.toUpperCase()}function o(g){return g!=null?g instanceof Array?g:typeof g.length!="number"||g.split||g.setInterval||g.call?[g]:Array.prototype.slice.call(g):[]}function s(g,y){var x=g;if(y)for(var A in y)x[A]=y[A];return x}function a(g){var y="[A-Za-z]",x="[\\x0D]",A="[0-9]",_="[\\x22]",L=e(A,"[A-Fa-f]"),ie="[\\x0A]",he="[\\x20]",ge=t(t("%[EFef]"+L+"%"+L+L+"%"+L+L)+"|"+t("%[89A-Fa-f]"+L+"%"+L+L)+"|"+t("%"+L+L)),Fe="[\\:\\/\\?\\#\\[\\]\\@]",fe="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",Ue=e(Fe,fe),Ve=g?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",De=g?"[\\uE000-\\uF8FF]":"[]",pe=e(y,A,"[\\-\\.\\_\\~]",Ve),Ce=t(y+e(y,A,"[\\+\\-\\.]")+"*"),we=t(t(ge+"|"+e(pe,fe,"[\\:]"))+"*"),Yn=t(t("25[0-5]")+"|"+t("2[0-4]"+A)+"|"+t("1"+A+A)+"|"+t("[1-9]"+A)+"|"+A),Bt=t(t("25[0-5]")+"|"+t("2[0-4]"+A)+"|"+t("1"+A+A)+"|"+t("0?[1-9]"+A)+"|0?0?"+A),qt=t(Bt+"\\."+Bt+"\\."+Bt+"\\."+Bt),Ee=t(L+"{1,4}"),Rt=t(t(Ee+"\\:"+Ee)+"|"+qt),Ft=t(t(Ee+"\\:")+"{6}"+Rt),yr=t("\\:\\:"+t(Ee+"\\:")+"{5}"+Rt),Xn=t(t(Ee)+"?\\:\\:"+t(Ee+"\\:")+"{4}"+Rt),qr=t(t(t(Ee+"\\:")+"{0,1}"+Ee)+"?\\:\\:"+t(Ee+"\\:")+"{3}"+Rt),Qo=t(t(t(Ee+"\\:")+"{0,2}"+Ee)+"?\\:\\:"+t(Ee+"\\:")+"{2}"+Rt),Ba=t(t(t(Ee+"\\:")+"{0,3}"+Ee)+"?\\:\\:"+Ee+"\\:"+Rt),Ra=t(t(t(Ee+"\\:")+"{0,4}"+Ee)+"?\\:\\:"+Rt),Hi=t(t(t(Ee+"\\:")+"{0,5}"+Ee)+"?\\:\\:"+Ee),ji=t(t(t(Ee+"\\:")+"{0,6}"+Ee)+"?\\:\\:"),Fr=t([Ft,yr,Xn,qr,Qo,Ba,Ra,Hi,ji].join("|")),Wi=t(t(pe+"|"+ge)+"+"),Hu=t(Fr+"\\%25"+Wi),Zn=t(Fr+t("\\%25|\\%(?!"+L+"{2})")+Wi),Gb=t("[vV]"+L+"+\\."+e(pe,fe,"[\\:]")+"+"),Jb=t("\\["+t(Zn+"|"+Fr+"|"+Gb)+"\\]"),Qh=t(t(ge+"|"+e(pe,fe))+"*"),es=t(Jb+"|"+qt+"(?!"+Qh+")|"+Qh),ts=t(A+"*"),ep=t(t(we+"@")+"?"+es+t("\\:"+ts)+"?"),rs=t(ge+"|"+e(pe,fe,"[\\:\\@]")),Yb=t(rs+"*"),tp=t(rs+"+"),Xb=t(t(ge+"|"+e(pe,fe,"[\\@]"))+"+"),Vr=t(t("\\/"+Yb)+"*"),zi=t("\\/"+t(tp+Vr)+"?"),ju=t(Xb+Vr),Oa=t(tp+Vr),Gi="(?!"+rs+")",jD=t(Vr+"|"+zi+"|"+ju+"|"+Oa+"|"+Gi),Ji=t(t(rs+"|"+e("[\\/\\?]",De))+"*"),ns=t(t(rs+"|[\\/\\?]")+"*"),rp=t(t("\\/\\/"+ep+Vr)+"|"+zi+"|"+Oa+"|"+Gi),Zb=t(Ce+"\\:"+rp+t("\\?"+Ji)+"?"+t("\\#"+ns)+"?"),Qb=t(t("\\/\\/"+ep+Vr)+"|"+zi+"|"+ju+"|"+Gi),ex=t(Qb+t("\\?"+Ji)+"?"+t("\\#"+ns)+"?"),WD=t(Zb+"|"+ex),zD=t(Ce+"\\:"+rp+t("\\?"+Ji)+"?"),GD="^("+Ce+")\\:"+t(t("\\/\\/("+t("("+we+")@")+"?("+es+")"+t("\\:("+ts+")")+"?)")+"?("+Vr+"|"+zi+"|"+Oa+"|"+Gi+")")+t("\\?("+Ji+")")+"?"+t("\\#("+ns+")")+"?$",JD="^(){0}"+t(t("\\/\\/("+t("("+we+")@")+"?("+es+")"+t("\\:("+ts+")")+"?)")+"?("+Vr+"|"+zi+"|"+ju+"|"+Gi+")")+t("\\?("+Ji+")")+"?"+t("\\#("+ns+")")+"?$",YD="^("+Ce+")\\:"+t(t("\\/\\/("+t("("+we+")@")+"?("+es+")"+t("\\:("+ts+")")+"?)")+"?("+Vr+"|"+zi+"|"+Oa+"|"+Gi+")")+t("\\?("+Ji+")")+"?$",XD="^"+t("\\#("+ns+")")+"?$",ZD="^"+t("("+we+")@")+"?("+es+")"+t("\\:("+ts+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",y,A,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",pe,fe),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",pe,fe),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",pe,fe),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",pe,fe),"g"),NOT_QUERY:new RegExp(e("[^\\%]",pe,fe,"[\\:\\@\\/\\?]",De),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",pe,fe,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",pe,fe),"g"),UNRESERVED:new RegExp(pe,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",pe,Ue),"g"),PCT_ENCODED:new RegExp(ge,"g"),IPV4ADDRESS:new RegExp("^("+qt+")$"),IPV6ADDRESS:new RegExp("^\\[?("+Fr+")"+t(t("\\%25|\\%(?!"+L+"{2})")+"("+Wi+")")+"?\\]?$")}}var c=a(!1),d=a(!0),u=function(){function g(y,x){var A=[],_=!0,L=!1,ie=void 0;try{for(var he=y[Symbol.iterator](),ge;!(_=(ge=he.next()).done)&&(A.push(ge.value),!(x&&A.length===x));_=!0);}catch(Fe){L=!0,ie=Fe}finally{try{!_&&he.return&&he.return()}finally{if(L)throw ie}}return A}return function(y,x){if(Array.isArray(y))return y;if(Symbol.iterator in Object(y))return g(y,x);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),h=function(g){if(Array.isArray(g)){for(var y=0,x=Array(g.length);y<g.length;y++)x[y]=g[y];return x}else return Array.from(g)},m=2147483647,w=36,p=1,b=26,v=38,S=700,D=72,E=128,R="-",I=/^xn--/,O=/[^\0-\x7E]/,C=/[\x2E\u3002\uFF0E\uFF61]/g,U={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},V=w-p,H=Math.floor,W=String.fromCharCode;function Q(g){throw new RangeError(U[g])}function de(g,y){for(var x=[],A=g.length;A--;)x[A]=y(g[A]);return x}function nt(g,y){var x=g.split("@"),A="";x.length>1&&(A=x[0]+"@",g=x[1]),g=g.replace(C,".");var _=g.split("."),L=de(_,y).join(".");return A+L}function k(g){for(var y=[],x=0,A=g.length;x<A;){var _=g.charCodeAt(x++);if(_>=55296&&_<=56319&&x<A){var L=g.charCodeAt(x++);(L&64512)==56320?y.push(((_&1023)<<10)+(L&1023)+65536):(y.push(_),x--)}else y.push(_)}return y}var M=function(y){return String.fromCodePoint.apply(String,h(y))},ee=function(y){return y-48<10?y-22:y-65<26?y-65:y-97<26?y-97:w},P=function(y,x){return y+22+75*(y<26)-((x!=0)<<5)},B=function(y,x,A){var _=0;for(y=A?H(y/S):y>>1,y+=H(y/x);y>V*b>>1;_+=w)y=H(y/V);return H(_+(V+1)*y/(y+v))},K=function(y){var x=[],A=y.length,_=0,L=E,ie=D,he=y.lastIndexOf(R);he<0&&(he=0);for(var ge=0;ge<he;++ge)y.charCodeAt(ge)>=128&&Q("not-basic"),x.push(y.charCodeAt(ge));for(var Fe=he>0?he+1:0;Fe<A;){for(var fe=_,Ue=1,Ve=w;;Ve+=w){Fe>=A&&Q("invalid-input");var De=ee(y.charCodeAt(Fe++));(De>=w||De>H((m-_)/Ue))&&Q("overflow"),_+=De*Ue;var pe=Ve<=ie?p:Ve>=ie+b?b:Ve-ie;if(De<pe)break;var Ce=w-pe;Ue>H(m/Ce)&&Q("overflow"),Ue*=Ce}var we=x.length+1;ie=B(_-fe,we,fe==0),H(_/we)>m-L&&Q("overflow"),L+=H(_/we),_%=we,x.splice(_++,0,L)}return String.fromCodePoint.apply(String,x)},F=function(y){var x=[];y=k(y);var A=y.length,_=E,L=0,ie=D,he=!0,ge=!1,Fe=void 0;try{for(var fe=y[Symbol.iterator](),Ue;!(he=(Ue=fe.next()).done);he=!0){var Ve=Ue.value;Ve<128&&x.push(W(Ve))}}catch(Zn){ge=!0,Fe=Zn}finally{try{!he&&fe.return&&fe.return()}finally{if(ge)throw Fe}}var De=x.length,pe=De;for(De&&x.push(R);pe<A;){var Ce=m,we=!0,Yn=!1,Bt=void 0;try{for(var qt=y[Symbol.iterator](),Ee;!(we=(Ee=qt.next()).done);we=!0){var Rt=Ee.value;Rt>=_&&Rt<Ce&&(Ce=Rt)}}catch(Zn){Yn=!0,Bt=Zn}finally{try{!we&&qt.return&&qt.return()}finally{if(Yn)throw Bt}}var Ft=pe+1;Ce-_>H((m-L)/Ft)&&Q("overflow"),L+=(Ce-_)*Ft,_=Ce;var yr=!0,Xn=!1,qr=void 0;try{for(var Qo=y[Symbol.iterator](),Ba;!(yr=(Ba=Qo.next()).done);yr=!0){var Ra=Ba.value;if(Ra<_&&++L>m&&Q("overflow"),Ra==_){for(var Hi=L,ji=w;;ji+=w){var Fr=ji<=ie?p:ji>=ie+b?b:ji-ie;if(Hi<Fr)break;var Wi=Hi-Fr,Hu=w-Fr;x.push(W(P(Fr+Wi%Hu,0))),Hi=H(Wi/Hu)}x.push(W(P(Hi,0))),ie=B(L,Ft,pe==De),L=0,++pe}}}catch(Zn){Xn=!0,qr=Zn}finally{try{!yr&&Qo.return&&Qo.return()}finally{if(Xn)throw qr}}++L,++_}return x.join("")},J=function(y){return nt(y,function(x){return I.test(x)?K(x.slice(4).toLowerCase()):x})},te=function(y){return nt(y,function(x){return O.test(x)?"xn--"+F(x):x})},X={version:"2.1.0",ucs2:{decode:k,encode:M},decode:K,encode:F,toASCII:te,toUnicode:J},Z={};function Y(g){var y=g.charCodeAt(0),x=void 0;return y<16?x="%0"+y.toString(16).toUpperCase():y<128?x="%"+y.toString(16).toUpperCase():y<2048?x="%"+(y>>6|192).toString(16).toUpperCase()+"%"+(y&63|128).toString(16).toUpperCase():x="%"+(y>>12|224).toString(16).toUpperCase()+"%"+(y>>6&63|128).toString(16).toUpperCase()+"%"+(y&63|128).toString(16).toUpperCase(),x}function re(g){for(var y="",x=0,A=g.length;x<A;){var _=parseInt(g.substr(x+1,2),16);if(_<128)y+=String.fromCharCode(_),x+=3;else if(_>=194&&_<224){if(A-x>=6){var L=parseInt(g.substr(x+4,2),16);y+=String.fromCharCode((_&31)<<6|L&63)}else y+=g.substr(x,6);x+=6}else if(_>=224){if(A-x>=9){var ie=parseInt(g.substr(x+4,2),16),he=parseInt(g.substr(x+7,2),16);y+=String.fromCharCode((_&15)<<12|(ie&63)<<6|he&63)}else y+=g.substr(x,9);x+=9}else y+=g.substr(x,3),x+=3}return y}function Ie(g,y){function x(A){var _=re(A);return _.match(y.UNRESERVED)?_:A}return g.scheme&&(g.scheme=String(g.scheme).replace(y.PCT_ENCODED,x).toLowerCase().replace(y.NOT_SCHEME,"")),g.userinfo!==void 0&&(g.userinfo=String(g.userinfo).replace(y.PCT_ENCODED,x).replace(y.NOT_USERINFO,Y).replace(y.PCT_ENCODED,i)),g.host!==void 0&&(g.host=String(g.host).replace(y.PCT_ENCODED,x).toLowerCase().replace(y.NOT_HOST,Y).replace(y.PCT_ENCODED,i)),g.path!==void 0&&(g.path=String(g.path).replace(y.PCT_ENCODED,x).replace(g.scheme?y.NOT_PATH:y.NOT_PATH_NOSCHEME,Y).replace(y.PCT_ENCODED,i)),g.query!==void 0&&(g.query=String(g.query).replace(y.PCT_ENCODED,x).replace(y.NOT_QUERY,Y).replace(y.PCT_ENCODED,i)),g.fragment!==void 0&&(g.fragment=String(g.fragment).replace(y.PCT_ENCODED,x).replace(y.NOT_FRAGMENT,Y).replace(y.PCT_ENCODED,i)),g}function Se(g){return g.replace(/^0*(.*)/,"$1")||"0"}function Pe(g,y){var x=g.match(y.IPV4ADDRESS)||[],A=u(x,2),_=A[1];return _?_.split(".").map(Se).join("."):g}function qe(g,y){var x=g.match(y.IPV6ADDRESS)||[],A=u(x,3),_=A[1],L=A[2];if(_){for(var ie=_.toLowerCase().split("::").reverse(),he=u(ie,2),ge=he[0],Fe=he[1],fe=Fe?Fe.split(":").map(Se):[],Ue=ge.split(":").map(Se),Ve=y.IPV4ADDRESS.test(Ue[Ue.length-1]),De=Ve?7:8,pe=Ue.length-De,Ce=Array(De),we=0;we<De;++we)Ce[we]=fe[we]||Ue[pe+we]||"";Ve&&(Ce[De-1]=Pe(Ce[De-1],y));var Yn=Ce.reduce(function(Ft,yr,Xn){if(!yr||yr==="0"){var qr=Ft[Ft.length-1];qr&&qr.index+qr.length===Xn?qr.length++:Ft.push({index:Xn,length:1})}return Ft},[]),Bt=Yn.sort(function(Ft,yr){return yr.length-Ft.length})[0],qt=void 0;if(Bt&&Bt.length>1){var Ee=Ce.slice(0,Bt.index),Rt=Ce.slice(Bt.index+Bt.length);qt=Ee.join(":")+"::"+Rt.join(":")}else qt=Ce.join(":");return L&&(qt+="%"+L),qt}else return g}var Ke=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,Qe="".match(/(){0}/)[1]===void 0;function je(g){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x={},A=y.iri!==!1?d:c;y.reference==="suffix"&&(g=(y.scheme?y.scheme+":":"")+"//"+g);var _=g.match(Ke);if(_){Qe?(x.scheme=_[1],x.userinfo=_[3],x.host=_[4],x.port=parseInt(_[5],10),x.path=_[6]||"",x.query=_[7],x.fragment=_[8],isNaN(x.port)&&(x.port=_[5])):(x.scheme=_[1]||void 0,x.userinfo=g.indexOf("@")!==-1?_[3]:void 0,x.host=g.indexOf("//")!==-1?_[4]:void 0,x.port=parseInt(_[5],10),x.path=_[6]||"",x.query=g.indexOf("?")!==-1?_[7]:void 0,x.fragment=g.indexOf("#")!==-1?_[8]:void 0,isNaN(x.port)&&(x.port=g.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?_[4]:void 0)),x.host&&(x.host=qe(Pe(x.host,A),A)),x.scheme===void 0&&x.userinfo===void 0&&x.host===void 0&&x.port===void 0&&!x.path&&x.query===void 0?x.reference="same-document":x.scheme===void 0?x.reference="relative":x.fragment===void 0?x.reference="absolute":x.reference="uri",y.reference&&y.reference!=="suffix"&&y.reference!==x.reference&&(x.error=x.error||"URI is not a "+y.reference+" reference.");var L=Z[(y.scheme||x.scheme||"").toLowerCase()];if(!y.unicodeSupport&&(!L||!L.unicodeSupport)){if(x.host&&(y.domainHost||L&&L.domainHost))try{x.host=X.toASCII(x.host.replace(A.PCT_ENCODED,re).toLowerCase())}catch(ie){x.error=x.error||"Host's domain name can not be converted to ASCII via punycode: "+ie}Ie(x,c)}else Ie(x,A);L&&L.parse&&L.parse(x,y)}else x.error=x.error||"URI can not be parsed.";return x}function $r(g,y){var x=y.iri!==!1?d:c,A=[];return g.userinfo!==void 0&&(A.push(g.userinfo),A.push("@")),g.host!==void 0&&A.push(qe(Pe(String(g.host),x),x).replace(x.IPV6ADDRESS,function(_,L,ie){return"["+L+(ie?"%25"+ie:"")+"]"})),(typeof g.port=="number"||typeof g.port=="string")&&(A.push(":"),A.push(String(g.port))),A.length?A.join(""):void 0}var wn=/^\.\.?\//,Jo=/^\/\.(\/|$)/,Sa=/^\/\.\.(\/|$)/,qu=/^\/?(?:.|\n)*?(?=\/|$)/;function bn(g){for(var y=[];g.length;)if(g.match(wn))g=g.replace(wn,"");else if(g.match(Jo))g=g.replace(Jo,"/");else if(g.match(Sa))g=g.replace(Sa,"/"),y.pop();else if(g==="."||g==="..")g="";else{var x=g.match(qu);if(x){var A=x[0];g=g.slice(A.length),y.push(A)}else throw new Error("Unexpected dot segment condition")}return y.join("")}function Nt(g){var y=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},x=y.iri?d:c,A=[],_=Z[(y.scheme||g.scheme||"").toLowerCase()];if(_&&_.serialize&&_.serialize(g,y),g.host&&!x.IPV6ADDRESS.test(g.host)){if(y.domainHost||_&&_.domainHost)try{g.host=y.iri?X.toUnicode(g.host):X.toASCII(g.host.replace(x.PCT_ENCODED,re).toLowerCase())}catch(he){g.error=g.error||"Host's domain name can not be converted to "+(y.iri?"Unicode":"ASCII")+" via punycode: "+he}}Ie(g,x),y.reference!=="suffix"&&g.scheme&&(A.push(g.scheme),A.push(":"));var L=$r(g,y);if(L!==void 0&&(y.reference!=="suffix"&&A.push("//"),A.push(L),g.path&&g.path.charAt(0)!=="/"&&A.push("/")),g.path!==void 0){var ie=g.path;!y.absolutePath&&(!_||!_.absolutePath)&&(ie=bn(ie)),L===void 0&&(ie=ie.replace(/^\/\//,"/%2F")),A.push(ie)}return g.query!==void 0&&(A.push("?"),A.push(g.query)),g.fragment!==void 0&&(A.push("#"),A.push(g.fragment)),A.join("")}function Yo(g,y){var x=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},A=arguments[3],_={};return A||(g=je(Nt(g,x),x),y=je(Nt(y,x),x)),x=x||{},!x.tolerant&&y.scheme?(_.scheme=y.scheme,_.userinfo=y.userinfo,_.host=y.host,_.port=y.port,_.path=bn(y.path||""),_.query=y.query):(y.userinfo!==void 0||y.host!==void 0||y.port!==void 0?(_.userinfo=y.userinfo,_.host=y.host,_.port=y.port,_.path=bn(y.path||""),_.query=y.query):(y.path?(y.path.charAt(0)==="/"?_.path=bn(y.path):((g.userinfo!==void 0||g.host!==void 0||g.port!==void 0)&&!g.path?_.path="/"+y.path:g.path?_.path=g.path.slice(0,g.path.lastIndexOf("/")+1)+y.path:_.path=y.path,_.path=bn(_.path)),_.query=y.query):(_.path=g.path,y.query!==void 0?_.query=y.query:_.query=g.query),_.userinfo=g.userinfo,_.host=g.host,_.port=g.port),_.scheme=g.scheme),_.fragment=y.fragment,_}function Aa(g,y,x){var A=s({scheme:"null"},x);return Nt(Yo(je(g,A),je(y,A),A,!0),A)}function Xo(g,y){return typeof g=="string"?g=Nt(je(g,y),y):n(g)==="object"&&(g=je(Nt(g,y),y)),g}function _a(g,y,x){return typeof g=="string"?g=Nt(je(g,x),x):n(g)==="object"&&(g=Nt(g,x)),typeof y=="string"?y=Nt(je(y,x),x):n(y)==="object"&&(y=Nt(y,x)),g===y}function Ta(g,y){return g&&g.toString().replace(!y||!y.iri?c.ESCAPE:d.ESCAPE,Y)}function $t(g,y){return g&&g.toString().replace(!y||!y.iri?c.PCT_ENCODED:d.PCT_ENCODED,re)}var xn={scheme:"http",domainHost:!0,parse:function(y,x){return y.host||(y.error=y.error||"HTTP URIs must have a host."),y},serialize:function(y,x){var A=String(y.scheme).toLowerCase()==="https";return(y.port===(A?443:80)||y.port==="")&&(y.port=void 0),y.path||(y.path="/"),y}},Zo={scheme:"https",domainHost:xn.domainHost,parse:xn.parse,serialize:xn.serialize};function Ia(g){return typeof g.secure=="boolean"?g.secure:String(g.scheme).toLowerCase()==="wss"}var Jn={scheme:"ws",domainHost:!0,parse:function(y,x){var A=y;return A.secure=Ia(A),A.resourceName=(A.path||"/")+(A.query?"?"+A.query:""),A.path=void 0,A.query=void 0,A},serialize:function(y,x){if((y.port===(Ia(y)?443:80)||y.port==="")&&(y.port=void 0),typeof y.secure=="boolean"&&(y.scheme=y.secure?"wss":"ws",y.secure=void 0),y.resourceName){var A=y.resourceName.split("?"),_=u(A,2),L=_[0],ie=_[1];y.path=L&&L!=="/"?L:void 0,y.query=ie,y.resourceName=void 0}return y.fragment=void 0,y}},Da={scheme:"wss",domainHost:Jn.domainHost,parse:Jn.parse,serialize:Jn.serialize},Fu={},Lb=!0,Gh="[A-Za-z0-9\\-\\.\\_\\~"+(Lb?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",pr="[0-9A-Fa-f]",Mb=t(t("%[EFef]"+pr+"%"+pr+pr+"%"+pr+pr)+"|"+t("%[89A-Fa-f]"+pr+"%"+pr+pr)+"|"+t("%"+pr+pr)),Nb="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",$b="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",qb=e($b,'[\\"\\\\]'),Fb="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Vb=new RegExp(Gh,"g"),Vi=new RegExp(Mb,"g"),Hb=new RegExp(e("[^]",Nb,"[\\.]",'[\\"]',qb),"g"),Jh=new RegExp(e("[^]",Gh,Fb),"g"),jb=Jh;function Vu(g){var y=re(g);return y.match(Vb)?y:g}var Yh={scheme:"mailto",parse:function(y,x){var A=y,_=A.to=A.path?A.path.split(","):[];if(A.path=void 0,A.query){for(var L=!1,ie={},he=A.query.split("&"),ge=0,Fe=he.length;ge<Fe;++ge){var fe=he[ge].split("=");switch(fe[0]){case"to":for(var Ue=fe[1].split(","),Ve=0,De=Ue.length;Ve<De;++Ve)_.push(Ue[Ve]);break;case"subject":A.subject=$t(fe[1],x);break;case"body":A.body=$t(fe[1],x);break;default:L=!0,ie[$t(fe[0],x)]=$t(fe[1],x);break}}L&&(A.headers=ie)}A.query=void 0;for(var pe=0,Ce=_.length;pe<Ce;++pe){var we=_[pe].split("@");if(we[0]=$t(we[0]),x.unicodeSupport)we[1]=$t(we[1],x).toLowerCase();else try{we[1]=X.toASCII($t(we[1],x).toLowerCase())}catch(Yn){A.error=A.error||"Email address's domain name can not be converted to ASCII via punycode: "+Yn}_[pe]=we.join("@")}return A},serialize:function(y,x){var A=y,_=o(y.to);if(_){for(var L=0,ie=_.length;L<ie;++L){var he=String(_[L]),ge=he.lastIndexOf("@"),Fe=he.slice(0,ge).replace(Vi,Vu).replace(Vi,i).replace(Hb,Y),fe=he.slice(ge+1);try{fe=x.iri?X.toUnicode(fe):X.toASCII($t(fe,x).toLowerCase())}catch(pe){A.error=A.error||"Email address's domain name can not be converted to "+(x.iri?"Unicode":"ASCII")+" via punycode: "+pe}_[L]=Fe+"@"+fe}A.path=_.join(",")}var Ue=y.headers=y.headers||{};y.subject&&(Ue.subject=y.subject),y.body&&(Ue.body=y.body);var Ve=[];for(var De in Ue)Ue[De]!==Fu[De]&&Ve.push(De.replace(Vi,Vu).replace(Vi,i).replace(Jh,Y)+"="+Ue[De].replace(Vi,Vu).replace(Vi,i).replace(jb,Y));return Ve.length&&(A.query=Ve.join("&")),A}},Wb=/^([^\:]+)\:(.*)/,Xh={scheme:"urn",parse:function(y,x){var A=y.path&&y.path.match(Wb),_=y;if(A){var L=x.scheme||_.scheme||"urn",ie=A[1].toLowerCase(),he=A[2],ge=L+":"+(x.nid||ie),Fe=Z[ge];_.nid=ie,_.nss=he,_.path=void 0,Fe&&(_=Fe.parse(_,x))}else _.error=_.error||"URN can not be parsed.";return _},serialize:function(y,x){var A=x.scheme||y.scheme||"urn",_=y.nid,L=A+":"+(x.nid||_),ie=Z[L];ie&&(y=ie.serialize(y,x));var he=y,ge=y.nss;return he.path=(_||x.nid)+":"+ge,he}},zb=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,Zh={scheme:"urn:uuid",parse:function(y,x){var A=y;return A.uuid=A.nss,A.nss=void 0,!x.tolerant&&(!A.uuid||!A.uuid.match(zb))&&(A.error=A.error||"UUID is not valid."),A},serialize:function(y,x){var A=y;return A.nss=(y.uuid||"").toLowerCase(),A}};Z[xn.scheme]=xn,Z[Zo.scheme]=Zo,Z[Jn.scheme]=Jn,Z[Da.scheme]=Da,Z[Yh.scheme]=Yh,Z[Xh.scheme]=Xh,Z[Zh.scheme]=Zh,r.SCHEMES=Z,r.pctEncChar=Y,r.pctDecChars=re,r.parse=je,r.removeDotSegments=bn,r.serialize=Nt,r.resolveComponents=Yo,r.resolve=Aa,r.normalize=Xo,r.equal=_a,r.escapeComponent=Ta,r.unescapeComponent=$t,Object.defineProperty(r,"__esModule",{value:!0})})});var bb=N((t3,wb)=>{"use strict";var r3=l(f());wb.exports=function r(e){if(typeof e=="number"&&isNaN(e))throw new Error("NaN is not allowed");if(typeof e=="number"&&!isFinite(e))throw new Error("Infinity is not allowed");return e===null||typeof e!="object"?JSON.stringify(e):e.toJSON instanceof Function?r(e.toJSON()):Array.isArray(e)?`[${e.reduce((i,o,s)=>`${i}${s===0?"":","}${r(o===void 0||typeof o=="symbol"?null:o)}`,"")}]`:`{${Object.keys(e).sort().reduce((n,i)=>{if(e[i]===void 0||typeof e[i]=="symbol")return n;let o=n.length===0?"":",";return`${n}${o}${r(i)}:${r(e[i])}`},"")}}`}});var kb=N((i4,Cb)=>{var o4=l(f()),Wo=1e3,zo=Wo*60,Go=zo*60,Fi=Go*24,ND=Fi*7,$D=Fi*365.25;Cb.exports=function(r,e){e=e||{};var t=typeof r;if(t==="string"&&r.length>0)return qD(r);if(t==="number"&&isFinite(r))return e.long?VD(r):FD(r);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(r))};function qD(r){if(r=String(r),!(r.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(r);if(e){var t=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return t*$D;case"weeks":case"week":case"w":return t*ND;case"days":case"day":case"d":return t*Fi;case"hours":case"hour":case"hrs":case"hr":case"h":return t*Go;case"minutes":case"minute":case"mins":case"min":case"m":return t*zo;case"seconds":case"second":case"secs":case"sec":case"s":return t*Wo;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return t;default:return}}}}function FD(r){var e=Math.abs(r);return e>=Fi?Math.round(r/Fi)+"d":e>=Go?Math.round(r/Go)+"h":e>=zo?Math.round(r/zo)+"m":e>=Wo?Math.round(r/Wo)+"s":r+"ms"}function VD(r){var e=Math.abs(r);return e>=Fi?$u(r,e,Fi,"day"):e>=Go?$u(r,e,Go,"hour"):e>=zo?$u(r,e,zo,"minute"):e>=Wo?$u(r,e,Wo,"second"):r+" ms"}function $u(r,e,t,n){var i=e>=t*1.5;return Math.round(r/t)+" "+n+(i?"s":"")}});var HD={};is(HD,{BearerDid:()=>mt,Did:()=>Re,DidDht:()=>ya,DidDhtDocument:()=>ma,DidDhtRegisteredDidType:()=>Ah,DidDhtRegisteredKeyType:()=>Cu,DidDhtUtils:()=>Xe,DidDhtVerificationRelationship:()=>_h,DidError:()=>$,DidErrorCode:()=>jr,DidIon:()=>qh,DidIonRegisteredKeyType:()=>Ob,DidIonUtils:()=>Gn,DidJwk:()=>Fh,DidKey:()=>Vh,DidKeyRegisteredKeyType:()=>Ub,DidKeyUtils:()=>er,DidKeyVerificationMethodType:()=>Mu,DidMethod:()=>Lt,DidResolverCacheLevel:()=>jh,DidResolverCacheNoop:()=>Wh,DidVerificationRelationship:()=>ti,DidWeb:()=>Hh,EMPTY_DID_RESOLUTION_RESULT:()=>Be,UniversalResolver:()=>zh,utils:()=>uh});var m4=l(f(),1);var dB=l(f(),1),ti=(o=>(o.authentication="authentication",o.assertionMethod="assertionMethod",o.keyAgreement="keyAgreement",o.capabilityInvocation="capabilityInvocation",o.capabilityDelegation="capabilityDelegation",o))(ti||{});var fB=l(f(),1),Be={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};var pB=l(f(),1),We=class We{constructor({method:e,id:t,path:n,query:i,fragment:o,params:s}){this.uri=`did:${e}:${t}`,this.method=e,this.id=t,this.path=n,this.query=i,this.fragment=o,this.params=s}static parse(e){if(!e)return null;let t=We.DID_URI_PATTERN.exec(e);if(!t||!t.groups)return null;let{method:n,id:i,path:o,query:s,fragment:a}=t.groups,c={uri:`did:${n}:${i}`,method:n,id:i};if(o&&(c.path=o),s&&(c.query=s.slice(1)),a&&(c.fragment=a.slice(1)),s){let d={},u=s.slice(1).split("&");for(let h of u){let[m,w]=h.split("=");d[m]=w}c.params=d}return c}};We.METHOD_PATTERN="([a-z0-9]+)",We.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})",We.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${We.PCT_ENCODED_PATTERN})`,We.METHOD_ID_PATTERN=`((?:${We.ID_CHAR_PATTERN}*:)*(${We.ID_CHAR_PATTERN}+))`,We.PATH_PATTERN="(/[^#?]*)?",We.QUERY_PATTERN="([?][^#]*)?",We.FRAGMENT_PATTERN="(#.*)?",We.DID_URI_PATTERN=new RegExp(`^did:(?<method>${We.METHOD_PATTERN}):(?<id>${We.METHOD_ID_PATTERN})(?<path>${We.PATH_PATTERN})(?<query>${We.QUERY_PATTERN})(?<fragment>${We.FRAGMENT_PATTERN})$`);var Re=We;var mB=l(f(),1),$=class r extends Error{constructor(t,n){super(`${t}: ${n}`);this.code=t;this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,r)}},jr=(p=>(p.InvalidDid="invalidDid",p.MethodNotSupported="methodNotSupported",p.InternalError="internalError",p.InvalidDidDocument="invalidDidDocument",p.InvalidDidDocumentLength="invalidDidDocumentLength",p.InvalidDidUrl="invalidDidUrl",p.InvalidPreviousDidProof="invalidPreviousDidProof",p.InvalidPublicKey="invalidPublicKey",p.InvalidPublicKeyLength="invalidPublicKeyLength",p.InvalidPublicKeyType="invalidPublicKeyType",p.InvalidSignature="invalidSignature",p.NotFound="notFound",p.RepresentationNotSupported="representationNotSupported",p.UnsupportedPublicKeyType="unsupportedPublicKeyType",p))(jr||{});var hK=l(f(),1);var XC=l(f(),1);var sC=l(f(),1);var r5=l(f(),1);var xB=l(f(),1),Fx=l(id(),1);var r8=l(f(),1);var MB=l(f(),1);var DB=l(f(),1);var vB=l(f(),1),EB=new Uint8Array(0);function Tp(r,e){if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0}function eo(r){if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")}var AB=l(f(),1);function Hx(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=i}var a=r.length,c=r.charAt(0),d=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var b=0,v=0,S=0,D=p.length;S!==D&&p[S]===0;)S++,b++;for(var E=(D-S)*u+1>>>0,R=new Uint8Array(E);S!==D;){for(var I=p[S],O=0,C=E-1;(I!==0||O<v)&&C!==-1;C--,O++)I+=256*R[C]>>>0,R[C]=I%a>>>0,I=I/a>>>0;if(I!==0)throw new Error("Non-zero carry");v=O,S++}for(var U=E-v;U!==E&&R[U]===0;)U++;for(var V=c.repeat(b);U<E;++U)V+=r.charAt(R[U]);return V}function m(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var b=0;if(p[b]!==" "){for(var v=0,S=0;p[b]===c;)v++,b++;for(var D=(p.length-b)*d+1>>>0,E=new Uint8Array(D);p[b];){var R=t[p.charCodeAt(b)];if(R===255)return;for(var I=0,O=D-1;(R!==0||I<S)&&O!==-1;O--,I++)R+=a*E[O]>>>0,E[O]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");S=I,b++}if(p[b]!==" "){for(var C=D-S;C!==D&&E[C]===0;)C++;for(var U=new Uint8Array(v+(D-C)),V=v;C!==D;)U[V++]=E[C++];return U}}}function w(p){var b=m(p);if(b)return b;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:m,decode:w}}var jx=Hx,Wx=jx,Ip=Wx;var od=class{name;prefix;baseEncode;constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},sd=class{name;prefix;baseDecode;prefixCodePoint;constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return Dp(this,e)}},ad=class{decoders;constructor(e){this.decoders=e}or(e){return Dp(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function Dp(r,e){return new ad({...r.decoders??{[r.prefix]:r},...e.decoders??{[e.prefix]:e}})}var cd=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new od(e,t,n),this.decoder=new sd(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function Bp({name:r,prefix:e,encode:t,decode:n}){return new cd(r,e,t,n)}function ud({name:r,prefix:e,alphabet:t}){let{encode:n,decode:i}=Ip(t,r);return Bp({prefix:e,name:r,encode:n,decode:o=>eo(i(o))})}function zx(r,e,t,n){let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*t/8|0),a=0,c=0,d=0;for(let u=0;u<o;++u){let h=i[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,s[d++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s}function Gx(r,e,t){let n=e[e.length-1]==="=",i=(1<<t)-1,o="",s=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],s+=8;s>t;)s-=t,o+=e[i&a>>s];if(s!==0&&(o+=e[i&a<<t-s]),n)for(;o.length*t&7;)o+="=";return o}function ft({name:r,prefix:e,bitsPerChar:t,alphabet:n}){return Bp({prefix:e,name:r,encode(i){return Gx(i,n,t)},decode(i){return zx(i,n,t,r)}})}var ss=ft({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),RB=ft({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),OB=ft({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),UB=ft({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),CB=ft({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),kB=ft({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),PB=ft({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),KB=ft({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),dd=ft({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var FB=l(f(),1);var Et=ud({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),$B=ud({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var GB=l(f(),1);var HB=ft({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),jB=ft({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),wr=ft({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),WB=ft({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var YB=l(f(),1);function Rp(r){return r.byteOffset!==0||r.byteLength!==r.buffer.byteLength}function Op(r){return typeof r!="object"||r===null?!1:typeof r[Symbol.asyncIterator]=="function"}function La(r){let t=Object.prototype.toString.call(r).match(/\s([a-zA-Z0-9]+)/),[n,i]=t;return i}var as=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},Up=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=r[o]&&function(s){return new Promise(function(a,c){s=r[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(d){o({value:d,done:a})},s)}},Ma=new TextEncoder,ri=new TextDecoder,z=class r{constructor(e,t){this.data=e,this.format=t}static arrayBuffer(e){return new r(e,"ArrayBuffer")}static asyncIterable(e){if(!Op(e))throw new TypeError("Input must be of type AsyncIterable.");return new r(e,"AsyncIterable")}static base32Z(e){return new r(e,"Base32Z")}static base58Btc(e){return new r(e,"Base58Btc")}static base64Url(e){return new r(e,"Base64Url")}static bufferSource(e){return new r(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new r(e,"Hex")}static multibase(e){return new r(e,"Multibase")}static object(e){return new r(e,"Object")}static string(e){return new r(e,"String")}static uint8Array(e){return new r(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return Et.baseDecode(this.data).buffer;case"Base64Url":return wr.baseDecode(this.data).buffer;case"BufferSource":{if(La(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return Rp(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return as(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return dd.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{let e=new Uint8Array(this.data);return Et.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return Et.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{let e=new Uint8Array(this.data);return wr.baseEncode(e)}case"BufferSource":{let e=this.toUint8Array();return wr.baseEncode(e)}case"Object":{let e=JSON.stringify(this.data),t=Ma.encode(e);return wr.baseEncode(t)}case"String":{let e=Ma.encode(this.data);return wr.baseEncode(e)}case"Uint8Array":return wr.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){return as(this,void 0,void 0,function*(){var e,t,n,i;switch(this.format){case"AsyncIterable":{let c=[];try{for(var o=!0,s=Up(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;let u=i;c.push(u)}}catch(u){t={error:u}}finally{try{!o&&!e&&(n=s.return)&&(yield n.call(s))}finally{if(t)throw t.error}}return new Blob(c)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){let e=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{let t=this.toUint8Array();return r.uint8Array(t).toHex()}case"Base64Url":{let t=this.toUint8Array();return r.uint8Array(t).toHex()}case"Uint8Array":{let t="";for(let n=0;n<this.data.length;n++)t+=e[this.data[n]];return t}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{let e=wr.baseDecode(this.data),t=ri.decode(e);return JSON.parse(t)}case"String":return JSON.parse(this.data);case"Uint8Array":{let e=ri.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return as(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return ri.decode(this.data);case"Base64Url":{let e=wr.baseDecode(this.data);return ri.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return ri.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){return as(this,void 0,void 0,function*(){var e,t,n,i;switch(this.format){case"AsyncIterable":{let c="";try{for(var o=!0,s=Up(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;let d=i;typeof d=="string"?c+=d:c+=ri.decode(d,{stream:!0})}}catch(d){t={error:d}}finally{try{!o&&!e&&(n=s.return)&&(yield n.call(s))}finally{if(t)throw t.error}}return c+=ri.decode(void 0,{stream:!1}),c}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return dd.baseDecode(this.data);case"Base58Btc":return Et.baseDecode(this.data);case"Base64Url":return wr.baseDecode(this.data);case"BufferSource":{let e=La(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{let e=new Uint8Array(this.data.length/2);for(let t=0;t<this.data.length;t+=2){let n=parseInt(this.data.substring(t,t+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[t/2]=n}return e}case"Object":{let e=JSON.stringify(this.data);return Ma.encode(e)}case"String":return Ma.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return as(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var C8=l(f(),1);var B8=l(f(),1);var p8=l(f(),1);var c8=l(f(),1);var Wr={};is(Wr,{decode:()=>to,encodeTo:()=>ni,encodingLength:()=>ii});var s8=l(f(),1);var i8=l(f(),1),Jx=Pp,Cp=128,Yx=127,Xx=~Yx,Zx=Math.pow(2,31);function Pp(r,e,t){e=e||[],t=t||0;for(var n=t;r>=Zx;)e[t++]=r&255|Cp,r/=128;for(;r&Xx;)e[t++]=r&255|Cp,r>>>=7;return e[t]=r|0,Pp.bytes=t-n+1,e}var Qx=ld,eE=128,kp=127;function ld(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a)throw ld.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&kp)<<i:(s&kp)*Math.pow(2,i),i+=7}while(s>=eE);return ld.bytes=o-n,t}var tE=Math.pow(2,7),rE=Math.pow(2,14),nE=Math.pow(2,21),iE=Math.pow(2,28),oE=Math.pow(2,35),sE=Math.pow(2,42),aE=Math.pow(2,49),cE=Math.pow(2,56),uE=Math.pow(2,63),dE=function(r){return r<tE?1:r<rE?2:r<nE?3:r<iE?4:r<oE?5:r<sE?6:r<aE?7:r<cE?8:r<uE?9:10},lE={encode:Jx,decode:Qx,encodingLength:dE},fE=lE,cs=fE;function to(r,e=0){return[cs.decode(r,e),cs.decode.bytes]}function ni(r,e,t=0){return cs.encode(r,e,t),e}function ii(r){return cs.encodingLength(r)}function fd(r,e){let t=e.byteLength,n=ii(r),i=n+ii(t),o=new Uint8Array(i+t);return ni(r,o,0),ni(t,o,n),o.set(e,i),new ro(r,t,e,o)}function Kp(r){let e=eo(r),[t,n]=to(e),[i,o]=to(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new ro(t,i,s,e)}function Lp(r,e){if(r===e)return!0;{let t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&Tp(r.bytes,t.bytes)}}var ro=class{code;size;digest;bytes;constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}};var u8=l(f(),1);function Mp(r,e){let{bytes:t,version:n}=r;switch(n){case 0:return pE(t,pd(r),e??Et.encoder);default:return yE(t,pd(r),e??ss.encoder)}}var Np=new WeakMap;function pd(r){let e=Np.get(r);if(e==null){let t=new Map;return Np.set(r,t),t}return e}var yd=class r{code;version;multihash;bytes;"/";constructor(e,t,n,i){this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:t}=this;if(e!==us)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==mE)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=fd(e,t);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return r.equals(this,e)}static equals(e,t){let n=t;return n!=null&&e.code===n.code&&e.version===n.version&&Lp(e.multihash,n.multihash)}toString(e){return Mp(this,e)}toJSON(){return{"/":Mp(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let t=e;if(t instanceof r)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){let{version:n,code:i,multihash:o,bytes:s}=t;return new r(n,i,o,s??$p(n,i,o.bytes))}else if(t[gE]===!0){let{version:n,multihash:i,code:o}=t,s=Kp(i);return r.create(n,o,s)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==us)throw new Error(`Version 0 CID must use dag-pb (code: ${us}) block encoding`);return new r(e,t,n,n.bytes)}case 1:{let i=$p(e,t,n.bytes);return new r(e,t,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return r.create(0,us,e)}static createV1(e,t){return r.create(1,e,t)}static decode(e){let[t,n]=r.decodeFirst(e);if(n.length!==0)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=r.inspectBytes(e),n=t.size-t.multihashSize,i=eo(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");let o=i.subarray(t.multihashSize-t.digestSize),s=new ro(t.multihashCode,t.digestSize,o,i);return[t.version===0?r.createV0(s):r.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[h,m]=to(e.subarray(t));return t+=m,h},i=n(),o=us;if(i===18?(i=0,t=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=t,a=n(),c=n(),d=t+c,u=d-s;return{version:i,codec:o,multihashCode:a,digestSize:c,multihashSize:u,size:d}}static parse(e,t){let[n,i]=hE(e,t),o=r.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return pd(o).set(n,e),o}};function hE(r,e){switch(r[0]){case"Q":{let t=e??Et;return[Et.prefix,t.decode(`${Et.prefix}${r}`)]}case Et.prefix:{let t=e??Et;return[Et.prefix,t.decode(r)]}case ss.prefix:{let t=e??ss;return[ss.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}}function pE(r,e,t){let{prefix:n}=t;if(n!==Et.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let i=e.get(n);if(i==null){let o=t.encode(r).slice(1);return e.set(n,o),o}else return i}function yE(r,e,t){let{prefix:n}=t,i=e.get(n);if(i==null){let o=t.encode(r);return e.set(n,o),o}else return i}var us=112,mE=18;function $p(r,e,t){let n=ii(r),i=n+ii(e),o=new Uint8Array(i+t.byteLength);return ni(r,o,0),ni(e,o,n),o.set(t,i),o}var gE=Symbol.for("@ipld/js-cid/CID");var m8=l(f(),1);var E8=l(f(),1);var g8=l(f(),1);var w8=l(f(),1);var b8=l(f(),1);var x8=l(f(),1);var br=class r{static addPrefix(e){var t;let{code:n,data:i,name:o}=e;if(!(o?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=r.codeToName.has(n)?n:r.nameToCode.get(o),n===void 0)throw new Error(`Unsupported multicodec: ${(t=e.name)!==null&&t!==void 0?t:e.code}`);let s=Wr.encodingLength(n),a=new Uint8Array(s+i.byteLength);return a.set(i,s),Wr.encodeTo(n,a),a}static getCodeFromData(e){let{prefixedData:t}=e,[n,i]=Wr.decode(t);return n}static getCodeFromName(e){let{name:t}=e,n=r.nameToCode.get(t);if(n===void 0)throw new Error(`Unsupported multicodec: ${t}`);return n}static getNameFromCode(e){let{code:t}=e,n=r.codeToName.get(t);if(n===void 0)throw new Error(`Unsupported multicodec: ${t}`);return n}static registerCodec(e){r.codeToName.set(e.code,e.name),r.nameToCode.set(e.name,e.code)}static removePrefix(e){let{prefixedData:t}=e,[n,i]=Wr.decode(t),o=r.codeToName.get(n);if(o===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:t.slice(i),name:o}}};br.codeToName=new Map;br.nameToCode=new Map;br.registerCodec({code:237,name:"ed25519-pub"});br.registerCodec({code:4864,name:"ed25519-priv"});br.registerCodec({code:236,name:"x25519-pub"});br.registerCodec({code:4866,name:"x25519-priv"});br.registerCodec({code:231,name:"secp256k1-pub"});br.registerCodec({code:4865,name:"secp256k1-priv"});var P8=l(f(),1);function md(r){Object.keys(r).forEach(e=>{r[e]===void 0?delete r[e]:typeof r[e]=="object"&&md(r[e])})}var HR=l(f(),1),Av=l(ul(),1),bi=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})};var fc=class{constructor(){this.store=new Map}clear(){return bi(this,void 0,void 0,function*(){this.store.clear()})}close(){return bi(this,void 0,void 0,function*(){})}delete(e){return bi(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return bi(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return bi(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return bi(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,t){return bi(this,void 0,void 0,function*(){this.store.set(e,t)})}};var zR=l(f(),1);var e5=l(f(),1),E_=l(qs(),1);var v_=l(qs(),1);var L5=l(f(),1);var O5=l(f(),1);var D5=l(f(),1);var A5=l(f(),1);var f5=l(f(),1);function S_(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}function vf(r,...e){if(!S_(r))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(r.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${r.length}`)}function Sf(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Kg(r,e){vf(r);let t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}var x5=l(f(),1);var p5=l(f(),1),Ao=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var jc=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),sr=(r,e)=>r<<32-e|r>>>e;var g5=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function A_(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Af(r){return typeof r=="string"&&(r=A_(r)),vf(r),r}var Hc=class{clone(){return this._cloneInto()}},w5={}.toString;function Lg(r){let e=n=>r().update(Af(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Mg(r=32){if(Ao&&typeof Ao.getRandomValues=="function")return Ao.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}function __(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(t>>i&o),a=Number(t&o),c=n?4:0,d=n?0:4;r.setUint32(e+c,s,n),r.setUint32(e+d,a,n)}var Ng=(r,e,t)=>r&e^~r&t,$g=(r,e,t)=>r&e^r&t^e&t,Wc=class extends Hc{constructor(e,t,n,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=jc(this.buffer)}update(e){Sf(this);let{view:t,buffer:n,blockLen:i}=this;e=Af(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let c=jc(e);for(;i<=o-s;s+=i)this.process(c,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){Sf(this),Kg(e,this),this.finished=!0;let{buffer:t,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)t[h]=0;__(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=jc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let d=c/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<d;h++)a.setUint32(4*h,u[h],o)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%t&&e.buffer.set(n),e}};var T_=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),kn=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Pn=new Uint32Array(64),_f=class extends Wc{constructor(){super(64,32,8,!1),this.A=kn[0]|0,this.B=kn[1]|0,this.C=kn[2]|0,this.D=kn[3]|0,this.E=kn[4]|0,this.F=kn[5]|0,this.G=kn[6]|0,this.H=kn[7]|0}get(){let{A:e,B:t,C:n,D:i,E:o,F:s,G:a,H:c}=this;return[e,t,n,i,o,s,a,c]}set(e,t,n,i,o,s,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)Pn[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){let m=Pn[h-15],w=Pn[h-2],p=sr(m,7)^sr(m,18)^m>>>3,b=sr(w,17)^sr(w,19)^w>>>10;Pn[h]=b+Pn[h-7]+p+Pn[h-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:c,G:d,H:u}=this;for(let h=0;h<64;h++){let m=sr(a,6)^sr(a,11)^sr(a,25),w=u+m+Ng(a,c,d)+T_[h]+Pn[h]|0,b=(sr(n,2)^sr(n,13)^sr(n,22))+$g(n,i,o)|0;u=d,d=c,c=a,a=s+w|0,s=o,o=i,i=n,n=w+b|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,d=d+this.G|0,u=u+this.H|0,this.set(n,i,o,s,a,c,d,u)}roundClean(){Pn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Kn=Lg(()=>new _f);var I_=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},_o=class{static digest(e){return I_(this,arguments,void 0,function*({data:t}){return Kn(t)})}};var C5=l(f(),1),Ur=class{};var D_=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},zc=class extends Ur{digest(e){return D_(this,arguments,void 0,function*({algorithm:t,data:n}){switch(t){case"SHA-256":return yield _o.digest({data:n})}})}};var aU=l(f(),1);var VO=l(f(),1);var BO=l(f(),1);var Q5=l(f(),1);var J5=l(f(),1);var N5=l(f(),1);function qg(r){if(!Number.isSafeInteger(r)||r<0)throw new Error(`Wrong positive integer: ${r}`)}function B_(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}function Tf(r,...e){if(!B_(r))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(r.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${r.length}`)}function Fg(r){if(typeof r!="function"||typeof r.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");qg(r.outputLen),qg(r.blockLen)}function To(r,e=!0){if(r.destroyed)throw new Error("Hash instance has been destroyed");if(e&&r.finished)throw new Error("Hash#digest() has already been called")}function Vg(r,e){Tf(r);let t=e.outputLen;if(r.length<t)throw new Error(`digestInto() expects output buffer of length at least ${t}`)}var j5=l(f(),1);var q5=l(f(),1),Gc=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function Hg(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}var Jc=r=>new DataView(r.buffer,r.byteOffset,r.byteLength),ar=(r,e)=>r<<32-e|r>>>e,R_=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!R_)throw new Error("Non little-endian hardware is not supported");function If(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function Fs(r){if(typeof r=="string"&&(r=If(r)),!Hg(r))throw new Error(`expected Uint8Array, got ${typeof r}`);return r}function Yc(...r){let e=0;for(let n=0;n<r.length;n++){let i=r[n];if(!Hg(i))throw new Error("Uint8Array expected");e+=i.length}let t=new Uint8Array(e);for(let n=0,i=0;n<r.length;n++){let o=r[n];t.set(o,i),i+=o.length}return t}var Io=class{clone(){return this._cloneInto()}},V5={}.toString;function Xc(r){let e=n=>r().update(Fs(n)).digest(),t=r();return e.outputLen=t.outputLen,e.blockLen=t.blockLen,e.create=()=>r(),e}function Vs(r=32){if(Gc&&typeof Gc.getRandomValues=="function")return Gc.getRandomValues(new Uint8Array(r));throw new Error("crypto.getRandomValues must be defined")}function O_(r,e,t,n){if(typeof r.setBigUint64=="function")return r.setBigUint64(e,t,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(t>>i&o),a=Number(t&o),c=n?4:0,d=n?0:4;r.setUint32(e+c,s,n),r.setUint32(e+d,a,n)}var Do=class extends Io{constructor(e,t,n,i){super(),this.blockLen=e,this.outputLen=t,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Jc(this.buffer)}update(e){To(this);let{view:t,buffer:n,blockLen:i}=this;e=Fs(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let c=Jc(e);for(;i<=o-s;s+=i)this.process(c,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(t,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){To(this),Vg(e,this),this.finished=!0;let{buffer:t,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;t[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let h=s;h<i;h++)t[h]=0;O_(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=Jc(e),c=this.outputLen;if(c%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let d=c/4,u=this.get();if(d>u.length)throw new Error("_sha2: outputLen bigger than state");for(let h=0;h<d;h++)a.setUint32(4*h,u[h],o)}digest(){let{buffer:e,outputLen:t}=this;this.digestInto(e);let n=e.slice(0,t);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:t,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%t&&e.buffer.set(n),e}};var U_=(r,e,t)=>r&e^~r&t,C_=(r,e,t)=>r&e^r&t^e&t,k_=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Ln=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Mn=new Uint32Array(64),Df=class extends Do{constructor(){super(64,32,8,!1),this.A=Ln[0]|0,this.B=Ln[1]|0,this.C=Ln[2]|0,this.D=Ln[3]|0,this.E=Ln[4]|0,this.F=Ln[5]|0,this.G=Ln[6]|0,this.H=Ln[7]|0}get(){let{A:e,B:t,C:n,D:i,E:o,F:s,G:a,H:c}=this;return[e,t,n,i,o,s,a,c]}set(e,t,n,i,o,s,a,c){this.A=e|0,this.B=t|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=c|0}process(e,t){for(let h=0;h<16;h++,t+=4)Mn[h]=e.getUint32(t,!1);for(let h=16;h<64;h++){let m=Mn[h-15],w=Mn[h-2],p=ar(m,7)^ar(m,18)^m>>>3,b=ar(w,17)^ar(w,19)^w>>>10;Mn[h]=b+Mn[h-7]+p+Mn[h-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:c,G:d,H:u}=this;for(let h=0;h<64;h++){let m=ar(a,6)^ar(a,11)^ar(a,25),w=u+m+U_(a,c,d)+k_[h]+Mn[h]|0,b=(ar(n,2)^ar(n,13)^ar(n,22))+C_(n,i,o)|0;u=d,d=c,c=a,a=s+w|0,s=o,o=i,i=n,n=w+b|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,c=c+this.F|0,d=d+this.G|0,u=u+this.H|0,this.set(n,i,o,s,a,c,d,u)}roundClean(){Mn.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var Zc=Xc(()=>new Df);var rO=l(f(),1);var eu={};is(eu,{bitGet:()=>q_,bitLen:()=>$_,bitMask:()=>Hs,bitSet:()=>F_,bytesToHex:()=>cn,bytesToNumberBE:()=>un,bytesToNumberLE:()=>ur,concatBytes:()=>ln,createHmacDrbg:()=>Of,ensureBytes:()=>Ae,equalBytes:()=>M_,hexToBytes:()=>Ui,hexToNumber:()=>Rf,isBytes:()=>cr,numberToBytesBE:()=>St,numberToBytesLE:()=>dn,numberToHexUnpadded:()=>Gg,numberToVarBytesBE:()=>L_,utf8ToBytes:()=>N_,validateObject:()=>Gt});var eO=l(f(),1);var zg=BigInt(0),Qc=BigInt(1),P_=BigInt(2);function cr(r){return r instanceof Uint8Array||r!=null&&typeof r=="object"&&r.constructor.name==="Uint8Array"}var K_=Array.from({length:256},(r,e)=>e.toString(16).padStart(2,"0"));function cn(r){if(!cr(r))throw new Error("Uint8Array expected");let e="";for(let t=0;t<r.length;t++)e+=K_[r[t]];return e}function Gg(r){let e=r.toString(16);return e.length&1?`0${e}`:e}function Rf(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);return BigInt(r===""?"0":`0x${r}`)}var an={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function jg(r){if(r>=an._0&&r<=an._9)return r-an._0;if(r>=an._A&&r<=an._F)return r-(an._A-10);if(r>=an._a&&r<=an._f)return r-(an._a-10)}function Ui(r){if(typeof r!="string")throw new Error("hex string expected, got "+typeof r);let e=r.length,t=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(t);for(let i=0,o=0;i<t;i++,o+=2){let s=jg(r.charCodeAt(o)),a=jg(r.charCodeAt(o+1));if(s===void 0||a===void 0){let c=r[o]+r[o+1];throw new Error('hex string expected, got non-hex character "'+c+'" at index '+o)}n[i]=s*16+a}return n}function un(r){return Rf(cn(r))}function ur(r){if(!cr(r))throw new Error("Uint8Array expected");return Rf(cn(Uint8Array.from(r).reverse()))}function St(r,e){return Ui(r.toString(16).padStart(e*2,"0"))}function dn(r,e){return St(r,e).reverse()}function L_(r){return Ui(Gg(r))}function Ae(r,e,t){let n;if(typeof e=="string")try{n=Ui(e)}catch(o){throw new Error(`${r} must be valid hex string, got "${e}". Cause: ${o}`)}else if(cr(e))n=Uint8Array.from(e);else throw new Error(`${r} must be hex string or Uint8Array`);let i=n.length;if(typeof t=="number"&&i!==t)throw new Error(`${r} expected ${t} bytes, got ${i}`);return n}function ln(...r){let e=0;for(let i=0;i<r.length;i++){let o=r[i];if(!cr(o))throw new Error("Uint8Array expected");e+=o.length}let t=new Uint8Array(e),n=0;for(let i=0;i<r.length;i++){let o=r[i];t.set(o,n),n+=o.length}return t}function M_(r,e){if(r.length!==e.length)return!1;let t=0;for(let n=0;n<r.length;n++)t|=r[n]^e[n];return t===0}function N_(r){if(typeof r!="string")throw new Error(`utf8ToBytes expected string, got ${typeof r}`);return new Uint8Array(new TextEncoder().encode(r))}function $_(r){let e;for(e=0;r>zg;r>>=Qc,e+=1);return e}function q_(r,e){return r>>BigInt(e)&Qc}var F_=(r,e,t)=>r|(t?Qc:zg)<<BigInt(e),Hs=r=>(P_<<BigInt(r-1))-Qc,Bf=r=>new Uint8Array(r),Wg=r=>Uint8Array.from(r);function Of(r,e,t){if(typeof r!="number"||r<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof t!="function")throw new Error("hmacFn must be a function");let n=Bf(r),i=Bf(r),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...h)=>t(i,n,...h),c=(h=Bf())=>{i=a(Wg([0]),h),n=a(),h.length!==0&&(i=a(Wg([1]),h),n=a())},d=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let h=0,m=[];for(;h<e;){n=a();let w=n.slice();m.push(w),h+=n.length}return ln(...m)};return(h,m)=>{s(),c(h);let w;for(;!(w=m(d()));)c();return s(),w}}var V_={bigint:r=>typeof r=="bigint",function:r=>typeof r=="function",boolean:r=>typeof r=="boolean",string:r=>typeof r=="string",stringOrUint8Array:r=>typeof r=="string"||cr(r),isSafeInteger:r=>Number.isSafeInteger(r),array:r=>Array.isArray(r),field:(r,e)=>e.Fp.isValid(r),hash:r=>typeof r=="function"&&Number.isSafeInteger(r.outputLen)};function Gt(r,e,t={}){let n=(i,o,s)=>{let a=V_[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let c=r[i];if(!(s&&c===void 0)&&!a(c,r))throw new Error(`Invalid param ${String(i)}=${c} (${typeof c}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(t))n(i,o,!0);return r}var Ge=BigInt(0),Oe=BigInt(1),Ci=BigInt(2),H_=BigInt(3),Uf=BigInt(4),Jg=BigInt(5),Yg=BigInt(8),j_=BigInt(9),W_=BigInt(16);function ye(r,e){let t=r%e;return t>=Ge?t:e+t}function Cf(r,e,t){if(t<=Ge||e<Ge)throw new Error("Expected power/modulo > 0");if(t===Oe)return Ge;let n=Oe;for(;e>Ge;)e&Oe&&(n=n*r%t),r=r*r%t,e>>=Oe;return n}function _e(r,e,t){let n=r;for(;e-- >Ge;)n*=n,n%=t;return n}function tu(r,e){if(r===Ge||e<=Ge)throw new Error(`invert: expected positive integers, got n=${r} mod=${e}`);let t=ye(r,e),n=e,i=Ge,o=Oe,s=Oe,a=Ge;for(;t!==Ge;){let d=n/t,u=n%t,h=i-s*d,m=o-a*d;n=t,t=u,i=s,o=a,s=h,a=m}if(n!==Oe)throw new Error("invert: does not exist");return ye(i,e)}function z_(r){let e=(r-Oe)/Ci,t,n,i;for(t=r-Oe,n=0;t%Ci===Ge;t/=Ci,n++);for(i=Ci;i<r&&Cf(i,e,r)!==r-Oe;i++);if(n===1){let s=(r+Oe)/Uf;return function(c,d){let u=c.pow(d,s);if(!c.eql(c.sqr(u),d))throw new Error("Cannot find square root");return u}}let o=(t+Oe)/Ci;return function(a,c){if(a.pow(c,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let d=n,u=a.pow(a.mul(a.ONE,i),t),h=a.pow(c,o),m=a.pow(c,t);for(;!a.eql(m,a.ONE);){if(a.eql(m,a.ZERO))return a.ZERO;let w=1;for(let b=a.sqr(m);w<d&&!a.eql(b,a.ONE);w++)b=a.sqr(b);let p=a.pow(u,Oe<<BigInt(d-w-1));u=a.sqr(p),h=a.mul(h,p),m=a.mul(m,u),d=w}return h}}function G_(r){if(r%Uf===H_){let e=(r+Oe)/Uf;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(r%Yg===Jg){let e=(r-Jg)/Yg;return function(n,i){let o=n.mul(i,Ci),s=n.pow(o,e),a=n.mul(i,s),c=n.mul(n.mul(a,Ci),s),d=n.mul(a,n.sub(c,n.ONE));if(!n.eql(n.sqr(d),i))throw new Error("Cannot find square root");return d}}return r%W_,z_(r)}var Xg=(r,e)=>(ye(r,e)&Oe)===Oe,J_=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function kf(r){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},t=J_.reduce((n,i)=>(n[i]="function",n),e);return Gt(r,t)}function Y_(r,e,t){if(t<Ge)throw new Error("Expected power > 0");if(t===Ge)return r.ONE;if(t===Oe)return e;let n=r.ONE,i=e;for(;t>Ge;)t&Oe&&(n=r.mul(n,i)),i=r.sqr(i),t>>=Oe;return n}function X_(r,e){let t=new Array(e.length),n=e.reduce((o,s,a)=>r.is0(s)?o:(t[a]=o,r.mul(o,s)),r.ONE),i=r.inv(n);return e.reduceRight((o,s,a)=>r.is0(s)?o:(t[a]=r.mul(o,t[a]),r.mul(o,s)),i),t}function Pf(r,e){let t=e!==void 0?e:r.toString(2).length,n=Math.ceil(t/8);return{nBitLength:t,nByteLength:n}}function Bo(r,e,t=!1,n={}){if(r<=Ge)throw new Error(`Expected Field ORDER > 0, got ${r}`);let{nBitLength:i,nByteLength:o}=Pf(r,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=G_(r),a=Object.freeze({ORDER:r,BITS:i,BYTES:o,MASK:Hs(i),ZERO:Ge,ONE:Oe,create:c=>ye(c,r),isValid:c=>{if(typeof c!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof c}`);return Ge<=c&&c<r},is0:c=>c===Ge,isOdd:c=>(c&Oe)===Oe,neg:c=>ye(-c,r),eql:(c,d)=>c===d,sqr:c=>ye(c*c,r),add:(c,d)=>ye(c+d,r),sub:(c,d)=>ye(c-d,r),mul:(c,d)=>ye(c*d,r),pow:(c,d)=>Y_(a,c,d),div:(c,d)=>ye(c*tu(d,r),r),sqrN:c=>c*c,addN:(c,d)=>c+d,subN:(c,d)=>c-d,mulN:(c,d)=>c*d,inv:c=>tu(c,r),sqrt:n.sqrt||(c=>s(a,c)),invertBatch:c=>X_(a,c),cmov:(c,d,u)=>u?d:c,toBytes:c=>t?dn(c,o):St(c,o),fromBytes:c=>{if(c.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${c.length}`);return t?ur(c):un(c)}});return Object.freeze(a)}function Zg(r,e){if(!r.isOdd)throw new Error("Field doesn't have isOdd");let t=r.sqrt(e);return r.isOdd(t)?r.neg(t):t}function Qg(r){if(typeof r!="bigint")throw new Error("field order must be bigint");let e=r.toString(2).length;return Math.ceil(e/8)}function Kf(r){let e=Qg(r);return e+Math.ceil(e/2)}function ew(r,e,t=!1){let n=r.length,i=Qg(e),o=Kf(e);if(n<16||n<o||n>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${n}`);let s=t?un(r):ur(r),a=ye(s,e-Oe)+Oe;return t?dn(a,i):St(a,i)}var hO=l(f(),1);var sO=l(f(),1);var Q_=BigInt(0),Lf=BigInt(1);function ru(r,e){let t=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:t,unsafeLadder(i,o){let s=r.ZERO,a=i;for(;o>Q_;)o&Lf&&(s=s.add(a)),a=a.double(),o>>=Lf;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),c=[],d=i,u=d;for(let h=0;h<s;h++){u=d,c.push(u);for(let m=1;m<a;m++)u=u.add(d),c.push(u);d=u.double()}return c},wNAF(i,o,s){let{windows:a,windowSize:c}=n(i),d=r.ZERO,u=r.BASE,h=BigInt(2**i-1),m=2**i,w=BigInt(i);for(let p=0;p<a;p++){let b=p*c,v=Number(s&h);s>>=w,v>c&&(v-=m,s+=Lf);let S=b,D=b+Math.abs(v)-1,E=p%2!==0,R=v<0;v===0?u=u.add(t(E,o[S])):d=d.add(t(R,o[D]))}return{p:d,f:u}},wNAFCached(i,o,s,a){let c=i._WINDOW_SIZE||1,d=o.get(i);return d||(d=this.precomputeWindow(i,c),c!==1&&o.set(i,a(d))),this.wNAF(c,d,s)}}}function js(r){return kf(r.Fp),Gt(r,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...Pf(r.n,r.nBitLength),...r,p:r.Fp.ORDER})}function eT(r){let e=js(r);Gt(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:t,Fp:n,a:i}=e;if(t){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof t!="object"||typeof t.beta!="bigint"||typeof t.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:tT,hexToBytes:rT}=eu,ki={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(r){let{Err:e}=ki;if(r.length<2||r[0]!==2)throw new e("Invalid signature integer tag");let t=r[1],n=r.subarray(2,t+2);if(!t||n.length!==t)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:tT(n),l:r.subarray(t+2)}},toSig(r){let{Err:e}=ki,t=typeof r=="string"?rT(r):r;if(!cr(t))throw new Error("ui8a expected");let n=t.length;if(n<2||t[0]!=48)throw new e("Invalid signature tag");if(t[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=ki._parseInt(t.subarray(2)),{d:s,l:a}=ki._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(r){let e=d=>Number.parseInt(d[0],16)&8?"00"+d:d,t=d=>{let u=d.toString(16);return u.length&1?`0${u}`:u},n=e(t(r.s)),i=e(t(r.r)),o=n.length/2,s=i.length/2,a=t(o),c=t(s);return`30${t(s+o+4)}02${c}${i}02${a}${n}`}},fn=BigInt(0),Jt=BigInt(1),dO=BigInt(2),tw=BigInt(3),lO=BigInt(4);function nT(r){let e=eT(r),{Fp:t}=e,n=e.toBytes||((p,b,v)=>{let S=b.toAffine();return ln(Uint8Array.from([4]),t.toBytes(S.x),t.toBytes(S.y))}),i=e.fromBytes||(p=>{let b=p.subarray(1),v=t.fromBytes(b.subarray(0,t.BYTES)),S=t.fromBytes(b.subarray(t.BYTES,2*t.BYTES));return{x:v,y:S}});function o(p){let{a:b,b:v}=e,S=t.sqr(p),D=t.mul(S,p);return t.add(t.add(D,t.mul(p,b)),v)}if(!t.eql(t.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(p){return typeof p=="bigint"&&fn<p&&p<e.n}function a(p){if(!s(p))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function c(p){let{allowedPrivateKeyLengths:b,nByteLength:v,wrapPrivateKey:S,n:D}=e;if(b&&typeof p!="bigint"){if(cr(p)&&(p=cn(p)),typeof p!="string"||!b.includes(p.length))throw new Error("Invalid key");p=p.padStart(v*2,"0")}let E;try{E=typeof p=="bigint"?p:un(Ae("private key",p,v))}catch{throw new Error(`private key must be ${v} bytes, hex or bigint, not ${typeof p}`)}return S&&(E=ye(E,D)),a(E),E}let d=new Map;function u(p){if(!(p instanceof h))throw new Error("ProjectivePoint expected")}class h{constructor(b,v,S){if(this.px=b,this.py=v,this.pz=S,b==null||!t.isValid(b))throw new Error("x required");if(v==null||!t.isValid(v))throw new Error("y required");if(S==null||!t.isValid(S))throw new Error("z required")}static fromAffine(b){let{x:v,y:S}=b||{};if(!b||!t.isValid(v)||!t.isValid(S))throw new Error("invalid affine point");if(b instanceof h)throw new Error("projective point not allowed");let D=E=>t.eql(E,t.ZERO);return D(v)&&D(S)?h.ZERO:new h(v,S,t.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(b){let v=t.invertBatch(b.map(S=>S.pz));return b.map((S,D)=>S.toAffine(v[D])).map(h.fromAffine)}static fromHex(b){let v=h.fromAffine(i(Ae("pointHex",b)));return v.assertValidity(),v}static fromPrivateKey(b){return h.BASE.multiply(c(b))}_setWindowSize(b){this._WINDOW_SIZE=b,d.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!t.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:b,y:v}=this.toAffine();if(!t.isValid(b)||!t.isValid(v))throw new Error("bad point: x or y not FE");let S=t.sqr(v),D=o(b);if(!t.eql(S,D))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:b}=this.toAffine();if(t.isOdd)return!t.isOdd(b);throw new Error("Field doesn't support isOdd")}equals(b){u(b);let{px:v,py:S,pz:D}=this,{px:E,py:R,pz:I}=b,O=t.eql(t.mul(v,I),t.mul(E,D)),C=t.eql(t.mul(S,I),t.mul(R,D));return O&&C}negate(){return new h(this.px,t.neg(this.py),this.pz)}double(){let{a:b,b:v}=e,S=t.mul(v,tw),{px:D,py:E,pz:R}=this,I=t.ZERO,O=t.ZERO,C=t.ZERO,U=t.mul(D,D),V=t.mul(E,E),H=t.mul(R,R),W=t.mul(D,E);return W=t.add(W,W),C=t.mul(D,R),C=t.add(C,C),I=t.mul(b,C),O=t.mul(S,H),O=t.add(I,O),I=t.sub(V,O),O=t.add(V,O),O=t.mul(I,O),I=t.mul(W,I),C=t.mul(S,C),H=t.mul(b,H),W=t.sub(U,H),W=t.mul(b,W),W=t.add(W,C),C=t.add(U,U),U=t.add(C,U),U=t.add(U,H),U=t.mul(U,W),O=t.add(O,U),H=t.mul(E,R),H=t.add(H,H),U=t.mul(H,W),I=t.sub(I,U),C=t.mul(H,V),C=t.add(C,C),C=t.add(C,C),new h(I,O,C)}add(b){u(b);let{px:v,py:S,pz:D}=this,{px:E,py:R,pz:I}=b,O=t.ZERO,C=t.ZERO,U=t.ZERO,V=e.a,H=t.mul(e.b,tw),W=t.mul(v,E),Q=t.mul(S,R),de=t.mul(D,I),nt=t.add(v,S),k=t.add(E,R);nt=t.mul(nt,k),k=t.add(W,Q),nt=t.sub(nt,k),k=t.add(v,D);let M=t.add(E,I);return k=t.mul(k,M),M=t.add(W,de),k=t.sub(k,M),M=t.add(S,D),O=t.add(R,I),M=t.mul(M,O),O=t.add(Q,de),M=t.sub(M,O),U=t.mul(V,k),O=t.mul(H,de),U=t.add(O,U),O=t.sub(Q,U),U=t.add(Q,U),C=t.mul(O,U),Q=t.add(W,W),Q=t.add(Q,W),de=t.mul(V,de),k=t.mul(H,k),Q=t.add(Q,de),de=t.sub(W,de),de=t.mul(V,de),k=t.add(k,de),W=t.mul(Q,k),C=t.add(C,W),W=t.mul(M,k),O=t.mul(nt,O),O=t.sub(O,W),W=t.mul(nt,Q),U=t.mul(M,U),U=t.add(U,W),new h(O,C,U)}subtract(b){return this.add(b.negate())}is0(){return this.equals(h.ZERO)}wNAF(b){return w.wNAFCached(this,d,b,v=>{let S=t.invertBatch(v.map(D=>D.pz));return v.map((D,E)=>D.toAffine(S[E])).map(h.fromAffine)})}multiplyUnsafe(b){let v=h.ZERO;if(b===fn)return v;if(a(b),b===Jt)return this;let{endo:S}=e;if(!S)return w.unsafeLadder(this,b);let{k1neg:D,k1:E,k2neg:R,k2:I}=S.splitScalar(b),O=v,C=v,U=this;for(;E>fn||I>fn;)E&Jt&&(O=O.add(U)),I&Jt&&(C=C.add(U)),U=U.double(),E>>=Jt,I>>=Jt;return D&&(O=O.negate()),R&&(C=C.negate()),C=new h(t.mul(C.px,S.beta),C.py,C.pz),O.add(C)}multiply(b){a(b);let v=b,S,D,{endo:E}=e;if(E){let{k1neg:R,k1:I,k2neg:O,k2:C}=E.splitScalar(v),{p:U,f:V}=this.wNAF(I),{p:H,f:W}=this.wNAF(C);U=w.constTimeNegate(R,U),H=w.constTimeNegate(O,H),H=new h(t.mul(H.px,E.beta),H.py,H.pz),S=U.add(H),D=V.add(W)}else{let{p:R,f:I}=this.wNAF(v);S=R,D=I}return h.normalizeZ([S,D])[0]}multiplyAndAddUnsafe(b,v,S){let D=h.BASE,E=(I,O)=>O===fn||O===Jt||!I.equals(D)?I.multiplyUnsafe(O):I.multiply(O),R=E(this,v).add(E(b,S));return R.is0()?void 0:R}toAffine(b){let{px:v,py:S,pz:D}=this,E=this.is0();b==null&&(b=E?t.ONE:t.inv(D));let R=t.mul(v,b),I=t.mul(S,b),O=t.mul(D,b);if(E)return{x:t.ZERO,y:t.ZERO};if(!t.eql(O,t.ONE))throw new Error("invZ was invalid");return{x:R,y:I}}isTorsionFree(){let{h:b,isTorsionFree:v}=e;if(b===Jt)return!0;if(v)return v(h,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:b,clearCofactor:v}=e;return b===Jt?this:v?v(h,this):this.multiplyUnsafe(e.h)}toRawBytes(b=!0){return this.assertValidity(),n(h,this,b)}toHex(b=!0){return cn(this.toRawBytes(b))}}h.BASE=new h(e.Gx,e.Gy,t.ONE),h.ZERO=new h(t.ZERO,t.ONE,t.ZERO);let m=e.nBitLength,w=ru(h,e.endo?Math.ceil(m/2):m);return{CURVE:e,ProjectivePoint:h,normPrivateKeyToScalar:c,weierstrassEquation:o,isWithinCurveOrder:s}}function iT(r){let e=js(r);return Gt(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function rw(r){let e=iT(r),{Fp:t,n}=e,i=t.BYTES+1,o=2*t.BYTES+1;function s(k){return fn<k&&k<t.ORDER}function a(k){return ye(k,n)}function c(k){return tu(k,n)}let{ProjectivePoint:d,normPrivateKeyToScalar:u,weierstrassEquation:h,isWithinCurveOrder:m}=nT({...e,toBytes(k,M,ee){let P=M.toAffine(),B=t.toBytes(P.x),K=ln;return ee?K(Uint8Array.from([M.hasEvenY()?2:3]),B):K(Uint8Array.from([4]),B,t.toBytes(P.y))},fromBytes(k){let M=k.length,ee=k[0],P=k.subarray(1);if(M===i&&(ee===2||ee===3)){let B=un(P);if(!s(B))throw new Error("Point is not on curve");let K=h(B),F=t.sqrt(K),J=(F&Jt)===Jt;return(ee&1)===1!==J&&(F=t.neg(F)),{x:B,y:F}}else if(M===o&&ee===4){let B=t.fromBytes(P.subarray(0,t.BYTES)),K=t.fromBytes(P.subarray(t.BYTES,2*t.BYTES));return{x:B,y:K}}else throw new Error(`Point of length ${M} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),w=k=>cn(St(k,e.nByteLength));function p(k){let M=n>>Jt;return k>M}function b(k){return p(k)?a(-k):k}let v=(k,M,ee)=>un(k.slice(M,ee));class S{constructor(M,ee,P){this.r=M,this.s=ee,this.recovery=P,this.assertValidity()}static fromCompact(M){let ee=e.nByteLength;return M=Ae("compactSignature",M,ee*2),new S(v(M,0,ee),v(M,ee,2*ee))}static fromDER(M){let{r:ee,s:P}=ki.toSig(Ae("DER",M));return new S(ee,P)}assertValidity(){if(!m(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!m(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(M){return new S(this.r,this.s,M)}recoverPublicKey(M){let{r:ee,s:P,recovery:B}=this,K=C(Ae("msgHash",M));if(B==null||![0,1,2,3].includes(B))throw new Error("recovery id invalid");let F=B===2||B===3?ee+e.n:ee;if(F>=t.ORDER)throw new Error("recovery id 2 or 3 invalid");let J=B&1?"03":"02",te=d.fromHex(J+w(F)),X=c(F),Z=a(-K*X),Y=a(P*X),re=d.BASE.multiplyAndAddUnsafe(te,Z,Y);if(!re)throw new Error("point at infinify");return re.assertValidity(),re}hasHighS(){return p(this.s)}normalizeS(){return this.hasHighS()?new S(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Ui(this.toDERHex())}toDERHex(){return ki.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Ui(this.toCompactHex())}toCompactHex(){return w(this.r)+w(this.s)}}let D={isValidPrivateKey(k){try{return u(k),!0}catch{return!1}},normPrivateKeyToScalar:u,randomPrivateKey:()=>{let k=Kf(e.n);return ew(e.randomBytes(k),e.n)},precompute(k=8,M=d.BASE){return M._setWindowSize(k),M.multiply(BigInt(3)),M}};function E(k,M=!0){return d.fromPrivateKey(k).toRawBytes(M)}function R(k){let M=cr(k),ee=typeof k=="string",P=(M||ee)&&k.length;return M?P===i||P===o:ee?P===2*i||P===2*o:k instanceof d}function I(k,M,ee=!0){if(R(k))throw new Error("first arg must be private key");if(!R(M))throw new Error("second arg must be public key");return d.fromHex(M).multiply(u(k)).toRawBytes(ee)}let O=e.bits2int||function(k){let M=un(k),ee=k.length*8-e.nBitLength;return ee>0?M>>BigInt(ee):M},C=e.bits2int_modN||function(k){return a(O(k))},U=Hs(e.nBitLength);function V(k){if(typeof k!="bigint")throw new Error("bigint expected");if(!(fn<=k&&k<U))throw new Error(`bigint expected < 2^${e.nBitLength}`);return St(k,e.nByteLength)}function H(k,M,ee=W){if(["recovered","canonical"].some(Se=>Se in ee))throw new Error("sign() legacy options not supported");let{hash:P,randomBytes:B}=e,{lowS:K,prehash:F,extraEntropy:J}=ee;K==null&&(K=!0),k=Ae("msgHash",k),F&&(k=Ae("prehashed msgHash",P(k)));let te=C(k),X=u(M),Z=[V(X),V(te)];if(J!=null){let Se=J===!0?B(t.BYTES):J;Z.push(Ae("extraEntropy",Se))}let Y=ln(...Z),re=te;function Ie(Se){let Pe=O(Se);if(!m(Pe))return;let qe=c(Pe),Ke=d.BASE.multiply(Pe).toAffine(),Qe=a(Ke.x);if(Qe===fn)return;let je=a(qe*a(re+Qe*X));if(je===fn)return;let $r=(Ke.x===Qe?0:2)|Number(Ke.y&Jt),wn=je;return K&&p(je)&&(wn=b(je),$r^=1),new S(Qe,wn,$r)}return{seed:Y,k2sig:Ie}}let W={lowS:e.lowS,prehash:!1},Q={lowS:e.lowS,prehash:!1};function de(k,M,ee=W){let{seed:P,k2sig:B}=H(k,M,ee),K=e;return Of(K.hash.outputLen,K.nByteLength,K.hmac)(P,B)}d.BASE._setWindowSize(8);function nt(k,M,ee,P=Q){let B=k;if(M=Ae("msgHash",M),ee=Ae("publicKey",ee),"strict"in P)throw new Error("options.strict was renamed to lowS");let{lowS:K,prehash:F}=P,J,te;try{if(typeof B=="string"||cr(B))try{J=S.fromDER(B)}catch(Ke){if(!(Ke instanceof ki.Err))throw Ke;J=S.fromCompact(B)}else if(typeof B=="object"&&typeof B.r=="bigint"&&typeof B.s=="bigint"){let{r:Ke,s:Qe}=B;J=new S(Ke,Qe)}else throw new Error("PARSE");te=d.fromHex(ee)}catch(Ke){if(Ke.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(K&&J.hasHighS())return!1;F&&(M=e.hash(M));let{r:X,s:Z}=J,Y=C(M),re=c(Z),Ie=a(Y*re),Se=a(X*re),Pe=d.BASE.multiplyAndAddUnsafe(te,Ie,Se)?.toAffine();return Pe?a(Pe.x)===X:!1}return{CURVE:e,getPublicKey:E,getSharedSecret:I,sign:de,verify:nt,ProjectivePoint:d,Signature:S,utils:D}}var vO=l(f(),1);var gO=l(f(),1);var nu=class extends Io{constructor(e,t){super(),this.finished=!1,this.destroyed=!1,Fg(e);let n=Fs(t);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return To(this),this.iHash.update(e),this}digestInto(e){To(this),Tf(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:t,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=t._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},Mf=(r,e,t)=>new nu(r,e).update(t).digest();Mf.create=(r,e)=>new nu(r,e);function oT(r){return{hash:r,hmac:(e,...t)=>Mf(r,e,Yc(...t)),randomBytes:Vs}}function iu(r,e){let t=n=>rw({...r,...oT(n)});return Object.freeze({...t(e),create:t})}var ow=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),nw=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),sT=BigInt(1),Nf=BigInt(2),iw=(r,e)=>(r+e/Nf)/e;function aT(r){let e=ow,t=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),c=BigInt(88),d=r*r*r%e,u=d*d*r%e,h=_e(u,t,e)*u%e,m=_e(h,t,e)*u%e,w=_e(m,Nf,e)*d%e,p=_e(w,i,e)*w%e,b=_e(p,o,e)*p%e,v=_e(b,a,e)*b%e,S=_e(v,c,e)*v%e,D=_e(S,a,e)*b%e,E=_e(D,t,e)*u%e,R=_e(E,s,e)*p%e,I=_e(R,n,e)*d%e,O=_e(I,Nf,e);if(!$f.eql($f.sqr(O),r))throw new Error("Cannot find square root");return O}var $f=Bo(ow,void 0,void 0,{sqrt:aT}),At=iu({a:BigInt(0),b:BigInt(7),Fp:$f,n:nw,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:r=>{let e=nw,t=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-sT*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=t,s=BigInt("0x100000000000000000000000000000000"),a=iw(o*r,e),c=iw(-n*r,e),d=ye(r-a*t-c*i,e),u=ye(-a*n-c*o,e),h=d>s,m=u>s;if(h&&(d=e-d),m&&(u=e-u),d>s||u>s)throw new Error("splitScalar: Endomorphism failed, k="+r);return{k1neg:h,k1:d,k2neg:m,k2:u}}}},Zc),TO=BigInt(0);var IO=At.ProjectivePoint;var KO=l(f(),1);var OO=l(f(),1);function sw(r){let e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){let i=Object.keys(n).sort(),o={};for(let s of i)o[s]=e(n[s]);return o}return n},t=e(r);return JSON.stringify(t)}var cT=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},qf="urn:jwk:";function ne(r){return cT(this,arguments,void 0,function*({jwk:e}){let t=e.kty,n;if(t==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(t==="oct")n={k:e.k,kty:e.kty};else if(t==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(t==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${t}`);md(n);let i=sw(n),o=z.string(i).toUint8Array(),s=yield _o.digest({data:o});return z.uint8Array(s).toBase64Url()})}function Cr(r){return!(!r||typeof r!="object"||!("kty"in r&&"crv"in r&&"x"in r&&"d"in r)||r.kty!=="EC"||typeof r.d!="string"||typeof r.x!="string")}function Ro(r){return!(!r||typeof r!="object"||!("kty"in r&&"crv"in r&&"x"in r)||"d"in r||r.kty!=="EC"||typeof r.x!="string")}function kr(r){return!(!r||typeof r!="object"||!("kty"in r&&"crv"in r&&"x"in r&&"d"in r)||r.kty!=="OKP"||typeof r.d!="string"||typeof r.x!="string")}function Oo(r){return!(!r||typeof r!="object"||"d"in r||!("kty"in r&&"crv"in r&&"x"in r)||r.kty!=="OKP"||typeof r.x!="string")}function aw(r){if(!r||typeof r!="object")return!1;switch(r.kty){case"EC":case"OKP":case"RSA":return"d"in r;case"oct":return"k"in r;default:return!1}}var ot=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},uT=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},tt=class r{static adjustSignatureToLowS(e){return ot(this,arguments,void 0,function*({signature:t}){let n=At.Signature.fromCompact(t);return n.hasHighS()?n.normalizeS().toCompactRawBytes():t})}static bytesToPrivateKey(e){return ot(this,arguments,void 0,function*({privateKeyBytes:t}){let n=yield r.getCurvePoint({keyBytes:t}),i={kty:"EC",crv:"secp256k1",d:z.uint8Array(t).toBase64Url(),x:z.uint8Array(n.x).toBase64Url(),y:z.uint8Array(n.y).toBase64Url()};return i.kid=yield ne({jwk:i}),i})}static bytesToPublicKey(e){return ot(this,arguments,void 0,function*({publicKeyBytes:t}){let n=yield r.getCurvePoint({keyBytes:t}),i={kty:"EC",crv:"secp256k1",x:z.uint8Array(n.x).toBase64Url(),y:z.uint8Array(n.y).toBase64Url()};return i.kid=yield ne({jwk:i}),i})}static compressPublicKey(e){return ot(this,arguments,void 0,function*({publicKeyBytes:t}){return At.ProjectivePoint.fromHex(t).toRawBytes(!0)})}static computePublicKey(e){return ot(this,arguments,void 0,function*({key:t}){let n=yield r.privateKeyToBytes({privateKey:t}),i=yield r.getCurvePoint({keyBytes:n}),o={kty:"EC",crv:"secp256k1",x:z.uint8Array(i.x).toBase64Url(),y:z.uint8Array(i.y).toBase64Url()};return o.kid=yield ne({jwk:o}),o})}static convertDerToCompactSignature(e){return ot(this,arguments,void 0,function*({derSignature:t}){return At.Signature.fromDER(t).toCompactRawBytes()})}static decompressPublicKey(e){return ot(this,arguments,void 0,function*({publicKeyBytes:t}){return At.ProjectivePoint.fromHex(t).toRawBytes(!1)})}static generateKey(){return ot(this,void 0,void 0,function*(){let e=At.utils.randomPrivateKey(),t=yield r.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield ne({jwk:t}),t})}static getPublicKey(e){return ot(this,arguments,void 0,function*({key:t}){var n;if(!(Cr(t)&&t.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let{d:i}=t,o=uT(t,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield ne({jwk:o})),o})}static privateKeyToBytes(e){return ot(this,arguments,void 0,function*({privateKey:t}){if(!Cr(t))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return z.base64Url(t.d).toUint8Array()})}static publicKeyToBytes(e){return ot(this,arguments,void 0,function*({publicKey:t}){if(!(Ro(t)&&t.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");let n=new Uint8Array([4]),i=z.base64Url(t.x).toUint8Array(),o=z.base64Url(t.y).toUint8Array();return new Uint8Array([...n,...i,...o])})}static sharedSecret(e){return ot(this,arguments,void 0,function*({privateKeyA:t,publicKeyB:n}){if("x"in t&&"x"in n&&t.x===n.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let i=yield r.privateKeyToBytes({privateKey:t}),o=yield r.publicKeyToBytes({publicKey:n});return At.getSharedSecret(i,o,!0).slice(1)})}static sign(e){return ot(this,arguments,void 0,function*({data:t,key:n}){let i=yield r.privateKeyToBytes({privateKey:n}),o=Kn(t);return At.sign(o,i).toCompactRawBytes()})}static validatePrivateKey(e){return ot(this,arguments,void 0,function*({privateKeyBytes:t}){return At.utils.isValidPrivateKey(t)})}static validatePublicKey(e){return ot(this,arguments,void 0,function*({publicKeyBytes:t}){try{At.ProjectivePoint.fromHex(t).assertValidity()}catch{return!1}return!0})}static verify(e){return ot(this,arguments,void 0,function*({key:t,signature:n,data:i}){let o=yield r.publicKeyToBytes({publicKey:t}),s=Kn(i);return At.verify(n,s,o,{lowS:!1})})}static getCurvePoint(e){return ot(this,arguments,void 0,function*({keyBytes:t}){t.byteLength===32&&(t=At.getPublicKey(t));let n=At.ProjectivePoint.fromHex(t),i=St(n.x,32),o=St(n.y,32);return{x:i,y:o}})}};var tU=l(f(),1);var GO=l(f(),1);var cw=Bo(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),dT=cw.create(BigInt("-3")),lT=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),fT=iu({a:dT,b:lT,Fp:cw,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},Zc),kt=fT;var st=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},hT=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},at=class r{static adjustSignatureToLowS(e){return st(this,arguments,void 0,function*({signature:t}){let n=kt.Signature.fromCompact(t);return n.hasHighS()?n.normalizeS().toCompactRawBytes():t})}static bytesToPrivateKey(e){return st(this,arguments,void 0,function*({privateKeyBytes:t}){let n=yield r.getCurvePoint({keyBytes:t}),i={kty:"EC",crv:"P-256",d:z.uint8Array(t).toBase64Url(),x:z.uint8Array(n.x).toBase64Url(),y:z.uint8Array(n.y).toBase64Url()};return i.kid=yield ne({jwk:i}),i})}static bytesToPublicKey(e){return st(this,arguments,void 0,function*({publicKeyBytes:t}){let n=yield r.getCurvePoint({keyBytes:t}),i={kty:"EC",crv:"P-256",x:z.uint8Array(n.x).toBase64Url(),y:z.uint8Array(n.y).toBase64Url()};return i.kid=yield ne({jwk:i}),i})}static compressPublicKey(e){return st(this,arguments,void 0,function*({publicKeyBytes:t}){return kt.ProjectivePoint.fromHex(t).toRawBytes(!0)})}static computePublicKey(e){return st(this,arguments,void 0,function*({key:t}){let n=yield r.privateKeyToBytes({privateKey:t}),i=yield r.getCurvePoint({keyBytes:n}),o={kty:"EC",crv:"P-256",x:z.uint8Array(i.x).toBase64Url(),y:z.uint8Array(i.y).toBase64Url()};return o.kid=yield ne({jwk:o}),o})}static convertDerToCompactSignature(e){return st(this,arguments,void 0,function*({derSignature:t}){return kt.Signature.fromDER(t).toCompactRawBytes()})}static decompressPublicKey(e){return st(this,arguments,void 0,function*({publicKeyBytes:t}){return kt.ProjectivePoint.fromHex(t).toRawBytes(!1)})}static generateKey(){return st(this,void 0,void 0,function*(){let e=kt.utils.randomPrivateKey(),t=yield r.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield ne({jwk:t}),t})}static getPublicKey(e){return st(this,arguments,void 0,function*({key:t}){var n;if(!(Cr(t)&&t.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let{d:i}=t,o=hT(t,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield ne({jwk:o})),o})}static privateKeyToBytes(e){return st(this,arguments,void 0,function*({privateKey:t}){if(!Cr(t))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return z.base64Url(t.d).toUint8Array()})}static publicKeyToBytes(e){return st(this,arguments,void 0,function*({publicKey:t}){if(!(Ro(t)&&t.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");let n=new Uint8Array([4]),i=z.base64Url(t.x).toUint8Array(),o=z.base64Url(t.y).toUint8Array();return new Uint8Array([...n,...i,...o])})}static sharedSecret(e){return st(this,arguments,void 0,function*({privateKeyA:t,publicKeyB:n}){if("x"in t&&"x"in n&&t.x===n.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let i=yield r.privateKeyToBytes({privateKey:t}),o=yield r.publicKeyToBytes({publicKey:n});return kt.getSharedSecret(i,o,!0).slice(1)})}static sign(e){return st(this,arguments,void 0,function*({data:t,key:n}){let i=yield r.privateKeyToBytes({privateKey:n}),o=Kn(t);return kt.sign(o,i).toCompactRawBytes()})}static validatePrivateKey(e){return st(this,arguments,void 0,function*({privateKeyBytes:t}){return kt.utils.isValidPrivateKey(t)})}static validatePublicKey(e){return st(this,arguments,void 0,function*({publicKeyBytes:t}){try{kt.ProjectivePoint.fromHex(t).assertValidity()}catch{return!1}return!0})}static verify(e){return st(this,arguments,void 0,function*({key:t,signature:n,data:i}){let o=yield r.publicKeyToBytes({publicKey:t}),s=Kn(i);return kt.verify(n,s,o,{lowS:!1})})}static getCurvePoint(e){return st(this,arguments,void 0,function*({keyBytes:t}){t.byteLength===32&&(t=kt.getPublicKey(t));let n=kt.ProjectivePoint.fromHex(t),i=St(n.x,32),o=St(n.y,32);return{x:i,y:o}})}};var Ws=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},zs=class extends Ur{computePublicKey(e){return Ws(this,arguments,void 0,function*({key:t}){if(!Cr(t))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(t.crv){case"secp256k1":{let n=yield tt.computePublicKey({key:t});return n.alg="ES256K",n}case"P-256":{let n=yield at.computePublicKey({key:t});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${t.crv}`)}})}generateKey(e){return Ws(this,arguments,void 0,function*({algorithm:t}){switch(t){case"ES256K":case"secp256k1":{let n=yield tt.generateKey();return n.alg="ES256K",n}case"ES256":case"secp256r1":{let n=yield at.generateKey();return n.alg="ES256",n}}})}getPublicKey(e){return Ws(this,arguments,void 0,function*({key:t}){if(!Cr(t))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(t.crv){case"secp256k1":{let n=yield tt.getPublicKey({key:t});return n.alg="ES256K",n}case"P-256":{let n=yield at.getPublicKey({key:t});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${t.crv}`)}})}sign(e){return Ws(this,arguments,void 0,function*({key:t,data:n}){if(!Cr(t))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(t.crv){case"secp256k1":return yield tt.sign({key:t,data:n});case"P-256":return yield at.sign({key:t,data:n});default:throw new Error(`Unsupported curve: ${t.crv}`)}})}verify(e){return Ws(this,arguments,void 0,function*({key:t,signature:n,data:i}){if(!Ro(t))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(t.crv){case"secp256k1":return yield tt.verify({key:t,signature:n,data:i});case"P-256":return yield at.verify({key:t,signature:n,data:i});default:throw new Error(`Unsupported curve: ${t.crv}`)}})}};var QU=l(f(),1);var GU=l(f(),1);var VU=l(f(),1);var pU=l(f(),1);var uU=l(f(),1),ou=BigInt(4294967295),Ff=BigInt(32);function uw(r,e=!1){return e?{h:Number(r&ou),l:Number(r>>Ff&ou)}:{h:Number(r>>Ff&ou)|0,l:Number(r&ou)|0}}function pT(r,e=!1){let t=new Uint32Array(r.length),n=new Uint32Array(r.length);for(let i=0;i<r.length;i++){let{h:o,l:s}=uw(r[i],e);[t[i],n[i]]=[o,s]}return[t,n]}var yT=(r,e)=>BigInt(r>>>0)<<Ff|BigInt(e>>>0),mT=(r,e,t)=>r>>>t,gT=(r,e,t)=>r<<32-t|e>>>t,wT=(r,e,t)=>r>>>t|e<<32-t,bT=(r,e,t)=>r<<32-t|e>>>t,xT=(r,e,t)=>r<<64-t|e>>>t-32,ET=(r,e,t)=>r>>>t-32|e<<64-t,vT=(r,e)=>e,ST=(r,e)=>r,AT=(r,e,t)=>r<<t|e>>>32-t,_T=(r,e,t)=>e<<t|r>>>32-t,TT=(r,e,t)=>e<<t-32|r>>>64-t,IT=(r,e,t)=>r<<t-32|e>>>64-t;function DT(r,e,t,n){let i=(e>>>0)+(n>>>0);return{h:r+t+(i/2**32|0)|0,l:i|0}}var BT=(r,e,t)=>(r>>>0)+(e>>>0)+(t>>>0),RT=(r,e,t,n)=>e+t+n+(r/2**32|0)|0,OT=(r,e,t,n)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0),UT=(r,e,t,n,i)=>e+t+n+i+(r/2**32|0)|0,CT=(r,e,t,n,i)=>(r>>>0)+(e>>>0)+(t>>>0)+(n>>>0)+(i>>>0),kT=(r,e,t,n,i,o)=>e+t+n+i+o+(r/2**32|0)|0;var PT={fromBig:uw,split:pT,toBig:yT,shrSH:mT,shrSL:gT,rotrSH:wT,rotrSL:bT,rotrBH:xT,rotrBL:ET,rotr32H:vT,rotr32L:ST,rotlSH:AT,rotlSL:_T,rotlBH:TT,rotlBL:IT,add:DT,add3L:BT,add3H:RT,add4L:OT,add4H:UT,add5H:kT,add5L:CT},oe=PT;var[KT,LT]=oe.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(r=>BigInt(r))),Nn=new Uint32Array(80),$n=new Uint32Array(80),Vf=class extends Do{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:t,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:c,Eh:d,El:u,Fh:h,Fl:m,Gh:w,Gl:p,Hh:b,Hl:v}=this;return[e,t,n,i,o,s,a,c,d,u,h,m,w,p,b,v]}set(e,t,n,i,o,s,a,c,d,u,h,m,w,p,b,v){this.Ah=e|0,this.Al=t|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=c|0,this.Eh=d|0,this.El=u|0,this.Fh=h|0,this.Fl=m|0,this.Gh=w|0,this.Gl=p|0,this.Hh=b|0,this.Hl=v|0}process(e,t){for(let E=0;E<16;E++,t+=4)Nn[E]=e.getUint32(t),$n[E]=e.getUint32(t+=4);for(let E=16;E<80;E++){let R=Nn[E-15]|0,I=$n[E-15]|0,O=oe.rotrSH(R,I,1)^oe.rotrSH(R,I,8)^oe.shrSH(R,I,7),C=oe.rotrSL(R,I,1)^oe.rotrSL(R,I,8)^oe.shrSL(R,I,7),U=Nn[E-2]|0,V=$n[E-2]|0,H=oe.rotrSH(U,V,19)^oe.rotrBH(U,V,61)^oe.shrSH(U,V,6),W=oe.rotrSL(U,V,19)^oe.rotrBL(U,V,61)^oe.shrSL(U,V,6),Q=oe.add4L(C,W,$n[E-7],$n[E-16]),de=oe.add4H(Q,O,H,Nn[E-7],Nn[E-16]);Nn[E]=de|0,$n[E]=Q|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:c,Dh:d,Dl:u,Eh:h,El:m,Fh:w,Fl:p,Gh:b,Gl:v,Hh:S,Hl:D}=this;for(let E=0;E<80;E++){let R=oe.rotrSH(h,m,14)^oe.rotrSH(h,m,18)^oe.rotrBH(h,m,41),I=oe.rotrSL(h,m,14)^oe.rotrSL(h,m,18)^oe.rotrBL(h,m,41),O=h&w^~h&b,C=m&p^~m&v,U=oe.add5L(D,I,C,LT[E],$n[E]),V=oe.add5H(U,S,R,O,KT[E],Nn[E]),H=U|0,W=oe.rotrSH(n,i,28)^oe.rotrBH(n,i,34)^oe.rotrBH(n,i,39),Q=oe.rotrSL(n,i,28)^oe.rotrBL(n,i,34)^oe.rotrBL(n,i,39),de=n&o^n&a^o&a,nt=i&s^i&c^s&c;S=b|0,D=v|0,b=w|0,v=p|0,w=h|0,p=m|0,{h,l:m}=oe.add(d|0,u|0,V|0,H|0),d=a|0,u=c|0,a=o|0,c=s|0,o=n|0,s=i|0;let k=oe.add3L(H,Q,nt);n=oe.add3H(k,V,W,de),i=k|0}({h:n,l:i}=oe.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=oe.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:c}=oe.add(this.Ch|0,this.Cl|0,a|0,c|0),{h:d,l:u}=oe.add(this.Dh|0,this.Dl|0,d|0,u|0),{h,l:m}=oe.add(this.Eh|0,this.El|0,h|0,m|0),{h:w,l:p}=oe.add(this.Fh|0,this.Fl|0,w|0,p|0),{h:b,l:v}=oe.add(this.Gh|0,this.Gl|0,b|0,v|0),{h:S,l:D}=oe.add(this.Hh|0,this.Hl|0,S|0,D|0),this.set(n,i,o,s,a,c,d,u,h,m,w,p,b,v,S,D)}roundClean(){Nn.fill(0),$n.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var Hf=Xc(()=>new Vf);var bU=l(f(),1);var dr=BigInt(0),Pt=BigInt(1),su=BigInt(2),MT=BigInt(8),NT={zip215:!0};function $T(r){let e=js(r);return Gt(r,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function au(r){let e=$T(r),{Fp:t,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:c}=e,d=su<<BigInt(a*8)-Pt,u=t.create,h=e.uvRatio||((P,B)=>{try{return{isValid:!0,value:t.sqrt(P*t.inv(B))}}catch{return{isValid:!1,value:dr}}}),m=e.adjustScalarBytes||(P=>P),w=e.domain||((P,B,K)=>{if(B.length||K)throw new Error("Contexts/pre-hash are not supported");return P}),p=P=>typeof P=="bigint"&&dr<P,b=(P,B)=>p(P)&&p(B)&&P<B,v=P=>P===dr||b(P,d);function S(P,B){if(b(P,B))return P;throw new Error(`Expected valid scalar < ${B}, got ${typeof P} ${P}`)}function D(P){return P===dr?P:S(P,n)}let E=new Map;function R(P){if(!(P instanceof I))throw new Error("ExtendedPoint expected")}class I{constructor(B,K,F,J){if(this.ex=B,this.ey=K,this.ez=F,this.et=J,!v(B))throw new Error("x required");if(!v(K))throw new Error("y required");if(!v(F))throw new Error("z required");if(!v(J))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(B){if(B instanceof I)throw new Error("extended point not allowed");let{x:K,y:F}=B||{};if(!v(K)||!v(F))throw new Error("invalid affine point");return new I(K,F,Pt,u(K*F))}static normalizeZ(B){let K=t.invertBatch(B.map(F=>F.ez));return B.map((F,J)=>F.toAffine(K[J])).map(I.fromAffine)}_setWindowSize(B){this._WINDOW_SIZE=B,E.delete(this)}assertValidity(){let{a:B,d:K}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:F,ey:J,ez:te,et:X}=this,Z=u(F*F),Y=u(J*J),re=u(te*te),Ie=u(re*re),Se=u(Z*B),Pe=u(re*u(Se+Y)),qe=u(Ie+u(K*u(Z*Y)));if(Pe!==qe)throw new Error("bad point: equation left != right (1)");let Ke=u(F*J),Qe=u(te*X);if(Ke!==Qe)throw new Error("bad point: equation left != right (2)")}equals(B){R(B);let{ex:K,ey:F,ez:J}=this,{ex:te,ey:X,ez:Z}=B,Y=u(K*Z),re=u(te*J),Ie=u(F*Z),Se=u(X*J);return Y===re&&Ie===Se}is0(){return this.equals(I.ZERO)}negate(){return new I(u(-this.ex),this.ey,this.ez,u(-this.et))}double(){let{a:B}=e,{ex:K,ey:F,ez:J}=this,te=u(K*K),X=u(F*F),Z=u(su*u(J*J)),Y=u(B*te),re=K+F,Ie=u(u(re*re)-te-X),Se=Y+X,Pe=Se-Z,qe=Y-X,Ke=u(Ie*Pe),Qe=u(Se*qe),je=u(Ie*qe),$r=u(Pe*Se);return new I(Ke,Qe,$r,je)}add(B){R(B);let{a:K,d:F}=e,{ex:J,ey:te,ez:X,et:Z}=this,{ex:Y,ey:re,ez:Ie,et:Se}=B;if(K===BigInt(-1)){let Yo=u((te-J)*(re+Y)),Aa=u((te+J)*(re-Y)),Xo=u(Aa-Yo);if(Xo===dr)return this.double();let _a=u(X*su*Se),Ta=u(Z*su*Ie),$t=Ta+_a,xn=Aa+Yo,Zo=Ta-_a,Ia=u($t*Xo),Jn=u(xn*Zo),Da=u($t*Zo),Fu=u(Xo*xn);return new I(Ia,Jn,Fu,Da)}let Pe=u(J*Y),qe=u(te*re),Ke=u(Z*F*Se),Qe=u(X*Ie),je=u((J+te)*(Y+re)-Pe-qe),$r=Qe-Ke,wn=Qe+Ke,Jo=u(qe-K*Pe),Sa=u(je*$r),qu=u(wn*Jo),bn=u(je*Jo),Nt=u($r*wn);return new I(Sa,qu,Nt,bn)}subtract(B){return this.add(B.negate())}wNAF(B){return U.wNAFCached(this,E,B,I.normalizeZ)}multiply(B){let{p:K,f:F}=this.wNAF(S(B,n));return I.normalizeZ([K,F])[0]}multiplyUnsafe(B){let K=D(B);return K===dr?C:this.equals(C)||K===Pt?this:this.equals(O)?this.wNAF(K).p:U.unsafeLadder(this,K)}isSmallOrder(){return this.multiplyUnsafe(c).is0()}isTorsionFree(){return U.unsafeLadder(this,n).is0()}toAffine(B){let{ex:K,ey:F,ez:J}=this,te=this.is0();B==null&&(B=te?MT:t.inv(J));let X=u(K*B),Z=u(F*B),Y=u(J*B);if(te)return{x:dr,y:Pt};if(Y!==Pt)throw new Error("invZ was invalid");return{x:X,y:Z}}clearCofactor(){let{h:B}=e;return B===Pt?this:this.multiplyUnsafe(B)}static fromHex(B,K=!1){let{d:F,a:J}=e,te=t.BYTES;B=Ae("pointHex",B,te);let X=B.slice(),Z=B[te-1];X[te-1]=Z&-129;let Y=ur(X);Y===dr||(K?S(Y,d):S(Y,t.ORDER));let re=u(Y*Y),Ie=u(re-Pt),Se=u(F*re-J),{isValid:Pe,value:qe}=h(Ie,Se);if(!Pe)throw new Error("Point.fromHex: invalid y coordinate");let Ke=(qe&Pt)===Pt,Qe=(Z&128)!==0;if(!K&&qe===dr&&Qe)throw new Error("Point.fromHex: x=0 and x_0=1");return Qe!==Ke&&(qe=u(-qe)),I.fromAffine({x:qe,y:Y})}static fromPrivateKey(B){return W(B).point}toRawBytes(){let{x:B,y:K}=this.toAffine(),F=dn(K,t.BYTES);return F[F.length-1]|=B&Pt?128:0,F}toHex(){return cn(this.toRawBytes())}}I.BASE=new I(e.Gx,e.Gy,Pt,u(e.Gx*e.Gy)),I.ZERO=new I(dr,Pt,Pt,dr);let{BASE:O,ZERO:C}=I,U=ru(I,a*8);function V(P){return ye(P,n)}function H(P){return V(ur(P))}function W(P){let B=a;P=Ae("private key",P,B);let K=Ae("hashed private key",o(P),2*B),F=m(K.slice(0,B)),J=K.slice(B,2*B),te=H(F),X=O.multiply(te),Z=X.toRawBytes();return{head:F,prefix:J,scalar:te,point:X,pointBytes:Z}}function Q(P){return W(P).pointBytes}function de(P=new Uint8Array,...B){let K=ln(...B);return H(o(w(K,Ae("context",P),!!i)))}function nt(P,B,K={}){P=Ae("message",P),i&&(P=i(P));let{prefix:F,scalar:J,pointBytes:te}=W(B),X=de(K.context,F,P),Z=O.multiply(X).toRawBytes(),Y=de(K.context,Z,te,P),re=V(X+Y*J);D(re);let Ie=ln(Z,dn(re,t.BYTES));return Ae("result",Ie,a*2)}let k=NT;function M(P,B,K,F=k){let{context:J,zip215:te}=F,X=t.BYTES;P=Ae("signature",P,2*X),B=Ae("message",B),i&&(B=i(B));let Z=ur(P.slice(X,2*X)),Y,re,Ie;try{Y=I.fromHex(K,te),re=I.fromHex(P.slice(0,X),te),Ie=O.multiplyUnsafe(Z)}catch{return!1}if(!te&&Y.isSmallOrder())return!1;let Se=de(J,re.toRawBytes(),Y.toRawBytes(),B);return re.add(Y.multiplyUnsafe(Se)).subtract(Ie).clearCofactor().equals(I.ZERO)}return O._setWindowSize(8),{CURVE:e,getPublicKey:Q,sign:nt,verify:M,ExtendedPoint:I,utils:{getExtendedPublicKey:W,randomPrivateKey:()=>s(t.BYTES),precompute(P=8,B=I.BASE){return B._setWindowSize(P),B.multiply(BigInt(3)),B}}}}var SU=l(f(),1);var Gs=BigInt(0),jf=BigInt(1);function qT(r){return Gt(r,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...r})}function dw(r){let e=qT(r),{P:t}=e,n=E=>ye(E,t),i=e.montgomeryBits,o=Math.ceil(i/8),s=e.nByteLength,a=e.adjustScalarBytes||(E=>E),c=e.powPminus2||(E=>Cf(E,t-BigInt(2),t));function d(E,R,I){let O=n(E*(R-I));return R=n(R-O),I=n(I+O),[R,I]}function u(E){if(typeof E=="bigint"&&Gs<=E&&E<t)return E;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let h=(e.a-BigInt(2))/BigInt(4);function m(E,R){let I=u(E),O=u(R),C=I,U=jf,V=Gs,H=I,W=jf,Q=Gs,de;for(let k=BigInt(i-1);k>=Gs;k--){let M=O>>k&jf;Q^=M,de=d(Q,U,H),U=de[0],H=de[1],de=d(Q,V,W),V=de[0],W=de[1],Q=M;let ee=U+V,P=n(ee*ee),B=U-V,K=n(B*B),F=P-K,J=H+W,te=H-W,X=n(te*ee),Z=n(J*B),Y=X+Z,re=X-Z;H=n(Y*Y),W=n(C*n(re*re)),U=n(P*K),V=n(F*(P+n(h*F)))}de=d(Q,U,H),U=de[0],H=de[1],de=d(Q,V,W),V=de[0],W=de[1];let nt=c(V);return n(U*nt)}function w(E){return dn(n(E),o)}function p(E){let R=Ae("u coordinate",E,o);return s===32&&(R[31]&=127),ur(R)}function b(E){let R=Ae("scalar",E),I=R.length;if(I!==o&&I!==s)throw new Error(`Expected ${o} or ${s} bytes, got ${I}`);return ur(a(R))}function v(E,R){let I=p(R),O=b(E),C=m(I,O);if(C===Gs)throw new Error("Invalid private or public key received");return w(C)}let S=w(e.Gu);function D(E){return v(E,S)}return{scalarMult:v,scalarMultBase:D,getSharedSecret:(E,R)=>v(E,R),getPublicKey:E=>D(E),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:S}}var Js=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),lw=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),BU=BigInt(0),FT=BigInt(1),Wf=BigInt(2),VT=BigInt(5),fw=BigInt(10),HT=BigInt(20),jT=BigInt(40),hw=BigInt(80);function pw(r){let e=Js,n=r*r%e*r%e,i=_e(n,Wf,e)*n%e,o=_e(i,FT,e)*r%e,s=_e(o,VT,e)*o%e,a=_e(s,fw,e)*s%e,c=_e(a,HT,e)*a%e,d=_e(c,jT,e)*c%e,u=_e(d,hw,e)*d%e,h=_e(u,hw,e)*d%e,m=_e(h,fw,e)*s%e;return{pow_p_5_8:_e(m,Wf,e)*r%e,b2:n}}function yw(r){return r[0]&=248,r[31]&=127,r[31]|=64,r}function WT(r,e){let t=Js,n=ye(e*e*e,t),i=ye(n*n*e,t),o=pw(r*i).pow_p_5_8,s=ye(r*n*o,t),a=ye(e*s*s,t),c=s,d=ye(s*lw,t),u=a===r,h=a===ye(-r,t),m=a===ye(-r*lw,t);return u&&(s=c),(h||m)&&(s=d),Xg(s,t)&&(s=ye(-s,t)),{isValid:u||h,value:s}}var Yt=Bo(Js,void 0,!0),Ys={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:Yt,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:Hf,randomBytes:Vs,adjustScalarBytes:yw,uvRatio:WT},qn=au(Ys);function mw(r,e,t){if(e.length>255)throw new Error("Context is too big");return Yc(If("SigEd25519 no Ed25519 collisions"),new Uint8Array([t?1:0,e.length]),e,r)}var RU=au({...Ys,domain:mw}),OU=au({...Ys,domain:mw,prehash:Hf}),Pi=dw({P:Js,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:r=>{let e=Js,{pow_p_5_8:t,b2:n}=pw(r);return ye(_e(t,BigInt(3),e)*n,e)},adjustScalarBytes:yw,randomBytes:Vs});function gw(r){let{y:e}=qn.ExtendedPoint.fromHex(r),t=BigInt(1);return Yt.toBytes(Yt.create((t+e)*Yt.inv(t-e)))}function ww(r){let e=Ys.hash(r.subarray(0,32));return Ys.adjustScalarBytes(e).subarray(0,32)}var zT=(Yt.ORDER+BigInt(3))/BigInt(8),UU=Yt.pow(Wf,zT),CU=Yt.sqrt(Yt.neg(Yt.ONE)),kU=(Yt.ORDER-BigInt(5))/BigInt(8),PU=BigInt(486662);var KU=Zg(Yt,Yt.neg(BigInt(486664)));var LU=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),MU=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),NU=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),$U=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var qU=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var Xt=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},GT=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},Je=class r{static bytesToPrivateKey(e){return Xt(this,arguments,void 0,function*({privateKeyBytes:t}){let n=qn.getPublicKey(t),i={crv:"Ed25519",d:z.uint8Array(t).toBase64Url(),kty:"OKP",x:z.uint8Array(n).toBase64Url()};return i.kid=yield ne({jwk:i}),i})}static bytesToPublicKey(e){return Xt(this,arguments,void 0,function*({publicKeyBytes:t}){let n={kty:"OKP",crv:"Ed25519",x:z.uint8Array(t).toBase64Url()};return n.kid=yield ne({jwk:n}),n})}static computePublicKey(e){return Xt(this,arguments,void 0,function*({key:t}){let n=yield r.privateKeyToBytes({privateKey:t}),i=qn.getPublicKey(n),o={kty:"OKP",crv:"Ed25519",x:z.uint8Array(i).toBase64Url()};return o.kid=yield ne({jwk:o}),o})}static convertPrivateKeyToX25519(e){return Xt(this,arguments,void 0,function*({privateKey:t}){let n=yield r.privateKeyToBytes({privateKey:t}),i=ww(n),o=Pi.getPublicKey(i),s={kty:"OKP",crv:"X25519",d:z.uint8Array(i).toBase64Url(),x:z.uint8Array(o).toBase64Url()};return s.kid=yield ne({jwk:s}),s})}static convertPublicKeyToX25519(e){return Xt(this,arguments,void 0,function*({publicKey:t}){let n=yield r.publicKeyToBytes({publicKey:t});if(!(yield r.validatePublicKey({publicKeyBytes:n})))throw new Error("Ed25519: Invalid public key.");let o=gw(n),s={kty:"OKP",crv:"X25519",x:z.uint8Array(o).toBase64Url()};return s.kid=yield ne({jwk:s}),s})}static generateKey(){return Xt(this,void 0,void 0,function*(){let e=qn.utils.randomPrivateKey(),t=yield r.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield ne({jwk:t}),t})}static getPublicKey(e){return Xt(this,arguments,void 0,function*({key:t}){var n;if(!(kr(t)&&t.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let{d:i}=t,o=GT(t,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield ne({jwk:o})),o})}static privateKeyToBytes(e){return Xt(this,arguments,void 0,function*({privateKey:t}){if(!kr(t))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return z.base64Url(t.d).toUint8Array()})}static publicKeyToBytes(e){return Xt(this,arguments,void 0,function*({publicKey:t}){if(!Oo(t))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return z.base64Url(t.x).toUint8Array()})}static sign(e){return Xt(this,arguments,void 0,function*({key:t,data:n}){let i=yield r.privateKeyToBytes({privateKey:t});return qn.sign(n,i)})}static validatePublicKey(e){return Xt(this,arguments,void 0,function*({publicKeyBytes:t}){try{qn.ExtendedPoint.fromHex(t).assertValidity()}catch{return!1}return!0})}static verify(e){return Xt(this,arguments,void 0,function*({key:t,signature:n,data:i}){let o=yield r.publicKeyToBytes({publicKey:t});return qn.verify(n,i,o)})}};var Xs=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},cu=class extends Ur{computePublicKey(e){return Xs(this,arguments,void 0,function*({key:t}){if(!kr(t))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(t.crv){case"Ed25519":{let n=yield Je.computePublicKey({key:t});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${t.crv}`)}})}generateKey(e){return Xs(this,arguments,void 0,function*({algorithm:t}){switch(t){case"Ed25519":{let n=yield Je.generateKey();return n.alg="EdDSA",n}}})}getPublicKey(e){return Xs(this,arguments,void 0,function*({key:t}){if(!kr(t))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(t.crv){case"Ed25519":{let n=yield Je.getPublicKey({key:t});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${t.crv}`)}})}sign(e){return Xs(this,arguments,void 0,function*({key:t,data:n}){if(!kr(t))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(t.crv){case"Ed25519":return yield Je.sign({key:t,data:n});default:throw new Error(`Unsupported curve: ${t.crv}`)}})}verify(e){return Xs(this,arguments,void 0,function*({key:t,signature:n,data:i}){if(!Oo(t))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(t.crv){case"Ed25519":return yield Je.verify({key:t,signature:n,data:i});default:throw new Error(`Unsupported curve: ${t.crv}`)}})}};var hn=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},zf={Ed25519:{implementation:cu,names:["Ed25519"]},secp256k1:{implementation:zs,names:["ES256K","secp256k1"]},secp256r1:{implementation:zs,names:["ES256","secp256r1"]},"SHA-256":{implementation:zc,names:["SHA-256"]}},dt=class{constructor(e){var t;this._algorithmInstances=new Map,this._keyStore=(t=e?.keyStore)!==null&&t!==void 0?t:new fc}digest(e){return hn(this,arguments,void 0,function*({algorithm:t,data:n}){return yield this.getAlgorithm({algorithm:t}).digest({algorithm:t,data:n})})}exportKey(e){return hn(this,arguments,void 0,function*({keyUri:t}){return yield this.getPrivateKey({keyUri:t})})}generateKey(e){return hn(this,arguments,void 0,function*({algorithm:t}){let i=yield this.getAlgorithm({algorithm:t}).generateKey({algorithm:t});if(i?.kid===void 0)throw new Error("Generated key is missing a required property: kid");let o=`${qf}${i.kid}`;return yield this._keyStore.set(o,i),o})}getKeyUri(e){return hn(this,arguments,void 0,function*({key:t}){let n=yield ne({jwk:t});return`${qf}${n}`})}getPublicKey(e){return hn(this,arguments,void 0,function*({keyUri:t}){let n=yield this.getPrivateKey({keyUri:t}),i=this.getAlgorithmName({key:n});return yield this.getAlgorithm({algorithm:i}).getPublicKey({key:n})})}importKey(e){return hn(this,arguments,void 0,function*({key:t}){var n;if(!aw(t))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");let i=structuredClone(t);(n=i.kid)!==null&&n!==void 0||(i.kid=yield ne({jwk:i}));let o=yield this.getKeyUri({key:i});return yield this._keyStore.set(o,i),o})}sign(e){return hn(this,arguments,void 0,function*({keyUri:t,data:n}){let i=yield this.getPrivateKey({keyUri:t}),o=this.getAlgorithmName({key:i});return this.getAlgorithm({algorithm:o}).sign({data:n,key:i})})}verify(e){return hn(this,arguments,void 0,function*({key:t,signature:n,data:i}){let o=this.getAlgorithmName({key:t});return this.getAlgorithm({algorithm:o}).verify({key:t,signature:n,data:i})})}getAlgorithm({algorithm:e}){var t;let n=(t=zf[e])===null||t===void 0?void 0:t.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){let t=e.alg,n=e.crv;for(let i in zf){let o=zf[i];if(t&&o.names.includes(t))return i;if(n&&o.names.includes(n))return i}throw new Error(`Unable to determine algorithm based on provided input: alg=${t}, crv=${n}`)}getPrivateKey(e){return hn(this,arguments,void 0,function*({keyUri:t}){let n=yield this._keyStore.get(t);if(!n)throw new Error(`Key not found: ${t}`);return n})}};var dC=l(f(),1);function JT(r){let e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(r.alg&&Object.values(e).includes(r.alg))return r.alg;if(r.crv&&Object.keys(e).includes(r.crv))return e[r.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${r.alg}, crv=${r.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}function Gf(r){return Mg(r)}function YT(){return Ao.randomUUID()}function XT({length:r}){if(3>r||r>10)throw new Error("randomPin() can securely generate a PIN between 3 to 10 digits.");let e=Math.pow(10,r)-1,t;if(r<=6){let n=Math.pow(10,r);do{let i=Gf(Math.ceil(r/2));t=new DataView(i.buffer).getUint16(0,!1)%n}while(t>e)}else{let n=Math.pow(10,10);do{let i=Gf(4);t=new DataView(i.buffer).getUint32(0,!1)%n}while(t>e)}return t.toString().padStart(r,"0")}var bw={randomPin:XT,randomUuid:YT,randomBytes:Gf,getJoseSignatureAlgorithmFromPublicKey:JT};var bC=l(f(),1);var pC=l(f(),1);var DC=l(f(),1);var SC=l(f(),1);var BC=l(f(),1);var RC=l(f(),1);var OC=l(f(),1);var kC=l(f(),1);var KC=l(f(),1);var qC=l(f(),1);var Fn=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},ZT=function(r,e){var t={};for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&e.indexOf(n)<0&&(t[n]=r[n]);if(r!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(r);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(r,n[i])&&(t[n[i]]=r[n[i]]);return t},Uo=class r{static bytesToPrivateKey(e){return Fn(this,arguments,void 0,function*({privateKeyBytes:t}){let n=Pi.getPublicKey(t),i={kty:"OKP",crv:"X25519",d:z.uint8Array(t).toBase64Url(),x:z.uint8Array(n).toBase64Url()};return i.kid=yield ne({jwk:i}),i})}static bytesToPublicKey(e){return Fn(this,arguments,void 0,function*({publicKeyBytes:t}){let n={kty:"OKP",crv:"X25519",x:z.uint8Array(t).toBase64Url()};return n.kid=yield ne({jwk:n}),n})}static computePublicKey(e){return Fn(this,arguments,void 0,function*({key:t}){let n=yield r.privateKeyToBytes({privateKey:t}),i=Pi.getPublicKey(n),o={kty:"OKP",crv:"X25519",x:z.uint8Array(i).toBase64Url()};return o.kid=yield ne({jwk:o}),o})}static generateKey(){return Fn(this,void 0,void 0,function*(){let e=Pi.utils.randomPrivateKey(),t=yield r.bytesToPrivateKey({privateKeyBytes:e});return t.kid=yield ne({jwk:t}),t})}static getPublicKey(e){return Fn(this,arguments,void 0,function*({key:t}){var n;if(!(kr(t)&&t.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let{d:i}=t,o=ZT(t,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield ne({jwk:o})),o})}static privateKeyToBytes(e){return Fn(this,arguments,void 0,function*({privateKey:t}){if(!kr(t))throw new Error("X25519: The provided key is not a valid OKP private key.");return z.base64Url(t.d).toUint8Array()})}static publicKeyToBytes(e){return Fn(this,arguments,void 0,function*({publicKey:t}){if(!Oo(t))throw new Error("X25519: The provided key is not a valid OKP public key.");return z.base64Url(t.x).toUint8Array()})}static sharedSecret(e){return Fn(this,arguments,void 0,function*({privateKeyA:t,publicKeyB:n}){if("x"in t&&"x"in n&&t.x===n.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let i=yield r.privateKeyToBytes({privateKey:t}),o=yield r.publicKeyToBytes({publicKey:n});return Pi.getSharedSecret(i,o)})}};var jC=l(f(),1);var JC=l(f(),1);var uh={};is(uh,{extractDidFragment:()=>Tt,getServices:()=>CI,getVerificationMethodByKey:()=>kI,getVerificationMethodTypes:()=>ah,getVerificationMethods:()=>na,getVerificationRelationshipsById:()=>ch,isDidService:()=>Lw,isDidVerificationMethod:()=>du,isDwnDidService:()=>PI,keyBytesToMultibaseId:()=>lu,multibaseIdToKeyBytes:()=>fu});var cK=l(f(),1);var WP=l(f(),1);var Sk=l(f(),1),QT=l(id(),1);var aP=l(f(),1);var Vk=l(f(),1);var Ck=l(f(),1);var _k=l(f(),1);function eI(r,e){if(r.length>=255)throw new TypeError("Alphabet too long");for(var t=new Uint8Array(256),n=0;n<t.length;n++)t[n]=255;for(var i=0;i<r.length;i++){var o=r.charAt(i),s=o.charCodeAt(0);if(t[s]!==255)throw new TypeError(o+" is ambiguous");t[s]=i}var a=r.length,c=r.charAt(0),d=Math.log(a)/Math.log(256),u=Math.log(256)/Math.log(a);function h(p){if(p instanceof Uint8Array||(ArrayBuffer.isView(p)?p=new Uint8Array(p.buffer,p.byteOffset,p.byteLength):Array.isArray(p)&&(p=Uint8Array.from(p))),!(p instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(p.length===0)return"";for(var b=0,v=0,S=0,D=p.length;S!==D&&p[S]===0;)S++,b++;for(var E=(D-S)*u+1>>>0,R=new Uint8Array(E);S!==D;){for(var I=p[S],O=0,C=E-1;(I!==0||O<v)&&C!==-1;C--,O++)I+=256*R[C]>>>0,R[C]=I%a>>>0,I=I/a>>>0;if(I!==0)throw new Error("Non-zero carry");v=O,S++}for(var U=E-v;U!==E&&R[U]===0;)U++;for(var V=c.repeat(b);U<E;++U)V+=r.charAt(R[U]);return V}function m(p){if(typeof p!="string")throw new TypeError("Expected String");if(p.length===0)return new Uint8Array;var b=0;if(p[b]!==" "){for(var v=0,S=0;p[b]===c;)v++,b++;for(var D=(p.length-b)*d+1>>>0,E=new Uint8Array(D);p[b];){var R=t[p.charCodeAt(b)];if(R===255)return;for(var I=0,O=D-1;(R!==0||I<S)&&O!==-1;O--,I++)R+=a*E[O]>>>0,E[O]=R%256>>>0,R=R/256>>>0;if(R!==0)throw new Error("Non-zero carry");S=I,b++}if(p[b]!==" "){for(var C=D-S;C!==D&&E[C]===0;)C++;for(var U=new Uint8Array(v+(D-C)),V=v;C!==D;)U[V++]=E[C++];return U}}}function w(p){var b=m(p);if(b)return b;throw new Error(`Non-${e} character`)}return{encode:h,decodeUnsafe:m,decode:w}}var tI=eI,rI=tI,xw=rI;var Ik=l(f(),1),Tk=new Uint8Array(0);var Ew=(r,e)=>{if(r===e)return!0;if(r.byteLength!==e.byteLength)return!1;for(let t=0;t<r.byteLength;t++)if(r[t]!==e[t])return!1;return!0},Co=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var Dk=l(f(),1);var Yf=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Xf=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return vw(this,e)}},Zf=class{constructor(e){this.decoders=e}or(e){return vw(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},vw=(r,e)=>new Zf({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}}),Qf=class{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new Yf(e,t,n),this.decoder=new Xf(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Sw=({name:r,prefix:e,encode:t,decode:n})=>new Qf(r,e,t,n),eh=({prefix:r,name:e,alphabet:t})=>{let{encode:n,decode:i}=xw(t,e);return Sw({prefix:r,name:e,encode:n,decode:o=>Co(i(o))})},iI=(r,e,t,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*t/8|0),a=0,c=0,d=0;for(let u=0;u<o;++u){let h=i[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,s[d++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},oI=(r,e,t)=>{let n=e[e.length-1]==="=",i=(1<<t)-1,o="",s=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],s+=8;s>t;)s-=t,o+=e[i&a>>s];if(s&&(o+=e[i&a<<t-s]),n)for(;o.length*t&7;)o+="=";return o},yt=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>Sw({prefix:e,name:r,encode(i){return oI(i,n,t)},decode(i){return iI(i,n,t,r)}});var Zs=yt({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Pk=yt({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Kk=yt({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),Lk=yt({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Mk=yt({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Nk=yt({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),$k=yt({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),qk=yt({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),th=yt({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var zk=l(f(),1);var _t=eh({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),jk=eh({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var Qk=l(f(),1);var Jk=yt({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Yk=yt({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Pr=yt({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Xk=yt({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var tP=l(f(),1);function Aw(r){return r.byteOffset!==0||r.byteLength!==r.buffer.byteLength}function _w(r){return typeof r!="object"||r===null?!1:typeof r[Symbol.asyncIterator]=="function"}function Qs(r){let t=Object.prototype.toString.call(r).match(/\s([a-zA-Z0-9]+)/),[n,i]=t;return i}var ea=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},Tw=function(r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=r[Symbol.asyncIterator],t;return e?e.call(r):(r=typeof __values=="function"?__values(r):r[Symbol.iterator](),t={},n("next"),n("throw"),n("return"),t[Symbol.asyncIterator]=function(){return this},t);function n(o){t[o]=r[o]&&function(s){return new Promise(function(a,c){s=r[o](s),i(a,c,s.done,s.value)})}}function i(o,s,a,c){Promise.resolve(c).then(function(d){o({value:d,done:a})},s)}},uu=new TextEncoder,Ki=new TextDecoder,$e=class r{constructor(e,t){this.data=e,this.format=t}static arrayBuffer(e){return new r(e,"ArrayBuffer")}static asyncIterable(e){if(!_w(e))throw new TypeError("Input must be of type AsyncIterable.");return new r(e,"AsyncIterable")}static base32Z(e){return new r(e,"Base32Z")}static base58Btc(e){return new r(e,"Base58Btc")}static base64Url(e){return new r(e,"Base64Url")}static bufferSource(e){return new r(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new r(e,"Hex")}static multibase(e){return new r(e,"Multibase")}static object(e){return new r(e,"Object")}static string(e){return new r(e,"String")}static uint8Array(e){return new r(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return _t.baseDecode(this.data).buffer;case"Base64Url":return Pr.baseDecode(this.data).buffer;case"BufferSource":{if(Qs(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return Aw(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return ea(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return th.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{let e=new Uint8Array(this.data);return _t.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return _t.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{let e=new Uint8Array(this.data);return Pr.baseEncode(e)}case"BufferSource":{let e=this.toUint8Array();return Pr.baseEncode(e)}case"Object":{let e=JSON.stringify(this.data),t=uu.encode(e);return Pr.baseEncode(t)}case"String":{let e=uu.encode(this.data);return Pr.baseEncode(e)}case"Uint8Array":return Pr.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,t,n,i;return ea(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let c=[];try{for(var o=!0,s=Tw(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;let u=i;c.push(u)}}catch(u){t={error:u}}finally{try{!o&&!e&&(n=s.return)&&(yield n.call(s))}finally{if(t)throw t.error}}return new Blob(c)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){let e=Array.from({length:256},(t,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{let t=this.toUint8Array();return r.uint8Array(t).toHex()}case"Base64Url":{let t=this.toUint8Array();return r.uint8Array(t).toHex()}case"Uint8Array":{let t="";for(let n=0;n<this.data.length;n++)t+=e[this.data[n]];return t}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{let e=Pr.baseDecode(this.data),t=Ki.decode(e);return JSON.parse(t)}case"String":return JSON.parse(this.data);case"Uint8Array":{let e=Ki.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return ea(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return Ki.decode(this.data);case"Base64Url":{let e=Pr.baseDecode(this.data);return Ki.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return Ki.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,t,n,i;return ea(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let c="";try{for(var o=!0,s=Tw(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;let d=i;typeof d=="string"?c+=d:c+=Ki.decode(d,{stream:!0})}}catch(d){t={error:d}}finally{try{!o&&!e&&(n=s.return)&&(yield n.call(s))}finally{if(t)throw t.error}}return c+=Ki.decode(void 0,{stream:!1}),c}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return th.baseDecode(this.data);case"Base58Btc":return _t.baseDecode(this.data);case"Base64Url":return Pr.baseDecode(this.data);case"BufferSource":{let e=Qs(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{let e=new Uint8Array(this.data.length/2);for(let t=0;t<this.data.length;t+=2){let n=parseInt(this.data.substring(t,t+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[t/2]=n}return e}case"Object":{let e=JSON.stringify(this.data);return uu.encode(e)}case"String":return uu.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return ea(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};var RP=l(f(),1);var TP=l(f(),1);var xP=l(f(),1);var pn={};is(pn,{decode:()=>ko,encodeTo:()=>Li,encodingLength:()=>Mi});var lP=l(f(),1);var uP=l(f(),1),sI=Bw,Iw=128,aI=127,cI=~aI,uI=Math.pow(2,31);function Bw(r,e,t){e=e||[],t=t||0;for(var n=t;r>=uI;)e[t++]=r&255|Iw,r/=128;for(;r&cI;)e[t++]=r&255|Iw,r>>>=7;return e[t]=r|0,Bw.bytes=t-n+1,e}var dI=rh,lI=128,Dw=127;function rh(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a)throw rh.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&Dw)<<i:(s&Dw)*Math.pow(2,i),i+=7}while(s>=lI);return rh.bytes=o-n,t}var fI=Math.pow(2,7),hI=Math.pow(2,14),pI=Math.pow(2,21),yI=Math.pow(2,28),mI=Math.pow(2,35),gI=Math.pow(2,42),wI=Math.pow(2,49),bI=Math.pow(2,56),xI=Math.pow(2,63),EI=function(r){return r<fI?1:r<hI?2:r<pI?3:r<yI?4:r<mI?5:r<gI?6:r<wI?7:r<bI?8:r<xI?9:10},vI={encode:sI,decode:dI,encodingLength:EI},SI=vI,ta=SI;var ko=(r,e=0)=>[ta.decode(r,e),ta.decode.bytes],Li=(r,e,t=0)=>(ta.encode(r,e,t),e),Mi=r=>ta.encodingLength(r);var hP=l(f(),1);var nh=(r,e)=>{let t=e.byteLength,n=Mi(r),i=n+Mi(t),o=new Uint8Array(i+t);return Li(r,o,0),Li(t,o,n),o.set(e,i),new Po(r,t,e,o)},Rw=r=>{let e=Co(r),[t,n]=ko(e),[i,o]=ko(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Po(t,i,s,e)},Ow=(r,e)=>{if(r===e)return!0;{let t=e;return r.code===t.code&&r.size===t.size&&t.bytes instanceof Uint8Array&&Ew(r.bytes,t.bytes)}},Po=class{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}};var pP=l(f(),1);var Uw=(r,e)=>{let{bytes:t,version:n}=r;switch(n){case 0:return _I(t,oh(r),e||_t.encoder);default:return TI(t,oh(r),e||Zs.encoder)}};var Cw=new WeakMap,oh=r=>{let e=Cw.get(r);if(e==null){let t=new Map;return Cw.set(r,t),t}return e},sh=class r{constructor(e,t,n,i){this.code=t,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:t}=this;if(e!==ra)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(t.code!==II)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return r.createV0(t)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:t}=this.multihash,n=nh(e,t);return r.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return r.equals(this,e)}static equals(e,t){let n=t;return n&&e.code===n.code&&e.version===n.version&&Ow(e.multihash,n.multihash)}toString(e){return Uw(this,e)}toJSON(){return{"/":Uw(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let t=e;if(t instanceof r)return t;if(t["/"]!=null&&t["/"]===t.bytes||t.asCID===t){let{version:n,code:i,multihash:o,bytes:s}=t;return new r(n,i,o,s||kw(n,i,o.bytes))}else if(t[DI]===!0){let{version:n,multihash:i,code:o}=t,s=Rw(i);return r.create(n,o,s)}else return null}static create(e,t,n){if(typeof t!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(t!==ra)throw new Error(`Version 0 CID must use dag-pb (code: ${ra}) block encoding`);return new r(e,t,n,n.bytes)}case 1:{let i=kw(e,t,n.bytes);return new r(e,t,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return r.create(0,ra,e)}static createV1(e,t){return r.create(1,e,t)}static decode(e){let[t,n]=r.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return t}static decodeFirst(e){let t=r.inspectBytes(e),n=t.size-t.multihashSize,i=Co(e.subarray(n,n+t.multihashSize));if(i.byteLength!==t.multihashSize)throw new Error("Incorrect length");let o=i.subarray(t.multihashSize-t.digestSize),s=new Po(t.multihashCode,t.digestSize,o,i);return[t.version===0?r.createV0(s):r.createV1(t.codec,s),e.subarray(t.size)]}static inspectBytes(e){let t=0,n=()=>{let[h,m]=ko(e.subarray(t));return t+=m,h},i=n(),o=ra;if(i===18?(i=0,t=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=t,a=n(),c=n(),d=t+c,u=d-s;return{version:i,codec:o,multihashCode:a,digestSize:c,multihashSize:u,size:d}}static parse(e,t){let[n,i]=AI(e,t),o=r.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return oh(o).set(n,e),o}},AI=(r,e)=>{switch(r[0]){case"Q":{let t=e||_t;return[_t.prefix,t.decode(`${_t.prefix}${r}`)]}case _t.prefix:{let t=e||_t;return[_t.prefix,t.decode(r)]}case Zs.prefix:{let t=e||Zs;return[Zs.prefix,t.decode(r)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[r[0],e.decode(r)]}}},_I=(r,e,t)=>{let{prefix:n}=t;if(n!==_t.prefix)throw Error(`Cannot string encode V0 in ${t.name} encoding`);let i=e.get(n);if(i==null){let o=t.encode(r).slice(1);return e.set(n,o),o}else return i},TI=(r,e,t)=>{let{prefix:n}=t,i=e.get(n);if(i==null){let o=t.encode(r);return e.set(n,o),o}else return i},ra=112,II=18,kw=(r,e,t)=>{let n=Mi(r),i=n+Mi(e),o=new Uint8Array(i+t.byteLength);return Li(r,o,0),Li(e,o,n),o.set(t,i),o},DI=Symbol.for("@ipld/js-cid/CID");var vP=l(f(),1);var SP=l(f(),1);var lt=class r{static addPrefix(e){var t;let{code:n,data:i,name:o}=e;if(!(o?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=r.codeToName.has(n)?n:r.nameToCode.get(o),n===void 0)throw new Error(`Unsupported multicodec: ${(t=e.name)!==null&&t!==void 0?t:e.code}`);let s=pn.encodingLength(n),a=new Uint8Array(s+i.byteLength);return a.set(i,s),pn.encodeTo(n,a),a}static getCodeFromData(e){let{prefixedData:t}=e,[n,i]=pn.decode(t);return n}static getCodeFromName(e){let{name:t}=e,n=r.nameToCode.get(t);if(n===void 0)throw new Error(`Unsupported multicodec: ${t}`);return n}static getNameFromCode(e){let{code:t}=e,n=r.codeToName.get(t);if(n===void 0)throw new Error(`Unsupported multicodec: ${t}`);return n}static registerCodec(e){r.codeToName.set(e.code,e.name),r.nameToCode.set(e.name,e.code)}static removePrefix(e){let{prefixedData:t}=e,[n,i]=pn.decode(t),o=r.codeToName.get(n);if(o===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:t.slice(i),name:o}}};lt.codeToName=new Map;lt.nameToCode=new Map;lt.registerCodec({code:237,name:"ed25519-pub"});lt.registerCodec({code:4864,name:"ed25519-priv"});lt.registerCodec({code:236,name:"x25519-pub"});lt.registerCodec({code:4866,name:"x25519-priv"});lt.registerCodec({code:231,name:"secp256k1-pub"});lt.registerCodec({code:4865,name:"secp256k1-priv"});var UP=l(f(),1);var KP=l(f(),1),RI=l(Kw(),1);var NP=l(f(),1);var HP=l(f(),1),OI=l(qs(),1);var UI=l(qs(),1);function Tt(r){if(typeof r=="string"&&r.length!==0)return r.split("#").pop()}function CI({didDocument:r,id:e,type:t}){return r?.service?.filter(n=>!(e&&n.id!==e||t&&n.type!==t))??[]}async function kI({didDocument:r,publicKeyJwk:e,publicKeyMultibase:t}){let n=na({didDocument:r});for(let i of n)if(e&&i.publicKeyJwk){if(await ne({jwk:e})===await ne({jwk:i.publicKeyJwk}))return i}else if(t&&i.publicKeyMultibase&&t===i.publicKeyMultibase)return i;return null}function na({didDocument:r}){if(!r)throw new TypeError("Required parameter missing: 'didDocument'");let e=[];return e.push(...r.verificationMethod?.filter(du)??[]),Object.keys(ti).forEach(t=>{e.push(...r[t]?.filter(du)??[])}),e}function ah({didDocument:r}){let t=na({didDocument:r}).map(n=>n.type);return[...new Set(t)]}function ch({didDocument:r,methodId:e}){let t=[];return Object.keys(ti).forEach(n=>{if(Array.isArray(r[n])){let i=r[n],o=Tt(e);i.some(a=>{let c=Tt(a)===o,d=du(a)&&Tt(a.id)===o;return c||d})&&t.push(n)}}),t}function Lw(r){return!r||typeof r!="object"||r===null?!1:"id"in r&&"type"in r&&"serviceEndpoint"in r}function PI(r){if(!Lw(r)||r.type!=="DecentralizedWebNode"||!("enc"in r&&"sig"in r))return!1;let e=t=>typeof t=="string"||Array.isArray(t)&&t.every(n=>typeof n=="string");return e(r.enc)&&e(r.sig)}function du(r){return!(!r||typeof r!="object"||r===null||!("id"in r&&"type"in r&&"controller"in r)||typeof r.id!="string"||typeof r.type!="string"||typeof r.controller!="string")}function lu({keyBytes:r,multicodecCode:e,multicodecName:t}){let n=lt.addPrefix({code:e,data:r,name:t}),i=$e.uint8Array(n).toBase58Btc();return $e.base58Btc(i).toMultibase()}function fu({multibaseKeyId:r}){try{let e=$e.multibase(r).toBase58Btc(),t=$e.base58Btc(e).toUint8Array(),{code:n,data:i,name:o}=lt.removePrefix({prefixedData:t});return{keyBytes:i,multicodecCode:n,multicodecName:o}}catch{throw new $("invalidDid",`Invalid multibase identifier: ${r}`)}}var mt=class r{constructor({uri:e,document:t,metadata:n,keyManager:i}){this.uri=e,this.document=t,this.metadata=n,this.keyManager=i}async export(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){let t=[];for(let n of this.document.verificationMethod){if(!n.publicKeyJwk)throw new Error(`Verification method '${n.id}' does not contain a public key in JWK format`);let i=await this.keyManager.getKeyUri({key:n.publicKeyJwk}),o=await this.keyManager.exportKey({keyUri:i});t.push({...o})}e.privateKeys=t}return e}async getSigner(e){let t=this.document.verificationMethod?.find(a=>Tt(a.id)===(Tt(e?.methodId)??Tt(this.document.assertionMethod?.[0])));if(!(t&&t.publicKeyJwk))throw new $("internalError","A verification method intended for signing could not be determined from the DID Document");let n=await this.keyManager.getKeyUri({key:t.publicKeyJwk}),i=await this.keyManager.getPublicKey({keyUri:n}),o=this.keyManager;return{algorithm:bw.getJoseSignatureAlgorithmFromPublicKey(i),keyId:t.id,async sign({data:a}){return await o.sign({data:a,keyUri:n})},async verify({data:a,signature:c}){return await o.verify({data:a,key:i,signature:c})}}}static async import({portableDid:e,keyManager:t=new dt}){let n=na({didDocument:e.document});if(n.length===0)throw new $("invalidDidDocument","At least one verification method is required but 0 were given");for(let o of e.privateKeys??[])await t.importKey({key:o});for(let o of n){if(!o.publicKeyJwk)throw new Error(`Verification method '${o.id}' does not contain a public key in JWK format`);let s=await t.getKeyUri({key:o.publicKeyJwk});await t.getPublicKey({keyUri:s})}return new r({uri:e.uri,document:e.document,metadata:e.metadata,keyManager:t})}};var mL=l(f(),1);var HK=l(f(),1);var UK=l(f(),1);var _K=l(f(),1);var yK=l(f(),1);var dh="0123456789abcdef",Nw=[],Mw=[];for(let r=0;r<256;r++)Nw[r]=dh[r>>4&15]+dh[r&15],r<16&&(r<10?Mw[48+r]=r:Mw[87+r]=r);var lh=r=>{let e=r.length,t="",n=0;for(;n<e;)t+=Nw[r[n++]];return t};var $w=(r,e=0)=>{let t=r.length||0;if(!e){let s=t;for(;s--;)e+=r[s].length}let n=new Uint8Array(e),i=e,o=t;for(;o--;)i-=r[o].length,n.set(r[o],i);return n};var gK=l(f()),qw="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",KI=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(ia=0;ia<qw.length;ia++)KI[qw.charCodeAt(ia)]=ia;var ia;var LI=new TextDecoder,fh=(r,e)=>e?new TextDecoder(e).decode(r):LI.decode(r),MI=new TextEncoder,Zt=r=>MI.encode(r);var Fw=typeof window<"u"?window:self,Vw=Fw.crypto||Fw.msCrypto||{},SK=Vw.subtle||Vw.webkitSubtle;var DK=l(f(),1);function Ko(r){let e=r<0?1:0;return r=Math.abs(Number(r||1)),Math.floor(Math.log10(r))+1+e}function hu(r){return ArrayBuffer.isView(r)?"arraybufferview":Array.isArray(r)?"array":r instanceof Number?"number":r instanceof Boolean?"boolean":r instanceof Set?"set":r instanceof Map?"map":r instanceof String?"string":r instanceof ArrayBuffer?"arraybuffer":typeof r}function me(r,e,t){let n=[],i=null;return me._encode(n,r),i=$w(n),me.bytes=i.length,ArrayBuffer.isView(e)?(e.set(i,t),e):i}me.bytes=-1;me._floatConversionDetected=!1;me._encode=function(r,e){if(e!=null)switch(hu(e)){case"object":me.dict(r,e);break;case"map":me.dictMap(r,e);break;case"array":me.list(r,e);break;case"set":me.listSet(r,e);break;case"string":me.string(r,e);break;case"number":me.number(r,e);break;case"boolean":me.number(r,e);break;case"arraybufferview":me.buffer(r,new Uint8Array(e.buffer,e.byteOffset,e.byteLength));break;case"arraybuffer":me.buffer(r,new Uint8Array(e));break}};var pu=new Uint8Array([101]),Hw=new Uint8Array([100]),jw=new Uint8Array([108]);me.buffer=function(r,e){r.push(Zt(e.length+":"),e)};me.string=function(r,e){r.push(Zt(Zt(e).byteLength+":"+e))};me.number=function(r,e){if(Number.isInteger(e))return r.push(Zt("i"+BigInt(e)+"e"));let t=2147483648,n=e/t<<0,i=e%t<<0,o=n*t+i;r.push(Zt("i"+o+"e")),o!==e&&!me._floatConversionDetected&&(me._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+e+'":','Bencoding only defines support for integers, value was converted to "'+o+'"'),console.trace())};me.dict=function(r,e){r.push(Hw);let t=0,n,i=Object.keys(e).sort(),o=i.length;for(;t<o;t++)n=i[t],e[n]!=null&&(me.string(r,n),me._encode(r,e[n]));r.push(pu)};me.dictMap=function(r,e){r.push(Hw);let t=Array.from(e.keys()).sort();for(let n of t)e.get(n)!=null&&(ArrayBuffer.isView(n)?me._encode(r,n):me.string(r,String(n)),me._encode(r,e.get(n)));r.push(pu)};me.list=function(r,e){let t=0,n=e.length;for(r.push(jw);t<n;t++)e[t]!=null&&me._encode(r,e[t]);r.push(pu)};me.listSet=function(r,e){r.push(jw);for(let t of e)t!=null&&me._encode(r,t);r.push(pu)};var Ww=me;var PK=l(f(),1);var NI=105,$I=58,qI=100,FI=108,hh=101;function zw(r,e,t){let n=0,i=1;for(let o=e;o<t;o++){let s=r[o];if(s<58&&s>=48){n=n*10+(s-48);continue}if(!(o===e&&s===43)){if(o===e&&s===45){i=-1;continue}if(s===46)break;throw new Error("not a number: buffer["+o+"] = "+s)}}return n*i}function G(r,e,t,n){return r==null||r.length===0?null:(typeof e!="number"&&n==null&&(n=e,e=void 0),typeof t!="number"&&n==null&&(n=t,t=void 0),G.position=0,G.encoding=n||null,G.data=ArrayBuffer.isView(r)?new Uint8Array(r.slice(e,t)):Zt(r),G.bytes=G.data.length,G.next())}G.bytes=0;G.position=0;G.data=null;G.encoding=null;G.next=function(){switch(G.data[G.position]){case qI:return G.dictionary();case FI:return G.list();case NI:return G.integer();default:return G.buffer()}};G.find=function(r){let e=G.position,t=G.data.length,n=G.data;for(;e<t;){if(n[e]===r)return e;e++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(r)+'" [0x'+r.toString(16)+"]")};G.dictionary=function(){G.position++;let r={};for(;G.data[G.position]!==hh;){let e=G.buffer(),t=fh(e);t.includes("\uFFFD")&&(t=lh(e)),r[t]=G.next()}return G.position++,r};G.list=function(){G.position++;let r=[];for(;G.data[G.position]!==hh;)r.push(G.next());return G.position++,r};G.integer=function(){let r=G.find(hh),e=zw(G.data,G.position+1,r);return G.position+=r+1-G.position,e};G.buffer=function(){let r=G.find($I),e=zw(G.data,G.position,r),t=++r+e;return G.position=t,G.encoding?fh(G.data.slice(r,t)):G.data.slice(r,t)};var Gw=G;var NK=l(f(),1);function VI(r){let e=2;for(let t of r)e+=yu(t);return e}function HI(r){let e=2;for(let[t,n]of r){let i=Zt(t).byteLength;e+=Ko(i)+1+i,e+=yu(n)}return e}function jI(r){let e=2,t=Object.keys(r);for(let n=0;n<t.length;n++){let i=Zt(t[n]).byteLength;e+=Ko(i)+1+i,e+=yu(r[t[n]])}return e}function WI(r){let e=Zt(r).byteLength;return Ko(e)+1+e}function zI(r){let e=r.byteLength-r.byteOffset;return Ko(e)+1+e}function yu(r){if(r==null)return 0;let t=hu(r);switch(t){case"arraybufferview":return zI(r);case"string":return WI(r);case"array":case"set":return VI(r);case"number":return 1+Ko(Math.floor(r))+1;case"bigint":return 1+r.toString().length+1;case"object":return jI(r);case"map":return HI(r);default:throw new TypeError(`Unsupported value of type "${t}"`)}}var ph=yu;var GI=ph,yh={encode:Ww,decode:Gw,byteLength:ph,encodingLength:GI};var tL=l(f(),1);var jK=l(f(),1),JI=/^(\d{1,3}\.){3,3}\d{1,3}$/;var YI=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;var lr={name:"v4",size:4,isFormat:r=>JI.test(r),encode(r,e,t){t=~~t,e=e||new Uint8Array(t+4);let n=r.length,i=0;for(let o=0;o<n;){let s=r.charCodeAt(o++);s===46?(e[t++]=i,i=0):i=i*10+(s-48)}return e[t]=i,e},decode(r,e){return e=~~e,`${r[e++]}.${r[e++]}.${r[e++]}.${r[e]}`}},yn={name:"v6",size:16,isFormat:r=>r.length>0&&YI.test(r),encode(r,e,t){t=~~t;let n=t+16,i=-1,o=0,s=0,a=!0,c=!1;e=e||new Uint8Array(t+16);for(let d=0;d<r.length;d++){let u=r.charCodeAt(d);u===58?(a?i!==-1?(t<n&&(e[t]=0),t<n-1&&(e[t+1]=0),t+=2):t<n&&(i=t):(c===!0?(t<n&&(e[t]=s),t++):(t<n&&(e[t]=o>>8),t<n-1&&(e[t+1]=o&255),t+=2),o=0,s=0),a=!0,c=!1):u===46?(t<n&&(e[t]=s),t++,s=0,o=0,a=!1,c=!0):(a=!1,u>=97?u-=87:u>=65?u-=55:(u-=48,s=s*10+u),o=(o<<4)+u)}if(a===!1)c===!0?(t<n&&(e[t]=s),t++):(t<n&&(e[t]=o>>8),t<n-1&&(e[t+1]=o&255),t+=2);else if(i===0)t<n&&(e[t]=0),t<n-1&&(e[t+1]=0),t+=2;else if(i!==-1){t+=2;for(let d=Math.min(t-1,n-1);d>=i+2;d--)e[d]=e[d-2];e[i]=0,e[i+1]=0,i=t}if(i!==t&&i!==-1)for(t>n-2&&(t=n-2);n>i;)e[--n]=t<n&&t>i?e[--t]:0;else for(;t<n;)e[t++]=0;return e},decode(r,e){e=~~e;let t="";for(let n=0;n<16;n+=2)n!==0&&(t+=":"),t+=(r[e+n]<<8|r[e+n+1]).toString(16);return t.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};function Jw(r){if(lr.isFormat(r))return lr.size;if(yn.isFormat(r))return yn.size;throw Error(`Invalid ip address: ${r}`)}function Yw(r){return Jw(r)===lr.size?1:2}function Xw(r,e,t){t=~~t;let n=Jw(r);return typeof e=="function"&&(e=e(t+n)),n===lr.size?lr.encode(r,e,t):yn.encode(r,e,t)}function Zw(r,e,t){if(e=~~e,t=t||r.length-e,t===lr.size)return lr.decode(r,e,t);if(t===yn.size)return yn.decode(r,e,t);throw Error(`Invalid buffer size needs to be ${lr.size} for v4 or ${yn.size} for v6.`)}var WK=l(f(),1);function oa(r){switch(r){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+r}function Lo(r){switch(r.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":return 255;case"*":return 255}return r.toUpperCase().startsWith("UNKNOWN_")?parseInt(r.slice(8)):0}var zK=l(f(),1);function Qw(r){switch(r){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+r}var GK=l(f(),1);function eb(r){switch(r){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+r}var JK=l(f(),1);function mh(r){switch(r){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+r}function gh(r){switch(r.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}var YK=l(f(),1);function tb(r){switch(r){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return r<0?null:`OPTION_${r}`}function wh(r){if(typeof r=="number")return r;if(!r)return-1;switch(r.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}let e=r.match(/_(\d+)$/);return e?parseInt(e[1],10):-1}var ZK=l(f(),1);var XK=l(f(),1);function bh(r){let e=0,t=r.length;for(let n=0;n<t;n+=1){let i=r.charCodeAt(n);if(i<=127)e+=1;else if(i<=2047)e+=2;else if((i&63488)!==55296)e+=3;else{let o=n+1;o===t||i>=56320||(r.charCodeAt(o)&64512)!==56320?e+=3:(n=o,e+=4)}}return e}function Mo(r,e,t){let n=r.length;t==null&&(t=0),e===void 0&&(e=new Uint8Array(bh(r)+t));let i=t;for(let o=0;o<n;o+=1){let s=r.charCodeAt(o);if(s<=127)e[i++]=s;else if(s<=2047)e[i++]=192|(s&1984)>>6,e[i++]=128|s&63;else if((s&63488)!==55296)e[i++]=224|(s&61440)>>12,e[i++]=128|(s&4032)>>6,e[i++]=128|s&63;else{let a=o+1;if(a===n||s>=56320)e[i++]=239,e[i++]=191,e[i++]=189;else{let c=r.charCodeAt(a);(c&64512)!==56320?(e[i++]=239,e[i++]=191,e[i++]=189):(o=a,s=65536|(s&1023)<<10|c&1023,e[i++]=240|(s&1835008)>>18,e[i++]=128|(s&258048)>>12,e[i++]=128|(s&4032)>>6,e[i++]=128|s&63)}}}return Mo.bytes=i-t,e}Mo.bytes=0;function No(r,e,t){let n="";e==null&&(e=0),t==null&&(t=r.length);for(let i=e;i<t;){let o=r[i++],s;if(o<=128)s=o;else if(o>191&&o<224)s=(o&31)<<6|r[i++]&63;else if(o>239&&o<365){s=((o&7)<<18|(r[i++]&63)<<12|(r[i++]&63)<<6|r[i++]&63)-65536;let a=55296|s>>10&1023;n+=String.fromCharCode(a),s=56320|s&1023}else s=(o&15)<<12|(r[i++]&63)<<6|r[i++]&63;n+=String.fromCharCode(s)}return No.bytes=t-e,n}No.bytes=0;var Vn=r=>r instanceof Uint8Array;function mn(r){return typeof r=="string"?bh(r):r.byteLength}function mu(r){return r instanceof Uint8Array?r:Array.isArray(r)?new Uint8Array(r):Mo(r)}function gu(r,e,t){if(typeof e!="string")throw new Error("unknown input type");return Mo(e,r,t),Mo.bytes}var sa={},rb=new Array(255);for(let r=0;r<=15;r+=1){let e=r.toString(16),t=e.toUpperCase();for(let n=0;n<=15;n+=1){let i=n.toString(16),o=i.toUpperCase(),s=r<<4|n,a=`${e}${i}`;rb[s]=a,sa[a]=s,sa[`${t}${i}`]=s,sa[`${e}${o}`]=s,sa[`${t}${o}`]=s}}function nb(r,e,t){let n="";for(let i=e;i<t;){let o=r[i++];n+=rb[o]}return n}function xh(r){return r.length>>>1}function ib(r,e,t,n){let i=0;for(;t<n;){let o=e.substr(i,2),s=sa[o];if(s===void 0)return;r[t++]=s,i+=2}return r}var iD=Math.pow(2,24),oD=Math.pow(2,16),sD=Math.pow(2,8),Kr=(r,e)=>r[e]*iD+r[e+1]*oD+r[e+2]*sD+r[e+3],se=(r,e)=>r[e]<<8|r[e+1],Lr=(r,e,t)=>(e=+e,r[t+3]=e,e=e>>>8,r[t+2]=e,e=e>>>8,r[t+1]=e,e=e>>>8,r[t]=e,t+4),j=(r,e,t)=>(r[t]=e>>8,r[t+1]=e&255,t+2);function It(r,e,t,n,i){return t<0&&(n-=t,t=0),n<0&&(n=0),i<0?new Uint8Array(0):t>=e.length||n>=i?0:aD(r,e,t,n,i)}function aD(r,e,t,n,i){i-n>e.length-t&&(i=n+e.length-t);let o=i-n,s=r.length-n;return o>s&&(o=s),(n!==0||i<r.length)&&(r=new Uint8Array(r.buffer,r.byteOffset+n,o)),e.set(r,t),o}var uD=0,ob=32768,vh=32768,dD=~vh,ab=32768,lD=~ab;function ve({bytes:r=0,encode:e,decode:t,encodingLength:n}){return e.bytes=r,t.bytes=r,{encode:e,decode:t,encodingLength:n||(()=>r)}}var q=ve({encode(r,e,t){e||(e=new Uint8Array(q.encodingLength(r))),t||(t=0);let n=t,i=r.replace(/^\.|\.$/gm,"");if(i.length){let o=i.split(".");for(let s=0;s<o.length;s++){let a=gu(e,o[s],t+1);e[t]=a,t+=a+1}}return e[t++]=0,q.encode.bytes=t-n,e},decode(r,e){e||(e=0);let t=[],n=e,i=0,o=0,s=!1;for(;;){if(e>=r.length)throw new Error("Cannot decode name (buffer overflow)");let a=r[e++];if(o+=s?0:1,a===0)break;if(a&192)if((a&192)===192){if(e+1>r.length)throw new Error("Cannot decode name (buffer overflow)");let c=se(r,e-1)-49152;if(c>=n)throw new Error("Cannot decode name (bad pointer)");e=c,n=c,o+=s?0:1,s=!0}else throw new Error("Cannot decode name (bad label)");else{if(e+a>r.length)throw new Error("Cannot decode name (buffer overflow)");if(i+=a+1,i>254)throw new Error("Cannot decode name (name too long)");t.push(No(r,e,e+a)),e+=a,o+=s?0:a}}return q.decode.bytes=o,t.length===0?".":t.join(".")},encodingLength(r){return r==="."||r===".."?1:mn(r.replace(/^\.|\.$/gm,""))+2}}),Ye=ve({encode(r,e,t){e||(e=new Uint8Array(Ye.encodingLength(r))),t||(t=0);let n=gu(e,r,t+1);return e[t]=n,Ye.encode.bytes=n+1,e},decode(r,e){e||(e=0);let t=r[e],n=No(r,e+1,e+1+t);return Ye.decode.bytes=t+1,n},encodingLength(r){return mn(r)+1}}),$o=ve({bytes:12,encode(r,e,t){e||(e=new Uint8Array($o.encodingLength(r))),t||(t=0);let n=(r.flags||0)&32767,i=r.type==="response"?ob:uD;return j(e,r.id||0,t),j(e,n|i,t+2),j(e,r.questions.length,t+4),j(e,r.answers.length,t+6),j(e,r.authorities.length,t+8),j(e,r.additionals.length,t+10),e},decode(r,e){if(e||(e=0),r.length<12)throw new Error("Header must be 12 bytes");let t=se(r,e+2);return{id:se(r,e),type:t&ob?"response":"query",flags:t&32767,flag_qr:(t>>15&1)===1,opcode:eb(t>>11&15),flag_aa:(t>>10&1)===1,flag_tc:(t>>9&1)===1,flag_rd:(t>>8&1)===1,flag_ra:(t>>7&1)===1,flag_z:(t>>6&1)===1,flag_ad:(t>>5&1)===1,flag_cd:(t>>4&1)===1,rcode:Qw(t&15),questions:new Array(se(r,e+4)),answers:new Array(se(r,e+6)),authorities:new Array(se(r,e+8)),additionals:new Array(se(r,e+10))}},encodingLength(){return 12}}),bu=ve({encode(r,e,t){e||(e=new Uint8Array(bu.encodingLength(r))),t||(t=0);let n=r.length;return j(e,n,t),It(r,e,t+2,0,n),bu.encode.bytes=n+2,e},decode(r,e){e||(e=0);let t=se(r,e),n=r.slice(e+2,e+2+t);return bu.decode.bytes=t+2,n},encodingLength(r){return r.length+2}}),xu=ve({encode(r,e,t){return e||(e=new Uint8Array(xu.encodingLength(r))),t||(t=0),q.encode(r,e,t+2),j(e,q.encode.bytes,t),xu.encode.bytes=q.encode.bytes+2,e},decode(r,e){e||(e=0);let t=se(r,e),n=q.decode(r,e+2);return xu.decode.bytes=t+2,n},encodingLength(r){return q.encodingLength(r)+2}}),Eu=ve({encode(r,e,t){e||(e=new Uint8Array(Eu.encodingLength(r))),t||(t=0);let n=t;return t+=2,q.encode(r.mname,e,t),t+=q.encode.bytes,q.encode(r.rname,e,t),t+=q.encode.bytes,Lr(e,r.serial||0,t),t+=4,Lr(e,r.refresh||0,t),t+=4,Lr(e,r.retry||0,t),t+=4,Lr(e,r.expire||0,t),t+=4,Lr(e,r.minimum||0,t),t+=4,j(e,t-n-2,n),Eu.encode.bytes=t-n,e},decode(r,e){e||(e=0);let t=e,n={};return e+=2,n.mname=q.decode(r,e),e+=q.decode.bytes,n.rname=q.decode(r,e),e+=q.decode.bytes,n.serial=Kr(r,e),e+=4,n.refresh=Kr(r,e),e+=4,n.retry=Kr(r,e),e+=4,n.expire=Kr(r,e),e+=4,n.minimum=Kr(r,e),e+=4,Eu.decode.bytes=e-t,n},encodingLength(r){return 22+q.encodingLength(r.mname)+q.encodingLength(r.rname)}}),vu=ve({encode(r,e,t){Array.isArray(r)||(r=[r]);for(let i=0;i<r.length;i++)if(typeof r[i]=="string"&&(r[i]=mu(r[i])),!Vn(r[i]))throw new Error("Must be a Buffer");e||(e=new Uint8Array(vu.encodingLength(r))),t||(t=0);let n=t;return t+=2,r.forEach(function(i){e[t++]=i.length,It(i,e,t,0,i.length),t+=i.length}),j(e,t-n-2,n),vu.encode.bytes=t-n,e},decode(r,e){e||(e=0);let t=e,n=se(r,e);e+=2;let i=[];for(;n>0;){let o=r[e++];if(--n,n<o)throw new Error("Buffer overflow");i.push(r.slice(e,e+o)),e+=o,n-=o}return vu.decode.bytes=e-t,i},encodingLength(r){Array.isArray(r)||(r=[r]);let e=2;return r.forEach(function(t){typeof t=="string"?e+=mn(t)+1:e+=t.length+1}),e}}),Su=ve({encode(r,e,t){e||(e=new Uint8Array(Su.encodingLength(r))),t||(t=0),typeof r=="string"&&(r=mu(r)),r||(r=new Uint8Array(0));let n=t;t+=2;let i=r.length;return It(r,e,t,0,i),t+=i,j(e,t-n-2,n),Su.encode.bytes=t-n,e},decode(r,e){e||(e=0);let t=e,n=se(r,e);e+=2;let i=r.slice(e,e+n);return e+=n,Su.decode.bytes=e-t,i},encodingLength(r){return r?(Vn(r)?r.length:mn(r))+2:2}}),Au=ve({encode(r,e,t){e||(e=new Uint8Array(Au.encodingLength(r))),t||(t=0);let n=t;return t+=2,Ye.encode(r.cpu,e,t),t+=Ye.encode.bytes,Ye.encode(r.os,e,t),t+=Ye.encode.bytes,j(e,t-n-2,n),Au.encode.bytes=t-n,e},decode(r,e){e||(e=0);let t=e,n={};return e+=2,n.cpu=Ye.decode(r,e),e+=Ye.decode.bytes,n.os=Ye.decode(r,e),e+=Ye.decode.bytes,Au.decode.bytes=e-t,n},encodingLength(r){return Ye.encodingLength(r.cpu)+Ye.encodingLength(r.os)+2}}),Vo=ve({encode(r,e,t){return e||(e=new Uint8Array(Vo.encodingLength(r))),t||(t=0),q.encode(r,e,t+2),j(e,q.encode.bytes,t),Vo.encode.bytes=q.encode.bytes+2,e},decode(r,e){e||(e=0);let t=q.decode(r,e+2);return Vo.decode.bytes=q.decode.bytes+2,t},encodingLength(r){return q.encodingLength(r)+2}}),_u=ve({encode(r,e,t){e||(e=new Uint8Array(_u.encodingLength(r))),t||(t=0),j(e,r.priority||0,t+2),j(e,r.weight||0,t+4),j(e,r.port||0,t+6),q.encode(r.target,e,t+8);let n=q.encode.bytes+6;return j(e,n,t),_u.encode.bytes=n+2,e},decode(r,e){e||(e=0);let t=se(r,e),n={};return n.priority=se(r,e+2),n.weight=se(r,e+4),n.port=se(r,e+6),n.target=q.decode(r,e+8),_u.decode.bytes=t+2,n},encodingLength(r){return 8+q.encodingLength(r.target)}}),Hn=ve({encode(r,e,t){let n=Hn.encodingLength(r);return e||(e=new Uint8Array(Hn.encodingLength(r))),t||(t=0),r.issuerCritical&&(r.flags=Hn.ISSUER_CRITICAL),j(e,n-2,t),t+=2,e[t]=r.flags||0,t+=1,Ye.encode(r.tag,e,t),t+=Ye.encode.bytes,gu(e,r.value,t),t+=mn(r.value),Hn.encode.bytes=n,e},decode(r,e){e||(e=0);let t=se(r,e);e+=2;let n=e,i={};return i.flags=r[e],e+=1,i.tag=Ye.decode(r,e),e+=Ye.decode.bytes,i.value=No(r,e,n+t),i.issuerCritical=!!(i.flags&Hn.ISSUER_CRITICAL),Hn.decode.bytes=t+2,i},encodingLength(r){return Ye.encodingLength(r.tag)+Ye.encodingLength(r.value)+2}});Hn.ISSUER_CRITICAL=128;var Tu=ve({encode(r,e,t){e||(e=new Uint8Array(Tu.encodingLength(r))),t||(t=0);let n=t;return t+=2,j(e,r.preference||0,t),t+=2,q.encode(r.exchange,e,t),t+=q.encode.bytes,j(e,t-n-2,n),Tu.encode.bytes=t-n,e},decode(r,e){e||(e=0);let t=e,n={};return e+=2,n.preference=se(r,e),e+=2,n.exchange=q.decode(r,e),e+=q.decode.bytes,Tu.decode.bytes=e-t,n},encodingLength(r){return 4+q.encodingLength(r.exchange)}}),cb=ve({encode(r,e,t){return e||(e=new Uint8Array(cb.encodingLength(r))),t||(t=0),j(e,4,t),t+=2,lr.encode(r,e,t),e},decode(r,e){return e||(e=0),e+=2,lr.decode(r,e)},bytes:6}),Iu=ve({encode(r,e,t){return e||(e=new Uint8Array(Iu.encodingLength(r))),t||(t=0),j(e,16,t),t+=2,yn.encode(r,e,t),Iu.encode.bytes=18,e},decode(r,e){e||(e=0),e+=2;let t=yn.decode(r,e);return Iu.decode.bytes=18,t},bytes:18}),sb=r=>new Uint8Array(r),gn=ve({encode(r,e,t){e||(e=new Uint8Array(gn.encodingLength(r))),t||(t=0);let n=t,i=wh(r.code);if(j(e,i,t),t+=2,r.data)j(e,r.data.length,t),t+=2,It(r.data,e,t),t+=r.data.length;else switch(i){case 8:{let o=r.sourcePrefixLength||0,s=r.family||Yw(r.ip,sb),a=Xw(r.ip,sb),c=Math.ceil(o/8);j(e,c+4,t),t+=2,j(e,s,t),t+=2,e[t++]=o,e[t++]=r.scopePrefixLength||0,It(a,e,t,0,c),t+=c}break;case 11:r.timeout?(j(e,2,t),t+=2,j(e,r.timeout,t),t+=2):(j(e,0,t),t+=2);break;case 12:{let o=r.length||0;j(e,o,t),t+=2,e.fill(0,t,t+o),t+=o}break;case 14:{let o=r.tags.length*2;j(e,o,t),t+=2;for(let s of r.tags)j(e,s,t),t+=2}break;default:throw new Error(`Unknown roption code: ${r.code}`)}return gn.encode.bytes=t-n,e},decode(r,e){e||(e=0);let t={};t.code=se(r,e),t.type=tb(t.code),e+=2;let n=se(r,e);switch(e+=2,t.data=r.slice(e,e+n),t.code){case 8:t.family=se(r,e),e+=2,t.sourcePrefixLength=r[e++],t.scopePrefixLength=r[e++];{let i=new Uint8Array(t.family===1?4:16);It(r,i,0,e,e+n-4),t.ip=Zw(i)}break;case 11:n>0&&(t.timeout=se(r,e),e+=2);break;case 14:t.tags=[];for(let i=0;i<n;i+=2)t.tags.push(se(r,e)),e+=2}return gn.decode.bytes=n+4,t},encodingLength(r){if(r.data)return r.data.length+4;switch(wh(r.code)){case 8:{let t=r.sourcePrefixLength||0;return Math.ceil(t/8)+8}case 11:return typeof r.timeout=="number"?6:4;case 12:return r.length+4;case 14:return 4+r.tags.length*2}throw new Error(`Unknown roption code: ${r.code}`)}}),jn=ve({encode(r,e,t){e||(e=new Uint8Array(jn.encodingLength(r))),t||(t=0);let n=t,i=Fo(r,gn);return j(e,i,t),t=fa(r,gn,e,t+2),jn.encode.bytes=t-n,e},decode(r,e){e||(e=0);let t=e,n=[],i=se(r,e);e+=2;let o=0;for(;i>0;)n[o++]=gn.decode(r,e),e+=gn.decode.bytes,i-=gn.decode.bytes;return jn.decode.bytes=e-t,n},encodingLength(r){return 2+Fo(r||[],gn)}}),Mr=ve({encode(r,e,t){e||(e=new Uint8Array(Mr.encodingLength(r))),t||(t=0);let n=t,i=r.key;if(!Vn(i))throw new Error("Key must be a Buffer");return t+=2,j(e,r.flags,t),t+=2,e[t]=Mr.PROTOCOL_DNSSEC,t+=1,e[t]=r.algorithm,t+=1,It(i,e,t,0,i.length),t+=i.length,Mr.encode.bytes=t-n,j(e,Mr.encode.bytes-2,n),e},decode(r,e){e||(e=0);let t=e,n={},i=se(r,e);if(e+=2,n.flags=se(r,e),e+=2,r[e]!==Mr.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return e+=1,n.algorithm=r[e],e+=1,n.key=r.slice(e,t+i+2),e+=n.key.length,Mr.decode.bytes=e-t,n},encodingLength(r){return 6+mn(r.key)}});Mr.PROTOCOL_DNSSEC=3;Mr.ZONE_KEY=128;Mr.SECURE_ENTRYPOINT=32768;var aa=ve({encode(r,e,t){e||(e=new Uint8Array(aa.encodingLength(r))),t||(t=0);let n=t,i=r.signature;if(!Vn(i))throw new Error("Signature must be a Buffer");return t+=2,j(e,Lo(r.typeCovered),t),t+=2,e[t]=r.algorithm,t+=1,e[t]=r.labels,t+=1,Lr(e,r.originalTTL,t),t+=4,Lr(e,r.expiration,t),t+=4,Lr(e,r.inception,t),t+=4,j(e,r.keyTag,t),t+=2,q.encode(r.signersName,e,t),t+=q.encode.bytes,It(i,e,t,0,i.length),t+=i.length,aa.encode.bytes=t-n,j(e,aa.encode.bytes-2,n),e},decode(r,e){e||(e=0);let t=e,n={},i=se(r,e);return e+=2,n.typeCovered=oa(se(r,e)),e+=2,n.algorithm=r[e],e+=1,n.labels=r[e],e+=1,n.originalTTL=Kr(r,e),e+=4,n.expiration=Kr(r,e),e+=4,n.inception=Kr(r,e),e+=4,n.keyTag=se(r,e),e+=2,n.signersName=q.decode(r,e),e+=q.decode.bytes,n.signature=r.slice(e,t+i+2),e+=n.signature.length,aa.decode.bytes=e-t,n},encodingLength(r){return 20+q.encodingLength(r.signersName)+mn(r.signature)}}),ca=ve({encode(r,e,t){e||(e=new Uint8Array(ca.encodingLength(r))),t||(t=0);let n=t;return t+=2,q.encode(r.mbox||".",e,t),t+=q.encode.bytes,q.encode(r.txt||".",e,t),t+=q.encode.bytes,ca.encode.bytes=t-n,j(e,ca.encode.bytes-2,n),e},decode(r,e){e||(e=0);let t=e,n={};return e+=2,n.mbox=q.decode(r,e)||".",e+=q.decode.bytes,n.txt=q.decode(r,e)||".",e+=q.decode.bytes,ca.decode.bytes=e-t,n},encodingLength(r){return 2+q.encodingLength(r.mbox||".")+q.encodingLength(r.txt||".")}}),Kt=ve({encode(r,e,t){e||(e=new Uint8Array(Kt.encodingLength(r))),t||(t=0);let n=t,i=[];for(let o=0;o<r.length;o++){let s=Lo(r[o]);i[s>>8]===void 0&&(i[s>>8]=[]),i[s>>8][s>>3&31]|=1<<7-(s&7)}for(let o=0;o<i.length;o++)if(i[o]!==void 0){let s=mu(i[o]);e[t]=o,t+=1,e[t]=s.length,t+=1,It(s,e,t,0,s.length),t+=s.length}return Kt.encode.bytes=t-n,e},decode(r,e,t){e||(e=0);let n=e,i=[];for(;e-n<t;){let o=r[e];e+=1;let s=r[e];e+=1;for(let a=0;a<s;a++){let c=r[e+a];for(let d=0;d<8;d++)if(c&1<<7-d){let u=oa(o<<8|a<<3|d);i.push(u)}}e+=s}return Kt.decode.bytes=e-n,i},encodingLength(r){let e=[];for(let n=0;n<r.length;n++){let i=Lo(r[n]);e[i>>8]=Math.max(e[i>>8]||0,i&255)}let t=0;for(let n=0;n<e.length;n++)e[n]!==void 0&&(t+=2+Math.ceil((e[n]+1)/8));return t}}),ua=ve({encode(r,e,t){e||(e=new Uint8Array(ua.encodingLength(r))),t||(t=0);let n=t;return t+=2,q.encode(r.nextDomain,e,t),t+=q.encode.bytes,Kt.encode(r.rrtypes,e,t),t+=Kt.encode.bytes,ua.encode.bytes=t-n,j(e,ua.encode.bytes-2,n),e},decode(r,e){e||(e=0);let t=e,n={},i=se(r,e);return e+=2,n.nextDomain=q.decode(r,e),e+=q.decode.bytes,n.rrtypes=Kt.decode(r,e,i-(e-t)),e+=Kt.decode.bytes,ua.decode.bytes=e-t,n},encodingLength(r){return 2+q.encodingLength(r.nextDomain)+Kt.encodingLength(r.rrtypes)}}),da=ve({encode(r,e,t){e||(e=new Uint8Array(da.encodingLength(r))),t||(t=0);let n=t,i=r.salt;if(!Vn(i))throw new Error("salt must be a Buffer");let o=r.nextDomain;if(!Vn(o))throw new Error("nextDomain must be a Buffer");return t+=2,e[t]=r.algorithm,t+=1,e[t]=r.flags,t+=1,j(e,r.iterations,t),t+=2,e[t]=i.length,t+=1,It(i,e,t,0,i.length),t+=i.length,e[t]=o.length,t+=1,It(o,e,t,0,o.length),t+=o.length,Kt.encode(r.rrtypes,e,t),t+=Kt.encode.bytes,da.encode.bytes=t-n,j(e,da.encode.bytes-2,n),e},decode(r,e){e||(e=0);let t=e,n={},i=se(r,e);e+=2,n.algorithm=r[e],e+=1,n.flags=r[e],e+=1,n.iterations=se(r,e),e+=2;let o=r[e];e+=1,n.salt=r.slice(e,e+o),e+=o;let s=r[e];return e+=1,n.nextDomain=r.slice(e,e+s),e+=s,n.rrtypes=Kt.decode(r,e,i-(e-t)),e+=Kt.decode.bytes,da.decode.bytes=e-t,n},encodingLength(r){return 8+r.salt.length+r.nextDomain.length+Kt.encodingLength(r.rrtypes)}}),la=ve({encode(r,e,t){e||(e=new Uint8Array(la.encodingLength(r))),t||(t=0);let n=t,i=r.digest;if(!Vn(i))throw new Error("Digest must be a Buffer");return t+=2,j(e,r.keyTag,t),t+=2,e[t]=r.algorithm,t+=1,e[t]=r.digestType,t+=1,It(i,e,t,0,i.length),t+=i.length,la.encode.bytes=t-n,j(e,la.encode.bytes-2,n),e},decode(r,e){e||(e=0);let t=e,n={},i=se(r,e);return e+=2,n.keyTag=se(r,e),e+=2,n.algorithm=r[e],e+=1,n.digestType=r[e],e+=1,n.digest=r.slice(e,t+i+2),e+=n.digest.length,la.decode.bytes=e-t,n},encodingLength(r){return 6+mn(r.digest)}}),qo=ve({encode(r,e,t){e||(e=new Uint8Array(qo.encodingLength(r))),t||(t=0);let n=t;t+=2,e[t]=r.algorithm,t+=1,e[t]=r.hash,t+=1;let i=xh(r.fingerprint),o=Sh(r.hash);if(i!==o)throw new Error(`Invalid length of fingerprint "${r.fingerprint}" for hashType=${r.hash}: ${i} != ${o}`);return ib(e,r.fingerprint,t,t+=i),qo.encode.bytes=t-n,j(e,qo.encode.bytes-2,n),e},decode(r,e){e||(e=0);let t=e,n={};e+=2,n.algorithm=r[e],e+=1,n.hash=r[e],e+=1;let i=Sh(n.hash);return n.fingerprint=nb(r,e,e+i),e+=i,qo.decode.bytes=e-t,n},encodingLength(r){return 4+xh(r.fingerprint)}});function Sh(r){if(r===1)return 20;if(r===2)return 32;throw new Error(`Invalid hashType=${r}, supported=1,2`)}qo.getFingerprintLengthForHashType=Sh;function Eh(r){switch(r.toUpperCase()){case"A":return cb;case"PTR":return Vo;case"CNAME":return Vo;case"DNAME":return Vo;case"TXT":return vu;case"NULL":return Su;case"AAAA":return Iu;case"SRV":return _u;case"HINFO":return Au;case"CAA":return Hn;case"NS":return xu;case"SOA":return Eu;case"MX":return Tu;case"OPT":return jn;case"DNSKEY":return Mr;case"RRSIG":return aa;case"RP":return ca;case"NSEC":return ua;case"NSEC3":return da;case"SSHFP":return qo;case"DS":return la}return bu}var Qt=ve({encode(r,e,t){e||(e=new Uint8Array(Qt.encodingLength(r))),t||(t=0);let n=t;if(q.encode(r.name,e,t),t+=q.encode.bytes,j(e,Lo(r.type),t),r.type.toUpperCase()==="OPT"){if(r.name!==".")throw new Error("OPT name must be root.");j(e,r.udpPayloadSize||4096,t+2),e[t+4]=r.extendedRcode||0,e[t+5]=r.ednsVersion||0,j(e,r.flags||0,t+6),t+=8,jn.encode(r.options||[],e,t),t+=jn.encode.bytes}else{let i=gh(r.class===void 0?"IN":r.class);r.flush&&(i|=vh),j(e,i,t+2),Lr(e,r.ttl||0,t+4),t+=8;let o=Eh(r.type);o.encode(r.data,e,t),t+=o.encode.bytes}return Qt.encode.bytes=t-n,e},decode(r,e){e||(e=0);let t={},n=e;if(t.name=q.decode(r,e),e+=q.decode.bytes,t.type=oa(se(r,e)),t.type==="OPT")t.udpPayloadSize=se(r,e+2),t.extendedRcode=r[e+4],t.ednsVersion=r[e+5],t.flags=se(r,e+6),t.flag_do=(t.flags>>15&1)===1,t.options=jn.decode(r,e+8),e+=8+jn.decode.bytes;else{let i=se(r,e+2);t.ttl=Kr(r,e+4),t.class=mh(i&dD),t.flush=!!(i&vh);let o=Eh(t.type);t.data=o.decode(r,e+8),e+=8+o.decode.bytes}return Qt.decode.bytes=e-n,t},encodingLength(r){let e=r.data!==null&&r.data!==void 0?r.data:r.options;return q.encodingLength(r.name)+8+Eh(r.type).encodingLength(e)}}),Ho=ve({encode(r,e,t){e||(e=new Uint8Array(Ho.encodingLength(r))),t||(t=0);let n=t;return q.encode(r.name,e,t),t+=q.encode.bytes,j(e,Lo(r.type),t),t+=2,j(e,gh(r.class===void 0?"IN":r.class),t),t+=2,Ho.encode.bytes=t-n,r},decode(r,e){e||(e=0);let t=e,n={};return n.name=q.decode(r,e),e+=q.decode.bytes,n.type=oa(se(r,e)),e+=2,n.class=mh(se(r,e)),e+=2,!!(n.class&ab)&&(n.class&=lD),Ho.decode.bytes=e-t,n},encodingLength(r){return q.encodingLength(r.name)+4}});var ub=1024;var ct={encode:function(r,e,t){let n=!e;n&&(e=new Uint8Array(fD(r))),t||(t=0);let i=t;return r.questions||(r.questions=[]),r.answers||(r.answers=[]),r.authorities||(r.authorities=[]),r.additionals||(r.additionals=[]),$o.encode(r,e,t),t+=$o.encode.bytes,t=fa(r.questions,Ho,e,t),t=fa(r.answers,Qt,e,t),t=fa(r.authorities,Qt,e,t),t=fa(r.additionals,Qt,e,t),ct.encode.bytes=t-i,n&&ha.bytes!==e.length?e.slice(0,ha.bytes):e},decode:function(r,e){e||(e=0);let t=e,n=$o.decode(r,e);return e+=$o.decode.bytes,e=wu(n.questions,Ho,r,e),e=wu(n.answers,Qt,r,e),e=wu(n.authorities,Qt,r,e),e=wu(n.additionals,Qt,r,e),ct.decode.bytes=e-t,n},encodingLength:function(r){return $o.encodingLength(r)+Fo(r.questions||[],Ho)+Fo(r.answers||[],Qt)+Fo(r.authorities||[],Qt)+Fo(r.additionals||[],Qt)}};ct.encode.bytes=0;ct.decode.bytes=0;function Du(r,e){if(r.questions)throw new Error("Only one .question object expected instead of a .questions array!");let t=Object.assign({type:e},r);return t.question&&(t.questions=[t.question],delete t.question),t}var Bu={encode:function(r,e,t){return e=ct.encode(Du(r,"query"),e,t),Bu.encode.bytes=ct.encode.bytes,e},decode:function(r,e){let t=ct.decode(r,e);return Bu.decode.bytes=ct.decode.bytes,t.questions&&(t.question=t.questions[0],delete t.questions),t},encodingLength:function(r){return ct.encodingLength(Du(r,"query"))}};Bu.encode.bytes=0;Bu.decode.bytes=0;var Ru={encode:function(r,e,t){return e=ct.encode(Du(r,"response"),e,t),Ru.encode.bytes=ct.encode.bytes,e},decode:function(r,e){let t=ct.decode(r,e);return Ru.decode.bytes=ct.decode.bytes,t.questions&&(t.question=t.questions[0],delete t.questions),t},encodingLength:function(r){return ct.encodingLength(Du(r,"response"))}};Ru.encode.bytes=0;Ru.decode.bytes=0;var ha=ct.encode,Ou=ct.decode,fD=ct.encodingLength;function db(r){let e=ha(r),t=new Uint8Array(2+e.byteLength);return j(t,e.byteLength),It(e,t,2,0,e.length),db.bytes=t.byteLength,t}db.bytes=0;function lb(r){let e=se(r,0);if(r.byteLength<e+2)return null;let t=Ou(r.slice(2));return lb.bytes=Ou.bytes,t}lb.bytes=0;function Fo(r,e){let t=0;for(let n=0;n<r.length;n++)t+=e.encodingLength(r[n]);return t}function fa(r,e,t,n){for(let i=0;i<r.length;i++)e.encode(r[i],t,n),n+=e.encode.bytes;return n}function wu(r,e,t,n){for(let i=0;i<r.length;i++)r[i]=e.decode(t,n),n+=e.decode.bytes;return n}var nL=l(f(),1),Lt=class{static async getSigningMethod(e){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")}static async resolve(e,t){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")}};var fb="https://diddht.tbddev.org",hD=0,Wn=7200,Uu=";",gt=",",Ah=(c=>(c[c.Discoverable=0]="Discoverable",c[c.Organization=1]="Organization",c[c.Government=2]="Government",c[c.Corporation=3]="Corporation",c[c.LocalBusiness=4]="LocalBusiness",c[c.SoftwarePackage=5]="SoftwarePackage",c[c.WebApp=6]="WebApp",c[c.FinancialInstitution=7]="FinancialInstitution",c))(Ah||{}),Cu=(i=>(i[i.Ed25519=0]="Ed25519",i[i.secp256k1=1]="secp256k1",i[i.secp256r1=2]="secp256r1",i[i.X25519=3]="X25519",i))(Cu||{}),_h=(o=>(o.authentication="auth",o.assertionMethod="asm",o.capabilityDelegation="del",o.capabilityInvocation="inv",o.keyAgreement="agm",o))(_h||{}),pb={Ed25519:0,ES256K:1,ES256:2,"P-256":2,secp256k1:1,secp256r1:2,X25519:3},hb={0:"EdDSA",1:"ES256K",2:"ES256",3:"ECDH-ES+A256KW"},pa=class pa extends Lt{static async create({keyManager:e=new dt,options:t={}}={}){if(t.verificationMethods?.some(u=>!(u.algorithm in pb)))throw new Error("One or more verification method algorithms are not supported");let n=t.verificationMethods?.filter(u=>"id"in u).map(u=>u.id);if(n&&n.length!==new Set(n).size)throw new Error("One or more verification method IDs are not unique");if(t.services?.some(u=>!u.id||!u.type||!u.serviceEndpoint))throw new Error("One or more services are missing required properties");let i=await e.generateKey({algorithm:"Ed25519"}),o=await e.getPublicKey({keyUri:i}),s=await Xe.identityKeyToIdentifier({identityKey:o}),a={id:s,...t.alsoKnownAs&&{alsoKnownAs:t.alsoKnownAs},...t.controllers&&{controller:t.controllers}},c=[...t.verificationMethods??[]];c?.some(u=>u.id?.split("#").pop()==="0")||c.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(let u of c){let h=u.id&&u.id.split("#").pop()==="0"?i:await e.generateKey({algorithm:u.algorithm}),m=await e.getPublicKey({keyUri:h}),w=u.id??m.kid??await ne({jwk:m});w=`${s}#${Tt(w)}`,a.verificationMethod??=[],a.verificationMethod.push({id:w,type:"JsonWebKey",controller:u.controller??s,publicKeyJwk:m});for(let p of u.purposes??[])a[p]||(a[p]=[]),a[p].push(w)}t.services?.forEach(u=>{a.service??=[],u.id=`${s}#${u.id.split("#").pop()}`,a.service.push(u)});let d=new mt({uri:s,document:a,metadata:{published:!1,...t.types&&{types:t.types}},keyManager:e});if(t.publish??!0){let u=await pa.publish({did:d,gatewayUri:t.gatewayUri});d.metadata=u.didDocumentMetadata}return d}static async import({portableDid:e,keyManager:t=new dt}){if(Re.parse(e.uri)?.method!==pa.methodName)throw new $("methodNotSupported","Method not supported");let i=await mt.import({portableDid:e,keyManager:t});if(!i.document.verificationMethod?.some(o=>o.id?.split("#").pop()==="0"))throw new $("invalidDidDocument","DID document must contain an Identity Key");return i}static async getSigningMethod({didDocument:e,methodId:t="#0"}){let n=Re.parse(e.id);if(n&&n.method!==this.methodName)throw new $("methodNotSupported",`Method not supported: ${n.method}`);let i=e.verificationMethod?.find(o=>Tt(o.id)===(Tt(t)??Tt(e.assertionMethod?.[0])));if(!(i&&i.publicKeyJwk))throw new $("internalError","A verification method intended for signing could not be determined from the DID Document");return i}static async publish({did:e,gatewayUri:t=fb}){return await ma.put({did:e,gatewayUri:t})}static async resolve(e,t={}){let n=t?.gatewayUri??fb;try{await Xe.identifierToIdentityKey({didUri:e});let{didDocument:i,didDocumentMetadata:o}=await ma.get({didUri:e,gatewayUri:n});return{...Be,didDocument:i,didDocumentMetadata:o}}catch(i){if(!(i instanceof $))throw new Error(i);return{...Be,didResolutionMetadata:{error:i.code,...i.message&&{errorMessage:i.message}}}}}};pa.methodName="dht";var ya=pa,ma=class r{static async get({didUri:e,gatewayUri:t}){let n=Xe.identifierToIdentityKeyBytes({didUri:e}),i=await r.pkarrGet({gatewayUri:t,publicKeyBytes:n}),o=await Xe.parseBep44GetMessage({bep44Message:i}),s=await r.fromDnsPacket({didUri:e,dnsPacket:o});return s.didDocumentMetadata.versionId=i.seq.toString(),s}static async put({did:e,gatewayUri:t}){let n=await r.toDnsPacket({didDocument:e.document,didMetadata:e.metadata,authoritativeGatewayUris:[t]}),i=await Xe.createBep44PutMessage({dnsPacket:n,publicKeyBytes:Xe.identifierToIdentityKeyBytes({didUri:e.uri}),signer:await e.getSigner({methodId:"0"})}),o=await r.pkarrPut({gatewayUri:t,bep44Message:i});return{didDocument:e.document,didDocumentMetadata:{...e.metadata,published:o,versionId:i.seq.toString()},didRegistrationMetadata:{}}}static async pkarrGet({gatewayUri:e,publicKeyBytes:t}){let n=$e.uint8Array(t).toBase32Z(),i=new URL(n,e).href,o;try{if(o=await fetch(i,{method:"GET"}),!o.ok)throw new $("notFound",`Pkarr record not found for: ${n}`)}catch(c){throw c instanceof $?c:new $("internalError",`Failed to fetch Pkarr record: ${c.message}`)}let s=await o.arrayBuffer();if(!s)throw new $("notFound",`Pkarr record not found for: ${n}`);if(s.byteLength<72)throw new $("invalidDidDocumentLength",`Pkarr response must be at least 72 bytes but got: ${s.byteLength}`);if(s.byteLength>1072)throw new $("invalidDidDocumentLength",`Pkarr response exceeds 1000 byte limit: ${s.byteLength}`);return{k:t,seq:Number(new DataView(s).getBigUint64(64)),sig:new Uint8Array(s,0,64),v:new Uint8Array(s,72)}}static async pkarrPut({gatewayUri:e,bep44Message:t}){let n=$e.uint8Array(t.k).toBase32Z(),i=new URL(n,e).href,o=new Uint8Array(t.v.length+72);o.set(t.sig,0),new DataView(o.buffer).setBigUint64(t.sig.length,BigInt(t.seq)),o.set(t.v,t.sig.length+8);let s;try{s=await fetch(i,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:o})}catch(a){throw new $("internalError",`Failed to put Pkarr record for identifier ${n}: ${a.message}`)}return s.ok}static async fromDnsPacket({didUri:e,dnsPacket:t}){let n={id:e},i={published:!0},o=new Map;for(let s of t?.answers??[]){if(s.type!=="TXT")continue;let a=s.name.split(".")[0].substring(1);switch(!0){case a.startsWith("aka"):{let c=Xe.parseTxtDataToString(s.data);n.alsoKnownAs=c.split(gt);break}case a.startsWith("cnt"):{let c=Xe.parseTxtDataToString(s.data);n.controller=c.includes(gt)?c.split(gt):c;break}case a.startsWith("k"):{let{id:c,t:d,k:u,c:h,a:m}=Xe.parseTxtDataToObject(s.data),w=$e.base64Url(u).toUint8Array(),p=Cu[Number(d)],b=await Xe.keyConverter(p).bytesToPublicKey({publicKeyBytes:w});b.alg=m||hb[Number(d)];let v=a==="k0"?"0":c!==void 0?c:await ne({jwk:b});n.verificationMethod??=[];let S=`${e}#${v}`;n.verificationMethod.push({id:S,type:"JsonWebKey",controller:h??e,publicKeyJwk:b}),o.set(a,S);break}case a.startsWith("s"):{let{id:c,t:d,se:u,...h}=Xe.parseTxtDataToObject(s.data),m=u.includes(gt)?u.split(gt):[u],w=Object.fromEntries(Object.entries(h).map(([p,b])=>[p,b.includes(gt)?b.split(gt):b]));n.service??=[],n.service.push({...w,id:`${e}#${c}`,type:d,serviceEndpoint:m});break}case a.startsWith("typ"):{let{id:c}=Xe.parseTxtDataToObject(s.data);i.types=c.split(gt).map(d=>Number(d));break}case a.startsWith("did"):{let c=p=>p.split(gt).map(b=>o.get(b)).filter(b=>typeof b=="string"),{auth:d,asm:u,del:h,inv:m,agm:w}=Xe.parseTxtDataToObject(s.data);d&&(n.authentication=c(d)),u&&(n.assertionMethod=c(u)),h&&(n.capabilityDelegation=c(h)),m&&(n.capabilityInvocation=c(m)),w&&(n.keyAgreement=c(w));break}}}return{didDocument:n,didDocumentMetadata:i,didResolutionMetadata:{}}}static async toDnsPacket({didDocument:e,didMetadata:t,authoritativeGatewayUris:n,previousDidProof:i}){let o=[],s=[],a=new Map,c=[],d=[];if(i!==void 0){let{signature:m,previousDid:w}=i;await Xe.validatePreviousDidProof({newDid:e.id,previousDidProof:i}),o.push({type:"TXT",name:"_prv._did.",ttl:Wn,data:`id=${w};s=${m}`})}if(e.alsoKnownAs&&o.push({type:"TXT",name:"_aka._did.",ttl:Wn,data:e.alsoKnownAs.join(gt)}),e.controller){let m=Array.isArray(e.controller)?e.controller.join(gt):e.controller;o.push({type:"TXT",name:"_cnt._did.",ttl:Wn,data:m})}for(let[m,w]of e.verificationMethod?.entries()??[]){let p=`k${m}`;d.push(p);let b=w.id.split("#").pop();a.set(b,p);let v=w.publicKeyJwk;if(!(v?.crv&&v.crv in pb))throw new $("invalidPublicKeyType",`Verification method '${w.id}' contains an unsupported key type: ${v?.crv??"undefined"}`);let S=Cu[v.crv],D=await Xe.keyConverter(v.crv).publicKeyToBytes({publicKey:v}),E=$e.uint8Array(D).toBase64Url(),R=[`t=${S}`,`k=${E}`];b!=="0"&&await ne({jwk:v})!==b&&R.unshift(`id=${b}`),v.alg!==hb[S]&&R.push(`a=${v.alg}`),w.controller!==e.id&&R.push(`c=${w.controller}`),o.push({type:"TXT",name:`_${p}._did.`,ttl:Wn,data:R.join(Uu)})}e.service?.forEach((m,w)=>{let p=`s${w}`;c.push(p);let{id:b,type:v,serviceEndpoint:S,...D}=m;b=Tt(b),S=Array.isArray(S)?S.join(","):S;let R=Object.entries({id:b,t:v,se:S,...D}).map(([O,C])=>`${O}=${C}`).join(Uu),I=Xe.chunkDataIfNeeded(R);o.push({type:"TXT",name:`_${p}._did.`,ttl:Wn,data:I})});let u=[`v=${hD}`];if(d.length&&u.push(`vm=${d.join(gt)}`),Object.keys(ti).forEach(m=>{let w=e[m]?.map(p=>a.get(p.split("#").pop()));if(w){let p=_h[m];u.push(`${p}=${w.join(gt)}`)}}),c.length&&u.push(`svc=${c.join(gt)}`),t.types?.length){let w=t.types.map(p=>typeof p=="string"?Ah[p]:p);o.push({type:"TXT",name:"_typ._did.",ttl:Wn,data:`id=${w.join(gt)}`})}o.push({type:"TXT",name:"_did."+r.getUniqueDidSuffix(e.id)+".",ttl:Wn,data:u.join(Uu)});for(let m of n||[])s.push({type:"NS",name:"_did."+r.getUniqueDidSuffix(e.id)+".",ttl:Wn,data:m+"."});return{id:0,type:"response",flags:ub,answers:[...o,...s]}}static getUniqueDidSuffix(e){return e.split(":")[2]}},Xe=class r{static async createBep44PutMessage({dnsPacket:e,publicKeyBytes:t,signer:n}){let i=Math.ceil(Date.now()/1e3),o=ha(e),s=yh.encode({seq:i,v:o}).subarray(1,-1);if(s.length>1e3)throw new $("invalidDidDocumentLength",`DNS packet exceeds the 1000 byte maximum size: ${s.length} bytes`);let a=await n.sign({data:s});return{k:t,seq:i,sig:a,v:o}}static async identifierToIdentityKey({didUri:e}){let t=r.identifierToIdentityKeyBytes({didUri:e});return await Je.bytesToPublicKey({publicKeyBytes:t})}static identifierToIdentityKeyBytes({didUri:e}){let t=Re.parse(e);if(!t)throw new $("invalidDid",`Invalid DID URI: ${e}`);if(t.method!==ya.methodName)throw new $("methodNotSupported",`Method not supported: ${t.method}`);let n;try{n=$e.base32Z(t.id).toUint8Array()}catch{throw new $("invalidPublicKey","Failed to decode method-specific identifier")}if(n.length!==32)throw new $("invalidPublicKeyLength",`Invalid public key length: ${n.length}`);return n}static async identityKeyToIdentifier({identityKey:e}){let t=await Je.publicKeyToBytes({publicKey:e}),n=$e.uint8Array(t).toBase32Z();return`did:${ya.methodName}:${n}`}static keyConverter(e){let n={Ed25519:Je,"P-256":{publicKeyToBytes:async({publicKey:i})=>{let o=await at.publicKeyToBytes({publicKey:i});return await at.compressPublicKey({publicKeyBytes:o})},bytesToPublicKey:at.bytesToPublicKey,privateKeyToBytes:at.privateKeyToBytes,bytesToPrivateKey:at.bytesToPrivateKey},secp256k1:{publicKeyToBytes:async({publicKey:i})=>{let o=await tt.publicKeyToBytes({publicKey:i});return await tt.compressPublicKey({publicKeyBytes:o})},bytesToPublicKey:tt.bytesToPublicKey,privateKeyToBytes:tt.privateKeyToBytes,bytesToPrivateKey:tt.bytesToPrivateKey},X25519:Uo}[e];if(!n)throw new $("invalidPublicKeyType",`Unsupported curve: ${e}`);return n}static async parseBep44GetMessage({bep44Message:e}){let t=await Je.bytesToPublicKey({publicKeyBytes:e.k}),n=yh.encode({seq:e.seq,v:e.v}).subarray(1,-1);if(!await Je.verify({key:t,signature:e.sig,data:n}))throw new $("invalidSignature","Invalid signature for DHT BEP44 message");return Ou(e.v)}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(Uu).reduce((t,n)=>{let[i,o]=n.split("=");return t[i]=o,t},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return $e.uint8Array(e).toString();if(Array.isArray(e))return e.map(t=>this.parseTxtDataToString(t)).join("");throw new $("internalError","Pkarr returned DNS TXT record with invalid data type")}static async validatePreviousDidProof({newDid:e,previousDidProof:t}){let n=await r.identifierToIdentityKey({didUri:t.previousDid}),i=r.identifierToIdentityKeyBytes({didUri:e}),o=$e.base64Url(t.signature).toUint8Array();if(!await Je.verify({key:n,data:i,signature:o}))throw new $("invalidPreviousDidProof","The previous DID proof is invalid.")}static chunkDataIfNeeded(e){if(e.length<=255)return e;let t=[];for(let n=0;n<e.length;n+=255)t.push(e.slice(n,n+255));return t}};var CM=l(f(),1);var SM=l(f(),1);var J3=l(f(),1);var VL=l(f(),1);var wL=l(f(),1),Te={DeltaExceedsMaximumSize:"DeltaExceedsMaximumSize",DidDocumentPublicKeyIdDuplicated:"DidDocumentPublicKeyIdDuplicated",DidDocumentPublicKeyMissingOrIncorrectType:"DidDocumentPublicKeyMissingOrIncorrectType",DidDocumentServiceIdDuplicated:"DidDocumentServiceIdDuplicated",DidSuffixIncorrectLength:"DidSuffixIncorrectLength",EncodedStringIncorrectEncoding:"EncodedStringIncorrectEncoding",IdNotUsingBase64UrlCharacterSet:"IdNotUsingBase64UrlCharacterSet",IdTooLong:"IdTooLong",JwkEs256kMissingOrInvalidCrv:"JwkEs256kMissingOrInvalidCrv",JwkEs256kMissingOrInvalidKty:"JwkEs256kMissingOrInvalidKty",JwkEs256kHasIncorrectLengthOfX:"JwkEs256kHasIncorrectLengthOfX",JwkEs256kHasIncorrectLengthOfY:"JwkEs256kHasIncorrectLengthOfY",JwkEs256kHasIncorrectLengthOfD:"JwkEs256kHasIncorrectLengthOfD",MultihashStringNotAMultihash:"MultihashStringNotAMultihash",MultihashUnsupportedHashAlgorithm:"MultihashUnsupportedHashAlgorithm",PublicKeyJwkEs256kHasUnexpectedProperty:"PublicKeyJwkEs256kHasUnexpectedProperty",PublicKeyPurposeDuplicated:"PublicKeyPurposeDuplicated",ServiceEndpointCannotBeAnArray:"ServiceEndpointCannotBeAnArray",ServiceEndpointStringNotValidUri:"ServiceEndpointStringNotValidUri",ServiceTypeTooLong:"ServiceTypeTooLong"};var xL=l(f(),1),xe=class extends Error{constructor(e,t){super(`${e}: ${t}`),this.code=e,Object.setPrototypeOf(this,new.target.prototype)}};var ML=l(f(),1);var UL=l(f(),1);var vL=l(f(),1);var _L=l(f(),1),SL=new Uint8Array(0);var Th=r=>{if(r instanceof Uint8Array&&r.constructor.name==="Uint8Array")return r;if(r instanceof ArrayBuffer)return new Uint8Array(r);if(ArrayBuffer.isView(r))return new Uint8Array(r.buffer,r.byteOffset,r.byteLength);throw new Error("Unknown type, must be binary type")};var TL=l(f(),1);var Ih=class{constructor(e,t,n){this.name=e,this.prefix=t,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},Dh=class{constructor(e,t,n){if(this.name=e,this.prefix=t,t.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=t.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return yb(this,e)}},Bh=class{constructor(e){this.decoders=e}or(e){return yb(this,e)}decode(e){let t=e[0],n=this.decoders[t];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},yb=(r,e)=>new Bh({...r.decoders||{[r.prefix]:r},...e.decoders||{[e.prefix]:e}}),Rh=class{constructor(e,t,n,i){this.name=e,this.prefix=t,this.baseEncode=n,this.baseDecode=i,this.encoder=new Ih(e,t,n),this.decoder=new Dh(e,t,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},pD=({name:r,prefix:e,encode:t,decode:n})=>new Rh(r,e,t,n);var yD=(r,e,t,n)=>{let i={};for(let u=0;u<e.length;++u)i[e[u]]=u;let o=r.length;for(;r[o-1]==="=";)--o;let s=new Uint8Array(o*t/8|0),a=0,c=0,d=0;for(let u=0;u<o;++u){let h=i[r[u]];if(h===void 0)throw new SyntaxError(`Non-${n} character`);c=c<<t|h,a+=t,a>=8&&(a-=8,s[d++]=255&c>>a)}if(a>=t||255&c<<8-a)throw new SyntaxError("Unexpected end of data");return s},mD=(r,e,t)=>{let n=e[e.length-1]==="=",i=(1<<t)-1,o="",s=0,a=0;for(let c=0;c<r.length;++c)for(a=a<<8|r[c],s+=8;s>t;)s-=t,o+=e[i&a>>s];if(s&&(o+=e[i&a<<t-s]),n)for(;o.length*t&7;)o+="=";return o},ga=({name:r,prefix:e,bitsPerChar:t,alphabet:n})=>pD({prefix:e,name:r,encode(i){return mD(i,n,t)},decode(i){return yD(i,n,t,r)}});var kL=ga({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),PL=ga({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),wa=ga({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),KL=ga({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var Dt=class r{static encode(e){return wa.baseEncode(e)}static decodeAsBytes(e,t){if(!r.isBase64UrlString(e))throw new xe(Te.EncodedStringIncorrectEncoding,`Given ${t} must be base64url string.`);return wa.baseDecode(e)}static decodeAsString(e,t){let n=r.decodeAsBytes(e,t);return r.bytesToString(n)}static isBase64UrlString(e){return/^[A-Za-z0-9_-]+$/.test(e)}static stringToBytes(e){return new TextEncoder().encode(e)}static bytesToString(e){return new TextDecoder().decode(e)}};var F3=l(f(),1),Tb=l(gb(),1);var ZL=l(f(),1);var WL=l(f(),1),Oh;(function(r){r.Public="public",r.Private="private"})(Oh||(Oh={}));var Mt=Oh;var Ze=class{static validateEs256kOperationKey(e,t){let n=new Set(["kty","crv","x","y"]);t===Mt.Private&&n.add("d");for(let i in e)if(!n.has(i))throw new xe(Te.PublicKeyJwkEs256kHasUnexpectedProperty,`SECP256K1 JWK key has unexpected property '${i}'.`);if(e.crv!=="secp256k1")throw new xe(Te.JwkEs256kMissingOrInvalidCrv,`SECP256K1 JWK 'crv' property must be 'secp256k1' but got '${e.crv}.'`);if(e.kty!=="EC")throw new xe(Te.JwkEs256kMissingOrInvalidKty,`SECP256K1 JWK 'kty' property must be 'EC' but got '${e.kty}.'`);if(e.x.length!==43)throw new xe(Te.JwkEs256kHasIncorrectLengthOfX,"SECP256K1 JWK 'x' property must be 43 bytes.");if(e.y.length!==43)throw new xe(Te.JwkEs256kHasIncorrectLengthOfY,"SECP256K1 JWK 'y' property must be 43 bytes.");if(t===Mt.Private&&(e.d===void 0||e.d.length!==43))throw new xe(Te.JwkEs256kHasIncorrectLengthOfD,"SECP256K1 JWK 'd' property must be 43 bytes.")}static validateId(e){if(e.length>50)throw new xe(Te.IdTooLong,`Key ID length ${e.length} exceed max allowed length of 50.`);if(!Dt.isBase64UrlString(e))throw new xe(Te.IdNotUsingBase64UrlCharacterSet,`Key ID '${e}' is not a Base64URL string.`)}static validatePublicKeyPurposes(e){if(e===void 0)return;let t=new Set;for(let n of e){if(t.has(n))throw new xe(Te.PublicKeyPurposeDuplicated,`Public key purpose '${n}' already specified.`);t.add(n)}}};var e3=l(f(),1),ba=class{};ba.hashAlgorithmInMultihashCode=18;ba.maxCanonicalizedDeltaSizeInBytes=1e3;var wt=ba;var o3=l(f(),1),xb=l(bb(),1);var fr=class r{static canonicalizeAsBytes(e){let t=r.removeAllUndefinedProperties(e),n=xb.default(t);return Dt.stringToBytes(n)}static removeAllUndefinedProperties(e){for(let t in e)typeof e[t]=="object"?r.removeAllUndefinedProperties(e[t]):e[t]===void 0&&delete e[t];return e}};var I3=l(f(),1);var f3=l(f(),1);var u3=l(f(),1);var a3=l(f(),1),gD=Sb,Eb=128,wD=127,bD=~wD,xD=Math.pow(2,31);function Sb(r,e,t){e=e||[],t=t||0;for(var n=t;r>=xD;)e[t++]=r&255|Eb,r/=128;for(;r&bD;)e[t++]=r&255|Eb,r>>>=7;return e[t]=r|0,Sb.bytes=t-n+1,e}var ED=Uh,vD=128,vb=127;function Uh(r,n){var t=0,n=n||0,i=0,o=n,s,a=r.length;do{if(o>=a)throw Uh.bytes=0,new RangeError("Could not decode varint");s=r[o++],t+=i<28?(s&vb)<<i:(s&vb)*Math.pow(2,i),i+=7}while(s>=vD);return Uh.bytes=o-n,t}var SD=Math.pow(2,7),AD=Math.pow(2,14),_D=Math.pow(2,21),TD=Math.pow(2,28),ID=Math.pow(2,35),DD=Math.pow(2,42),BD=Math.pow(2,49),RD=Math.pow(2,56),OD=Math.pow(2,63),UD=function(r){return r<SD?1:r<AD?2:r<_D?3:r<TD?4:r<ID?5:r<DD?6:r<BD?7:r<RD?8:r<OD?9:10},CD={encode:gD,decode:ED,encodingLength:UD},kD=CD,xa=kD;var Ch=(r,e=0)=>[xa.decode(r,e),xa.decode.bytes],kh=(r,e,t=0)=>(xa.encode(r,e,t),e),Ph=r=>xa.encodingLength(r);var Kh=(r,e)=>{let t=e.byteLength,n=Ph(r),i=n+Ph(t),o=new Uint8Array(i+t);return kh(r,o,0),kh(t,o,n),o.set(e,i),new Pu(r,t,e,o)},Ab=r=>{let e=Th(r),[t,n]=Ch(e),[i,o]=Ch(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new Pu(t,i,s,e)};var Pu=class{constructor(e,t,n,i){this.code=e,this.size=t,this.digest=n,this.bytes=i}};var w3=l(f(),1);var p3=l(f(),1);var Mh=({name:r,code:e,encode:t})=>new Lh(r,e,t),Lh=class{constructor(e,t,n){this.name=e,this.code=t,this.encode=n}digest(e){if(e instanceof Uint8Array){let t=this.encode(e);return t instanceof Uint8Array?Kh(this.code,t):t.then(n=>Kh(this.code,n))}else throw Error("Unknown type, must be binary type")}};var _b=r=>async e=>new Uint8Array(await crypto.subtle.digest(r,e)),Ku=Mh({name:"sha2-256",code:18,encode:_b("SHA-256")}),m3=Mh({name:"sha2-512",code:19,encode:_b("SHA-512")});var Ea=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},rt=class r{static hash(e,t){return Ea(this,void 0,void 0,function*(){let n;switch(t){case 18:n=(yield Ku.digest(e)).bytes;break;default:throw new xe(Te.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${t} is not supported.`)}return n})}static hashAsNonMultihashBytes(e,t){return Ea(this,void 0,void 0,function*(){let n;switch(t){case 18:n=yield Ku.encode(e);break;default:throw new xe(Te.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${t} is not supported.`)}return n})}static canonicalizeThenHashThenEncode(e,t){return Ea(this,void 0,void 0,function*(){let n=fr.canonicalizeAsBytes(e);return yield r.hashThenEncode(n,t)})}static canonicalizeThenDoubleHashThenEncode(e,t){return Ea(this,void 0,void 0,function*(){let n=fr.canonicalizeAsBytes(e),i=yield r.hashAsNonMultihashBytes(n,t);return yield r.hashThenEncode(i,t)})}static hashThenEncode(e,t){return Ea(this,void 0,void 0,function*(){let n=yield r.hash(e,t);return Dt.encode(n)})}static validateEncodedHashComputedUsingSupportedHashAlgorithm(e,t){let n,i=Dt.decodeAsBytes(e,t);try{n=Ab(i)}catch{throw new xe(Te.MultihashStringNotAMultihash,`Given ${t} string '${e}' is not a multihash after decoding.`)}let o=wt.hashAlgorithmInMultihashCode;if(o!==n.code)throw new xe(Te.MultihashUnsupportedHashAlgorithm,`Given ${t} uses unsupported multihash algorithm with code ${n.code}, should use ${o} or change IonSdkConfig to desired hashing algorithm.`)}};var B3=l(f(),1),Nh;(function(r){r.Create="create",r.Update="update",r.Deactivate="deactivate",r.Recover="recover"})(Nh||(Nh={}));var va=Nh;var O3=l(f(),1),$h;(function(r){r.Replace="replace",r.AddPublicKeys="add-public-keys",r.RemovePublicKeys="remove-public-keys",r.AddServices="add-services",r.RemoveServices="remove-services"})($h||($h={}));var Ni=$h;var Lu=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},zn=class r{static createCreateRequest(e){return Lu(this,void 0,void 0,function*(){let t=e.recoveryKey,n=e.updateKey,i=e.document.publicKeys,o=e.document.services;Ze.validateEs256kOperationKey(t,Mt.Public),Ze.validateEs256kOperationKey(n,Mt.Public),r.validateDidDocumentKeys(i),r.validateServices(o);let s=wt.hashAlgorithmInMultihashCode,a=[{action:Ni.Replace,document:e.document}],c={updateCommitment:yield rt.canonicalizeThenDoubleHashThenEncode(n,s),patches:a};r.validateDeltaSize(c);let u={deltaHash:yield rt.canonicalizeThenHashThenEncode(c,s),recoveryCommitment:yield rt.canonicalizeThenDoubleHashThenEncode(t,s)};return{type:va.Create,suffixData:u,delta:c}})}static createDeactivateRequest(e){return Lu(this,void 0,void 0,function*(){r.validateDidSuffix(e.didSuffix),Ze.validateEs256kOperationKey(e.recoveryPublicKey,Mt.Public);let t=wt.hashAlgorithmInMultihashCode,n=yield rt.canonicalizeThenHashThenEncode(e.recoveryPublicKey,t),i={didSuffix:e.didSuffix,recoveryKey:e.recoveryPublicKey},o=yield e.signer.sign({alg:"ES256K"},i);return{type:va.Deactivate,didSuffix:e.didSuffix,revealValue:n,signedData:o}})}static createRecoverRequest(e){return Lu(this,void 0,void 0,function*(){r.validateDidSuffix(e.didSuffix),Ze.validateEs256kOperationKey(e.recoveryPublicKey,Mt.Public),Ze.validateEs256kOperationKey(e.nextRecoveryPublicKey,Mt.Public),Ze.validateEs256kOperationKey(e.nextUpdatePublicKey,Mt.Public),r.validateDidDocumentKeys(e.document.publicKeys),r.validateServices(e.document.services);let t=wt.hashAlgorithmInMultihashCode,n=yield rt.canonicalizeThenHashThenEncode(e.recoveryPublicKey,t),i=[{action:Ni.Replace,document:e.document}],o=yield rt.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,t),s={patches:i,updateCommitment:o},a=yield rt.canonicalizeThenHashThenEncode(s,t),d={recoveryCommitment:yield rt.canonicalizeThenDoubleHashThenEncode(e.nextRecoveryPublicKey,t),recoveryKey:e.recoveryPublicKey,deltaHash:a},u=yield e.signer.sign({alg:"ES256K"},d);return{type:va.Recover,didSuffix:e.didSuffix,revealValue:n,delta:s,signedData:u}})}static createUpdateRequest(e){return Lu(this,void 0,void 0,function*(){if(r.validateDidSuffix(e.didSuffix),Ze.validateEs256kOperationKey(e.updatePublicKey,Mt.Public),Ze.validateEs256kOperationKey(e.nextUpdatePublicKey,Mt.Public),r.validateServices(e.servicesToAdd),r.validateDidDocumentKeys(e.publicKeysToAdd),e.idsOfServicesToRemove!==void 0)for(let p of e.idsOfServicesToRemove)Ze.validateId(p);if(e.idsOfPublicKeysToRemove!==void 0)for(let p of e.idsOfPublicKeysToRemove)Ze.validateId(p);let t=[],n=e.servicesToAdd;if(n!==void 0&&n.length>0){let p={action:Ni.AddServices,services:n};t.push(p)}let i=e.idsOfServicesToRemove;if(i!==void 0&&i.length>0){let p={action:Ni.RemoveServices,ids:i};t.push(p)}let o=e.publicKeysToAdd;if(o!==void 0&&o.length>0){let p={action:Ni.AddPublicKeys,publicKeys:o};t.push(p)}let s=e.idsOfPublicKeysToRemove;if(s!==void 0&&s.length>0){let p={action:Ni.RemovePublicKeys,ids:s};t.push(p)}let a=wt.hashAlgorithmInMultihashCode,c=yield rt.canonicalizeThenHashThenEncode(e.updatePublicKey,a),d=yield rt.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,a),u={patches:t,updateCommitment:d},h=yield rt.canonicalizeThenHashThenEncode(u,a),m={updateKey:e.updatePublicKey,deltaHash:h},w=yield e.signer.sign({alg:"ES256K"},m);return{type:va.Update,didSuffix:e.didSuffix,revealValue:c,delta:u,signedData:w}})}static validateDidSuffix(e){rt.validateEncodedHashComputedUsingSupportedHashAlgorithm(e,"didSuffix")}static validateDidDocumentKeys(e){if(e===void 0)return;let t=new Set;for(let n of e){if(Array.isArray(n.publicKeyJwk))throw new xe(Te.DidDocumentPublicKeyMissingOrIncorrectType,"DID Document key 'publicKeyJwk' property is not a non-array object.");if(Ze.validateId(n.id),t.has(n.id))throw new xe(Te.DidDocumentPublicKeyIdDuplicated,`DID Document key with ID '${n.id}' already exists.`);t.add(n.id),Ze.validatePublicKeyPurposes(n.purposes)}}static validateServices(e){if(e!==void 0&&e.length!==0){let t=new Set;for(let n of e){if(r.validateService(n),t.has(n.id))throw new xe(Te.DidDocumentServiceIdDuplicated,"Service id has to be unique");t.add(n.id)}}}static validateService(e){Ze.validateId(e.id);let t=30;if(e.type.length>t){let n=`Service endpoint type length ${e.type.length} exceeds max allowed length of ${t}.`;throw new xe(Te.ServiceTypeTooLong,n)}if(Array.isArray(e.serviceEndpoint)){let n="Service endpoint value cannot be an array.";throw new xe(Te.ServiceEndpointCannotBeAnArray,n)}if(typeof e.serviceEndpoint=="string"&&Tb.parse(e.serviceEndpoint).error!==void 0)throw new xe(Te.ServiceEndpointStringNotValidUri,`Service endpoint string '${e.serviceEndpoint}' is not a URI.`)}static validateDeltaSize(e){let t=fr.canonicalizeAsBytes(e);if(t.length>wt.maxCanonicalizedDeltaSizeInBytes){let n=`Delta of ${t.length} bytes exceeded limit of ${wt.maxCanonicalizedDeltaSizeInBytes} bytes.`;throw new xe(Te.DeltaExceedsMaximumSize,n)}}};var Ib=function(r,e,t,n){function i(o){return o instanceof t?o:new t(function(s){s(o)})}return new(t||(t=Promise))(function(o,s){function a(u){try{d(n.next(u))}catch(h){s(h)}}function c(u){try{d(n.throw(u))}catch(h){s(h)}}function d(u){u.done?o(u.value):i(u.value).then(a,c)}d((n=n.apply(r,e||[])).next())})},jo=class r{static createLongFormDid(e){return Ib(this,void 0,void 0,function*(){let t=yield zn.createCreateRequest(e),n=yield r.computeDidUniqueSuffix(t.suffixData),i;wt.network===void 0||wt.network==="mainnet"?i=`did:ion:${n}`:i=`did:ion:${wt.network}:${n}`;let o={suffixData:t.suffixData,delta:t.delta},s=fr.canonicalizeAsBytes(o),a=Dt.encode(s);return`${i}:${a}`})}static computeDidUniqueSuffix(e){return Ib(this,void 0,void 0,function*(){let t=fr.canonicalizeAsBytes(e),n=yield rt.hash(t,wt.hashAlgorithmInMultihashCode);return Dt.encode(n)})}};var Q3=l(f(),1);var tM=l(f(),1),Db;(function(r){r.Mainnet="mainnet",r.Testnet="test"})(Db||(Db={}));var nM=l(f(),1),Bb;(function(r){r.Authentication="authentication",r.AssertionMethod="assertionMethod",r.CapabilityInvocation="capabilityInvocation",r.CapabilityDelegation="capabilityDelegation",r.KeyAgreement="keyAgreement"})(Bb||(Bb={}));var dM=l(f(),1);var Ob=(i=>(i.Ed25519="Ed25519",i.secp256k1="secp256k1",i.secp256r1="secp256r1",i.X25519="X25519",i))(Ob||{}),LD={Ed25519:"Ed25519",ES256K:"secp256k1",ES256:"secp256r1","P-256":"secp256r1",secp256k1:"secp256k1",secp256r1:"secp256r1"},Rb="https://ion.tbd.engineering",$i=class $i extends Lt{static async create({keyManager:e=new dt,options:t={}}={}){if(t.verificationMethods?.some(p=>!(p.algorithm in LD)))throw new Error("One or more verification method algorithms are not supported");let n=t.verificationMethods?.filter(p=>"id"in p).map(p=>p.id);if(n&&n.length!==new Set(n).size)throw new Error("One or more verification method IDs are not unique");if(t.services?.some(p=>!p.id||!p.type||!p.serviceEndpoint))throw new Error("One or more services are missing required properties");let i={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},o=[];for(let p of t.verificationMethods??[i]){let b=await e.generateKey({algorithm:p.algorithm}),v=await e.getPublicKey({keyUri:b});o.push({id:p.id,publicKeyJwk:v,purposes:p.purposes??["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}let s=await e.generateKey({algorithm:"secp256k1"}),a=await e.getPublicKey({keyUri:s}),c=await e.generateKey({algorithm:"secp256k1"}),d=await e.getPublicKey({keyUri:c}),u=await Gn.computeLongFormDidUri({recoveryKey:a,updateKey:d,services:t.services??[],verificationMethods:o}),{didDocument:h,didResolutionMetadata:m}=await $i.resolve(u,{gatewayUri:t.gatewayUri});if(h===null)throw new Error(`Unable to resolve DID during creation: ${m?.error}`);let w=new mt({uri:u,document:h,metadata:{published:!1,canonicalId:u.split(":",3).join(":"),recoveryKey:a,updateKey:d},keyManager:e});if(t.publish??!0){let p=await $i.publish({did:w,gatewayUri:t.gatewayUri});w.metadata=p.didDocumentMetadata}return w}static async getSigningMethod({didDocument:e,methodId:t}){let n=Re.parse(e.id);if(n&&n.method!==this.methodName)throw new $("methodNotSupported",`Method not supported: ${n.method}`);let i=e.verificationMethod?.find(o=>o.id===(t??e.assertionMethod?.[0]));if(!(i&&i.publicKeyJwk))throw new $("internalError","A verification method intended for signing could not be determined from the DID Document");return i}static async import({portableDid:e,keyManager:t=new dt}){if(Re.parse(e.uri)?.method!==$i.methodName)throw new $("methodNotSupported","Method not supported");return await mt.import({portableDid:e,keyManager:t})}static async publish({did:e,gatewayUri:t=Rb}){let n=e.document.verificationMethod?.map(s=>({id:s.id,publicKeyJwk:s.publicKeyJwk,purposes:ch({didDocument:e.document,methodId:s.id})}))??[],i=await Gn.createIonDocument({services:e.document.service??[],verificationMethods:n}),o=await Gn.constructCreateRequest({ionDocument:i,recoveryKey:e.metadata.recoveryKey,updateKey:e.metadata.updateKey});try{let s=Gn.appendPathToUrl({baseUrl:t,path:"/operations"}),a=await fetch(s,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(o)});return{didDocument:e.document,didDocumentMetadata:{...e.metadata,published:a.ok},didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:"internalError",errorMessage:`Failed to publish DID document for: ${e.uri}`}}}}static async resolve(e,t={}){let n=Re.parse(e);if(!n)return{...Be,didResolutionMetadata:{error:"invalidDid"}};if(n.method!==$i.methodName)return{...Be,didResolutionMetadata:{error:"methodNotSupported"}};let i=t?.gatewayUri??Rb;try{let o=Gn.appendPathToUrl({baseUrl:i,path:`/identifiers/${e}`}),s=await fetch(o);if(!s.ok)throw new $("notFound",`Unable to find DID document for: ${e}`);let{didDocument:a,didDocumentMetadata:c}=await s.json();return{...Be,...a&&{didDocument:a},didDocumentMetadata:{published:c?.method?.published,...c}}}catch(o){if(!(o instanceof $))throw new Error(o);return{...Be,didResolutionMetadata:{error:o.code,...o.message&&{errorMessage:o.message}}}}}};$i.methodName="ion";var qh=$i,Gn=class r{static appendPathToUrl({baseUrl:e,path:t}){let n=new URL(e);return n.pathname=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",n.pathname+=t.startsWith("/")?t.substring(1):t,n.toString()}static async computeLongFormDidUri({recoveryKey:e,updateKey:t,services:n,verificationMethods:i}){let o=await r.createIonDocument({services:n,verificationMethods:i}),s=r.normalizeJwk(e),a=r.normalizeJwk(t);return await jo.createLongFormDid({document:o,recoveryKey:s,updateKey:a})}static async constructCreateRequest({ionDocument:e,recoveryKey:t,updateKey:n}){return await zn.createCreateRequest({document:e,recoveryKey:r.normalizeJwk(t),updateKey:r.normalizeJwk(n)})}static async createIonDocument({services:e,verificationMethods:t}){let n=[];for(let s of t){let a=s.id??s.publicKeyJwk.kid??await ne({jwk:s.publicKeyJwk});a=`${a.split("#").pop()}`;let c={id:a,publicKeyJwk:r.normalizeJwk(s.publicKeyJwk),purposes:s.purposes,type:"JsonWebKey2020"};n.push(c)}let i=e.map(s=>({...s,id:`${s.id.split("#").pop()}`}));return{publicKeys:n,services:i}}static normalizeJwk(e){let t=e.kty,n;if(t==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(t==="oct")n={k:e.k,kty:e.kty};else if(t==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(t==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${t}`);return n}};var FM=l(f(),1);var qi=class qi extends Lt{static async create({keyManager:e=new dt,options:t={}}={}){if(t.algorithm&&t.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(t.verificationMethods&&t.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");let n=t.algorithm??t.verificationMethods?.[0]?.algorithm??"Ed25519",i=await e.generateKey({algorithm:n}),o=await e.getPublicKey({keyUri:i}),s=$e.object(o).toBase64Url(),a=`did:${qi.methodName}:${s}`,d=(await qi.resolve(a)).didDocument;return new mt({uri:a,document:d,metadata:{},keyManager:e})}static async getSigningMethod({didDocument:e}){let t=Re.parse(e.id);if(t&&t.method!==this.methodName)throw new $("methodNotSupported",`Method not supported: ${t.method}`);let[n]=e.verificationMethod??[];if(!(n&&n.publicKeyJwk))throw new $("internalError","A verification method intended for signing could not be determined from the DID Document");return n}static async import({portableDid:e,keyManager:t=new dt}){if(Re.parse(e.uri)?.method!==qi.methodName)throw new $("methodNotSupported","Method not supported");let i=await mt.import({portableDid:e,keyManager:t});if(i.document.verificationMethod.length!==1)throw new $("invalidDidDocument","DID document must contain exactly one verification method");return i}static async resolve(e,t){let n=Re.parse(e),i;try{i=$e.base64Url(n.id).toObject()}catch{}if(!n||!i)return{...Be,didResolutionMetadata:{error:"invalidDid"}};if(n.method!==qi.methodName)return{...Be,didResolutionMetadata:{error:"methodNotSupported"}};let o={"@context":["https://www.w3.org/ns/did/v1"],id:n.uri},s=`${o.id}#0`;switch(o.verificationMethod=[{id:s,type:"JsonWebKey",controller:o.id,publicKeyJwk:i}],o.authentication=[s],o.assertionMethod=[s],o.capabilityInvocation=[s],o.capabilityDelegation=[s],o.keyAgreement=[s],i.use){case"sig":{delete o.keyAgreement;break}case"enc":{delete o.authentication,delete o.assertionMethod,delete o.capabilityInvocation,delete o.capabilityDelegation;break}}return{...Be,didDocument:o}}};qi.methodName="jwk";var Fh=qi;var ZM=l(f(),1);var Ub=(i=>(i.Ed25519="Ed25519",i.secp256k1="secp256k1",i.secp256r1="secp256r1",i.X25519="X25519",i))(Ub||{}),Mu={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},MD={Ed25519:"Ed25519",ES256K:"secp256k1",ES256:"secp256r1","P-256":"secp256r1",secp256k1:"secp256k1",secp256r1:"secp256r1",X25519:"X25519"},hr=class hr extends Lt{static async create({keyManager:e=new dt,options:t={}}={}){if(t.algorithm&&t.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(t.verificationMethods&&t.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");let n=t.algorithm??t.verificationMethods?.[0]?.algorithm??"Ed25519",i=await e.generateKey({algorithm:n}),o=await e.getPublicKey({keyUri:i}),s=await er.publicKeyToMultibaseId({publicKey:o}),a=`did:${hr.methodName}:${s}`,d=(await hr.resolve(a,t)).didDocument;return new mt({uri:a,document:d,metadata:{},keyManager:e})}static async getSigningMethod({didDocument:e}){let t=Re.parse(e.id);if(t&&t.method!==this.methodName)throw new $("methodNotSupported",`Method not supported: ${t.method}`);let[n]=e.assertionMethod||[],i=e.verificationMethod?.find(o=>o.id===n);if(!(i&&i.publicKeyJwk))throw new $("internalError","A verification method intended for signing could not be determined from the DID Document");return i}static async import({portableDid:e,keyManager:t=new dt}){if(Re.parse(e.uri)?.method!==hr.methodName)throw new $("methodNotSupported","Method not supported");let i=await mt.import({portableDid:e,keyManager:t});if(i.document.verificationMethod.length!==1)throw new $("invalidDidDocument","DID document must contain exactly one verification method");return i}static async resolve(e,t){try{let n=await hr.createDocument({didUri:e,options:t});return{...Be,didDocument:n}}catch(n){if(!(n instanceof $))throw new Error(n);return{...Be,didResolutionMetadata:{error:n.code,...n.message&&{errorMessage:n.message}}}}}static async createDocument({didUri:e,options:t={}}){let{defaultContext:n="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:i=!1,enableExperimentalPublicKeyTypes:o=!1,publicKeyFormat:s="JsonWebKey2020"}=t,a={id:""},c=Re.parse(e);if(!c)throw new $("invalidDid",`Invalid DID URI: ${e}`);let d=c.id;if(c.method!==hr.methodName)throw new $("methodNotSupported",`Method not supported: ${c.method}`);if(!hr.validateIdentifier(c))throw new $("invalidDid",`Invalid DID URI: ${e}`);let u=await hr.createSignatureMethod({didUri:e,multibaseValue:d,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}});if(a.id=c.uri,a.verificationMethod=[u],a.authentication=[u.id],a.assertionMethod=[u.id],a.capabilityInvocation=[u.id],a.capabilityDelegation=[u.id],i===!0){let w=s==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",p=await this.createEncryptionMethod({didUri:e,multibaseValue:d,options:{enableExperimentalPublicKeyTypes:o,publicKeyFormat:w}});a.verificationMethod.push(p),a.keyAgreement=[p.id]}let h=[n];return ah({didDocument:a}).forEach(w=>{let p=Mu[w];h.push(p)}),a["@context"]=h,a}static async createEncryptionMethod({didUri:e,multibaseValue:t,options:n}){let{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=n,s={id:"",type:"",controller:""},{keyBytes:a,multicodecCode:c}=await hr.deriveEncryptionKey({multibaseValue:t}),d=a.byteLength,u=er.MULTICODEC_PUBLIC_KEY_LENGTH[c];if(d!==u)throw new $("invalidPublicKeyLength",`Expected ${d} bytes. Actual: ${u}`);let h=lu({keyBytes:a,multicodecCode:c});s.id=`${e}#${h}`;try{new URL(s.id)}catch{throw new $("invalidDidUrl","Verification Method ID is not a valid DID URL.")}if(!(o in Mu))throw new $("unsupportedPublicKeyType",`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(o))throw new $("invalidPublicKeyType",`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(s.type=o,s.controller=e,o==="X25519KeyAgreementKey2020"&&(s.publicKeyMultibase=h),o==="JsonWebKey2020"){let{crv:w}=await er.multicodecToJwk({code:c});s.publicKeyJwk=await er.keyConverter(w).bytesToPublicKey({publicKeyBytes:a})}return s}static async createSignatureMethod({didUri:e,multibaseValue:t,options:n}){let{enableExperimentalPublicKeyTypes:i,publicKeyFormat:o}=n,s={id:"",type:"",controller:""},{keyBytes:a,multicodecCode:c,multicodecName:d}=fu({multibaseKeyId:t}),u=a.byteLength,h=er.MULTICODEC_PUBLIC_KEY_LENGTH[c];if(u!==h)throw new $("invalidPublicKeyLength",`Expected ${u} bytes. Actual: ${h}`);let m=!1;switch(d){case"secp256k1-pub":m=await tt.validatePublicKey({publicKeyBytes:a});break;case"ed25519-pub":m=await Je.validatePublicKey({publicKeyBytes:a});break;case"x25519-pub":m=!0;break}if(!m)throw new $("invalidPublicKey","Invalid public key detected.");s.id=`${e}#${t}`;try{new URL(s.id)}catch{throw new $("invalidDidUrl","Verification Method ID is not a valid DID URL.")}if(!(o in Mu))throw new $("unsupportedPublicKeyType",`Unsupported format: ${o}`);if(i===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(o))throw new $("invalidPublicKeyType",`Specified '${o}' without setting enableExperimentalPublicKeyTypes to true.`);if(s.type=o,s.controller=e,o==="Ed25519VerificationKey2020"&&(s.publicKeyMultibase=t),o==="JsonWebKey2020"){let{crv:p}=await er.multicodecToJwk({code:c});s.publicKeyJwk=await er.keyConverter(p).bytesToPublicKey({publicKeyBytes:a})}return s}static async deriveEncryptionKey({multibaseValue:e}){let t={keyBytes:new Uint8Array,multicodecCode:0},{keyBytes:n,multicodecCode:i}=fu({multibaseKeyId:e});if(i===237){let o=await er.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:n}),s=await Je.convertPublicKeyToX25519({publicKey:o});t={keyBytes:await er.keyConverter("Ed25519").publicKeyToBytes({publicKey:s}),multicodecCode:236}}return t}static validateIdentifier(e){let{method:t,id:n}=e,[i]=e.uri.split(":",1);return i==="did"&&t==="key"&&Number("1")>0&&Qs(n)==="String"&&n.startsWith("z")}};hr.methodName="key";var Vh=hr,Nr=class Nr{static async jwkToMulticodec({jwk:e}){let t=[];e.crv&&(t.push(e.crv),e.d?t.push("private"):t.push("public"));let n=t.join(":"),i=Nr.JWK_TO_MULTICODEC[n];if(i===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${n}'`);return{code:lt.getCodeFromName({name:i}),name:i}}static keyCompressor(e){let n={"P-256":at.compressPublicKey,secp256k1:tt.compressPublicKey}[e];if(!n)throw new $("invalidPublicKeyType",`Unsupported curve: ${e}`);return n}static keyConverter(e){let n={Ed25519:Je,"P-256":at,secp256k1:tt,X25519:Uo}[e];if(!n)throw new $("invalidPublicKeyType",`Unsupported curve: ${e}`);return n}static async multicodecToJwk({code:e,name:t}){if(!(t?!e:e))throw new Error("Either 'name' or 'code' must be defined, but not both.");t=t===void 0?lt.getNameFromCode({code:e}):t;let n=t,i=Nr.MULTICODEC_TO_JWK[n];if(i===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return{...i}}static async publicKeyToMultibaseId({publicKey:e}){if(!(e?.crv&&e.crv in MD))throw new $("invalidPublicKeyType",`Public key contains an unsupported key type: ${e?.crv??"undefined"}`);let t=await Nr.keyConverter(e.crv).publicKeyToBytes({publicKey:e});/^(secp256k1|P-256|P-384|P-521)$/.test(e.crv)&&(t=await Nr.keyCompressor(e.crv)({publicKeyBytes:t}));let{name:n}=await Nr.jwkToMulticodec({jwk:e});return lu({keyBytes:t,multicodecName:n})}};Nr.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"},Nr.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32},Nr.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};var er=Nr;var n4=l(f(),1);var Nu=class Nu extends Lt{static async resolve(e,t){let n=Re.parse(e);if(!n)return{...Be,didResolutionMetadata:{error:"invalidDid"}};if(n.method!==Nu.methodName)return{...Be,didResolutionMetadata:{error:"methodNotSupported"}};let i=`https://${n.id.replace(/:/g,"/")}`;i=decodeURIComponent(i);let o=n.id.includes(":")?`${i}/did.json`:`${i}/.well-known/did.json`;try{let s=await fetch(o);if(!s.ok)throw new Error("HTTP error status code returned");let a=await s.json();return{...Be,didDocument:a}}catch{return{...Be,didResolutionMetadata:{error:"notFound"}}}}};Nu.methodName="web";var Hh=Nu;var a4=l(f(),1),Pb=l(kb(),1),Kb=l(ul(),1),jh=class{constructor({db:e,location:t="DATA/DID_RESOLVERCACHE",ttl:n="15m"}={}){this.cache=e??new Kb.Level(t),this.ttl=(0,Pb.default)(n)}async get(e){try{let t=await this.cache.get(e),n=JSON.parse(t);if(Date.now()>=n.ttlMillis){this.cache.nextTick(()=>this.cache.del(e));return}else return n.value}catch(t){if(t.notFound)return;throw t}}set(e,t){let n={ttlMillis:Date.now()+this.ttl,value:t},i=JSON.stringify(n);return this.cache.put(e,i)}delete(e){return this.cache.del(e)}clear(){return this.cache.clear()}close(){return this.cache.close()}};var u4=l(f(),1),Wh={get:function(r){return null},set:function(r,e){return null},delete:function(r){return null},clear:function(){return null},close:function(){return null}};var y4=l(f(),1);var zh=class{constructor({cache:e,didResolvers:t}){this.didResolvers=new Map;this.cache=e||Wh;for(let n of t)this.didResolvers.set(n.methodName,n)}async resolve(e,t){let n=Re.parse(e);if(!n)return{...Be,didResolutionMetadata:{error:"invalidDid",errorMessage:`Invalid DID URI: ${e}`}};let i=this.didResolvers.get(n.method);if(!i)return{...Be,didResolutionMetadata:{error:"methodNotSupported",errorMessage:`Method not supported: ${n.method}`}};let o=await this.cache.get(n.uri);if(o)return o;{let s=await i.resolve(n.uri,t);return s.didResolutionMetadata.error||await this.cache.set(n.uri,s),s}}async dereference(e,t){let n=Re.parse(e);if(!n)return{dereferencingMetadata:{error:"invalidDidUrl"},contentStream:null,contentMetadata:{}};let{didDocument:i,didResolutionMetadata:o,didDocumentMetadata:s}=await this.resolve(n.uri);if(!i)return{dereferencingMetadata:{error:o.error},contentStream:null,contentMetadata:{}};if(!n.fragment||n.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:i,contentMetadata:s};let{service:a=[],verificationMethod:c=[]}=i,d=new Set([e,n.fragment,`#${n.fragment}`]),u;for(let h of c)if(d.has(h.id)){u=h;break}for(let h of a)if(d.has(h.id)){u=h;break}return u?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:u,contentMetadata:o}:{dereferencingMetadata:{error:"notFound"},contentStream:null,contentMetadata:{}}}};return sx(HD);})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

queue-microtask/index.js:
  (*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

run-parallel-limit/index.js:
  (*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/p256.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

uint8-util/util.js:
  (* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
  *
  * @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
  * @license  MIT
  *)
*/
//# sourceMappingURL=browser.js.map
