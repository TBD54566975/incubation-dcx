"use strict";var Web5UserAgent=(()=>{var _2e=Object.create;var i8=Object.defineProperty;var x2e=Object.getOwnPropertyDescriptor;var E2e=Object.getOwnPropertyNames;var S2e=Object.getPrototypeOf,T2e=Object.prototype.hasOwnProperty;var A2e=(t=>typeof require<"u"?require:typeof Proxy<"u"?new Proxy(t,{get:(e,r)=>(typeof require<"u"?require:e)[r]}):t)(function(t){if(typeof require<"u")return require.apply(this,arguments);throw Error('Dynamic require of "'+t+'" is not supported')});var k2e=(t,e)=>()=>(t&&(e=t(t=0)),e);var W=(t,e)=>()=>(e||t((e={exports:{}}).exports,e),e.exports),Or=(t,e)=>{for(var r in e)i8(t,r,{get:e[r],enumerable:!0})},mV=(t,e,r,n)=>{if(e&&typeof e=="object"||typeof e=="function")for(let i of E2e(e))!T2e.call(t,i)&&i!==r&&i8(t,i,{get:()=>e[i],enumerable:!(n=x2e(e,i))||n.enumerable});return t};var xt=(t,e,r)=>(r=t!=null?_2e(S2e(t)):{},mV(e||!t||!t.__esModule?i8(r,"default",{value:t,enumerable:!0}):r,t)),P2e=t=>mV(i8({},"__esModule",{value:!0}),t);var ZB=W(o8=>{"use strict";f();o8.byteLength=R2e;o8.toByteArray=O2e;o8.fromByteArray=C2e;var Il=[],Sd=[],I2e=typeof Uint8Array<"u"?Uint8Array:Array,YB="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(K0=0,gV=YB.length;K0<gV;++K0)Il[K0]=YB[K0],Sd[YB.charCodeAt(K0)]=K0;var K0,gV;Sd[45]=62;Sd[95]=63;function vV(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var r=t.indexOf("=");r===-1&&(r=e);var n=r===e?0:4-r%4;return[r,n]}function R2e(t){var e=vV(t),r=e[0],n=e[1];return(r+n)*3/4-n}function B2e(t,e,r){return(e+r)*3/4-r}function O2e(t){var e,r=vV(t),n=r[0],i=r[1],o=new I2e(B2e(t,n,i)),s=0,a=i>0?n-4:n,d;for(d=0;d<a;d+=4)e=Sd[t.charCodeAt(d)]<<18|Sd[t.charCodeAt(d+1)]<<12|Sd[t.charCodeAt(d+2)]<<6|Sd[t.charCodeAt(d+3)],o[s++]=e>>16&255,o[s++]=e>>8&255,o[s++]=e&255;return i===2&&(e=Sd[t.charCodeAt(d)]<<2|Sd[t.charCodeAt(d+1)]>>4,o[s++]=e&255),i===1&&(e=Sd[t.charCodeAt(d)]<<10|Sd[t.charCodeAt(d+1)]<<4|Sd[t.charCodeAt(d+2)]>>2,o[s++]=e>>8&255,o[s++]=e&255),o}function M2e(t){return Il[t>>18&63]+Il[t>>12&63]+Il[t>>6&63]+Il[t&63]}function D2e(t,e,r){for(var n,i=[],o=e;o<r;o+=3)n=(t[o]<<16&16711680)+(t[o+1]<<8&65280)+(t[o+2]&255),i.push(M2e(n));return i.join("")}function C2e(t){for(var e,r=t.length,n=r%3,i=[],o=16383,s=0,a=r-n;s<a;s+=o)i.push(D2e(t,s,s+o>a?a:s+o));return n===1?(e=t[r-1],i.push(Il[e>>2]+Il[e<<4&63]+"==")):n===2&&(e=(t[r-2]<<8)+t[r-1],i.push(Il[e>>10]+Il[e>>4&63]+Il[e<<2&63]+"=")),i.join("")}});var QB=W(XB=>{f();XB.read=function(t,e,r,n,i){var o,s,a=i*8-n-1,d=(1<<a)-1,u=d>>1,c=-7,l=r?i-1:0,h=r?-1:1,y=t[e+l];for(l+=h,o=y&(1<<-c)-1,y>>=-c,c+=a;c>0;o=o*256+t[e+l],l+=h,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=n;c>0;s=s*256+t[e+l],l+=h,c-=8);if(o===0)o=1-u;else{if(o===d)return s?NaN:(y?-1:1)*(1/0);s=s+Math.pow(2,n),o=o-u}return(y?-1:1)*s*Math.pow(2,o-n)};XB.write=function(t,e,r,n,i,o){var s,a,d,u=o*8-i-1,c=(1<<u)-1,l=c>>1,h=i===23?Math.pow(2,-24)-Math.pow(2,-77):0,y=n?0:o-1,g=n?1:-1,v=e<0||e===0&&1/e<0?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(d=Math.pow(2,-s))<1&&(s--,d*=2),s+l>=1?e+=h/d:e+=h*Math.pow(2,1-l),e*d>=2&&(s++,d/=2),s+l>=c?(a=0,s=c):s+l>=1?(a=(e*d-1)*Math.pow(2,i),s=s+l):(a=e*Math.pow(2,l-1)*Math.pow(2,i),s=0));i>=8;t[r+y]=a&255,y+=g,a/=256,i-=8);for(s=s<<i|a,u+=i;u>0;t[r+y]=s&255,y+=g,s/=256,u-=8);t[r+y-g]|=v*128}});var BV=W(iw=>{"use strict";f();var e9=ZB(),nw=QB(),bV=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;iw.Buffer=ve;iw.SlowBuffer=q2e;iw.INSPECT_MAX_BYTES=50;var s8=2147483647;iw.kMaxLength=s8;ve.TYPED_ARRAY_SUPPORT=j2e();!ve.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function j2e(){try{var t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch{return!1}}Object.defineProperty(ve.prototype,"parent",{enumerable:!0,get:function(){if(ve.isBuffer(this))return this.buffer}});Object.defineProperty(ve.prototype,"offset",{enumerable:!0,get:function(){if(ve.isBuffer(this))return this.byteOffset}});function sh(t){if(t>s8)throw new RangeError('The value "'+t+'" is invalid for option "size"');var e=new Uint8Array(t);return Object.setPrototypeOf(e,ve.prototype),e}function ve(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return i9(t)}return xV(t,e,r)}ve.poolSize=8192;function xV(t,e,r){if(typeof t=="string")return N2e(t,e);if(ArrayBuffer.isView(t))return U2e(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Rl(t,ArrayBuffer)||t&&Rl(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Rl(t,SharedArrayBuffer)||t&&Rl(t.buffer,SharedArrayBuffer)))return r9(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');var n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return ve.from(n,e,r);var i=K2e(t);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return ve.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}ve.from=function(t,e,r){return xV(t,e,r)};Object.setPrototypeOf(ve.prototype,Uint8Array.prototype);Object.setPrototypeOf(ve,Uint8Array);function EV(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function $2e(t,e,r){return EV(t),t<=0?sh(t):e!==void 0?typeof r=="string"?sh(t).fill(e,r):sh(t).fill(e):sh(t)}ve.alloc=function(t,e,r){return $2e(t,e,r)};function i9(t){return EV(t),sh(t<0?0:o9(t)|0)}ve.allocUnsafe=function(t){return i9(t)};ve.allocUnsafeSlow=function(t){return i9(t)};function N2e(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!ve.isEncoding(e))throw new TypeError("Unknown encoding: "+e);var r=SV(t,e)|0,n=sh(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function t9(t){for(var e=t.length<0?0:o9(t.length)|0,r=sh(e),n=0;n<e;n+=1)r[n]=t[n]&255;return r}function U2e(t){if(Rl(t,Uint8Array)){var e=new Uint8Array(t);return r9(e.buffer,e.byteOffset,e.byteLength)}return t9(t)}function r9(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');var n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,ve.prototype),n}function K2e(t){if(ve.isBuffer(t)){var e=o9(t.length)|0,r=sh(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||s9(t.length)?sh(0):t9(t);if(t.type==="Buffer"&&Array.isArray(t.data))return t9(t.data)}function o9(t){if(t>=s8)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+s8.toString(16)+" bytes");return t|0}function q2e(t){return+t!=t&&(t=0),ve.alloc(+t)}ve.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==ve.prototype};ve.compare=function(e,r){if(Rl(e,Uint8Array)&&(e=ve.from(e,e.offset,e.byteLength)),Rl(r,Uint8Array)&&(r=ve.from(r,r.offset,r.byteLength)),!ve.isBuffer(e)||!ve.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;for(var n=e.length,i=r.length,o=0,s=Math.min(n,i);o<s;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0};ve.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};ve.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return ve.alloc(0);var n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;var i=ve.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){var s=e[n];if(Rl(s,Uint8Array))o+s.length>i.length?ve.from(s).copy(i,o):Uint8Array.prototype.set.call(i,s,o);else if(ve.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};function SV(t,e){if(ve.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Rl(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);var r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;for(var i=!1;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return n9(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return RV(t).length;default:if(i)return n?-1:n9(t).length;e=(""+e).toLowerCase(),i=!0}}ve.byteLength=SV;function L2e(t,e,r){var n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return X2e(this,e,r);case"utf8":case"utf-8":return AV(this,e,r);case"ascii":return Y2e(this,e,r);case"latin1":case"binary":return Z2e(this,e,r);case"base64":return G2e(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return Q2e(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}ve.prototype._isBuffer=!0;function q0(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}ve.prototype.swap16=function(){var e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(var r=0;r<e;r+=2)q0(this,r,r+1);return this};ve.prototype.swap32=function(){var e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(var r=0;r<e;r+=4)q0(this,r,r+3),q0(this,r+1,r+2);return this};ve.prototype.swap64=function(){var e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(var r=0;r<e;r+=8)q0(this,r,r+7),q0(this,r+1,r+6),q0(this,r+2,r+5),q0(this,r+3,r+4);return this};ve.prototype.toString=function(){var e=this.length;return e===0?"":arguments.length===0?AV(this,0,e):L2e.apply(this,arguments)};ve.prototype.toLocaleString=ve.prototype.toString;ve.prototype.equals=function(e){if(!ve.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:ve.compare(this,e)===0};ve.prototype.inspect=function(){var e="",r=iw.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};bV&&(ve.prototype[bV]=ve.prototype.inspect);ve.prototype.compare=function(e,r,n,i,o){if(Rl(e,Uint8Array)&&(e=ve.from(e,e.offset,e.byteLength)),!ve.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;for(var s=o-i,a=n-r,d=Math.min(s,a),u=this.slice(i,o),c=e.slice(r,n),l=0;l<d;++l)if(u[l]!==c[l]){s=u[l],a=c[l];break}return s<a?-1:a<s?1:0};function TV(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,s9(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=ve.from(e,n)),ve.isBuffer(e))return e.length===0?-1:wV(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):wV(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function wV(t,e,r,n,i){var o=1,s=t.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;o=2,s/=2,a/=2,r/=2}function d(y,g){return o===1?y[g]:y.readUInt16BE(g*o)}var u;if(i){var c=-1;for(u=r;u<s;u++)if(d(t,u)===d(e,c===-1?0:u-c)){if(c===-1&&(c=u),u-c+1===a)return c*o}else c!==-1&&(u-=u-c),c=-1}else for(r+a>s&&(r=s-a),u=r;u>=0;u--){for(var l=!0,h=0;h<a;h++)if(d(t,u+h)!==d(e,h)){l=!1;break}if(l)return u}return-1}ve.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};ve.prototype.indexOf=function(e,r,n){return TV(this,e,r,n,!0)};ve.prototype.lastIndexOf=function(e,r,n){return TV(this,e,r,n,!1)};function F2e(t,e,r,n){r=Number(r)||0;var i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;var o=e.length;n>o/2&&(n=o/2);for(var s=0;s<n;++s){var a=parseInt(e.substr(s*2,2),16);if(s9(a))return s;t[r+s]=a}return s}function z2e(t,e,r,n){return a8(n9(e,t.length-r),t,r,n)}function V2e(t,e,r,n){return a8(r_e(e),t,r,n)}function H2e(t,e,r,n){return a8(RV(e),t,r,n)}function W2e(t,e,r,n){return a8(n_e(e,t.length-r),t,r,n)}ve.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");var o=this.length-r;if((n===void 0||n>o)&&(n=o),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");for(var s=!1;;)switch(i){case"hex":return F2e(this,e,r,n);case"utf8":case"utf-8":return z2e(this,e,r,n);case"ascii":case"latin1":case"binary":return V2e(this,e,r,n);case"base64":return H2e(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return W2e(this,e,r,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};ve.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function G2e(t,e,r){return e===0&&r===t.length?e9.fromByteArray(t):e9.fromByteArray(t.slice(e,r))}function AV(t,e,r){r=Math.min(t.length,r);for(var n=[],i=e;i<r;){var o=t[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){var d,u,c,l;switch(a){case 1:o<128&&(s=o);break;case 2:d=t[i+1],(d&192)===128&&(l=(o&31)<<6|d&63,l>127&&(s=l));break;case 3:d=t[i+1],u=t[i+2],(d&192)===128&&(u&192)===128&&(l=(o&15)<<12|(d&63)<<6|u&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:d=t[i+1],u=t[i+2],c=t[i+3],(d&192)===128&&(u&192)===128&&(c&192)===128&&(l=(o&15)<<18|(d&63)<<12|(u&63)<<6|c&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=a}return J2e(n)}var _V=4096;function J2e(t){var e=t.length;if(e<=_V)return String.fromCharCode.apply(String,t);for(var r="",n=0;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=_V));return r}function Y2e(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function Z2e(t,e,r){var n="";r=Math.min(t.length,r);for(var i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function X2e(t,e,r){var n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);for(var i="",o=e;o<r;++o)i+=i_e[t[o]];return i}function Q2e(t,e,r){for(var n=t.slice(e,r),i="",o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}ve.prototype.slice=function(e,r){var n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);var i=this.subarray(e,r);return Object.setPrototypeOf(i,ve.prototype),i};function So(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}ve.prototype.readUintLE=ve.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||So(e,r,this.length);for(var i=this[e],o=1,s=0;++s<r&&(o*=256);)i+=this[e+s]*o;return i};ve.prototype.readUintBE=ve.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||So(e,r,this.length);for(var i=this[e+--r],o=1;r>0&&(o*=256);)i+=this[e+--r]*o;return i};ve.prototype.readUint8=ve.prototype.readUInt8=function(e,r){return e=e>>>0,r||So(e,1,this.length),this[e]};ve.prototype.readUint16LE=ve.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||So(e,2,this.length),this[e]|this[e+1]<<8};ve.prototype.readUint16BE=ve.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||So(e,2,this.length),this[e]<<8|this[e+1]};ve.prototype.readUint32LE=ve.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||So(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};ve.prototype.readUint32BE=ve.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||So(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};ve.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||So(e,r,this.length);for(var i=this[e],o=1,s=0;++s<r&&(o*=256);)i+=this[e+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*r)),i};ve.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||So(e,r,this.length);for(var i=r,o=1,s=this[e+--i];i>0&&(o*=256);)s+=this[e+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*r)),s};ve.prototype.readInt8=function(e,r){return e=e>>>0,r||So(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};ve.prototype.readInt16LE=function(e,r){e=e>>>0,r||So(e,2,this.length);var n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};ve.prototype.readInt16BE=function(e,r){e=e>>>0,r||So(e,2,this.length);var n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};ve.prototype.readInt32LE=function(e,r){return e=e>>>0,r||So(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};ve.prototype.readInt32BE=function(e,r){return e=e>>>0,r||So(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};ve.prototype.readFloatLE=function(e,r){return e=e>>>0,r||So(e,4,this.length),nw.read(this,e,!0,23,4)};ve.prototype.readFloatBE=function(e,r){return e=e>>>0,r||So(e,4,this.length),nw.read(this,e,!1,23,4)};ve.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||So(e,8,this.length),nw.read(this,e,!0,52,8)};ve.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||So(e,8,this.length),nw.read(this,e,!1,52,8)};function tc(t,e,r,n,i,o){if(!ve.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}ve.prototype.writeUintLE=ve.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){var o=Math.pow(2,8*n)-1;tc(this,e,r,n,o,0)}var s=1,a=0;for(this[r]=e&255;++a<n&&(s*=256);)this[r+a]=e/s&255;return r+n};ve.prototype.writeUintBE=ve.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){var o=Math.pow(2,8*n)-1;tc(this,e,r,n,o,0)}var s=n-1,a=1;for(this[r+s]=e&255;--s>=0&&(a*=256);)this[r+s]=e/a&255;return r+n};ve.prototype.writeUint8=ve.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||tc(this,e,r,1,255,0),this[r]=e&255,r+1};ve.prototype.writeUint16LE=ve.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||tc(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};ve.prototype.writeUint16BE=ve.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||tc(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};ve.prototype.writeUint32LE=ve.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||tc(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};ve.prototype.writeUint32BE=ve.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||tc(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};ve.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){var o=Math.pow(2,8*n-1);tc(this,e,r,n,o-1,-o)}var s=0,a=1,d=0;for(this[r]=e&255;++s<n&&(a*=256);)e<0&&d===0&&this[r+s-1]!==0&&(d=1),this[r+s]=(e/a>>0)-d&255;return r+n};ve.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){var o=Math.pow(2,8*n-1);tc(this,e,r,n,o-1,-o)}var s=n-1,a=1,d=0;for(this[r+s]=e&255;--s>=0&&(a*=256);)e<0&&d===0&&this[r+s+1]!==0&&(d=1),this[r+s]=(e/a>>0)-d&255;return r+n};ve.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||tc(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};ve.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||tc(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};ve.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||tc(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};ve.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||tc(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};ve.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||tc(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function kV(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function PV(t,e,r,n,i){return e=+e,r=r>>>0,i||kV(t,e,r,4,34028234663852886e22,-34028234663852886e22),nw.write(t,e,r,n,23,4),r+4}ve.prototype.writeFloatLE=function(e,r,n){return PV(this,e,r,!0,n)};ve.prototype.writeFloatBE=function(e,r,n){return PV(this,e,r,!1,n)};function IV(t,e,r,n,i){return e=+e,r=r>>>0,i||kV(t,e,r,8,17976931348623157e292,-17976931348623157e292),nw.write(t,e,r,n,52,8),r+8}ve.prototype.writeDoubleLE=function(e,r,n){return IV(this,e,r,!0,n)};ve.prototype.writeDoubleBE=function(e,r,n){return IV(this,e,r,!1,n)};ve.prototype.copy=function(e,r,n,i){if(!ve.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);var o=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),o};ve.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!ve.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){var o=e.charCodeAt(0);(i==="utf8"&&o<128||i==="latin1")&&(e=o)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);var s;if(typeof e=="number")for(s=r;s<n;++s)this[s]=e;else{var a=ve.isBuffer(e)?e:ve.from(e,i),d=a.length;if(d===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(s=0;s<n-r;++s)this[s+r]=a[s%d]}return this};var e_e=/[^+/0-9A-Za-z-_]/g;function t_e(t){if(t=t.split("=")[0],t=t.trim().replace(e_e,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function n9(t,e){e=e||1/0;for(var r,n=t.length,i=null,o=[],s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function r_e(t){for(var e=[],r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function n_e(t,e){for(var r,n,i,o=[],s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function RV(t){return e9.toByteArray(t_e(t))}function a8(t,e,r,n){for(var i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Rl(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function s9(t){return t!==t}var i_e=function(){for(var t="0123456789abcdef",e=new Array(256),r=0;r<16;++r)for(var n=r*16,i=0;i<16;++i)e[n+i]=t[r]+t[i];return e}()});var Fs=W((rot,CV)=>{f();var Oi=CV.exports={},Bl,Ol;function a9(){throw new Error("setTimeout has not been defined")}function c9(){throw new Error("clearTimeout has not been defined")}(function(){try{typeof setTimeout=="function"?Bl=setTimeout:Bl=a9}catch{Bl=a9}try{typeof clearTimeout=="function"?Ol=clearTimeout:Ol=c9}catch{Ol=c9}})();function OV(t){if(Bl===setTimeout)return setTimeout(t,0);if((Bl===a9||!Bl)&&setTimeout)return Bl=setTimeout,setTimeout(t,0);try{return Bl(t,0)}catch{try{return Bl.call(null,t,0)}catch{return Bl.call(this,t,0)}}}function o_e(t){if(Ol===clearTimeout)return clearTimeout(t);if((Ol===c9||!Ol)&&clearTimeout)return Ol=clearTimeout,clearTimeout(t);try{return Ol(t)}catch{try{return Ol.call(null,t)}catch{return Ol.call(this,t)}}}var ah=[],ow=!1,L0,c8=-1;function s_e(){!ow||!L0||(ow=!1,L0.length?ah=L0.concat(ah):c8=-1,ah.length&&MV())}function MV(){if(!ow){var t=OV(s_e);ow=!0;for(var e=ah.length;e;){for(L0=ah,ah=[];++c8<e;)L0&&L0[c8].run();c8=-1,e=ah.length}L0=null,ow=!1,o_e(t)}}Oi.nextTick=function(t){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];ah.push(new DV(t,e)),ah.length===1&&!ow&&OV(MV)};function DV(t,e){this.fun=t,this.array=e}DV.prototype.run=function(){this.fun.apply(null,this.array)};Oi.title="browser";Oi.browser=!0;Oi.env={};Oi.argv=[];Oi.version="";Oi.versions={};function ch(){}Oi.on=ch;Oi.addListener=ch;Oi.once=ch;Oi.off=ch;Oi.removeListener=ch;Oi.removeAllListeners=ch;Oi.emit=ch;Oi.prependListener=ch;Oi.prependOnceListener=ch;Oi.listeners=function(t){return[]};Oi.binding=function(t){throw new Error("process.binding is not supported")};Oi.cwd=function(){return"/"};Oi.chdir=function(t){throw new Error("process.chdir is not supported")};Oi.umask=function(){return 0}});var M,I,iot,f=k2e(()=>{M=xt(BV()),I=xt(Fs()),iot=function(t){function e(){var n=this||self;return delete t.prototype.__magic__,n}if(typeof globalThis=="object")return globalThis;if(this)return e();t.defineProperty(t.prototype,"__magic__",{configurable:!0,get:e});var r=__magic__;return r}(Object)});var $V=W((sot,jV)=>{f();var a_e=typeof globalThis=="object"&&globalThis&&globalThis.Object===Object&&globalThis;jV.exports=a_e});var UV=W((cot,NV)=>{f();var c_e=$V(),d_e=typeof self=="object"&&self&&self.Object===Object&&self,u_e=c_e||d_e||Function("return this")();NV.exports=u_e});var d9=W((uot,KV)=>{f();var l_e=UV(),f_e=l_e.Symbol;KV.exports=f_e});var zV=W((fot,FV)=>{f();var qV=d9(),LV=Object.prototype,h_e=LV.hasOwnProperty,p_e=LV.toString,ux=qV?qV.toStringTag:void 0;function y_e(t){var e=h_e.call(t,ux),r=t[ux];try{t[ux]=void 0;var n=!0}catch{}var i=p_e.call(t);return n&&(e?t[ux]=r:delete t[ux]),i}FV.exports=y_e});var HV=W((pot,VV)=>{f();var m_e=Object.prototype,g_e=m_e.toString;function v_e(t){return g_e.call(t)}VV.exports=v_e});var YV=W((mot,JV)=>{f();var WV=d9(),b_e=zV(),w_e=HV(),__e="[object Null]",x_e="[object Undefined]",GV=WV?WV.toStringTag:void 0;function E_e(t){return t==null?t===void 0?x_e:__e:GV&&GV in Object(t)?b_e(t):w_e(t)}JV.exports=E_e});var XV=W((vot,ZV)=>{f();function S_e(t,e){return function(r){return t(e(r))}}ZV.exports=S_e});var eH=W((wot,QV)=>{f();var T_e=XV(),A_e=T_e(Object.getPrototypeOf,Object);QV.exports=A_e});var rH=W((xot,tH)=>{f();function k_e(t){return t!=null&&typeof t=="object"}tH.exports=k_e});var oH=W((Sot,iH)=>{f();var P_e=YV(),I_e=eH(),R_e=rH(),B_e="[object Object]",O_e=Function.prototype,M_e=Object.prototype,nH=O_e.toString,D_e=M_e.hasOwnProperty,C_e=nH.call(Object);function j_e(t){if(!R_e(t)||P_e(t)!=B_e)return!1;var e=I_e(t);if(e===null)return!0;var r=D_e.call(e,"constructor")&&e.constructor;return typeof r=="function"&&r instanceof r&&nH.call(r)==C_e}iH.exports=j_e});var Uc=W((uft,AJ)=>{"use strict";f();function TJ(t,e){for(let r in e)Object.defineProperty(t,r,{value:e[r],enumerable:!0,configurable:!0});return t}function k5e(t,e,r){if(!t||typeof t=="string")throw new TypeError("Please pass an Error to err-code");r||(r={}),typeof e=="object"&&(r=e,e=""),e&&(r.code=e);try{return TJ(t,r)}catch{r.message=t.message,r.stack=t.stack;let i=function(){};return i.prototype=Object.create(Object.getPrototypeOf(t)),TJ(new i,r)}}AJ.exports=k5e});var _Y=W((iE,rT)=>{f();(function(t,e){"use strict";var r={version:"3.0.0",x86:{},x64:{},inputValidation:!0};function n(y){if(!Array.isArray(y)&&!ArrayBuffer.isView(y))return!1;for(var g=0;g<y.length;g++)if(!Number.isInteger(y[g])||y[g]<0||y[g]>255)return!1;return!0}function i(y,g){return(y&65535)*g+(((y>>>16)*g&65535)<<16)}function o(y,g){return y<<g|y>>>32-g}function s(y){return y^=y>>>16,y=i(y,2246822507),y^=y>>>13,y=i(y,3266489909),y^=y>>>16,y}function a(y,g){y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var v=[0,0,0,0];return v[3]+=y[3]+g[3],v[2]+=v[3]>>>16,v[3]&=65535,v[2]+=y[2]+g[2],v[1]+=v[2]>>>16,v[2]&=65535,v[1]+=y[1]+g[1],v[0]+=v[1]>>>16,v[1]&=65535,v[0]+=y[0]+g[0],v[0]&=65535,[v[0]<<16|v[1],v[2]<<16|v[3]]}function d(y,g){y=[y[0]>>>16,y[0]&65535,y[1]>>>16,y[1]&65535],g=[g[0]>>>16,g[0]&65535,g[1]>>>16,g[1]&65535];var v=[0,0,0,0];return v[3]+=y[3]*g[3],v[2]+=v[3]>>>16,v[3]&=65535,v[2]+=y[2]*g[3],v[1]+=v[2]>>>16,v[2]&=65535,v[2]+=y[3]*g[2],v[1]+=v[2]>>>16,v[2]&=65535,v[1]+=y[1]*g[3],v[0]+=v[1]>>>16,v[1]&=65535,v[1]+=y[2]*g[2],v[0]+=v[1]>>>16,v[1]&=65535,v[1]+=y[3]*g[1],v[0]+=v[1]>>>16,v[1]&=65535,v[0]+=y[0]*g[3]+y[1]*g[2]+y[2]*g[1]+y[3]*g[0],v[0]&=65535,[v[0]<<16|v[1],v[2]<<16|v[3]]}function u(y,g){return g%=64,g===32?[y[1],y[0]]:g<32?[y[0]<<g|y[1]>>>32-g,y[1]<<g|y[0]>>>32-g]:(g-=32,[y[1]<<g|y[0]>>>32-g,y[0]<<g|y[1]>>>32-g])}function c(y,g){return g%=64,g===0?y:g<32?[y[0]<<g|y[1]>>>32-g,y[1]<<g]:[y[1]<<g-32,0]}function l(y,g){return[y[0]^g[0],y[1]^g[1]]}function h(y){return y=l(y,[0,y[0]>>>1]),y=d(y,[4283543511,3981806797]),y=l(y,[0,y[0]>>>1]),y=d(y,[3301882366,444984403]),y=l(y,[0,y[0]>>>1]),y}r.x86.hash32=function(y,g){if(r.inputValidation&&!n(y))return e;g=g||0;for(var v=y.length%4,x=y.length-v,S=g,A=0,T=3432918353,$=461845907,j=0;j<x;j=j+4)A=y[j]|y[j+1]<<8|y[j+2]<<16|y[j+3]<<24,A=i(A,T),A=o(A,15),A=i(A,$),S^=A,S=o(S,13),S=i(S,5)+3864292196;switch(A=0,v){case 3:A^=y[j+2]<<16;case 2:A^=y[j+1]<<8;case 1:A^=y[j],A=i(A,T),A=o(A,15),A=i(A,$),S^=A}return S^=y.length,S=s(S),S>>>0},r.x86.hash128=function(y,g){if(r.inputValidation&&!n(y))return e;g=g||0;for(var v=y.length%16,x=y.length-v,S=g,A=g,T=g,$=g,j=0,K=0,F=0,L=0,V=597399067,q=2869860233,k=951274213,P=2716044179,B=0;B<x;B=B+16)j=y[B]|y[B+1]<<8|y[B+2]<<16|y[B+3]<<24,K=y[B+4]|y[B+5]<<8|y[B+6]<<16|y[B+7]<<24,F=y[B+8]|y[B+9]<<8|y[B+10]<<16|y[B+11]<<24,L=y[B+12]|y[B+13]<<8|y[B+14]<<16|y[B+15]<<24,j=i(j,V),j=o(j,15),j=i(j,q),S^=j,S=o(S,19),S+=A,S=i(S,5)+1444728091,K=i(K,q),K=o(K,16),K=i(K,k),A^=K,A=o(A,17),A+=T,A=i(A,5)+197830471,F=i(F,k),F=o(F,17),F=i(F,P),T^=F,T=o(T,15),T+=$,T=i(T,5)+2530024501,L=i(L,P),L=o(L,18),L=i(L,V),$^=L,$=o($,13),$+=S,$=i($,5)+850148119;switch(j=0,K=0,F=0,L=0,v){case 15:L^=y[B+14]<<16;case 14:L^=y[B+13]<<8;case 13:L^=y[B+12],L=i(L,P),L=o(L,18),L=i(L,V),$^=L;case 12:F^=y[B+11]<<24;case 11:F^=y[B+10]<<16;case 10:F^=y[B+9]<<8;case 9:F^=y[B+8],F=i(F,k),F=o(F,17),F=i(F,P),T^=F;case 8:K^=y[B+7]<<24;case 7:K^=y[B+6]<<16;case 6:K^=y[B+5]<<8;case 5:K^=y[B+4],K=i(K,q),K=o(K,16),K=i(K,k),A^=K;case 4:j^=y[B+3]<<24;case 3:j^=y[B+2]<<16;case 2:j^=y[B+1]<<8;case 1:j^=y[B],j=i(j,V),j=o(j,15),j=i(j,q),S^=j}return S^=y.length,A^=y.length,T^=y.length,$^=y.length,S+=A,S+=T,S+=$,A+=S,T+=S,$+=S,S=s(S),A=s(A),T=s(T),$=s($),S+=A,S+=T,S+=$,A+=S,T+=S,$+=S,("00000000"+(S>>>0).toString(16)).slice(-8)+("00000000"+(A>>>0).toString(16)).slice(-8)+("00000000"+(T>>>0).toString(16)).slice(-8)+("00000000"+($>>>0).toString(16)).slice(-8)},r.x64.hash128=function(y,g){if(r.inputValidation&&!n(y))return e;g=g||0;for(var v=y.length%16,x=y.length-v,S=[0,g],A=[0,g],T=[0,0],$=[0,0],j=[2277735313,289559509],K=[1291169091,658871167],F=0;F<x;F=F+16)T=[y[F+4]|y[F+5]<<8|y[F+6]<<16|y[F+7]<<24,y[F]|y[F+1]<<8|y[F+2]<<16|y[F+3]<<24],$=[y[F+12]|y[F+13]<<8|y[F+14]<<16|y[F+15]<<24,y[F+8]|y[F+9]<<8|y[F+10]<<16|y[F+11]<<24],T=d(T,j),T=u(T,31),T=d(T,K),S=l(S,T),S=u(S,27),S=a(S,A),S=a(d(S,[0,5]),[0,1390208809]),$=d($,K),$=u($,33),$=d($,j),A=l(A,$),A=u(A,31),A=a(A,S),A=a(d(A,[0,5]),[0,944331445]);switch(T=[0,0],$=[0,0],v){case 15:$=l($,c([0,y[F+14]],48));case 14:$=l($,c([0,y[F+13]],40));case 13:$=l($,c([0,y[F+12]],32));case 12:$=l($,c([0,y[F+11]],24));case 11:$=l($,c([0,y[F+10]],16));case 10:$=l($,c([0,y[F+9]],8));case 9:$=l($,[0,y[F+8]]),$=d($,K),$=u($,33),$=d($,j),A=l(A,$);case 8:T=l(T,c([0,y[F+7]],56));case 7:T=l(T,c([0,y[F+6]],48));case 6:T=l(T,c([0,y[F+5]],40));case 5:T=l(T,c([0,y[F+4]],32));case 4:T=l(T,c([0,y[F+3]],24));case 3:T=l(T,c([0,y[F+2]],16));case 2:T=l(T,c([0,y[F+1]],8));case 1:T=l(T,[0,y[F]]),T=d(T,j),T=u(T,31),T=d(T,K),S=l(S,T)}return S=l(S,[0,y.length]),A=l(A,[0,y.length]),S=a(S,A),A=a(A,S),S=h(S),A=h(A),S=a(S,A),A=a(A,S),("00000000"+(S[0]>>>0).toString(16)).slice(-8)+("00000000"+(S[1]>>>0).toString(16)).slice(-8)+("00000000"+(A[0]>>>0).toString(16)).slice(-8)+("00000000"+(A[1]>>>0).toString(16)).slice(-8)},typeof iE<"u"?(typeof rT<"u"&&rT.exports&&(iE=rT.exports=r),iE.murmurHash3=r):typeof define=="function"&&define.amd?define([],function(){return r}):(r._murmurHash3=t.murmurHash3,r.noConflict=function(){return t.murmurHash3=r._murmurHash3,r._murmurHash3=e,r.noConflict=e,r},t.murmurHash3=r)})(iE)});var EY=W((Kyt,xY)=>{f();xY.exports=_Y()});var AY=W((Jyt,TY)=>{"use strict";f();TY.exports=class{constructor(){this._bitArrays=[],this._data=[],this._length=0,this._changedLength=!1,this._changedData=!1}set(e,r){let n=this._internalPositionFor(e,!1);if(r===void 0)n!==-1&&(this._unsetInternalPos(n),this._unsetBit(e),this._changedLength=!0,this._changedData=!0);else{let i=!1;n===-1?(n=this._data.length,this._setBit(e),this._changedData=!0):i=!0,this._setInternalPos(n,e,r,i),this._changedLength=!0}}unset(e){this.set(e,void 0)}get(e){this._sortData();let r=this._internalPositionFor(e,!0);if(r!==-1)return this._data[r][1]}push(e){return this.set(this.length,e),this.length}get length(){if(this._sortData(),this._changedLength){let e=this._data[this._data.length-1];this._length=e?e[0]+1:0,this._changedLength=!1}return this._length}forEach(e){let r=0;for(;r<this.length;)e(this.get(r),r,this),r++}map(e){let r=0,n=new Array(this.length);for(;r<this.length;)n[r]=e(this.get(r),r,this),r++;return n}reduce(e,r){let n=0,i=r;for(;n<this.length;){let o=this.get(n);i=e(i,o,n),n++}return i}find(e){let r=0,n,i;for(;r<this.length&&!n;)i=this.get(r),n=e(i),r++;return n?i:void 0}_internalPositionFor(e,r){let n=this._bytePosFor(e,r);if(n>=this._bitArrays.length)return-1;let i=this._bitArrays[n],o=e-n*7;if(!((i&1<<o)>0))return-1;let a=this._bitArrays.slice(0,n).reduce(D3e,0),d=~(4294967295<<o+1),u=SY(i&d);return a+u-1}_bytePosFor(e,r){let n=Math.floor(e/7),i=n+1;for(;!r&&this._bitArrays.length<i;)this._bitArrays.push(0);return n}_setBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]|=1<<e-r*7}_unsetBit(e){let r=this._bytePosFor(e,!1);this._bitArrays[r]&=~(1<<e-r*7)}_setInternalPos(e,r,n,i){let o=this._data,s=[r,n];if(i)this._sortData(),o[e]=s;else{if(o.length)if(o[o.length-1][0]>=r)o.push(s);else if(o[0][0]<=r)o.unshift(s);else{let a=Math.round(o.length/2);this._data=o.slice(0,a).concat(s).concat(o.slice(a))}else this._data.push(s);this._changedData=!0,this._changedLength=!0}}_unsetInternalPos(e){this._data.splice(e,1)}_sortData(){this._changedData&&this._data.sort(C3e),this._changedData=!1}bitField(){let e=[],r=8,n=0,i=0,o,s=this._bitArrays.slice();for(;s.length||n;){n===0&&(o=s.shift(),n=7);let d=Math.min(n,r),u=~(255<<d),c=o&u;i|=c<<8-r,o=o>>>d,n-=d,r-=d,(!r||!n&&!s.length)&&(e.push(i),i=0,r=8)}for(var a=e.length-1;a>0&&e[a]===0;a--)e.pop();return e}compactArray(){return this._sortData(),this._data.map(j3e)}};function D3e(t,e){return t+SY(e)}function SY(t){let e=t;return e=e-(e>>1&1431655765),e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>24}function C3e(t,e){return t[0]-e[0]}function j3e(t){return t[1]}});var bn=W(Hw=>{"use strict";f();var PM=ZB(),zw=QB(),KY=typeof Symbol=="function"&&typeof Symbol.for=="function"?Symbol.for("nodejs.util.inspect.custom"):null;Hw.Buffer=ye;Hw.SlowBuffer=e8e;Hw.INSPECT_MAX_BYTES=50;var cT=2147483647;Hw.kMaxLength=cT;ye.TYPED_ARRAY_SUPPORT=J3e();!ye.TYPED_ARRAY_SUPPORT&&typeof console<"u"&&typeof console.error=="function"&&console.error("This browser lacks typed array (Uint8Array) support which is required by `buffer` v5.x. Use `buffer` v4.x if you require old browser support.");function J3e(){try{let t=new Uint8Array(1),e={foo:function(){return 42}};return Object.setPrototypeOf(e,Uint8Array.prototype),Object.setPrototypeOf(t,e),t.foo()===42}catch{return!1}}Object.defineProperty(ye.prototype,"parent",{enumerable:!0,get:function(){if(ye.isBuffer(this))return this.buffer}});Object.defineProperty(ye.prototype,"offset",{enumerable:!0,get:function(){if(ye.isBuffer(this))return this.byteOffset}});function xh(t){if(t>cT)throw new RangeError('The value "'+t+'" is invalid for option "size"');let e=new Uint8Array(t);return Object.setPrototypeOf(e,ye.prototype),e}function ye(t,e,r){if(typeof t=="number"){if(typeof e=="string")throw new TypeError('The "string" argument must be of type string. Received type number');return OM(t)}return zY(t,e,r)}ye.poolSize=8192;function zY(t,e,r){if(typeof t=="string")return Z3e(t,e);if(ArrayBuffer.isView(t))return X3e(t);if(t==null)throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t);if(Fl(t,ArrayBuffer)||t&&Fl(t.buffer,ArrayBuffer)||typeof SharedArrayBuffer<"u"&&(Fl(t,SharedArrayBuffer)||t&&Fl(t.buffer,SharedArrayBuffer)))return RM(t,e,r);if(typeof t=="number")throw new TypeError('The "value" argument must not be of type number. Received type number');let n=t.valueOf&&t.valueOf();if(n!=null&&n!==t)return ye.from(n,e,r);let i=Q3e(t);if(i)return i;if(typeof Symbol<"u"&&Symbol.toPrimitive!=null&&typeof t[Symbol.toPrimitive]=="function")return ye.from(t[Symbol.toPrimitive]("string"),e,r);throw new TypeError("The first argument must be one of type string, Buffer, ArrayBuffer, Array, or Array-like Object. Received type "+typeof t)}ye.from=function(t,e,r){return zY(t,e,r)};Object.setPrototypeOf(ye.prototype,Uint8Array.prototype);Object.setPrototypeOf(ye,Uint8Array);function VY(t){if(typeof t!="number")throw new TypeError('"size" argument must be of type number');if(t<0)throw new RangeError('The value "'+t+'" is invalid for option "size"')}function Y3e(t,e,r){return VY(t),t<=0?xh(t):e!==void 0?typeof r=="string"?xh(t).fill(e,r):xh(t).fill(e):xh(t)}ye.alloc=function(t,e,r){return Y3e(t,e,r)};function OM(t){return VY(t),xh(t<0?0:MM(t)|0)}ye.allocUnsafe=function(t){return OM(t)};ye.allocUnsafeSlow=function(t){return OM(t)};function Z3e(t,e){if((typeof e!="string"||e==="")&&(e="utf8"),!ye.isEncoding(e))throw new TypeError("Unknown encoding: "+e);let r=HY(t,e)|0,n=xh(r),i=n.write(t,e);return i!==r&&(n=n.slice(0,i)),n}function IM(t){let e=t.length<0?0:MM(t.length)|0,r=xh(e);for(let n=0;n<e;n+=1)r[n]=t[n]&255;return r}function X3e(t){if(Fl(t,Uint8Array)){let e=new Uint8Array(t);return RM(e.buffer,e.byteOffset,e.byteLength)}return IM(t)}function RM(t,e,r){if(e<0||t.byteLength<e)throw new RangeError('"offset" is outside of buffer bounds');if(t.byteLength<e+(r||0))throw new RangeError('"length" is outside of buffer bounds');let n;return e===void 0&&r===void 0?n=new Uint8Array(t):r===void 0?n=new Uint8Array(t,e):n=new Uint8Array(t,e,r),Object.setPrototypeOf(n,ye.prototype),n}function Q3e(t){if(ye.isBuffer(t)){let e=MM(t.length)|0,r=xh(e);return r.length===0||t.copy(r,0,0,e),r}if(t.length!==void 0)return typeof t.length!="number"||CM(t.length)?xh(0):IM(t);if(t.type==="Buffer"&&Array.isArray(t.data))return IM(t.data)}function MM(t){if(t>=cT)throw new RangeError("Attempt to allocate Buffer larger than maximum size: 0x"+cT.toString(16)+" bytes");return t|0}function e8e(t){return+t!=t&&(t=0),ye.alloc(+t)}ye.isBuffer=function(e){return e!=null&&e._isBuffer===!0&&e!==ye.prototype};ye.compare=function(e,r){if(Fl(e,Uint8Array)&&(e=ye.from(e,e.offset,e.byteLength)),Fl(r,Uint8Array)&&(r=ye.from(r,r.offset,r.byteLength)),!ye.isBuffer(e)||!ye.isBuffer(r))throw new TypeError('The "buf1", "buf2" arguments must be one of type Buffer or Uint8Array');if(e===r)return 0;let n=e.length,i=r.length;for(let o=0,s=Math.min(n,i);o<s;++o)if(e[o]!==r[o]){n=e[o],i=r[o];break}return n<i?-1:i<n?1:0};ye.isEncoding=function(e){switch(String(e).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"latin1":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}};ye.concat=function(e,r){if(!Array.isArray(e))throw new TypeError('"list" argument must be an Array of Buffers');if(e.length===0)return ye.alloc(0);let n;if(r===void 0)for(r=0,n=0;n<e.length;++n)r+=e[n].length;let i=ye.allocUnsafe(r),o=0;for(n=0;n<e.length;++n){let s=e[n];if(Fl(s,Uint8Array))o+s.length>i.length?(ye.isBuffer(s)||(s=ye.from(s)),s.copy(i,o)):Uint8Array.prototype.set.call(i,s,o);else if(ye.isBuffer(s))s.copy(i,o);else throw new TypeError('"list" argument must be an Array of Buffers');o+=s.length}return i};function HY(t,e){if(ye.isBuffer(t))return t.length;if(ArrayBuffer.isView(t)||Fl(t,ArrayBuffer))return t.byteLength;if(typeof t!="string")throw new TypeError('The "string" argument must be one of type string, Buffer, or ArrayBuffer. Received type '+typeof t);let r=t.length,n=arguments.length>2&&arguments[2]===!0;if(!n&&r===0)return 0;let i=!1;for(;;)switch(e){case"ascii":case"latin1":case"binary":return r;case"utf8":case"utf-8":return BM(t).length;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return r*2;case"hex":return r>>>1;case"base64":return tZ(t).length;default:if(i)return n?-1:BM(t).length;e=(""+e).toLowerCase(),i=!0}}ye.byteLength=HY;function t8e(t,e,r){let n=!1;if((e===void 0||e<0)&&(e=0),e>this.length||((r===void 0||r>this.length)&&(r=this.length),r<=0)||(r>>>=0,e>>>=0,r<=e))return"";for(t||(t="utf8");;)switch(t){case"hex":return l8e(this,e,r);case"utf8":case"utf-8":return GY(this,e,r);case"ascii":return d8e(this,e,r);case"latin1":case"binary":return u8e(this,e,r);case"base64":return a8e(this,e,r);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return f8e(this,e,r);default:if(n)throw new TypeError("Unknown encoding: "+t);t=(t+"").toLowerCase(),n=!0}}ye.prototype._isBuffer=!0;function gg(t,e,r){let n=t[e];t[e]=t[r],t[r]=n}ye.prototype.swap16=function(){let e=this.length;if(e%2!==0)throw new RangeError("Buffer size must be a multiple of 16-bits");for(let r=0;r<e;r+=2)gg(this,r,r+1);return this};ye.prototype.swap32=function(){let e=this.length;if(e%4!==0)throw new RangeError("Buffer size must be a multiple of 32-bits");for(let r=0;r<e;r+=4)gg(this,r,r+3),gg(this,r+1,r+2);return this};ye.prototype.swap64=function(){let e=this.length;if(e%8!==0)throw new RangeError("Buffer size must be a multiple of 64-bits");for(let r=0;r<e;r+=8)gg(this,r,r+7),gg(this,r+1,r+6),gg(this,r+2,r+5),gg(this,r+3,r+4);return this};ye.prototype.toString=function(){let e=this.length;return e===0?"":arguments.length===0?GY(this,0,e):t8e.apply(this,arguments)};ye.prototype.toLocaleString=ye.prototype.toString;ye.prototype.equals=function(e){if(!ye.isBuffer(e))throw new TypeError("Argument must be a Buffer");return this===e?!0:ye.compare(this,e)===0};ye.prototype.inspect=function(){let e="",r=Hw.INSPECT_MAX_BYTES;return e=this.toString("hex",0,r).replace(/(.{2})/g,"$1 ").trim(),this.length>r&&(e+=" ... "),"<Buffer "+e+">"};KY&&(ye.prototype[KY]=ye.prototype.inspect);ye.prototype.compare=function(e,r,n,i,o){if(Fl(e,Uint8Array)&&(e=ye.from(e,e.offset,e.byteLength)),!ye.isBuffer(e))throw new TypeError('The "target" argument must be one of type Buffer or Uint8Array. Received type '+typeof e);if(r===void 0&&(r=0),n===void 0&&(n=e?e.length:0),i===void 0&&(i=0),o===void 0&&(o=this.length),r<0||n>e.length||i<0||o>this.length)throw new RangeError("out of range index");if(i>=o&&r>=n)return 0;if(i>=o)return-1;if(r>=n)return 1;if(r>>>=0,n>>>=0,i>>>=0,o>>>=0,this===e)return 0;let s=o-i,a=n-r,d=Math.min(s,a),u=this.slice(i,o),c=e.slice(r,n);for(let l=0;l<d;++l)if(u[l]!==c[l]){s=u[l],a=c[l];break}return s<a?-1:a<s?1:0};function WY(t,e,r,n,i){if(t.length===0)return-1;if(typeof r=="string"?(n=r,r=0):r>2147483647?r=2147483647:r<-2147483648&&(r=-2147483648),r=+r,CM(r)&&(r=i?0:t.length-1),r<0&&(r=t.length+r),r>=t.length){if(i)return-1;r=t.length-1}else if(r<0)if(i)r=0;else return-1;if(typeof e=="string"&&(e=ye.from(e,n)),ye.isBuffer(e))return e.length===0?-1:qY(t,e,r,n,i);if(typeof e=="number")return e=e&255,typeof Uint8Array.prototype.indexOf=="function"?i?Uint8Array.prototype.indexOf.call(t,e,r):Uint8Array.prototype.lastIndexOf.call(t,e,r):qY(t,[e],r,n,i);throw new TypeError("val must be string, number or Buffer")}function qY(t,e,r,n,i){let o=1,s=t.length,a=e.length;if(n!==void 0&&(n=String(n).toLowerCase(),n==="ucs2"||n==="ucs-2"||n==="utf16le"||n==="utf-16le")){if(t.length<2||e.length<2)return-1;o=2,s/=2,a/=2,r/=2}function d(c,l){return o===1?c[l]:c.readUInt16BE(l*o)}let u;if(i){let c=-1;for(u=r;u<s;u++)if(d(t,u)===d(e,c===-1?0:u-c)){if(c===-1&&(c=u),u-c+1===a)return c*o}else c!==-1&&(u-=u-c),c=-1}else for(r+a>s&&(r=s-a),u=r;u>=0;u--){let c=!0;for(let l=0;l<a;l++)if(d(t,u+l)!==d(e,l)){c=!1;break}if(c)return u}return-1}ye.prototype.includes=function(e,r,n){return this.indexOf(e,r,n)!==-1};ye.prototype.indexOf=function(e,r,n){return WY(this,e,r,n,!0)};ye.prototype.lastIndexOf=function(e,r,n){return WY(this,e,r,n,!1)};function r8e(t,e,r,n){r=Number(r)||0;let i=t.length-r;n?(n=Number(n),n>i&&(n=i)):n=i;let o=e.length;n>o/2&&(n=o/2);let s;for(s=0;s<n;++s){let a=parseInt(e.substr(s*2,2),16);if(CM(a))return s;t[r+s]=a}return s}function n8e(t,e,r,n){return dT(BM(e,t.length-r),t,r,n)}function i8e(t,e,r,n){return dT(m8e(e),t,r,n)}function o8e(t,e,r,n){return dT(tZ(e),t,r,n)}function s8e(t,e,r,n){return dT(g8e(e,t.length-r),t,r,n)}ye.prototype.write=function(e,r,n,i){if(r===void 0)i="utf8",n=this.length,r=0;else if(n===void 0&&typeof r=="string")i=r,n=this.length,r=0;else if(isFinite(r))r=r>>>0,isFinite(n)?(n=n>>>0,i===void 0&&(i="utf8")):(i=n,n=void 0);else throw new Error("Buffer.write(string, encoding, offset[, length]) is no longer supported");let o=this.length-r;if((n===void 0||n>o)&&(n=o),e.length>0&&(n<0||r<0)||r>this.length)throw new RangeError("Attempt to write outside buffer bounds");i||(i="utf8");let s=!1;for(;;)switch(i){case"hex":return r8e(this,e,r,n);case"utf8":case"utf-8":return n8e(this,e,r,n);case"ascii":case"latin1":case"binary":return i8e(this,e,r,n);case"base64":return o8e(this,e,r,n);case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return s8e(this,e,r,n);default:if(s)throw new TypeError("Unknown encoding: "+i);i=(""+i).toLowerCase(),s=!0}};ye.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}};function a8e(t,e,r){return e===0&&r===t.length?PM.fromByteArray(t):PM.fromByteArray(t.slice(e,r))}function GY(t,e,r){r=Math.min(t.length,r);let n=[],i=e;for(;i<r;){let o=t[i],s=null,a=o>239?4:o>223?3:o>191?2:1;if(i+a<=r){let d,u,c,l;switch(a){case 1:o<128&&(s=o);break;case 2:d=t[i+1],(d&192)===128&&(l=(o&31)<<6|d&63,l>127&&(s=l));break;case 3:d=t[i+1],u=t[i+2],(d&192)===128&&(u&192)===128&&(l=(o&15)<<12|(d&63)<<6|u&63,l>2047&&(l<55296||l>57343)&&(s=l));break;case 4:d=t[i+1],u=t[i+2],c=t[i+3],(d&192)===128&&(u&192)===128&&(c&192)===128&&(l=(o&15)<<18|(d&63)<<12|(u&63)<<6|c&63,l>65535&&l<1114112&&(s=l))}}s===null?(s=65533,a=1):s>65535&&(s-=65536,n.push(s>>>10&1023|55296),s=56320|s&1023),n.push(s),i+=a}return c8e(n)}var LY=4096;function c8e(t){let e=t.length;if(e<=LY)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=LY));return r}function d8e(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]&127);return n}function u8e(t,e,r){let n="";r=Math.min(t.length,r);for(let i=e;i<r;++i)n+=String.fromCharCode(t[i]);return n}function l8e(t,e,r){let n=t.length;(!e||e<0)&&(e=0),(!r||r<0||r>n)&&(r=n);let i="";for(let o=e;o<r;++o)i+=v8e[t[o]];return i}function f8e(t,e,r){let n=t.slice(e,r),i="";for(let o=0;o<n.length-1;o+=2)i+=String.fromCharCode(n[o]+n[o+1]*256);return i}ye.prototype.slice=function(e,r){let n=this.length;e=~~e,r=r===void 0?n:~~r,e<0?(e+=n,e<0&&(e=0)):e>n&&(e=n),r<0?(r+=n,r<0&&(r=0)):r>n&&(r=n),r<e&&(r=e);let i=this.subarray(e,r);return Object.setPrototypeOf(i,ye.prototype),i};function Oo(t,e,r){if(t%1!==0||t<0)throw new RangeError("offset is not uint");if(t+e>r)throw new RangeError("Trying to access beyond buffer length")}ye.prototype.readUintLE=ye.prototype.readUIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||Oo(e,r,this.length);let i=this[e],o=1,s=0;for(;++s<r&&(o*=256);)i+=this[e+s]*o;return i};ye.prototype.readUintBE=ye.prototype.readUIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||Oo(e,r,this.length);let i=this[e+--r],o=1;for(;r>0&&(o*=256);)i+=this[e+--r]*o;return i};ye.prototype.readUint8=ye.prototype.readUInt8=function(e,r){return e=e>>>0,r||Oo(e,1,this.length),this[e]};ye.prototype.readUint16LE=ye.prototype.readUInt16LE=function(e,r){return e=e>>>0,r||Oo(e,2,this.length),this[e]|this[e+1]<<8};ye.prototype.readUint16BE=ye.prototype.readUInt16BE=function(e,r){return e=e>>>0,r||Oo(e,2,this.length),this[e]<<8|this[e+1]};ye.prototype.readUint32LE=ye.prototype.readUInt32LE=function(e,r){return e=e>>>0,r||Oo(e,4,this.length),(this[e]|this[e+1]<<8|this[e+2]<<16)+this[e+3]*16777216};ye.prototype.readUint32BE=ye.prototype.readUInt32BE=function(e,r){return e=e>>>0,r||Oo(e,4,this.length),this[e]*16777216+(this[e+1]<<16|this[e+2]<<8|this[e+3])};ye.prototype.readBigUInt64LE=Iy(function(e){e=e>>>0,Vw(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&sE(e,this.length-8);let i=r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24,o=this[++e]+this[++e]*2**8+this[++e]*2**16+n*2**24;return BigInt(i)+(BigInt(o)<<BigInt(32))});ye.prototype.readBigUInt64BE=Iy(function(e){e=e>>>0,Vw(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&sE(e,this.length-8);let i=r*2**24+this[++e]*2**16+this[++e]*2**8+this[++e],o=this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n;return(BigInt(i)<<BigInt(32))+BigInt(o)});ye.prototype.readIntLE=function(e,r,n){e=e>>>0,r=r>>>0,n||Oo(e,r,this.length);let i=this[e],o=1,s=0;for(;++s<r&&(o*=256);)i+=this[e+s]*o;return o*=128,i>=o&&(i-=Math.pow(2,8*r)),i};ye.prototype.readIntBE=function(e,r,n){e=e>>>0,r=r>>>0,n||Oo(e,r,this.length);let i=r,o=1,s=this[e+--i];for(;i>0&&(o*=256);)s+=this[e+--i]*o;return o*=128,s>=o&&(s-=Math.pow(2,8*r)),s};ye.prototype.readInt8=function(e,r){return e=e>>>0,r||Oo(e,1,this.length),this[e]&128?(255-this[e]+1)*-1:this[e]};ye.prototype.readInt16LE=function(e,r){e=e>>>0,r||Oo(e,2,this.length);let n=this[e]|this[e+1]<<8;return n&32768?n|4294901760:n};ye.prototype.readInt16BE=function(e,r){e=e>>>0,r||Oo(e,2,this.length);let n=this[e+1]|this[e]<<8;return n&32768?n|4294901760:n};ye.prototype.readInt32LE=function(e,r){return e=e>>>0,r||Oo(e,4,this.length),this[e]|this[e+1]<<8|this[e+2]<<16|this[e+3]<<24};ye.prototype.readInt32BE=function(e,r){return e=e>>>0,r||Oo(e,4,this.length),this[e]<<24|this[e+1]<<16|this[e+2]<<8|this[e+3]};ye.prototype.readBigInt64LE=Iy(function(e){e=e>>>0,Vw(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&sE(e,this.length-8);let i=this[e+4]+this[e+5]*2**8+this[e+6]*2**16+(n<<24);return(BigInt(i)<<BigInt(32))+BigInt(r+this[++e]*2**8+this[++e]*2**16+this[++e]*2**24)});ye.prototype.readBigInt64BE=Iy(function(e){e=e>>>0,Vw(e,"offset");let r=this[e],n=this[e+7];(r===void 0||n===void 0)&&sE(e,this.length-8);let i=(r<<24)+this[++e]*2**16+this[++e]*2**8+this[++e];return(BigInt(i)<<BigInt(32))+BigInt(this[++e]*2**24+this[++e]*2**16+this[++e]*2**8+n)});ye.prototype.readFloatLE=function(e,r){return e=e>>>0,r||Oo(e,4,this.length),zw.read(this,e,!0,23,4)};ye.prototype.readFloatBE=function(e,r){return e=e>>>0,r||Oo(e,4,this.length),zw.read(this,e,!1,23,4)};ye.prototype.readDoubleLE=function(e,r){return e=e>>>0,r||Oo(e,8,this.length),zw.read(this,e,!0,52,8)};ye.prototype.readDoubleBE=function(e,r){return e=e>>>0,r||Oo(e,8,this.length),zw.read(this,e,!1,52,8)};function ic(t,e,r,n,i,o){if(!ye.isBuffer(t))throw new TypeError('"buffer" argument must be a Buffer instance');if(e>i||e<o)throw new RangeError('"value" argument is out of bounds');if(r+n>t.length)throw new RangeError("Index out of range")}ye.prototype.writeUintLE=ye.prototype.writeUIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;ic(this,e,r,n,a,0)}let o=1,s=0;for(this[r]=e&255;++s<n&&(o*=256);)this[r+s]=e/o&255;return r+n};ye.prototype.writeUintBE=ye.prototype.writeUIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,n=n>>>0,!i){let a=Math.pow(2,8*n)-1;ic(this,e,r,n,a,0)}let o=n-1,s=1;for(this[r+o]=e&255;--o>=0&&(s*=256);)this[r+o]=e/s&255;return r+n};ye.prototype.writeUint8=ye.prototype.writeUInt8=function(e,r,n){return e=+e,r=r>>>0,n||ic(this,e,r,1,255,0),this[r]=e&255,r+1};ye.prototype.writeUint16LE=ye.prototype.writeUInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||ic(this,e,r,2,65535,0),this[r]=e&255,this[r+1]=e>>>8,r+2};ye.prototype.writeUint16BE=ye.prototype.writeUInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||ic(this,e,r,2,65535,0),this[r]=e>>>8,this[r+1]=e&255,r+2};ye.prototype.writeUint32LE=ye.prototype.writeUInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||ic(this,e,r,4,4294967295,0),this[r+3]=e>>>24,this[r+2]=e>>>16,this[r+1]=e>>>8,this[r]=e&255,r+4};ye.prototype.writeUint32BE=ye.prototype.writeUInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||ic(this,e,r,4,4294967295,0),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};function JY(t,e,r,n,i){eZ(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o,o=o>>8,t[r++]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,s=s>>8,t[r++]=s,r}function YY(t,e,r,n,i){eZ(e,n,i,t,r,7);let o=Number(e&BigInt(4294967295));t[r+7]=o,o=o>>8,t[r+6]=o,o=o>>8,t[r+5]=o,o=o>>8,t[r+4]=o;let s=Number(e>>BigInt(32)&BigInt(4294967295));return t[r+3]=s,s=s>>8,t[r+2]=s,s=s>>8,t[r+1]=s,s=s>>8,t[r]=s,r+8}ye.prototype.writeBigUInt64LE=Iy(function(e,r=0){return JY(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});ye.prototype.writeBigUInt64BE=Iy(function(e,r=0){return YY(this,e,r,BigInt(0),BigInt("0xffffffffffffffff"))});ye.prototype.writeIntLE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let d=Math.pow(2,8*n-1);ic(this,e,r,n,d-1,-d)}let o=0,s=1,a=0;for(this[r]=e&255;++o<n&&(s*=256);)e<0&&a===0&&this[r+o-1]!==0&&(a=1),this[r+o]=(e/s>>0)-a&255;return r+n};ye.prototype.writeIntBE=function(e,r,n,i){if(e=+e,r=r>>>0,!i){let d=Math.pow(2,8*n-1);ic(this,e,r,n,d-1,-d)}let o=n-1,s=1,a=0;for(this[r+o]=e&255;--o>=0&&(s*=256);)e<0&&a===0&&this[r+o+1]!==0&&(a=1),this[r+o]=(e/s>>0)-a&255;return r+n};ye.prototype.writeInt8=function(e,r,n){return e=+e,r=r>>>0,n||ic(this,e,r,1,127,-128),e<0&&(e=255+e+1),this[r]=e&255,r+1};ye.prototype.writeInt16LE=function(e,r,n){return e=+e,r=r>>>0,n||ic(this,e,r,2,32767,-32768),this[r]=e&255,this[r+1]=e>>>8,r+2};ye.prototype.writeInt16BE=function(e,r,n){return e=+e,r=r>>>0,n||ic(this,e,r,2,32767,-32768),this[r]=e>>>8,this[r+1]=e&255,r+2};ye.prototype.writeInt32LE=function(e,r,n){return e=+e,r=r>>>0,n||ic(this,e,r,4,2147483647,-2147483648),this[r]=e&255,this[r+1]=e>>>8,this[r+2]=e>>>16,this[r+3]=e>>>24,r+4};ye.prototype.writeInt32BE=function(e,r,n){return e=+e,r=r>>>0,n||ic(this,e,r,4,2147483647,-2147483648),e<0&&(e=4294967295+e+1),this[r]=e>>>24,this[r+1]=e>>>16,this[r+2]=e>>>8,this[r+3]=e&255,r+4};ye.prototype.writeBigInt64LE=Iy(function(e,r=0){return JY(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});ye.prototype.writeBigInt64BE=Iy(function(e,r=0){return YY(this,e,r,-BigInt("0x8000000000000000"),BigInt("0x7fffffffffffffff"))});function ZY(t,e,r,n,i,o){if(r+n>t.length)throw new RangeError("Index out of range");if(r<0)throw new RangeError("Index out of range")}function XY(t,e,r,n,i){return e=+e,r=r>>>0,i||ZY(t,e,r,4,34028234663852886e22,-34028234663852886e22),zw.write(t,e,r,n,23,4),r+4}ye.prototype.writeFloatLE=function(e,r,n){return XY(this,e,r,!0,n)};ye.prototype.writeFloatBE=function(e,r,n){return XY(this,e,r,!1,n)};function QY(t,e,r,n,i){return e=+e,r=r>>>0,i||ZY(t,e,r,8,17976931348623157e292,-17976931348623157e292),zw.write(t,e,r,n,52,8),r+8}ye.prototype.writeDoubleLE=function(e,r,n){return QY(this,e,r,!0,n)};ye.prototype.writeDoubleBE=function(e,r,n){return QY(this,e,r,!1,n)};ye.prototype.copy=function(e,r,n,i){if(!ye.isBuffer(e))throw new TypeError("argument should be a Buffer");if(n||(n=0),!i&&i!==0&&(i=this.length),r>=e.length&&(r=e.length),r||(r=0),i>0&&i<n&&(i=n),i===n||e.length===0||this.length===0)return 0;if(r<0)throw new RangeError("targetStart out of bounds");if(n<0||n>=this.length)throw new RangeError("Index out of range");if(i<0)throw new RangeError("sourceEnd out of bounds");i>this.length&&(i=this.length),e.length-r<i-n&&(i=e.length-r+n);let o=i-n;return this===e&&typeof Uint8Array.prototype.copyWithin=="function"?this.copyWithin(r,n,i):Uint8Array.prototype.set.call(e,this.subarray(n,i),r),o};ye.prototype.fill=function(e,r,n,i){if(typeof e=="string"){if(typeof r=="string"?(i=r,r=0,n=this.length):typeof n=="string"&&(i=n,n=this.length),i!==void 0&&typeof i!="string")throw new TypeError("encoding must be a string");if(typeof i=="string"&&!ye.isEncoding(i))throw new TypeError("Unknown encoding: "+i);if(e.length===1){let s=e.charCodeAt(0);(i==="utf8"&&s<128||i==="latin1")&&(e=s)}}else typeof e=="number"?e=e&255:typeof e=="boolean"&&(e=Number(e));if(r<0||this.length<r||this.length<n)throw new RangeError("Out of range index");if(n<=r)return this;r=r>>>0,n=n===void 0?this.length:n>>>0,e||(e=0);let o;if(typeof e=="number")for(o=r;o<n;++o)this[o]=e;else{let s=ye.isBuffer(e)?e:ye.from(e,i),a=s.length;if(a===0)throw new TypeError('The value "'+e+'" is invalid for argument "value"');for(o=0;o<n-r;++o)this[o+r]=s[o%a]}return this};var Fw={};function DM(t,e,r){Fw[t]=class extends r{constructor(){super(),Object.defineProperty(this,"message",{value:e.apply(this,arguments),writable:!0,configurable:!0}),this.name=`${this.name} [${t}]`,this.stack,delete this.name}get code(){return t}set code(i){Object.defineProperty(this,"code",{configurable:!0,enumerable:!0,value:i,writable:!0})}toString(){return`${this.name} [${t}]: ${this.message}`}}}DM("ERR_BUFFER_OUT_OF_BOUNDS",function(t){return t?`${t} is outside of buffer bounds`:"Attempt to access memory outside buffer bounds"},RangeError);DM("ERR_INVALID_ARG_TYPE",function(t,e){return`The "${t}" argument must be of type number. Received type ${typeof e}`},TypeError);DM("ERR_OUT_OF_RANGE",function(t,e,r){let n=`The value of "${t}" is out of range.`,i=r;return Number.isInteger(r)&&Math.abs(r)>2**32?i=FY(String(r)):typeof r=="bigint"&&(i=String(r),(r>BigInt(2)**BigInt(32)||r<-(BigInt(2)**BigInt(32)))&&(i=FY(i)),i+="n"),n+=` It must be ${e}. Received ${i}`,n},RangeError);function FY(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function h8e(t,e,r){Vw(e,"offset"),(t[e]===void 0||t[e+r]===void 0)&&sE(e,t.length-(r+1))}function eZ(t,e,r,n,i,o){if(t>r||t<e){let s=typeof e=="bigint"?"n":"",a;throw o>3?e===0||e===BigInt(0)?a=`>= 0${s} and < 2${s} ** ${(o+1)*8}${s}`:a=`>= -(2${s} ** ${(o+1)*8-1}${s}) and < 2 ** ${(o+1)*8-1}${s}`:a=`>= ${e}${s} and <= ${r}${s}`,new Fw.ERR_OUT_OF_RANGE("value",a,t)}h8e(n,i,o)}function Vw(t,e){if(typeof t!="number")throw new Fw.ERR_INVALID_ARG_TYPE(e,"number",t)}function sE(t,e,r){throw Math.floor(t)!==t?(Vw(t,r),new Fw.ERR_OUT_OF_RANGE(r||"offset","an integer",t)):e<0?new Fw.ERR_BUFFER_OUT_OF_BOUNDS:new Fw.ERR_OUT_OF_RANGE(r||"offset",`>= ${r?1:0} and <= ${e}`,t)}var p8e=/[^+/0-9A-Za-z-_]/g;function y8e(t){if(t=t.split("=")[0],t=t.trim().replace(p8e,""),t.length<2)return"";for(;t.length%4!==0;)t=t+"=";return t}function BM(t,e){e=e||1/0;let r,n=t.length,i=null,o=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function m8e(t){let e=[];for(let r=0;r<t.length;++r)e.push(t.charCodeAt(r)&255);return e}function g8e(t,e){let r,n,i,o=[];for(let s=0;s<t.length&&!((e-=2)<0);++s)r=t.charCodeAt(s),n=r>>8,i=r%256,o.push(i),o.push(n);return o}function tZ(t){return PM.toByteArray(y8e(t))}function dT(t,e,r,n){let i;for(i=0;i<n&&!(i+r>=e.length||i>=t.length);++i)e[i+r]=t[i];return i}function Fl(t,e){return t instanceof e||t!=null&&t.constructor!=null&&t.constructor.name!=null&&t.constructor.name===e.name}function CM(t){return t!==t}var v8e=function(){let t="0123456789abcdef",e=new Array(256);for(let r=0;r<16;++r){let n=r*16;for(let i=0;i<16;++i)e[n+i]=t[r]+t[i]}return e}();function Iy(t){return typeof BigInt>"u"?b8e:t}function b8e(){throw new Error("BigInt not supported")}});var ur=W((jM,nZ)=>{f();var uT=bn(),zl=uT.Buffer;function rZ(t,e){for(var r in t)e[r]=t[r]}zl.from&&zl.alloc&&zl.allocUnsafe&&zl.allocUnsafeSlow?nZ.exports=uT:(rZ(uT,jM),jM.Buffer=vg);function vg(t,e,r){return zl(t,e,r)}vg.prototype=Object.create(zl.prototype);rZ(zl,vg);vg.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return zl(t,e,r)};vg.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=zl(t);return e!==void 0?typeof r=="string"?n.fill(e,r):n.fill(e):n.fill(0),n};vg.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return zl(t)};vg.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return uT.SlowBuffer(t)}});var bg=W((Xmt,NM)=>{"use strict";f();var $M=65536,w8e=4294967295;function _8e(){throw new Error(`Secure random number generation is not supported by this browser.
Use Chrome, Firefox or Internet Explorer 11`)}var x8e=ur().Buffer,lT=globalThis.crypto||globalThis.msCrypto;lT&&lT.getRandomValues?NM.exports=E8e:NM.exports=_8e;function E8e(t,e){if(t>w8e)throw new RangeError("requested too many random bytes");var r=x8e.allocUnsafe(t);if(t>0)if(t>$M)for(var n=0;n<t;n+=$M)lT.getRandomValues(r.slice(n,n+$M));else lT.getRandomValues(r);return typeof e=="function"?I.default.nextTick(function(){e(null,r)}):r}});var Vt=W((e0t,UM)=>{f();typeof Object.create=="function"?UM.exports=function(e,r){r&&(e.super_=r,e.prototype=Object.create(r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:UM.exports=function(e,r){if(r){e.super_=r;var n=function(){};n.prototype=r.prototype,e.prototype=new n,e.prototype.constructor=e}}});var Ba=W((r0t,KM)=>{"use strict";f();var Ww=typeof Reflect=="object"?Reflect:null,iZ=Ww&&typeof Ww.apply=="function"?Ww.apply:function(e,r,n){return Function.prototype.apply.call(e,r,n)},fT;Ww&&typeof Ww.ownKeys=="function"?fT=Ww.ownKeys:Object.getOwnPropertySymbols?fT=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:fT=function(e){return Object.getOwnPropertyNames(e)};function S8e(t){console&&console.warn&&console.warn(t)}var sZ=Number.isNaN||function(e){return e!==e};function wn(){wn.init.call(this)}KM.exports=wn;KM.exports.once=P8e;wn.EventEmitter=wn;wn.prototype._events=void 0;wn.prototype._eventsCount=0;wn.prototype._maxListeners=void 0;var oZ=10;function hT(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(wn,"defaultMaxListeners",{enumerable:!0,get:function(){return oZ},set:function(t){if(typeof t!="number"||t<0||sZ(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");oZ=t}});wn.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};wn.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||sZ(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function aZ(t){return t._maxListeners===void 0?wn.defaultMaxListeners:t._maxListeners}wn.prototype.getMaxListeners=function(){return aZ(this)};wn.prototype.emit=function(e){for(var r=[],n=1;n<arguments.length;n++)r.push(arguments[n]);var i=e==="error",o=this._events;if(o!==void 0)i=i&&o.error===void 0;else if(!i)return!1;if(i){var s;if(r.length>0&&(s=r[0]),s instanceof Error)throw s;var a=new Error("Unhandled error."+(s?" ("+s.message+")":""));throw a.context=s,a}var d=o[e];if(d===void 0)return!1;if(typeof d=="function")iZ(d,this,r);else for(var u=d.length,c=fZ(d,u),n=0;n<u;++n)iZ(c[n],this,r);return!0};function cZ(t,e,r,n){var i,o,s;if(hT(r),o=t._events,o===void 0?(o=t._events=Object.create(null),t._eventsCount=0):(o.newListener!==void 0&&(t.emit("newListener",e,r.listener?r.listener:r),o=t._events),s=o[e]),s===void 0)s=o[e]=r,++t._eventsCount;else if(typeof s=="function"?s=o[e]=n?[r,s]:[s,r]:n?s.unshift(r):s.push(r),i=aZ(t),i>0&&s.length>i&&!s.warned){s.warned=!0;var a=new Error("Possible EventEmitter memory leak detected. "+s.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");a.name="MaxListenersExceededWarning",a.emitter=t,a.type=e,a.count=s.length,S8e(a)}return t}wn.prototype.addListener=function(e,r){return cZ(this,e,r,!1)};wn.prototype.on=wn.prototype.addListener;wn.prototype.prependListener=function(e,r){return cZ(this,e,r,!0)};function T8e(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function dZ(t,e,r){var n={fired:!1,wrapFn:void 0,target:t,type:e,listener:r},i=T8e.bind(n);return i.listener=r,n.wrapFn=i,i}wn.prototype.once=function(e,r){return hT(r),this.on(e,dZ(this,e,r)),this};wn.prototype.prependOnceListener=function(e,r){return hT(r),this.prependListener(e,dZ(this,e,r)),this};wn.prototype.removeListener=function(e,r){var n,i,o,s,a;if(hT(r),i=this._events,i===void 0)return this;if(n=i[e],n===void 0)return this;if(n===r||n.listener===r)--this._eventsCount===0?this._events=Object.create(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||r));else if(typeof n!="function"){for(o=-1,s=n.length-1;s>=0;s--)if(n[s]===r||n[s].listener===r){a=n[s].listener,o=s;break}if(o<0)return this;o===0?n.shift():A8e(n,o),n.length===1&&(i[e]=n[0]),i.removeListener!==void 0&&this.emit("removeListener",e,a||r)}return this};wn.prototype.off=wn.prototype.removeListener;wn.prototype.removeAllListeners=function(e){var r,n,i;if(n=this._events,n===void 0)return this;if(n.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):n[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete n[e]),this;if(arguments.length===0){var o=Object.keys(n),s;for(i=0;i<o.length;++i)s=o[i],s!=="removeListener"&&this.removeAllListeners(s);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(r=n[e],typeof r=="function")this.removeListener(e,r);else if(r!==void 0)for(i=r.length-1;i>=0;i--)this.removeListener(e,r[i]);return this};function uZ(t,e,r){var n=t._events;if(n===void 0)return[];var i=n[e];return i===void 0?[]:typeof i=="function"?r?[i.listener||i]:[i]:r?k8e(i):fZ(i,i.length)}wn.prototype.listeners=function(e){return uZ(this,e,!0)};wn.prototype.rawListeners=function(e){return uZ(this,e,!1)};wn.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):lZ.call(t,e)};wn.prototype.listenerCount=lZ;function lZ(t){var e=this._events;if(e!==void 0){var r=e[t];if(typeof r=="function")return 1;if(r!==void 0)return r.length}return 0}wn.prototype.eventNames=function(){return this._eventsCount>0?fT(this._events):[]};function fZ(t,e){for(var r=new Array(e),n=0;n<e;++n)r[n]=t[n];return r}function A8e(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function k8e(t){for(var e=new Array(t.length),r=0;r<e.length;++r)e[r]=t[r].listener||t[r];return e}function P8e(t,e){return new Promise(function(r,n){function i(s){t.removeListener(e,o),n(s)}function o(){typeof t.removeListener=="function"&&t.removeListener("error",i),r([].slice.call(arguments))}hZ(t,e,o,{once:!0}),e!=="error"&&I8e(t,i,{once:!0})})}function I8e(t,e,r){typeof t.on=="function"&&hZ(t,"error",e,r)}function hZ(t,e,r,n){if(typeof t.on=="function")n.once?t.once(e,r):t.on(e,r);else if(typeof t.addEventListener=="function")t.addEventListener(e,function i(o){n.once&&t.removeEventListener(e,i),r(o)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}});var qM=W((i0t,pZ)=>{f();pZ.exports=Ba().EventEmitter});var aE=W(()=>{f()});var wZ=W((d0t,bZ)=>{"use strict";f();function yZ(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(i){return Object.getOwnPropertyDescriptor(t,i).enumerable})),r.push.apply(r,n)}return r}function mZ(t){for(var e=1;e<arguments.length;e++){var r=arguments[e]!=null?arguments[e]:{};e%2?yZ(Object(r),!0).forEach(function(n){R8e(t,n,r[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):yZ(Object(r)).forEach(function(n){Object.defineProperty(t,n,Object.getOwnPropertyDescriptor(r,n))})}return t}function R8e(t,e,r){return e=vZ(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function B8e(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function gZ(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,vZ(n.key),n)}}function O8e(t,e,r){return e&&gZ(t.prototype,e),r&&gZ(t,r),Object.defineProperty(t,"prototype",{writable:!1}),t}function vZ(t){var e=M8e(t,"string");return typeof e=="symbol"?e:String(e)}function M8e(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var D8e=bn(),pT=D8e.Buffer,C8e=aE(),LM=C8e.inspect,j8e=LM&&LM.custom||"inspect";function $8e(t,e,r){pT.prototype.copy.call(t,e,r)}bZ.exports=function(){function t(){B8e(this,t),this.head=null,this.tail=null,this.length=0}return O8e(t,[{key:"push",value:function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length}},{key:"unshift",value:function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length}},{key:"shift",value:function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}}},{key:"clear",value:function(){this.head=this.tail=null,this.length=0}},{key:"join",value:function(r){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i}},{key:"concat",value:function(r){if(this.length===0)return pT.alloc(0);for(var n=pT.allocUnsafe(r>>>0),i=this.head,o=0;i;)$8e(i.data,n,o),o+=i.data.length,i=i.next;return n}},{key:"consume",value:function(r,n){var i;return r<this.head.data.length?(i=this.head.data.slice(0,r),this.head.data=this.head.data.slice(r)):r===this.head.data.length?i=this.shift():i=n?this._getString(r):this._getBuffer(r),i}},{key:"first",value:function(){return this.head.data}},{key:"_getString",value:function(r){var n=this.head,i=1,o=n.data;for(r-=o.length;n=n.next;){var s=n.data,a=r>s.length?s.length:r;if(a===s.length?o+=s:o+=s.slice(0,r),r-=a,r===0){a===s.length?(++i,n.next?this.head=n.next:this.head=this.tail=null):(this.head=n,n.data=s.slice(a));break}++i}return this.length-=i,o}},{key:"_getBuffer",value:function(r){var n=pT.allocUnsafe(r),i=this.head,o=1;for(i.data.copy(n),r-=i.data.length;i=i.next;){var s=i.data,a=r>s.length?s.length:r;if(s.copy(n,n.length-r,0,a),r-=a,r===0){a===s.length?(++o,i.next?this.head=i.next:this.head=this.tail=null):(this.head=i,i.data=s.slice(a));break}++o}return this.length-=o,n}},{key:j8e,value:function(r,n){return LM(this,mZ(mZ({},n),{},{depth:0,customInspect:!1}))}}]),t}()});var zM=W((l0t,xZ)=>{"use strict";f();function N8e(t,e){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,I.default.nextTick(FM,this,t)):I.default.nextTick(FM,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?r._writableState?r._writableState.errorEmitted?I.default.nextTick(yT,r):(r._writableState.errorEmitted=!0,I.default.nextTick(_Z,r,o)):I.default.nextTick(_Z,r,o):e?(I.default.nextTick(yT,r),e(o)):I.default.nextTick(yT,r)}),this)}function _Z(t,e){FM(t,e),yT(t)}function yT(t){t._writableState&&!t._writableState.emitClose||t._readableState&&!t._readableState.emitClose||t.emit("close")}function U8e(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function FM(t,e){t.emit("error",e)}function K8e(t,e){var r=t._readableState,n=t._writableState;r&&r.autoDestroy||n&&n.autoDestroy?t.destroy(e):t.emit("error",e)}xZ.exports={destroy:N8e,undestroy:U8e,errorOrDestroy:K8e}});var wg=W((h0t,TZ)=>{"use strict";f();function q8e(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,t.__proto__=e}var SZ={};function Id(t,e,r){r||(r=Error);function n(o,s,a){return typeof e=="string"?e:e(o,s,a)}var i=function(o){q8e(s,o);function s(a,d,u){return o.call(this,n(a,d,u))||this}return s}(r);i.prototype.name=r.name,i.prototype.code=t,SZ[t]=i}function EZ(t,e){if(Array.isArray(t)){var r=t.length;return t=t.map(function(n){return String(n)}),r>2?"one of ".concat(e," ").concat(t.slice(0,r-1).join(", "),", or ")+t[r-1]:r===2?"one of ".concat(e," ").concat(t[0]," or ").concat(t[1]):"of ".concat(e," ").concat(t[0])}else return"of ".concat(e," ").concat(String(t))}function L8e(t,e,r){return t.substr(!r||r<0?0:+r,e.length)===e}function F8e(t,e,r){return(r===void 0||r>t.length)&&(r=t.length),t.substring(r-e.length,r)===e}function z8e(t,e,r){return typeof r!="number"&&(r=0),r+e.length>t.length?!1:t.indexOf(e,r)!==-1}Id("ERR_INVALID_OPT_VALUE",function(t,e){return'The value "'+e+'" is invalid for option "'+t+'"'},TypeError);Id("ERR_INVALID_ARG_TYPE",function(t,e,r){var n;typeof e=="string"&&L8e(e,"not ")?(n="must not be",e=e.replace(/^not /,"")):n="must be";var i;if(F8e(t," argument"))i="The ".concat(t," ").concat(n," ").concat(EZ(e,"type"));else{var o=z8e(t,".")?"property":"argument";i='The "'.concat(t,'" ').concat(o," ").concat(n," ").concat(EZ(e,"type"))}return i+=". Received type ".concat(typeof r),i},TypeError);Id("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF");Id("ERR_METHOD_NOT_IMPLEMENTED",function(t){return"The "+t+" method is not implemented"});Id("ERR_STREAM_PREMATURE_CLOSE","Premature close");Id("ERR_STREAM_DESTROYED",function(t){return"Cannot call "+t+" after a stream was destroyed"});Id("ERR_MULTIPLE_CALLBACK","Callback called multiple times");Id("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable");Id("ERR_STREAM_WRITE_AFTER_END","write after end");Id("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Id("ERR_UNKNOWN_ENCODING",function(t){return"Unknown encoding: "+t},TypeError);Id("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event");TZ.exports.codes=SZ});var VM=W((y0t,AZ)=>{"use strict";f();var V8e=wg().codes.ERR_INVALID_OPT_VALUE;function H8e(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function W8e(t,e,r,n){var i=H8e(e,n,r);if(i!=null){if(!(isFinite(i)&&Math.floor(i)===i)||i<0){var o=n?r:"highWaterMark";throw new V8e(o,i)}return Math.floor(i)}return t.objectMode?16:16*1024}AZ.exports={getHighWaterMark:W8e}});var WM=W((g0t,kZ)=>{f();kZ.exports=G8e;function G8e(t,e){if(HM("noDeprecation"))return t;var r=!1;function n(){if(!r){if(HM("throwDeprecation"))throw new Error(e);HM("traceDeprecation")?console.trace(e):console.warn(e),r=!0}return t.apply(this,arguments)}return n}function HM(t){try{if(!globalThis.localStorage)return!1}catch{return!1}var e=globalThis.localStorage[t];return e==null?!1:String(e).toLowerCase()==="true"}});var vT=W((b0t,MZ)=>{"use strict";f();MZ.exports=Ei;function IZ(t){var e=this;this.next=null,this.entry=null,this.finish=function(){_Te(e,t)}}var Gw;Ei.WritableState=dE;var J8e={deprecate:WM()},RZ=qM(),gT=bn().Buffer,Y8e=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function Z8e(t){return gT.from(t)}function X8e(t){return gT.isBuffer(t)||t instanceof Y8e}var JM=zM(),Q8e=VM(),eTe=Q8e.getHighWaterMark,Ry=wg().codes,tTe=Ry.ERR_INVALID_ARG_TYPE,rTe=Ry.ERR_METHOD_NOT_IMPLEMENTED,nTe=Ry.ERR_MULTIPLE_CALLBACK,iTe=Ry.ERR_STREAM_CANNOT_PIPE,oTe=Ry.ERR_STREAM_DESTROYED,sTe=Ry.ERR_STREAM_NULL_VALUES,aTe=Ry.ERR_STREAM_WRITE_AFTER_END,cTe=Ry.ERR_UNKNOWN_ENCODING,Jw=JM.errorOrDestroy;Vt()(Ei,RZ);function dTe(){}function dE(t,e,r){Gw=Gw||By(),t=t||{},typeof r!="boolean"&&(r=e instanceof Gw),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode),this.highWaterMark=eTe(this,t,"writableHighWaterMark",r),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var n=t.decodeStrings===!1;this.decodeStrings=!n,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(i){mTe(e,i)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.bufferedRequestCount=0,this.corkedRequestsFree=new IZ(this)}dE.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(dE.prototype,"buffer",{get:J8e.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var mT;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(mT=Function.prototype[Symbol.hasInstance],Object.defineProperty(Ei,Symbol.hasInstance,{value:function(e){return mT.call(this,e)?!0:this!==Ei?!1:e&&e._writableState instanceof dE}})):mT=function(e){return e instanceof this};function Ei(t){Gw=Gw||By();var e=this instanceof Gw;if(!e&&!mT.call(Ei,this))return new Ei(t);this._writableState=new dE(t,this,e),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),RZ.call(this)}Ei.prototype.pipe=function(){Jw(this,new iTe)};function uTe(t,e){var r=new aTe;Jw(t,r),I.default.nextTick(e,r)}function lTe(t,e,r,n){var i;return r===null?i=new sTe:typeof r!="string"&&!e.objectMode&&(i=new tTe("chunk",["string","Buffer"],r)),i?(Jw(t,i),I.default.nextTick(n,i),!1):!0}Ei.prototype.write=function(t,e,r){var n=this._writableState,i=!1,o=!n.objectMode&&X8e(t);return o&&!gT.isBuffer(t)&&(t=Z8e(t)),typeof e=="function"&&(r=e,e=null),o?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=dTe),n.ending?uTe(this,r):(o||lTe(this,n,t,r))&&(n.pendingcb++,i=hTe(this,n,o,t,e,r)),i};Ei.prototype.cork=function(){this._writableState.corked++};Ei.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&BZ(this,t))};Ei.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new cTe(e);return this._writableState.defaultEncoding=e,this};Object.defineProperty(Ei.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});function fTe(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=gT.from(e,r)),e}Object.defineProperty(Ei.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function hTe(t,e,r,n,i,o){if(!r){var s=fTe(e,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=e.objectMode?1:n.length;e.length+=a;var d=e.length<e.highWaterMark;if(d||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else GM(t,e,!1,a,n,i,o);return d}function GM(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new oTe("write")):r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function pTe(t,e,r,n,i){--e.pendingcb,r?(I.default.nextTick(i,n),I.default.nextTick(cE,t,e),t._writableState.errorEmitted=!0,Jw(t,n)):(i(n),t._writableState.errorEmitted=!0,Jw(t,n),cE(t,e))}function yTe(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function mTe(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function")throw new nTe;if(yTe(r),e)pTe(t,r,n,e,i);else{var o=OZ(r)||t.destroyed;!o&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&BZ(t,r),n?I.default.nextTick(PZ,t,r,o,i):PZ(t,r,o,i)}}function PZ(t,e,r,n){r||gTe(t,e),e.pendingcb--,n(),cE(t,e)}function gTe(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function BZ(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),o=e.corkedRequestsFree;o.entry=r;for(var s=0,a=!0;r;)i[s]=r,r.isBuf||(a=!1),r=r.next,s+=1;i.allBuffers=a,GM(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new IZ(e),e.bufferedRequestCount=0}else{for(;r;){var d=r.chunk,u=r.encoding,c=r.callback,l=e.objectMode?1:d.length;if(GM(t,e,!1,l,d,u,c),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}Ei.prototype._write=function(t,e,r){r(new rTe("_write()"))};Ei.prototype._writev=null;Ei.prototype.end=function(t,e,r){var n=this._writableState;return typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||wTe(this,n,r),this};Object.defineProperty(Ei.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function OZ(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function vTe(t,e){t._final(function(r){e.pendingcb--,r&&Jw(t,r),e.prefinished=!0,t.emit("prefinish"),cE(t,e)})}function bTe(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.pendingcb++,e.finalCalled=!0,I.default.nextTick(vTe,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function cE(t,e){var r=OZ(e);if(r&&(bTe(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"),e.autoDestroy))){var n=t._readableState;(!n||n.autoDestroy&&n.endEmitted)&&t.destroy()}return r}function wTe(t,e,r){e.ending=!0,cE(t,e),r&&(e.finished?I.default.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function _Te(t,e,r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree.next=t}Object.defineProperty(Ei.prototype,"destroyed",{enumerable:!1,get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(e){this._writableState&&(this._writableState.destroyed=e)}});Ei.prototype.destroy=JM.destroy;Ei.prototype._undestroy=JM.undestroy;Ei.prototype._destroy=function(t,e){e(t)}});var By=W((_0t,CZ)=>{"use strict";f();var xTe=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};CZ.exports=Vl;var DZ=_T(),ZM=vT();Vt()(Vl,DZ);for(YM=xTe(ZM.prototype),bT=0;bT<YM.length;bT++)wT=YM[bT],Vl.prototype[wT]||(Vl.prototype[wT]=ZM.prototype[wT]);var YM,wT,bT;function Vl(t){if(!(this instanceof Vl))return new Vl(t);DZ.call(this,t),ZM.call(this,t),this.allowHalfOpen=!0,t&&(t.readable===!1&&(this.readable=!1),t.writable===!1&&(this.writable=!1),t.allowHalfOpen===!1&&(this.allowHalfOpen=!1,this.once("end",ETe)))}Object.defineProperty(Vl.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});Object.defineProperty(Vl.prototype,"writableBuffer",{enumerable:!1,get:function(){return this._writableState&&this._writableState.getBuffer()}});Object.defineProperty(Vl.prototype,"writableLength",{enumerable:!1,get:function(){return this._writableState.length}});function ETe(){this._writableState.ended||I.default.nextTick(STe,this)}function STe(t){t.end()}Object.defineProperty(Vl.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(e){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=e,this._writableState.destroyed=e)}})});var Yw=W($Z=>{"use strict";f();var QM=ur().Buffer,jZ=QM.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function TTe(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function ATe(t){var e=TTe(t);if(typeof e!="string"&&(QM.isEncoding===jZ||!jZ(t)))throw new Error("Unknown encoding: "+t);return e||t}$Z.StringDecoder=uE;function uE(t){this.encoding=ATe(t);var e;switch(this.encoding){case"utf16le":this.text=OTe,this.end=MTe,e=4;break;case"utf8":this.fillLast=ITe,e=4;break;case"base64":this.text=DTe,this.end=CTe,e=3;break;default:this.write=jTe,this.end=$Te;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=QM.allocUnsafe(e)}uE.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};uE.prototype.end=BTe;uE.prototype.text=RTe;uE.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function XM(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function kTe(t,e,r){var n=e.length-1;if(n<r)return 0;var i=XM(e[n]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--n<r||i===-2?0:(i=XM(e[n]),i>=0?(i>0&&(t.lastNeed=i-2),i):--n<r||i===-2?0:(i=XM(e[n]),i>=0?(i>0&&(i===2?i=0:t.lastNeed=i-3),i):0))}function PTe(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function ITe(t){var e=this.lastTotal-this.lastNeed,r=PTe(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function RTe(t,e){var r=kTe(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function BTe(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function OTe(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function MTe(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function DTe(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function CTe(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function jTe(t){return t.toString(this.encoding)}function $Te(t){return t&&t.length?this.write(t):""}});var lE=W((T0t,KZ)=>{"use strict";f();var NZ=wg().codes.ERR_STREAM_PREMATURE_CLOSE;function NTe(t){var e=!1;return function(){if(!e){e=!0;for(var r=arguments.length,n=new Array(r),i=0;i<r;i++)n[i]=arguments[i];t.apply(this,n)}}}function UTe(){}function KTe(t){return t.setHeader&&typeof t.abort=="function"}function UZ(t,e,r){if(typeof e=="function")return UZ(t,null,e);e||(e={}),r=NTe(r||UTe);var n=e.readable||e.readable!==!1&&t.readable,i=e.writable||e.writable!==!1&&t.writable,o=function(){t.writable||a()},s=t._writableState&&t._writableState.finished,a=function(){i=!1,s=!0,n||r.call(t)},d=t._readableState&&t._readableState.endEmitted,u=function(){n=!1,d=!0,i||r.call(t)},c=function(g){r.call(t,g)},l=function(){var g;if(n&&!d)return(!t._readableState||!t._readableState.ended)&&(g=new NZ),r.call(t,g);if(i&&!s)return(!t._writableState||!t._writableState.ended)&&(g=new NZ),r.call(t,g)},h=function(){t.req.on("finish",a)};return KTe(t)?(t.on("complete",a),t.on("abort",l),t.req?h():t.on("request",h)):i&&!t._writableState&&(t.on("end",o),t.on("close",o)),t.on("end",u),t.on("finish",a),e.error!==!1&&t.on("error",c),t.on("close",l),function(){t.removeListener("complete",a),t.removeListener("abort",l),t.removeListener("request",h),t.req&&t.req.removeListener("finish",a),t.removeListener("end",o),t.removeListener("close",o),t.removeListener("finish",a),t.removeListener("end",u),t.removeListener("error",c),t.removeListener("close",l)}}KZ.exports=UZ});var LZ=W((k0t,qZ)=>{"use strict";f();var xT;function Oy(t,e,r){return e=qTe(e),e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function qTe(t){var e=LTe(t,"string");return typeof e=="symbol"?e:String(e)}function LTe(t,e){if(typeof t!="object"||t===null)return t;var r=t[Symbol.toPrimitive];if(r!==void 0){var n=r.call(t,e||"default");if(typeof n!="object")return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}var FTe=lE(),My=Symbol("lastResolve"),_g=Symbol("lastReject"),fE=Symbol("error"),ET=Symbol("ended"),xg=Symbol("lastPromise"),e7=Symbol("handlePromise"),Eg=Symbol("stream");function Dy(t,e){return{value:t,done:e}}function zTe(t){var e=t[My];if(e!==null){var r=t[Eg].read();r!==null&&(t[xg]=null,t[My]=null,t[_g]=null,e(Dy(r,!1)))}}function VTe(t){I.default.nextTick(zTe,t)}function HTe(t,e){return function(r,n){t.then(function(){if(e[ET]){r(Dy(void 0,!0));return}e[e7](r,n)},n)}}var WTe=Object.getPrototypeOf(function(){}),GTe=Object.setPrototypeOf((xT={get stream(){return this[Eg]},next:function(){var e=this,r=this[fE];if(r!==null)return Promise.reject(r);if(this[ET])return Promise.resolve(Dy(void 0,!0));if(this[Eg].destroyed)return new Promise(function(s,a){I.default.nextTick(function(){e[fE]?a(e[fE]):s(Dy(void 0,!0))})});var n=this[xg],i;if(n)i=new Promise(HTe(n,this));else{var o=this[Eg].read();if(o!==null)return Promise.resolve(Dy(o,!1));i=new Promise(this[e7])}return this[xg]=i,i}},Oy(xT,Symbol.asyncIterator,function(){return this}),Oy(xT,"return",function(){var e=this;return new Promise(function(r,n){e[Eg].destroy(null,function(i){if(i){n(i);return}r(Dy(void 0,!0))})})}),xT),WTe),JTe=function(e){var r,n=Object.create(GTe,(r={},Oy(r,Eg,{value:e,writable:!0}),Oy(r,My,{value:null,writable:!0}),Oy(r,_g,{value:null,writable:!0}),Oy(r,fE,{value:null,writable:!0}),Oy(r,ET,{value:e._readableState.endEmitted,writable:!0}),Oy(r,e7,{value:function(o,s){var a=n[Eg].read();a?(n[xg]=null,n[My]=null,n[_g]=null,o(Dy(a,!1))):(n[My]=o,n[_g]=s)},writable:!0}),r));return n[xg]=null,FTe(e,function(i){if(i&&i.code!=="ERR_STREAM_PREMATURE_CLOSE"){var o=n[_g];o!==null&&(n[xg]=null,n[My]=null,n[_g]=null,o(i)),n[fE]=i;return}var s=n[My];s!==null&&(n[xg]=null,n[My]=null,n[_g]=null,s(Dy(void 0,!0))),n[ET]=!0}),e.on("readable",VTe.bind(null,n)),n};qZ.exports=JTe});var zZ=W((I0t,FZ)=>{f();FZ.exports=function(){throw new Error("Readable.from is not available in the browser")}});var _T=W((O0t,eX)=>{"use strict";f();eX.exports=Jr;var Zw;Jr.ReadableState=GZ;var B0t=Ba().EventEmitter,WZ=function(e,r){return e.listeners(r).length},pE=qM(),ST=bn().Buffer,YTe=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function ZTe(t){return ST.from(t)}function XTe(t){return ST.isBuffer(t)||t instanceof YTe}var t7=aE(),Pr;t7&&t7.debuglog?Pr=t7.debuglog("stream"):Pr=function(){};var QTe=wZ(),c7=zM(),eAe=VM(),tAe=eAe.getHighWaterMark,TT=wg().codes,rAe=TT.ERR_INVALID_ARG_TYPE,nAe=TT.ERR_STREAM_PUSH_AFTER_EOF,iAe=TT.ERR_METHOD_NOT_IMPLEMENTED,oAe=TT.ERR_STREAM_UNSHIFT_AFTER_END_EVENT,Xw,r7,n7;Vt()(Jr,pE);var hE=c7.errorOrDestroy,i7=["error","close","destroy","pause","resume"];function sAe(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):Array.isArray(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function GZ(t,e,r){Zw=Zw||By(),t=t||{},typeof r!="boolean"&&(r=e instanceof Zw),this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode),this.highWaterMark=tAe(this,t,"readableHighWaterMark",r),this.buffer=new QTe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.paused=!0,this.emitClose=t.emitClose!==!1,this.autoDestroy=!!t.autoDestroy,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(Xw||(Xw=Yw().StringDecoder),this.decoder=new Xw(t.encoding),this.encoding=t.encoding)}function Jr(t){if(Zw=Zw||By(),!(this instanceof Jr))return new Jr(t);var e=this instanceof Zw;this._readableState=new GZ(t,this,e),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),pE.call(this)}Object.defineProperty(Jr.prototype,"destroyed",{enumerable:!1,get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(e){this._readableState&&(this._readableState.destroyed=e)}});Jr.prototype.destroy=c7.destroy;Jr.prototype._undestroy=c7.undestroy;Jr.prototype._destroy=function(t,e){e(t)};Jr.prototype.push=function(t,e){var r=this._readableState,n;return r.objectMode?n=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=ST.from(t,e),e=""),n=!0),JZ(this,t,e,!1,n)};Jr.prototype.unshift=function(t){return JZ(this,t,null,!0,!1)};function JZ(t,e,r,n,i){Pr("readableAddChunk",e);var o=t._readableState;if(e===null)o.reading=!1,dAe(t,o);else{var s;if(i||(s=aAe(o,e)),s)hE(t,s);else if(o.objectMode||e&&e.length>0)if(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==ST.prototype&&(e=ZTe(e)),n)o.endEmitted?hE(t,new oAe):o7(t,o,e,!0);else if(o.ended)hE(t,new nAe);else{if(o.destroyed)return!1;o.reading=!1,o.decoder&&!r?(e=o.decoder.write(e),o.objectMode||e.length!==0?o7(t,o,e,!1):a7(t,o)):o7(t,o,e,!1)}else n||(o.reading=!1,a7(t,o))}return!o.ended&&(o.length<o.highWaterMark||o.length===0)}function o7(t,e,r,n){e.flowing&&e.length===0&&!e.sync?(e.awaitDrain=0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&AT(t)),a7(t,e)}function aAe(t,e){var r;return!XTe(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new rAe("chunk",["string","Buffer","Uint8Array"],e)),r}Jr.prototype.isPaused=function(){return this._readableState.flowing===!1};Jr.prototype.setEncoding=function(t){Xw||(Xw=Yw().StringDecoder);var e=new Xw(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;for(var r=this._readableState.buffer.head,n="";r!==null;)n+=e.write(r.data),r=r.next;return this._readableState.buffer.clear(),n!==""&&this._readableState.buffer.push(n),this._readableState.length=n.length,this};var VZ=1073741824;function cAe(t){return t>=VZ?t=VZ:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function HZ(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=cAe(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Jr.prototype.read=function(t){Pr("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return Pr("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?s7(this):AT(this),null;if(t=HZ(t,e),t===0&&e.ended)return e.length===0&&s7(this),null;var n=e.needReadable;Pr("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,Pr("length less than watermark",n)),e.ended||e.reading?(n=!1,Pr("reading or ended",n)):n&&(Pr("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=HZ(r,e)));var i;return t>0?i=XZ(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.awaitDrain=0),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&s7(this)),i!==null&&this.emit("data",i),i};function dAe(t,e){if(Pr("onEofChunk"),!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?AT(t):(e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,YZ(t)))}}function AT(t){var e=t._readableState;Pr("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(Pr("emitReadable",e.flowing),e.emittedReadable=!0,I.default.nextTick(YZ,t))}function YZ(t){var e=t._readableState;Pr("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,d7(t)}function a7(t,e){e.readingMore||(e.readingMore=!0,I.default.nextTick(uAe,t,e))}function uAe(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){var r=e.length;if(Pr("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}Jr.prototype._read=function(t){hE(this,new iAe("_read()"))};Jr.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,Pr("pipe count=%d opts=%j",n.pipesCount,e);var i=(!e||e.end!==!1)&&t!==I.default.stdout&&t!==I.default.stderr,o=i?a:v;n.endEmitted?I.default.nextTick(o):r.once("end",o),t.on("unpipe",s);function s(x,S){Pr("onunpipe"),x===r&&S&&S.hasUnpiped===!1&&(S.hasUnpiped=!0,c())}function a(){Pr("onend"),t.end()}var d=lAe(r);t.on("drain",d);var u=!1;function c(){Pr("cleanup"),t.removeListener("close",y),t.removeListener("finish",g),t.removeListener("drain",d),t.removeListener("error",h),t.removeListener("unpipe",s),r.removeListener("end",a),r.removeListener("end",v),r.removeListener("data",l),u=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&d()}r.on("data",l);function l(x){Pr("ondata");var S=t.write(x);Pr("dest.write",S),S===!1&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&QZ(n.pipes,t)!==-1)&&!u&&(Pr("false write response, pause",n.awaitDrain),n.awaitDrain++),r.pause())}function h(x){Pr("onerror",x),v(),t.removeListener("error",h),WZ(t,"error")===0&&hE(t,x)}sAe(t,"error",h);function y(){t.removeListener("finish",g),v()}t.once("close",y);function g(){Pr("onfinish"),t.removeListener("close",y),v()}t.once("finish",g);function v(){Pr("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||(Pr("pipe resume"),r.resume()),t};function lAe(t){return function(){var r=t._readableState;Pr("pipeOnDrain",r.awaitDrain),r.awaitDrain&&r.awaitDrain--,r.awaitDrain===0&&WZ(t,"data")&&(r.flowing=!0,d7(t))}}Jr.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=QZ(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};Jr.prototype.on=function(t,e){var r=pE.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,Pr("on readable",n.length,n.reading),n.length?AT(this):n.reading||I.default.nextTick(fAe,this)),r};Jr.prototype.addListener=Jr.prototype.on;Jr.prototype.removeListener=function(t,e){var r=pE.prototype.removeListener.call(this,t,e);return t==="readable"&&I.default.nextTick(ZZ,this),r};Jr.prototype.removeAllListeners=function(t){var e=pE.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&I.default.nextTick(ZZ,this),e};function ZZ(t){var e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&!e.paused?e.flowing=!0:t.listenerCount("data")>0&&t.resume()}function fAe(t){Pr("readable nexttick read 0"),t.read(0)}Jr.prototype.resume=function(){var t=this._readableState;return t.flowing||(Pr("resume"),t.flowing=!t.readableListening,hAe(this,t)),t.paused=!1,this};function hAe(t,e){e.resumeScheduled||(e.resumeScheduled=!0,I.default.nextTick(pAe,t,e))}function pAe(t,e){Pr("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),d7(t),e.flowing&&!e.reading&&t.read(0)}Jr.prototype.pause=function(){return Pr("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Pr("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState.paused=!0,this};function d7(t){var e=t._readableState;for(Pr("flow",e.flowing);e.flowing&&t.read()!==null;);}Jr.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;t.on("end",function(){if(Pr("wrapped end"),r.decoder&&!r.ended){var s=r.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(Pr("wrapped data"),r.decoder&&(s=r.decoder.write(s)),!(r.objectMode&&s==null)&&!(!r.objectMode&&(!s||!s.length))){var a=e.push(s);a||(n=!0,t.pause())}});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(a){return function(){return t[a].apply(t,arguments)}}(i));for(var o=0;o<i7.length;o++)t.on(i7[o],this.emit.bind(this,i7[o]));return this._read=function(s){Pr("wrapped _read",s),n&&(n=!1,t.resume())},this};typeof Symbol=="function"&&(Jr.prototype[Symbol.asyncIterator]=function(){return r7===void 0&&(r7=LZ()),r7(this)});Object.defineProperty(Jr.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Object.defineProperty(Jr.prototype,"readableBuffer",{enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}});Object.defineProperty(Jr.prototype,"readableFlowing",{enumerable:!1,get:function(){return this._readableState.flowing},set:function(e){this._readableState&&(this._readableState.flowing=e)}});Jr._fromList=XZ;Object.defineProperty(Jr.prototype,"readableLength",{enumerable:!1,get:function(){return this._readableState.length}});function XZ(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function s7(t){var e=t._readableState;Pr("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,I.default.nextTick(yAe,e,t))}function yAe(t,e){if(Pr("endReadableNT",t.endEmitted,t.length),!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"),t.autoDestroy)){var r=e._writableState;(!r||r.autoDestroy&&r.finished)&&e.destroy()}}typeof Symbol=="function"&&(Jr.from=function(t,e){return n7===void 0&&(n7=zZ()),n7(Jr,t,e)});function QZ(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}});var IT=W((D0t,rX)=>{"use strict";f();rX.exports=Eh;var kT=wg().codes,mAe=kT.ERR_METHOD_NOT_IMPLEMENTED,gAe=kT.ERR_MULTIPLE_CALLBACK,vAe=kT.ERR_TRANSFORM_ALREADY_TRANSFORMING,bAe=kT.ERR_TRANSFORM_WITH_LENGTH_0,PT=By();Vt()(Eh,PT);function wAe(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(n===null)return this.emit("error",new gAe);r.writechunk=null,r.writecb=null,e!=null&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Eh(t){if(!(this instanceof Eh))return new Eh(t);PT.call(this,t),this._transformState={afterTransform:wAe.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",_Ae)}function _Ae(){var t=this;typeof this._flush=="function"&&!this._readableState.destroyed?this._flush(function(e,r){tX(t,e,r)}):tX(this,null,null)}Eh.prototype.push=function(t,e){return this._transformState.needTransform=!1,PT.prototype.push.call(this,t,e)};Eh.prototype._transform=function(t,e,r){r(new mAe("_transform()"))};Eh.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};Eh.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Eh.prototype._destroy=function(t,e){PT.prototype._destroy.call(this,t,function(r){e(r)})};function tX(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new bAe;if(t._transformState.transforming)throw new vAe;return t.push(null)}});var u7=W((j0t,iX)=>{"use strict";f();iX.exports=yE;var nX=IT();Vt()(yE,nX);function yE(t){if(!(this instanceof yE))return new yE(t);nX.call(this,t)}yE.prototype._transform=function(t,e,r){r(null,t)}});var f7=W((N0t,cX)=>{"use strict";f();var l7;function xAe(t){var e=!1;return function(){e||(e=!0,t.apply(void 0,arguments))}}var aX=wg().codes,EAe=aX.ERR_MISSING_ARGS,SAe=aX.ERR_STREAM_DESTROYED;function oX(t){if(t)throw t}function TAe(t){return t.setHeader&&typeof t.abort=="function"}function AAe(t,e,r,n){n=xAe(n);var i=!1;t.on("close",function(){i=!0}),l7===void 0&&(l7=lE()),l7(t,{readable:e,writable:r},function(s){if(s)return n(s);i=!0,n()});var o=!1;return function(s){if(!i&&!o){if(o=!0,TAe(t))return t.abort();if(typeof t.destroy=="function")return t.destroy();n(s||new SAe("pipe"))}}}function sX(t){t()}function kAe(t,e){return t.pipe(e)}function PAe(t){return!t.length||typeof t[t.length-1]!="function"?oX:t.pop()}function IAe(){for(var t=arguments.length,e=new Array(t),r=0;r<t;r++)e[r]=arguments[r];var n=PAe(e);if(Array.isArray(e[0])&&(e=e[0]),e.length<2)throw new EAe("streams");var i,o=e.map(function(s,a){var d=a<e.length-1,u=a>0;return AAe(s,d,u,function(c){i||(i=c),c&&o.forEach(sX),!d&&(o.forEach(sX),n(i))})});return e.reduce(kAe)}cX.exports=IAe});var h7=W((Rd,dX)=>{f();Rd=dX.exports=_T();Rd.Stream=Rd;Rd.Readable=Rd;Rd.Writable=vT();Rd.Duplex=By();Rd.Transform=IT();Rd.PassThrough=u7();Rd.finished=lE();Rd.pipeline=f7()});var p7=W((q0t,lX)=>{"use strict";f();var RT=ur().Buffer,uX=h7().Transform,RAe=Vt();function BAe(t,e){if(!RT.isBuffer(t)&&typeof t!="string")throw new TypeError(e+" must be a string or a buffer")}function Cy(t){uX.call(this),this._block=RT.allocUnsafe(t),this._blockSize=t,this._blockOffset=0,this._length=[0,0,0,0],this._finalized=!1}RAe(Cy,uX);Cy.prototype._transform=function(t,e,r){var n=null;try{this.update(t,e)}catch(i){n=i}r(n)};Cy.prototype._flush=function(t){var e=null;try{this.push(this.digest())}catch(r){e=r}t(e)};Cy.prototype.update=function(t,e){if(BAe(t,"Data"),this._finalized)throw new Error("Digest already called");RT.isBuffer(t)||(t=RT.from(t,e));for(var r=this._block,n=0;this._blockOffset+t.length-n>=this._blockSize;){for(var i=this._blockOffset;i<this._blockSize;)r[i++]=t[n++];this._update(),this._blockOffset=0}for(;n<t.length;)r[this._blockOffset++]=t[n++];for(var o=0,s=t.length*8;s>0;++o)this._length[o]+=s,s=this._length[o]/4294967296|0,s>0&&(this._length[o]-=4294967296*s);return this};Cy.prototype._update=function(){throw new Error("_update is not implemented")};Cy.prototype.digest=function(t){if(this._finalized)throw new Error("Digest already called");this._finalized=!0;var e=this._digest();t!==void 0&&(e=e.toString(t)),this._block.fill(0),this._blockOffset=0;for(var r=0;r<4;++r)this._length[r]=0;return e};Cy.prototype._digest=function(){throw new Error("_digest is not implemented")};lX.exports=Cy});var MT=W((F0t,hX)=>{"use strict";f();var OAe=Vt(),fX=p7(),MAe=ur().Buffer,DAe=new Array(16);function BT(){fX.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878}OAe(BT,fX);BT.prototype._update=function(){for(var t=DAe,e=0;e<16;++e)t[e]=this._block.readInt32LE(e*4);var r=this._a,n=this._b,i=this._c,o=this._d;r=Xs(r,n,i,o,t[0],3614090360,7),o=Xs(o,r,n,i,t[1],3905402710,12),i=Xs(i,o,r,n,t[2],606105819,17),n=Xs(n,i,o,r,t[3],3250441966,22),r=Xs(r,n,i,o,t[4],4118548399,7),o=Xs(o,r,n,i,t[5],1200080426,12),i=Xs(i,o,r,n,t[6],2821735955,17),n=Xs(n,i,o,r,t[7],4249261313,22),r=Xs(r,n,i,o,t[8],1770035416,7),o=Xs(o,r,n,i,t[9],2336552879,12),i=Xs(i,o,r,n,t[10],4294925233,17),n=Xs(n,i,o,r,t[11],2304563134,22),r=Xs(r,n,i,o,t[12],1804603682,7),o=Xs(o,r,n,i,t[13],4254626195,12),i=Xs(i,o,r,n,t[14],2792965006,17),n=Xs(n,i,o,r,t[15],1236535329,22),r=Qs(r,n,i,o,t[1],4129170786,5),o=Qs(o,r,n,i,t[6],3225465664,9),i=Qs(i,o,r,n,t[11],643717713,14),n=Qs(n,i,o,r,t[0],3921069994,20),r=Qs(r,n,i,o,t[5],3593408605,5),o=Qs(o,r,n,i,t[10],38016083,9),i=Qs(i,o,r,n,t[15],3634488961,14),n=Qs(n,i,o,r,t[4],3889429448,20),r=Qs(r,n,i,o,t[9],568446438,5),o=Qs(o,r,n,i,t[14],3275163606,9),i=Qs(i,o,r,n,t[3],4107603335,14),n=Qs(n,i,o,r,t[8],1163531501,20),r=Qs(r,n,i,o,t[13],2850285829,5),o=Qs(o,r,n,i,t[2],4243563512,9),i=Qs(i,o,r,n,t[7],1735328473,14),n=Qs(n,i,o,r,t[12],2368359562,20),r=ea(r,n,i,o,t[5],4294588738,4),o=ea(o,r,n,i,t[8],2272392833,11),i=ea(i,o,r,n,t[11],1839030562,16),n=ea(n,i,o,r,t[14],4259657740,23),r=ea(r,n,i,o,t[1],2763975236,4),o=ea(o,r,n,i,t[4],1272893353,11),i=ea(i,o,r,n,t[7],4139469664,16),n=ea(n,i,o,r,t[10],3200236656,23),r=ea(r,n,i,o,t[13],681279174,4),o=ea(o,r,n,i,t[0],3936430074,11),i=ea(i,o,r,n,t[3],3572445317,16),n=ea(n,i,o,r,t[6],76029189,23),r=ea(r,n,i,o,t[9],3654602809,4),o=ea(o,r,n,i,t[12],3873151461,11),i=ea(i,o,r,n,t[15],530742520,16),n=ea(n,i,o,r,t[2],3299628645,23),r=ta(r,n,i,o,t[0],4096336452,6),o=ta(o,r,n,i,t[7],1126891415,10),i=ta(i,o,r,n,t[14],2878612391,15),n=ta(n,i,o,r,t[5],4237533241,21),r=ta(r,n,i,o,t[12],1700485571,6),o=ta(o,r,n,i,t[3],2399980690,10),i=ta(i,o,r,n,t[10],4293915773,15),n=ta(n,i,o,r,t[1],2240044497,21),r=ta(r,n,i,o,t[8],1873313359,6),o=ta(o,r,n,i,t[15],4264355552,10),i=ta(i,o,r,n,t[6],2734768916,15),n=ta(n,i,o,r,t[13],1309151649,21),r=ta(r,n,i,o,t[4],4149444226,6),o=ta(o,r,n,i,t[11],3174756917,10),i=ta(i,o,r,n,t[2],718787259,15),n=ta(n,i,o,r,t[9],3951481745,21),this._a=this._a+r|0,this._b=this._b+n|0,this._c=this._c+i|0,this._d=this._d+o|0};BT.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=MAe.allocUnsafe(16);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t};function OT(t,e){return t<<e|t>>>32-e}function Xs(t,e,r,n,i,o,s){return OT(t+(e&r|~e&n)+i+o|0,s)+e|0}function Qs(t,e,r,n,i,o,s){return OT(t+(e&n|r&~n)+i+o|0,s)+e|0}function ea(t,e,r,n,i,o,s){return OT(t+(e^r^n)+i+o|0,s)+e|0}function ta(t,e,r,n,i,o,s){return OT(t+(r^(e|~n))+i+o|0,s)+e|0}hX.exports=BT});var CT=W((V0t,wX)=>{"use strict";f();var y7=bn().Buffer,CAe=Vt(),bX=p7(),jAe=new Array(16),mE=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],gE=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],vE=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],bE=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11],wE=[0,1518500249,1859775393,2400959708,2840853838],_E=[1352829926,1548603684,1836072691,2053994217,0];function DT(){bX.call(this,64),this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520}CAe(DT,bX);DT.prototype._update=function(){for(var t=jAe,e=0;e<16;++e)t[e]=this._block.readInt32LE(e*4);for(var r=this._a|0,n=this._b|0,i=this._c|0,o=this._d|0,s=this._e|0,a=this._a|0,d=this._b|0,u=this._c|0,c=this._d|0,l=this._e|0,h=0;h<80;h+=1){var y,g;h<16?(y=pX(r,n,i,o,s,t[mE[h]],wE[0],vE[h]),g=vX(a,d,u,c,l,t[gE[h]],_E[0],bE[h])):h<32?(y=yX(r,n,i,o,s,t[mE[h]],wE[1],vE[h]),g=gX(a,d,u,c,l,t[gE[h]],_E[1],bE[h])):h<48?(y=mX(r,n,i,o,s,t[mE[h]],wE[2],vE[h]),g=mX(a,d,u,c,l,t[gE[h]],_E[2],bE[h])):h<64?(y=gX(r,n,i,o,s,t[mE[h]],wE[3],vE[h]),g=yX(a,d,u,c,l,t[gE[h]],_E[3],bE[h])):(y=vX(r,n,i,o,s,t[mE[h]],wE[4],vE[h]),g=pX(a,d,u,c,l,t[gE[h]],_E[4],bE[h])),r=s,s=o,o=Sg(i,10),i=n,n=y,a=l,l=c,c=Sg(u,10),u=d,d=g}var v=this._b+i+c|0;this._b=this._c+o+l|0,this._c=this._d+s+a|0,this._d=this._e+r+d|0,this._e=this._a+n+u|0,this._a=v};DT.prototype._digest=function(){this._block[this._blockOffset++]=128,this._blockOffset>56&&(this._block.fill(0,this._blockOffset,64),this._update(),this._blockOffset=0),this._block.fill(0,this._blockOffset,56),this._block.writeUInt32LE(this._length[0],56),this._block.writeUInt32LE(this._length[1],60),this._update();var t=y7.alloc?y7.alloc(20):new y7(20);return t.writeInt32LE(this._a,0),t.writeInt32LE(this._b,4),t.writeInt32LE(this._c,8),t.writeInt32LE(this._d,12),t.writeInt32LE(this._e,16),t};function Sg(t,e){return t<<e|t>>>32-e}function pX(t,e,r,n,i,o,s,a){return Sg(t+(e^r^n)+o+s|0,a)+i|0}function yX(t,e,r,n,i,o,s,a){return Sg(t+(e&r|~e&n)+o+s|0,a)+i|0}function mX(t,e,r,n,i,o,s,a){return Sg(t+((e|~r)^n)+o+s|0,a)+i|0}function gX(t,e,r,n,i,o,s,a){return Sg(t+(e&n|r&~n)+o+s|0,a)+i|0}function vX(t,e,r,n,i,o,s,a){return Sg(t+(e^(r|~n))+o+s|0,a)+i|0}wX.exports=DT});var Tg=W((W0t,xX)=>{f();var _X=ur().Buffer;function jT(t,e){this._block=_X.alloc(t),this._finalSize=e,this._blockSize=t,this._len=0}jT.prototype.update=function(t,e){typeof t=="string"&&(e=e||"utf8",t=_X.from(t,e));for(var r=this._block,n=this._blockSize,i=t.length,o=this._len,s=0;s<i;){for(var a=o%n,d=Math.min(i-s,n-a),u=0;u<d;u++)r[a+u]=t[s+u];o+=d,s+=d,o%n===0&&this._update(r)}return this._len+=i,this};jT.prototype.digest=function(t){var e=this._len%this._blockSize;this._block[e]=128,this._block.fill(0,e+1),e>=this._finalSize&&(this._update(this._block),this._block.fill(0));var r=this._len*8;if(r<=4294967295)this._block.writeUInt32BE(r,this._blockSize-4);else{var n=(r&4294967295)>>>0,i=(r-n)/4294967296;this._block.writeUInt32BE(i,this._blockSize-8),this._block.writeUInt32BE(n,this._blockSize-4)}this._update(this._block);var o=this._hash();return t?o.toString(t):o};jT.prototype._update=function(){throw new Error("_update must be implemented by subclass")};xX.exports=jT});var TX=W((J0t,SX)=>{f();var $Ae=Vt(),EX=Tg(),NAe=ur().Buffer,UAe=[1518500249,1859775393,-1894007588,-899497514],KAe=new Array(80);function xE(){this.init(),this._w=KAe,EX.call(this,64,56)}$Ae(xE,EX);xE.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function qAe(t){return t<<5|t>>>27}function LAe(t){return t<<30|t>>>2}function FAe(t,e,r,n){return t===0?e&r|~e&n:t===2?e&r|e&n|r&n:e^r^n}xE.prototype._update=function(t){for(var e=this._w,r=this._a|0,n=this._b|0,i=this._c|0,o=this._d|0,s=this._e|0,a=0;a<16;++a)e[a]=t.readInt32BE(a*4);for(;a<80;++a)e[a]=e[a-3]^e[a-8]^e[a-14]^e[a-16];for(var d=0;d<80;++d){var u=~~(d/20),c=qAe(r)+FAe(u,n,i,o)+s+e[d]+UAe[u]|0;s=o,o=i,i=LAe(n),n=r,r=c}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=s+this._e|0};xE.prototype._hash=function(){var t=NAe.allocUnsafe(20);return t.writeInt32BE(this._a|0,0),t.writeInt32BE(this._b|0,4),t.writeInt32BE(this._c|0,8),t.writeInt32BE(this._d|0,12),t.writeInt32BE(this._e|0,16),t};SX.exports=xE});var PX=W((Z0t,kX)=>{f();var zAe=Vt(),AX=Tg(),VAe=ur().Buffer,HAe=[1518500249,1859775393,-1894007588,-899497514],WAe=new Array(80);function EE(){this.init(),this._w=WAe,AX.call(this,64,56)}zAe(EE,AX);EE.prototype.init=function(){return this._a=1732584193,this._b=4023233417,this._c=2562383102,this._d=271733878,this._e=3285377520,this};function GAe(t){return t<<1|t>>>31}function JAe(t){return t<<5|t>>>27}function YAe(t){return t<<30|t>>>2}function ZAe(t,e,r,n){return t===0?e&r|~e&n:t===2?e&r|e&n|r&n:e^r^n}EE.prototype._update=function(t){for(var e=this._w,r=this._a|0,n=this._b|0,i=this._c|0,o=this._d|0,s=this._e|0,a=0;a<16;++a)e[a]=t.readInt32BE(a*4);for(;a<80;++a)e[a]=GAe(e[a-3]^e[a-8]^e[a-14]^e[a-16]);for(var d=0;d<80;++d){var u=~~(d/20),c=JAe(r)+ZAe(u,n,i,o)+s+e[d]+HAe[u]|0;s=o,o=i,i=YAe(n),n=r,r=c}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=s+this._e|0};EE.prototype._hash=function(){var t=VAe.allocUnsafe(20);return t.writeInt32BE(this._a|0,0),t.writeInt32BE(this._b|0,4),t.writeInt32BE(this._c|0,8),t.writeInt32BE(this._d|0,12),t.writeInt32BE(this._e|0,16),t};kX.exports=EE});var m7=W((Q0t,RX)=>{f();var XAe=Vt(),IX=Tg(),QAe=ur().Buffer,e4e=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298],t4e=new Array(64);function SE(){this.init(),this._w=t4e,IX.call(this,64,56)}XAe(SE,IX);SE.prototype.init=function(){return this._a=1779033703,this._b=3144134277,this._c=1013904242,this._d=2773480762,this._e=1359893119,this._f=2600822924,this._g=528734635,this._h=1541459225,this};function r4e(t,e,r){return r^t&(e^r)}function n4e(t,e,r){return t&e|r&(t|e)}function i4e(t){return(t>>>2|t<<30)^(t>>>13|t<<19)^(t>>>22|t<<10)}function o4e(t){return(t>>>6|t<<26)^(t>>>11|t<<21)^(t>>>25|t<<7)}function s4e(t){return(t>>>7|t<<25)^(t>>>18|t<<14)^t>>>3}function a4e(t){return(t>>>17|t<<15)^(t>>>19|t<<13)^t>>>10}SE.prototype._update=function(t){for(var e=this._w,r=this._a|0,n=this._b|0,i=this._c|0,o=this._d|0,s=this._e|0,a=this._f|0,d=this._g|0,u=this._h|0,c=0;c<16;++c)e[c]=t.readInt32BE(c*4);for(;c<64;++c)e[c]=a4e(e[c-2])+e[c-7]+s4e(e[c-15])+e[c-16]|0;for(var l=0;l<64;++l){var h=u+o4e(s)+r4e(s,a,d)+e4e[l]+e[l]|0,y=i4e(r)+n4e(r,n,i)|0;u=d,d=a,a=s,s=o+h|0,o=i,i=n,n=r,r=h+y|0}this._a=r+this._a|0,this._b=n+this._b|0,this._c=i+this._c|0,this._d=o+this._d|0,this._e=s+this._e|0,this._f=a+this._f|0,this._g=d+this._g|0,this._h=u+this._h|0};SE.prototype._hash=function(){var t=QAe.allocUnsafe(32);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t.writeInt32BE(this._h,28),t};RX.exports=SE});var OX=W((tgt,BX)=>{f();var c4e=Vt(),d4e=m7(),u4e=Tg(),l4e=ur().Buffer,f4e=new Array(64);function $T(){this.init(),this._w=f4e,u4e.call(this,64,56)}c4e($T,d4e);$T.prototype.init=function(){return this._a=3238371032,this._b=914150663,this._c=812702999,this._d=4144912697,this._e=4290775857,this._f=1750603025,this._g=1694076839,this._h=3204075428,this};$T.prototype._hash=function(){var t=l4e.allocUnsafe(28);return t.writeInt32BE(this._a,0),t.writeInt32BE(this._b,4),t.writeInt32BE(this._c,8),t.writeInt32BE(this._d,12),t.writeInt32BE(this._e,16),t.writeInt32BE(this._f,20),t.writeInt32BE(this._g,24),t};BX.exports=$T});var g7=W((ngt,UX)=>{f();var h4e=Vt(),NX=Tg(),p4e=ur().Buffer,MX=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591],y4e=new Array(160);function TE(){this.init(),this._w=y4e,NX.call(this,128,112)}h4e(TE,NX);TE.prototype.init=function(){return this._ah=1779033703,this._bh=3144134277,this._ch=1013904242,this._dh=2773480762,this._eh=1359893119,this._fh=2600822924,this._gh=528734635,this._hh=1541459225,this._al=4089235720,this._bl=2227873595,this._cl=4271175723,this._dl=1595750129,this._el=2917565137,this._fl=725511199,this._gl=4215389547,this._hl=327033209,this};function DX(t,e,r){return r^t&(e^r)}function CX(t,e,r){return t&e|r&(t|e)}function jX(t,e){return(t>>>28|e<<4)^(e>>>2|t<<30)^(e>>>7|t<<25)}function $X(t,e){return(t>>>14|e<<18)^(t>>>18|e<<14)^(e>>>9|t<<23)}function m4e(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^t>>>7}function g4e(t,e){return(t>>>1|e<<31)^(t>>>8|e<<24)^(t>>>7|e<<25)}function v4e(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^t>>>6}function b4e(t,e){return(t>>>19|e<<13)^(e>>>29|t<<3)^(t>>>6|e<<26)}function Mo(t,e){return t>>>0<e>>>0?1:0}TE.prototype._update=function(t){for(var e=this._w,r=this._ah|0,n=this._bh|0,i=this._ch|0,o=this._dh|0,s=this._eh|0,a=this._fh|0,d=this._gh|0,u=this._hh|0,c=this._al|0,l=this._bl|0,h=this._cl|0,y=this._dl|0,g=this._el|0,v=this._fl|0,x=this._gl|0,S=this._hl|0,A=0;A<32;A+=2)e[A]=t.readInt32BE(A*4),e[A+1]=t.readInt32BE(A*4+4);for(;A<160;A+=2){var T=e[A-30],$=e[A-15*2+1],j=m4e(T,$),K=g4e($,T);T=e[A-2*2],$=e[A-2*2+1];var F=v4e(T,$),L=b4e($,T),V=e[A-7*2],q=e[A-7*2+1],k=e[A-16*2],P=e[A-16*2+1],B=K+q|0,p=j+V+Mo(B,K)|0;B=B+L|0,p=p+F+Mo(B,L)|0,B=B+P|0,p=p+k+Mo(B,P)|0,e[A]=p,e[A+1]=B}for(var m=0;m<160;m+=2){p=e[m],B=e[m+1];var w=CX(r,n,i),E=CX(c,l,h),_=jX(r,c),b=jX(c,r),C=$X(s,g),N=$X(g,s),D=MX[m],U=MX[m+1],G=DX(s,a,d),Y=DX(g,v,x),J=S+N|0,H=u+C+Mo(J,S)|0;J=J+Y|0,H=H+G+Mo(J,Y)|0,J=J+U|0,H=H+D+Mo(J,U)|0,J=J+B|0,H=H+p+Mo(J,B)|0;var X=b+E|0,te=_+w+Mo(X,b)|0;u=d,S=x,d=a,x=v,a=s,v=g,g=y+J|0,s=o+H+Mo(g,y)|0,o=i,y=h,i=n,h=l,n=r,l=c,c=J+X|0,r=H+te+Mo(c,J)|0}this._al=this._al+c|0,this._bl=this._bl+l|0,this._cl=this._cl+h|0,this._dl=this._dl+y|0,this._el=this._el+g|0,this._fl=this._fl+v|0,this._gl=this._gl+x|0,this._hl=this._hl+S|0,this._ah=this._ah+r+Mo(this._al,c)|0,this._bh=this._bh+n+Mo(this._bl,l)|0,this._ch=this._ch+i+Mo(this._cl,h)|0,this._dh=this._dh+o+Mo(this._dl,y)|0,this._eh=this._eh+s+Mo(this._el,g)|0,this._fh=this._fh+a+Mo(this._fl,v)|0,this._gh=this._gh+d+Mo(this._gl,x)|0,this._hh=this._hh+u+Mo(this._hl,S)|0};TE.prototype._hash=function(){var t=p4e.allocUnsafe(64);function e(r,n,i){t.writeInt32BE(r,i),t.writeInt32BE(n,i+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),e(this._gh,this._gl,48),e(this._hh,this._hl,56),t};UX.exports=TE});var qX=W((ogt,KX)=>{f();var w4e=Vt(),_4e=g7(),x4e=Tg(),E4e=ur().Buffer,S4e=new Array(160);function NT(){this.init(),this._w=S4e,x4e.call(this,128,112)}w4e(NT,_4e);NT.prototype.init=function(){return this._ah=3418070365,this._bh=1654270250,this._ch=2438529370,this._dh=355462360,this._eh=1731405415,this._fh=2394180231,this._gh=3675008525,this._hh=1203062813,this._al=3238371032,this._bl=914150663,this._cl=812702999,this._dl=4144912697,this._el=4290775857,this._fl=1750603025,this._gl=1694076839,this._hl=3204075428,this};NT.prototype._hash=function(){var t=E4e.allocUnsafe(48);function e(r,n,i){t.writeInt32BE(r,i),t.writeInt32BE(n,i+4)}return e(this._ah,this._al,0),e(this._bh,this._bl,8),e(this._ch,this._cl,16),e(this._dh,this._dl,24),e(this._eh,this._el,32),e(this._fh,this._fl,40),t};KX.exports=NT});var UT=W((Sh,LX)=>{f();var Sh=LX.exports=function(e){e=e.toLowerCase();var r=Sh[e];if(!r)throw new Error(e+" is not supported (we accept pull requests)");return new r};Sh.sha=TX();Sh.sha1=PX();Sh.sha224=OX();Sh.sha256=m7();Sh.sha384=qX();Sh.sha512=g7()});var zX=W((cgt,FX)=>{f();FX.exports=Bd;var v7=Ba().EventEmitter,T4e=Vt();T4e(Bd,v7);Bd.Readable=_T();Bd.Writable=vT();Bd.Duplex=By();Bd.Transform=IT();Bd.PassThrough=u7();Bd.finished=lE();Bd.pipeline=f7();Bd.Stream=Bd;function Bd(){v7.call(this)}Bd.prototype.pipe=function(t,e){var r=this;function n(c){t.writable&&t.write(c)===!1&&r.pause&&r.pause()}r.on("data",n);function i(){r.readable&&r.resume&&r.resume()}t.on("drain",i),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",s),r.on("close",a));var o=!1;function s(){o||(o=!0,t.end())}function a(){o||(o=!0,typeof t.destroy=="function"&&t.destroy())}function d(c){if(u(),v7.listenerCount(this,"error")===0)throw c}r.on("error",d),t.on("error",d);function u(){r.removeListener("data",n),t.removeListener("drain",i),r.removeListener("end",s),r.removeListener("close",a),r.removeListener("error",d),t.removeListener("error",d),r.removeListener("end",u),r.removeListener("close",u),t.removeListener("close",u)}return r.on("end",u),r.on("close",u),t.on("close",u),t.emit("pipe",r),t}});var Th=W((ugt,WX)=>{f();var VX=ur().Buffer,HX=zX().Transform,A4e=Yw().StringDecoder,k4e=Vt();function Du(t){HX.call(this),this.hashMode=typeof t=="string",this.hashMode?this[t]=this._finalOrDigest:this.final=this._finalOrDigest,this._final&&(this.__final=this._final,this._final=null),this._decoder=null,this._encoding=null}k4e(Du,HX);Du.prototype.update=function(t,e,r){typeof t=="string"&&(t=VX.from(t,e));var n=this._update(t);return this.hashMode?this:(r&&(n=this._toString(n,r)),n)};Du.prototype.setAutoPadding=function(){};Du.prototype.getAuthTag=function(){throw new Error("trying to get auth tag in unsupported state")};Du.prototype.setAuthTag=function(){throw new Error("trying to set auth tag in unsupported state")};Du.prototype.setAAD=function(){throw new Error("trying to set aad in unsupported state")};Du.prototype._transform=function(t,e,r){var n;try{this.hashMode?this._update(t):this.push(this._update(t))}catch(i){n=i}finally{r(n)}};Du.prototype._flush=function(t){var e;try{this.push(this.__final())}catch(r){e=r}t(e)};Du.prototype._finalOrDigest=function(t){var e=this.__final()||VX.alloc(0);return t&&(e=this._toString(e,t,!0)),e};Du.prototype._toString=function(t,e,r){if(this._decoder||(this._decoder=new A4e(e),this._encoding=e),this._encoding!==e)throw new Error("can't switch encodings");var n=this._decoder.write(t);return r&&(n+=this._decoder.end()),n};WX.exports=Du});var Qw=W((fgt,JX)=>{"use strict";f();var P4e=Vt(),I4e=MT(),R4e=CT(),B4e=UT(),GX=Th();function KT(t){GX.call(this,"digest"),this._hash=t}P4e(KT,GX);KT.prototype._update=function(t){this._hash.update(t)};KT.prototype._final=function(){return this._hash.digest()};JX.exports=function(e){return e=e.toLowerCase(),e==="md5"?new I4e:e==="rmd160"||e==="ripemd160"?new R4e:new KT(B4e(e))}});var XX=W((pgt,ZX)=>{"use strict";f();var O4e=Vt(),Ag=ur().Buffer,YX=Th(),M4e=Ag.alloc(128),e1=64;function qT(t,e){YX.call(this,"digest"),typeof e=="string"&&(e=Ag.from(e)),this._alg=t,this._key=e,e.length>e1?e=t(e):e.length<e1&&(e=Ag.concat([e,M4e],e1));for(var r=this._ipad=Ag.allocUnsafe(e1),n=this._opad=Ag.allocUnsafe(e1),i=0;i<e1;i++)r[i]=e[i]^54,n[i]=e[i]^92;this._hash=[r]}O4e(qT,YX);qT.prototype._update=function(t){this._hash.push(t)};qT.prototype._final=function(){var t=this._alg(Ag.concat(this._hash));return this._alg(Ag.concat([this._opad,t]))};ZX.exports=qT});var b7=W((mgt,QX)=>{f();var D4e=MT();QX.exports=function(t){return new D4e().update(t).digest()}});var x7=W((vgt,tQ)=>{"use strict";f();var C4e=Vt(),j4e=XX(),eQ=Th(),AE=ur().Buffer,$4e=b7(),w7=CT(),_7=UT(),N4e=AE.alloc(128);function kE(t,e){eQ.call(this,"digest"),typeof e=="string"&&(e=AE.from(e));var r=t==="sha512"||t==="sha384"?128:64;if(this._alg=t,this._key=e,e.length>r){var n=t==="rmd160"?new w7:_7(t);e=n.update(e).digest()}else e.length<r&&(e=AE.concat([e,N4e],r));for(var i=this._ipad=AE.allocUnsafe(r),o=this._opad=AE.allocUnsafe(r),s=0;s<r;s++)i[s]=e[s]^54,o[s]=e[s]^92;this._hash=t==="rmd160"?new w7:_7(t),this._hash.update(i)}C4e(kE,eQ);kE.prototype._update=function(t){this._hash.update(t)};kE.prototype._final=function(){var t=this._hash.digest(),e=this._alg==="rmd160"?new w7:_7(this._alg);return e.update(this._opad).update(t).digest()};tQ.exports=function(e,r){return e=e.toLowerCase(),e==="rmd160"||e==="ripemd160"?new kE("rmd160",r):e==="md5"?new j4e($4e,r):new kE(e,r)}});var E7=W((wgt,U4e)=>{U4e.exports={sha224WithRSAEncryption:{sign:"rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},"RSA-SHA224":{sign:"ecdsa/rsa",hash:"sha224",id:"302d300d06096086480165030402040500041c"},sha256WithRSAEncryption:{sign:"rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},"RSA-SHA256":{sign:"ecdsa/rsa",hash:"sha256",id:"3031300d060960864801650304020105000420"},sha384WithRSAEncryption:{sign:"rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},"RSA-SHA384":{sign:"ecdsa/rsa",hash:"sha384",id:"3041300d060960864801650304020205000430"},sha512WithRSAEncryption:{sign:"rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA512":{sign:"ecdsa/rsa",hash:"sha512",id:"3051300d060960864801650304020305000440"},"RSA-SHA1":{sign:"rsa",hash:"sha1",id:"3021300906052b0e03021a05000414"},"ecdsa-with-SHA1":{sign:"ecdsa",hash:"sha1",id:""},sha256:{sign:"ecdsa",hash:"sha256",id:""},sha224:{sign:"ecdsa",hash:"sha224",id:""},sha384:{sign:"ecdsa",hash:"sha384",id:""},sha512:{sign:"ecdsa",hash:"sha512",id:""},"DSA-SHA":{sign:"dsa",hash:"sha1",id:""},"DSA-SHA1":{sign:"dsa",hash:"sha1",id:""},DSA:{sign:"dsa",hash:"sha1",id:""},"DSA-WITH-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-SHA224":{sign:"dsa",hash:"sha224",id:""},"DSA-WITH-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-SHA256":{sign:"dsa",hash:"sha256",id:""},"DSA-WITH-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-SHA384":{sign:"dsa",hash:"sha384",id:""},"DSA-WITH-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-SHA512":{sign:"dsa",hash:"sha512",id:""},"DSA-RIPEMD160":{sign:"dsa",hash:"rmd160",id:""},ripemd160WithRSA:{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},"RSA-RIPEMD160":{sign:"rsa",hash:"rmd160",id:"3021300906052b2403020105000414"},md5WithRSAEncryption:{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"},"RSA-MD5":{sign:"rsa",hash:"md5",id:"3020300c06082a864886f70d020505000410"}}});var nQ=W((_gt,rQ)=>{"use strict";f();rQ.exports=E7()});var S7=W((Egt,iQ)=>{f();var K4e=Math.pow(2,30)-1;iQ.exports=function(t,e){if(typeof t!="number")throw new TypeError("Iterations not a number");if(t<0)throw new TypeError("Bad iterations");if(typeof e!="number")throw new TypeError("Key length not a number");if(e<0||e>K4e||e!==e)throw new TypeError("Bad key length")}});var T7=W((Tgt,sQ)=>{f();var LT;globalThis.process&&globalThis.process.browser?LT="utf-8":globalThis.process&&globalThis.process.version?(oQ=parseInt(I.default.version.split(".")[0].slice(1),10),LT=oQ>=6?"utf-8":"binary"):LT="utf-8";var oQ;sQ.exports=LT});var k7=W((kgt,aQ)=>{f();var A7=ur().Buffer;aQ.exports=function(t,e,r){if(A7.isBuffer(t))return t;if(typeof t=="string")return A7.from(t,e);if(ArrayBuffer.isView(t))return A7.from(t.buffer);throw new TypeError(r+" must be a string, a Buffer, a typed array or a DataView")}});var P7=W((Igt,lQ)=>{f();var q4e=b7(),L4e=CT(),F4e=UT(),kg=ur().Buffer,z4e=S7(),cQ=T7(),dQ=k7(),V4e=kg.alloc(128),FT={md5:16,sha1:20,sha224:28,sha256:32,sha384:48,sha512:64,rmd160:20,ripemd160:20};function uQ(t,e,r){var n=H4e(t),i=t==="sha512"||t==="sha384"?128:64;e.length>i?e=n(e):e.length<i&&(e=kg.concat([e,V4e],i));for(var o=kg.allocUnsafe(i+FT[t]),s=kg.allocUnsafe(i+FT[t]),a=0;a<i;a++)o[a]=e[a]^54,s[a]=e[a]^92;var d=kg.allocUnsafe(i+r+4);o.copy(d,0,0,i),this.ipad1=d,this.ipad2=o,this.opad=s,this.alg=t,this.blocksize=i,this.hash=n,this.size=FT[t]}uQ.prototype.run=function(t,e){t.copy(e,this.blocksize);var r=this.hash(e);return r.copy(this.opad,this.blocksize),this.hash(this.opad)};function H4e(t){function e(n){return F4e(t).update(n).digest()}function r(n){return new L4e().update(n).digest()}return t==="rmd160"||t==="ripemd160"?r:t==="md5"?q4e:e}function W4e(t,e,r,n,i){z4e(r,n),t=dQ(t,cQ,"Password"),e=dQ(e,cQ,"Salt"),i=i||"sha1";var o=new uQ(i,t,e.length),s=kg.allocUnsafe(n),a=kg.allocUnsafe(e.length+4);e.copy(a,0,0,e.length);for(var d=0,u=FT[i],c=Math.ceil(n/u),l=1;l<=c;l++){a.writeUInt32BE(l,e.length);for(var h=o.run(a,o.ipad1),y=h,g=1;g<r;g++){y=o.run(y,o.ipad2);for(var v=0;v<u;v++)h[v]^=y[v]}h.copy(s,d),d+=u}return s}lQ.exports=W4e});var vQ=W((Bgt,gQ)=>{f();var yQ=ur().Buffer,G4e=S7(),fQ=T7(),hQ=P7(),pQ=k7(),zT,PE=globalThis.crypto&&globalThis.crypto.subtle,J4e={sha:"SHA-1","sha-1":"SHA-1",sha1:"SHA-1",sha256:"SHA-256","sha-256":"SHA-256",sha384:"SHA-384","sha-384":"SHA-384","sha-512":"SHA-512",sha512:"SHA-512"},I7=[];function Y4e(t){if(globalThis.process&&!globalThis.process.browser||!PE||!PE.importKey||!PE.deriveBits)return Promise.resolve(!1);if(I7[t]!==void 0)return I7[t];zT=zT||yQ.alloc(8);var e=mQ(zT,zT,10,128,t).then(function(){return!0}).catch(function(){return!1});return I7[t]=e,e}var Pg;function R7(){return Pg||(globalThis.process&&globalThis.process.nextTick?Pg=globalThis.process.nextTick:globalThis.queueMicrotask?Pg=globalThis.queueMicrotask:globalThis.setImmediate?Pg=globalThis.setImmediate:Pg=globalThis.setTimeout,Pg)}function mQ(t,e,r,n,i){return PE.importKey("raw",t,{name:"PBKDF2"},!1,["deriveBits"]).then(function(o){return PE.deriveBits({name:"PBKDF2",salt:e,iterations:r,hash:{name:i}},o,n<<3)}).then(function(o){return yQ.from(o)})}function Z4e(t,e){t.then(function(r){R7()(function(){e(null,r)})},function(r){R7()(function(){e(r)})})}gQ.exports=function(t,e,r,n,i,o){typeof i=="function"&&(o=i,i=void 0),i=i||"sha1";var s=J4e[i.toLowerCase()];if(!s||typeof globalThis.Promise!="function"){R7()(function(){var a;try{a=hQ(t,e,r,n,i)}catch(d){return o(d)}o(null,a)});return}if(G4e(r,n),t=pQ(t,fQ,"Password"),e=pQ(e,fQ,"Salt"),typeof o!="function")throw new Error("No callback provided to pbkdf2");Z4e(Y4e(s).then(function(a){return a?mQ(t,e,r,n,s):hQ(t,e,r,n,i)}),o)}});var O7=W(B7=>{f();B7.pbkdf2=vQ();B7.pbkdf2Sync=P7()});var M7=W(Od=>{"use strict";f();Od.readUInt32BE=function(e,r){var n=e[0+r]<<24|e[1+r]<<16|e[2+r]<<8|e[3+r];return n>>>0};Od.writeUInt32BE=function(e,r,n){e[0+n]=r>>>24,e[1+n]=r>>>16&255,e[2+n]=r>>>8&255,e[3+n]=r&255};Od.ip=function(e,r,n,i){for(var o=0,s=0,a=6;a>=0;a-=2){for(var d=0;d<=24;d+=8)o<<=1,o|=r>>>d+a&1;for(var d=0;d<=24;d+=8)o<<=1,o|=e>>>d+a&1}for(var a=6;a>=0;a-=2){for(var d=1;d<=25;d+=8)s<<=1,s|=r>>>d+a&1;for(var d=1;d<=25;d+=8)s<<=1,s|=e>>>d+a&1}n[i+0]=o>>>0,n[i+1]=s>>>0};Od.rip=function(e,r,n,i){for(var o=0,s=0,a=0;a<4;a++)for(var d=24;d>=0;d-=8)o<<=1,o|=r>>>d+a&1,o<<=1,o|=e>>>d+a&1;for(var a=4;a<8;a++)for(var d=24;d>=0;d-=8)s<<=1,s|=r>>>d+a&1,s<<=1,s|=e>>>d+a&1;n[i+0]=o>>>0,n[i+1]=s>>>0};Od.pc1=function(e,r,n,i){for(var o=0,s=0,a=7;a>=5;a--){for(var d=0;d<=24;d+=8)o<<=1,o|=r>>d+a&1;for(var d=0;d<=24;d+=8)o<<=1,o|=e>>d+a&1}for(var d=0;d<=24;d+=8)o<<=1,o|=r>>d+a&1;for(var a=1;a<=3;a++){for(var d=0;d<=24;d+=8)s<<=1,s|=r>>d+a&1;for(var d=0;d<=24;d+=8)s<<=1,s|=e>>d+a&1}for(var d=0;d<=24;d+=8)s<<=1,s|=e>>d+a&1;n[i+0]=o>>>0,n[i+1]=s>>>0};Od.r28shl=function(e,r){return e<<r&268435455|e>>>28-r};var VT=[14,11,17,4,27,23,25,0,13,22,7,18,5,9,16,24,2,20,12,21,1,8,15,26,15,4,25,19,9,1,26,16,5,11,23,8,12,7,17,0,22,3,10,14,6,20,27,24];Od.pc2=function(e,r,n,i){for(var o=0,s=0,a=VT.length>>>1,d=0;d<a;d++)o<<=1,o|=e>>>VT[d]&1;for(var d=a;d<VT.length;d++)s<<=1,s|=r>>>VT[d]&1;n[i+0]=o>>>0,n[i+1]=s>>>0};Od.expand=function(e,r,n){var i=0,o=0;i=(e&1)<<5|e>>>27;for(var s=23;s>=15;s-=4)i<<=6,i|=e>>>s&63;for(var s=11;s>=3;s-=4)o|=e>>>s&63,o<<=6;o|=(e&31)<<1|e>>>31,r[n+0]=i>>>0,r[n+1]=o>>>0};var bQ=[14,0,4,15,13,7,1,4,2,14,15,2,11,13,8,1,3,10,10,6,6,12,12,11,5,9,9,5,0,3,7,8,4,15,1,12,14,8,8,2,13,4,6,9,2,1,11,7,15,5,12,11,9,3,7,14,3,10,10,0,5,6,0,13,15,3,1,13,8,4,14,7,6,15,11,2,3,8,4,14,9,12,7,0,2,1,13,10,12,6,0,9,5,11,10,5,0,13,14,8,7,10,11,1,10,3,4,15,13,4,1,2,5,11,8,6,12,7,6,12,9,0,3,5,2,14,15,9,10,13,0,7,9,0,14,9,6,3,3,4,15,6,5,10,1,2,13,8,12,5,7,14,11,12,4,11,2,15,8,1,13,1,6,10,4,13,9,0,8,6,15,9,3,8,0,7,11,4,1,15,2,14,12,3,5,11,10,5,14,2,7,12,7,13,13,8,14,11,3,5,0,6,6,15,9,0,10,3,1,4,2,7,8,2,5,12,11,1,12,10,4,14,15,9,10,3,6,15,9,0,0,6,12,10,11,1,7,13,13,8,15,9,1,4,3,5,14,11,5,12,2,7,8,2,4,14,2,14,12,11,4,2,1,12,7,4,10,7,11,13,6,1,8,5,5,0,3,15,15,10,13,3,0,9,14,8,9,6,4,11,2,8,1,12,11,7,10,1,13,14,7,2,8,13,15,6,9,15,12,0,5,9,6,10,3,4,0,5,14,3,12,10,1,15,10,4,15,2,9,7,2,12,6,9,8,5,0,6,13,1,3,13,4,14,14,0,7,11,5,3,11,8,9,4,14,3,15,2,5,12,2,9,8,5,12,15,3,10,7,11,0,14,4,1,10,7,1,6,13,0,11,8,6,13,4,13,11,0,2,11,14,7,15,4,0,9,8,1,13,10,3,14,12,3,9,5,7,12,5,2,10,15,6,8,1,6,1,6,4,11,11,13,13,8,12,1,3,4,7,10,14,7,10,9,15,5,6,0,8,15,0,14,5,2,9,3,2,12,13,1,2,15,8,13,4,8,6,10,15,3,11,7,1,4,10,12,9,5,3,6,14,11,5,0,0,14,12,9,7,2,7,2,11,1,4,14,1,7,9,4,12,10,14,8,2,13,0,15,6,12,10,9,13,0,15,3,3,5,5,6,8,11];Od.substitute=function(e,r){for(var n=0,i=0;i<4;i++){var o=e>>>18-i*6&63,s=bQ[i*64+o];n<<=4,n|=s}for(var i=0;i<4;i++){var o=r>>>18-i*6&63,s=bQ[4*64+i*64+o];n<<=4,n|=s}return n>>>0};var wQ=[16,25,12,11,3,20,4,15,31,17,9,6,27,14,1,22,30,24,8,18,0,5,29,23,13,19,2,26,10,21,28,7];Od.permute=function(e){for(var r=0,n=0;n<wQ.length;n++)r<<=1,r|=e>>>wQ[n]&1;return r>>>0};Od.padSplit=function(e,r,n){for(var i=e.toString(2);i.length<r;)i="0"+i;for(var o=[],s=0;s<r;s+=n)o.push(i.slice(s,s+n));return o.join(" ")}});var Fc=W(($gt,xQ)=>{f();xQ.exports=_Q;function _Q(t,e){if(!t)throw new Error(e||"Assertion failed")}_Q.equal=function(e,r,n){if(e!=r)throw new Error(n||"Assertion failed: "+e+" != "+r)}});var HT=W((Ugt,EQ)=>{"use strict";f();var X4e=Fc();function Md(t){this.options=t,this.type=this.options.type,this.blockSize=8,this._init(),this.buffer=new Array(this.blockSize),this.bufferOff=0,this.padding=t.padding!==!1}EQ.exports=Md;Md.prototype._init=function(){};Md.prototype.update=function(e){return e.length===0?[]:this.type==="decrypt"?this._updateDecrypt(e):this._updateEncrypt(e)};Md.prototype._buffer=function(e,r){for(var n=Math.min(this.buffer.length-this.bufferOff,e.length-r),i=0;i<n;i++)this.buffer[this.bufferOff+i]=e[r+i];return this.bufferOff+=n,n};Md.prototype._flushBuffer=function(e,r){return this._update(this.buffer,0,e,r),this.bufferOff=0,this.blockSize};Md.prototype._updateEncrypt=function(e){var r=0,n=0,i=(this.bufferOff+e.length)/this.blockSize|0,o=new Array(i*this.blockSize);this.bufferOff!==0&&(r+=this._buffer(e,r),this.bufferOff===this.buffer.length&&(n+=this._flushBuffer(o,n)));for(var s=e.length-(e.length-r)%this.blockSize;r<s;r+=this.blockSize)this._update(e,r,o,n),n+=this.blockSize;for(;r<e.length;r++,this.bufferOff++)this.buffer[this.bufferOff]=e[r];return o};Md.prototype._updateDecrypt=function(e){for(var r=0,n=0,i=Math.ceil((this.bufferOff+e.length)/this.blockSize)-1,o=new Array(i*this.blockSize);i>0;i--)r+=this._buffer(e,r),n+=this._flushBuffer(o,n);return r+=this._buffer(e,r),o};Md.prototype.final=function(e){var r;e&&(r=this.update(e));var n;return this.type==="encrypt"?n=this._finalEncrypt():n=this._finalDecrypt(),r?r.concat(n):n};Md.prototype._pad=function(e,r){if(r===0)return!1;for(;r<e.length;)e[r++]=0;return!0};Md.prototype._finalEncrypt=function(){if(!this._pad(this.buffer,this.bufferOff))return[];var e=new Array(this.blockSize);return this._update(this.buffer,0,e,0),e};Md.prototype._unpad=function(e){return e};Md.prototype._finalDecrypt=function(){X4e.equal(this.bufferOff,this.blockSize,"Not enough data to decrypt");var e=new Array(this.blockSize);return this._flushBuffer(e,0),this._unpad(e)}});var D7=W((qgt,AQ)=>{"use strict";f();var SQ=Fc(),Q4e=Vt(),io=M7(),TQ=HT();function eke(){this.tmp=new Array(2),this.keys=null}function Hl(t){TQ.call(this,t);var e=new eke;this._desState=e,this.deriveKeys(e,t.key)}Q4e(Hl,TQ);AQ.exports=Hl;Hl.create=function(e){return new Hl(e)};var tke=[1,1,2,2,2,2,2,2,1,2,2,2,2,2,2,1];Hl.prototype.deriveKeys=function(e,r){e.keys=new Array(16*2),SQ.equal(r.length,this.blockSize,"Invalid key length");var n=io.readUInt32BE(r,0),i=io.readUInt32BE(r,4);io.pc1(n,i,e.tmp,0),n=e.tmp[0],i=e.tmp[1];for(var o=0;o<e.keys.length;o+=2){var s=tke[o>>>1];n=io.r28shl(n,s),i=io.r28shl(i,s),io.pc2(n,i,e.keys,o)}};Hl.prototype._update=function(e,r,n,i){var o=this._desState,s=io.readUInt32BE(e,r),a=io.readUInt32BE(e,r+4);io.ip(s,a,o.tmp,0),s=o.tmp[0],a=o.tmp[1],this.type==="encrypt"?this._encrypt(o,s,a,o.tmp,0):this._decrypt(o,s,a,o.tmp,0),s=o.tmp[0],a=o.tmp[1],io.writeUInt32BE(n,s,i),io.writeUInt32BE(n,a,i+4)};Hl.prototype._pad=function(e,r){if(this.padding===!1)return!1;for(var n=e.length-r,i=r;i<e.length;i++)e[i]=n;return!0};Hl.prototype._unpad=function(e){if(this.padding===!1)return e;for(var r=e[e.length-1],n=e.length-r;n<e.length;n++)SQ.equal(e[n],r);return e.slice(0,e.length-r)};Hl.prototype._encrypt=function(e,r,n,i,o){for(var s=r,a=n,d=0;d<e.keys.length;d+=2){var u=e.keys[d],c=e.keys[d+1];io.expand(a,e.tmp,0),u^=e.tmp[0],c^=e.tmp[1];var l=io.substitute(u,c),h=io.permute(l),y=a;a=(s^h)>>>0,s=y}io.rip(a,s,i,o)};Hl.prototype._decrypt=function(e,r,n,i,o){for(var s=n,a=r,d=e.keys.length-2;d>=0;d-=2){var u=e.keys[d],c=e.keys[d+1];io.expand(s,e.tmp,0),u^=e.tmp[0],c^=e.tmp[1];var l=io.substitute(u,c),h=io.permute(l),y=s;s=(a^h)>>>0,a=y}io.rip(s,a,i,o)}});var PQ=W(kQ=>{"use strict";f();var rke=Fc(),nke=Vt(),WT={};function ike(t){rke.equal(t.length,8,"Invalid IV length"),this.iv=new Array(8);for(var e=0;e<this.iv.length;e++)this.iv[e]=t[e]}function oke(t){function e(o){t.call(this,o),this._cbcInit()}nke(e,t);for(var r=Object.keys(WT),n=0;n<r.length;n++){var i=r[n];e.prototype[i]=WT[i]}return e.create=function(s){return new e(s)},e}kQ.instantiate=oke;WT._cbcInit=function(){var e=new ike(this.options.iv);this._cbcState=e};WT._update=function(e,r,n,i){var o=this._cbcState,s=this.constructor.super_.prototype,a=o.iv;if(this.type==="encrypt"){for(var d=0;d<this.blockSize;d++)a[d]^=e[r+d];s._update.call(this,a,0,n,i);for(var d=0;d<this.blockSize;d++)a[d]=n[i+d]}else{s._update.call(this,e,r,n,i);for(var d=0;d<this.blockSize;d++)n[i+d]^=a[d];for(var d=0;d<this.blockSize;d++)a[d]=e[r+d]}}});var BQ=W((Vgt,RQ)=>{"use strict";f();var ske=Fc(),ake=Vt(),IQ=HT(),jy=D7();function cke(t,e){ske.equal(e.length,24,"Invalid key length");var r=e.slice(0,8),n=e.slice(8,16),i=e.slice(16,24);t==="encrypt"?this.ciphers=[jy.create({type:"encrypt",key:r}),jy.create({type:"decrypt",key:n}),jy.create({type:"encrypt",key:i})]:this.ciphers=[jy.create({type:"decrypt",key:i}),jy.create({type:"encrypt",key:n}),jy.create({type:"decrypt",key:r})]}function Ig(t){IQ.call(this,t);var e=new cke(this.type,this.options.key);this._edeState=e}ake(Ig,IQ);RQ.exports=Ig;Ig.create=function(e){return new Ig(e)};Ig.prototype._update=function(e,r,n,i){var o=this._edeState;o.ciphers[0]._update(e,r,n,i),o.ciphers[1]._update(n,i,n,i),o.ciphers[2]._update(n,i,n,i)};Ig.prototype._pad=jy.prototype._pad;Ig.prototype._unpad=jy.prototype._unpad});var OQ=W(t1=>{"use strict";f();t1.utils=M7();t1.Cipher=HT();t1.DES=D7();t1.CBC=PQ();t1.EDE=BQ()});var CQ=W((Jgt,DQ)=>{f();var MQ=Th(),Ah=OQ(),dke=Vt(),Rg=ur().Buffer,IE={"des-ede3-cbc":Ah.CBC.instantiate(Ah.EDE),"des-ede3":Ah.EDE,"des-ede-cbc":Ah.CBC.instantiate(Ah.EDE),"des-ede":Ah.EDE,"des-cbc":Ah.CBC.instantiate(Ah.DES),"des-ecb":Ah.DES};IE.des=IE["des-cbc"];IE.des3=IE["des-ede3-cbc"];DQ.exports=GT;dke(GT,MQ);function GT(t){MQ.call(this);var e=t.mode.toLowerCase(),r=IE[e],n;t.decrypt?n="decrypt":n="encrypt";var i=t.key;Rg.isBuffer(i)||(i=Rg.from(i)),(e==="des-ede"||e==="des-ede-cbc")&&(i=Rg.concat([i,i.slice(0,8)]));var o=t.iv;Rg.isBuffer(o)||(o=Rg.from(o)),this._des=r.create({key:i,iv:o,type:n})}GT.prototype._update=function(t){return Rg.from(this._des.update(t))};GT.prototype._final=function(){return Rg.from(this._des.final())}});var jQ=W(C7=>{f();C7.encrypt=function(t,e){return t._cipher.encryptBlock(e)};C7.decrypt=function(t,e){return t._cipher.decryptBlock(e)}});var r1=W((Qgt,$Q)=>{f();$Q.exports=function(e,r){for(var n=Math.min(e.length,r.length),i=new M.Buffer(n),o=0;o<n;++o)i[o]=e[o]^r[o];return i}});var UQ=W(j7=>{f();var NQ=r1();j7.encrypt=function(t,e){var r=NQ(e,t._prev);return t._prev=t._cipher.encryptBlock(r),t._prev};j7.decrypt=function(t,e){var r=t._prev;t._prev=e;var n=t._cipher.decryptBlock(e);return NQ(n,r)}});var LQ=W(qQ=>{f();var RE=ur().Buffer,uke=r1();function KQ(t,e,r){var n=e.length,i=uke(e,t._cache);return t._cache=t._cache.slice(n),t._prev=RE.concat([t._prev,r?e:i]),i}qQ.encrypt=function(t,e,r){for(var n=RE.allocUnsafe(0),i;e.length;)if(t._cache.length===0&&(t._cache=t._cipher.encryptBlock(t._prev),t._prev=RE.allocUnsafe(0)),t._cache.length<=e.length)i=t._cache.length,n=RE.concat([n,KQ(t,e.slice(0,i),r)]),e=e.slice(i);else{n=RE.concat([n,KQ(t,e,r)]);break}return n}});var zQ=W(FQ=>{f();var $7=ur().Buffer;function lke(t,e,r){var n=t._cipher.encryptBlock(t._prev),i=n[0]^e;return t._prev=$7.concat([t._prev.slice(1),$7.from([r?e:i])]),i}FQ.encrypt=function(t,e,r){for(var n=e.length,i=$7.allocUnsafe(n),o=-1;++o<n;)i[o]=lke(t,e[o],r);return i}});var HQ=W(VQ=>{f();var JT=ur().Buffer;function fke(t,e,r){for(var n,i=-1,o=8,s=0,a,d;++i<o;)n=t._cipher.encryptBlock(t._prev),a=e&1<<7-i?128:0,d=n[0]^a,s+=(d&128)>>i%8,t._prev=hke(t._prev,r?a:d);return s}function hke(t,e){var r=t.length,n=-1,i=JT.allocUnsafe(t.length);for(t=JT.concat([t,JT.from([e])]);++n<r;)i[n]=t[n]<<1|t[n+1]>>7;return i}VQ.encrypt=function(t,e,r){for(var n=e.length,i=JT.allocUnsafe(n),o=-1;++o<n;)i[o]=fke(t,e[o],r);return i}});var GQ=W(WQ=>{f();var pke=r1();function yke(t){return t._prev=t._cipher.encryptBlock(t._prev),t._prev}WQ.encrypt=function(t,e){for(;t._cache.length<e.length;)t._cache=M.Buffer.concat([t._cache,yke(t)]);var r=t._cache.slice(0,e.length);return t._cache=t._cache.slice(e.length),pke(e,r)}});var N7=W((lvt,JQ)=>{f();function mke(t){for(var e=t.length,r;e--;)if(r=t.readUInt8(e),r===255)t.writeUInt8(0,e);else{r++,t.writeUInt8(r,e);break}}JQ.exports=mke});var K7=W(ZQ=>{f();var gke=r1(),YQ=ur().Buffer,vke=N7();function bke(t){var e=t._cipher.encryptBlockRaw(t._prev);return vke(t._prev),e}var U7=16;ZQ.encrypt=function(t,e){var r=Math.ceil(e.length/U7),n=t._cache.length;t._cache=YQ.concat([t._cache,YQ.allocUnsafe(r*U7)]);for(var i=0;i<r;i++){var o=bke(t),s=n+i*U7;t._cache.writeUInt32BE(o[0],s+0),t._cache.writeUInt32BE(o[1],s+4),t._cache.writeUInt32BE(o[2],s+8),t._cache.writeUInt32BE(o[3],s+12)}var a=t._cache.slice(0,e.length);return t._cache=t._cache.slice(e.length),gke(e,a)}});var q7=W((yvt,wke)=>{wke.exports={"aes-128-ecb":{cipher:"AES",key:128,iv:0,mode:"ECB",type:"block"},"aes-192-ecb":{cipher:"AES",key:192,iv:0,mode:"ECB",type:"block"},"aes-256-ecb":{cipher:"AES",key:256,iv:0,mode:"ECB",type:"block"},"aes-128-cbc":{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},"aes-192-cbc":{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},"aes-256-cbc":{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},aes128:{cipher:"AES",key:128,iv:16,mode:"CBC",type:"block"},aes192:{cipher:"AES",key:192,iv:16,mode:"CBC",type:"block"},aes256:{cipher:"AES",key:256,iv:16,mode:"CBC",type:"block"},"aes-128-cfb":{cipher:"AES",key:128,iv:16,mode:"CFB",type:"stream"},"aes-192-cfb":{cipher:"AES",key:192,iv:16,mode:"CFB",type:"stream"},"aes-256-cfb":{cipher:"AES",key:256,iv:16,mode:"CFB",type:"stream"},"aes-128-cfb8":{cipher:"AES",key:128,iv:16,mode:"CFB8",type:"stream"},"aes-192-cfb8":{cipher:"AES",key:192,iv:16,mode:"CFB8",type:"stream"},"aes-256-cfb8":{cipher:"AES",key:256,iv:16,mode:"CFB8",type:"stream"},"aes-128-cfb1":{cipher:"AES",key:128,iv:16,mode:"CFB1",type:"stream"},"aes-192-cfb1":{cipher:"AES",key:192,iv:16,mode:"CFB1",type:"stream"},"aes-256-cfb1":{cipher:"AES",key:256,iv:16,mode:"CFB1",type:"stream"},"aes-128-ofb":{cipher:"AES",key:128,iv:16,mode:"OFB",type:"stream"},"aes-192-ofb":{cipher:"AES",key:192,iv:16,mode:"OFB",type:"stream"},"aes-256-ofb":{cipher:"AES",key:256,iv:16,mode:"OFB",type:"stream"},"aes-128-ctr":{cipher:"AES",key:128,iv:16,mode:"CTR",type:"stream"},"aes-192-ctr":{cipher:"AES",key:192,iv:16,mode:"CTR",type:"stream"},"aes-256-ctr":{cipher:"AES",key:256,iv:16,mode:"CTR",type:"stream"},"aes-128-gcm":{cipher:"AES",key:128,iv:12,mode:"GCM",type:"auth"},"aes-192-gcm":{cipher:"AES",key:192,iv:12,mode:"GCM",type:"auth"},"aes-256-gcm":{cipher:"AES",key:256,iv:12,mode:"GCM",type:"auth"}}});var ZT=W((mvt,XQ)=>{f();var _ke={ECB:jQ(),CBC:UQ(),CFB:LQ(),CFB8:zQ(),CFB1:HQ(),OFB:GQ(),CTR:K7(),GCM:K7()},YT=q7();for(L7 in YT)YT[L7].module=_ke[YT[L7].mode];var L7;XQ.exports=YT});var BE=W((vvt,eee)=>{f();var XT=ur().Buffer;function z7(t){XT.isBuffer(t)||(t=XT.from(t));for(var e=t.length/4|0,r=new Array(e),n=0;n<e;n++)r[n]=t.readUInt32BE(n*4);return r}function F7(t){for(var e=0;e<t.length;t++)t[e]=0}function QQ(t,e,r,n,i){for(var o=r[0],s=r[1],a=r[2],d=r[3],u=t[0]^e[0],c=t[1]^e[1],l=t[2]^e[2],h=t[3]^e[3],y,g,v,x,S=4,A=1;A<i;A++)y=o[u>>>24]^s[c>>>16&255]^a[l>>>8&255]^d[h&255]^e[S++],g=o[c>>>24]^s[l>>>16&255]^a[h>>>8&255]^d[u&255]^e[S++],v=o[l>>>24]^s[h>>>16&255]^a[u>>>8&255]^d[c&255]^e[S++],x=o[h>>>24]^s[u>>>16&255]^a[c>>>8&255]^d[l&255]^e[S++],u=y,c=g,l=v,h=x;return y=(n[u>>>24]<<24|n[c>>>16&255]<<16|n[l>>>8&255]<<8|n[h&255])^e[S++],g=(n[c>>>24]<<24|n[l>>>16&255]<<16|n[h>>>8&255]<<8|n[u&255])^e[S++],v=(n[l>>>24]<<24|n[h>>>16&255]<<16|n[u>>>8&255]<<8|n[c&255])^e[S++],x=(n[h>>>24]<<24|n[u>>>16&255]<<16|n[c>>>8&255]<<8|n[l&255])^e[S++],y=y>>>0,g=g>>>0,v=v>>>0,x=x>>>0,[y,g,v,x]}var xke=[0,1,2,4,8,16,32,64,128,27,54],Yi=function(){for(var t=new Array(256),e=0;e<256;e++)e<128?t[e]=e<<1:t[e]=e<<1^283;for(var r=[],n=[],i=[[],[],[],[]],o=[[],[],[],[]],s=0,a=0,d=0;d<256;++d){var u=a^a<<1^a<<2^a<<3^a<<4;u=u>>>8^u&255^99,r[s]=u,n[u]=s;var c=t[s],l=t[c],h=t[l],y=t[u]*257^u*16843008;i[0][s]=y<<24|y>>>8,i[1][s]=y<<16|y>>>16,i[2][s]=y<<8|y>>>24,i[3][s]=y,y=h*16843009^l*65537^c*257^s*16843008,o[0][u]=y<<24|y>>>8,o[1][u]=y<<16|y>>>16,o[2][u]=y<<8|y>>>24,o[3][u]=y,s===0?s=a=1:(s=c^t[t[t[h^c]]],a^=t[t[a]])}return{SBOX:r,INV_SBOX:n,SUB_MIX:i,INV_SUB_MIX:o}}();function Dd(t){this._key=z7(t),this._reset()}Dd.blockSize=4*4;Dd.keySize=256/8;Dd.prototype.blockSize=Dd.blockSize;Dd.prototype.keySize=Dd.keySize;Dd.prototype._reset=function(){for(var t=this._key,e=t.length,r=e+6,n=(r+1)*4,i=[],o=0;o<e;o++)i[o]=t[o];for(o=e;o<n;o++){var s=i[o-1];o%e===0?(s=s<<8|s>>>24,s=Yi.SBOX[s>>>24]<<24|Yi.SBOX[s>>>16&255]<<16|Yi.SBOX[s>>>8&255]<<8|Yi.SBOX[s&255],s^=xke[o/e|0]<<24):e>6&&o%e===4&&(s=Yi.SBOX[s>>>24]<<24|Yi.SBOX[s>>>16&255]<<16|Yi.SBOX[s>>>8&255]<<8|Yi.SBOX[s&255]),i[o]=i[o-e]^s}for(var a=[],d=0;d<n;d++){var u=n-d,c=i[u-(d%4?0:4)];d<4||u<=4?a[d]=c:a[d]=Yi.INV_SUB_MIX[0][Yi.SBOX[c>>>24]]^Yi.INV_SUB_MIX[1][Yi.SBOX[c>>>16&255]]^Yi.INV_SUB_MIX[2][Yi.SBOX[c>>>8&255]]^Yi.INV_SUB_MIX[3][Yi.SBOX[c&255]]}this._nRounds=r,this._keySchedule=i,this._invKeySchedule=a};Dd.prototype.encryptBlockRaw=function(t){return t=z7(t),QQ(t,this._keySchedule,Yi.SUB_MIX,Yi.SBOX,this._nRounds)};Dd.prototype.encryptBlock=function(t){var e=this.encryptBlockRaw(t),r=XT.allocUnsafe(16);return r.writeUInt32BE(e[0],0),r.writeUInt32BE(e[1],4),r.writeUInt32BE(e[2],8),r.writeUInt32BE(e[3],12),r};Dd.prototype.decryptBlock=function(t){t=z7(t);var e=t[1];t[1]=t[3],t[3]=e;var r=QQ(t,this._invKeySchedule,Yi.INV_SUB_MIX,Yi.INV_SBOX,this._nRounds),n=XT.allocUnsafe(16);return n.writeUInt32BE(r[0],0),n.writeUInt32BE(r[3],4),n.writeUInt32BE(r[2],8),n.writeUInt32BE(r[1],12),n};Dd.prototype.scrub=function(){F7(this._keySchedule),F7(this._invKeySchedule),F7(this._key)};eee.exports.AES=Dd});var nee=W((wvt,ree)=>{f();var n1=ur().Buffer,Eke=n1.alloc(16,0);function Ske(t){return[t.readUInt32BE(0),t.readUInt32BE(4),t.readUInt32BE(8),t.readUInt32BE(12)]}function tee(t){var e=n1.allocUnsafe(16);return e.writeUInt32BE(t[0]>>>0,0),e.writeUInt32BE(t[1]>>>0,4),e.writeUInt32BE(t[2]>>>0,8),e.writeUInt32BE(t[3]>>>0,12),e}function OE(t){this.h=t,this.state=n1.alloc(16,0),this.cache=n1.allocUnsafe(0)}OE.prototype.ghash=function(t){for(var e=-1;++e<t.length;)this.state[e]^=t[e];this._multiply()};OE.prototype._multiply=function(){for(var t=Ske(this.h),e=[0,0,0,0],r,n,i,o=-1;++o<128;){for(n=(this.state[~~(o/8)]&1<<7-o%8)!==0,n&&(e[0]^=t[0],e[1]^=t[1],e[2]^=t[2],e[3]^=t[3]),i=(t[3]&1)!==0,r=3;r>0;r--)t[r]=t[r]>>>1|(t[r-1]&1)<<31;t[0]=t[0]>>>1,i&&(t[0]=t[0]^225<<24)}this.state=tee(e)};OE.prototype.update=function(t){this.cache=n1.concat([this.cache,t]);for(var e;this.cache.length>=16;)e=this.cache.slice(0,16),this.cache=this.cache.slice(16),this.ghash(e)};OE.prototype.final=function(t,e){return this.cache.length&&this.ghash(n1.concat([this.cache,Eke],16)),this.ghash(tee([0,t,0,e])),this.state};ree.exports=OE});var V7=W((xvt,see)=>{f();var Tke=BE(),oc=ur().Buffer,iee=Th(),Ake=Vt(),oee=nee(),kke=r1(),Pke=N7();function Ike(t,e){var r=0;t.length!==e.length&&r++;for(var n=Math.min(t.length,e.length),i=0;i<n;++i)r+=t[i]^e[i];return r}function Rke(t,e,r){if(e.length===12)return t._finID=oc.concat([e,oc.from([0,0,0,1])]),oc.concat([e,oc.from([0,0,0,2])]);var n=new oee(r),i=e.length,o=i%16;n.update(e),o&&(o=16-o,n.update(oc.alloc(o,0))),n.update(oc.alloc(8,0));var s=i*8,a=oc.alloc(8);a.writeUIntBE(s,0,8),n.update(a),t._finID=n.state;var d=oc.from(t._finID);return Pke(d),d}function Bg(t,e,r,n){iee.call(this);var i=oc.alloc(4,0);this._cipher=new Tke.AES(e);var o=this._cipher.encryptBlock(i);this._ghash=new oee(o),r=Rke(this,r,o),this._prev=oc.from(r),this._cache=oc.allocUnsafe(0),this._secCache=oc.allocUnsafe(0),this._decrypt=n,this._alen=0,this._len=0,this._mode=t,this._authTag=null,this._called=!1}Ake(Bg,iee);Bg.prototype._update=function(t){if(!this._called&&this._alen){var e=16-this._alen%16;e<16&&(e=oc.alloc(e,0),this._ghash.update(e))}this._called=!0;var r=this._mode.encrypt(this,t);return this._decrypt?this._ghash.update(t):this._ghash.update(r),this._len+=t.length,r};Bg.prototype._final=function(){if(this._decrypt&&!this._authTag)throw new Error("Unsupported state or unable to authenticate data");var t=kke(this._ghash.final(this._alen*8,this._len*8),this._cipher.encryptBlock(this._finID));if(this._decrypt&&Ike(t,this._authTag))throw new Error("Unsupported state or unable to authenticate data");this._authTag=t,this._cipher.scrub()};Bg.prototype.getAuthTag=function(){if(this._decrypt||!oc.isBuffer(this._authTag))throw new Error("Attempting to get auth tag in unsupported state");return this._authTag};Bg.prototype.setAuthTag=function(e){if(!this._decrypt)throw new Error("Attempting to set auth tag in unsupported state");this._authTag=e};Bg.prototype.setAAD=function(e){if(this._called)throw new Error("Attempting to set AAD in unsupported state");this._ghash.update(e),this._alen+=e.length};see.exports=Bg});var W7=W((Svt,cee)=>{f();var Bke=BE(),H7=ur().Buffer,aee=Th(),Oke=Vt();function QT(t,e,r,n){aee.call(this),this._cipher=new Bke.AES(e),this._prev=H7.from(r),this._cache=H7.allocUnsafe(0),this._secCache=H7.allocUnsafe(0),this._decrypt=n,this._mode=t}Oke(QT,aee);QT.prototype._update=function(t){return this._mode.encrypt(this,t,this._decrypt)};QT.prototype._final=function(){this._cipher.scrub()};cee.exports=QT});var ME=W((Avt,dee)=>{f();var Og=ur().Buffer,Mke=MT();function Dke(t,e,r,n){if(Og.isBuffer(t)||(t=Og.from(t,"binary")),e&&(Og.isBuffer(e)||(e=Og.from(e,"binary")),e.length!==8))throw new RangeError("salt should be Buffer with 8 byte length");for(var i=r/8,o=Og.alloc(i),s=Og.alloc(n||0),a=Og.alloc(0);i>0||n>0;){var d=new Mke;d.update(a),d.update(t),e&&d.update(e),a=d.digest();var u=0;if(i>0){var c=o.length-i;u=Math.min(i,a.length),a.copy(o,c,0,u),i-=u}if(u<a.length&&n>0){var l=s.length-n,h=Math.min(n,a.length-u);a.copy(s,l,u,u+h),n-=h}}return a.fill(0),{key:o,iv:s}}dee.exports=Dke});var hee=W(G7=>{f();var uee=ZT(),Cke=V7(),kh=ur().Buffer,jke=W7(),lee=Th(),$ke=BE(),Nke=ME(),Uke=Vt();function DE(t,e,r){lee.call(this),this._cache=new eA,this._cipher=new $ke.AES(e),this._prev=kh.from(r),this._mode=t,this._autopadding=!0}Uke(DE,lee);DE.prototype._update=function(t){this._cache.add(t);for(var e,r,n=[];e=this._cache.get();)r=this._mode.encrypt(this,e),n.push(r);return kh.concat(n)};var Kke=kh.alloc(16,16);DE.prototype._final=function(){var t=this._cache.flush();if(this._autopadding)return t=this._mode.encrypt(this,t),this._cipher.scrub(),t;if(!t.equals(Kke))throw this._cipher.scrub(),new Error("data not multiple of block length")};DE.prototype.setAutoPadding=function(t){return this._autopadding=!!t,this};function eA(){this.cache=kh.allocUnsafe(0)}eA.prototype.add=function(t){this.cache=kh.concat([this.cache,t])};eA.prototype.get=function(){if(this.cache.length>15){var t=this.cache.slice(0,16);return this.cache=this.cache.slice(16),t}return null};eA.prototype.flush=function(){for(var t=16-this.cache.length,e=kh.allocUnsafe(t),r=-1;++r<t;)e.writeUInt8(t,r);return kh.concat([this.cache,e])};function fee(t,e,r){var n=uee[t.toLowerCase()];if(!n)throw new TypeError("invalid suite type");if(typeof e=="string"&&(e=kh.from(e)),e.length!==n.key/8)throw new TypeError("invalid key length "+e.length);if(typeof r=="string"&&(r=kh.from(r)),n.mode!=="GCM"&&r.length!==n.iv)throw new TypeError("invalid iv length "+r.length);return n.type==="stream"?new jke(n.module,e,r):n.type==="auth"?new Cke(n.module,e,r):new DE(n.module,e,r)}function qke(t,e){var r=uee[t.toLowerCase()];if(!r)throw new TypeError("invalid suite type");var n=Nke(e,!1,r.key,r.iv);return fee(t,n.key,n.iv)}G7.createCipheriv=fee;G7.createCipher=qke});var gee=W(J7=>{f();var Lke=V7(),i1=ur().Buffer,pee=ZT(),Fke=W7(),yee=Th(),zke=BE(),Vke=ME(),Hke=Vt();function CE(t,e,r){yee.call(this),this._cache=new tA,this._last=void 0,this._cipher=new zke.AES(e),this._prev=i1.from(r),this._mode=t,this._autopadding=!0}Hke(CE,yee);CE.prototype._update=function(t){this._cache.add(t);for(var e,r,n=[];e=this._cache.get(this._autopadding);)r=this._mode.decrypt(this,e),n.push(r);return i1.concat(n)};CE.prototype._final=function(){var t=this._cache.flush();if(this._autopadding)return Wke(this._mode.decrypt(this,t));if(t)throw new Error("data not multiple of block length")};CE.prototype.setAutoPadding=function(t){return this._autopadding=!!t,this};function tA(){this.cache=i1.allocUnsafe(0)}tA.prototype.add=function(t){this.cache=i1.concat([this.cache,t])};tA.prototype.get=function(t){var e;if(t){if(this.cache.length>16)return e=this.cache.slice(0,16),this.cache=this.cache.slice(16),e}else if(this.cache.length>=16)return e=this.cache.slice(0,16),this.cache=this.cache.slice(16),e;return null};tA.prototype.flush=function(){if(this.cache.length)return this.cache};function Wke(t){var e=t[15];if(e<1||e>16)throw new Error("unable to decrypt data");for(var r=-1;++r<e;)if(t[r+(16-e)]!==e)throw new Error("unable to decrypt data");if(e!==16)return t.slice(0,16-e)}function mee(t,e,r){var n=pee[t.toLowerCase()];if(!n)throw new TypeError("invalid suite type");if(typeof r=="string"&&(r=i1.from(r)),n.mode!=="GCM"&&r.length!==n.iv)throw new TypeError("invalid iv length "+r.length);if(typeof e=="string"&&(e=i1.from(e)),e.length!==n.key/8)throw new TypeError("invalid key length "+e.length);return n.type==="stream"?new Fke(n.module,e,r,!0):n.type==="auth"?new Lke(n.module,e,r,!0):new CE(n.module,e,r)}function Gke(t,e){var r=pee[t.toLowerCase()];if(!r)throw new TypeError("invalid suite type");var n=Vke(e,!1,r.key,r.iv);return mee(t,n.key,n.iv)}J7.createDecipher=Gke;J7.createDecipheriv=mee});var rA=W(Cu=>{f();var vee=hee(),bee=gee(),Jke=q7();function Yke(){return Object.keys(Jke)}Cu.createCipher=Cu.Cipher=vee.createCipher;Cu.createCipheriv=Cu.Cipheriv=vee.createCipheriv;Cu.createDecipher=Cu.Decipher=bee.createDecipher;Cu.createDecipheriv=Cu.Decipheriv=bee.createDecipheriv;Cu.listCiphers=Cu.getCiphers=Yke});var wee=W(Ph=>{f();Ph["des-ecb"]={key:8,iv:0};Ph["des-cbc"]=Ph.des={key:8,iv:8};Ph["des-ede3-cbc"]=Ph.des3={key:24,iv:8};Ph["des-ede3"]={key:24,iv:0};Ph["des-ede-cbc"]={key:16,iv:8};Ph["des-ede"]={key:16,iv:0}});var Tee=W(ju=>{f();var _ee=CQ(),Y7=rA(),$y=ZT(),Ih=wee(),xee=ME();function Zke(t,e){t=t.toLowerCase();var r,n;if($y[t])r=$y[t].key,n=$y[t].iv;else if(Ih[t])r=Ih[t].key*8,n=Ih[t].iv;else throw new TypeError("invalid suite type");var i=xee(e,!1,r,n);return Eee(t,i.key,i.iv)}function Xke(t,e){t=t.toLowerCase();var r,n;if($y[t])r=$y[t].key,n=$y[t].iv;else if(Ih[t])r=Ih[t].key*8,n=Ih[t].iv;else throw new TypeError("invalid suite type");var i=xee(e,!1,r,n);return See(t,i.key,i.iv)}function Eee(t,e,r){if(t=t.toLowerCase(),$y[t])return Y7.createCipheriv(t,e,r);if(Ih[t])return new _ee({key:e,iv:r,mode:t});throw new TypeError("invalid suite type")}function See(t,e,r){if(t=t.toLowerCase(),$y[t])return Y7.createDecipheriv(t,e,r);if(Ih[t])return new _ee({key:e,iv:r,mode:t,decrypt:!0});throw new TypeError("invalid suite type")}function Qke(){return Object.keys(Ih).concat(Y7.getCiphers())}ju.createCipher=ju.Cipher=Zke;ju.createCipheriv=ju.Cipheriv=Eee;ju.createDecipher=ju.Decipher=Xke;ju.createDecipheriv=ju.Decipheriv=See;ju.listCiphers=ju.getCiphers=Qke});var Z7=W(()=>{f()});var Do=W((Aee,X7)=>{f();(function(t,e){"use strict";function r(q,k){if(!q)throw new Error(k||"Assertion failed")}function n(q,k){q.super_=k;var P=function(){};P.prototype=k.prototype,q.prototype=new P,q.prototype.constructor=q}function i(q,k,P){if(i.isBN(q))return q;this.negative=0,this.words=null,this.length=0,this.red=null,q!==null&&((k==="le"||k==="be")&&(P=k,k=10),this._init(q||0,k||10,P||"be"))}typeof t=="object"?t.exports=i:e.BN=i,i.BN=i,i.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=Z7().Buffer}catch{}i.isBN=function(k){return k instanceof i?!0:k!==null&&typeof k=="object"&&k.constructor.wordSize===i.wordSize&&Array.isArray(k.words)},i.max=function(k,P){return k.cmp(P)>0?k:P},i.min=function(k,P){return k.cmp(P)<0?k:P},i.prototype._init=function(k,P,B){if(typeof k=="number")return this._initNumber(k,P,B);if(typeof k=="object")return this._initArray(k,P,B);P==="hex"&&(P=16),r(P===(P|0)&&P>=2&&P<=36),k=k.toString().replace(/\s+/g,"");var p=0;k[0]==="-"&&(p++,this.negative=1),p<k.length&&(P===16?this._parseHex(k,p,B):(this._parseBase(k,P,p),B==="le"&&this._initArray(this.toArray(),P,B)))},i.prototype._initNumber=function(k,P,B){k<0&&(this.negative=1,k=-k),k<67108864?(this.words=[k&67108863],this.length=1):k<4503599627370496?(this.words=[k&67108863,k/67108864&67108863],this.length=2):(r(k<9007199254740992),this.words=[k&67108863,k/67108864&67108863,1],this.length=3),B==="le"&&this._initArray(this.toArray(),P,B)},i.prototype._initArray=function(k,P,B){if(r(typeof k.length=="number"),k.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(k.length/3),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m,w,E=0;if(B==="be")for(p=k.length-1,m=0;p>=0;p-=3)w=k[p]|k[p-1]<<8|k[p-2]<<16,this.words[m]|=w<<E&67108863,this.words[m+1]=w>>>26-E&67108863,E+=24,E>=26&&(E-=26,m++);else if(B==="le")for(p=0,m=0;p<k.length;p+=3)w=k[p]|k[p+1]<<8|k[p+2]<<16,this.words[m]|=w<<E&67108863,this.words[m+1]=w>>>26-E&67108863,E+=24,E>=26&&(E-=26,m++);return this.strip()};function s(q,k){var P=q.charCodeAt(k);return P>=65&&P<=70?P-55:P>=97&&P<=102?P-87:P-48&15}function a(q,k,P){var B=s(q,P);return P-1>=k&&(B|=s(q,P-1)<<4),B}i.prototype._parseHex=function(k,P,B){this.length=Math.ceil((k.length-P)/6),this.words=new Array(this.length);for(var p=0;p<this.length;p++)this.words[p]=0;var m=0,w=0,E;if(B==="be")for(p=k.length-1;p>=P;p-=2)E=a(k,P,p)<<m,this.words[w]|=E&67108863,m>=18?(m-=18,w+=1,this.words[w]|=E>>>26):m+=8;else{var _=k.length-P;for(p=_%2===0?P+1:P;p<k.length;p+=2)E=a(k,P,p)<<m,this.words[w]|=E&67108863,m>=18?(m-=18,w+=1,this.words[w]|=E>>>26):m+=8}this.strip()};function d(q,k,P,B){for(var p=0,m=Math.min(q.length,P),w=k;w<m;w++){var E=q.charCodeAt(w)-48;p*=B,E>=49?p+=E-49+10:E>=17?p+=E-17+10:p+=E}return p}i.prototype._parseBase=function(k,P,B){this.words=[0],this.length=1;for(var p=0,m=1;m<=67108863;m*=P)p++;p--,m=m/P|0;for(var w=k.length-B,E=w%p,_=Math.min(w,w-E)+B,b=0,C=B;C<_;C+=p)b=d(k,C,C+p,P),this.imuln(m),this.words[0]+b<67108864?this.words[0]+=b:this._iaddn(b);if(E!==0){var N=1;for(b=d(k,C,k.length,P),C=0;C<E;C++)N*=P;this.imuln(N),this.words[0]+b<67108864?this.words[0]+=b:this._iaddn(b)}this.strip()},i.prototype.copy=function(k){k.words=new Array(this.length);for(var P=0;P<this.length;P++)k.words[P]=this.words[P];k.length=this.length,k.negative=this.negative,k.red=this.red},i.prototype.clone=function(){var k=new i(null);return this.copy(k),k},i.prototype._expand=function(k){for(;this.length<k;)this.words[this.length++]=0;return this},i.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},i.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var u=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],c=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],l=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(k,P){k=k||10,P=P|0||1;var B;if(k===16||k==="hex"){B="";for(var p=0,m=0,w=0;w<this.length;w++){var E=this.words[w],_=((E<<p|m)&16777215).toString(16);m=E>>>24-p&16777215,m!==0||w!==this.length-1?B=u[6-_.length]+_+B:B=_+B,p+=2,p>=26&&(p-=26,w--)}for(m!==0&&(B=m.toString(16)+B);B.length%P!==0;)B="0"+B;return this.negative!==0&&(B="-"+B),B}if(k===(k|0)&&k>=2&&k<=36){var b=c[k],C=l[k];B="";var N=this.clone();for(N.negative=0;!N.isZero();){var D=N.modn(C).toString(k);N=N.idivn(C),N.isZero()?B=D+B:B=u[b-D.length]+D+B}for(this.isZero()&&(B="0"+B);B.length%P!==0;)B="0"+B;return this.negative!==0&&(B="-"+B),B}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var k=this.words[0];return this.length===2?k+=this.words[1]*67108864:this.length===3&&this.words[2]===1?k+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-k:k},i.prototype.toJSON=function(){return this.toString(16)},i.prototype.toBuffer=function(k,P){return r(typeof o<"u"),this.toArrayLike(o,k,P)},i.prototype.toArray=function(k,P){return this.toArrayLike(Array,k,P)},i.prototype.toArrayLike=function(k,P,B){var p=this.byteLength(),m=B||Math.max(1,p);r(p<=m,"byte array longer than desired length"),r(m>0,"Requested array length <= 0"),this.strip();var w=P==="le",E=new k(m),_,b,C=this.clone();if(w){for(b=0;!C.isZero();b++)_=C.andln(255),C.iushrn(8),E[b]=_;for(;b<m;b++)E[b]=0}else{for(b=0;b<m-p;b++)E[b]=0;for(b=0;!C.isZero();b++)_=C.andln(255),C.iushrn(8),E[m-b-1]=_}return E},Math.clz32?i.prototype._countBits=function(k){return 32-Math.clz32(k)}:i.prototype._countBits=function(k){var P=k,B=0;return P>=4096&&(B+=13,P>>>=13),P>=64&&(B+=7,P>>>=7),P>=8&&(B+=4,P>>>=4),P>=2&&(B+=2,P>>>=2),B+P},i.prototype._zeroBits=function(k){if(k===0)return 26;var P=k,B=0;return P&8191||(B+=13,P>>>=13),P&127||(B+=7,P>>>=7),P&15||(B+=4,P>>>=4),P&3||(B+=2,P>>>=2),P&1||B++,B},i.prototype.bitLength=function(){var k=this.words[this.length-1],P=this._countBits(k);return(this.length-1)*26+P};function h(q){for(var k=new Array(q.bitLength()),P=0;P<k.length;P++){var B=P/26|0,p=P%26;k[P]=(q.words[B]&1<<p)>>>p}return k}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var k=0,P=0;P<this.length;P++){var B=this._zeroBits(this.words[P]);if(k+=B,B!==26)break}return k},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(k){return this.negative!==0?this.abs().inotn(k).iaddn(1):this.clone()},i.prototype.fromTwos=function(k){return this.testn(k-1)?this.notn(k).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(k){for(;this.length<k.length;)this.words[this.length++]=0;for(var P=0;P<k.length;P++)this.words[P]=this.words[P]|k.words[P];return this.strip()},i.prototype.ior=function(k){return r((this.negative|k.negative)===0),this.iuor(k)},i.prototype.or=function(k){return this.length>k.length?this.clone().ior(k):k.clone().ior(this)},i.prototype.uor=function(k){return this.length>k.length?this.clone().iuor(k):k.clone().iuor(this)},i.prototype.iuand=function(k){var P;this.length>k.length?P=k:P=this;for(var B=0;B<P.length;B++)this.words[B]=this.words[B]&k.words[B];return this.length=P.length,this.strip()},i.prototype.iand=function(k){return r((this.negative|k.negative)===0),this.iuand(k)},i.prototype.and=function(k){return this.length>k.length?this.clone().iand(k):k.clone().iand(this)},i.prototype.uand=function(k){return this.length>k.length?this.clone().iuand(k):k.clone().iuand(this)},i.prototype.iuxor=function(k){var P,B;this.length>k.length?(P=this,B=k):(P=k,B=this);for(var p=0;p<B.length;p++)this.words[p]=P.words[p]^B.words[p];if(this!==P)for(;p<P.length;p++)this.words[p]=P.words[p];return this.length=P.length,this.strip()},i.prototype.ixor=function(k){return r((this.negative|k.negative)===0),this.iuxor(k)},i.prototype.xor=function(k){return this.length>k.length?this.clone().ixor(k):k.clone().ixor(this)},i.prototype.uxor=function(k){return this.length>k.length?this.clone().iuxor(k):k.clone().iuxor(this)},i.prototype.inotn=function(k){r(typeof k=="number"&&k>=0);var P=Math.ceil(k/26)|0,B=k%26;this._expand(P),B>0&&P--;for(var p=0;p<P;p++)this.words[p]=~this.words[p]&67108863;return B>0&&(this.words[p]=~this.words[p]&67108863>>26-B),this.strip()},i.prototype.notn=function(k){return this.clone().inotn(k)},i.prototype.setn=function(k,P){r(typeof k=="number"&&k>=0);var B=k/26|0,p=k%26;return this._expand(B+1),P?this.words[B]=this.words[B]|1<<p:this.words[B]=this.words[B]&~(1<<p),this.strip()},i.prototype.iadd=function(k){var P;if(this.negative!==0&&k.negative===0)return this.negative=0,P=this.isub(k),this.negative^=1,this._normSign();if(this.negative===0&&k.negative!==0)return k.negative=0,P=this.isub(k),k.negative=1,P._normSign();var B,p;this.length>k.length?(B=this,p=k):(B=k,p=this);for(var m=0,w=0;w<p.length;w++)P=(B.words[w]|0)+(p.words[w]|0)+m,this.words[w]=P&67108863,m=P>>>26;for(;m!==0&&w<B.length;w++)P=(B.words[w]|0)+m,this.words[w]=P&67108863,m=P>>>26;if(this.length=B.length,m!==0)this.words[this.length]=m,this.length++;else if(B!==this)for(;w<B.length;w++)this.words[w]=B.words[w];return this},i.prototype.add=function(k){var P;return k.negative!==0&&this.negative===0?(k.negative=0,P=this.sub(k),k.negative^=1,P):k.negative===0&&this.negative!==0?(this.negative=0,P=k.sub(this),this.negative=1,P):this.length>k.length?this.clone().iadd(k):k.clone().iadd(this)},i.prototype.isub=function(k){if(k.negative!==0){k.negative=0;var P=this.iadd(k);return k.negative=1,P._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(k),this.negative=1,this._normSign();var B=this.cmp(k);if(B===0)return this.negative=0,this.length=1,this.words[0]=0,this;var p,m;B>0?(p=this,m=k):(p=k,m=this);for(var w=0,E=0;E<m.length;E++)P=(p.words[E]|0)-(m.words[E]|0)+w,w=P>>26,this.words[E]=P&67108863;for(;w!==0&&E<p.length;E++)P=(p.words[E]|0)+w,w=P>>26,this.words[E]=P&67108863;if(w===0&&E<p.length&&p!==this)for(;E<p.length;E++)this.words[E]=p.words[E];return this.length=Math.max(this.length,E),p!==this&&(this.negative=1),this.strip()},i.prototype.sub=function(k){return this.clone().isub(k)};function y(q,k,P){P.negative=k.negative^q.negative;var B=q.length+k.length|0;P.length=B,B=B-1|0;var p=q.words[0]|0,m=k.words[0]|0,w=p*m,E=w&67108863,_=w/67108864|0;P.words[0]=E;for(var b=1;b<B;b++){for(var C=_>>>26,N=_&67108863,D=Math.min(b,k.length-1),U=Math.max(0,b-q.length+1);U<=D;U++){var G=b-U|0;p=q.words[G]|0,m=k.words[U]|0,w=p*m+N,C+=w/67108864|0,N=w&67108863}P.words[b]=N|0,_=C|0}return _!==0?P.words[b]=_|0:P.length--,P.strip()}var g=function(k,P,B){var p=k.words,m=P.words,w=B.words,E=0,_,b,C,N=p[0]|0,D=N&8191,U=N>>>13,G=p[1]|0,Y=G&8191,J=G>>>13,H=p[2]|0,X=H&8191,te=H>>>13,ne=p[3]|0,Q=ne&8191,re=ne>>>13,ae=p[4]|0,he=ae&8191,ge=ae>>>13,ie=p[5]|0,pe=ie&8191,be=ie>>>13,Ue=p[6]|0,ke=Ue&8191,it=Ue>>>13,St=p[7]|0,Fe=St&8191,mt=St>>>13,In=p[8]|0,Pe=In&8191,Te=In>>>13,Wt=p[9]|0,Re=Wt&8191,xe=Wt>>>13,qr=m[0]|0,We=qr&8191,Ye=qr>>>13,an=m[1]|0,Bt=an&8191,Ze=an>>>13,xd=m[2]|0,Ot=xd&8191,qt=xd>>>13,j0=m[3]|0,Nt=j0&8191,Xt=j0>>>13,Ed=m[4]|0,Qt=Ed&8191,Gt=Ed>>>13,$0=m[5]|0,Lt=$0&8191,Jt=$0>>>13,N0=m[6]|0,Yt=N0&8191,er=N0>>>13,oy=m[7]|0,ee=oy&8191,Z=oy>>>13,oe=m[8]|0,ce=oe&8191,ue=oe>>>13,$e=m[9]|0,Be=$e&8191,Ne=$e>>>13;B.negative=k.negative^P.negative,B.length=19,_=Math.imul(D,We),b=Math.imul(D,Ye),b=b+Math.imul(U,We)|0,C=Math.imul(U,Ye);var Br=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(Br>>>26)|0,Br&=67108863,_=Math.imul(Y,We),b=Math.imul(Y,Ye),b=b+Math.imul(J,We)|0,C=Math.imul(J,Ye),_=_+Math.imul(D,Bt)|0,b=b+Math.imul(D,Ze)|0,b=b+Math.imul(U,Bt)|0,C=C+Math.imul(U,Ze)|0;var Ft=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(Ft>>>26)|0,Ft&=67108863,_=Math.imul(X,We),b=Math.imul(X,Ye),b=b+Math.imul(te,We)|0,C=Math.imul(te,Ye),_=_+Math.imul(Y,Bt)|0,b=b+Math.imul(Y,Ze)|0,b=b+Math.imul(J,Bt)|0,C=C+Math.imul(J,Ze)|0,_=_+Math.imul(D,Ot)|0,b=b+Math.imul(D,qt)|0,b=b+Math.imul(U,Ot)|0,C=C+Math.imul(U,qt)|0;var pt=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(pt>>>26)|0,pt&=67108863,_=Math.imul(Q,We),b=Math.imul(Q,Ye),b=b+Math.imul(re,We)|0,C=Math.imul(re,Ye),_=_+Math.imul(X,Bt)|0,b=b+Math.imul(X,Ze)|0,b=b+Math.imul(te,Bt)|0,C=C+Math.imul(te,Ze)|0,_=_+Math.imul(Y,Ot)|0,b=b+Math.imul(Y,qt)|0,b=b+Math.imul(J,Ot)|0,C=C+Math.imul(J,qt)|0,_=_+Math.imul(D,Nt)|0,b=b+Math.imul(D,Xt)|0,b=b+Math.imul(U,Nt)|0,C=C+Math.imul(U,Xt)|0;var tn=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(tn>>>26)|0,tn&=67108863,_=Math.imul(he,We),b=Math.imul(he,Ye),b=b+Math.imul(ge,We)|0,C=Math.imul(ge,Ye),_=_+Math.imul(Q,Bt)|0,b=b+Math.imul(Q,Ze)|0,b=b+Math.imul(re,Bt)|0,C=C+Math.imul(re,Ze)|0,_=_+Math.imul(X,Ot)|0,b=b+Math.imul(X,qt)|0,b=b+Math.imul(te,Ot)|0,C=C+Math.imul(te,qt)|0,_=_+Math.imul(Y,Nt)|0,b=b+Math.imul(Y,Xt)|0,b=b+Math.imul(J,Nt)|0,C=C+Math.imul(J,Xt)|0,_=_+Math.imul(D,Qt)|0,b=b+Math.imul(D,Gt)|0,b=b+Math.imul(U,Qt)|0,C=C+Math.imul(U,Gt)|0;var yn=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(yn>>>26)|0,yn&=67108863,_=Math.imul(pe,We),b=Math.imul(pe,Ye),b=b+Math.imul(be,We)|0,C=Math.imul(be,Ye),_=_+Math.imul(he,Bt)|0,b=b+Math.imul(he,Ze)|0,b=b+Math.imul(ge,Bt)|0,C=C+Math.imul(ge,Ze)|0,_=_+Math.imul(Q,Ot)|0,b=b+Math.imul(Q,qt)|0,b=b+Math.imul(re,Ot)|0,C=C+Math.imul(re,qt)|0,_=_+Math.imul(X,Nt)|0,b=b+Math.imul(X,Xt)|0,b=b+Math.imul(te,Nt)|0,C=C+Math.imul(te,Xt)|0,_=_+Math.imul(Y,Qt)|0,b=b+Math.imul(Y,Gt)|0,b=b+Math.imul(J,Qt)|0,C=C+Math.imul(J,Gt)|0,_=_+Math.imul(D,Lt)|0,b=b+Math.imul(D,Jt)|0,b=b+Math.imul(U,Lt)|0,C=C+Math.imul(U,Jt)|0;var Zr=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(Zr>>>26)|0,Zr&=67108863,_=Math.imul(ke,We),b=Math.imul(ke,Ye),b=b+Math.imul(it,We)|0,C=Math.imul(it,Ye),_=_+Math.imul(pe,Bt)|0,b=b+Math.imul(pe,Ze)|0,b=b+Math.imul(be,Bt)|0,C=C+Math.imul(be,Ze)|0,_=_+Math.imul(he,Ot)|0,b=b+Math.imul(he,qt)|0,b=b+Math.imul(ge,Ot)|0,C=C+Math.imul(ge,qt)|0,_=_+Math.imul(Q,Nt)|0,b=b+Math.imul(Q,Xt)|0,b=b+Math.imul(re,Nt)|0,C=C+Math.imul(re,Xt)|0,_=_+Math.imul(X,Qt)|0,b=b+Math.imul(X,Gt)|0,b=b+Math.imul(te,Qt)|0,C=C+Math.imul(te,Gt)|0,_=_+Math.imul(Y,Lt)|0,b=b+Math.imul(Y,Jt)|0,b=b+Math.imul(J,Lt)|0,C=C+Math.imul(J,Jt)|0,_=_+Math.imul(D,Yt)|0,b=b+Math.imul(D,er)|0,b=b+Math.imul(U,Yt)|0,C=C+Math.imul(U,er)|0;var dr=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(dr>>>26)|0,dr&=67108863,_=Math.imul(Fe,We),b=Math.imul(Fe,Ye),b=b+Math.imul(mt,We)|0,C=Math.imul(mt,Ye),_=_+Math.imul(ke,Bt)|0,b=b+Math.imul(ke,Ze)|0,b=b+Math.imul(it,Bt)|0,C=C+Math.imul(it,Ze)|0,_=_+Math.imul(pe,Ot)|0,b=b+Math.imul(pe,qt)|0,b=b+Math.imul(be,Ot)|0,C=C+Math.imul(be,qt)|0,_=_+Math.imul(he,Nt)|0,b=b+Math.imul(he,Xt)|0,b=b+Math.imul(ge,Nt)|0,C=C+Math.imul(ge,Xt)|0,_=_+Math.imul(Q,Qt)|0,b=b+Math.imul(Q,Gt)|0,b=b+Math.imul(re,Qt)|0,C=C+Math.imul(re,Gt)|0,_=_+Math.imul(X,Lt)|0,b=b+Math.imul(X,Jt)|0,b=b+Math.imul(te,Lt)|0,C=C+Math.imul(te,Jt)|0,_=_+Math.imul(Y,Yt)|0,b=b+Math.imul(Y,er)|0,b=b+Math.imul(J,Yt)|0,C=C+Math.imul(J,er)|0,_=_+Math.imul(D,ee)|0,b=b+Math.imul(D,Z)|0,b=b+Math.imul(U,ee)|0,C=C+Math.imul(U,Z)|0;var rn=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(rn>>>26)|0,rn&=67108863,_=Math.imul(Pe,We),b=Math.imul(Pe,Ye),b=b+Math.imul(Te,We)|0,C=Math.imul(Te,Ye),_=_+Math.imul(Fe,Bt)|0,b=b+Math.imul(Fe,Ze)|0,b=b+Math.imul(mt,Bt)|0,C=C+Math.imul(mt,Ze)|0,_=_+Math.imul(ke,Ot)|0,b=b+Math.imul(ke,qt)|0,b=b+Math.imul(it,Ot)|0,C=C+Math.imul(it,qt)|0,_=_+Math.imul(pe,Nt)|0,b=b+Math.imul(pe,Xt)|0,b=b+Math.imul(be,Nt)|0,C=C+Math.imul(be,Xt)|0,_=_+Math.imul(he,Qt)|0,b=b+Math.imul(he,Gt)|0,b=b+Math.imul(ge,Qt)|0,C=C+Math.imul(ge,Gt)|0,_=_+Math.imul(Q,Lt)|0,b=b+Math.imul(Q,Jt)|0,b=b+Math.imul(re,Lt)|0,C=C+Math.imul(re,Jt)|0,_=_+Math.imul(X,Yt)|0,b=b+Math.imul(X,er)|0,b=b+Math.imul(te,Yt)|0,C=C+Math.imul(te,er)|0,_=_+Math.imul(Y,ee)|0,b=b+Math.imul(Y,Z)|0,b=b+Math.imul(J,ee)|0,C=C+Math.imul(J,Z)|0,_=_+Math.imul(D,ce)|0,b=b+Math.imul(D,ue)|0,b=b+Math.imul(U,ce)|0,C=C+Math.imul(U,ue)|0;var Nr=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,_=Math.imul(Re,We),b=Math.imul(Re,Ye),b=b+Math.imul(xe,We)|0,C=Math.imul(xe,Ye),_=_+Math.imul(Pe,Bt)|0,b=b+Math.imul(Pe,Ze)|0,b=b+Math.imul(Te,Bt)|0,C=C+Math.imul(Te,Ze)|0,_=_+Math.imul(Fe,Ot)|0,b=b+Math.imul(Fe,qt)|0,b=b+Math.imul(mt,Ot)|0,C=C+Math.imul(mt,qt)|0,_=_+Math.imul(ke,Nt)|0,b=b+Math.imul(ke,Xt)|0,b=b+Math.imul(it,Nt)|0,C=C+Math.imul(it,Xt)|0,_=_+Math.imul(pe,Qt)|0,b=b+Math.imul(pe,Gt)|0,b=b+Math.imul(be,Qt)|0,C=C+Math.imul(be,Gt)|0,_=_+Math.imul(he,Lt)|0,b=b+Math.imul(he,Jt)|0,b=b+Math.imul(ge,Lt)|0,C=C+Math.imul(ge,Jt)|0,_=_+Math.imul(Q,Yt)|0,b=b+Math.imul(Q,er)|0,b=b+Math.imul(re,Yt)|0,C=C+Math.imul(re,er)|0,_=_+Math.imul(X,ee)|0,b=b+Math.imul(X,Z)|0,b=b+Math.imul(te,ee)|0,C=C+Math.imul(te,Z)|0,_=_+Math.imul(Y,ce)|0,b=b+Math.imul(Y,ue)|0,b=b+Math.imul(J,ce)|0,C=C+Math.imul(J,ue)|0,_=_+Math.imul(D,Be)|0,b=b+Math.imul(D,Ne)|0,b=b+Math.imul(U,Be)|0,C=C+Math.imul(U,Ne)|0;var wa=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(wa>>>26)|0,wa&=67108863,_=Math.imul(Re,Bt),b=Math.imul(Re,Ze),b=b+Math.imul(xe,Bt)|0,C=Math.imul(xe,Ze),_=_+Math.imul(Pe,Ot)|0,b=b+Math.imul(Pe,qt)|0,b=b+Math.imul(Te,Ot)|0,C=C+Math.imul(Te,qt)|0,_=_+Math.imul(Fe,Nt)|0,b=b+Math.imul(Fe,Xt)|0,b=b+Math.imul(mt,Nt)|0,C=C+Math.imul(mt,Xt)|0,_=_+Math.imul(ke,Qt)|0,b=b+Math.imul(ke,Gt)|0,b=b+Math.imul(it,Qt)|0,C=C+Math.imul(it,Gt)|0,_=_+Math.imul(pe,Lt)|0,b=b+Math.imul(pe,Jt)|0,b=b+Math.imul(be,Lt)|0,C=C+Math.imul(be,Jt)|0,_=_+Math.imul(he,Yt)|0,b=b+Math.imul(he,er)|0,b=b+Math.imul(ge,Yt)|0,C=C+Math.imul(ge,er)|0,_=_+Math.imul(Q,ee)|0,b=b+Math.imul(Q,Z)|0,b=b+Math.imul(re,ee)|0,C=C+Math.imul(re,Z)|0,_=_+Math.imul(X,ce)|0,b=b+Math.imul(X,ue)|0,b=b+Math.imul(te,ce)|0,C=C+Math.imul(te,ue)|0,_=_+Math.imul(Y,Be)|0,b=b+Math.imul(Y,Ne)|0,b=b+Math.imul(J,Be)|0,C=C+Math.imul(J,Ne)|0;var Ri=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(Ri>>>26)|0,Ri&=67108863,_=Math.imul(Re,Ot),b=Math.imul(Re,qt),b=b+Math.imul(xe,Ot)|0,C=Math.imul(xe,qt),_=_+Math.imul(Pe,Nt)|0,b=b+Math.imul(Pe,Xt)|0,b=b+Math.imul(Te,Nt)|0,C=C+Math.imul(Te,Xt)|0,_=_+Math.imul(Fe,Qt)|0,b=b+Math.imul(Fe,Gt)|0,b=b+Math.imul(mt,Qt)|0,C=C+Math.imul(mt,Gt)|0,_=_+Math.imul(ke,Lt)|0,b=b+Math.imul(ke,Jt)|0,b=b+Math.imul(it,Lt)|0,C=C+Math.imul(it,Jt)|0,_=_+Math.imul(pe,Yt)|0,b=b+Math.imul(pe,er)|0,b=b+Math.imul(be,Yt)|0,C=C+Math.imul(be,er)|0,_=_+Math.imul(he,ee)|0,b=b+Math.imul(he,Z)|0,b=b+Math.imul(ge,ee)|0,C=C+Math.imul(ge,Z)|0,_=_+Math.imul(Q,ce)|0,b=b+Math.imul(Q,ue)|0,b=b+Math.imul(re,ce)|0,C=C+Math.imul(re,ue)|0,_=_+Math.imul(X,Be)|0,b=b+Math.imul(X,Ne)|0,b=b+Math.imul(te,Be)|0,C=C+Math.imul(te,Ne)|0;var Vi=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(Vi>>>26)|0,Vi&=67108863,_=Math.imul(Re,Nt),b=Math.imul(Re,Xt),b=b+Math.imul(xe,Nt)|0,C=Math.imul(xe,Xt),_=_+Math.imul(Pe,Qt)|0,b=b+Math.imul(Pe,Gt)|0,b=b+Math.imul(Te,Qt)|0,C=C+Math.imul(Te,Gt)|0,_=_+Math.imul(Fe,Lt)|0,b=b+Math.imul(Fe,Jt)|0,b=b+Math.imul(mt,Lt)|0,C=C+Math.imul(mt,Jt)|0,_=_+Math.imul(ke,Yt)|0,b=b+Math.imul(ke,er)|0,b=b+Math.imul(it,Yt)|0,C=C+Math.imul(it,er)|0,_=_+Math.imul(pe,ee)|0,b=b+Math.imul(pe,Z)|0,b=b+Math.imul(be,ee)|0,C=C+Math.imul(be,Z)|0,_=_+Math.imul(he,ce)|0,b=b+Math.imul(he,ue)|0,b=b+Math.imul(ge,ce)|0,C=C+Math.imul(ge,ue)|0,_=_+Math.imul(Q,Be)|0,b=b+Math.imul(Q,Ne)|0,b=b+Math.imul(re,Be)|0,C=C+Math.imul(re,Ne)|0;var Lr=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(Lr>>>26)|0,Lr&=67108863,_=Math.imul(Re,Qt),b=Math.imul(Re,Gt),b=b+Math.imul(xe,Qt)|0,C=Math.imul(xe,Gt),_=_+Math.imul(Pe,Lt)|0,b=b+Math.imul(Pe,Jt)|0,b=b+Math.imul(Te,Lt)|0,C=C+Math.imul(Te,Jt)|0,_=_+Math.imul(Fe,Yt)|0,b=b+Math.imul(Fe,er)|0,b=b+Math.imul(mt,Yt)|0,C=C+Math.imul(mt,er)|0,_=_+Math.imul(ke,ee)|0,b=b+Math.imul(ke,Z)|0,b=b+Math.imul(it,ee)|0,C=C+Math.imul(it,Z)|0,_=_+Math.imul(pe,ce)|0,b=b+Math.imul(pe,ue)|0,b=b+Math.imul(be,ce)|0,C=C+Math.imul(be,ue)|0,_=_+Math.imul(he,Be)|0,b=b+Math.imul(he,Ne)|0,b=b+Math.imul(ge,Be)|0,C=C+Math.imul(ge,Ne)|0;var Bi=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(Bi>>>26)|0,Bi&=67108863,_=Math.imul(Re,Lt),b=Math.imul(Re,Jt),b=b+Math.imul(xe,Lt)|0,C=Math.imul(xe,Jt),_=_+Math.imul(Pe,Yt)|0,b=b+Math.imul(Pe,er)|0,b=b+Math.imul(Te,Yt)|0,C=C+Math.imul(Te,er)|0,_=_+Math.imul(Fe,ee)|0,b=b+Math.imul(Fe,Z)|0,b=b+Math.imul(mt,ee)|0,C=C+Math.imul(mt,Z)|0,_=_+Math.imul(ke,ce)|0,b=b+Math.imul(ke,ue)|0,b=b+Math.imul(it,ce)|0,C=C+Math.imul(it,ue)|0,_=_+Math.imul(pe,Be)|0,b=b+Math.imul(pe,Ne)|0,b=b+Math.imul(be,Be)|0,C=C+Math.imul(be,Ne)|0;var Hi=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(Hi>>>26)|0,Hi&=67108863,_=Math.imul(Re,Yt),b=Math.imul(Re,er),b=b+Math.imul(xe,Yt)|0,C=Math.imul(xe,er),_=_+Math.imul(Pe,ee)|0,b=b+Math.imul(Pe,Z)|0,b=b+Math.imul(Te,ee)|0,C=C+Math.imul(Te,Z)|0,_=_+Math.imul(Fe,ce)|0,b=b+Math.imul(Fe,ue)|0,b=b+Math.imul(mt,ce)|0,C=C+Math.imul(mt,ue)|0,_=_+Math.imul(ke,Be)|0,b=b+Math.imul(ke,Ne)|0,b=b+Math.imul(it,Be)|0,C=C+Math.imul(it,Ne)|0;var Eo=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(Eo>>>26)|0,Eo&=67108863,_=Math.imul(Re,ee),b=Math.imul(Re,Z),b=b+Math.imul(xe,ee)|0,C=Math.imul(xe,Z),_=_+Math.imul(Pe,ce)|0,b=b+Math.imul(Pe,ue)|0,b=b+Math.imul(Te,ce)|0,C=C+Math.imul(Te,ue)|0,_=_+Math.imul(Fe,Be)|0,b=b+Math.imul(Fe,Ne)|0,b=b+Math.imul(mt,Be)|0,C=C+Math.imul(mt,Ne)|0;var _a=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(_a>>>26)|0,_a&=67108863,_=Math.imul(Re,ce),b=Math.imul(Re,ue),b=b+Math.imul(xe,ce)|0,C=Math.imul(xe,ue),_=_+Math.imul(Pe,Be)|0,b=b+Math.imul(Pe,Ne)|0,b=b+Math.imul(Te,Be)|0,C=C+Math.imul(Te,Ne)|0;var rs=(E+_|0)+((b&8191)<<13)|0;E=(C+(b>>>13)|0)+(rs>>>26)|0,rs&=67108863,_=Math.imul(Re,Be),b=Math.imul(Re,Ne),b=b+Math.imul(xe,Be)|0,C=Math.imul(xe,Ne);var Rc=(E+_|0)+((b&8191)<<13)|0;return E=(C+(b>>>13)|0)+(Rc>>>26)|0,Rc&=67108863,w[0]=Br,w[1]=Ft,w[2]=pt,w[3]=tn,w[4]=yn,w[5]=Zr,w[6]=dr,w[7]=rn,w[8]=Nr,w[9]=wa,w[10]=Ri,w[11]=Vi,w[12]=Lr,w[13]=Bi,w[14]=Hi,w[15]=Eo,w[16]=_a,w[17]=rs,w[18]=Rc,E!==0&&(w[19]=E,B.length++),B};Math.imul||(g=y);function v(q,k,P){P.negative=k.negative^q.negative,P.length=q.length+k.length;for(var B=0,p=0,m=0;m<P.length-1;m++){var w=p;p=0;for(var E=B&67108863,_=Math.min(m,k.length-1),b=Math.max(0,m-q.length+1);b<=_;b++){var C=m-b,N=q.words[C]|0,D=k.words[b]|0,U=N*D,G=U&67108863;w=w+(U/67108864|0)|0,G=G+E|0,E=G&67108863,w=w+(G>>>26)|0,p+=w>>>26,w&=67108863}P.words[m]=E,B=w,w=p}return B!==0?P.words[m]=B:P.length--,P.strip()}function x(q,k,P){var B=new S;return B.mulp(q,k,P)}i.prototype.mulTo=function(k,P){var B,p=this.length+k.length;return this.length===10&&k.length===10?B=g(this,k,P):p<63?B=y(this,k,P):p<1024?B=v(this,k,P):B=x(this,k,P),B};function S(q,k){this.x=q,this.y=k}S.prototype.makeRBT=function(k){for(var P=new Array(k),B=i.prototype._countBits(k)-1,p=0;p<k;p++)P[p]=this.revBin(p,B,k);return P},S.prototype.revBin=function(k,P,B){if(k===0||k===B-1)return k;for(var p=0,m=0;m<P;m++)p|=(k&1)<<P-m-1,k>>=1;return p},S.prototype.permute=function(k,P,B,p,m,w){for(var E=0;E<w;E++)p[E]=P[k[E]],m[E]=B[k[E]]},S.prototype.transform=function(k,P,B,p,m,w){this.permute(w,k,P,B,p,m);for(var E=1;E<m;E<<=1)for(var _=E<<1,b=Math.cos(2*Math.PI/_),C=Math.sin(2*Math.PI/_),N=0;N<m;N+=_)for(var D=b,U=C,G=0;G<E;G++){var Y=B[N+G],J=p[N+G],H=B[N+G+E],X=p[N+G+E],te=D*H-U*X;X=D*X+U*H,H=te,B[N+G]=Y+H,p[N+G]=J+X,B[N+G+E]=Y-H,p[N+G+E]=J-X,G!==_&&(te=b*D-C*U,U=b*U+C*D,D=te)}},S.prototype.guessLen13b=function(k,P){var B=Math.max(P,k)|1,p=B&1,m=0;for(B=B/2|0;B;B=B>>>1)m++;return 1<<m+1+p},S.prototype.conjugate=function(k,P,B){if(!(B<=1))for(var p=0;p<B/2;p++){var m=k[p];k[p]=k[B-p-1],k[B-p-1]=m,m=P[p],P[p]=-P[B-p-1],P[B-p-1]=-m}},S.prototype.normalize13b=function(k,P){for(var B=0,p=0;p<P/2;p++){var m=Math.round(k[2*p+1]/P)*8192+Math.round(k[2*p]/P)+B;k[p]=m&67108863,m<67108864?B=0:B=m/67108864|0}return k},S.prototype.convert13b=function(k,P,B,p){for(var m=0,w=0;w<P;w++)m=m+(k[w]|0),B[2*w]=m&8191,m=m>>>13,B[2*w+1]=m&8191,m=m>>>13;for(w=2*P;w<p;++w)B[w]=0;r(m===0),r((m&-8192)===0)},S.prototype.stub=function(k){for(var P=new Array(k),B=0;B<k;B++)P[B]=0;return P},S.prototype.mulp=function(k,P,B){var p=2*this.guessLen13b(k.length,P.length),m=this.makeRBT(p),w=this.stub(p),E=new Array(p),_=new Array(p),b=new Array(p),C=new Array(p),N=new Array(p),D=new Array(p),U=B.words;U.length=p,this.convert13b(k.words,k.length,E,p),this.convert13b(P.words,P.length,C,p),this.transform(E,w,_,b,p,m),this.transform(C,w,N,D,p,m);for(var G=0;G<p;G++){var Y=_[G]*N[G]-b[G]*D[G];b[G]=_[G]*D[G]+b[G]*N[G],_[G]=Y}return this.conjugate(_,b,p),this.transform(_,b,U,w,p,m),this.conjugate(U,w,p),this.normalize13b(U,p),B.negative=k.negative^P.negative,B.length=k.length+P.length,B.strip()},i.prototype.mul=function(k){var P=new i(null);return P.words=new Array(this.length+k.length),this.mulTo(k,P)},i.prototype.mulf=function(k){var P=new i(null);return P.words=new Array(this.length+k.length),x(this,k,P)},i.prototype.imul=function(k){return this.clone().mulTo(k,this)},i.prototype.imuln=function(k){r(typeof k=="number"),r(k<67108864);for(var P=0,B=0;B<this.length;B++){var p=(this.words[B]|0)*k,m=(p&67108863)+(P&67108863);P>>=26,P+=p/67108864|0,P+=m>>>26,this.words[B]=m&67108863}return P!==0&&(this.words[B]=P,this.length++),this},i.prototype.muln=function(k){return this.clone().imuln(k)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(k){var P=h(k);if(P.length===0)return new i(1);for(var B=this,p=0;p<P.length&&P[p]===0;p++,B=B.sqr());if(++p<P.length)for(var m=B.sqr();p<P.length;p++,m=m.sqr())P[p]!==0&&(B=B.mul(m));return B},i.prototype.iushln=function(k){r(typeof k=="number"&&k>=0);var P=k%26,B=(k-P)/26,p=67108863>>>26-P<<26-P,m;if(P!==0){var w=0;for(m=0;m<this.length;m++){var E=this.words[m]&p,_=(this.words[m]|0)-E<<P;this.words[m]=_|w,w=E>>>26-P}w&&(this.words[m]=w,this.length++)}if(B!==0){for(m=this.length-1;m>=0;m--)this.words[m+B]=this.words[m];for(m=0;m<B;m++)this.words[m]=0;this.length+=B}return this.strip()},i.prototype.ishln=function(k){return r(this.negative===0),this.iushln(k)},i.prototype.iushrn=function(k,P,B){r(typeof k=="number"&&k>=0);var p;P?p=(P-P%26)/26:p=0;var m=k%26,w=Math.min((k-m)/26,this.length),E=67108863^67108863>>>m<<m,_=B;if(p-=w,p=Math.max(0,p),_){for(var b=0;b<w;b++)_.words[b]=this.words[b];_.length=w}if(w!==0)if(this.length>w)for(this.length-=w,b=0;b<this.length;b++)this.words[b]=this.words[b+w];else this.words[0]=0,this.length=1;var C=0;for(b=this.length-1;b>=0&&(C!==0||b>=p);b--){var N=this.words[b]|0;this.words[b]=C<<26-m|N>>>m,C=N&E}return _&&C!==0&&(_.words[_.length++]=C),this.length===0&&(this.words[0]=0,this.length=1),this.strip()},i.prototype.ishrn=function(k,P,B){return r(this.negative===0),this.iushrn(k,P,B)},i.prototype.shln=function(k){return this.clone().ishln(k)},i.prototype.ushln=function(k){return this.clone().iushln(k)},i.prototype.shrn=function(k){return this.clone().ishrn(k)},i.prototype.ushrn=function(k){return this.clone().iushrn(k)},i.prototype.testn=function(k){r(typeof k=="number"&&k>=0);var P=k%26,B=(k-P)/26,p=1<<P;if(this.length<=B)return!1;var m=this.words[B];return!!(m&p)},i.prototype.imaskn=function(k){r(typeof k=="number"&&k>=0);var P=k%26,B=(k-P)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=B)return this;if(P!==0&&B++,this.length=Math.min(B,this.length),P!==0){var p=67108863^67108863>>>P<<P;this.words[this.length-1]&=p}return this.strip()},i.prototype.maskn=function(k){return this.clone().imaskn(k)},i.prototype.iaddn=function(k){return r(typeof k=="number"),r(k<67108864),k<0?this.isubn(-k):this.negative!==0?this.length===1&&(this.words[0]|0)<k?(this.words[0]=k-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(k),this.negative=1,this):this._iaddn(k)},i.prototype._iaddn=function(k){this.words[0]+=k;for(var P=0;P<this.length&&this.words[P]>=67108864;P++)this.words[P]-=67108864,P===this.length-1?this.words[P+1]=1:this.words[P+1]++;return this.length=Math.max(this.length,P+1),this},i.prototype.isubn=function(k){if(r(typeof k=="number"),r(k<67108864),k<0)return this.iaddn(-k);if(this.negative!==0)return this.negative=0,this.iaddn(k),this.negative=1,this;if(this.words[0]-=k,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var P=0;P<this.length&&this.words[P]<0;P++)this.words[P]+=67108864,this.words[P+1]-=1;return this.strip()},i.prototype.addn=function(k){return this.clone().iaddn(k)},i.prototype.subn=function(k){return this.clone().isubn(k)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(k,P,B){var p=k.length+B,m;this._expand(p);var w,E=0;for(m=0;m<k.length;m++){w=(this.words[m+B]|0)+E;var _=(k.words[m]|0)*P;w-=_&67108863,E=(w>>26)-(_/67108864|0),this.words[m+B]=w&67108863}for(;m<this.length-B;m++)w=(this.words[m+B]|0)+E,E=w>>26,this.words[m+B]=w&67108863;if(E===0)return this.strip();for(r(E===-1),E=0,m=0;m<this.length;m++)w=-(this.words[m]|0)+E,E=w>>26,this.words[m]=w&67108863;return this.negative=1,this.strip()},i.prototype._wordDiv=function(k,P){var B=this.length-k.length,p=this.clone(),m=k,w=m.words[m.length-1]|0,E=this._countBits(w);B=26-E,B!==0&&(m=m.ushln(B),p.iushln(B),w=m.words[m.length-1]|0);var _=p.length-m.length,b;if(P!=="mod"){b=new i(null),b.length=_+1,b.words=new Array(b.length);for(var C=0;C<b.length;C++)b.words[C]=0}var N=p.clone()._ishlnsubmul(m,1,_);N.negative===0&&(p=N,b&&(b.words[_]=1));for(var D=_-1;D>=0;D--){var U=(p.words[m.length+D]|0)*67108864+(p.words[m.length+D-1]|0);for(U=Math.min(U/w|0,67108863),p._ishlnsubmul(m,U,D);p.negative!==0;)U--,p.negative=0,p._ishlnsubmul(m,1,D),p.isZero()||(p.negative^=1);b&&(b.words[D]=U)}return b&&b.strip(),p.strip(),P!=="div"&&B!==0&&p.iushrn(B),{div:b||null,mod:p}},i.prototype.divmod=function(k,P,B){if(r(!k.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var p,m,w;return this.negative!==0&&k.negative===0?(w=this.neg().divmod(k,P),P!=="mod"&&(p=w.div.neg()),P!=="div"&&(m=w.mod.neg(),B&&m.negative!==0&&m.iadd(k)),{div:p,mod:m}):this.negative===0&&k.negative!==0?(w=this.divmod(k.neg(),P),P!=="mod"&&(p=w.div.neg()),{div:p,mod:w.mod}):this.negative&k.negative?(w=this.neg().divmod(k.neg(),P),P!=="div"&&(m=w.mod.neg(),B&&m.negative!==0&&m.isub(k)),{div:w.div,mod:m}):k.length>this.length||this.cmp(k)<0?{div:new i(0),mod:this}:k.length===1?P==="div"?{div:this.divn(k.words[0]),mod:null}:P==="mod"?{div:null,mod:new i(this.modn(k.words[0]))}:{div:this.divn(k.words[0]),mod:new i(this.modn(k.words[0]))}:this._wordDiv(k,P)},i.prototype.div=function(k){return this.divmod(k,"div",!1).div},i.prototype.mod=function(k){return this.divmod(k,"mod",!1).mod},i.prototype.umod=function(k){return this.divmod(k,"mod",!0).mod},i.prototype.divRound=function(k){var P=this.divmod(k);if(P.mod.isZero())return P.div;var B=P.div.negative!==0?P.mod.isub(k):P.mod,p=k.ushrn(1),m=k.andln(1),w=B.cmp(p);return w<0||m===1&&w===0?P.div:P.div.negative!==0?P.div.isubn(1):P.div.iaddn(1)},i.prototype.modn=function(k){r(k<=67108863);for(var P=(1<<26)%k,B=0,p=this.length-1;p>=0;p--)B=(P*B+(this.words[p]|0))%k;return B},i.prototype.idivn=function(k){r(k<=67108863);for(var P=0,B=this.length-1;B>=0;B--){var p=(this.words[B]|0)+P*67108864;this.words[B]=p/k|0,P=p%k}return this.strip()},i.prototype.divn=function(k){return this.clone().idivn(k)},i.prototype.egcd=function(k){r(k.negative===0),r(!k.isZero());var P=this,B=k.clone();P.negative!==0?P=P.umod(k):P=P.clone();for(var p=new i(1),m=new i(0),w=new i(0),E=new i(1),_=0;P.isEven()&&B.isEven();)P.iushrn(1),B.iushrn(1),++_;for(var b=B.clone(),C=P.clone();!P.isZero();){for(var N=0,D=1;!(P.words[0]&D)&&N<26;++N,D<<=1);if(N>0)for(P.iushrn(N);N-- >0;)(p.isOdd()||m.isOdd())&&(p.iadd(b),m.isub(C)),p.iushrn(1),m.iushrn(1);for(var U=0,G=1;!(B.words[0]&G)&&U<26;++U,G<<=1);if(U>0)for(B.iushrn(U);U-- >0;)(w.isOdd()||E.isOdd())&&(w.iadd(b),E.isub(C)),w.iushrn(1),E.iushrn(1);P.cmp(B)>=0?(P.isub(B),p.isub(w),m.isub(E)):(B.isub(P),w.isub(p),E.isub(m))}return{a:w,b:E,gcd:B.iushln(_)}},i.prototype._invmp=function(k){r(k.negative===0),r(!k.isZero());var P=this,B=k.clone();P.negative!==0?P=P.umod(k):P=P.clone();for(var p=new i(1),m=new i(0),w=B.clone();P.cmpn(1)>0&&B.cmpn(1)>0;){for(var E=0,_=1;!(P.words[0]&_)&&E<26;++E,_<<=1);if(E>0)for(P.iushrn(E);E-- >0;)p.isOdd()&&p.iadd(w),p.iushrn(1);for(var b=0,C=1;!(B.words[0]&C)&&b<26;++b,C<<=1);if(b>0)for(B.iushrn(b);b-- >0;)m.isOdd()&&m.iadd(w),m.iushrn(1);P.cmp(B)>=0?(P.isub(B),p.isub(m)):(B.isub(P),m.isub(p))}var N;return P.cmpn(1)===0?N=p:N=m,N.cmpn(0)<0&&N.iadd(k),N},i.prototype.gcd=function(k){if(this.isZero())return k.abs();if(k.isZero())return this.abs();var P=this.clone(),B=k.clone();P.negative=0,B.negative=0;for(var p=0;P.isEven()&&B.isEven();p++)P.iushrn(1),B.iushrn(1);do{for(;P.isEven();)P.iushrn(1);for(;B.isEven();)B.iushrn(1);var m=P.cmp(B);if(m<0){var w=P;P=B,B=w}else if(m===0||B.cmpn(1)===0)break;P.isub(B)}while(!0);return B.iushln(p)},i.prototype.invm=function(k){return this.egcd(k).a.umod(k)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(k){return this.words[0]&k},i.prototype.bincn=function(k){r(typeof k=="number");var P=k%26,B=(k-P)/26,p=1<<P;if(this.length<=B)return this._expand(B+1),this.words[B]|=p,this;for(var m=p,w=B;m!==0&&w<this.length;w++){var E=this.words[w]|0;E+=m,m=E>>>26,E&=67108863,this.words[w]=E}return m!==0&&(this.words[w]=m,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(k){var P=k<0;if(this.negative!==0&&!P)return-1;if(this.negative===0&&P)return 1;this.strip();var B;if(this.length>1)B=1;else{P&&(k=-k),r(k<=67108863,"Number is too big");var p=this.words[0]|0;B=p===k?0:p<k?-1:1}return this.negative!==0?-B|0:B},i.prototype.cmp=function(k){if(this.negative!==0&&k.negative===0)return-1;if(this.negative===0&&k.negative!==0)return 1;var P=this.ucmp(k);return this.negative!==0?-P|0:P},i.prototype.ucmp=function(k){if(this.length>k.length)return 1;if(this.length<k.length)return-1;for(var P=0,B=this.length-1;B>=0;B--){var p=this.words[B]|0,m=k.words[B]|0;if(p!==m){p<m?P=-1:p>m&&(P=1);break}}return P},i.prototype.gtn=function(k){return this.cmpn(k)===1},i.prototype.gt=function(k){return this.cmp(k)===1},i.prototype.gten=function(k){return this.cmpn(k)>=0},i.prototype.gte=function(k){return this.cmp(k)>=0},i.prototype.ltn=function(k){return this.cmpn(k)===-1},i.prototype.lt=function(k){return this.cmp(k)===-1},i.prototype.lten=function(k){return this.cmpn(k)<=0},i.prototype.lte=function(k){return this.cmp(k)<=0},i.prototype.eqn=function(k){return this.cmpn(k)===0},i.prototype.eq=function(k){return this.cmp(k)===0},i.red=function(k){return new L(k)},i.prototype.toRed=function(k){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),k.convertTo(this)._forceRed(k)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(k){return this.red=k,this},i.prototype.forceRed=function(k){return r(!this.red,"Already a number in reduction context"),this._forceRed(k)},i.prototype.redAdd=function(k){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,k)},i.prototype.redIAdd=function(k){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,k)},i.prototype.redSub=function(k){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,k)},i.prototype.redISub=function(k){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,k)},i.prototype.redShl=function(k){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,k)},i.prototype.redMul=function(k){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,k),this.red.mul(this,k)},i.prototype.redIMul=function(k){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,k),this.red.imul(this,k)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(k){return r(this.red&&!k.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,k)};var A={k256:null,p224:null,p192:null,p25519:null};function T(q,k){this.name=q,this.p=new i(k,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}T.prototype._tmp=function(){var k=new i(null);return k.words=new Array(Math.ceil(this.n/13)),k},T.prototype.ireduce=function(k){var P=k,B;do this.split(P,this.tmp),P=this.imulK(P),P=P.iadd(this.tmp),B=P.bitLength();while(B>this.n);var p=B<this.n?-1:P.ucmp(this.p);return p===0?(P.words[0]=0,P.length=1):p>0?P.isub(this.p):P.strip!==void 0?P.strip():P._strip(),P},T.prototype.split=function(k,P){k.iushrn(this.n,0,P)},T.prototype.imulK=function(k){return k.imul(this.k)};function $(){T.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n($,T),$.prototype.split=function(k,P){for(var B=4194303,p=Math.min(k.length,9),m=0;m<p;m++)P.words[m]=k.words[m];if(P.length=p,k.length<=9){k.words[0]=0,k.length=1;return}var w=k.words[9];for(P.words[P.length++]=w&B,m=10;m<k.length;m++){var E=k.words[m]|0;k.words[m-10]=(E&B)<<4|w>>>22,w=E}w>>>=22,k.words[m-10]=w,w===0&&k.length>10?k.length-=10:k.length-=9},$.prototype.imulK=function(k){k.words[k.length]=0,k.words[k.length+1]=0,k.length+=2;for(var P=0,B=0;B<k.length;B++){var p=k.words[B]|0;P+=p*977,k.words[B]=P&67108863,P=p*64+(P/67108864|0)}return k.words[k.length-1]===0&&(k.length--,k.words[k.length-1]===0&&k.length--),k};function j(){T.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(j,T);function K(){T.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(K,T);function F(){T.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(F,T),F.prototype.imulK=function(k){for(var P=0,B=0;B<k.length;B++){var p=(k.words[B]|0)*19+P,m=p&67108863;p>>>=26,k.words[B]=m,P=p}return P!==0&&(k.words[k.length++]=P),k},i._prime=function(k){if(A[k])return A[k];var P;if(k==="k256")P=new $;else if(k==="p224")P=new j;else if(k==="p192")P=new K;else if(k==="p25519")P=new F;else throw new Error("Unknown prime "+k);return A[k]=P,P};function L(q){if(typeof q=="string"){var k=i._prime(q);this.m=k.p,this.prime=k}else r(q.gtn(1),"modulus must be greater than 1"),this.m=q,this.prime=null}L.prototype._verify1=function(k){r(k.negative===0,"red works only with positives"),r(k.red,"red works only with red numbers")},L.prototype._verify2=function(k,P){r((k.negative|P.negative)===0,"red works only with positives"),r(k.red&&k.red===P.red,"red works only with red numbers")},L.prototype.imod=function(k){return this.prime?this.prime.ireduce(k)._forceRed(this):k.umod(this.m)._forceRed(this)},L.prototype.neg=function(k){return k.isZero()?k.clone():this.m.sub(k)._forceRed(this)},L.prototype.add=function(k,P){this._verify2(k,P);var B=k.add(P);return B.cmp(this.m)>=0&&B.isub(this.m),B._forceRed(this)},L.prototype.iadd=function(k,P){this._verify2(k,P);var B=k.iadd(P);return B.cmp(this.m)>=0&&B.isub(this.m),B},L.prototype.sub=function(k,P){this._verify2(k,P);var B=k.sub(P);return B.cmpn(0)<0&&B.iadd(this.m),B._forceRed(this)},L.prototype.isub=function(k,P){this._verify2(k,P);var B=k.isub(P);return B.cmpn(0)<0&&B.iadd(this.m),B},L.prototype.shl=function(k,P){return this._verify1(k),this.imod(k.ushln(P))},L.prototype.imul=function(k,P){return this._verify2(k,P),this.imod(k.imul(P))},L.prototype.mul=function(k,P){return this._verify2(k,P),this.imod(k.mul(P))},L.prototype.isqr=function(k){return this.imul(k,k.clone())},L.prototype.sqr=function(k){return this.mul(k,k)},L.prototype.sqrt=function(k){if(k.isZero())return k.clone();var P=this.m.andln(3);if(r(P%2===1),P===3){var B=this.m.add(new i(1)).iushrn(2);return this.pow(k,B)}for(var p=this.m.subn(1),m=0;!p.isZero()&&p.andln(1)===0;)m++,p.iushrn(1);r(!p.isZero());var w=new i(1).toRed(this),E=w.redNeg(),_=this.m.subn(1).iushrn(1),b=this.m.bitLength();for(b=new i(2*b*b).toRed(this);this.pow(b,_).cmp(E)!==0;)b.redIAdd(E);for(var C=this.pow(b,p),N=this.pow(k,p.addn(1).iushrn(1)),D=this.pow(k,p),U=m;D.cmp(w)!==0;){for(var G=D,Y=0;G.cmp(w)!==0;Y++)G=G.redSqr();r(Y<U);var J=this.pow(C,new i(1).iushln(U-Y-1));N=N.redMul(J),C=J.redSqr(),D=D.redMul(C),U=Y}return N},L.prototype.invm=function(k){var P=k._invmp(this.m);return P.negative!==0?(P.negative=0,this.imod(P).redNeg()):this.imod(P)},L.prototype.pow=function(k,P){if(P.isZero())return new i(1).toRed(this);if(P.cmpn(1)===0)return k.clone();var B=4,p=new Array(1<<B);p[0]=new i(1).toRed(this),p[1]=k;for(var m=2;m<p.length;m++)p[m]=this.mul(p[m-1],k);var w=p[0],E=0,_=0,b=P.bitLength()%26;for(b===0&&(b=26),m=P.length-1;m>=0;m--){for(var C=P.words[m],N=b-1;N>=0;N--){var D=C>>N&1;if(w!==p[0]&&(w=this.sqr(w)),D===0&&E===0){_=0;continue}E<<=1,E|=D,_++,!(_!==B&&(m!==0||N!==0))&&(w=this.mul(w,p[E]),_=0,E=0)}b=26}return w},L.prototype.convertTo=function(k){var P=k.umod(this.m);return P===k?P.clone():P},L.prototype.convertFrom=function(k){var P=k.clone();return P.red=null,P},i.mont=function(k){return new V(k)};function V(q){L.call(this,q),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(V,L),V.prototype.convertTo=function(k){return this.imod(k.ushln(this.shift))},V.prototype.convertFrom=function(k){var P=this.imod(k.mul(this.rinv));return P.red=null,P},V.prototype.imul=function(k,P){if(k.isZero()||P.isZero())return k.words[0]=0,k.length=1,k;var B=k.imul(P),p=B.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=B.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},V.prototype.mul=function(k,P){if(k.isZero()||P.isZero())return new i(0)._forceRed(this);var B=k.mul(P),p=B.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),m=B.isub(p).iushrn(this.shift),w=m;return m.cmp(this.m)>=0?w=m.isub(this.m):m.cmpn(0)<0&&(w=m.iadd(this.m)),w._forceRed(this)},V.prototype.invm=function(k){var P=this.imod(k._invmp(this.m).mul(this.r2));return P._forceRed(this)}})(typeof X7>"u"||X7,Aee)});var nA=W((Lvt,tD)=>{f();var Q7;tD.exports=function(e){return Q7||(Q7=new Ny(null)),Q7.generate(e)};function Ny(t){this.rand=t}tD.exports.Rand=Ny;Ny.prototype.generate=function(e){return this._rand(e)};Ny.prototype._rand=function(e){if(this.rand.getBytes)return this.rand.getBytes(e);for(var r=new Uint8Array(e),n=0;n<r.length;n++)r[n]=this.rand.getByte();return r};if(typeof self=="object")self.crypto&&self.crypto.getRandomValues?Ny.prototype._rand=function(e){var r=new Uint8Array(e);return self.crypto.getRandomValues(r),r}:self.msCrypto&&self.msCrypto.getRandomValues?Ny.prototype._rand=function(e){var r=new Uint8Array(e);return self.msCrypto.getRandomValues(r),r}:typeof window=="object"&&(Ny.prototype._rand=function(){throw new Error("Not implemented yet")});else try{if(eD=iA(),typeof eD.randomBytes!="function")throw new Error("Not supported");Ny.prototype._rand=function(e){return eD.randomBytes(e)}}catch{}var eD});var rD=W((zvt,kee)=>{f();var Mg=Do(),ePe=nA();function Dg(t){this.rand=t||new ePe.Rand}kee.exports=Dg;Dg.create=function(e){return new Dg(e)};Dg.prototype._randbelow=function(e){var r=e.bitLength(),n=Math.ceil(r/8);do var i=new Mg(this.rand.generate(n));while(i.cmp(e)>=0);return i};Dg.prototype._randrange=function(e,r){var n=r.sub(e);return e.add(this._randbelow(n))};Dg.prototype.test=function(e,r,n){var i=e.bitLength(),o=Mg.mont(e),s=new Mg(1).toRed(o);r||(r=Math.max(1,i/48|0));for(var a=e.subn(1),d=0;!a.testn(d);d++);for(var u=e.shrn(d),c=a.toRed(o),l=!0;r>0;r--){var h=this._randrange(new Mg(2),a);n&&n(h);var y=h.toRed(o).redPow(u);if(!(y.cmp(s)===0||y.cmp(c)===0)){for(var g=1;g<d;g++){if(y=y.redSqr(),y.cmp(s)===0)return!1;if(y.cmp(c)===0)break}if(g===d)return!1}}return l};Dg.prototype.getDivisor=function(e,r){var n=e.bitLength(),i=Mg.mont(e),o=new Mg(1).toRed(i);r||(r=Math.max(1,n/48|0));for(var s=e.subn(1),a=0;!s.testn(a);a++);for(var d=e.shrn(a),u=s.toRed(i);r>0;r--){var c=this._randrange(new Mg(2),s),l=e.gcd(c);if(l.cmpn(1)!==0)return l;var h=c.toRed(i).redPow(d);if(!(h.cmp(o)===0||h.cmp(u)===0)){for(var y=1;y<a;y++){if(h=h.redSqr(),h.cmp(o)===0)return h.fromRed().subn(1).gcd(e);if(h.cmp(u)===0)break}if(y===a)return h=h.redSqr(),h.fromRed().subn(1).gcd(e)}}return!1}});var cD=W((Yvt,Ree)=>{f();var tPe=bg();Ree.exports=aD;aD.simpleSieve=oD;aD.fermatTest=sD;var as=Do(),rPe=new as(24),nPe=rD(),Pee=new nPe,iPe=new as(1),iD=new as(2),oPe=new as(5),Hvt=new as(16),Wvt=new as(8),sPe=new as(10),aPe=new as(3),Gvt=new as(7),cPe=new as(11),Iee=new as(4),Jvt=new as(12),nD=null;function dPe(){if(nD!==null)return nD;var t=1048576,e=[];e[0]=2;for(var r=1,n=3;n<t;n+=2){for(var i=Math.ceil(Math.sqrt(n)),o=0;o<r&&e[o]<=i&&n%e[o]!==0;o++);r!==o&&e[o]<=i||(e[r++]=n)}return nD=e,e}function oD(t){for(var e=dPe(),r=0;r<e.length;r++)if(t.modn(e[r])===0)return t.cmpn(e[r])===0;return!0}function sD(t){var e=as.mont(t);return iD.toRed(e).redPow(t.subn(1)).fromRed().cmpn(1)===0}function aD(t,e){if(t<16)return e===2||e===5?new as([140,123]):new as([140,39]);e=new as(e);for(var r,n;;){for(r=new as(tPe(Math.ceil(t/8)));r.bitLength()>t;)r.ishrn(1);if(r.isEven()&&r.iadd(iPe),r.testn(1)||r.iadd(iD),e.cmp(iD)){if(!e.cmp(oPe))for(;r.mod(sPe).cmp(aPe);)r.iadd(Iee)}else for(;r.mod(rPe).cmp(cPe);)r.iadd(Iee);if(n=r.shrn(1),oD(n)&&oD(r)&&sD(n)&&sD(r)&&Pee.test(n)&&Pee.test(r))return r}}});var Bee=W((Xvt,uPe)=>{uPe.exports={modp1:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a63a3620ffffffffffffffff"},modp2:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece65381ffffffffffffffff"},modp5:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca237327ffffffffffffffff"},modp14:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aacaa68ffffffffffffffff"},modp15:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a93ad2caffffffffffffffff"},modp16:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c934063199ffffffffffffffff"},modp17:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dcc4024ffffffffffffffff"},modp18:{gen:"02",prime:"ffffffffffffffffc90fdaa22168c234c4c6628b80dc1cd129024e088a67cc74020bbea63b139b22514a08798e3404ddef9519b3cd3a431b302b0a6df25f14374fe1356d6d51c245e485b576625e7ec6f44c42e9a637ed6b0bff5cb6f406b7edee386bfb5a899fa5ae9f24117c4b1fe649286651ece45b3dc2007cb8a163bf0598da48361c55d39a69163fa8fd24cf5f83655d23dca3ad961c62f356208552bb9ed529077096966d670c354e4abc9804f1746c08ca18217c32905e462e36ce3be39e772c180e86039b2783a2ec07a28fb5c55df06f4c52c9de2bcbf6955817183995497cea956ae515d2261898fa051015728e5a8aaac42dad33170d04507a33a85521abdf1cba64ecfb850458dbef0a8aea71575d060c7db3970f85a6e1e4c7abf5ae8cdb0933d71e8c94e04a25619dcee3d2261ad2ee6bf12ffa06d98a0864d87602733ec86a64521f2b18177b200cbbe117577a615d6c770988c0bad946e208e24fa074e5ab3143db5bfce0fd108e4b82d120a92108011a723c12a787e6d788719a10bdba5b2699c327186af4e23c1a946834b6150bda2583e9ca2ad44ce8dbbbc2db04de8ef92e8efc141fbecaa6287c59474e6bc05d99b2964fa090c3a2233ba186515be7ed1f612970cee2d7afb81bdd762170481cd0069127d5b05aa993b4ea988d8fddc186ffb7dc90a6c08f4df435c93402849236c3fab4d27c7026c1d4dcb2602646dec9751e763dba37bdf8ff9406ad9e530ee5db382f413001aeb06a53ed9027d831179727b0865a8918da3edbebcf9b14ed44ce6cbaced4bb1bdb7f1447e6cc254b332051512bd7af426fb8f401378cd2bf5983ca01c64b92ecf032ea15d1721d03f482d7ce6e74fef6d55e702f46980c82b5a84031900b1c9e59e7c97fbec7e8f323a97a7e36cc88be0f1d45b7ff585ac54bd407b22b4154aacc8f6d7ebf48e1d814cc5ed20f8037e0a79715eef29be32806a1d58bb7c5da76f550aa3d8a1fbff0eb19ccb1a313d55cda56c9ec2ef29632387fe8d76e3c0468043e8f663f4860ee12bf2d5b0b7474d6e694f91e6dbe115974a3926f12fee5e438777cb6a932df8cd8bec4d073b931ba3bc832b68d9dd300741fa7bf8afc47ed2576f6936ba424663aab639c5ae4f5683423b4742bf1c978238f16cbe39d652de3fdb8befc848ad922222e04a4037c0713eb57a81a23f0c73473fc646cea306b4bcbc8862f8385ddfa9d4b7fa2c087e879683303ed5bdd3a062b3cf5b3a278a66d2a13f83f44f82ddf310ee074ab6a364597e899a0255dc164f31cc50846851df9ab48195ded7ea1b1d510bd7ee74d73faf36bc31ecfa268359046f4eb879f924009438b481c6cd7889a002ed5ee382bc9190da6fc026e479558e4475677e9aa9e3050e2765694dfc81f56e880b96e7160c980dd98edd3dfffffffffffffffff"}}});var Cee=W((Qvt,Dee)=>{f();var Cd=Do(),lPe=rD(),Oee=new lPe,fPe=new Cd(24),hPe=new Cd(11),pPe=new Cd(10),yPe=new Cd(3),mPe=new Cd(7),Mee=cD(),gPe=bg();Dee.exports=Rh;function vPe(t,e){return e=e||"utf8",M.Buffer.isBuffer(t)||(t=new M.Buffer(t,e)),this._pub=new Cd(t),this}function bPe(t,e){return e=e||"utf8",M.Buffer.isBuffer(t)||(t=new M.Buffer(t,e)),this._priv=new Cd(t),this}var oA={};function wPe(t,e){var r=e.toString("hex"),n=[r,t.toString(16)].join("_");if(n in oA)return oA[n];var i=0;if(t.isEven()||!Mee.simpleSieve||!Mee.fermatTest(t)||!Oee.test(t))return i+=1,r==="02"||r==="05"?i+=8:i+=4,oA[n]=i,i;Oee.test(t.shrn(1))||(i+=2);var o;switch(r){case"02":t.mod(fPe).cmp(hPe)&&(i+=8);break;case"05":o=t.mod(pPe),o.cmp(yPe)&&o.cmp(mPe)&&(i+=8);break;default:i+=4}return oA[n]=i,i}function Rh(t,e,r){this.setGenerator(e),this.__prime=new Cd(t),this._prime=Cd.mont(this.__prime),this._primeLen=t.length,this._pub=void 0,this._priv=void 0,this._primeCode=void 0,r?(this.setPublicKey=vPe,this.setPrivateKey=bPe):this._primeCode=8}Object.defineProperty(Rh.prototype,"verifyError",{enumerable:!0,get:function(){return typeof this._primeCode!="number"&&(this._primeCode=wPe(this.__prime,this.__gen)),this._primeCode}});Rh.prototype.generateKeys=function(){return this._priv||(this._priv=new Cd(gPe(this._primeLen))),this._pub=this._gen.toRed(this._prime).redPow(this._priv).fromRed(),this.getPublicKey()};Rh.prototype.computeSecret=function(t){t=new Cd(t),t=t.toRed(this._prime);var e=t.redPow(this._priv).fromRed(),r=new M.Buffer(e.toArray()),n=this.getPrime();if(r.length<n.length){var i=new M.Buffer(n.length-r.length);i.fill(0),r=M.Buffer.concat([i,r])}return r};Rh.prototype.getPublicKey=function(e){return sA(this._pub,e)};Rh.prototype.getPrivateKey=function(e){return sA(this._priv,e)};Rh.prototype.getPrime=function(t){return sA(this.__prime,t)};Rh.prototype.getGenerator=function(t){return sA(this._gen,t)};Rh.prototype.setGenerator=function(t,e){return e=e||"utf8",M.Buffer.isBuffer(t)||(t=new M.Buffer(t,e)),this.__gen=t,this._gen=new Cd(t),this};function sA(t,e){var r=new M.Buffer(t.toArray());return e?r.toString(e):r}});var Nee=W(o1=>{f();var _Pe=cD(),jee=Bee(),dD=Cee();function xPe(t){var e=new M.Buffer(jee[t].prime,"hex"),r=new M.Buffer(jee[t].gen,"hex");return new dD(e,r)}var EPe={binary:!0,hex:!0,base64:!0};function $ee(t,e,r,n){return M.Buffer.isBuffer(e)||EPe[e]===void 0?$ee(t,"binary",e,r):(e=e||"binary",n=n||"binary",r=r||new M.Buffer([2]),M.Buffer.isBuffer(r)||(r=new M.Buffer(r,n)),typeof t=="number"?new dD(_Pe(t,r),r,!0):(M.Buffer.isBuffer(t)||(t=new M.Buffer(t,e)),new dD(t,r,!0)))}o1.DiffieHellmanGroup=o1.createDiffieHellmanGroup=o1.getDiffieHellman=xPe;o1.createDiffieHellman=o1.DiffieHellman=$ee});var jE=W((nbt,uD)=>{"use strict";f();typeof I.default>"u"||!I.default.version||I.default.version.indexOf("v0.")===0||I.default.version.indexOf("v1.")===0&&I.default.version.indexOf("v1.8.")!==0?uD.exports={nextTick:SPe}:uD.exports=I.default;function SPe(t,e,r,n){if(typeof t!="function")throw new TypeError('"callback" argument must be a function');var i=arguments.length,o,s;switch(i){case 0:case 1:return I.default.nextTick(t);case 2:return I.default.nextTick(function(){t.call(null,e)});case 3:return I.default.nextTick(function(){t.call(null,e,r)});case 4:return I.default.nextTick(function(){t.call(null,e,r,n)});default:for(o=new Array(i-1),s=0;s<o.length;)o[s++]=arguments[s];return I.default.nextTick(function(){t.apply(null,o)})}}});var Kee=W((obt,Uee)=>{f();var TPe={}.toString;Uee.exports=Array.isArray||function(t){return TPe.call(t)=="[object Array]"}});var lD=W((abt,qee)=>{f();qee.exports=Ba().EventEmitter});var $E=W((fD,Fee)=>{f();var aA=bn(),Bh=aA.Buffer;function Lee(t,e){for(var r in t)e[r]=t[r]}Bh.from&&Bh.alloc&&Bh.allocUnsafe&&Bh.allocUnsafeSlow?Fee.exports=aA:(Lee(aA,fD),fD.Buffer=s1);function s1(t,e,r){return Bh(t,e,r)}Lee(Bh,s1);s1.from=function(t,e,r){if(typeof t=="number")throw new TypeError("Argument must not be a number");return Bh(t,e,r)};s1.alloc=function(t,e,r){if(typeof t!="number")throw new TypeError("Argument must be a number");var n=Bh(t);return e!==void 0?typeof r=="string"?n.fill(e,r):n.fill(e):n.fill(0),n};s1.allocUnsafe=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return Bh(t)};s1.allocUnsafeSlow=function(t){if(typeof t!="number")throw new TypeError("Argument must be a number");return aA.SlowBuffer(t)}});var a1=W(ra=>{f();function APe(t){return Array.isArray?Array.isArray(t):cA(t)==="[object Array]"}ra.isArray=APe;function kPe(t){return typeof t=="boolean"}ra.isBoolean=kPe;function PPe(t){return t===null}ra.isNull=PPe;function IPe(t){return t==null}ra.isNullOrUndefined=IPe;function RPe(t){return typeof t=="number"}ra.isNumber=RPe;function BPe(t){return typeof t=="string"}ra.isString=BPe;function OPe(t){return typeof t=="symbol"}ra.isSymbol=OPe;function MPe(t){return t===void 0}ra.isUndefined=MPe;function DPe(t){return cA(t)==="[object RegExp]"}ra.isRegExp=DPe;function CPe(t){return typeof t=="object"&&t!==null}ra.isObject=CPe;function jPe(t){return cA(t)==="[object Date]"}ra.isDate=jPe;function $Pe(t){return cA(t)==="[object Error]"||t instanceof Error}ra.isError=$Pe;function NPe(t){return typeof t=="function"}ra.isFunction=NPe;function UPe(t){return t===null||typeof t=="boolean"||typeof t=="number"||typeof t=="string"||typeof t=="symbol"||typeof t>"u"}ra.isPrimitive=UPe;ra.isBuffer=bn().Buffer.isBuffer;function cA(t){return Object.prototype.toString.call(t)}});var Vee=W((fbt,hD)=>{"use strict";f();function KPe(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}var zee=$E().Buffer,NE=aE();function qPe(t,e,r){t.copy(e,r)}hD.exports=function(){function t(){KPe(this,t),this.head=null,this.tail=null,this.length=0}return t.prototype.push=function(r){var n={data:r,next:null};this.length>0?this.tail.next=n:this.head=n,this.tail=n,++this.length},t.prototype.unshift=function(r){var n={data:r,next:this.head};this.length===0&&(this.tail=n),this.head=n,++this.length},t.prototype.shift=function(){if(this.length!==0){var r=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,r}},t.prototype.clear=function(){this.head=this.tail=null,this.length=0},t.prototype.join=function(r){if(this.length===0)return"";for(var n=this.head,i=""+n.data;n=n.next;)i+=r+n.data;return i},t.prototype.concat=function(r){if(this.length===0)return zee.alloc(0);for(var n=zee.allocUnsafe(r>>>0),i=this.head,o=0;i;)qPe(i.data,n,o),o+=i.data.length,i=i.next;return n},t}();NE&&NE.inspect&&NE.inspect.custom&&(hD.exports.prototype[NE.inspect.custom]=function(){var t=NE.inspect({length:this.length});return this.constructor.name+" "+t})});var pD=W((pbt,Hee)=>{"use strict";f();var dA=jE();function LPe(t,e){var r=this,n=this._readableState&&this._readableState.destroyed,i=this._writableState&&this._writableState.destroyed;return n||i?(e?e(t):t&&(this._writableState?this._writableState.errorEmitted||(this._writableState.errorEmitted=!0,dA.nextTick(uA,this,t)):dA.nextTick(uA,this,t)),this):(this._readableState&&(this._readableState.destroyed=!0),this._writableState&&(this._writableState.destroyed=!0),this._destroy(t||null,function(o){!e&&o?r._writableState?r._writableState.errorEmitted||(r._writableState.errorEmitted=!0,dA.nextTick(uA,r,o)):dA.nextTick(uA,r,o):e&&e(o)}),this)}function FPe(){this._readableState&&(this._readableState.destroyed=!1,this._readableState.reading=!1,this._readableState.ended=!1,this._readableState.endEmitted=!1),this._writableState&&(this._writableState.destroyed=!1,this._writableState.ended=!1,this._writableState.ending=!1,this._writableState.finalCalled=!1,this._writableState.prefinished=!1,this._writableState.finished=!1,this._writableState.errorEmitted=!1)}function uA(t,e){t.emit("error",e)}Hee.exports={destroy:LPe,undestroy:FPe}});var mD=W((mbt,ete)=>{"use strict";f();var Cg=jE();ete.exports=Zi;function Gee(t){var e=this;this.next=null,this.entry=null,this.finish=function(){aIe(e,t)}}var zPe=!I.default.browser&&["v0.10","v0.9."].indexOf(I.default.version.slice(0,5))>-1?setImmediate:Cg.nextTick,c1;Zi.WritableState=KE;var Jee=Object.create(a1());Jee.inherits=Vt();var VPe={deprecate:WM()},Yee=lD(),fA=$E().Buffer,HPe=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function WPe(t){return fA.from(t)}function GPe(t){return fA.isBuffer(t)||t instanceof HPe}var Zee=pD();Jee.inherits(Zi,Yee);function JPe(){}function KE(t,e){c1=c1||jg(),t=t||{};var r=e instanceof c1;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.writableObjectMode);var n=t.highWaterMark,i=t.writableHighWaterMark,o=this.objectMode?16:16*1024;n||n===0?this.highWaterMark=n:r&&(i||i===0)?this.highWaterMark=i:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;var s=t.decodeStrings===!1;this.decodeStrings=!s,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(a){rIe(e,a)},this.writecb=null,this.writelen=0,this.bufferedRequest=null,this.lastBufferedRequest=null,this.pendingcb=0,this.prefinished=!1,this.errorEmitted=!1,this.bufferedRequestCount=0,this.corkedRequestsFree=new Gee(this)}KE.prototype.getBuffer=function(){for(var e=this.bufferedRequest,r=[];e;)r.push(e),e=e.next;return r};(function(){try{Object.defineProperty(KE.prototype,"buffer",{get:VPe.deprecate(function(){return this.getBuffer()},"_writableState.buffer is deprecated. Use _writableState.getBuffer instead.","DEP0003")})}catch{}})();var lA;typeof Symbol=="function"&&Symbol.hasInstance&&typeof Function.prototype[Symbol.hasInstance]=="function"?(lA=Function.prototype[Symbol.hasInstance],Object.defineProperty(Zi,Symbol.hasInstance,{value:function(t){return lA.call(this,t)?!0:this!==Zi?!1:t&&t._writableState instanceof KE}})):lA=function(t){return t instanceof this};function Zi(t){if(c1=c1||jg(),!lA.call(Zi,this)&&!(this instanceof c1))return new Zi(t);this._writableState=new KE(t,this),this.writable=!0,t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final)),Yee.call(this)}Zi.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe, not readable"))};function YPe(t,e){var r=new Error("write after end");t.emit("error",r),Cg.nextTick(e,r)}function ZPe(t,e,r,n){var i=!0,o=!1;return r===null?o=new TypeError("May not write null values to stream"):typeof r!="string"&&r!==void 0&&!e.objectMode&&(o=new TypeError("Invalid non-string/buffer chunk")),o&&(t.emit("error",o),Cg.nextTick(n,o),i=!1),i}Zi.prototype.write=function(t,e,r){var n=this._writableState,i=!1,o=!n.objectMode&&GPe(t);return o&&!fA.isBuffer(t)&&(t=WPe(t)),typeof e=="function"&&(r=e,e=null),o?e="buffer":e||(e=n.defaultEncoding),typeof r!="function"&&(r=JPe),n.ended?YPe(this,r):(o||ZPe(this,n,t,r))&&(n.pendingcb++,i=QPe(this,n,o,t,e,r)),i};Zi.prototype.cork=function(){var t=this._writableState;t.corked++};Zi.prototype.uncork=function(){var t=this._writableState;t.corked&&(t.corked--,!t.writing&&!t.corked&&!t.bufferProcessing&&t.bufferedRequest&&Xee(this,t))};Zi.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=e.toLowerCase()),!(["hex","utf8","utf-8","ascii","binary","base64","ucs2","ucs-2","utf16le","utf-16le","raw"].indexOf((e+"").toLowerCase())>-1))throw new TypeError("Unknown encoding: "+e);return this._writableState.defaultEncoding=e,this};function XPe(t,e,r){return!t.objectMode&&t.decodeStrings!==!1&&typeof e=="string"&&(e=fA.from(e,r)),e}Object.defineProperty(Zi.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function QPe(t,e,r,n,i,o){if(!r){var s=XPe(e,n,i);n!==s&&(r=!0,i="buffer",n=s)}var a=e.objectMode?1:n.length;e.length+=a;var d=e.length<e.highWaterMark;if(d||(e.needDrain=!0),e.writing||e.corked){var u=e.lastBufferedRequest;e.lastBufferedRequest={chunk:n,encoding:i,isBuf:r,callback:o,next:null},u?u.next=e.lastBufferedRequest:e.bufferedRequest=e.lastBufferedRequest,e.bufferedRequestCount+=1}else yD(t,e,!1,a,n,i,o);return d}function yD(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function eIe(t,e,r,n,i){--e.pendingcb,r?(Cg.nextTick(i,n),Cg.nextTick(UE,t,e),t._writableState.errorEmitted=!0,t.emit("error",n)):(i(n),t._writableState.errorEmitted=!0,t.emit("error",n),UE(t,e))}function tIe(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function rIe(t,e){var r=t._writableState,n=r.sync,i=r.writecb;if(tIe(r),e)eIe(t,r,n,e,i);else{var o=Qee(r);!o&&!r.corked&&!r.bufferProcessing&&r.bufferedRequest&&Xee(t,r),n?zPe(Wee,t,r,o,i):Wee(t,r,o,i)}}function Wee(t,e,r,n){r||nIe(t,e),e.pendingcb--,n(),UE(t,e)}function nIe(t,e){e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function Xee(t,e){e.bufferProcessing=!0;var r=e.bufferedRequest;if(t._writev&&r&&r.next){var n=e.bufferedRequestCount,i=new Array(n),o=e.corkedRequestsFree;o.entry=r;for(var s=0,a=!0;r;)i[s]=r,r.isBuf||(a=!1),r=r.next,s+=1;i.allBuffers=a,yD(t,e,!0,e.length,i,"",o.finish),e.pendingcb++,e.lastBufferedRequest=null,o.next?(e.corkedRequestsFree=o.next,o.next=null):e.corkedRequestsFree=new Gee(e),e.bufferedRequestCount=0}else{for(;r;){var d=r.chunk,u=r.encoding,c=r.callback,l=e.objectMode?1:d.length;if(yD(t,e,!1,l,d,u,c),r=r.next,e.bufferedRequestCount--,e.writing)break}r===null&&(e.lastBufferedRequest=null)}e.bufferedRequest=r,e.bufferProcessing=!1}Zi.prototype._write=function(t,e,r){r(new Error("_write() is not implemented"))};Zi.prototype._writev=null;Zi.prototype.end=function(t,e,r){var n=this._writableState;typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null),t!=null&&this.write(t,e),n.corked&&(n.corked=1,this.uncork()),n.ending||sIe(this,n,r)};function Qee(t){return t.ending&&t.length===0&&t.bufferedRequest===null&&!t.finished&&!t.writing}function iIe(t,e){t._final(function(r){e.pendingcb--,r&&t.emit("error",r),e.prefinished=!0,t.emit("prefinish"),UE(t,e)})}function oIe(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"?(e.pendingcb++,e.finalCalled=!0,Cg.nextTick(iIe,t,e)):(e.prefinished=!0,t.emit("prefinish")))}function UE(t,e){var r=Qee(e);return r&&(oIe(t,e),e.pendingcb===0&&(e.finished=!0,t.emit("finish"))),r}function sIe(t,e,r){e.ending=!0,UE(t,e),r&&(e.finished?Cg.nextTick(r):t.once("finish",r)),e.ended=!0,t.writable=!1}function aIe(t,e,r){var n=t.entry;for(t.entry=null;n;){var i=n.callback;e.pendingcb--,i(r),n=n.next}e.corkedRequestsFree.next=t}Object.defineProperty(Zi.prototype,"destroyed",{get:function(){return this._writableState===void 0?!1:this._writableState.destroyed},set:function(t){this._writableState&&(this._writableState.destroyed=t)}});Zi.prototype.destroy=Zee.destroy;Zi.prototype._undestroy=Zee.undestroy;Zi.prototype._destroy=function(t,e){this.end(),e(t)}});var jg=W((vbt,ite)=>{"use strict";f();var tte=jE(),cIe=Object.keys||function(t){var e=[];for(var r in t)e.push(r);return e};ite.exports=Oh;var rte=Object.create(a1());rte.inherits=Vt();var nte=bD(),vD=mD();rte.inherits(Oh,nte);for(gD=cIe(vD.prototype),hA=0;hA<gD.length;hA++)pA=gD[hA],Oh.prototype[pA]||(Oh.prototype[pA]=vD.prototype[pA]);var gD,pA,hA;function Oh(t){if(!(this instanceof Oh))return new Oh(t);nte.call(this,t),vD.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),this.once("end",dIe)}Object.defineProperty(Oh.prototype,"writableHighWaterMark",{enumerable:!1,get:function(){return this._writableState.highWaterMark}});function dIe(){this.allowHalfOpen||this._writableState.ended||tte.nextTick(uIe,this)}function uIe(t){t.end()}Object.defineProperty(Oh.prototype,"destroyed",{get:function(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set:function(t){this._readableState===void 0||this._writableState===void 0||(this._readableState.destroyed=t,this._writableState.destroyed=t)}});Oh.prototype._destroy=function(t,e){this.push(null),this.end(),tte.nextTick(e,t)}});var xD=W(ste=>{"use strict";f();var _D=$E().Buffer,ote=_D.isEncoding||function(t){switch(t=""+t,t&&t.toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":case"raw":return!0;default:return!1}};function lIe(t){if(!t)return"utf8";for(var e;;)switch(t){case"utf8":case"utf-8":return"utf8";case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return"utf16le";case"latin1":case"binary":return"latin1";case"base64":case"ascii":case"hex":return t;default:if(e)return;t=(""+t).toLowerCase(),e=!0}}function fIe(t){var e=lIe(t);if(typeof e!="string"&&(_D.isEncoding===ote||!ote(t)))throw new Error("Unknown encoding: "+t);return e||t}ste.StringDecoder=qE;function qE(t){this.encoding=fIe(t);var e;switch(this.encoding){case"utf16le":this.text=vIe,this.end=bIe,e=4;break;case"utf8":this.fillLast=yIe,e=4;break;case"base64":this.text=wIe,this.end=_Ie,e=3;break;default:this.write=xIe,this.end=EIe;return}this.lastNeed=0,this.lastTotal=0,this.lastChar=_D.allocUnsafe(e)}qE.prototype.write=function(t){if(t.length===0)return"";var e,r;if(this.lastNeed){if(e=this.fillLast(t),e===void 0)return"";r=this.lastNeed,this.lastNeed=0}else r=0;return r<t.length?e?e+this.text(t,r):this.text(t,r):e||""};qE.prototype.end=gIe;qE.prototype.text=mIe;qE.prototype.fillLast=function(t){if(this.lastNeed<=t.length)return t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,this.lastTotal-this.lastNeed,0,t.length),this.lastNeed-=t.length};function wD(t){return t<=127?0:t>>5===6?2:t>>4===14?3:t>>3===30?4:t>>6===2?-1:-2}function hIe(t,e,r){var n=e.length-1;if(n<r)return 0;var i=wD(e[n]);return i>=0?(i>0&&(t.lastNeed=i-1),i):--n<r||i===-2?0:(i=wD(e[n]),i>=0?(i>0&&(t.lastNeed=i-2),i):--n<r||i===-2?0:(i=wD(e[n]),i>=0?(i>0&&(i===2?i=0:t.lastNeed=i-3),i):0))}function pIe(t,e,r){if((e[0]&192)!==128)return t.lastNeed=0,"\uFFFD";if(t.lastNeed>1&&e.length>1){if((e[1]&192)!==128)return t.lastNeed=1,"\uFFFD";if(t.lastNeed>2&&e.length>2&&(e[2]&192)!==128)return t.lastNeed=2,"\uFFFD"}}function yIe(t){var e=this.lastTotal-this.lastNeed,r=pIe(this,t,e);if(r!==void 0)return r;if(this.lastNeed<=t.length)return t.copy(this.lastChar,e,0,this.lastNeed),this.lastChar.toString(this.encoding,0,this.lastTotal);t.copy(this.lastChar,e,0,t.length),this.lastNeed-=t.length}function mIe(t,e){var r=hIe(this,t,e);if(!this.lastNeed)return t.toString("utf8",e);this.lastTotal=r;var n=t.length-(r-this.lastNeed);return t.copy(this.lastChar,0,n),t.toString("utf8",e,n)}function gIe(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+"\uFFFD":e}function vIe(t,e){if((t.length-e)%2===0){var r=t.toString("utf16le",e);if(r){var n=r.charCodeAt(r.length-1);if(n>=55296&&n<=56319)return this.lastNeed=2,this.lastTotal=4,this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1],r.slice(0,-1)}return r}return this.lastNeed=1,this.lastTotal=2,this.lastChar[0]=t[t.length-1],t.toString("utf16le",e,t.length-1)}function bIe(t){var e=t&&t.length?this.write(t):"";if(this.lastNeed){var r=this.lastTotal-this.lastNeed;return e+this.lastChar.toString("utf16le",0,r)}return e}function wIe(t,e){var r=(t.length-e)%3;return r===0?t.toString("base64",e):(this.lastNeed=3-r,this.lastTotal=3,r===1?this.lastChar[0]=t[t.length-1]:(this.lastChar[0]=t[t.length-2],this.lastChar[1]=t[t.length-1]),t.toString("base64",e,t.length-r))}function _Ie(t){var e=t&&t.length?this.write(t):"";return this.lastNeed?e+this.lastChar.toString("base64",0,3-this.lastNeed):e}function xIe(t){return t.toString(this.encoding)}function EIe(t){return t&&t.length?this.write(t):""}});var bD=W((Ebt,vte)=>{"use strict";f();var u1=jE();vte.exports=Hn;var SIe=Kee(),LE;Hn.ReadableState=hte;var xbt=Ba().EventEmitter,ute=function(t,e){return t.listeners(e).length},kD=lD(),FE=$E().Buffer,TIe=(typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof self<"u"?self:{}).Uint8Array||function(){};function AIe(t){return FE.from(t)}function kIe(t){return FE.isBuffer(t)||t instanceof TIe}var lte=Object.create(a1());lte.inherits=Vt();var ED=aE(),nn=void 0;ED&&ED.debuglog?nn=ED.debuglog("stream"):nn=function(){};var PIe=Vee(),fte=pD(),d1;lte.inherits(Hn,kD);var SD=["error","close","destroy","pause","resume"];function IIe(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):SIe(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}function hte(t,e){LE=LE||jg(),t=t||{};var r=e instanceof LE;this.objectMode=!!t.objectMode,r&&(this.objectMode=this.objectMode||!!t.readableObjectMode);var n=t.highWaterMark,i=t.readableHighWaterMark,o=this.objectMode?16:16*1024;n||n===0?this.highWaterMark=n:r&&(i||i===0)?this.highWaterMark=i:this.highWaterMark=o,this.highWaterMark=Math.floor(this.highWaterMark),this.buffer=new PIe,this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this.destroyed=!1,this.defaultEncoding=t.defaultEncoding||"utf8",this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,t.encoding&&(d1||(d1=xD().StringDecoder),this.decoder=new d1(t.encoding),this.encoding=t.encoding)}function Hn(t){if(LE=LE||jg(),!(this instanceof Hn))return new Hn(t);this._readableState=new hte(t,this),this.readable=!0,t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy)),kD.call(this)}Object.defineProperty(Hn.prototype,"destroyed",{get:function(){return this._readableState===void 0?!1:this._readableState.destroyed},set:function(t){this._readableState&&(this._readableState.destroyed=t)}});Hn.prototype.destroy=fte.destroy;Hn.prototype._undestroy=fte.undestroy;Hn.prototype._destroy=function(t,e){this.push(null),e(t)};Hn.prototype.push=function(t,e){var r=this._readableState,n;return r.objectMode?n=!0:typeof t=="string"&&(e=e||r.defaultEncoding,e!==r.encoding&&(t=FE.from(t,e),e=""),n=!0),pte(this,t,e,!1,n)};Hn.prototype.unshift=function(t){return pte(this,t,null,!0,!1)};function pte(t,e,r,n,i){var o=t._readableState;if(e===null)o.reading=!1,MIe(t,o);else{var s;i||(s=RIe(o,e)),s?t.emit("error",s):o.objectMode||e&&e.length>0?(typeof e!="string"&&!o.objectMode&&Object.getPrototypeOf(e)!==FE.prototype&&(e=AIe(e)),n?o.endEmitted?t.emit("error",new Error("stream.unshift() after end event")):TD(t,o,e,!0):o.ended?t.emit("error",new Error("stream.push() after EOF")):(o.reading=!1,o.decoder&&!r?(e=o.decoder.write(e),o.objectMode||e.length!==0?TD(t,o,e,!1):yte(t,o)):TD(t,o,e,!1))):n||(o.reading=!1)}return BIe(o)}function TD(t,e,r,n){e.flowing&&e.length===0&&!e.sync?(t.emit("data",r),t.read(0)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&yA(t)),yte(t,e)}function RIe(t,e){var r;return!kIe(e)&&typeof e!="string"&&e!==void 0&&!t.objectMode&&(r=new TypeError("Invalid non-string/buffer chunk")),r}function BIe(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||t.length===0)}Hn.prototype.isPaused=function(){return this._readableState.flowing===!1};Hn.prototype.setEncoding=function(t){return d1||(d1=xD().StringDecoder),this._readableState.decoder=new d1(t),this._readableState.encoding=t,this};var ate=8388608;function OIe(t){return t>=ate?t=ate:(t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++),t}function cte(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:t!==t?e.flowing&&e.length?e.buffer.head.data.length:e.length:(t>e.highWaterMark&&(e.highWaterMark=OIe(t)),t<=e.length?t:e.ended?e.length:(e.needReadable=!0,0))}Hn.prototype.read=function(t){nn("read",t),t=parseInt(t,10);var e=this._readableState,r=t;if(t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return nn("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?AD(this):yA(this),null;if(t=cte(t,e),t===0&&e.ended)return e.length===0&&AD(this),null;var n=e.needReadable;nn("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,nn("length less than watermark",n)),e.ended||e.reading?(n=!1,nn("reading or ended",n)):n&&(nn("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1,e.reading||(t=cte(r,e)));var i;return t>0?i=mte(t,e):i=null,i===null?(e.needReadable=!0,t=0):e.length-=t,e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&AD(this)),i!==null&&this.emit("data",i),i};function MIe(t,e){if(!e.ended){if(e.decoder){var r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,yA(t)}}function yA(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(nn("emitReadable",e.flowing),e.emittedReadable=!0,e.sync?u1.nextTick(dte,t):dte(t))}function dte(t){nn("emit readable"),t.emit("readable"),PD(t)}function yte(t,e){e.readingMore||(e.readingMore=!0,u1.nextTick(DIe,t,e))}function DIe(t,e){for(var r=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(nn("maybeReadMore read 0"),t.read(0),r!==e.length);)r=e.length;e.readingMore=!1}Hn.prototype._read=function(t){this.emit("error",new Error("_read() is not implemented"))};Hn.prototype.pipe=function(t,e){var r=this,n=this._readableState;switch(n.pipesCount){case 0:n.pipes=t;break;case 1:n.pipes=[n.pipes,t];break;default:n.pipes.push(t);break}n.pipesCount+=1,nn("pipe count=%d opts=%j",n.pipesCount,e);var i=(!e||e.end!==!1)&&t!==I.default.stdout&&t!==I.default.stderr,o=i?a:x;n.endEmitted?u1.nextTick(o):r.once("end",o),t.on("unpipe",s);function s(S,A){nn("onunpipe"),S===r&&A&&A.hasUnpiped===!1&&(A.hasUnpiped=!0,c())}function a(){nn("onend"),t.end()}var d=CIe(r);t.on("drain",d);var u=!1;function c(){nn("cleanup"),t.removeListener("close",g),t.removeListener("finish",v),t.removeListener("drain",d),t.removeListener("error",y),t.removeListener("unpipe",s),r.removeListener("end",a),r.removeListener("end",x),r.removeListener("data",h),u=!0,n.awaitDrain&&(!t._writableState||t._writableState.needDrain)&&d()}var l=!1;r.on("data",h);function h(S){nn("ondata"),l=!1;var A=t.write(S);A===!1&&!l&&((n.pipesCount===1&&n.pipes===t||n.pipesCount>1&&gte(n.pipes,t)!==-1)&&!u&&(nn("false write response, pause",n.awaitDrain),n.awaitDrain++,l=!0),r.pause())}function y(S){nn("onerror",S),x(),t.removeListener("error",y),ute(t,"error")===0&&t.emit("error",S)}IIe(t,"error",y);function g(){t.removeListener("finish",v),x()}t.once("close",g);function v(){nn("onfinish"),t.removeListener("close",g),x()}t.once("finish",v);function x(){nn("unpipe"),r.unpipe(t)}return t.emit("pipe",r),n.flowing||(nn("pipe resume"),r.resume()),t};function CIe(t){return function(){var e=t._readableState;nn("pipeOnDrain",e.awaitDrain),e.awaitDrain&&e.awaitDrain--,e.awaitDrain===0&&ute(t,"data")&&(e.flowing=!0,PD(t))}}Hn.prototype.unpipe=function(t){var e=this._readableState,r={hasUnpiped:!1};if(e.pipesCount===0)return this;if(e.pipesCount===1)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,e.flowing=!1,t&&t.emit("unpipe",this,r),this);if(!t){var n=e.pipes,i=e.pipesCount;e.pipes=null,e.pipesCount=0,e.flowing=!1;for(var o=0;o<i;o++)n[o].emit("unpipe",this,{hasUnpiped:!1});return this}var s=gte(e.pipes,t);return s===-1?this:(e.pipes.splice(s,1),e.pipesCount-=1,e.pipesCount===1&&(e.pipes=e.pipes[0]),t.emit("unpipe",this,r),this)};Hn.prototype.on=function(t,e){var r=kD.prototype.on.call(this,t,e);if(t==="data")this._readableState.flowing!==!1&&this.resume();else if(t==="readable"){var n=this._readableState;!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.emittedReadable=!1,n.reading?n.length&&yA(this):u1.nextTick(jIe,this))}return r};Hn.prototype.addListener=Hn.prototype.on;function jIe(t){nn("readable nexttick read 0"),t.read(0)}Hn.prototype.resume=function(){var t=this._readableState;return t.flowing||(nn("resume"),t.flowing=!0,$Ie(this,t)),this};function $Ie(t,e){e.resumeScheduled||(e.resumeScheduled=!0,u1.nextTick(NIe,t,e))}function NIe(t,e){e.reading||(nn("resume read 0"),t.read(0)),e.resumeScheduled=!1,e.awaitDrain=0,t.emit("resume"),PD(t),e.flowing&&!e.reading&&t.read(0)}Hn.prototype.pause=function(){return nn("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(nn("pause"),this._readableState.flowing=!1,this.emit("pause")),this};function PD(t){var e=t._readableState;for(nn("flow",e.flowing);e.flowing&&t.read()!==null;);}Hn.prototype.wrap=function(t){var e=this,r=this._readableState,n=!1;t.on("end",function(){if(nn("wrapped end"),r.decoder&&!r.ended){var s=r.decoder.end();s&&s.length&&e.push(s)}e.push(null)}),t.on("data",function(s){if(nn("wrapped data"),r.decoder&&(s=r.decoder.write(s)),!(r.objectMode&&s==null)&&!(!r.objectMode&&(!s||!s.length))){var a=e.push(s);a||(n=!0,t.pause())}});for(var i in t)this[i]===void 0&&typeof t[i]=="function"&&(this[i]=function(s){return function(){return t[s].apply(t,arguments)}}(i));for(var o=0;o<SD.length;o++)t.on(SD[o],this.emit.bind(this,SD[o]));return this._read=function(s){nn("wrapped _read",s),n&&(n=!1,t.resume())},this};Object.defineProperty(Hn.prototype,"readableHighWaterMark",{enumerable:!1,get:function(){return this._readableState.highWaterMark}});Hn._fromList=mte;function mte(t,e){if(e.length===0)return null;var r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.head.data:r=e.buffer.concat(e.length),e.buffer.clear()):r=UIe(t,e.buffer,e.decoder),r}function UIe(t,e,r){var n;return t<e.head.data.length?(n=e.head.data.slice(0,t),e.head.data=e.head.data.slice(t)):t===e.head.data.length?n=e.shift():n=r?KIe(t,e):qIe(t,e),n}function KIe(t,e){var r=e.head,n=1,i=r.data;for(t-=i.length;r=r.next;){var o=r.data,s=t>o.length?o.length:t;if(s===o.length?i+=o:i+=o.slice(0,t),t-=s,t===0){s===o.length?(++n,r.next?e.head=r.next:e.head=e.tail=null):(e.head=r,r.data=o.slice(s));break}++n}return e.length-=n,i}function qIe(t,e){var r=FE.allocUnsafe(t),n=e.head,i=1;for(n.data.copy(r),t-=n.data.length;n=n.next;){var o=n.data,s=t>o.length?o.length:t;if(o.copy(r,r.length-t,0,s),t-=s,t===0){s===o.length?(++i,n.next?e.head=n.next:e.head=e.tail=null):(e.head=n,n.data=o.slice(s));break}++i}return e.length-=i,r}function AD(t){var e=t._readableState;if(e.length>0)throw new Error('"endReadable()" called on non-empty stream');e.endEmitted||(e.ended=!0,u1.nextTick(LIe,e,t))}function LIe(t,e){!t.endEmitted&&t.length===0&&(t.endEmitted=!0,e.readable=!1,e.emit("end"))}function gte(t,e){for(var r=0,n=t.length;r<n;r++)if(t[r]===e)return r;return-1}});var ID=W((Tbt,_te)=>{"use strict";f();_te.exports=Mh;var mA=jg(),wte=Object.create(a1());wte.inherits=Vt();wte.inherits(Mh,mA);function FIe(t,e){var r=this._transformState;r.transforming=!1;var n=r.writecb;if(!n)return this.emit("error",new Error("write callback called multiple times"));r.writechunk=null,r.writecb=null,e!=null&&this.push(e),n(t);var i=this._readableState;i.reading=!1,(i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}function Mh(t){if(!(this instanceof Mh))return new Mh(t);mA.call(this,t),this._transformState={afterTransform:FIe.bind(this),needTransform:!1,transforming:!1,writecb:null,writechunk:null,writeencoding:null},this._readableState.needReadable=!0,this._readableState.sync=!1,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",zIe)}function zIe(){var t=this;typeof this._flush=="function"?this._flush(function(e,r){bte(t,e,r)}):bte(this,null,null)}Mh.prototype.push=function(t,e){return this._transformState.needTransform=!1,mA.prototype.push.call(this,t,e)};Mh.prototype._transform=function(t,e,r){throw new Error("_transform() is not implemented")};Mh.prototype._write=function(t,e,r){var n=this._transformState;if(n.writecb=r,n.writechunk=t,n.writeencoding=e,!n.transforming){var i=this._readableState;(n.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}};Mh.prototype._read=function(t){var e=this._transformState;e.writechunk!==null&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0};Mh.prototype._destroy=function(t,e){var r=this;mA.prototype._destroy.call(this,t,function(n){e(n),r.emit("close")})};function bte(t,e,r){if(e)return t.emit("error",e);if(r!=null&&t.push(r),t._writableState.length)throw new Error("Calling transform done when ws.length != 0");if(t._transformState.transforming)throw new Error("Calling transform done when still transforming");return t.push(null)}});var Tte=W((kbt,Ste)=>{"use strict";f();Ste.exports=zE;var xte=ID(),Ete=Object.create(a1());Ete.inherits=Vt();Ete.inherits(zE,xte);function zE(t){if(!(this instanceof zE))return new zE(t);xte.call(this,t)}zE.prototype._transform=function(t,e,r){r(null,t)}});var kte=W((Wl,Ate)=>{f();Wl=Ate.exports=bD();Wl.Stream=Wl;Wl.Readable=Wl;Wl.Writable=mD();Wl.Duplex=jg();Wl.Transform=ID();Wl.PassThrough=Tte()});var gA=W((Pte,RD)=>{f();(function(t,e){"use strict";function r(B,p){if(!B)throw new Error(p||"Assertion failed")}function n(B,p){B.super_=p;var m=function(){};m.prototype=p.prototype,B.prototype=new m,B.prototype.constructor=B}function i(B,p,m){if(i.isBN(B))return B;this.negative=0,this.words=null,this.length=0,this.red=null,B!==null&&((p==="le"||p==="be")&&(m=p,p=10),this._init(B||0,p||10,m||"be"))}typeof t=="object"?t.exports=i:e.BN=i,i.BN=i,i.wordSize=26;var o;try{typeof window<"u"&&typeof window.Buffer<"u"?o=window.Buffer:o=Z7().Buffer}catch{}i.isBN=function(p){return p instanceof i?!0:p!==null&&typeof p=="object"&&p.constructor.wordSize===i.wordSize&&Array.isArray(p.words)},i.max=function(p,m){return p.cmp(m)>0?p:m},i.min=function(p,m){return p.cmp(m)<0?p:m},i.prototype._init=function(p,m,w){if(typeof p=="number")return this._initNumber(p,m,w);if(typeof p=="object")return this._initArray(p,m,w);m==="hex"&&(m=16),r(m===(m|0)&&m>=2&&m<=36),p=p.toString().replace(/\s+/g,"");var E=0;p[0]==="-"&&(E++,this.negative=1),E<p.length&&(m===16?this._parseHex(p,E,w):(this._parseBase(p,m,E),w==="le"&&this._initArray(this.toArray(),m,w)))},i.prototype._initNumber=function(p,m,w){p<0&&(this.negative=1,p=-p),p<67108864?(this.words=[p&67108863],this.length=1):p<4503599627370496?(this.words=[p&67108863,p/67108864&67108863],this.length=2):(r(p<9007199254740992),this.words=[p&67108863,p/67108864&67108863,1],this.length=3),w==="le"&&this._initArray(this.toArray(),m,w)},i.prototype._initArray=function(p,m,w){if(r(typeof p.length=="number"),p.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(p.length/3),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var _,b,C=0;if(w==="be")for(E=p.length-1,_=0;E>=0;E-=3)b=p[E]|p[E-1]<<8|p[E-2]<<16,this.words[_]|=b<<C&67108863,this.words[_+1]=b>>>26-C&67108863,C+=24,C>=26&&(C-=26,_++);else if(w==="le")for(E=0,_=0;E<p.length;E+=3)b=p[E]|p[E+1]<<8|p[E+2]<<16,this.words[_]|=b<<C&67108863,this.words[_+1]=b>>>26-C&67108863,C+=24,C>=26&&(C-=26,_++);return this._strip()};function s(B,p){var m=B.charCodeAt(p);if(m>=48&&m<=57)return m-48;if(m>=65&&m<=70)return m-55;if(m>=97&&m<=102)return m-87;r(!1,"Invalid character in "+B)}function a(B,p,m){var w=s(B,m);return m-1>=p&&(w|=s(B,m-1)<<4),w}i.prototype._parseHex=function(p,m,w){this.length=Math.ceil((p.length-m)/6),this.words=new Array(this.length);for(var E=0;E<this.length;E++)this.words[E]=0;var _=0,b=0,C;if(w==="be")for(E=p.length-1;E>=m;E-=2)C=a(p,m,E)<<_,this.words[b]|=C&67108863,_>=18?(_-=18,b+=1,this.words[b]|=C>>>26):_+=8;else{var N=p.length-m;for(E=N%2===0?m+1:m;E<p.length;E+=2)C=a(p,m,E)<<_,this.words[b]|=C&67108863,_>=18?(_-=18,b+=1,this.words[b]|=C>>>26):_+=8}this._strip()};function d(B,p,m,w){for(var E=0,_=0,b=Math.min(B.length,m),C=p;C<b;C++){var N=B.charCodeAt(C)-48;E*=w,N>=49?_=N-49+10:N>=17?_=N-17+10:_=N,r(N>=0&&_<w,"Invalid character"),E+=_}return E}i.prototype._parseBase=function(p,m,w){this.words=[0],this.length=1;for(var E=0,_=1;_<=67108863;_*=m)E++;E--,_=_/m|0;for(var b=p.length-w,C=b%E,N=Math.min(b,b-C)+w,D=0,U=w;U<N;U+=E)D=d(p,U,U+E,m),this.imuln(_),this.words[0]+D<67108864?this.words[0]+=D:this._iaddn(D);if(C!==0){var G=1;for(D=d(p,U,p.length,m),U=0;U<C;U++)G*=m;this.imuln(G),this.words[0]+D<67108864?this.words[0]+=D:this._iaddn(D)}this._strip()},i.prototype.copy=function(p){p.words=new Array(this.length);for(var m=0;m<this.length;m++)p.words[m]=this.words[m];p.length=this.length,p.negative=this.negative,p.red=this.red};function u(B,p){B.words=p.words,B.length=p.length,B.negative=p.negative,B.red=p.red}if(i.prototype._move=function(p){u(p,this)},i.prototype.clone=function(){var p=new i(null);return this.copy(p),p},i.prototype._expand=function(p){for(;this.length<p;)this.words[this.length++]=0;return this},i.prototype._strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},i.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},typeof Symbol<"u"&&typeof Symbol.for=="function")try{i.prototype[Symbol.for("nodejs.util.inspect.custom")]=c}catch{i.prototype.inspect=c}else i.prototype.inspect=c;function c(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"}var l=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],h=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],y=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];i.prototype.toString=function(p,m){p=p||10,m=m|0||1;var w;if(p===16||p==="hex"){w="";for(var E=0,_=0,b=0;b<this.length;b++){var C=this.words[b],N=((C<<E|_)&16777215).toString(16);_=C>>>24-E&16777215,E+=2,E>=26&&(E-=26,b--),_!==0||b!==this.length-1?w=l[6-N.length]+N+w:w=N+w}for(_!==0&&(w=_.toString(16)+w);w.length%m!==0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}if(p===(p|0)&&p>=2&&p<=36){var D=h[p],U=y[p];w="";var G=this.clone();for(G.negative=0;!G.isZero();){var Y=G.modrn(U).toString(p);G=G.idivn(U),G.isZero()?w=Y+w:w=l[D-Y.length]+Y+w}for(this.isZero()&&(w="0"+w);w.length%m!==0;)w="0"+w;return this.negative!==0&&(w="-"+w),w}r(!1,"Base should be between 2 and 36")},i.prototype.toNumber=function(){var p=this.words[0];return this.length===2?p+=this.words[1]*67108864:this.length===3&&this.words[2]===1?p+=4503599627370496+this.words[1]*67108864:this.length>2&&r(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-p:p},i.prototype.toJSON=function(){return this.toString(16,2)},o&&(i.prototype.toBuffer=function(p,m){return this.toArrayLike(o,p,m)}),i.prototype.toArray=function(p,m){return this.toArrayLike(Array,p,m)};var g=function(p,m){return p.allocUnsafe?p.allocUnsafe(m):new p(m)};i.prototype.toArrayLike=function(p,m,w){this._strip();var E=this.byteLength(),_=w||Math.max(1,E);r(E<=_,"byte array longer than desired length"),r(_>0,"Requested array length <= 0");var b=g(p,_),C=m==="le"?"LE":"BE";return this["_toArrayLike"+C](b,E),b},i.prototype._toArrayLikeLE=function(p,m){for(var w=0,E=0,_=0,b=0;_<this.length;_++){var C=this.words[_]<<b|E;p[w++]=C&255,w<p.length&&(p[w++]=C>>8&255),w<p.length&&(p[w++]=C>>16&255),b===6?(w<p.length&&(p[w++]=C>>24&255),E=0,b=0):(E=C>>>24,b+=2)}if(w<p.length)for(p[w++]=E;w<p.length;)p[w++]=0},i.prototype._toArrayLikeBE=function(p,m){for(var w=p.length-1,E=0,_=0,b=0;_<this.length;_++){var C=this.words[_]<<b|E;p[w--]=C&255,w>=0&&(p[w--]=C>>8&255),w>=0&&(p[w--]=C>>16&255),b===6?(w>=0&&(p[w--]=C>>24&255),E=0,b=0):(E=C>>>24,b+=2)}if(w>=0)for(p[w--]=E;w>=0;)p[w--]=0},Math.clz32?i.prototype._countBits=function(p){return 32-Math.clz32(p)}:i.prototype._countBits=function(p){var m=p,w=0;return m>=4096&&(w+=13,m>>>=13),m>=64&&(w+=7,m>>>=7),m>=8&&(w+=4,m>>>=4),m>=2&&(w+=2,m>>>=2),w+m},i.prototype._zeroBits=function(p){if(p===0)return 26;var m=p,w=0;return m&8191||(w+=13,m>>>=13),m&127||(w+=7,m>>>=7),m&15||(w+=4,m>>>=4),m&3||(w+=2,m>>>=2),m&1||w++,w},i.prototype.bitLength=function(){var p=this.words[this.length-1],m=this._countBits(p);return(this.length-1)*26+m};function v(B){for(var p=new Array(B.bitLength()),m=0;m<p.length;m++){var w=m/26|0,E=m%26;p[m]=B.words[w]>>>E&1}return p}i.prototype.zeroBits=function(){if(this.isZero())return 0;for(var p=0,m=0;m<this.length;m++){var w=this._zeroBits(this.words[m]);if(p+=w,w!==26)break}return p},i.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},i.prototype.toTwos=function(p){return this.negative!==0?this.abs().inotn(p).iaddn(1):this.clone()},i.prototype.fromTwos=function(p){return this.testn(p-1)?this.notn(p).iaddn(1).ineg():this.clone()},i.prototype.isNeg=function(){return this.negative!==0},i.prototype.neg=function(){return this.clone().ineg()},i.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},i.prototype.iuor=function(p){for(;this.length<p.length;)this.words[this.length++]=0;for(var m=0;m<p.length;m++)this.words[m]=this.words[m]|p.words[m];return this._strip()},i.prototype.ior=function(p){return r((this.negative|p.negative)===0),this.iuor(p)},i.prototype.or=function(p){return this.length>p.length?this.clone().ior(p):p.clone().ior(this)},i.prototype.uor=function(p){return this.length>p.length?this.clone().iuor(p):p.clone().iuor(this)},i.prototype.iuand=function(p){var m;this.length>p.length?m=p:m=this;for(var w=0;w<m.length;w++)this.words[w]=this.words[w]&p.words[w];return this.length=m.length,this._strip()},i.prototype.iand=function(p){return r((this.negative|p.negative)===0),this.iuand(p)},i.prototype.and=function(p){return this.length>p.length?this.clone().iand(p):p.clone().iand(this)},i.prototype.uand=function(p){return this.length>p.length?this.clone().iuand(p):p.clone().iuand(this)},i.prototype.iuxor=function(p){var m,w;this.length>p.length?(m=this,w=p):(m=p,w=this);for(var E=0;E<w.length;E++)this.words[E]=m.words[E]^w.words[E];if(this!==m)for(;E<m.length;E++)this.words[E]=m.words[E];return this.length=m.length,this._strip()},i.prototype.ixor=function(p){return r((this.negative|p.negative)===0),this.iuxor(p)},i.prototype.xor=function(p){return this.length>p.length?this.clone().ixor(p):p.clone().ixor(this)},i.prototype.uxor=function(p){return this.length>p.length?this.clone().iuxor(p):p.clone().iuxor(this)},i.prototype.inotn=function(p){r(typeof p=="number"&&p>=0);var m=Math.ceil(p/26)|0,w=p%26;this._expand(m),w>0&&m--;for(var E=0;E<m;E++)this.words[E]=~this.words[E]&67108863;return w>0&&(this.words[E]=~this.words[E]&67108863>>26-w),this._strip()},i.prototype.notn=function(p){return this.clone().inotn(p)},i.prototype.setn=function(p,m){r(typeof p=="number"&&p>=0);var w=p/26|0,E=p%26;return this._expand(w+1),m?this.words[w]=this.words[w]|1<<E:this.words[w]=this.words[w]&~(1<<E),this._strip()},i.prototype.iadd=function(p){var m;if(this.negative!==0&&p.negative===0)return this.negative=0,m=this.isub(p),this.negative^=1,this._normSign();if(this.negative===0&&p.negative!==0)return p.negative=0,m=this.isub(p),p.negative=1,m._normSign();var w,E;this.length>p.length?(w=this,E=p):(w=p,E=this);for(var _=0,b=0;b<E.length;b++)m=(w.words[b]|0)+(E.words[b]|0)+_,this.words[b]=m&67108863,_=m>>>26;for(;_!==0&&b<w.length;b++)m=(w.words[b]|0)+_,this.words[b]=m&67108863,_=m>>>26;if(this.length=w.length,_!==0)this.words[this.length]=_,this.length++;else if(w!==this)for(;b<w.length;b++)this.words[b]=w.words[b];return this},i.prototype.add=function(p){var m;return p.negative!==0&&this.negative===0?(p.negative=0,m=this.sub(p),p.negative^=1,m):p.negative===0&&this.negative!==0?(this.negative=0,m=p.sub(this),this.negative=1,m):this.length>p.length?this.clone().iadd(p):p.clone().iadd(this)},i.prototype.isub=function(p){if(p.negative!==0){p.negative=0;var m=this.iadd(p);return p.negative=1,m._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(p),this.negative=1,this._normSign();var w=this.cmp(p);if(w===0)return this.negative=0,this.length=1,this.words[0]=0,this;var E,_;w>0?(E=this,_=p):(E=p,_=this);for(var b=0,C=0;C<_.length;C++)m=(E.words[C]|0)-(_.words[C]|0)+b,b=m>>26,this.words[C]=m&67108863;for(;b!==0&&C<E.length;C++)m=(E.words[C]|0)+b,b=m>>26,this.words[C]=m&67108863;if(b===0&&C<E.length&&E!==this)for(;C<E.length;C++)this.words[C]=E.words[C];return this.length=Math.max(this.length,C),E!==this&&(this.negative=1),this._strip()},i.prototype.sub=function(p){return this.clone().isub(p)};function x(B,p,m){m.negative=p.negative^B.negative;var w=B.length+p.length|0;m.length=w,w=w-1|0;var E=B.words[0]|0,_=p.words[0]|0,b=E*_,C=b&67108863,N=b/67108864|0;m.words[0]=C;for(var D=1;D<w;D++){for(var U=N>>>26,G=N&67108863,Y=Math.min(D,p.length-1),J=Math.max(0,D-B.length+1);J<=Y;J++){var H=D-J|0;E=B.words[H]|0,_=p.words[J]|0,b=E*_+G,U+=b/67108864|0,G=b&67108863}m.words[D]=G|0,N=U|0}return N!==0?m.words[D]=N|0:m.length--,m._strip()}var S=function(p,m,w){var E=p.words,_=m.words,b=w.words,C=0,N,D,U,G=E[0]|0,Y=G&8191,J=G>>>13,H=E[1]|0,X=H&8191,te=H>>>13,ne=E[2]|0,Q=ne&8191,re=ne>>>13,ae=E[3]|0,he=ae&8191,ge=ae>>>13,ie=E[4]|0,pe=ie&8191,be=ie>>>13,Ue=E[5]|0,ke=Ue&8191,it=Ue>>>13,St=E[6]|0,Fe=St&8191,mt=St>>>13,In=E[7]|0,Pe=In&8191,Te=In>>>13,Wt=E[8]|0,Re=Wt&8191,xe=Wt>>>13,qr=E[9]|0,We=qr&8191,Ye=qr>>>13,an=_[0]|0,Bt=an&8191,Ze=an>>>13,xd=_[1]|0,Ot=xd&8191,qt=xd>>>13,j0=_[2]|0,Nt=j0&8191,Xt=j0>>>13,Ed=_[3]|0,Qt=Ed&8191,Gt=Ed>>>13,$0=_[4]|0,Lt=$0&8191,Jt=$0>>>13,N0=_[5]|0,Yt=N0&8191,er=N0>>>13,oy=_[6]|0,ee=oy&8191,Z=oy>>>13,oe=_[7]|0,ce=oe&8191,ue=oe>>>13,$e=_[8]|0,Be=$e&8191,Ne=$e>>>13,Br=_[9]|0,Ft=Br&8191,pt=Br>>>13;w.negative=p.negative^m.negative,w.length=19,N=Math.imul(Y,Bt),D=Math.imul(Y,Ze),D=D+Math.imul(J,Bt)|0,U=Math.imul(J,Ze);var tn=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(tn>>>26)|0,tn&=67108863,N=Math.imul(X,Bt),D=Math.imul(X,Ze),D=D+Math.imul(te,Bt)|0,U=Math.imul(te,Ze),N=N+Math.imul(Y,Ot)|0,D=D+Math.imul(Y,qt)|0,D=D+Math.imul(J,Ot)|0,U=U+Math.imul(J,qt)|0;var yn=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(yn>>>26)|0,yn&=67108863,N=Math.imul(Q,Bt),D=Math.imul(Q,Ze),D=D+Math.imul(re,Bt)|0,U=Math.imul(re,Ze),N=N+Math.imul(X,Ot)|0,D=D+Math.imul(X,qt)|0,D=D+Math.imul(te,Ot)|0,U=U+Math.imul(te,qt)|0,N=N+Math.imul(Y,Nt)|0,D=D+Math.imul(Y,Xt)|0,D=D+Math.imul(J,Nt)|0,U=U+Math.imul(J,Xt)|0;var Zr=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(Zr>>>26)|0,Zr&=67108863,N=Math.imul(he,Bt),D=Math.imul(he,Ze),D=D+Math.imul(ge,Bt)|0,U=Math.imul(ge,Ze),N=N+Math.imul(Q,Ot)|0,D=D+Math.imul(Q,qt)|0,D=D+Math.imul(re,Ot)|0,U=U+Math.imul(re,qt)|0,N=N+Math.imul(X,Nt)|0,D=D+Math.imul(X,Xt)|0,D=D+Math.imul(te,Nt)|0,U=U+Math.imul(te,Xt)|0,N=N+Math.imul(Y,Qt)|0,D=D+Math.imul(Y,Gt)|0,D=D+Math.imul(J,Qt)|0,U=U+Math.imul(J,Gt)|0;var dr=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(dr>>>26)|0,dr&=67108863,N=Math.imul(pe,Bt),D=Math.imul(pe,Ze),D=D+Math.imul(be,Bt)|0,U=Math.imul(be,Ze),N=N+Math.imul(he,Ot)|0,D=D+Math.imul(he,qt)|0,D=D+Math.imul(ge,Ot)|0,U=U+Math.imul(ge,qt)|0,N=N+Math.imul(Q,Nt)|0,D=D+Math.imul(Q,Xt)|0,D=D+Math.imul(re,Nt)|0,U=U+Math.imul(re,Xt)|0,N=N+Math.imul(X,Qt)|0,D=D+Math.imul(X,Gt)|0,D=D+Math.imul(te,Qt)|0,U=U+Math.imul(te,Gt)|0,N=N+Math.imul(Y,Lt)|0,D=D+Math.imul(Y,Jt)|0,D=D+Math.imul(J,Lt)|0,U=U+Math.imul(J,Jt)|0;var rn=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(rn>>>26)|0,rn&=67108863,N=Math.imul(ke,Bt),D=Math.imul(ke,Ze),D=D+Math.imul(it,Bt)|0,U=Math.imul(it,Ze),N=N+Math.imul(pe,Ot)|0,D=D+Math.imul(pe,qt)|0,D=D+Math.imul(be,Ot)|0,U=U+Math.imul(be,qt)|0,N=N+Math.imul(he,Nt)|0,D=D+Math.imul(he,Xt)|0,D=D+Math.imul(ge,Nt)|0,U=U+Math.imul(ge,Xt)|0,N=N+Math.imul(Q,Qt)|0,D=D+Math.imul(Q,Gt)|0,D=D+Math.imul(re,Qt)|0,U=U+Math.imul(re,Gt)|0,N=N+Math.imul(X,Lt)|0,D=D+Math.imul(X,Jt)|0,D=D+Math.imul(te,Lt)|0,U=U+Math.imul(te,Jt)|0,N=N+Math.imul(Y,Yt)|0,D=D+Math.imul(Y,er)|0,D=D+Math.imul(J,Yt)|0,U=U+Math.imul(J,er)|0;var Nr=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(Nr>>>26)|0,Nr&=67108863,N=Math.imul(Fe,Bt),D=Math.imul(Fe,Ze),D=D+Math.imul(mt,Bt)|0,U=Math.imul(mt,Ze),N=N+Math.imul(ke,Ot)|0,D=D+Math.imul(ke,qt)|0,D=D+Math.imul(it,Ot)|0,U=U+Math.imul(it,qt)|0,N=N+Math.imul(pe,Nt)|0,D=D+Math.imul(pe,Xt)|0,D=D+Math.imul(be,Nt)|0,U=U+Math.imul(be,Xt)|0,N=N+Math.imul(he,Qt)|0,D=D+Math.imul(he,Gt)|0,D=D+Math.imul(ge,Qt)|0,U=U+Math.imul(ge,Gt)|0,N=N+Math.imul(Q,Lt)|0,D=D+Math.imul(Q,Jt)|0,D=D+Math.imul(re,Lt)|0,U=U+Math.imul(re,Jt)|0,N=N+Math.imul(X,Yt)|0,D=D+Math.imul(X,er)|0,D=D+Math.imul(te,Yt)|0,U=U+Math.imul(te,er)|0,N=N+Math.imul(Y,ee)|0,D=D+Math.imul(Y,Z)|0,D=D+Math.imul(J,ee)|0,U=U+Math.imul(J,Z)|0;var wa=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(wa>>>26)|0,wa&=67108863,N=Math.imul(Pe,Bt),D=Math.imul(Pe,Ze),D=D+Math.imul(Te,Bt)|0,U=Math.imul(Te,Ze),N=N+Math.imul(Fe,Ot)|0,D=D+Math.imul(Fe,qt)|0,D=D+Math.imul(mt,Ot)|0,U=U+Math.imul(mt,qt)|0,N=N+Math.imul(ke,Nt)|0,D=D+Math.imul(ke,Xt)|0,D=D+Math.imul(it,Nt)|0,U=U+Math.imul(it,Xt)|0,N=N+Math.imul(pe,Qt)|0,D=D+Math.imul(pe,Gt)|0,D=D+Math.imul(be,Qt)|0,U=U+Math.imul(be,Gt)|0,N=N+Math.imul(he,Lt)|0,D=D+Math.imul(he,Jt)|0,D=D+Math.imul(ge,Lt)|0,U=U+Math.imul(ge,Jt)|0,N=N+Math.imul(Q,Yt)|0,D=D+Math.imul(Q,er)|0,D=D+Math.imul(re,Yt)|0,U=U+Math.imul(re,er)|0,N=N+Math.imul(X,ee)|0,D=D+Math.imul(X,Z)|0,D=D+Math.imul(te,ee)|0,U=U+Math.imul(te,Z)|0,N=N+Math.imul(Y,ce)|0,D=D+Math.imul(Y,ue)|0,D=D+Math.imul(J,ce)|0,U=U+Math.imul(J,ue)|0;var Ri=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(Ri>>>26)|0,Ri&=67108863,N=Math.imul(Re,Bt),D=Math.imul(Re,Ze),D=D+Math.imul(xe,Bt)|0,U=Math.imul(xe,Ze),N=N+Math.imul(Pe,Ot)|0,D=D+Math.imul(Pe,qt)|0,D=D+Math.imul(Te,Ot)|0,U=U+Math.imul(Te,qt)|0,N=N+Math.imul(Fe,Nt)|0,D=D+Math.imul(Fe,Xt)|0,D=D+Math.imul(mt,Nt)|0,U=U+Math.imul(mt,Xt)|0,N=N+Math.imul(ke,Qt)|0,D=D+Math.imul(ke,Gt)|0,D=D+Math.imul(it,Qt)|0,U=U+Math.imul(it,Gt)|0,N=N+Math.imul(pe,Lt)|0,D=D+Math.imul(pe,Jt)|0,D=D+Math.imul(be,Lt)|0,U=U+Math.imul(be,Jt)|0,N=N+Math.imul(he,Yt)|0,D=D+Math.imul(he,er)|0,D=D+Math.imul(ge,Yt)|0,U=U+Math.imul(ge,er)|0,N=N+Math.imul(Q,ee)|0,D=D+Math.imul(Q,Z)|0,D=D+Math.imul(re,ee)|0,U=U+Math.imul(re,Z)|0,N=N+Math.imul(X,ce)|0,D=D+Math.imul(X,ue)|0,D=D+Math.imul(te,ce)|0,U=U+Math.imul(te,ue)|0,N=N+Math.imul(Y,Be)|0,D=D+Math.imul(Y,Ne)|0,D=D+Math.imul(J,Be)|0,U=U+Math.imul(J,Ne)|0;var Vi=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(Vi>>>26)|0,Vi&=67108863,N=Math.imul(We,Bt),D=Math.imul(We,Ze),D=D+Math.imul(Ye,Bt)|0,U=Math.imul(Ye,Ze),N=N+Math.imul(Re,Ot)|0,D=D+Math.imul(Re,qt)|0,D=D+Math.imul(xe,Ot)|0,U=U+Math.imul(xe,qt)|0,N=N+Math.imul(Pe,Nt)|0,D=D+Math.imul(Pe,Xt)|0,D=D+Math.imul(Te,Nt)|0,U=U+Math.imul(Te,Xt)|0,N=N+Math.imul(Fe,Qt)|0,D=D+Math.imul(Fe,Gt)|0,D=D+Math.imul(mt,Qt)|0,U=U+Math.imul(mt,Gt)|0,N=N+Math.imul(ke,Lt)|0,D=D+Math.imul(ke,Jt)|0,D=D+Math.imul(it,Lt)|0,U=U+Math.imul(it,Jt)|0,N=N+Math.imul(pe,Yt)|0,D=D+Math.imul(pe,er)|0,D=D+Math.imul(be,Yt)|0,U=U+Math.imul(be,er)|0,N=N+Math.imul(he,ee)|0,D=D+Math.imul(he,Z)|0,D=D+Math.imul(ge,ee)|0,U=U+Math.imul(ge,Z)|0,N=N+Math.imul(Q,ce)|0,D=D+Math.imul(Q,ue)|0,D=D+Math.imul(re,ce)|0,U=U+Math.imul(re,ue)|0,N=N+Math.imul(X,Be)|0,D=D+Math.imul(X,Ne)|0,D=D+Math.imul(te,Be)|0,U=U+Math.imul(te,Ne)|0,N=N+Math.imul(Y,Ft)|0,D=D+Math.imul(Y,pt)|0,D=D+Math.imul(J,Ft)|0,U=U+Math.imul(J,pt)|0;var Lr=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(Lr>>>26)|0,Lr&=67108863,N=Math.imul(We,Ot),D=Math.imul(We,qt),D=D+Math.imul(Ye,Ot)|0,U=Math.imul(Ye,qt),N=N+Math.imul(Re,Nt)|0,D=D+Math.imul(Re,Xt)|0,D=D+Math.imul(xe,Nt)|0,U=U+Math.imul(xe,Xt)|0,N=N+Math.imul(Pe,Qt)|0,D=D+Math.imul(Pe,Gt)|0,D=D+Math.imul(Te,Qt)|0,U=U+Math.imul(Te,Gt)|0,N=N+Math.imul(Fe,Lt)|0,D=D+Math.imul(Fe,Jt)|0,D=D+Math.imul(mt,Lt)|0,U=U+Math.imul(mt,Jt)|0,N=N+Math.imul(ke,Yt)|0,D=D+Math.imul(ke,er)|0,D=D+Math.imul(it,Yt)|0,U=U+Math.imul(it,er)|0,N=N+Math.imul(pe,ee)|0,D=D+Math.imul(pe,Z)|0,D=D+Math.imul(be,ee)|0,U=U+Math.imul(be,Z)|0,N=N+Math.imul(he,ce)|0,D=D+Math.imul(he,ue)|0,D=D+Math.imul(ge,ce)|0,U=U+Math.imul(ge,ue)|0,N=N+Math.imul(Q,Be)|0,D=D+Math.imul(Q,Ne)|0,D=D+Math.imul(re,Be)|0,U=U+Math.imul(re,Ne)|0,N=N+Math.imul(X,Ft)|0,D=D+Math.imul(X,pt)|0,D=D+Math.imul(te,Ft)|0,U=U+Math.imul(te,pt)|0;var Bi=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(Bi>>>26)|0,Bi&=67108863,N=Math.imul(We,Nt),D=Math.imul(We,Xt),D=D+Math.imul(Ye,Nt)|0,U=Math.imul(Ye,Xt),N=N+Math.imul(Re,Qt)|0,D=D+Math.imul(Re,Gt)|0,D=D+Math.imul(xe,Qt)|0,U=U+Math.imul(xe,Gt)|0,N=N+Math.imul(Pe,Lt)|0,D=D+Math.imul(Pe,Jt)|0,D=D+Math.imul(Te,Lt)|0,U=U+Math.imul(Te,Jt)|0,N=N+Math.imul(Fe,Yt)|0,D=D+Math.imul(Fe,er)|0,D=D+Math.imul(mt,Yt)|0,U=U+Math.imul(mt,er)|0,N=N+Math.imul(ke,ee)|0,D=D+Math.imul(ke,Z)|0,D=D+Math.imul(it,ee)|0,U=U+Math.imul(it,Z)|0,N=N+Math.imul(pe,ce)|0,D=D+Math.imul(pe,ue)|0,D=D+Math.imul(be,ce)|0,U=U+Math.imul(be,ue)|0,N=N+Math.imul(he,Be)|0,D=D+Math.imul(he,Ne)|0,D=D+Math.imul(ge,Be)|0,U=U+Math.imul(ge,Ne)|0,N=N+Math.imul(Q,Ft)|0,D=D+Math.imul(Q,pt)|0,D=D+Math.imul(re,Ft)|0,U=U+Math.imul(re,pt)|0;var Hi=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(Hi>>>26)|0,Hi&=67108863,N=Math.imul(We,Qt),D=Math.imul(We,Gt),D=D+Math.imul(Ye,Qt)|0,U=Math.imul(Ye,Gt),N=N+Math.imul(Re,Lt)|0,D=D+Math.imul(Re,Jt)|0,D=D+Math.imul(xe,Lt)|0,U=U+Math.imul(xe,Jt)|0,N=N+Math.imul(Pe,Yt)|0,D=D+Math.imul(Pe,er)|0,D=D+Math.imul(Te,Yt)|0,U=U+Math.imul(Te,er)|0,N=N+Math.imul(Fe,ee)|0,D=D+Math.imul(Fe,Z)|0,D=D+Math.imul(mt,ee)|0,U=U+Math.imul(mt,Z)|0,N=N+Math.imul(ke,ce)|0,D=D+Math.imul(ke,ue)|0,D=D+Math.imul(it,ce)|0,U=U+Math.imul(it,ue)|0,N=N+Math.imul(pe,Be)|0,D=D+Math.imul(pe,Ne)|0,D=D+Math.imul(be,Be)|0,U=U+Math.imul(be,Ne)|0,N=N+Math.imul(he,Ft)|0,D=D+Math.imul(he,pt)|0,D=D+Math.imul(ge,Ft)|0,U=U+Math.imul(ge,pt)|0;var Eo=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(Eo>>>26)|0,Eo&=67108863,N=Math.imul(We,Lt),D=Math.imul(We,Jt),D=D+Math.imul(Ye,Lt)|0,U=Math.imul(Ye,Jt),N=N+Math.imul(Re,Yt)|0,D=D+Math.imul(Re,er)|0,D=D+Math.imul(xe,Yt)|0,U=U+Math.imul(xe,er)|0,N=N+Math.imul(Pe,ee)|0,D=D+Math.imul(Pe,Z)|0,D=D+Math.imul(Te,ee)|0,U=U+Math.imul(Te,Z)|0,N=N+Math.imul(Fe,ce)|0,D=D+Math.imul(Fe,ue)|0,D=D+Math.imul(mt,ce)|0,U=U+Math.imul(mt,ue)|0,N=N+Math.imul(ke,Be)|0,D=D+Math.imul(ke,Ne)|0,D=D+Math.imul(it,Be)|0,U=U+Math.imul(it,Ne)|0,N=N+Math.imul(pe,Ft)|0,D=D+Math.imul(pe,pt)|0,D=D+Math.imul(be,Ft)|0,U=U+Math.imul(be,pt)|0;var _a=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(_a>>>26)|0,_a&=67108863,N=Math.imul(We,Yt),D=Math.imul(We,er),D=D+Math.imul(Ye,Yt)|0,U=Math.imul(Ye,er),N=N+Math.imul(Re,ee)|0,D=D+Math.imul(Re,Z)|0,D=D+Math.imul(xe,ee)|0,U=U+Math.imul(xe,Z)|0,N=N+Math.imul(Pe,ce)|0,D=D+Math.imul(Pe,ue)|0,D=D+Math.imul(Te,ce)|0,U=U+Math.imul(Te,ue)|0,N=N+Math.imul(Fe,Be)|0,D=D+Math.imul(Fe,Ne)|0,D=D+Math.imul(mt,Be)|0,U=U+Math.imul(mt,Ne)|0,N=N+Math.imul(ke,Ft)|0,D=D+Math.imul(ke,pt)|0,D=D+Math.imul(it,Ft)|0,U=U+Math.imul(it,pt)|0;var rs=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(rs>>>26)|0,rs&=67108863,N=Math.imul(We,ee),D=Math.imul(We,Z),D=D+Math.imul(Ye,ee)|0,U=Math.imul(Ye,Z),N=N+Math.imul(Re,ce)|0,D=D+Math.imul(Re,ue)|0,D=D+Math.imul(xe,ce)|0,U=U+Math.imul(xe,ue)|0,N=N+Math.imul(Pe,Be)|0,D=D+Math.imul(Pe,Ne)|0,D=D+Math.imul(Te,Be)|0,U=U+Math.imul(Te,Ne)|0,N=N+Math.imul(Fe,Ft)|0,D=D+Math.imul(Fe,pt)|0,D=D+Math.imul(mt,Ft)|0,U=U+Math.imul(mt,pt)|0;var Rc=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(Rc>>>26)|0,Rc&=67108863,N=Math.imul(We,ce),D=Math.imul(We,ue),D=D+Math.imul(Ye,ce)|0,U=Math.imul(Ye,ue),N=N+Math.imul(Re,Be)|0,D=D+Math.imul(Re,Ne)|0,D=D+Math.imul(xe,Be)|0,U=U+Math.imul(xe,Ne)|0,N=N+Math.imul(Pe,Ft)|0,D=D+Math.imul(Pe,pt)|0,D=D+Math.imul(Te,Ft)|0,U=U+Math.imul(Te,pt)|0;var sy=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(sy>>>26)|0,sy&=67108863,N=Math.imul(We,Be),D=Math.imul(We,Ne),D=D+Math.imul(Ye,Be)|0,U=Math.imul(Ye,Ne),N=N+Math.imul(Re,Ft)|0,D=D+Math.imul(Re,pt)|0,D=D+Math.imul(xe,Ft)|0,U=U+Math.imul(xe,pt)|0;var ay=(C+N|0)+((D&8191)<<13)|0;C=(U+(D>>>13)|0)+(ay>>>26)|0,ay&=67108863,N=Math.imul(We,Ft),D=Math.imul(We,pt),D=D+Math.imul(Ye,Ft)|0,U=Math.imul(Ye,pt);var Pl=(C+N|0)+((D&8191)<<13)|0;return C=(U+(D>>>13)|0)+(Pl>>>26)|0,Pl&=67108863,b[0]=tn,b[1]=yn,b[2]=Zr,b[3]=dr,b[4]=rn,b[5]=Nr,b[6]=wa,b[7]=Ri,b[8]=Vi,b[9]=Lr,b[10]=Bi,b[11]=Hi,b[12]=Eo,b[13]=_a,b[14]=rs,b[15]=Rc,b[16]=sy,b[17]=ay,b[18]=Pl,C!==0&&(b[19]=C,w.length++),w};Math.imul||(S=x);function A(B,p,m){m.negative=p.negative^B.negative,m.length=B.length+p.length;for(var w=0,E=0,_=0;_<m.length-1;_++){var b=E;E=0;for(var C=w&67108863,N=Math.min(_,p.length-1),D=Math.max(0,_-B.length+1);D<=N;D++){var U=_-D,G=B.words[U]|0,Y=p.words[D]|0,J=G*Y,H=J&67108863;b=b+(J/67108864|0)|0,H=H+C|0,C=H&67108863,b=b+(H>>>26)|0,E+=b>>>26,b&=67108863}m.words[_]=C,w=b,b=E}return w!==0?m.words[_]=w:m.length--,m._strip()}function T(B,p,m){return A(B,p,m)}i.prototype.mulTo=function(p,m){var w,E=this.length+p.length;return this.length===10&&p.length===10?w=S(this,p,m):E<63?w=x(this,p,m):E<1024?w=A(this,p,m):w=T(this,p,m),w};function $(B,p){this.x=B,this.y=p}$.prototype.makeRBT=function(p){for(var m=new Array(p),w=i.prototype._countBits(p)-1,E=0;E<p;E++)m[E]=this.revBin(E,w,p);return m},$.prototype.revBin=function(p,m,w){if(p===0||p===w-1)return p;for(var E=0,_=0;_<m;_++)E|=(p&1)<<m-_-1,p>>=1;return E},$.prototype.permute=function(p,m,w,E,_,b){for(var C=0;C<b;C++)E[C]=m[p[C]],_[C]=w[p[C]]},$.prototype.transform=function(p,m,w,E,_,b){this.permute(b,p,m,w,E,_);for(var C=1;C<_;C<<=1)for(var N=C<<1,D=Math.cos(2*Math.PI/N),U=Math.sin(2*Math.PI/N),G=0;G<_;G+=N)for(var Y=D,J=U,H=0;H<C;H++){var X=w[G+H],te=E[G+H],ne=w[G+H+C],Q=E[G+H+C],re=Y*ne-J*Q;Q=Y*Q+J*ne,ne=re,w[G+H]=X+ne,E[G+H]=te+Q,w[G+H+C]=X-ne,E[G+H+C]=te-Q,H!==N&&(re=D*Y-U*J,J=D*J+U*Y,Y=re)}},$.prototype.guessLen13b=function(p,m){var w=Math.max(m,p)|1,E=w&1,_=0;for(w=w/2|0;w;w=w>>>1)_++;return 1<<_+1+E},$.prototype.conjugate=function(p,m,w){if(!(w<=1))for(var E=0;E<w/2;E++){var _=p[E];p[E]=p[w-E-1],p[w-E-1]=_,_=m[E],m[E]=-m[w-E-1],m[w-E-1]=-_}},$.prototype.normalize13b=function(p,m){for(var w=0,E=0;E<m/2;E++){var _=Math.round(p[2*E+1]/m)*8192+Math.round(p[2*E]/m)+w;p[E]=_&67108863,_<67108864?w=0:w=_/67108864|0}return p},$.prototype.convert13b=function(p,m,w,E){for(var _=0,b=0;b<m;b++)_=_+(p[b]|0),w[2*b]=_&8191,_=_>>>13,w[2*b+1]=_&8191,_=_>>>13;for(b=2*m;b<E;++b)w[b]=0;r(_===0),r((_&-8192)===0)},$.prototype.stub=function(p){for(var m=new Array(p),w=0;w<p;w++)m[w]=0;return m},$.prototype.mulp=function(p,m,w){var E=2*this.guessLen13b(p.length,m.length),_=this.makeRBT(E),b=this.stub(E),C=new Array(E),N=new Array(E),D=new Array(E),U=new Array(E),G=new Array(E),Y=new Array(E),J=w.words;J.length=E,this.convert13b(p.words,p.length,C,E),this.convert13b(m.words,m.length,U,E),this.transform(C,b,N,D,E,_),this.transform(U,b,G,Y,E,_);for(var H=0;H<E;H++){var X=N[H]*G[H]-D[H]*Y[H];D[H]=N[H]*Y[H]+D[H]*G[H],N[H]=X}return this.conjugate(N,D,E),this.transform(N,D,J,b,E,_),this.conjugate(J,b,E),this.normalize13b(J,E),w.negative=p.negative^m.negative,w.length=p.length+m.length,w._strip()},i.prototype.mul=function(p){var m=new i(null);return m.words=new Array(this.length+p.length),this.mulTo(p,m)},i.prototype.mulf=function(p){var m=new i(null);return m.words=new Array(this.length+p.length),T(this,p,m)},i.prototype.imul=function(p){return this.clone().mulTo(p,this)},i.prototype.imuln=function(p){var m=p<0;m&&(p=-p),r(typeof p=="number"),r(p<67108864);for(var w=0,E=0;E<this.length;E++){var _=(this.words[E]|0)*p,b=(_&67108863)+(w&67108863);w>>=26,w+=_/67108864|0,w+=b>>>26,this.words[E]=b&67108863}return w!==0&&(this.words[E]=w,this.length++),m?this.ineg():this},i.prototype.muln=function(p){return this.clone().imuln(p)},i.prototype.sqr=function(){return this.mul(this)},i.prototype.isqr=function(){return this.imul(this.clone())},i.prototype.pow=function(p){var m=v(p);if(m.length===0)return new i(1);for(var w=this,E=0;E<m.length&&m[E]===0;E++,w=w.sqr());if(++E<m.length)for(var _=w.sqr();E<m.length;E++,_=_.sqr())m[E]!==0&&(w=w.mul(_));return w},i.prototype.iushln=function(p){r(typeof p=="number"&&p>=0);var m=p%26,w=(p-m)/26,E=67108863>>>26-m<<26-m,_;if(m!==0){var b=0;for(_=0;_<this.length;_++){var C=this.words[_]&E,N=(this.words[_]|0)-C<<m;this.words[_]=N|b,b=C>>>26-m}b&&(this.words[_]=b,this.length++)}if(w!==0){for(_=this.length-1;_>=0;_--)this.words[_+w]=this.words[_];for(_=0;_<w;_++)this.words[_]=0;this.length+=w}return this._strip()},i.prototype.ishln=function(p){return r(this.negative===0),this.iushln(p)},i.prototype.iushrn=function(p,m,w){r(typeof p=="number"&&p>=0);var E;m?E=(m-m%26)/26:E=0;var _=p%26,b=Math.min((p-_)/26,this.length),C=67108863^67108863>>>_<<_,N=w;if(E-=b,E=Math.max(0,E),N){for(var D=0;D<b;D++)N.words[D]=this.words[D];N.length=b}if(b!==0)if(this.length>b)for(this.length-=b,D=0;D<this.length;D++)this.words[D]=this.words[D+b];else this.words[0]=0,this.length=1;var U=0;for(D=this.length-1;D>=0&&(U!==0||D>=E);D--){var G=this.words[D]|0;this.words[D]=U<<26-_|G>>>_,U=G&C}return N&&U!==0&&(N.words[N.length++]=U),this.length===0&&(this.words[0]=0,this.length=1),this._strip()},i.prototype.ishrn=function(p,m,w){return r(this.negative===0),this.iushrn(p,m,w)},i.prototype.shln=function(p){return this.clone().ishln(p)},i.prototype.ushln=function(p){return this.clone().iushln(p)},i.prototype.shrn=function(p){return this.clone().ishrn(p)},i.prototype.ushrn=function(p){return this.clone().iushrn(p)},i.prototype.testn=function(p){r(typeof p=="number"&&p>=0);var m=p%26,w=(p-m)/26,E=1<<m;if(this.length<=w)return!1;var _=this.words[w];return!!(_&E)},i.prototype.imaskn=function(p){r(typeof p=="number"&&p>=0);var m=p%26,w=(p-m)/26;if(r(this.negative===0,"imaskn works only with positive numbers"),this.length<=w)return this;if(m!==0&&w++,this.length=Math.min(w,this.length),m!==0){var E=67108863^67108863>>>m<<m;this.words[this.length-1]&=E}return this._strip()},i.prototype.maskn=function(p){return this.clone().imaskn(p)},i.prototype.iaddn=function(p){return r(typeof p=="number"),r(p<67108864),p<0?this.isubn(-p):this.negative!==0?this.length===1&&(this.words[0]|0)<=p?(this.words[0]=p-(this.words[0]|0),this.negative=0,this):(this.negative=0,this.isubn(p),this.negative=1,this):this._iaddn(p)},i.prototype._iaddn=function(p){this.words[0]+=p;for(var m=0;m<this.length&&this.words[m]>=67108864;m++)this.words[m]-=67108864,m===this.length-1?this.words[m+1]=1:this.words[m+1]++;return this.length=Math.max(this.length,m+1),this},i.prototype.isubn=function(p){if(r(typeof p=="number"),r(p<67108864),p<0)return this.iaddn(-p);if(this.negative!==0)return this.negative=0,this.iaddn(p),this.negative=1,this;if(this.words[0]-=p,this.length===1&&this.words[0]<0)this.words[0]=-this.words[0],this.negative=1;else for(var m=0;m<this.length&&this.words[m]<0;m++)this.words[m]+=67108864,this.words[m+1]-=1;return this._strip()},i.prototype.addn=function(p){return this.clone().iaddn(p)},i.prototype.subn=function(p){return this.clone().isubn(p)},i.prototype.iabs=function(){return this.negative=0,this},i.prototype.abs=function(){return this.clone().iabs()},i.prototype._ishlnsubmul=function(p,m,w){var E=p.length+w,_;this._expand(E);var b,C=0;for(_=0;_<p.length;_++){b=(this.words[_+w]|0)+C;var N=(p.words[_]|0)*m;b-=N&67108863,C=(b>>26)-(N/67108864|0),this.words[_+w]=b&67108863}for(;_<this.length-w;_++)b=(this.words[_+w]|0)+C,C=b>>26,this.words[_+w]=b&67108863;if(C===0)return this._strip();for(r(C===-1),C=0,_=0;_<this.length;_++)b=-(this.words[_]|0)+C,C=b>>26,this.words[_]=b&67108863;return this.negative=1,this._strip()},i.prototype._wordDiv=function(p,m){var w=this.length-p.length,E=this.clone(),_=p,b=_.words[_.length-1]|0,C=this._countBits(b);w=26-C,w!==0&&(_=_.ushln(w),E.iushln(w),b=_.words[_.length-1]|0);var N=E.length-_.length,D;if(m!=="mod"){D=new i(null),D.length=N+1,D.words=new Array(D.length);for(var U=0;U<D.length;U++)D.words[U]=0}var G=E.clone()._ishlnsubmul(_,1,N);G.negative===0&&(E=G,D&&(D.words[N]=1));for(var Y=N-1;Y>=0;Y--){var J=(E.words[_.length+Y]|0)*67108864+(E.words[_.length+Y-1]|0);for(J=Math.min(J/b|0,67108863),E._ishlnsubmul(_,J,Y);E.negative!==0;)J--,E.negative=0,E._ishlnsubmul(_,1,Y),E.isZero()||(E.negative^=1);D&&(D.words[Y]=J)}return D&&D._strip(),E._strip(),m!=="div"&&w!==0&&E.iushrn(w),{div:D||null,mod:E}},i.prototype.divmod=function(p,m,w){if(r(!p.isZero()),this.isZero())return{div:new i(0),mod:new i(0)};var E,_,b;return this.negative!==0&&p.negative===0?(b=this.neg().divmod(p,m),m!=="mod"&&(E=b.div.neg()),m!=="div"&&(_=b.mod.neg(),w&&_.negative!==0&&_.iadd(p)),{div:E,mod:_}):this.negative===0&&p.negative!==0?(b=this.divmod(p.neg(),m),m!=="mod"&&(E=b.div.neg()),{div:E,mod:b.mod}):this.negative&p.negative?(b=this.neg().divmod(p.neg(),m),m!=="div"&&(_=b.mod.neg(),w&&_.negative!==0&&_.isub(p)),{div:b.div,mod:_}):p.length>this.length||this.cmp(p)<0?{div:new i(0),mod:this}:p.length===1?m==="div"?{div:this.divn(p.words[0]),mod:null}:m==="mod"?{div:null,mod:new i(this.modrn(p.words[0]))}:{div:this.divn(p.words[0]),mod:new i(this.modrn(p.words[0]))}:this._wordDiv(p,m)},i.prototype.div=function(p){return this.divmod(p,"div",!1).div},i.prototype.mod=function(p){return this.divmod(p,"mod",!1).mod},i.prototype.umod=function(p){return this.divmod(p,"mod",!0).mod},i.prototype.divRound=function(p){var m=this.divmod(p);if(m.mod.isZero())return m.div;var w=m.div.negative!==0?m.mod.isub(p):m.mod,E=p.ushrn(1),_=p.andln(1),b=w.cmp(E);return b<0||_===1&&b===0?m.div:m.div.negative!==0?m.div.isubn(1):m.div.iaddn(1)},i.prototype.modrn=function(p){var m=p<0;m&&(p=-p),r(p<=67108863);for(var w=(1<<26)%p,E=0,_=this.length-1;_>=0;_--)E=(w*E+(this.words[_]|0))%p;return m?-E:E},i.prototype.modn=function(p){return this.modrn(p)},i.prototype.idivn=function(p){var m=p<0;m&&(p=-p),r(p<=67108863);for(var w=0,E=this.length-1;E>=0;E--){var _=(this.words[E]|0)+w*67108864;this.words[E]=_/p|0,w=_%p}return this._strip(),m?this.ineg():this},i.prototype.divn=function(p){return this.clone().idivn(p)},i.prototype.egcd=function(p){r(p.negative===0),r(!p.isZero());var m=this,w=p.clone();m.negative!==0?m=m.umod(p):m=m.clone();for(var E=new i(1),_=new i(0),b=new i(0),C=new i(1),N=0;m.isEven()&&w.isEven();)m.iushrn(1),w.iushrn(1),++N;for(var D=w.clone(),U=m.clone();!m.isZero();){for(var G=0,Y=1;!(m.words[0]&Y)&&G<26;++G,Y<<=1);if(G>0)for(m.iushrn(G);G-- >0;)(E.isOdd()||_.isOdd())&&(E.iadd(D),_.isub(U)),E.iushrn(1),_.iushrn(1);for(var J=0,H=1;!(w.words[0]&H)&&J<26;++J,H<<=1);if(J>0)for(w.iushrn(J);J-- >0;)(b.isOdd()||C.isOdd())&&(b.iadd(D),C.isub(U)),b.iushrn(1),C.iushrn(1);m.cmp(w)>=0?(m.isub(w),E.isub(b),_.isub(C)):(w.isub(m),b.isub(E),C.isub(_))}return{a:b,b:C,gcd:w.iushln(N)}},i.prototype._invmp=function(p){r(p.negative===0),r(!p.isZero());var m=this,w=p.clone();m.negative!==0?m=m.umod(p):m=m.clone();for(var E=new i(1),_=new i(0),b=w.clone();m.cmpn(1)>0&&w.cmpn(1)>0;){for(var C=0,N=1;!(m.words[0]&N)&&C<26;++C,N<<=1);if(C>0)for(m.iushrn(C);C-- >0;)E.isOdd()&&E.iadd(b),E.iushrn(1);for(var D=0,U=1;!(w.words[0]&U)&&D<26;++D,U<<=1);if(D>0)for(w.iushrn(D);D-- >0;)_.isOdd()&&_.iadd(b),_.iushrn(1);m.cmp(w)>=0?(m.isub(w),E.isub(_)):(w.isub(m),_.isub(E))}var G;return m.cmpn(1)===0?G=E:G=_,G.cmpn(0)<0&&G.iadd(p),G},i.prototype.gcd=function(p){if(this.isZero())return p.abs();if(p.isZero())return this.abs();var m=this.clone(),w=p.clone();m.negative=0,w.negative=0;for(var E=0;m.isEven()&&w.isEven();E++)m.iushrn(1),w.iushrn(1);do{for(;m.isEven();)m.iushrn(1);for(;w.isEven();)w.iushrn(1);var _=m.cmp(w);if(_<0){var b=m;m=w,w=b}else if(_===0||w.cmpn(1)===0)break;m.isub(w)}while(!0);return w.iushln(E)},i.prototype.invm=function(p){return this.egcd(p).a.umod(p)},i.prototype.isEven=function(){return(this.words[0]&1)===0},i.prototype.isOdd=function(){return(this.words[0]&1)===1},i.prototype.andln=function(p){return this.words[0]&p},i.prototype.bincn=function(p){r(typeof p=="number");var m=p%26,w=(p-m)/26,E=1<<m;if(this.length<=w)return this._expand(w+1),this.words[w]|=E,this;for(var _=E,b=w;_!==0&&b<this.length;b++){var C=this.words[b]|0;C+=_,_=C>>>26,C&=67108863,this.words[b]=C}return _!==0&&(this.words[b]=_,this.length++),this},i.prototype.isZero=function(){return this.length===1&&this.words[0]===0},i.prototype.cmpn=function(p){var m=p<0;if(this.negative!==0&&!m)return-1;if(this.negative===0&&m)return 1;this._strip();var w;if(this.length>1)w=1;else{m&&(p=-p),r(p<=67108863,"Number is too big");var E=this.words[0]|0;w=E===p?0:E<p?-1:1}return this.negative!==0?-w|0:w},i.prototype.cmp=function(p){if(this.negative!==0&&p.negative===0)return-1;if(this.negative===0&&p.negative!==0)return 1;var m=this.ucmp(p);return this.negative!==0?-m|0:m},i.prototype.ucmp=function(p){if(this.length>p.length)return 1;if(this.length<p.length)return-1;for(var m=0,w=this.length-1;w>=0;w--){var E=this.words[w]|0,_=p.words[w]|0;if(E!==_){E<_?m=-1:E>_&&(m=1);break}}return m},i.prototype.gtn=function(p){return this.cmpn(p)===1},i.prototype.gt=function(p){return this.cmp(p)===1},i.prototype.gten=function(p){return this.cmpn(p)>=0},i.prototype.gte=function(p){return this.cmp(p)>=0},i.prototype.ltn=function(p){return this.cmpn(p)===-1},i.prototype.lt=function(p){return this.cmp(p)===-1},i.prototype.lten=function(p){return this.cmpn(p)<=0},i.prototype.lte=function(p){return this.cmp(p)<=0},i.prototype.eqn=function(p){return this.cmpn(p)===0},i.prototype.eq=function(p){return this.cmp(p)===0},i.red=function(p){return new k(p)},i.prototype.toRed=function(p){return r(!this.red,"Already a number in reduction context"),r(this.negative===0,"red works only with positives"),p.convertTo(this)._forceRed(p)},i.prototype.fromRed=function(){return r(this.red,"fromRed works only with numbers in reduction context"),this.red.convertFrom(this)},i.prototype._forceRed=function(p){return this.red=p,this},i.prototype.forceRed=function(p){return r(!this.red,"Already a number in reduction context"),this._forceRed(p)},i.prototype.redAdd=function(p){return r(this.red,"redAdd works only with red numbers"),this.red.add(this,p)},i.prototype.redIAdd=function(p){return r(this.red,"redIAdd works only with red numbers"),this.red.iadd(this,p)},i.prototype.redSub=function(p){return r(this.red,"redSub works only with red numbers"),this.red.sub(this,p)},i.prototype.redISub=function(p){return r(this.red,"redISub works only with red numbers"),this.red.isub(this,p)},i.prototype.redShl=function(p){return r(this.red,"redShl works only with red numbers"),this.red.shl(this,p)},i.prototype.redMul=function(p){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,p),this.red.mul(this,p)},i.prototype.redIMul=function(p){return r(this.red,"redMul works only with red numbers"),this.red._verify2(this,p),this.red.imul(this,p)},i.prototype.redSqr=function(){return r(this.red,"redSqr works only with red numbers"),this.red._verify1(this),this.red.sqr(this)},i.prototype.redISqr=function(){return r(this.red,"redISqr works only with red numbers"),this.red._verify1(this),this.red.isqr(this)},i.prototype.redSqrt=function(){return r(this.red,"redSqrt works only with red numbers"),this.red._verify1(this),this.red.sqrt(this)},i.prototype.redInvm=function(){return r(this.red,"redInvm works only with red numbers"),this.red._verify1(this),this.red.invm(this)},i.prototype.redNeg=function(){return r(this.red,"redNeg works only with red numbers"),this.red._verify1(this),this.red.neg(this)},i.prototype.redPow=function(p){return r(this.red&&!p.red,"redPow(normalNum)"),this.red._verify1(this),this.red.pow(this,p)};var j={k256:null,p224:null,p192:null,p25519:null};function K(B,p){this.name=B,this.p=new i(p,16),this.n=this.p.bitLength(),this.k=new i(1).iushln(this.n).isub(this.p),this.tmp=this._tmp()}K.prototype._tmp=function(){var p=new i(null);return p.words=new Array(Math.ceil(this.n/13)),p},K.prototype.ireduce=function(p){var m=p,w;do this.split(m,this.tmp),m=this.imulK(m),m=m.iadd(this.tmp),w=m.bitLength();while(w>this.n);var E=w<this.n?-1:m.ucmp(this.p);return E===0?(m.words[0]=0,m.length=1):E>0?m.isub(this.p):m.strip!==void 0?m.strip():m._strip(),m},K.prototype.split=function(p,m){p.iushrn(this.n,0,m)},K.prototype.imulK=function(p){return p.imul(this.k)};function F(){K.call(this,"k256","ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f")}n(F,K),F.prototype.split=function(p,m){for(var w=4194303,E=Math.min(p.length,9),_=0;_<E;_++)m.words[_]=p.words[_];if(m.length=E,p.length<=9){p.words[0]=0,p.length=1;return}var b=p.words[9];for(m.words[m.length++]=b&w,_=10;_<p.length;_++){var C=p.words[_]|0;p.words[_-10]=(C&w)<<4|b>>>22,b=C}b>>>=22,p.words[_-10]=b,b===0&&p.length>10?p.length-=10:p.length-=9},F.prototype.imulK=function(p){p.words[p.length]=0,p.words[p.length+1]=0,p.length+=2;for(var m=0,w=0;w<p.length;w++){var E=p.words[w]|0;m+=E*977,p.words[w]=m&67108863,m=E*64+(m/67108864|0)}return p.words[p.length-1]===0&&(p.length--,p.words[p.length-1]===0&&p.length--),p};function L(){K.call(this,"p224","ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001")}n(L,K);function V(){K.call(this,"p192","ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff")}n(V,K);function q(){K.call(this,"25519","7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed")}n(q,K),q.prototype.imulK=function(p){for(var m=0,w=0;w<p.length;w++){var E=(p.words[w]|0)*19+m,_=E&67108863;E>>>=26,p.words[w]=_,m=E}return m!==0&&(p.words[p.length++]=m),p},i._prime=function(p){if(j[p])return j[p];var m;if(p==="k256")m=new F;else if(p==="p224")m=new L;else if(p==="p192")m=new V;else if(p==="p25519")m=new q;else throw new Error("Unknown prime "+p);return j[p]=m,m};function k(B){if(typeof B=="string"){var p=i._prime(B);this.m=p.p,this.prime=p}else r(B.gtn(1),"modulus must be greater than 1"),this.m=B,this.prime=null}k.prototype._verify1=function(p){r(p.negative===0,"red works only with positives"),r(p.red,"red works only with red numbers")},k.prototype._verify2=function(p,m){r((p.negative|m.negative)===0,"red works only with positives"),r(p.red&&p.red===m.red,"red works only with red numbers")},k.prototype.imod=function(p){return this.prime?this.prime.ireduce(p)._forceRed(this):(u(p,p.umod(this.m)._forceRed(this)),p)},k.prototype.neg=function(p){return p.isZero()?p.clone():this.m.sub(p)._forceRed(this)},k.prototype.add=function(p,m){this._verify2(p,m);var w=p.add(m);return w.cmp(this.m)>=0&&w.isub(this.m),w._forceRed(this)},k.prototype.iadd=function(p,m){this._verify2(p,m);var w=p.iadd(m);return w.cmp(this.m)>=0&&w.isub(this.m),w},k.prototype.sub=function(p,m){this._verify2(p,m);var w=p.sub(m);return w.cmpn(0)<0&&w.iadd(this.m),w._forceRed(this)},k.prototype.isub=function(p,m){this._verify2(p,m);var w=p.isub(m);return w.cmpn(0)<0&&w.iadd(this.m),w},k.prototype.shl=function(p,m){return this._verify1(p),this.imod(p.ushln(m))},k.prototype.imul=function(p,m){return this._verify2(p,m),this.imod(p.imul(m))},k.prototype.mul=function(p,m){return this._verify2(p,m),this.imod(p.mul(m))},k.prototype.isqr=function(p){return this.imul(p,p.clone())},k.prototype.sqr=function(p){return this.mul(p,p)},k.prototype.sqrt=function(p){if(p.isZero())return p.clone();var m=this.m.andln(3);if(r(m%2===1),m===3){var w=this.m.add(new i(1)).iushrn(2);return this.pow(p,w)}for(var E=this.m.subn(1),_=0;!E.isZero()&&E.andln(1)===0;)_++,E.iushrn(1);r(!E.isZero());var b=new i(1).toRed(this),C=b.redNeg(),N=this.m.subn(1).iushrn(1),D=this.m.bitLength();for(D=new i(2*D*D).toRed(this);this.pow(D,N).cmp(C)!==0;)D.redIAdd(C);for(var U=this.pow(D,E),G=this.pow(p,E.addn(1).iushrn(1)),Y=this.pow(p,E),J=_;Y.cmp(b)!==0;){for(var H=Y,X=0;H.cmp(b)!==0;X++)H=H.redSqr();r(X<J);var te=this.pow(U,new i(1).iushln(J-X-1));G=G.redMul(te),U=te.redSqr(),Y=Y.redMul(U),J=X}return G},k.prototype.invm=function(p){var m=p._invmp(this.m);return m.negative!==0?(m.negative=0,this.imod(m).redNeg()):this.imod(m)},k.prototype.pow=function(p,m){if(m.isZero())return new i(1).toRed(this);if(m.cmpn(1)===0)return p.clone();var w=4,E=new Array(1<<w);E[0]=new i(1).toRed(this),E[1]=p;for(var _=2;_<E.length;_++)E[_]=this.mul(E[_-1],p);var b=E[0],C=0,N=0,D=m.bitLength()%26;for(D===0&&(D=26),_=m.length-1;_>=0;_--){for(var U=m.words[_],G=D-1;G>=0;G--){var Y=U>>G&1;if(b!==E[0]&&(b=this.sqr(b)),Y===0&&C===0){N=0;continue}C<<=1,C|=Y,N++,!(N!==w&&(_!==0||G!==0))&&(b=this.mul(b,E[C]),N=0,C=0)}D=26}return b},k.prototype.convertTo=function(p){var m=p.umod(this.m);return m===p?m.clone():m},k.prototype.convertFrom=function(p){var m=p.clone();return m.red=null,m},i.mont=function(p){return new P(p)};function P(B){k.call(this,B),this.shift=this.m.bitLength(),this.shift%26!==0&&(this.shift+=26-this.shift%26),this.r=new i(1).iushln(this.shift),this.r2=this.imod(this.r.sqr()),this.rinv=this.r._invmp(this.m),this.minv=this.rinv.mul(this.r).isubn(1).div(this.m),this.minv=this.minv.umod(this.r),this.minv=this.r.sub(this.minv)}n(P,k),P.prototype.convertTo=function(p){return this.imod(p.ushln(this.shift))},P.prototype.convertFrom=function(p){var m=this.imod(p.mul(this.rinv));return m.red=null,m},P.prototype.imul=function(p,m){if(p.isZero()||m.isZero())return p.words[0]=0,p.length=1,p;var w=p.imul(m),E=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),_=w.isub(E).iushrn(this.shift),b=_;return _.cmp(this.m)>=0?b=_.isub(this.m):_.cmpn(0)<0&&(b=_.iadd(this.m)),b._forceRed(this)},P.prototype.mul=function(p,m){if(p.isZero()||m.isZero())return new i(0)._forceRed(this);var w=p.mul(m),E=w.maskn(this.shift).mul(this.minv).imaskn(this.shift).mul(this.m),_=w.isub(E).iushrn(this.shift),b=_;return _.cmp(this.m)>=0?b=_.isub(this.m):_.cmpn(0)<0&&(b=_.iadd(this.m)),b._forceRed(this)},P.prototype.invm=function(p){var m=this.imod(p._invmp(this.m).mul(this.r2));return m._forceRed(this)}})(typeof RD>"u"||RD,Pte)});var vA=W((Bbt,Bte)=>{f();var l1=gA(),VIe=bg();function HIe(t){var e=Ite(t),r=e.toRed(l1.mont(t.modulus)).redPow(new l1(t.publicExponent)).fromRed();return{blinder:r,unblinder:e.invm(t.modulus)}}function Ite(t){var e=t.modulus.byteLength(),r;do r=new l1(VIe(e));while(r.cmp(t.modulus)>=0||!r.umod(t.prime1)||!r.umod(t.prime2));return r}function Rte(t,e){var r=HIe(e),n=e.modulus.byteLength(),i=new l1(t).mul(r.blinder).umod(e.modulus),o=i.toRed(l1.mont(e.prime1)),s=i.toRed(l1.mont(e.prime2)),a=e.coefficient,d=e.prime1,u=e.prime2,c=o.redPow(e.exponent1).fromRed(),l=s.redPow(e.exponent2).fromRed(),h=c.isub(l).imul(a).umod(d).imul(u);return l.iadd(h).imul(r.unblinder).umod(e.modulus).toArrayLike(M.Buffer,"be",n)}Rte.getr=Ite;Bte.exports=Rte});var Ote=W((Mbt,WIe)=>{WIe.exports={name:"elliptic",version:"6.5.7",description:"EC cryptography",main:"lib/elliptic.js",files:["lib"],scripts:{lint:"eslint lib test","lint:fix":"npm run lint -- --fix",unit:"istanbul test _mocha --reporter=spec test/index.js",test:"npm run lint && npm run unit",version:"grunt dist && git add dist/"},repository:{type:"git",url:"git@github.com:indutny/elliptic"},keywords:["EC","Elliptic","curve","Cryptography"],author:"Fedor Indutny <fedor@indutny.com>",license:"MIT",bugs:{url:"https://github.com/indutny/elliptic/issues"},homepage:"https://github.com/indutny/elliptic",devDependencies:{brfs:"^2.0.2",coveralls:"^3.1.0",eslint:"^7.6.0",grunt:"^1.2.1","grunt-browserify":"^5.3.0","grunt-cli":"^1.3.2","grunt-contrib-connect":"^3.0.0","grunt-contrib-copy":"^1.0.0","grunt-contrib-uglify":"^5.0.0","grunt-mocha-istanbul":"^5.0.2","grunt-saucelabs":"^9.0.1",istanbul:"^0.4.5",mocha:"^8.0.1"},dependencies:{"bn.js":"^4.11.9",brorand:"^1.1.0","hash.js":"^1.0.0","hmac-drbg":"^1.0.1",inherits:"^2.0.4","minimalistic-assert":"^1.0.1","minimalistic-crypto-utils":"^1.0.1"}}});var BD=W(Cte=>{"use strict";f();var bA=Cte;function GIe(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t!="string"){for(var n=0;n<t.length;n++)r[n]=t[n]|0;return r}if(e==="hex"){t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!==0&&(t="0"+t);for(var n=0;n<t.length;n+=2)r.push(parseInt(t[n]+t[n+1],16))}else for(var n=0;n<t.length;n++){var i=t.charCodeAt(n),o=i>>8,s=i&255;o?r.push(o,s):r.push(s)}return r}bA.toArray=GIe;function Mte(t){return t.length===1?"0"+t:t}bA.zero2=Mte;function Dte(t){for(var e="",r=0;r<t.length;r++)e+=Mte(t[r].toString(16));return e}bA.toHex=Dte;bA.encode=function(e,r){return r==="hex"?Dte(e):e}});var zc=W(jte=>{"use strict";f();var $u=jte,JIe=Do(),YIe=Fc(),wA=BD();$u.assert=YIe;$u.toArray=wA.toArray;$u.zero2=wA.zero2;$u.toHex=wA.toHex;$u.encode=wA.encode;function ZIe(t,e,r){var n=new Array(Math.max(t.bitLength(),r)+1),i;for(i=0;i<n.length;i+=1)n[i]=0;var o=1<<e+1,s=t.clone();for(i=0;i<n.length;i++){var a,d=s.andln(o-1);s.isOdd()?(d>(o>>1)-1?a=(o>>1)-d:a=d,s.isubn(a)):a=0,n[i]=a,s.iushrn(1)}return n}$u.getNAF=ZIe;function XIe(t,e){var r=[[],[]];t=t.clone(),e=e.clone();for(var n=0,i=0,o;t.cmpn(-n)>0||e.cmpn(-i)>0;){var s=t.andln(3)+n&3,a=e.andln(3)+i&3;s===3&&(s=-1),a===3&&(a=-1);var d;s&1?(o=t.andln(7)+n&7,(o===3||o===5)&&a===2?d=-s:d=s):d=0,r[0].push(d);var u;a&1?(o=e.andln(7)+i&7,(o===3||o===5)&&s===2?u=-a:u=a):u=0,r[1].push(u),2*n===d+1&&(n=1-n),2*i===u+1&&(i=1-i),t.iushrn(1),e.iushrn(1)}return r}$u.getJSF=XIe;function QIe(t,e,r){var n="_"+e;t.prototype[e]=function(){return this[n]!==void 0?this[n]:this[n]=r.call(this)}}$u.cachedProperty=QIe;function eRe(t){return typeof t=="string"?$u.toArray(t,"hex"):t}$u.parseBytes=eRe;function tRe(t){return new JIe(t,"hex","le")}$u.intFromLE=tRe});var HE=W((Nbt,$te)=>{"use strict";f();var $g=Do(),VE=zc(),_A=VE.getNAF,rRe=VE.getJSF,xA=VE.assert;function Uy(t,e){this.type=t,this.p=new $g(e.p,16),this.red=e.prime?$g.red(e.prime):$g.mont(this.p),this.zero=new $g(0).toRed(this.red),this.one=new $g(1).toRed(this.red),this.two=new $g(2).toRed(this.red),this.n=e.n&&new $g(e.n,16),this.g=e.g&&this.pointFromJSON(e.g,e.gRed),this._wnafT1=new Array(4),this._wnafT2=new Array(4),this._wnafT3=new Array(4),this._wnafT4=new Array(4),this._bitLength=this.n?this.n.bitLength():0;var r=this.n&&this.p.div(this.n);!r||r.cmpn(100)>0?this.redN=null:(this._maxwellTrick=!0,this.redN=this.n.toRed(this.red))}$te.exports=Uy;Uy.prototype.point=function(){throw new Error("Not implemented")};Uy.prototype.validate=function(){throw new Error("Not implemented")};Uy.prototype._fixedNafMul=function(e,r){xA(e.precomputed);var n=e._getDoubles(),i=_A(r,1,this._bitLength),o=(1<<n.step+1)-(n.step%2===0?2:1);o/=3;var s=[],a,d;for(a=0;a<i.length;a+=n.step){d=0;for(var u=a+n.step-1;u>=a;u--)d=(d<<1)+i[u];s.push(d)}for(var c=this.jpoint(null,null,null),l=this.jpoint(null,null,null),h=o;h>0;h--){for(a=0;a<s.length;a++)d=s[a],d===h?l=l.mixedAdd(n.points[a]):d===-h&&(l=l.mixedAdd(n.points[a].neg()));c=c.add(l)}return c.toP()};Uy.prototype._wnafMul=function(e,r){var n=4,i=e._getNAFPoints(n);n=i.wnd;for(var o=i.points,s=_A(r,n,this._bitLength),a=this.jpoint(null,null,null),d=s.length-1;d>=0;d--){for(var u=0;d>=0&&s[d]===0;d--)u++;if(d>=0&&u++,a=a.dblp(u),d<0)break;var c=s[d];xA(c!==0),e.type==="affine"?c>0?a=a.mixedAdd(o[c-1>>1]):a=a.mixedAdd(o[-c-1>>1].neg()):c>0?a=a.add(o[c-1>>1]):a=a.add(o[-c-1>>1].neg())}return e.type==="affine"?a.toP():a};Uy.prototype._wnafMulAdd=function(e,r,n,i,o){var s=this._wnafT1,a=this._wnafT2,d=this._wnafT3,u=0,c,l,h;for(c=0;c<i;c++){h=r[c];var y=h._getNAFPoints(e);s[c]=y.wnd,a[c]=y.points}for(c=i-1;c>=1;c-=2){var g=c-1,v=c;if(s[g]!==1||s[v]!==1){d[g]=_A(n[g],s[g],this._bitLength),d[v]=_A(n[v],s[v],this._bitLength),u=Math.max(d[g].length,u),u=Math.max(d[v].length,u);continue}var x=[r[g],null,null,r[v]];r[g].y.cmp(r[v].y)===0?(x[1]=r[g].add(r[v]),x[2]=r[g].toJ().mixedAdd(r[v].neg())):r[g].y.cmp(r[v].y.redNeg())===0?(x[1]=r[g].toJ().mixedAdd(r[v]),x[2]=r[g].add(r[v].neg())):(x[1]=r[g].toJ().mixedAdd(r[v]),x[2]=r[g].toJ().mixedAdd(r[v].neg()));var S=[-3,-1,-5,-7,0,7,5,1,3],A=rRe(n[g],n[v]);for(u=Math.max(A[0].length,u),d[g]=new Array(u),d[v]=new Array(u),l=0;l<u;l++){var T=A[0][l]|0,$=A[1][l]|0;d[g][l]=S[(T+1)*3+($+1)],d[v][l]=0,a[g]=x}}var j=this.jpoint(null,null,null),K=this._wnafT4;for(c=u;c>=0;c--){for(var F=0;c>=0;){var L=!0;for(l=0;l<i;l++)K[l]=d[l][c]|0,K[l]!==0&&(L=!1);if(!L)break;F++,c--}if(c>=0&&F++,j=j.dblp(F),c<0)break;for(l=0;l<i;l++){var V=K[l];V!==0&&(V>0?h=a[l][V-1>>1]:V<0&&(h=a[l][-V-1>>1].neg()),h.type==="affine"?j=j.mixedAdd(h):j=j.add(h))}}for(c=0;c<i;c++)a[c]=null;return o?j:j.toP()};function jd(t,e){this.curve=t,this.type=e,this.precomputed=null}Uy.BasePoint=jd;jd.prototype.eq=function(){throw new Error("Not implemented")};jd.prototype.validate=function(){return this.curve.validate(this)};Uy.prototype.decodePoint=function(e,r){e=VE.toArray(e,r);var n=this.p.byteLength();if((e[0]===4||e[0]===6||e[0]===7)&&e.length-1===2*n){e[0]===6?xA(e[e.length-1]%2===0):e[0]===7&&xA(e[e.length-1]%2===1);var i=this.point(e.slice(1,1+n),e.slice(1+n,1+2*n));return i}else if((e[0]===2||e[0]===3)&&e.length-1===n)return this.pointFromX(e.slice(1,1+n),e[0]===3);throw new Error("Unknown point format")};jd.prototype.encodeCompressed=function(e){return this.encode(e,!0)};jd.prototype._encode=function(e){var r=this.curve.p.byteLength(),n=this.getX().toArray("be",r);return e?[this.getY().isEven()?2:3].concat(n):[4].concat(n,this.getY().toArray("be",r))};jd.prototype.encode=function(e,r){return VE.encode(this._encode(r),e)};jd.prototype.precompute=function(e){if(this.precomputed)return this;var r={doubles:null,naf:null,beta:null};return r.naf=this._getNAFPoints(8),r.doubles=this._getDoubles(4,e),r.beta=this._getBeta(),this.precomputed=r,this};jd.prototype._hasDoubles=function(e){if(!this.precomputed)return!1;var r=this.precomputed.doubles;return r?r.points.length>=Math.ceil((e.bitLength()+1)/r.step):!1};jd.prototype._getDoubles=function(e,r){if(this.precomputed&&this.precomputed.doubles)return this.precomputed.doubles;for(var n=[this],i=this,o=0;o<r;o+=e){for(var s=0;s<e;s++)i=i.dbl();n.push(i)}return{step:e,points:n}};jd.prototype._getNAFPoints=function(e){if(this.precomputed&&this.precomputed.naf)return this.precomputed.naf;for(var r=[this],n=(1<<e)-1,i=n===1?null:this.dbl(),o=1;o<n;o++)r[o]=r[o-1].add(i);return{wnd:e,points:r}};jd.prototype._getBeta=function(){return null};jd.prototype.dblp=function(e){for(var r=this,n=0;n<e;n++)r=r.dbl();return r}});var Ute=W((Kbt,Nte)=>{"use strict";f();var nRe=zc(),Si=Do(),OD=Vt(),f1=HE(),iRe=nRe.assert;function $d(t){f1.call(this,"short",t),this.a=new Si(t.a,16).toRed(this.red),this.b=new Si(t.b,16).toRed(this.red),this.tinv=this.two.redInvm(),this.zeroA=this.a.fromRed().cmpn(0)===0,this.threeA=this.a.fromRed().sub(this.p).cmpn(-3)===0,this.endo=this._getEndomorphism(t),this._endoWnafT1=new Array(4),this._endoWnafT2=new Array(4)}OD($d,f1);Nte.exports=$d;$d.prototype._getEndomorphism=function(e){if(!(!this.zeroA||!this.g||!this.n||this.p.modn(3)!==1)){var r,n;if(e.beta)r=new Si(e.beta,16).toRed(this.red);else{var i=this._getEndoRoots(this.p);r=i[0].cmp(i[1])<0?i[0]:i[1],r=r.toRed(this.red)}if(e.lambda)n=new Si(e.lambda,16);else{var o=this._getEndoRoots(this.n);this.g.mul(o[0]).x.cmp(this.g.x.redMul(r))===0?n=o[0]:(n=o[1],iRe(this.g.mul(n).x.cmp(this.g.x.redMul(r))===0))}var s;return e.basis?s=e.basis.map(function(a){return{a:new Si(a.a,16),b:new Si(a.b,16)}}):s=this._getEndoBasis(n),{beta:r,lambda:n,basis:s}}};$d.prototype._getEndoRoots=function(e){var r=e===this.p?this.red:Si.mont(e),n=new Si(2).toRed(r).redInvm(),i=n.redNeg(),o=new Si(3).toRed(r).redNeg().redSqrt().redMul(n),s=i.redAdd(o).fromRed(),a=i.redSub(o).fromRed();return[s,a]};$d.prototype._getEndoBasis=function(e){for(var r=this.n.ushrn(Math.floor(this.n.bitLength()/2)),n=e,i=this.n.clone(),o=new Si(1),s=new Si(0),a=new Si(0),d=new Si(1),u,c,l,h,y,g,v,x=0,S,A;n.cmpn(0)!==0;){var T=i.div(n);S=i.sub(T.mul(n)),A=a.sub(T.mul(o));var $=d.sub(T.mul(s));if(!l&&S.cmp(r)<0)u=v.neg(),c=o,l=S.neg(),h=A;else if(l&&++x===2)break;v=S,i=n,n=S,a=o,o=A,d=s,s=$}y=S.neg(),g=A;var j=l.sqr().add(h.sqr()),K=y.sqr().add(g.sqr());return K.cmp(j)>=0&&(y=u,g=c),l.negative&&(l=l.neg(),h=h.neg()),y.negative&&(y=y.neg(),g=g.neg()),[{a:l,b:h},{a:y,b:g}]};$d.prototype._endoSplit=function(e){var r=this.endo.basis,n=r[0],i=r[1],o=i.b.mul(e).divRound(this.n),s=n.b.neg().mul(e).divRound(this.n),a=o.mul(n.a),d=s.mul(i.a),u=o.mul(n.b),c=s.mul(i.b),l=e.sub(a).sub(d),h=u.add(c).neg();return{k1:l,k2:h}};$d.prototype.pointFromX=function(e,r){e=new Si(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr().redMul(e).redIAdd(e.redMul(this.a)).redIAdd(this.b),i=n.redSqrt();if(i.redSqr().redSub(n).cmp(this.zero)!==0)throw new Error("invalid point");var o=i.fromRed().isOdd();return(r&&!o||!r&&o)&&(i=i.redNeg()),this.point(e,i)};$d.prototype.validate=function(e){if(e.inf)return!0;var r=e.x,n=e.y,i=this.a.redMul(r),o=r.redSqr().redMul(r).redIAdd(i).redIAdd(this.b);return n.redSqr().redISub(o).cmpn(0)===0};$d.prototype._endoWnafMulAdd=function(e,r,n){for(var i=this._endoWnafT1,o=this._endoWnafT2,s=0;s<e.length;s++){var a=this._endoSplit(r[s]),d=e[s],u=d._getBeta();a.k1.negative&&(a.k1.ineg(),d=d.neg(!0)),a.k2.negative&&(a.k2.ineg(),u=u.neg(!0)),i[s*2]=d,i[s*2+1]=u,o[s*2]=a.k1,o[s*2+1]=a.k2}for(var c=this._wnafMulAdd(1,i,o,s*2,n),l=0;l<s*2;l++)i[l]=null,o[l]=null;return c};function Co(t,e,r,n){f1.BasePoint.call(this,t,"affine"),e===null&&r===null?(this.x=null,this.y=null,this.inf=!0):(this.x=new Si(e,16),this.y=new Si(r,16),n&&(this.x.forceRed(this.curve.red),this.y.forceRed(this.curve.red)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.inf=!1)}OD(Co,f1.BasePoint);$d.prototype.point=function(e,r,n){return new Co(this,e,r,n)};$d.prototype.pointFromJSON=function(e,r){return Co.fromJSON(this,e,r)};Co.prototype._getBeta=function(){if(this.curve.endo){var e=this.precomputed;if(e&&e.beta)return e.beta;var r=this.curve.point(this.x.redMul(this.curve.endo.beta),this.y);if(e){var n=this.curve,i=function(o){return n.point(o.x.redMul(n.endo.beta),o.y)};e.beta=r,r.precomputed={beta:null,naf:e.naf&&{wnd:e.naf.wnd,points:e.naf.points.map(i)},doubles:e.doubles&&{step:e.doubles.step,points:e.doubles.points.map(i)}}}return r}};Co.prototype.toJSON=function(){return this.precomputed?[this.x,this.y,this.precomputed&&{doubles:this.precomputed.doubles&&{step:this.precomputed.doubles.step,points:this.precomputed.doubles.points.slice(1)},naf:this.precomputed.naf&&{wnd:this.precomputed.naf.wnd,points:this.precomputed.naf.points.slice(1)}}]:[this.x,this.y]};Co.fromJSON=function(e,r,n){typeof r=="string"&&(r=JSON.parse(r));var i=e.point(r[0],r[1],n);if(!r[2])return i;function o(a){return e.point(a[0],a[1],n)}var s=r[2];return i.precomputed={beta:null,doubles:s.doubles&&{step:s.doubles.step,points:[i].concat(s.doubles.points.map(o))},naf:s.naf&&{wnd:s.naf.wnd,points:[i].concat(s.naf.points.map(o))}},i};Co.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+">"};Co.prototype.isInfinity=function(){return this.inf};Co.prototype.add=function(e){if(this.inf)return e;if(e.inf)return this;if(this.eq(e))return this.dbl();if(this.neg().eq(e))return this.curve.point(null,null);if(this.x.cmp(e.x)===0)return this.curve.point(null,null);var r=this.y.redSub(e.y);r.cmpn(0)!==0&&(r=r.redMul(this.x.redSub(e.x).redInvm()));var n=r.redSqr().redISub(this.x).redISub(e.x),i=r.redMul(this.x.redSub(n)).redISub(this.y);return this.curve.point(n,i)};Co.prototype.dbl=function(){if(this.inf)return this;var e=this.y.redAdd(this.y);if(e.cmpn(0)===0)return this.curve.point(null,null);var r=this.curve.a,n=this.x.redSqr(),i=e.redInvm(),o=n.redAdd(n).redIAdd(n).redIAdd(r).redMul(i),s=o.redSqr().redISub(this.x.redAdd(this.x)),a=o.redMul(this.x.redSub(s)).redISub(this.y);return this.curve.point(s,a)};Co.prototype.getX=function(){return this.x.fromRed()};Co.prototype.getY=function(){return this.y.fromRed()};Co.prototype.mul=function(e){return e=new Si(e,16),this.isInfinity()?this:this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve.endo?this.curve._endoWnafMulAdd([this],[e]):this.curve._wnafMul(this,e)};Co.prototype.mulAdd=function(e,r,n){var i=[this,r],o=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,o):this.curve._wnafMulAdd(1,i,o,2)};Co.prototype.jmulAdd=function(e,r,n){var i=[this,r],o=[e,n];return this.curve.endo?this.curve._endoWnafMulAdd(i,o,!0):this.curve._wnafMulAdd(1,i,o,2,!0)};Co.prototype.eq=function(e){return this===e||this.inf===e.inf&&(this.inf||this.x.cmp(e.x)===0&&this.y.cmp(e.y)===0)};Co.prototype.neg=function(e){if(this.inf)return this;var r=this.curve.point(this.x,this.y.redNeg());if(e&&this.precomputed){var n=this.precomputed,i=function(o){return o.neg()};r.precomputed={naf:n.naf&&{wnd:n.naf.wnd,points:n.naf.points.map(i)},doubles:n.doubles&&{step:n.doubles.step,points:n.doubles.points.map(i)}}}return r};Co.prototype.toJ=function(){if(this.inf)return this.curve.jpoint(null,null,null);var e=this.curve.jpoint(this.x,this.y,this.curve.one);return e};function cs(t,e,r,n){f1.BasePoint.call(this,t,"jacobian"),e===null&&r===null&&n===null?(this.x=this.curve.one,this.y=this.curve.one,this.z=new Si(0)):(this.x=new Si(e,16),this.y=new Si(r,16),this.z=new Si(n,16)),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.zOne=this.z===this.curve.one}OD(cs,f1.BasePoint);$d.prototype.jpoint=function(e,r,n){return new cs(this,e,r,n)};cs.prototype.toP=function(){if(this.isInfinity())return this.curve.point(null,null);var e=this.z.redInvm(),r=e.redSqr(),n=this.x.redMul(r),i=this.y.redMul(r).redMul(e);return this.curve.point(n,i)};cs.prototype.neg=function(){return this.curve.jpoint(this.x,this.y.redNeg(),this.z)};cs.prototype.add=function(e){if(this.isInfinity())return e;if(e.isInfinity())return this;var r=e.z.redSqr(),n=this.z.redSqr(),i=this.x.redMul(r),o=e.x.redMul(n),s=this.y.redMul(r.redMul(e.z)),a=e.y.redMul(n.redMul(this.z)),d=i.redSub(o),u=s.redSub(a);if(d.cmpn(0)===0)return u.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var c=d.redSqr(),l=c.redMul(d),h=i.redMul(c),y=u.redSqr().redIAdd(l).redISub(h).redISub(h),g=u.redMul(h.redISub(y)).redISub(s.redMul(l)),v=this.z.redMul(e.z).redMul(d);return this.curve.jpoint(y,g,v)};cs.prototype.mixedAdd=function(e){if(this.isInfinity())return e.toJ();if(e.isInfinity())return this;var r=this.z.redSqr(),n=this.x,i=e.x.redMul(r),o=this.y,s=e.y.redMul(r).redMul(this.z),a=n.redSub(i),d=o.redSub(s);if(a.cmpn(0)===0)return d.cmpn(0)!==0?this.curve.jpoint(null,null,null):this.dbl();var u=a.redSqr(),c=u.redMul(a),l=n.redMul(u),h=d.redSqr().redIAdd(c).redISub(l).redISub(l),y=d.redMul(l.redISub(h)).redISub(o.redMul(c)),g=this.z.redMul(a);return this.curve.jpoint(h,y,g)};cs.prototype.dblp=function(e){if(e===0)return this;if(this.isInfinity())return this;if(!e)return this.dbl();var r;if(this.curve.zeroA||this.curve.threeA){var n=this;for(r=0;r<e;r++)n=n.dbl();return n}var i=this.curve.a,o=this.curve.tinv,s=this.x,a=this.y,d=this.z,u=d.redSqr().redSqr(),c=a.redAdd(a);for(r=0;r<e;r++){var l=s.redSqr(),h=c.redSqr(),y=h.redSqr(),g=l.redAdd(l).redIAdd(l).redIAdd(i.redMul(u)),v=s.redMul(h),x=g.redSqr().redISub(v.redAdd(v)),S=v.redISub(x),A=g.redMul(S);A=A.redIAdd(A).redISub(y);var T=c.redMul(d);r+1<e&&(u=u.redMul(y)),s=x,d=T,c=A}return this.curve.jpoint(s,c.redMul(o),d)};cs.prototype.dbl=function(){return this.isInfinity()?this:this.curve.zeroA?this._zeroDbl():this.curve.threeA?this._threeDbl():this._dbl()};cs.prototype._zeroDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),o=this.y.redSqr(),s=o.redSqr(),a=this.x.redAdd(o).redSqr().redISub(i).redISub(s);a=a.redIAdd(a);var d=i.redAdd(i).redIAdd(i),u=d.redSqr().redISub(a).redISub(a),c=s.redIAdd(s);c=c.redIAdd(c),c=c.redIAdd(c),e=u,r=d.redMul(a.redISub(u)).redISub(c),n=this.y.redAdd(this.y)}else{var l=this.x.redSqr(),h=this.y.redSqr(),y=h.redSqr(),g=this.x.redAdd(h).redSqr().redISub(l).redISub(y);g=g.redIAdd(g);var v=l.redAdd(l).redIAdd(l),x=v.redSqr(),S=y.redIAdd(y);S=S.redIAdd(S),S=S.redIAdd(S),e=x.redISub(g).redISub(g),r=v.redMul(g.redISub(e)).redISub(S),n=this.y.redMul(this.z),n=n.redIAdd(n)}return this.curve.jpoint(e,r,n)};cs.prototype._threeDbl=function(){var e,r,n;if(this.zOne){var i=this.x.redSqr(),o=this.y.redSqr(),s=o.redSqr(),a=this.x.redAdd(o).redSqr().redISub(i).redISub(s);a=a.redIAdd(a);var d=i.redAdd(i).redIAdd(i).redIAdd(this.curve.a),u=d.redSqr().redISub(a).redISub(a);e=u;var c=s.redIAdd(s);c=c.redIAdd(c),c=c.redIAdd(c),r=d.redMul(a.redISub(u)).redISub(c),n=this.y.redAdd(this.y)}else{var l=this.z.redSqr(),h=this.y.redSqr(),y=this.x.redMul(h),g=this.x.redSub(l).redMul(this.x.redAdd(l));g=g.redAdd(g).redIAdd(g);var v=y.redIAdd(y);v=v.redIAdd(v);var x=v.redAdd(v);e=g.redSqr().redISub(x),n=this.y.redAdd(this.z).redSqr().redISub(h).redISub(l);var S=h.redSqr();S=S.redIAdd(S),S=S.redIAdd(S),S=S.redIAdd(S),r=g.redMul(v.redISub(e)).redISub(S)}return this.curve.jpoint(e,r,n)};cs.prototype._dbl=function(){var e=this.curve.a,r=this.x,n=this.y,i=this.z,o=i.redSqr().redSqr(),s=r.redSqr(),a=n.redSqr(),d=s.redAdd(s).redIAdd(s).redIAdd(e.redMul(o)),u=r.redAdd(r);u=u.redIAdd(u);var c=u.redMul(a),l=d.redSqr().redISub(c.redAdd(c)),h=c.redISub(l),y=a.redSqr();y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var g=d.redMul(h).redISub(y),v=n.redAdd(n).redMul(i);return this.curve.jpoint(l,g,v)};cs.prototype.trpl=function(){if(!this.curve.zeroA)return this.dbl().add(this);var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr(),i=r.redSqr(),o=e.redAdd(e).redIAdd(e),s=o.redSqr(),a=this.x.redAdd(r).redSqr().redISub(e).redISub(i);a=a.redIAdd(a),a=a.redAdd(a).redIAdd(a),a=a.redISub(s);var d=a.redSqr(),u=i.redIAdd(i);u=u.redIAdd(u),u=u.redIAdd(u),u=u.redIAdd(u);var c=o.redIAdd(a).redSqr().redISub(s).redISub(d).redISub(u),l=r.redMul(c);l=l.redIAdd(l),l=l.redIAdd(l);var h=this.x.redMul(d).redISub(l);h=h.redIAdd(h),h=h.redIAdd(h);var y=this.y.redMul(c.redMul(u.redISub(c)).redISub(a.redMul(d)));y=y.redIAdd(y),y=y.redIAdd(y),y=y.redIAdd(y);var g=this.z.redAdd(a).redSqr().redISub(n).redISub(d);return this.curve.jpoint(h,y,g)};cs.prototype.mul=function(e,r){return e=new Si(e,r),this.curve._wnafMul(this,e)};cs.prototype.eq=function(e){if(e.type==="affine")return this.eq(e.toJ());if(this===e)return!0;var r=this.z.redSqr(),n=e.z.redSqr();if(this.x.redMul(n).redISub(e.x.redMul(r)).cmpn(0)!==0)return!1;var i=r.redMul(this.z),o=n.redMul(e.z);return this.y.redMul(o).redISub(e.y.redMul(i)).cmpn(0)===0};cs.prototype.eqXToP=function(e){var r=this.z.redSqr(),n=e.toRed(this.curve.red).redMul(r);if(this.x.cmp(n)===0)return!0;for(var i=e.clone(),o=this.curve.redN.redMul(r);;){if(i.iadd(this.curve.n),i.cmp(this.curve.p)>=0)return!1;if(n.redIAdd(o),this.x.cmp(n)===0)return!0}};cs.prototype.inspect=function(){return this.isInfinity()?"<EC JPoint Infinity>":"<EC JPoint x: "+this.x.toString(16,2)+" y: "+this.y.toString(16,2)+" z: "+this.z.toString(16,2)+">"};cs.prototype.isInfinity=function(){return this.z.cmpn(0)===0}});var Lte=W((Lbt,qte)=>{"use strict";f();var h1=Do(),Kte=Vt(),EA=HE(),oRe=zc();function p1(t){EA.call(this,"mont",t),this.a=new h1(t.a,16).toRed(this.red),this.b=new h1(t.b,16).toRed(this.red),this.i4=new h1(4).toRed(this.red).redInvm(),this.two=new h1(2).toRed(this.red),this.a24=this.i4.redMul(this.a.redAdd(this.two))}Kte(p1,EA);qte.exports=p1;p1.prototype.validate=function(e){var r=e.normalize().x,n=r.redSqr(),i=n.redMul(r).redAdd(n.redMul(this.a)).redAdd(r),o=i.redSqrt();return o.redSqr().cmp(i)===0};function jo(t,e,r){EA.BasePoint.call(this,t,"projective"),e===null&&r===null?(this.x=this.curve.one,this.z=this.curve.zero):(this.x=new h1(e,16),this.z=new h1(r,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)))}Kte(jo,EA.BasePoint);p1.prototype.decodePoint=function(e,r){return this.point(oRe.toArray(e,r),1)};p1.prototype.point=function(e,r){return new jo(this,e,r)};p1.prototype.pointFromJSON=function(e){return jo.fromJSON(this,e)};jo.prototype.precompute=function(){};jo.prototype._encode=function(){return this.getX().toArray("be",this.curve.p.byteLength())};jo.fromJSON=function(e,r){return new jo(e,r[0],r[1]||e.one)};jo.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};jo.prototype.isInfinity=function(){return this.z.cmpn(0)===0};jo.prototype.dbl=function(){var e=this.x.redAdd(this.z),r=e.redSqr(),n=this.x.redSub(this.z),i=n.redSqr(),o=r.redSub(i),s=r.redMul(i),a=o.redMul(i.redAdd(this.curve.a24.redMul(o)));return this.curve.point(s,a)};jo.prototype.add=function(){throw new Error("Not supported on Montgomery curve")};jo.prototype.diffAdd=function(e,r){var n=this.x.redAdd(this.z),i=this.x.redSub(this.z),o=e.x.redAdd(e.z),s=e.x.redSub(e.z),a=s.redMul(n),d=o.redMul(i),u=r.z.redMul(a.redAdd(d).redSqr()),c=r.x.redMul(a.redISub(d).redSqr());return this.curve.point(u,c)};jo.prototype.mul=function(e){for(var r=e.clone(),n=this,i=this.curve.point(null,null),o=this,s=[];r.cmpn(0)!==0;r.iushrn(1))s.push(r.andln(1));for(var a=s.length-1;a>=0;a--)s[a]===0?(n=n.diffAdd(i,o),i=i.dbl()):(i=n.diffAdd(i,o),n=n.dbl());return i};jo.prototype.mulAdd=function(){throw new Error("Not supported on Montgomery curve")};jo.prototype.jumlAdd=function(){throw new Error("Not supported on Montgomery curve")};jo.prototype.eq=function(e){return this.getX().cmp(e.getX())===0};jo.prototype.normalize=function(){return this.x=this.x.redMul(this.z.redInvm()),this.z=this.curve.one,this};jo.prototype.getX=function(){return this.normalize(),this.x.fromRed()}});var Vte=W((zbt,zte)=>{"use strict";f();var sRe=zc(),Dh=Do(),Fte=Vt(),SA=HE(),aRe=sRe.assert;function Gl(t){this.twisted=(t.a|0)!==1,this.mOneA=this.twisted&&(t.a|0)===-1,this.extended=this.mOneA,SA.call(this,"edwards",t),this.a=new Dh(t.a,16).umod(this.red.m),this.a=this.a.toRed(this.red),this.c=new Dh(t.c,16).toRed(this.red),this.c2=this.c.redSqr(),this.d=new Dh(t.d,16).toRed(this.red),this.dd=this.d.redAdd(this.d),aRe(!this.twisted||this.c.fromRed().cmpn(1)===0),this.oneC=(t.c|0)===1}Fte(Gl,SA);zte.exports=Gl;Gl.prototype._mulA=function(e){return this.mOneA?e.redNeg():this.a.redMul(e)};Gl.prototype._mulC=function(e){return this.oneC?e:this.c.redMul(e)};Gl.prototype.jpoint=function(e,r,n,i){return this.point(e,r,n,i)};Gl.prototype.pointFromX=function(e,r){e=new Dh(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=this.c2.redSub(this.a.redMul(n)),o=this.one.redSub(this.c2.redMul(this.d).redMul(n)),s=i.redMul(o.redInvm()),a=s.redSqrt();if(a.redSqr().redSub(s).cmp(this.zero)!==0)throw new Error("invalid point");var d=a.fromRed().isOdd();return(r&&!d||!r&&d)&&(a=a.redNeg()),this.point(e,a)};Gl.prototype.pointFromY=function(e,r){e=new Dh(e,16),e.red||(e=e.toRed(this.red));var n=e.redSqr(),i=n.redSub(this.c2),o=n.redMul(this.d).redMul(this.c2).redSub(this.a),s=i.redMul(o.redInvm());if(s.cmp(this.zero)===0){if(r)throw new Error("invalid point");return this.point(this.zero,e)}var a=s.redSqrt();if(a.redSqr().redSub(s).cmp(this.zero)!==0)throw new Error("invalid point");return a.fromRed().isOdd()!==r&&(a=a.redNeg()),this.point(a,e)};Gl.prototype.validate=function(e){if(e.isInfinity())return!0;e.normalize();var r=e.x.redSqr(),n=e.y.redSqr(),i=r.redMul(this.a).redAdd(n),o=this.c2.redMul(this.one.redAdd(this.d.redMul(r).redMul(n)));return i.cmp(o)===0};function Nn(t,e,r,n,i){SA.BasePoint.call(this,t,"projective"),e===null&&r===null&&n===null?(this.x=this.curve.zero,this.y=this.curve.one,this.z=this.curve.one,this.t=this.curve.zero,this.zOne=!0):(this.x=new Dh(e,16),this.y=new Dh(r,16),this.z=n?new Dh(n,16):this.curve.one,this.t=i&&new Dh(i,16),this.x.red||(this.x=this.x.toRed(this.curve.red)),this.y.red||(this.y=this.y.toRed(this.curve.red)),this.z.red||(this.z=this.z.toRed(this.curve.red)),this.t&&!this.t.red&&(this.t=this.t.toRed(this.curve.red)),this.zOne=this.z===this.curve.one,this.curve.extended&&!this.t&&(this.t=this.x.redMul(this.y),this.zOne||(this.t=this.t.redMul(this.z.redInvm()))))}Fte(Nn,SA.BasePoint);Gl.prototype.pointFromJSON=function(e){return Nn.fromJSON(this,e)};Gl.prototype.point=function(e,r,n,i){return new Nn(this,e,r,n,i)};Nn.fromJSON=function(e,r){return new Nn(e,r[0],r[1],r[2])};Nn.prototype.inspect=function(){return this.isInfinity()?"<EC Point Infinity>":"<EC Point x: "+this.x.fromRed().toString(16,2)+" y: "+this.y.fromRed().toString(16,2)+" z: "+this.z.fromRed().toString(16,2)+">"};Nn.prototype.isInfinity=function(){return this.x.cmpn(0)===0&&(this.y.cmp(this.z)===0||this.zOne&&this.y.cmp(this.curve.c)===0)};Nn.prototype._extDbl=function(){var e=this.x.redSqr(),r=this.y.redSqr(),n=this.z.redSqr();n=n.redIAdd(n);var i=this.curve._mulA(e),o=this.x.redAdd(this.y).redSqr().redISub(e).redISub(r),s=i.redAdd(r),a=s.redSub(n),d=i.redSub(r),u=o.redMul(a),c=s.redMul(d),l=o.redMul(d),h=a.redMul(s);return this.curve.point(u,c,h,l)};Nn.prototype._projDbl=function(){var e=this.x.redAdd(this.y).redSqr(),r=this.x.redSqr(),n=this.y.redSqr(),i,o,s,a,d,u;if(this.curve.twisted){a=this.curve._mulA(r);var c=a.redAdd(n);this.zOne?(i=e.redSub(r).redSub(n).redMul(c.redSub(this.curve.two)),o=c.redMul(a.redSub(n)),s=c.redSqr().redSub(c).redSub(c)):(d=this.z.redSqr(),u=c.redSub(d).redISub(d),i=e.redSub(r).redISub(n).redMul(u),o=c.redMul(a.redSub(n)),s=c.redMul(u))}else a=r.redAdd(n),d=this.curve._mulC(this.z).redSqr(),u=a.redSub(d).redSub(d),i=this.curve._mulC(e.redISub(a)).redMul(u),o=this.curve._mulC(a).redMul(r.redISub(n)),s=a.redMul(u);return this.curve.point(i,o,s)};Nn.prototype.dbl=function(){return this.isInfinity()?this:this.curve.extended?this._extDbl():this._projDbl()};Nn.prototype._extAdd=function(e){var r=this.y.redSub(this.x).redMul(e.y.redSub(e.x)),n=this.y.redAdd(this.x).redMul(e.y.redAdd(e.x)),i=this.t.redMul(this.curve.dd).redMul(e.t),o=this.z.redMul(e.z.redAdd(e.z)),s=n.redSub(r),a=o.redSub(i),d=o.redAdd(i),u=n.redAdd(r),c=s.redMul(a),l=d.redMul(u),h=s.redMul(u),y=a.redMul(d);return this.curve.point(c,l,y,h)};Nn.prototype._projAdd=function(e){var r=this.z.redMul(e.z),n=r.redSqr(),i=this.x.redMul(e.x),o=this.y.redMul(e.y),s=this.curve.d.redMul(i).redMul(o),a=n.redSub(s),d=n.redAdd(s),u=this.x.redAdd(this.y).redMul(e.x.redAdd(e.y)).redISub(i).redISub(o),c=r.redMul(a).redMul(u),l,h;return this.curve.twisted?(l=r.redMul(d).redMul(o.redSub(this.curve._mulA(i))),h=a.redMul(d)):(l=r.redMul(d).redMul(o.redSub(i)),h=this.curve._mulC(a).redMul(d)),this.curve.point(c,l,h)};Nn.prototype.add=function(e){return this.isInfinity()?e:e.isInfinity()?this:this.curve.extended?this._extAdd(e):this._projAdd(e)};Nn.prototype.mul=function(e){return this._hasDoubles(e)?this.curve._fixedNafMul(this,e):this.curve._wnafMul(this,e)};Nn.prototype.mulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!1)};Nn.prototype.jmulAdd=function(e,r,n){return this.curve._wnafMulAdd(1,[this,r],[e,n],2,!0)};Nn.prototype.normalize=function(){if(this.zOne)return this;var e=this.z.redInvm();return this.x=this.x.redMul(e),this.y=this.y.redMul(e),this.t&&(this.t=this.t.redMul(e)),this.z=this.curve.one,this.zOne=!0,this};Nn.prototype.neg=function(){return this.curve.point(this.x.redNeg(),this.y,this.z,this.t&&this.t.redNeg())};Nn.prototype.getX=function(){return this.normalize(),this.x.fromRed()};Nn.prototype.getY=function(){return this.normalize(),this.y.fromRed()};Nn.prototype.eq=function(e){return this===e||this.getX().cmp(e.getX())===0&&this.getY().cmp(e.getY())===0};Nn.prototype.eqXToP=function(e){var r=e.toRed(this.curve.red).redMul(this.z);if(this.x.cmp(r)===0)return!0;for(var n=e.clone(),i=this.curve.redN.redMul(this.z);;){if(n.iadd(this.curve.n),n.cmp(this.curve.p)>=0)return!1;if(r.redIAdd(i),this.x.cmp(r)===0)return!0}};Nn.prototype.toP=Nn.prototype.normalize;Nn.prototype.mixedAdd=Nn.prototype.add});var MD=W(Hte=>{"use strict";f();var TA=Hte;TA.base=HE();TA.short=Ute();TA.mont=Lte();TA.edwards=Vte()});var Nu=W(Rn=>{"use strict";f();var cRe=Fc(),dRe=Vt();Rn.inherits=dRe;function uRe(t,e){return(t.charCodeAt(e)&64512)!==55296||e<0||e+1>=t.length?!1:(t.charCodeAt(e+1)&64512)===56320}function lRe(t,e){if(Array.isArray(t))return t.slice();if(!t)return[];var r=[];if(typeof t=="string")if(e){if(e==="hex")for(t=t.replace(/[^a-z0-9]+/ig,""),t.length%2!==0&&(t="0"+t),i=0;i<t.length;i+=2)r.push(parseInt(t[i]+t[i+1],16))}else for(var n=0,i=0;i<t.length;i++){var o=t.charCodeAt(i);o<128?r[n++]=o:o<2048?(r[n++]=o>>6|192,r[n++]=o&63|128):uRe(t,i)?(o=65536+((o&1023)<<10)+(t.charCodeAt(++i)&1023),r[n++]=o>>18|240,r[n++]=o>>12&63|128,r[n++]=o>>6&63|128,r[n++]=o&63|128):(r[n++]=o>>12|224,r[n++]=o>>6&63|128,r[n++]=o&63|128)}else for(i=0;i<t.length;i++)r[i]=t[i]|0;return r}Rn.toArray=lRe;function fRe(t){for(var e="",r=0;r<t.length;r++)e+=Gte(t[r].toString(16));return e}Rn.toHex=fRe;function Wte(t){var e=t>>>24|t>>>8&65280|t<<8&16711680|(t&255)<<24;return e>>>0}Rn.htonl=Wte;function hRe(t,e){for(var r="",n=0;n<t.length;n++){var i=t[n];e==="little"&&(i=Wte(i)),r+=Jte(i.toString(16))}return r}Rn.toHex32=hRe;function Gte(t){return t.length===1?"0"+t:t}Rn.zero2=Gte;function Jte(t){return t.length===7?"0"+t:t.length===6?"00"+t:t.length===5?"000"+t:t.length===4?"0000"+t:t.length===3?"00000"+t:t.length===2?"000000"+t:t.length===1?"0000000"+t:t}Rn.zero8=Jte;function pRe(t,e,r,n){var i=r-e;cRe(i%4===0);for(var o=new Array(i/4),s=0,a=e;s<o.length;s++,a+=4){var d;n==="big"?d=t[a]<<24|t[a+1]<<16|t[a+2]<<8|t[a+3]:d=t[a+3]<<24|t[a+2]<<16|t[a+1]<<8|t[a],o[s]=d>>>0}return o}Rn.join32=pRe;function yRe(t,e){for(var r=new Array(t.length*4),n=0,i=0;n<t.length;n++,i+=4){var o=t[n];e==="big"?(r[i]=o>>>24,r[i+1]=o>>>16&255,r[i+2]=o>>>8&255,r[i+3]=o&255):(r[i+3]=o>>>24,r[i+2]=o>>>16&255,r[i+1]=o>>>8&255,r[i]=o&255)}return r}Rn.split32=yRe;function mRe(t,e){return t>>>e|t<<32-e}Rn.rotr32=mRe;function gRe(t,e){return t<<e|t>>>32-e}Rn.rotl32=gRe;function vRe(t,e){return t+e>>>0}Rn.sum32=vRe;function bRe(t,e,r){return t+e+r>>>0}Rn.sum32_3=bRe;function wRe(t,e,r,n){return t+e+r+n>>>0}Rn.sum32_4=wRe;function _Re(t,e,r,n,i){return t+e+r+n+i>>>0}Rn.sum32_5=_Re;function xRe(t,e,r,n){var i=t[e],o=t[e+1],s=n+o>>>0,a=(s<n?1:0)+r+i;t[e]=a>>>0,t[e+1]=s}Rn.sum64=xRe;function ERe(t,e,r,n){var i=e+n>>>0,o=(i<e?1:0)+t+r;return o>>>0}Rn.sum64_hi=ERe;function SRe(t,e,r,n){var i=e+n;return i>>>0}Rn.sum64_lo=SRe;function TRe(t,e,r,n,i,o,s,a){var d=0,u=e;u=u+n>>>0,d+=u<e?1:0,u=u+o>>>0,d+=u<o?1:0,u=u+a>>>0,d+=u<a?1:0;var c=t+r+i+s+d;return c>>>0}Rn.sum64_4_hi=TRe;function ARe(t,e,r,n,i,o,s,a){var d=e+n+o+a;return d>>>0}Rn.sum64_4_lo=ARe;function kRe(t,e,r,n,i,o,s,a,d,u){var c=0,l=e;l=l+n>>>0,c+=l<e?1:0,l=l+o>>>0,c+=l<o?1:0,l=l+a>>>0,c+=l<a?1:0,l=l+u>>>0,c+=l<u?1:0;var h=t+r+i+s+d+c;return h>>>0}Rn.sum64_5_hi=kRe;function PRe(t,e,r,n,i,o,s,a,d,u){var c=e+n+o+a+u;return c>>>0}Rn.sum64_5_lo=PRe;function IRe(t,e,r){var n=e<<32-r|t>>>r;return n>>>0}Rn.rotr64_hi=IRe;function RRe(t,e,r){var n=t<<32-r|e>>>r;return n>>>0}Rn.rotr64_lo=RRe;function BRe(t,e,r){return t>>>r}Rn.shr64_hi=BRe;function ORe(t,e,r){var n=t<<32-r|e>>>r;return n>>>0}Rn.shr64_lo=ORe});var y1=W(Zte=>{"use strict";f();var Yte=Nu(),MRe=Fc();function AA(){this.pending=null,this.pendingTotal=0,this.blockSize=this.constructor.blockSize,this.outSize=this.constructor.outSize,this.hmacStrength=this.constructor.hmacStrength,this.padLength=this.constructor.padLength/8,this.endian="big",this._delta8=this.blockSize/8,this._delta32=this.blockSize/32}Zte.BlockHash=AA;AA.prototype.update=function(e,r){if(e=Yte.toArray(e,r),this.pending?this.pending=this.pending.concat(e):this.pending=e,this.pendingTotal+=e.length,this.pending.length>=this._delta8){e=this.pending;var n=e.length%this._delta8;this.pending=e.slice(e.length-n,e.length),this.pending.length===0&&(this.pending=null),e=Yte.join32(e,0,e.length-n,this.endian);for(var i=0;i<e.length;i+=this._delta32)this._update(e,i,i+this._delta32)}return this};AA.prototype.digest=function(e){return this.update(this._pad()),MRe(this.pending===null),this._digest(e)};AA.prototype._pad=function(){var e=this.pendingTotal,r=this._delta8,n=r-(e+this.padLength)%r,i=new Array(n+this.padLength);i[0]=128;for(var o=1;o<n;o++)i[o]=0;if(e<<=3,this.endian==="big"){for(var s=8;s<this.padLength;s++)i[o++]=0;i[o++]=0,i[o++]=0,i[o++]=0,i[o++]=0,i[o++]=e>>>24&255,i[o++]=e>>>16&255,i[o++]=e>>>8&255,i[o++]=e&255}else for(i[o++]=e&255,i[o++]=e>>>8&255,i[o++]=e>>>16&255,i[o++]=e>>>24&255,i[o++]=0,i[o++]=0,i[o++]=0,i[o++]=0,s=8;s<this.padLength;s++)i[o++]=0;return i}});var DD=W(Ch=>{"use strict";f();var DRe=Nu(),Jl=DRe.rotr32;function CRe(t,e,r,n){if(t===0)return Xte(e,r,n);if(t===1||t===3)return ere(e,r,n);if(t===2)return Qte(e,r,n)}Ch.ft_1=CRe;function Xte(t,e,r){return t&e^~t&r}Ch.ch32=Xte;function Qte(t,e,r){return t&e^t&r^e&r}Ch.maj32=Qte;function ere(t,e,r){return t^e^r}Ch.p32=ere;function jRe(t){return Jl(t,2)^Jl(t,13)^Jl(t,22)}Ch.s0_256=jRe;function $Re(t){return Jl(t,6)^Jl(t,11)^Jl(t,25)}Ch.s1_256=$Re;function NRe(t){return Jl(t,7)^Jl(t,18)^t>>>3}Ch.g0_256=NRe;function URe(t){return Jl(t,17)^Jl(t,19)^t>>>10}Ch.g1_256=URe});var nre=W((ewt,rre)=>{"use strict";f();var m1=Nu(),KRe=y1(),qRe=DD(),CD=m1.rotl32,WE=m1.sum32,LRe=m1.sum32_5,FRe=qRe.ft_1,tre=KRe.BlockHash,zRe=[1518500249,1859775393,2400959708,3395469782];function Yl(){if(!(this instanceof Yl))return new Yl;tre.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.W=new Array(80)}m1.inherits(Yl,tre);rre.exports=Yl;Yl.blockSize=512;Yl.outSize=160;Yl.hmacStrength=80;Yl.padLength=64;Yl.prototype._update=function(e,r){for(var n=this.W,i=0;i<16;i++)n[i]=e[r+i];for(;i<n.length;i++)n[i]=CD(n[i-3]^n[i-8]^n[i-14]^n[i-16],1);var o=this.h[0],s=this.h[1],a=this.h[2],d=this.h[3],u=this.h[4];for(i=0;i<n.length;i++){var c=~~(i/20),l=LRe(CD(o,5),FRe(c,s,a,d),u,n[i],zRe[c]);u=d,d=a,a=CD(s,30),s=o,o=l}this.h[0]=WE(this.h[0],o),this.h[1]=WE(this.h[1],s),this.h[2]=WE(this.h[2],a),this.h[3]=WE(this.h[3],d),this.h[4]=WE(this.h[4],u)};Yl.prototype._digest=function(e){return e==="hex"?m1.toHex32(this.h,"big"):m1.split32(this.h,"big")}});var jD=W((rwt,ore)=>{"use strict";f();var g1=Nu(),VRe=y1(),v1=DD(),HRe=Fc(),Uu=g1.sum32,WRe=g1.sum32_4,GRe=g1.sum32_5,JRe=v1.ch32,YRe=v1.maj32,ZRe=v1.s0_256,XRe=v1.s1_256,QRe=v1.g0_256,eBe=v1.g1_256,ire=VRe.BlockHash,tBe=[1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298];function Zl(){if(!(this instanceof Zl))return new Zl;ire.call(this),this.h=[1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225],this.k=tBe,this.W=new Array(64)}g1.inherits(Zl,ire);ore.exports=Zl;Zl.blockSize=512;Zl.outSize=256;Zl.hmacStrength=192;Zl.padLength=64;Zl.prototype._update=function(e,r){for(var n=this.W,i=0;i<16;i++)n[i]=e[r+i];for(;i<n.length;i++)n[i]=WRe(eBe(n[i-2]),n[i-7],QRe(n[i-15]),n[i-16]);var o=this.h[0],s=this.h[1],a=this.h[2],d=this.h[3],u=this.h[4],c=this.h[5],l=this.h[6],h=this.h[7];for(HRe(this.k.length===n.length),i=0;i<n.length;i++){var y=GRe(h,XRe(u),JRe(u,c,l),this.k[i],n[i]),g=Uu(ZRe(o),YRe(o,s,a));h=l,l=c,c=u,u=Uu(d,y),d=a,a=s,s=o,o=Uu(y,g)}this.h[0]=Uu(this.h[0],o),this.h[1]=Uu(this.h[1],s),this.h[2]=Uu(this.h[2],a),this.h[3]=Uu(this.h[3],d),this.h[4]=Uu(this.h[4],u),this.h[5]=Uu(this.h[5],c),this.h[6]=Uu(this.h[6],l),this.h[7]=Uu(this.h[7],h)};Zl.prototype._digest=function(e){return e==="hex"?g1.toHex32(this.h,"big"):g1.split32(this.h,"big")}});var cre=W((iwt,are)=>{"use strict";f();var $D=Nu(),sre=jD();function jh(){if(!(this instanceof jh))return new jh;sre.call(this),this.h=[3238371032,914150663,812702999,4144912697,4290775857,1750603025,1694076839,3204075428]}$D.inherits(jh,sre);are.exports=jh;jh.blockSize=512;jh.outSize=224;jh.hmacStrength=192;jh.padLength=64;jh.prototype._digest=function(e){return e==="hex"?$D.toHex32(this.h.slice(0,7),"big"):$D.split32(this.h.slice(0,7),"big")}});var KD=W((swt,fre)=>{"use strict";f();var sc=Nu(),rBe=y1(),nBe=Fc(),Xl=sc.rotr64_hi,Ql=sc.rotr64_lo,dre=sc.shr64_hi,ure=sc.shr64_lo,Ky=sc.sum64,ND=sc.sum64_hi,UD=sc.sum64_lo,iBe=sc.sum64_4_hi,oBe=sc.sum64_4_lo,sBe=sc.sum64_5_hi,aBe=sc.sum64_5_lo,lre=rBe.BlockHash,cBe=[1116352408,3609767458,1899447441,602891725,3049323471,3964484399,3921009573,2173295548,961987163,4081628472,1508970993,3053834265,2453635748,2937671579,2870763221,3664609560,3624381080,2734883394,310598401,1164996542,607225278,1323610764,1426881987,3590304994,1925078388,4068182383,2162078206,991336113,2614888103,633803317,3248222580,3479774868,3835390401,2666613458,4022224774,944711139,264347078,2341262773,604807628,2007800933,770255983,1495990901,1249150122,1856431235,1555081692,3175218132,1996064986,2198950837,2554220882,3999719339,2821834349,766784016,2952996808,2566594879,3210313671,3203337956,3336571891,1034457026,3584528711,2466948901,113926993,3758326383,338241895,168717936,666307205,1188179964,773529912,1546045734,1294757372,1522805485,1396182291,2643833823,1695183700,2343527390,1986661051,1014477480,2177026350,1206759142,2456956037,344077627,2730485921,1290863460,2820302411,3158454273,3259730800,3505952657,3345764771,106217008,3516065817,3606008344,3600352804,1432725776,4094571909,1467031594,275423344,851169720,430227734,3100823752,506948616,1363258195,659060556,3750685593,883997877,3785050280,958139571,3318307427,1322822218,3812723403,1537002063,2003034995,1747873779,3602036899,1955562222,1575990012,2024104815,1125592928,2227730452,2716904306,2361852424,442776044,2428436474,593698344,2756734187,3733110249,3204031479,2999351573,3329325298,3815920427,3391569614,3928383900,3515267271,566280711,3940187606,3454069534,4118630271,4000239992,116418474,1914138554,174292421,2731055270,289380356,3203993006,460393269,320620315,685471733,587496836,852142971,1086792851,1017036298,365543100,1126000580,2618297676,1288033470,3409855158,1501505948,4234509866,1607167915,987167468,1816402316,1246189591];function Ku(){if(!(this instanceof Ku))return new Ku;lre.call(this),this.h=[1779033703,4089235720,3144134277,2227873595,1013904242,4271175723,2773480762,1595750129,1359893119,2917565137,2600822924,725511199,528734635,4215389547,1541459225,327033209],this.k=cBe,this.W=new Array(160)}sc.inherits(Ku,lre);fre.exports=Ku;Ku.blockSize=1024;Ku.outSize=512;Ku.hmacStrength=192;Ku.padLength=128;Ku.prototype._prepareBlock=function(e,r){for(var n=this.W,i=0;i<32;i++)n[i]=e[r+i];for(;i<n.length;i+=2){var o=bBe(n[i-4],n[i-3]),s=wBe(n[i-4],n[i-3]),a=n[i-14],d=n[i-13],u=gBe(n[i-30],n[i-29]),c=vBe(n[i-30],n[i-29]),l=n[i-32],h=n[i-31];n[i]=iBe(o,s,a,d,u,c,l,h),n[i+1]=oBe(o,s,a,d,u,c,l,h)}};Ku.prototype._update=function(e,r){this._prepareBlock(e,r);var n=this.W,i=this.h[0],o=this.h[1],s=this.h[2],a=this.h[3],d=this.h[4],u=this.h[5],c=this.h[6],l=this.h[7],h=this.h[8],y=this.h[9],g=this.h[10],v=this.h[11],x=this.h[12],S=this.h[13],A=this.h[14],T=this.h[15];nBe(this.k.length===n.length);for(var $=0;$<n.length;$+=2){var j=A,K=T,F=yBe(h,y),L=mBe(h,y),V=dBe(h,y,g,v,x,S),q=uBe(h,y,g,v,x,S),k=this.k[$],P=this.k[$+1],B=n[$],p=n[$+1],m=sBe(j,K,F,L,V,q,k,P,B,p),w=aBe(j,K,F,L,V,q,k,P,B,p);j=hBe(i,o),K=pBe(i,o),F=lBe(i,o,s,a,d,u),L=fBe(i,o,s,a,d,u);var E=ND(j,K,F,L),_=UD(j,K,F,L);A=x,T=S,x=g,S=v,g=h,v=y,h=ND(c,l,m,w),y=UD(l,l,m,w),c=d,l=u,d=s,u=a,s=i,a=o,i=ND(m,w,E,_),o=UD(m,w,E,_)}Ky(this.h,0,i,o),Ky(this.h,2,s,a),Ky(this.h,4,d,u),Ky(this.h,6,c,l),Ky(this.h,8,h,y),Ky(this.h,10,g,v),Ky(this.h,12,x,S),Ky(this.h,14,A,T)};Ku.prototype._digest=function(e){return e==="hex"?sc.toHex32(this.h,"big"):sc.split32(this.h,"big")};function dBe(t,e,r,n,i){var o=t&r^~t&i;return o<0&&(o+=4294967296),o}function uBe(t,e,r,n,i,o){var s=e&n^~e&o;return s<0&&(s+=4294967296),s}function lBe(t,e,r,n,i){var o=t&r^t&i^r&i;return o<0&&(o+=4294967296),o}function fBe(t,e,r,n,i,o){var s=e&n^e&o^n&o;return s<0&&(s+=4294967296),s}function hBe(t,e){var r=Xl(t,e,28),n=Xl(e,t,2),i=Xl(e,t,7),o=r^n^i;return o<0&&(o+=4294967296),o}function pBe(t,e){var r=Ql(t,e,28),n=Ql(e,t,2),i=Ql(e,t,7),o=r^n^i;return o<0&&(o+=4294967296),o}function yBe(t,e){var r=Xl(t,e,14),n=Xl(t,e,18),i=Xl(e,t,9),o=r^n^i;return o<0&&(o+=4294967296),o}function mBe(t,e){var r=Ql(t,e,14),n=Ql(t,e,18),i=Ql(e,t,9),o=r^n^i;return o<0&&(o+=4294967296),o}function gBe(t,e){var r=Xl(t,e,1),n=Xl(t,e,8),i=dre(t,e,7),o=r^n^i;return o<0&&(o+=4294967296),o}function vBe(t,e){var r=Ql(t,e,1),n=Ql(t,e,8),i=ure(t,e,7),o=r^n^i;return o<0&&(o+=4294967296),o}function bBe(t,e){var r=Xl(t,e,19),n=Xl(e,t,29),i=dre(t,e,6),o=r^n^i;return o<0&&(o+=4294967296),o}function wBe(t,e){var r=Ql(t,e,19),n=Ql(e,t,29),i=ure(t,e,6),o=r^n^i;return o<0&&(o+=4294967296),o}});var yre=W((cwt,pre)=>{"use strict";f();var qD=Nu(),hre=KD();function $h(){if(!(this instanceof $h))return new $h;hre.call(this),this.h=[3418070365,3238371032,1654270250,914150663,2438529370,812702999,355462360,4144912697,1731405415,4290775857,2394180231,1750603025,3675008525,1694076839,1203062813,3204075428]}qD.inherits($h,hre);pre.exports=$h;$h.blockSize=1024;$h.outSize=384;$h.hmacStrength=192;$h.padLength=128;$h.prototype._digest=function(e){return e==="hex"?qD.toHex32(this.h.slice(0,12),"big"):qD.split32(this.h.slice(0,12),"big")}});var mre=W(b1=>{"use strict";f();b1.sha1=nre();b1.sha224=cre();b1.sha256=jD();b1.sha384=yre();b1.sha512=KD()});var xre=W(_re=>{"use strict";f();var Ng=Nu(),_Be=y1(),kA=Ng.rotl32,gre=Ng.sum32,GE=Ng.sum32_3,vre=Ng.sum32_4,wre=_Be.BlockHash;function ef(){if(!(this instanceof ef))return new ef;wre.call(this),this.h=[1732584193,4023233417,2562383102,271733878,3285377520],this.endian="little"}Ng.inherits(ef,wre);_re.ripemd160=ef;ef.blockSize=512;ef.outSize=160;ef.hmacStrength=192;ef.padLength=64;ef.prototype._update=function(e,r){for(var n=this.h[0],i=this.h[1],o=this.h[2],s=this.h[3],a=this.h[4],d=n,u=i,c=o,l=s,h=a,y=0;y<80;y++){var g=gre(kA(vre(n,bre(y,i,o,s),e[SBe[y]+r],xBe(y)),ABe[y]),a);n=a,a=s,s=kA(o,10),o=i,i=g,g=gre(kA(vre(d,bre(79-y,u,c,l),e[TBe[y]+r],EBe(y)),kBe[y]),h),d=h,h=l,l=kA(c,10),c=u,u=g}g=GE(this.h[1],o,l),this.h[1]=GE(this.h[2],s,h),this.h[2]=GE(this.h[3],a,d),this.h[3]=GE(this.h[4],n,u),this.h[4]=GE(this.h[0],i,c),this.h[0]=g};ef.prototype._digest=function(e){return e==="hex"?Ng.toHex32(this.h,"little"):Ng.split32(this.h,"little")};function bre(t,e,r,n){return t<=15?e^r^n:t<=31?e&r|~e&n:t<=47?(e|~r)^n:t<=63?e&n|r&~n:e^(r|~n)}function xBe(t){return t<=15?0:t<=31?1518500249:t<=47?1859775393:t<=63?2400959708:2840853838}function EBe(t){return t<=15?1352829926:t<=31?1548603684:t<=47?1836072691:t<=63?2053994217:0}var SBe=[0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8,3,10,14,4,9,15,8,1,2,7,0,6,13,11,5,12,1,9,11,10,0,8,12,4,13,3,7,15,14,5,6,2,4,0,5,9,7,12,2,10,14,1,3,8,11,6,15,13],TBe=[5,14,7,0,9,2,11,4,13,6,15,8,1,10,3,12,6,11,3,7,0,13,5,10,14,15,8,12,4,9,1,2,15,5,1,3,7,14,6,9,11,8,12,2,10,0,4,13,8,6,4,1,3,11,15,0,5,12,2,13,9,7,10,14,12,15,10,4,1,5,8,7,6,2,13,14,0,3,9,11],ABe=[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8,7,6,8,13,11,9,7,15,7,12,15,9,11,7,13,12,11,13,6,7,14,9,13,15,14,8,13,6,5,12,7,5,11,12,14,15,14,15,9,8,9,14,5,6,8,6,5,12,9,15,5,11,6,8,13,12,5,12,13,14,11,8,5,6],kBe=[8,9,9,11,13,15,15,5,7,7,8,11,14,14,12,6,9,13,15,7,12,8,9,11,7,7,12,7,6,15,13,11,9,7,15,11,8,6,6,14,12,13,5,14,13,13,7,5,15,5,8,11,14,14,6,14,6,9,12,9,12,5,15,8,8,5,12,9,12,5,14,6,8,13,6,5,15,13,11,11]});var Sre=W((pwt,Ere)=>{"use strict";f();var PBe=Nu(),IBe=Fc();function w1(t,e,r){if(!(this instanceof w1))return new w1(t,e,r);this.Hash=t,this.blockSize=t.blockSize/8,this.outSize=t.outSize/8,this.inner=null,this.outer=null,this._init(PBe.toArray(e,r))}Ere.exports=w1;w1.prototype._init=function(e){e.length>this.blockSize&&(e=new this.Hash().update(e).digest()),IBe(e.length<=this.blockSize);for(var r=e.length;r<this.blockSize;r++)e.push(0);for(r=0;r<e.length;r++)e[r]^=54;for(this.inner=new this.Hash().update(e),r=0;r<e.length;r++)e[r]^=106;this.outer=new this.Hash().update(e)};w1.prototype.update=function(e,r){return this.inner.update(e,r),this};w1.prototype.digest=function(e){return this.outer.update(this.inner.digest()),this.outer.digest(e)}});var PA=W(Tre=>{f();var ds=Tre;ds.utils=Nu();ds.common=y1();ds.sha=mre();ds.ripemd=xre();ds.hmac=Sre();ds.sha1=ds.sha.sha1;ds.sha256=ds.sha.sha256;ds.sha224=ds.sha.sha224;ds.sha384=ds.sha.sha384;ds.sha512=ds.sha.sha512;ds.ripemd160=ds.ripemd.ripemd160});var kre=W((vwt,Are)=>{f();Are.exports={doubles:{step:4,points:[["e60fce93b59e9ec53011aabc21c23e97b2a31369b87a5ae9c44ee89e2a6dec0a","f7e3507399e595929db99f34f57937101296891e44d23f0be1f32cce69616821"],["8282263212c609d9ea2a6e3e172de238d8c39cabd5ac1ca10646e23fd5f51508","11f8a8098557dfe45e8256e830b60ace62d613ac2f7b17bed31b6eaff6e26caf"],["175e159f728b865a72f99cc6c6fc846de0b93833fd2222ed73fce5b551e5b739","d3506e0d9e3c79eba4ef97a51ff71f5eacb5955add24345c6efa6ffee9fed695"],["363d90d447b00c9c99ceac05b6262ee053441c7e55552ffe526bad8f83ff4640","4e273adfc732221953b445397f3363145b9a89008199ecb62003c7f3bee9de9"],["8b4b5f165df3c2be8c6244b5b745638843e4a781a15bcd1b69f79a55dffdf80c","4aad0a6f68d308b4b3fbd7813ab0da04f9e336546162ee56b3eff0c65fd4fd36"],["723cbaa6e5db996d6bf771c00bd548c7b700dbffa6c0e77bcb6115925232fcda","96e867b5595cc498a921137488824d6e2660a0653779494801dc069d9eb39f5f"],["eebfa4d493bebf98ba5feec812c2d3b50947961237a919839a533eca0e7dd7fa","5d9a8ca3970ef0f269ee7edaf178089d9ae4cdc3a711f712ddfd4fdae1de8999"],["100f44da696e71672791d0a09b7bde459f1215a29b3c03bfefd7835b39a48db0","cdd9e13192a00b772ec8f3300c090666b7ff4a18ff5195ac0fbd5cd62bc65a09"],["e1031be262c7ed1b1dc9227a4a04c017a77f8d4464f3b3852c8acde6e534fd2d","9d7061928940405e6bb6a4176597535af292dd419e1ced79a44f18f29456a00d"],["feea6cae46d55b530ac2839f143bd7ec5cf8b266a41d6af52d5e688d9094696d","e57c6b6c97dce1bab06e4e12bf3ecd5c981c8957cc41442d3155debf18090088"],["da67a91d91049cdcb367be4be6ffca3cfeed657d808583de33fa978bc1ec6cb1","9bacaa35481642bc41f463f7ec9780e5dec7adc508f740a17e9ea8e27a68be1d"],["53904faa0b334cdda6e000935ef22151ec08d0f7bb11069f57545ccc1a37b7c0","5bc087d0bc80106d88c9eccac20d3c1c13999981e14434699dcb096b022771c8"],["8e7bcd0bd35983a7719cca7764ca906779b53a043a9b8bcaeff959f43ad86047","10b7770b2a3da4b3940310420ca9514579e88e2e47fd68b3ea10047e8460372a"],["385eed34c1cdff21e6d0818689b81bde71a7f4f18397e6690a841e1599c43862","283bebc3e8ea23f56701de19e9ebf4576b304eec2086dc8cc0458fe5542e5453"],["6f9d9b803ecf191637c73a4413dfa180fddf84a5947fbc9c606ed86c3fac3a7","7c80c68e603059ba69b8e2a30e45c4d47ea4dd2f5c281002d86890603a842160"],["3322d401243c4e2582a2147c104d6ecbf774d163db0f5e5313b7e0e742d0e6bd","56e70797e9664ef5bfb019bc4ddaf9b72805f63ea2873af624f3a2e96c28b2a0"],["85672c7d2de0b7da2bd1770d89665868741b3f9af7643397721d74d28134ab83","7c481b9b5b43b2eb6374049bfa62c2e5e77f17fcc5298f44c8e3094f790313a6"],["948bf809b1988a46b06c9f1919413b10f9226c60f668832ffd959af60c82a0a","53a562856dcb6646dc6b74c5d1c3418c6d4dff08c97cd2bed4cb7f88d8c8e589"],["6260ce7f461801c34f067ce0f02873a8f1b0e44dfc69752accecd819f38fd8e8","bc2da82b6fa5b571a7f09049776a1ef7ecd292238051c198c1a84e95b2b4ae17"],["e5037de0afc1d8d43d8348414bbf4103043ec8f575bfdc432953cc8d2037fa2d","4571534baa94d3b5f9f98d09fb990bddbd5f5b03ec481f10e0e5dc841d755bda"],["e06372b0f4a207adf5ea905e8f1771b4e7e8dbd1c6a6c5b725866a0ae4fce725","7a908974bce18cfe12a27bb2ad5a488cd7484a7787104870b27034f94eee31dd"],["213c7a715cd5d45358d0bbf9dc0ce02204b10bdde2a3f58540ad6908d0559754","4b6dad0b5ae462507013ad06245ba190bb4850f5f36a7eeddff2c27534b458f2"],["4e7c272a7af4b34e8dbb9352a5419a87e2838c70adc62cddf0cc3a3b08fbd53c","17749c766c9d0b18e16fd09f6def681b530b9614bff7dd33e0b3941817dcaae6"],["fea74e3dbe778b1b10f238ad61686aa5c76e3db2be43057632427e2840fb27b6","6e0568db9b0b13297cf674deccb6af93126b596b973f7b77701d3db7f23cb96f"],["76e64113f677cf0e10a2570d599968d31544e179b760432952c02a4417bdde39","c90ddf8dee4e95cf577066d70681f0d35e2a33d2b56d2032b4b1752d1901ac01"],["c738c56b03b2abe1e8281baa743f8f9a8f7cc643df26cbee3ab150242bcbb891","893fb578951ad2537f718f2eacbfbbbb82314eef7880cfe917e735d9699a84c3"],["d895626548b65b81e264c7637c972877d1d72e5f3a925014372e9f6588f6c14b","febfaa38f2bc7eae728ec60818c340eb03428d632bb067e179363ed75d7d991f"],["b8da94032a957518eb0f6433571e8761ceffc73693e84edd49150a564f676e03","2804dfa44805a1e4d7c99cc9762808b092cc584d95ff3b511488e4e74efdf6e7"],["e80fea14441fb33a7d8adab9475d7fab2019effb5156a792f1a11778e3c0df5d","eed1de7f638e00771e89768ca3ca94472d155e80af322ea9fcb4291b6ac9ec78"],["a301697bdfcd704313ba48e51d567543f2a182031efd6915ddc07bbcc4e16070","7370f91cfb67e4f5081809fa25d40f9b1735dbf7c0a11a130c0d1a041e177ea1"],["90ad85b389d6b936463f9d0512678de208cc330b11307fffab7ac63e3fb04ed4","e507a3620a38261affdcbd9427222b839aefabe1582894d991d4d48cb6ef150"],["8f68b9d2f63b5f339239c1ad981f162ee88c5678723ea3351b7b444c9ec4c0da","662a9f2dba063986de1d90c2b6be215dbbea2cfe95510bfdf23cbf79501fff82"],["e4f3fb0176af85d65ff99ff9198c36091f48e86503681e3e6686fd5053231e11","1e63633ad0ef4f1c1661a6d0ea02b7286cc7e74ec951d1c9822c38576feb73bc"],["8c00fa9b18ebf331eb961537a45a4266c7034f2f0d4e1d0716fb6eae20eae29e","efa47267fea521a1a9dc343a3736c974c2fadafa81e36c54e7d2a4c66702414b"],["e7a26ce69dd4829f3e10cec0a9e98ed3143d084f308b92c0997fddfc60cb3e41","2a758e300fa7984b471b006a1aafbb18d0a6b2c0420e83e20e8a9421cf2cfd51"],["b6459e0ee3662ec8d23540c223bcbdc571cbcb967d79424f3cf29eb3de6b80ef","67c876d06f3e06de1dadf16e5661db3c4b3ae6d48e35b2ff30bf0b61a71ba45"],["d68a80c8280bb840793234aa118f06231d6f1fc67e73c5a5deda0f5b496943e8","db8ba9fff4b586d00c4b1f9177b0e28b5b0e7b8f7845295a294c84266b133120"],["324aed7df65c804252dc0270907a30b09612aeb973449cea4095980fc28d3d5d","648a365774b61f2ff130c0c35aec1f4f19213b0c7e332843967224af96ab7c84"],["4df9c14919cde61f6d51dfdbe5fee5dceec4143ba8d1ca888e8bd373fd054c96","35ec51092d8728050974c23a1d85d4b5d506cdc288490192ebac06cad10d5d"],["9c3919a84a474870faed8a9c1cc66021523489054d7f0308cbfc99c8ac1f98cd","ddb84f0f4a4ddd57584f044bf260e641905326f76c64c8e6be7e5e03d4fc599d"],["6057170b1dd12fdf8de05f281d8e06bb91e1493a8b91d4cc5a21382120a959e5","9a1af0b26a6a4807add9a2daf71df262465152bc3ee24c65e899be932385a2a8"],["a576df8e23a08411421439a4518da31880cef0fba7d4df12b1a6973eecb94266","40a6bf20e76640b2c92b97afe58cd82c432e10a7f514d9f3ee8be11ae1b28ec8"],["7778a78c28dec3e30a05fe9629de8c38bb30d1f5cf9a3a208f763889be58ad71","34626d9ab5a5b22ff7098e12f2ff580087b38411ff24ac563b513fc1fd9f43ac"],["928955ee637a84463729fd30e7afd2ed5f96274e5ad7e5cb09eda9c06d903ac","c25621003d3f42a827b78a13093a95eeac3d26efa8a8d83fc5180e935bcd091f"],["85d0fef3ec6db109399064f3a0e3b2855645b4a907ad354527aae75163d82751","1f03648413a38c0be29d496e582cf5663e8751e96877331582c237a24eb1f962"],["ff2b0dce97eece97c1c9b6041798b85dfdfb6d8882da20308f5404824526087e","493d13fef524ba188af4c4dc54d07936c7b7ed6fb90e2ceb2c951e01f0c29907"],["827fbbe4b1e880ea9ed2b2e6301b212b57f1ee148cd6dd28780e5e2cf856e241","c60f9c923c727b0b71bef2c67d1d12687ff7a63186903166d605b68baec293ec"],["eaa649f21f51bdbae7be4ae34ce6e5217a58fdce7f47f9aa7f3b58fa2120e2b3","be3279ed5bbbb03ac69a80f89879aa5a01a6b965f13f7e59d47a5305ba5ad93d"],["e4a42d43c5cf169d9391df6decf42ee541b6d8f0c9a137401e23632dda34d24f","4d9f92e716d1c73526fc99ccfb8ad34ce886eedfa8d8e4f13a7f7131deba9414"],["1ec80fef360cbdd954160fadab352b6b92b53576a88fea4947173b9d4300bf19","aeefe93756b5340d2f3a4958a7abbf5e0146e77f6295a07b671cdc1cc107cefd"],["146a778c04670c2f91b00af4680dfa8bce3490717d58ba889ddb5928366642be","b318e0ec3354028add669827f9d4b2870aaa971d2f7e5ed1d0b297483d83efd0"],["fa50c0f61d22e5f07e3acebb1aa07b128d0012209a28b9776d76a8793180eef9","6b84c6922397eba9b72cd2872281a68a5e683293a57a213b38cd8d7d3f4f2811"],["da1d61d0ca721a11b1a5bf6b7d88e8421a288ab5d5bba5220e53d32b5f067ec2","8157f55a7c99306c79c0766161c91e2966a73899d279b48a655fba0f1ad836f1"],["a8e282ff0c9706907215ff98e8fd416615311de0446f1e062a73b0610d064e13","7f97355b8db81c09abfb7f3c5b2515888b679a3e50dd6bd6cef7c73111f4cc0c"],["174a53b9c9a285872d39e56e6913cab15d59b1fa512508c022f382de8319497c","ccc9dc37abfc9c1657b4155f2c47f9e6646b3a1d8cb9854383da13ac079afa73"],["959396981943785c3d3e57edf5018cdbe039e730e4918b3d884fdff09475b7ba","2e7e552888c331dd8ba0386a4b9cd6849c653f64c8709385e9b8abf87524f2fd"],["d2a63a50ae401e56d645a1153b109a8fcca0a43d561fba2dbb51340c9d82b151","e82d86fb6443fcb7565aee58b2948220a70f750af484ca52d4142174dcf89405"],["64587e2335471eb890ee7896d7cfdc866bacbdbd3839317b3436f9b45617e073","d99fcdd5bf6902e2ae96dd6447c299a185b90a39133aeab358299e5e9faf6589"],["8481bde0e4e4d885b3a546d3e549de042f0aa6cea250e7fd358d6c86dd45e458","38ee7b8cba5404dd84a25bf39cecb2ca900a79c42b262e556d64b1b59779057e"],["13464a57a78102aa62b6979ae817f4637ffcfed3c4b1ce30bcd6303f6caf666b","69be159004614580ef7e433453ccb0ca48f300a81d0942e13f495a907f6ecc27"],["bc4a9df5b713fe2e9aef430bcc1dc97a0cd9ccede2f28588cada3a0d2d83f366","d3a81ca6e785c06383937adf4b798caa6e8a9fbfa547b16d758d666581f33c1"],["8c28a97bf8298bc0d23d8c749452a32e694b65e30a9472a3954ab30fe5324caa","40a30463a3305193378fedf31f7cc0eb7ae784f0451cb9459e71dc73cbef9482"],["8ea9666139527a8c1dd94ce4f071fd23c8b350c5a4bb33748c4ba111faccae0","620efabbc8ee2782e24e7c0cfb95c5d735b783be9cf0f8e955af34a30e62b945"],["dd3625faef5ba06074669716bbd3788d89bdde815959968092f76cc4eb9a9787","7a188fa3520e30d461da2501045731ca941461982883395937f68d00c644a573"],["f710d79d9eb962297e4f6232b40e8f7feb2bc63814614d692c12de752408221e","ea98e67232d3b3295d3b535532115ccac8612c721851617526ae47a9c77bfc82"]]},naf:{wnd:7,points:[["f9308a019258c31049344f85f89d5229b531c845836f99b08601f113bce036f9","388f7b0f632de8140fe337e62a37f3566500a99934c2231b6cb9fd7584b8e672"],["2f8bde4d1a07209355b4a7250a5c5128e88b84bddc619ab7cba8d569b240efe4","d8ac222636e5e3d6d4dba9dda6c9c426f788271bab0d6840dca87d3aa6ac62d6"],["5cbdf0646e5db4eaa398f365f2ea7a0e3d419b7e0330e39ce92bddedcac4f9bc","6aebca40ba255960a3178d6d861a54dba813d0b813fde7b5a5082628087264da"],["acd484e2f0c7f65309ad178a9f559abde09796974c57e714c35f110dfc27ccbe","cc338921b0a7d9fd64380971763b61e9add888a4375f8e0f05cc262ac64f9c37"],["774ae7f858a9411e5ef4246b70c65aac5649980be5c17891bbec17895da008cb","d984a032eb6b5e190243dd56d7b7b365372db1e2dff9d6a8301d74c9c953c61b"],["f28773c2d975288bc7d1d205c3748651b075fbc6610e58cddeeddf8f19405aa8","ab0902e8d880a89758212eb65cdaf473a1a06da521fa91f29b5cb52db03ed81"],["d7924d4f7d43ea965a465ae3095ff41131e5946f3c85f79e44adbcf8e27e080e","581e2872a86c72a683842ec228cc6defea40af2bd896d3a5c504dc9ff6a26b58"],["defdea4cdb677750a420fee807eacf21eb9898ae79b9768766e4faa04a2d4a34","4211ab0694635168e997b0ead2a93daeced1f4a04a95c0f6cfb199f69e56eb77"],["2b4ea0a797a443d293ef5cff444f4979f06acfebd7e86d277475656138385b6c","85e89bc037945d93b343083b5a1c86131a01f60c50269763b570c854e5c09b7a"],["352bbf4a4cdd12564f93fa332ce333301d9ad40271f8107181340aef25be59d5","321eb4075348f534d59c18259dda3e1f4a1b3b2e71b1039c67bd3d8bcf81998c"],["2fa2104d6b38d11b0230010559879124e42ab8dfeff5ff29dc9cdadd4ecacc3f","2de1068295dd865b64569335bd5dd80181d70ecfc882648423ba76b532b7d67"],["9248279b09b4d68dab21a9b066edda83263c3d84e09572e269ca0cd7f5453714","73016f7bf234aade5d1aa71bdea2b1ff3fc0de2a887912ffe54a32ce97cb3402"],["daed4f2be3a8bf278e70132fb0beb7522f570e144bf615c07e996d443dee8729","a69dce4a7d6c98e8d4a1aca87ef8d7003f83c230f3afa726ab40e52290be1c55"],["c44d12c7065d812e8acf28d7cbb19f9011ecd9e9fdf281b0e6a3b5e87d22e7db","2119a460ce326cdc76c45926c982fdac0e106e861edf61c5a039063f0e0e6482"],["6a245bf6dc698504c89a20cfded60853152b695336c28063b61c65cbd269e6b4","e022cf42c2bd4a708b3f5126f16a24ad8b33ba48d0423b6efd5e6348100d8a82"],["1697ffa6fd9de627c077e3d2fe541084ce13300b0bec1146f95ae57f0d0bd6a5","b9c398f186806f5d27561506e4557433a2cf15009e498ae7adee9d63d01b2396"],["605bdb019981718b986d0f07e834cb0d9deb8360ffb7f61df982345ef27a7479","2972d2de4f8d20681a78d93ec96fe23c26bfae84fb14db43b01e1e9056b8c49"],["62d14dab4150bf497402fdc45a215e10dcb01c354959b10cfe31c7e9d87ff33d","80fc06bd8cc5b01098088a1950eed0db01aa132967ab472235f5642483b25eaf"],["80c60ad0040f27dade5b4b06c408e56b2c50e9f56b9b8b425e555c2f86308b6f","1c38303f1cc5c30f26e66bad7fe72f70a65eed4cbe7024eb1aa01f56430bd57a"],["7a9375ad6167ad54aa74c6348cc54d344cc5dc9487d847049d5eabb0fa03c8fb","d0e3fa9eca8726909559e0d79269046bdc59ea10c70ce2b02d499ec224dc7f7"],["d528ecd9b696b54c907a9ed045447a79bb408ec39b68df504bb51f459bc3ffc9","eecf41253136e5f99966f21881fd656ebc4345405c520dbc063465b521409933"],["49370a4b5f43412ea25f514e8ecdad05266115e4a7ecb1387231808f8b45963","758f3f41afd6ed428b3081b0512fd62a54c3f3afbb5b6764b653052a12949c9a"],["77f230936ee88cbbd73df930d64702ef881d811e0e1498e2f1c13eb1fc345d74","958ef42a7886b6400a08266e9ba1b37896c95330d97077cbbe8eb3c7671c60d6"],["f2dac991cc4ce4b9ea44887e5c7c0bce58c80074ab9d4dbaeb28531b7739f530","e0dedc9b3b2f8dad4da1f32dec2531df9eb5fbeb0598e4fd1a117dba703a3c37"],["463b3d9f662621fb1b4be8fbbe2520125a216cdfc9dae3debcba4850c690d45b","5ed430d78c296c3543114306dd8622d7c622e27c970a1de31cb377b01af7307e"],["f16f804244e46e2a09232d4aff3b59976b98fac14328a2d1a32496b49998f247","cedabd9b82203f7e13d206fcdf4e33d92a6c53c26e5cce26d6579962c4e31df6"],["caf754272dc84563b0352b7a14311af55d245315ace27c65369e15f7151d41d1","cb474660ef35f5f2a41b643fa5e460575f4fa9b7962232a5c32f908318a04476"],["2600ca4b282cb986f85d0f1709979d8b44a09c07cb86d7c124497bc86f082120","4119b88753c15bd6a693b03fcddbb45d5ac6be74ab5f0ef44b0be9475a7e4b40"],["7635ca72d7e8432c338ec53cd12220bc01c48685e24f7dc8c602a7746998e435","91b649609489d613d1d5e590f78e6d74ecfc061d57048bad9e76f302c5b9c61"],["754e3239f325570cdbbf4a87deee8a66b7f2b33479d468fbc1a50743bf56cc18","673fb86e5bda30fb3cd0ed304ea49a023ee33d0197a695d0c5d98093c536683"],["e3e6bd1071a1e96aff57859c82d570f0330800661d1c952f9fe2694691d9b9e8","59c9e0bba394e76f40c0aa58379a3cb6a5a2283993e90c4167002af4920e37f5"],["186b483d056a033826ae73d88f732985c4ccb1f32ba35f4b4cc47fdcf04aa6eb","3b952d32c67cf77e2e17446e204180ab21fb8090895138b4a4a797f86e80888b"],["df9d70a6b9876ce544c98561f4be4f725442e6d2b737d9c91a8321724ce0963f","55eb2dafd84d6ccd5f862b785dc39d4ab157222720ef9da217b8c45cf2ba2417"],["5edd5cc23c51e87a497ca815d5dce0f8ab52554f849ed8995de64c5f34ce7143","efae9c8dbc14130661e8cec030c89ad0c13c66c0d17a2905cdc706ab7399a868"],["290798c2b6476830da12fe02287e9e777aa3fba1c355b17a722d362f84614fba","e38da76dcd440621988d00bcf79af25d5b29c094db2a23146d003afd41943e7a"],["af3c423a95d9f5b3054754efa150ac39cd29552fe360257362dfdecef4053b45","f98a3fd831eb2b749a93b0e6f35cfb40c8cd5aa667a15581bc2feded498fd9c6"],["766dbb24d134e745cccaa28c99bf274906bb66b26dcf98df8d2fed50d884249a","744b1152eacbe5e38dcc887980da38b897584a65fa06cedd2c924f97cbac5996"],["59dbf46f8c94759ba21277c33784f41645f7b44f6c596a58ce92e666191abe3e","c534ad44175fbc300f4ea6ce648309a042ce739a7919798cd85e216c4a307f6e"],["f13ada95103c4537305e691e74e9a4a8dd647e711a95e73cb62dc6018cfd87b8","e13817b44ee14de663bf4bc808341f326949e21a6a75c2570778419bdaf5733d"],["7754b4fa0e8aced06d4167a2c59cca4cda1869c06ebadfb6488550015a88522c","30e93e864e669d82224b967c3020b8fa8d1e4e350b6cbcc537a48b57841163a2"],["948dcadf5990e048aa3874d46abef9d701858f95de8041d2a6828c99e2262519","e491a42537f6e597d5d28a3224b1bc25df9154efbd2ef1d2cbba2cae5347d57e"],["7962414450c76c1689c7b48f8202ec37fb224cf5ac0bfa1570328a8a3d7c77ab","100b610ec4ffb4760d5c1fc133ef6f6b12507a051f04ac5760afa5b29db83437"],["3514087834964b54b15b160644d915485a16977225b8847bb0dd085137ec47ca","ef0afbb2056205448e1652c48e8127fc6039e77c15c2378b7e7d15a0de293311"],["d3cc30ad6b483e4bc79ce2c9dd8bc54993e947eb8df787b442943d3f7b527eaf","8b378a22d827278d89c5e9be8f9508ae3c2ad46290358630afb34db04eede0a4"],["1624d84780732860ce1c78fcbfefe08b2b29823db913f6493975ba0ff4847610","68651cf9b6da903e0914448c6cd9d4ca896878f5282be4c8cc06e2a404078575"],["733ce80da955a8a26902c95633e62a985192474b5af207da6df7b4fd5fc61cd4","f5435a2bd2badf7d485a4d8b8db9fcce3e1ef8e0201e4578c54673bc1dc5ea1d"],["15d9441254945064cf1a1c33bbd3b49f8966c5092171e699ef258dfab81c045c","d56eb30b69463e7234f5137b73b84177434800bacebfc685fc37bbe9efe4070d"],["a1d0fcf2ec9de675b612136e5ce70d271c21417c9d2b8aaaac138599d0717940","edd77f50bcb5a3cab2e90737309667f2641462a54070f3d519212d39c197a629"],["e22fbe15c0af8ccc5780c0735f84dbe9a790badee8245c06c7ca37331cb36980","a855babad5cd60c88b430a69f53a1a7a38289154964799be43d06d77d31da06"],["311091dd9860e8e20ee13473c1155f5f69635e394704eaa74009452246cfa9b3","66db656f87d1f04fffd1f04788c06830871ec5a64feee685bd80f0b1286d8374"],["34c1fd04d301be89b31c0442d3e6ac24883928b45a9340781867d4232ec2dbdf","9414685e97b1b5954bd46f730174136d57f1ceeb487443dc5321857ba73abee"],["f219ea5d6b54701c1c14de5b557eb42a8d13f3abbcd08affcc2a5e6b049b8d63","4cb95957e83d40b0f73af4544cccf6b1f4b08d3c07b27fb8d8c2962a400766d1"],["d7b8740f74a8fbaab1f683db8f45de26543a5490bca627087236912469a0b448","fa77968128d9c92ee1010f337ad4717eff15db5ed3c049b3411e0315eaa4593b"],["32d31c222f8f6f0ef86f7c98d3a3335ead5bcd32abdd94289fe4d3091aa824bf","5f3032f5892156e39ccd3d7915b9e1da2e6dac9e6f26e961118d14b8462e1661"],["7461f371914ab32671045a155d9831ea8793d77cd59592c4340f86cbc18347b5","8ec0ba238b96bec0cbdddcae0aa442542eee1ff50c986ea6b39847b3cc092ff6"],["ee079adb1df1860074356a25aa38206a6d716b2c3e67453d287698bad7b2b2d6","8dc2412aafe3be5c4c5f37e0ecc5f9f6a446989af04c4e25ebaac479ec1c8c1e"],["16ec93e447ec83f0467b18302ee620f7e65de331874c9dc72bfd8616ba9da6b5","5e4631150e62fb40d0e8c2a7ca5804a39d58186a50e497139626778e25b0674d"],["eaa5f980c245f6f038978290afa70b6bd8855897f98b6aa485b96065d537bd99","f65f5d3e292c2e0819a528391c994624d784869d7e6ea67fb18041024edc07dc"],["78c9407544ac132692ee1910a02439958ae04877151342ea96c4b6b35a49f51","f3e0319169eb9b85d5404795539a5e68fa1fbd583c064d2462b675f194a3ddb4"],["494f4be219a1a77016dcd838431aea0001cdc8ae7a6fc688726578d9702857a5","42242a969283a5f339ba7f075e36ba2af925ce30d767ed6e55f4b031880d562c"],["a598a8030da6d86c6bc7f2f5144ea549d28211ea58faa70ebf4c1e665c1fe9b5","204b5d6f84822c307e4b4a7140737aec23fc63b65b35f86a10026dbd2d864e6b"],["c41916365abb2b5d09192f5f2dbeafec208f020f12570a184dbadc3e58595997","4f14351d0087efa49d245b328984989d5caf9450f34bfc0ed16e96b58fa9913"],["841d6063a586fa475a724604da03bc5b92a2e0d2e0a36acfe4c73a5514742881","73867f59c0659e81904f9a1c7543698e62562d6744c169ce7a36de01a8d6154"],["5e95bb399a6971d376026947f89bde2f282b33810928be4ded112ac4d70e20d5","39f23f366809085beebfc71181313775a99c9aed7d8ba38b161384c746012865"],["36e4641a53948fd476c39f8a99fd974e5ec07564b5315d8bf99471bca0ef2f66","d2424b1b1abe4eb8164227b085c9aa9456ea13493fd563e06fd51cf5694c78fc"],["336581ea7bfbbb290c191a2f507a41cf5643842170e914faeab27c2c579f726","ead12168595fe1be99252129b6e56b3391f7ab1410cd1e0ef3dcdcabd2fda224"],["8ab89816dadfd6b6a1f2634fcf00ec8403781025ed6890c4849742706bd43ede","6fdcef09f2f6d0a044e654aef624136f503d459c3e89845858a47a9129cdd24e"],["1e33f1a746c9c5778133344d9299fcaa20b0938e8acff2544bb40284b8c5fb94","60660257dd11b3aa9c8ed618d24edff2306d320f1d03010e33a7d2057f3b3b6"],["85b7c1dcb3cec1b7ee7f30ded79dd20a0ed1f4cc18cbcfcfa410361fd8f08f31","3d98a9cdd026dd43f39048f25a8847f4fcafad1895d7a633c6fed3c35e999511"],["29df9fbd8d9e46509275f4b125d6d45d7fbe9a3b878a7af872a2800661ac5f51","b4c4fe99c775a606e2d8862179139ffda61dc861c019e55cd2876eb2a27d84b"],["a0b1cae06b0a847a3fea6e671aaf8adfdfe58ca2f768105c8082b2e449fce252","ae434102edde0958ec4b19d917a6a28e6b72da1834aff0e650f049503a296cf2"],["4e8ceafb9b3e9a136dc7ff67e840295b499dfb3b2133e4ba113f2e4c0e121e5","cf2174118c8b6d7a4b48f6d534ce5c79422c086a63460502b827ce62a326683c"],["d24a44e047e19b6f5afb81c7ca2f69080a5076689a010919f42725c2b789a33b","6fb8d5591b466f8fc63db50f1c0f1c69013f996887b8244d2cdec417afea8fa3"],["ea01606a7a6c9cdd249fdfcfacb99584001edd28abbab77b5104e98e8e3b35d4","322af4908c7312b0cfbfe369f7a7b3cdb7d4494bc2823700cfd652188a3ea98d"],["af8addbf2b661c8a6c6328655eb96651252007d8c5ea31be4ad196de8ce2131f","6749e67c029b85f52a034eafd096836b2520818680e26ac8f3dfbcdb71749700"],["e3ae1974566ca06cc516d47e0fb165a674a3dabcfca15e722f0e3450f45889","2aeabe7e4531510116217f07bf4d07300de97e4874f81f533420a72eeb0bd6a4"],["591ee355313d99721cf6993ffed1e3e301993ff3ed258802075ea8ced397e246","b0ea558a113c30bea60fc4775460c7901ff0b053d25ca2bdeee98f1a4be5d196"],["11396d55fda54c49f19aa97318d8da61fa8584e47b084945077cf03255b52984","998c74a8cd45ac01289d5833a7beb4744ff536b01b257be4c5767bea93ea57a4"],["3c5d2a1ba39c5a1790000738c9e0c40b8dcdfd5468754b6405540157e017aa7a","b2284279995a34e2f9d4de7396fc18b80f9b8b9fdd270f6661f79ca4c81bd257"],["cc8704b8a60a0defa3a99a7299f2e9c3fbc395afb04ac078425ef8a1793cc030","bdd46039feed17881d1e0862db347f8cf395b74fc4bcdc4e940b74e3ac1f1b13"],["c533e4f7ea8555aacd9777ac5cad29b97dd4defccc53ee7ea204119b2889b197","6f0a256bc5efdf429a2fb6242f1a43a2d9b925bb4a4b3a26bb8e0f45eb596096"],["c14f8f2ccb27d6f109f6d08d03cc96a69ba8c34eec07bbcf566d48e33da6593","c359d6923bb398f7fd4473e16fe1c28475b740dd098075e6c0e8649113dc3a38"],["a6cbc3046bc6a450bac24789fa17115a4c9739ed75f8f21ce441f72e0b90e6ef","21ae7f4680e889bb130619e2c0f95a360ceb573c70603139862afd617fa9b9f"],["347d6d9a02c48927ebfb86c1359b1caf130a3c0267d11ce6344b39f99d43cc38","60ea7f61a353524d1c987f6ecec92f086d565ab687870cb12689ff1e31c74448"],["da6545d2181db8d983f7dcb375ef5866d47c67b1bf31c8cf855ef7437b72656a","49b96715ab6878a79e78f07ce5680c5d6673051b4935bd897fea824b77dc208a"],["c40747cc9d012cb1a13b8148309c6de7ec25d6945d657146b9d5994b8feb1111","5ca560753be2a12fc6de6caf2cb489565db936156b9514e1bb5e83037e0fa2d4"],["4e42c8ec82c99798ccf3a610be870e78338c7f713348bd34c8203ef4037f3502","7571d74ee5e0fb92a7a8b33a07783341a5492144cc54bcc40a94473693606437"],["3775ab7089bc6af823aba2e1af70b236d251cadb0c86743287522a1b3b0dedea","be52d107bcfa09d8bcb9736a828cfa7fac8db17bf7a76a2c42ad961409018cf7"],["cee31cbf7e34ec379d94fb814d3d775ad954595d1314ba8846959e3e82f74e26","8fd64a14c06b589c26b947ae2bcf6bfa0149ef0be14ed4d80f448a01c43b1c6d"],["b4f9eaea09b6917619f6ea6a4eb5464efddb58fd45b1ebefcdc1a01d08b47986","39e5c9925b5a54b07433a4f18c61726f8bb131c012ca542eb24a8ac07200682a"],["d4263dfc3d2df923a0179a48966d30ce84e2515afc3dccc1b77907792ebcc60e","62dfaf07a0f78feb30e30d6295853ce189e127760ad6cf7fae164e122a208d54"],["48457524820fa65a4f8d35eb6930857c0032acc0a4a2de422233eeda897612c4","25a748ab367979d98733c38a1fa1c2e7dc6cc07db2d60a9ae7a76aaa49bd0f77"],["dfeeef1881101f2cb11644f3a2afdfc2045e19919152923f367a1767c11cceda","ecfb7056cf1de042f9420bab396793c0c390bde74b4bbdff16a83ae09a9a7517"],["6d7ef6b17543f8373c573f44e1f389835d89bcbc6062ced36c82df83b8fae859","cd450ec335438986dfefa10c57fea9bcc521a0959b2d80bbf74b190dca712d10"],["e75605d59102a5a2684500d3b991f2e3f3c88b93225547035af25af66e04541f","f5c54754a8f71ee540b9b48728473e314f729ac5308b06938360990e2bfad125"],["eb98660f4c4dfaa06a2be453d5020bc99a0c2e60abe388457dd43fefb1ed620c","6cb9a8876d9cb8520609af3add26cd20a0a7cd8a9411131ce85f44100099223e"],["13e87b027d8514d35939f2e6892b19922154596941888336dc3563e3b8dba942","fef5a3c68059a6dec5d624114bf1e91aac2b9da568d6abeb2570d55646b8adf1"],["ee163026e9fd6fe017c38f06a5be6fc125424b371ce2708e7bf4491691e5764a","1acb250f255dd61c43d94ccc670d0f58f49ae3fa15b96623e5430da0ad6c62b2"],["b268f5ef9ad51e4d78de3a750c2dc89b1e626d43505867999932e5db33af3d80","5f310d4b3c99b9ebb19f77d41c1dee018cf0d34fd4191614003e945a1216e423"],["ff07f3118a9df035e9fad85eb6c7bfe42b02f01ca99ceea3bf7ffdba93c4750d","438136d603e858a3a5c440c38eccbaddc1d2942114e2eddd4740d098ced1f0d8"],["8d8b9855c7c052a34146fd20ffb658bea4b9f69e0d825ebec16e8c3ce2b526a1","cdb559eedc2d79f926baf44fb84ea4d44bcf50fee51d7ceb30e2e7f463036758"],["52db0b5384dfbf05bfa9d472d7ae26dfe4b851ceca91b1eba54263180da32b63","c3b997d050ee5d423ebaf66a6db9f57b3180c902875679de924b69d84a7b375"],["e62f9490d3d51da6395efd24e80919cc7d0f29c3f3fa48c6fff543becbd43352","6d89ad7ba4876b0b22c2ca280c682862f342c8591f1daf5170e07bfd9ccafa7d"],["7f30ea2476b399b4957509c88f77d0191afa2ff5cb7b14fd6d8e7d65aaab1193","ca5ef7d4b231c94c3b15389a5f6311e9daff7bb67b103e9880ef4bff637acaec"],["5098ff1e1d9f14fb46a210fada6c903fef0fb7b4a1dd1d9ac60a0361800b7a00","9731141d81fc8f8084d37c6e7542006b3ee1b40d60dfe5362a5b132fd17ddc0"],["32b78c7de9ee512a72895be6b9cbefa6e2f3c4ccce445c96b9f2c81e2778ad58","ee1849f513df71e32efc3896ee28260c73bb80547ae2275ba497237794c8753c"],["e2cb74fddc8e9fbcd076eef2a7c72b0ce37d50f08269dfc074b581550547a4f7","d3aa2ed71c9dd2247a62df062736eb0baddea9e36122d2be8641abcb005cc4a4"],["8438447566d4d7bedadc299496ab357426009a35f235cb141be0d99cd10ae3a8","c4e1020916980a4da5d01ac5e6ad330734ef0d7906631c4f2390426b2edd791f"],["4162d488b89402039b584c6fc6c308870587d9c46f660b878ab65c82c711d67e","67163e903236289f776f22c25fb8a3afc1732f2b84b4e95dbda47ae5a0852649"],["3fad3fa84caf0f34f0f89bfd2dcf54fc175d767aec3e50684f3ba4a4bf5f683d","cd1bc7cb6cc407bb2f0ca647c718a730cf71872e7d0d2a53fa20efcdfe61826"],["674f2600a3007a00568c1a7ce05d0816c1fb84bf1370798f1c69532faeb1a86b","299d21f9413f33b3edf43b257004580b70db57da0b182259e09eecc69e0d38a5"],["d32f4da54ade74abb81b815ad1fb3b263d82d6c692714bcff87d29bd5ee9f08f","f9429e738b8e53b968e99016c059707782e14f4535359d582fc416910b3eea87"],["30e4e670435385556e593657135845d36fbb6931f72b08cb1ed954f1e3ce3ff6","462f9bce619898638499350113bbc9b10a878d35da70740dc695a559eb88db7b"],["be2062003c51cc3004682904330e4dee7f3dcd10b01e580bf1971b04d4cad297","62188bc49d61e5428573d48a74e1c655b1c61090905682a0d5558ed72dccb9bc"],["93144423ace3451ed29e0fb9ac2af211cb6e84a601df5993c419859fff5df04a","7c10dfb164c3425f5c71a3f9d7992038f1065224f72bb9d1d902a6d13037b47c"],["b015f8044f5fcbdcf21ca26d6c34fb8197829205c7b7d2a7cb66418c157b112c","ab8c1e086d04e813744a655b2df8d5f83b3cdc6faa3088c1d3aea1454e3a1d5f"],["d5e9e1da649d97d89e4868117a465a3a4f8a18de57a140d36b3f2af341a21b52","4cb04437f391ed73111a13cc1d4dd0db1693465c2240480d8955e8592f27447a"],["d3ae41047dd7ca065dbf8ed77b992439983005cd72e16d6f996a5316d36966bb","bd1aeb21ad22ebb22a10f0303417c6d964f8cdd7df0aca614b10dc14d125ac46"],["463e2763d885f958fc66cdd22800f0a487197d0a82e377b49f80af87c897b065","bfefacdb0e5d0fd7df3a311a94de062b26b80c61fbc97508b79992671ef7ca7f"],["7985fdfd127c0567c6f53ec1bb63ec3158e597c40bfe747c83cddfc910641917","603c12daf3d9862ef2b25fe1de289aed24ed291e0ec6708703a5bd567f32ed03"],["74a1ad6b5f76e39db2dd249410eac7f99e74c59cb83d2d0ed5ff1543da7703e9","cc6157ef18c9c63cd6193d83631bbea0093e0968942e8c33d5737fd790e0db08"],["30682a50703375f602d416664ba19b7fc9bab42c72747463a71d0896b22f6da3","553e04f6b018b4fa6c8f39e7f311d3176290d0e0f19ca73f17714d9977a22ff8"],["9e2158f0d7c0d5f26c3791efefa79597654e7a2b2464f52b1ee6c1347769ef57","712fcdd1b9053f09003a3481fa7762e9ffd7c8ef35a38509e2fbf2629008373"],["176e26989a43c9cfeba4029c202538c28172e566e3c4fce7322857f3be327d66","ed8cc9d04b29eb877d270b4878dc43c19aefd31f4eee09ee7b47834c1fa4b1c3"],["75d46efea3771e6e68abb89a13ad747ecf1892393dfc4f1b7004788c50374da8","9852390a99507679fd0b86fd2b39a868d7efc22151346e1a3ca4726586a6bed8"],["809a20c67d64900ffb698c4c825f6d5f2310fb0451c869345b7319f645605721","9e994980d9917e22b76b061927fa04143d096ccc54963e6a5ebfa5f3f8e286c1"],["1b38903a43f7f114ed4500b4eac7083fdefece1cf29c63528d563446f972c180","4036edc931a60ae889353f77fd53de4a2708b26b6f5da72ad3394119daf408f9"]]}}});var IA=W(Rre=>{"use strict";f();var FD=Rre,qy=PA(),LD=MD(),RBe=zc(),Pre=RBe.assert;function Ire(t){t.type==="short"?this.curve=new LD.short(t):t.type==="edwards"?this.curve=new LD.edwards(t):this.curve=new LD.mont(t),this.g=this.curve.g,this.n=this.curve.n,this.hash=t.hash,Pre(this.g.validate(),"Invalid curve"),Pre(this.g.mul(this.n).isInfinity(),"Invalid curve, G*N != O")}FD.PresetCurve=Ire;function Ly(t,e){Object.defineProperty(FD,t,{configurable:!0,enumerable:!0,get:function(){var r=new Ire(e);return Object.defineProperty(FD,t,{configurable:!0,enumerable:!0,value:r}),r}})}Ly("p192",{type:"short",prime:"p192",p:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff",a:"ffffffff ffffffff ffffffff fffffffe ffffffff fffffffc",b:"64210519 e59c80e7 0fa7e9ab 72243049 feb8deec c146b9b1",n:"ffffffff ffffffff ffffffff 99def836 146bc9b1 b4d22831",hash:qy.sha256,gRed:!1,g:["188da80e b03090f6 7cbf20eb 43a18800 f4ff0afd 82ff1012","07192b95 ffc8da78 631011ed 6b24cdd5 73f977a1 1e794811"]});Ly("p224",{type:"short",prime:"p224",p:"ffffffff ffffffff ffffffff ffffffff 00000000 00000000 00000001",a:"ffffffff ffffffff ffffffff fffffffe ffffffff ffffffff fffffffe",b:"b4050a85 0c04b3ab f5413256 5044b0b7 d7bfd8ba 270b3943 2355ffb4",n:"ffffffff ffffffff ffffffff ffff16a2 e0b8f03e 13dd2945 5c5c2a3d",hash:qy.sha256,gRed:!1,g:["b70e0cbd 6bb4bf7f 321390b9 4a03c1d3 56c21122 343280d6 115c1d21","bd376388 b5f723fb 4c22dfe6 cd4375a0 5a074764 44d58199 85007e34"]});Ly("p256",{type:"short",prime:null,p:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff ffffffff",a:"ffffffff 00000001 00000000 00000000 00000000 ffffffff ffffffff fffffffc",b:"5ac635d8 aa3a93e7 b3ebbd55 769886bc 651d06b0 cc53b0f6 3bce3c3e 27d2604b",n:"ffffffff 00000000 ffffffff ffffffff bce6faad a7179e84 f3b9cac2 fc632551",hash:qy.sha256,gRed:!1,g:["6b17d1f2 e12c4247 f8bce6e5 63a440f2 77037d81 2deb33a0 f4a13945 d898c296","4fe342e2 fe1a7f9b 8ee7eb4a 7c0f9e16 2bce3357 6b315ece cbb64068 37bf51f5"]});Ly("p384",{type:"short",prime:null,p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 ffffffff",a:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe ffffffff 00000000 00000000 fffffffc",b:"b3312fa7 e23ee7e4 988e056b e3f82d19 181d9c6e fe814112 0314088f 5013875a c656398d 8a2ed19d 2a85c8ed d3ec2aef",n:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff c7634d81 f4372ddf 581a0db2 48b0a77a ecec196a ccc52973",hash:qy.sha384,gRed:!1,g:["aa87ca22 be8b0537 8eb1c71e f320ad74 6e1d3b62 8ba79b98 59f741e0 82542a38 5502f25d bf55296c 3a545e38 72760ab7","3617de4a 96262c6f 5d9e98bf 9292dc29 f8f41dbd 289a147c e9da3113 b5f0b8c0 0a60b1ce 1d7e819d 7a431d7c 90ea0e5f"]});Ly("p521",{type:"short",prime:null,p:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff",a:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffc",b:"00000051 953eb961 8e1c9a1f 929a21a0 b68540ee a2da725b 99b315f3 b8b48991 8ef109e1 56193951 ec7e937b 1652c0bd 3bb1bf07 3573df88 3d2c34f1 ef451fd4 6b503f00",n:"000001ff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffa 51868783 bf2f966b 7fcc0148 f709a5d0 3bb5c9b8 899c47ae bb6fb71e 91386409",hash:qy.sha512,gRed:!1,g:["000000c6 858e06b7 0404e9cd 9e3ecb66 2395b442 9c648139 053fb521 f828af60 6b4d3dba a14b5e77 efe75928 fe1dc127 a2ffa8de 3348b3c1 856a429b f97e7e31 c2e5bd66","00000118 39296a78 9a3bc004 5c8a5fb4 2c7d1bd9 98f54449 579b4468 17afbd17 273e662c 97ee7299 5ef42640 c550b901 3fad0761 353c7086 a272c240 88be9476 9fd16650"]});Ly("curve25519",{type:"mont",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"76d06",b:"1",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:qy.sha256,gRed:!1,g:["9"]});Ly("ed25519",{type:"edwards",prime:"p25519",p:"7fffffffffffffff ffffffffffffffff ffffffffffffffff ffffffffffffffed",a:"-1",c:"1",d:"52036cee2b6ffe73 8cc740797779e898 00700a4d4141d8ab 75eb4dca135978a3",n:"1000000000000000 0000000000000000 14def9dea2f79cd6 5812631a5cf5d3ed",hash:qy.sha256,gRed:!1,g:["216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51a","6666666666666666666666666666666666666666666666666666666666666658"]});var zD;try{zD=kre()}catch{zD=void 0}Ly("secp256k1",{type:"short",prime:"k256",p:"ffffffff ffffffff ffffffff ffffffff ffffffff ffffffff fffffffe fffffc2f",a:"0",b:"7",n:"ffffffff ffffffff ffffffff fffffffe baaedce6 af48a03b bfd25e8c d0364141",h:"1",hash:qy.sha256,beta:"7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee",lambda:"5363ad4cc05c30e0a5261c028812645a122e22ea20816678df02967c1b23bd72",basis:[{a:"3086d221a7d46bcde86c90e49284eb15",b:"-e4437ed6010e88286f547fa90abfe4c3"},{a:"114ca50f7a8e2f3f657c1108d9d44cfd8",b:"3086d221a7d46bcde86c90e49284eb15"}],gRed:!1,g:["79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798","483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8",zD]})});var Mre=W((xwt,Ore)=>{"use strict";f();var BBe=PA(),Ug=BD(),Bre=Fc();function Fy(t){if(!(this instanceof Fy))return new Fy(t);this.hash=t.hash,this.predResist=!!t.predResist,this.outLen=this.hash.outSize,this.minEntropy=t.minEntropy||this.hash.hmacStrength,this._reseed=null,this.reseedInterval=null,this.K=null,this.V=null;var e=Ug.toArray(t.entropy,t.entropyEnc||"hex"),r=Ug.toArray(t.nonce,t.nonceEnc||"hex"),n=Ug.toArray(t.pers,t.persEnc||"hex");Bre(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._init(e,r,n)}Ore.exports=Fy;Fy.prototype._init=function(e,r,n){var i=e.concat(r).concat(n);this.K=new Array(this.outLen/8),this.V=new Array(this.outLen/8);for(var o=0;o<this.V.length;o++)this.K[o]=0,this.V[o]=1;this._update(i),this._reseed=1,this.reseedInterval=281474976710656};Fy.prototype._hmac=function(){return new BBe.hmac(this.hash,this.K)};Fy.prototype._update=function(e){var r=this._hmac().update(this.V).update([0]);e&&(r=r.update(e)),this.K=r.digest(),this.V=this._hmac().update(this.V).digest(),e&&(this.K=this._hmac().update(this.V).update([1]).update(e).digest(),this.V=this._hmac().update(this.V).digest())};Fy.prototype.reseed=function(e,r,n,i){typeof r!="string"&&(i=n,n=r,r=null),e=Ug.toArray(e,r),n=Ug.toArray(n,i),Bre(e.length>=this.minEntropy/8,"Not enough entropy. Minimum is: "+this.minEntropy+" bits"),this._update(e.concat(n||[])),this._reseed=1};Fy.prototype.generate=function(e,r,n,i){if(this._reseed>this.reseedInterval)throw new Error("Reseed is required");typeof r!="string"&&(i=n,n=r,r=null),n&&(n=Ug.toArray(n,i||"hex"),this._update(n));for(var o=[];o.length<e;)this.V=this._hmac().update(this.V).digest(),o=o.concat(this.V);var s=o.slice(0,e);return this._update(n),this._reseed++,Ug.encode(s,r)}});var Cre=W((Swt,Dre)=>{"use strict";f();var OBe=Do(),MBe=zc(),VD=MBe.assert;function na(t,e){this.ec=t,this.priv=null,this.pub=null,e.priv&&this._importPrivate(e.priv,e.privEnc),e.pub&&this._importPublic(e.pub,e.pubEnc)}Dre.exports=na;na.fromPublic=function(e,r,n){return r instanceof na?r:new na(e,{pub:r,pubEnc:n})};na.fromPrivate=function(e,r,n){return r instanceof na?r:new na(e,{priv:r,privEnc:n})};na.prototype.validate=function(){var e=this.getPublic();return e.isInfinity()?{result:!1,reason:"Invalid public key"}:e.validate()?e.mul(this.ec.curve.n).isInfinity()?{result:!0,reason:null}:{result:!1,reason:"Public key * N != O"}:{result:!1,reason:"Public key is not a point"}};na.prototype.getPublic=function(e,r){return typeof e=="string"&&(r=e,e=null),this.pub||(this.pub=this.ec.g.mul(this.priv)),r?this.pub.encode(r,e):this.pub};na.prototype.getPrivate=function(e){return e==="hex"?this.priv.toString(16,2):this.priv};na.prototype._importPrivate=function(e,r){this.priv=new OBe(e,r||16),this.priv=this.priv.umod(this.ec.curve.n)};na.prototype._importPublic=function(e,r){if(e.x||e.y){this.ec.curve.type==="mont"?VD(e.x,"Need x coordinate"):(this.ec.curve.type==="short"||this.ec.curve.type==="edwards")&&VD(e.x&&e.y,"Need both x and y coordinate"),this.pub=this.ec.curve.point(e.x,e.y);return}this.pub=this.ec.curve.decodePoint(e,r)};na.prototype.derive=function(e){return e.validate()||VD(e.validate(),"public point not validated"),e.mul(this.priv).getX()};na.prototype.sign=function(e,r,n){return this.ec.sign(e,this,r,n)};na.prototype.verify=function(e,r){return this.ec.verify(e,r,this)};na.prototype.inspect=function(){return"<Key priv: "+(this.priv&&this.priv.toString(16,2))+" pub: "+(this.pub&&this.pub.inspect())+" >"}});var Nre=W((Awt,$re)=>{"use strict";f();var RA=Do(),GD=zc(),DBe=GD.assert;function BA(t,e){if(t instanceof BA)return t;this._importDER(t,e)||(DBe(t.r&&t.s,"Signature without r or s"),this.r=new RA(t.r,16),this.s=new RA(t.s,16),t.recoveryParam===void 0?this.recoveryParam=null:this.recoveryParam=t.recoveryParam)}$re.exports=BA;function CBe(){this.place=0}function HD(t,e){var r=t[e.place++];if(!(r&128))return r;var n=r&15;if(n===0||n>4||t[e.place]===0)return!1;for(var i=0,o=0,s=e.place;o<n;o++,s++)i<<=8,i|=t[s],i>>>=0;return i<=127?!1:(e.place=s,i)}function jre(t){for(var e=0,r=t.length-1;!t[e]&&!(t[e+1]&128)&&e<r;)e++;return e===0?t:t.slice(e)}BA.prototype._importDER=function(e,r){e=GD.toArray(e,r);var n=new CBe;if(e[n.place++]!==48)return!1;var i=HD(e,n);if(i===!1||i+n.place!==e.length||e[n.place++]!==2)return!1;var o=HD(e,n);if(o===!1||e[n.place]&128)return!1;var s=e.slice(n.place,o+n.place);if(n.place+=o,e[n.place++]!==2)return!1;var a=HD(e,n);if(a===!1||e.length!==a+n.place||e[n.place]&128)return!1;var d=e.slice(n.place,a+n.place);if(s[0]===0)if(s[1]&128)s=s.slice(1);else return!1;if(d[0]===0)if(d[1]&128)d=d.slice(1);else return!1;return this.r=new RA(s),this.s=new RA(d),this.recoveryParam=null,!0};function WD(t,e){if(e<128){t.push(e);return}var r=1+(Math.log(e)/Math.LN2>>>3);for(t.push(r|128);--r;)t.push(e>>>(r<<3)&255);t.push(e)}BA.prototype.toDER=function(e){var r=this.r.toArray(),n=this.s.toArray();for(r[0]&128&&(r=[0].concat(r)),n[0]&128&&(n=[0].concat(n)),r=jre(r),n=jre(n);!n[0]&&!(n[1]&128);)n=n.slice(1);var i=[2];WD(i,r.length),i=i.concat(r),i.push(2),WD(i,n.length);var o=i.concat(n),s=[48];return WD(s,o.length),s=s.concat(o),GD.encode(s,e)}});var Lre=W((Pwt,qre)=>{"use strict";f();var Kg=Do(),Ure=Mre(),jBe=zc(),JD=IA(),$Be=nA(),Kre=jBe.assert,YD=Cre(),OA=Nre();function Nd(t){if(!(this instanceof Nd))return new Nd(t);typeof t=="string"&&(Kre(Object.prototype.hasOwnProperty.call(JD,t),"Unknown curve "+t),t=JD[t]),t instanceof JD.PresetCurve&&(t={curve:t}),this.curve=t.curve.curve,this.n=this.curve.n,this.nh=this.n.ushrn(1),this.g=this.curve.g,this.g=t.curve.g,this.g.precompute(t.curve.n.bitLength()+1),this.hash=t.hash||t.curve.hash}qre.exports=Nd;Nd.prototype.keyPair=function(e){return new YD(this,e)};Nd.prototype.keyFromPrivate=function(e,r){return YD.fromPrivate(this,e,r)};Nd.prototype.keyFromPublic=function(e,r){return YD.fromPublic(this,e,r)};Nd.prototype.genKeyPair=function(e){e||(e={});for(var r=new Ure({hash:this.hash,pers:e.pers,persEnc:e.persEnc||"utf8",entropy:e.entropy||$Be(this.hash.hmacStrength),entropyEnc:e.entropy&&e.entropyEnc||"utf8",nonce:this.n.toArray()}),n=this.n.byteLength(),i=this.n.sub(new Kg(2));;){var o=new Kg(r.generate(n));if(!(o.cmp(i)>0))return o.iaddn(1),this.keyFromPrivate(o)}};Nd.prototype._truncateToN=function(e,r){var n=e.byteLength()*8-this.n.bitLength();return n>0&&(e=e.ushrn(n)),!r&&e.cmp(this.n)>=0?e.sub(this.n):e};Nd.prototype.sign=function(e,r,n,i){typeof n=="object"&&(i=n,n=null),i||(i={}),r=this.keyFromPrivate(r,n),e=this._truncateToN(new Kg(e,16));for(var o=this.n.byteLength(),s=r.getPrivate().toArray("be",o),a=e.toArray("be",o),d=new Ure({hash:this.hash,entropy:s,nonce:a,pers:i.pers,persEnc:i.persEnc||"utf8"}),u=this.n.sub(new Kg(1)),c=0;;c++){var l=i.k?i.k(c):new Kg(d.generate(this.n.byteLength()));if(l=this._truncateToN(l,!0),!(l.cmpn(1)<=0||l.cmp(u)>=0)){var h=this.g.mul(l);if(!h.isInfinity()){var y=h.getX(),g=y.umod(this.n);if(g.cmpn(0)!==0){var v=l.invm(this.n).mul(g.mul(r.getPrivate()).iadd(e));if(v=v.umod(this.n),v.cmpn(0)!==0){var x=(h.getY().isOdd()?1:0)|(y.cmp(g)!==0?2:0);return i.canonical&&v.cmp(this.nh)>0&&(v=this.n.sub(v),x^=1),new OA({r:g,s:v,recoveryParam:x})}}}}}};Nd.prototype.verify=function(e,r,n,i){e=this._truncateToN(new Kg(e,16)),n=this.keyFromPublic(n,i),r=new OA(r,"hex");var o=r.r,s=r.s;if(o.cmpn(1)<0||o.cmp(this.n)>=0||s.cmpn(1)<0||s.cmp(this.n)>=0)return!1;var a=s.invm(this.n),d=a.mul(e).umod(this.n),u=a.mul(o).umod(this.n),c;return this.curve._maxwellTrick?(c=this.g.jmulAdd(d,n.getPublic(),u),c.isInfinity()?!1:c.eqXToP(o)):(c=this.g.mulAdd(d,n.getPublic(),u),c.isInfinity()?!1:c.getX().umod(this.n).cmp(o)===0)};Nd.prototype.recoverPubKey=function(t,e,r,n){Kre((3&r)===r,"The recovery param is more than two bits"),e=new OA(e,n);var i=this.n,o=new Kg(t),s=e.r,a=e.s,d=r&1,u=r>>1;if(s.cmp(this.curve.p.umod(this.curve.n))>=0&&u)throw new Error("Unable to find sencond key candinate");u?s=this.curve.pointFromX(s.add(this.curve.n),d):s=this.curve.pointFromX(s,d);var c=e.r.invm(i),l=i.sub(o).mul(c).umod(i),h=a.mul(c).umod(i);return this.g.mulAdd(l,s,h)};Nd.prototype.getKeyRecoveryParam=function(t,e,r,n){if(e=new OA(e,n),e.recoveryParam!==null)return e.recoveryParam;for(var i=0;i<4;i++){var o;try{o=this.recoverPubKey(t,e,i)}catch{continue}if(o.eq(r))return i}throw new Error("Unable to find valid recovery factor")}});var Hre=W((Rwt,Vre)=>{"use strict";f();var JE=zc(),zre=JE.assert,Fre=JE.parseBytes,_1=JE.cachedProperty;function $o(t,e){this.eddsa=t,this._secret=Fre(e.secret),t.isPoint(e.pub)?this._pub=e.pub:this._pubBytes=Fre(e.pub)}$o.fromPublic=function(e,r){return r instanceof $o?r:new $o(e,{pub:r})};$o.fromSecret=function(e,r){return r instanceof $o?r:new $o(e,{secret:r})};$o.prototype.secret=function(){return this._secret};_1($o,"pubBytes",function(){return this.eddsa.encodePoint(this.pub())});_1($o,"pub",function(){return this._pubBytes?this.eddsa.decodePoint(this._pubBytes):this.eddsa.g.mul(this.priv())});_1($o,"privBytes",function(){var e=this.eddsa,r=this.hash(),n=e.encodingLength-1,i=r.slice(0,e.encodingLength);return i[0]&=248,i[n]&=127,i[n]|=64,i});_1($o,"priv",function(){return this.eddsa.decodeInt(this.privBytes())});_1($o,"hash",function(){return this.eddsa.hash().update(this.secret()).digest()});_1($o,"messagePrefix",function(){return this.hash().slice(this.eddsa.encodingLength)});$o.prototype.sign=function(e){return zre(this._secret,"KeyPair can only verify"),this.eddsa.sign(e,this)};$o.prototype.verify=function(e,r){return this.eddsa.verify(e,r,this)};$o.prototype.getSecret=function(e){return zre(this._secret,"KeyPair is public only"),JE.encode(this.secret(),e)};$o.prototype.getPublic=function(e){return JE.encode(this.pubBytes(),e)};Vre.exports=$o});var Jre=W((Owt,Gre)=>{"use strict";f();var NBe=Do(),MA=zc(),Wre=MA.assert,DA=MA.cachedProperty,UBe=MA.parseBytes;function qg(t,e){this.eddsa=t,typeof e!="object"&&(e=UBe(e)),Array.isArray(e)&&(Wre(e.length===t.encodingLength*2,"Signature has invalid size"),e={R:e.slice(0,t.encodingLength),S:e.slice(t.encodingLength)}),Wre(e.R&&e.S,"Signature without R or S"),t.isPoint(e.R)&&(this._R=e.R),e.S instanceof NBe&&(this._S=e.S),this._Rencoded=Array.isArray(e.R)?e.R:e.Rencoded,this._Sencoded=Array.isArray(e.S)?e.S:e.Sencoded}DA(qg,"S",function(){return this.eddsa.decodeInt(this.Sencoded())});DA(qg,"R",function(){return this.eddsa.decodePoint(this.Rencoded())});DA(qg,"Rencoded",function(){return this.eddsa.encodePoint(this.R())});DA(qg,"Sencoded",function(){return this.eddsa.encodeInt(this.S())});qg.prototype.toBytes=function(){return this.Rencoded().concat(this.Sencoded())};qg.prototype.toHex=function(){return MA.encode(this.toBytes(),"hex").toUpperCase()};Gre.exports=qg});var ene=W((Dwt,Qre)=>{"use strict";f();var KBe=PA(),qBe=IA(),x1=zc(),LBe=x1.assert,Zre=x1.parseBytes,Xre=Hre(),Yre=Jre();function ac(t){if(LBe(t==="ed25519","only tested with ed25519 so far"),!(this instanceof ac))return new ac(t);t=qBe[t].curve,this.curve=t,this.g=t.g,this.g.precompute(t.n.bitLength()+1),this.pointClass=t.point().constructor,this.encodingLength=Math.ceil(t.n.bitLength()/8),this.hash=KBe.sha512}Qre.exports=ac;ac.prototype.sign=function(e,r){e=Zre(e);var n=this.keyFromSecret(r),i=this.hashInt(n.messagePrefix(),e),o=this.g.mul(i),s=this.encodePoint(o),a=this.hashInt(s,n.pubBytes(),e).mul(n.priv()),d=i.add(a).umod(this.curve.n);return this.makeSignature({R:o,S:d,Rencoded:s})};ac.prototype.verify=function(e,r,n){if(e=Zre(e),r=this.makeSignature(r),r.S().gte(r.eddsa.curve.n)||r.S().isNeg())return!1;var i=this.keyFromPublic(n),o=this.hashInt(r.Rencoded(),i.pubBytes(),e),s=this.g.mul(r.S()),a=r.R().add(i.pub().mul(o));return a.eq(s)};ac.prototype.hashInt=function(){for(var e=this.hash(),r=0;r<arguments.length;r++)e.update(arguments[r]);return x1.intFromLE(e.digest()).umod(this.curve.n)};ac.prototype.keyFromPublic=function(e){return Xre.fromPublic(this,e)};ac.prototype.keyFromSecret=function(e){return Xre.fromSecret(this,e)};ac.prototype.makeSignature=function(e){return e instanceof Yre?e:new Yre(this,e)};ac.prototype.encodePoint=function(e){var r=e.getY().toArray("le",this.encodingLength);return r[this.encodingLength-1]|=e.getX().isOdd()?128:0,r};ac.prototype.decodePoint=function(e){e=x1.parseBytes(e);var r=e.length-1,n=e.slice(0,r).concat(e[r]&-129),i=(e[r]&128)!==0,o=x1.intFromLE(n);return this.curve.pointFromY(o,i)};ac.prototype.encodeInt=function(e){return e.toArray("le",this.encodingLength)};ac.prototype.decodeInt=function(e){return x1.intFromLE(e)};ac.prototype.isPoint=function(e){return e instanceof this.pointClass}});var CA=W(tne=>{"use strict";f();var Lg=tne;Lg.version=Ote().version;Lg.utils=zc();Lg.rand=nA();Lg.curve=MD();Lg.curves=IA();Lg.ec=Lre();Lg.eddsa=ene()});var ine=W(nne=>{f();var rne=S1(),FBe=Vt(),zBe=nne;zBe.define=function(e,r){return new E1(e,r)};function E1(t,e){this.name=t,this.body=e,this.decoders={},this.encoders={}}E1.prototype._createNamed=function(e){var r;try{r=A2e("vm").runInThisContext("(function "+this.name+`(entity) {
  this._initNamed(entity);
})`)}catch{r=function(i){this._initNamed(i)}}return FBe(r,e),r.prototype._initNamed=function(i){e.call(this,i)},new r(this)};E1.prototype._getDecoder=function(e){return e=e||"der",this.decoders.hasOwnProperty(e)||(this.decoders[e]=this._createNamed(rne.decoders[e])),this.decoders[e]};E1.prototype.decode=function(e,r,n){return this._getDecoder(r).decode(e,n)};E1.prototype._getEncoder=function(e){return e=e||"der",this.encoders.hasOwnProperty(e)||(this.encoders[e]=this._createNamed(rne.encoders[e])),this.encoders[e]};E1.prototype.encode=function(e,r,n){return this._getEncoder(r).encode(e,n)}});var sne=W(one=>{f();var VBe=Vt();function Ud(t){this._reporterState={obj:null,path:[],options:t||{},errors:[]}}one.Reporter=Ud;Ud.prototype.isError=function(e){return e instanceof T1};Ud.prototype.save=function(){var e=this._reporterState;return{obj:e.obj,pathLen:e.path.length}};Ud.prototype.restore=function(e){var r=this._reporterState;r.obj=e.obj,r.path=r.path.slice(0,e.pathLen)};Ud.prototype.enterKey=function(e){return this._reporterState.path.push(e)};Ud.prototype.exitKey=function(e){var r=this._reporterState;r.path=r.path.slice(0,e-1)};Ud.prototype.leaveKey=function(e,r,n){var i=this._reporterState;this.exitKey(e),i.obj!==null&&(i.obj[r]=n)};Ud.prototype.path=function(){return this._reporterState.path.join("/")};Ud.prototype.enterObject=function(){var e=this._reporterState,r=e.obj;return e.obj={},r};Ud.prototype.leaveObject=function(e){var r=this._reporterState,n=r.obj;return r.obj=e,n};Ud.prototype.error=function(e){var r,n=this._reporterState,i=e instanceof T1;if(i?r=e:r=new T1(n.path.map(function(o){return"["+JSON.stringify(o)+"]"}).join(""),e.message||e,e.stack),!n.options.partial)throw r;return i||n.errors.push(r),r};Ud.prototype.wrapResult=function(e){var r=this._reporterState;return r.options.partial?{result:this.isError(e)?null:e,errors:r.errors}:e};function T1(t,e){this.path=t,this.rethrow(e)}VBe(T1,Error);T1.prototype.rethrow=function(e){if(this.message=e+" at: "+(this.path||"(shallow)"),Error.captureStackTrace&&Error.captureStackTrace(this,T1),!this.stack)try{throw new Error(this.message)}catch(r){this.stack=r.stack}return this}});var XD=W(ZD=>{f();var HBe=Vt(),$A=A1().Reporter,YE=bn().Buffer;function tf(t,e){if($A.call(this,e),!YE.isBuffer(t)){this.error("Input not Buffer");return}this.base=t,this.offset=0,this.length=t.length}HBe(tf,$A);ZD.DecoderBuffer=tf;tf.prototype.save=function(){return{offset:this.offset,reporter:$A.prototype.save.call(this)}};tf.prototype.restore=function(e){var r=new tf(this.base);return r.offset=e.offset,r.length=this.offset,this.offset=e.offset,$A.prototype.restore.call(this,e.reporter),r};tf.prototype.isEmpty=function(){return this.offset===this.length};tf.prototype.readUInt8=function(e){return this.offset+1<=this.length?this.base.readUInt8(this.offset++,!0):this.error(e||"DecoderBuffer overrun")};tf.prototype.skip=function(e,r){if(!(this.offset+e<=this.length))return this.error(r||"DecoderBuffer overrun");var n=new tf(this.base);return n._reporterState=this._reporterState,n.offset=this.offset,n.length=this.offset+e,this.offset+=e,n};tf.prototype.raw=function(e){return this.base.slice(e?e.offset:this.offset,this.length)};function jA(t,e){if(Array.isArray(t))this.length=0,this.value=t.map(function(r){return r instanceof jA||(r=new jA(r,e)),this.length+=r.length,r},this);else if(typeof t=="number"){if(!(0<=t&&t<=255))return e.error("non-byte EncoderBuffer value");this.value=t,this.length=1}else if(typeof t=="string")this.value=t,this.length=YE.byteLength(t);else if(YE.isBuffer(t))this.value=t,this.length=t.length;else return e.error("Unsupported type: "+typeof t)}ZD.EncoderBuffer=jA;jA.prototype.join=function(e,r){return e||(e=new YE(this.length)),r||(r=0),this.length===0||(Array.isArray(this.value)?this.value.forEach(function(n){n.join(e,r),r+=n.length}):(typeof this.value=="number"?e[r]=this.value:typeof this.value=="string"?e.write(this.value,r):YE.isBuffer(this.value)&&this.value.copy(e,r),r+=this.length)),e}});var dne=W((zwt,cne)=>{f();var WBe=A1().Reporter,GBe=A1().EncoderBuffer,JBe=A1().DecoderBuffer,Oa=Fc(),ane=["seq","seqof","set","setof","objid","bool","gentime","utctime","null_","enum","int","objDesc","bitstr","bmpstr","charstr","genstr","graphstr","ia5str","iso646str","numstr","octstr","printstr","t61str","unistr","utf8str","videostr"],YBe=["key","obj","use","optional","explicit","implicit","def","choice","any","contains"].concat(ane),ZBe=["_peekTag","_decodeTag","_use","_decodeStr","_decodeObjid","_decodeTime","_decodeNull","_decodeInt","_decodeBool","_decodeList","_encodeComposite","_encodeStr","_encodeObjid","_encodeTime","_encodeNull","_encodeInt","_encodeBool"];function _n(t,e){var r={};this._baseState=r,r.enc=t,r.parent=e||null,r.children=null,r.tag=null,r.args=null,r.reverseArgs=null,r.choice=null,r.optional=!1,r.any=!1,r.obj=!1,r.use=null,r.useDecoder=null,r.key=null,r.default=null,r.explicit=null,r.implicit=null,r.contains=null,r.parent||(r.children=[],this._wrap())}cne.exports=_n;var XBe=["enc","parent","children","tag","args","reverseArgs","choice","optional","any","obj","use","alteredUse","key","default","explicit","implicit","contains"];_n.prototype.clone=function(){var e=this._baseState,r={};XBe.forEach(function(i){r[i]=e[i]});var n=new this.constructor(r.parent);return n._baseState=r,n};_n.prototype._wrap=function(){var e=this._baseState;YBe.forEach(function(r){this[r]=function(){var i=new this.constructor(this);return e.children.push(i),i[r].apply(i,arguments)}},this)};_n.prototype._init=function(e){var r=this._baseState;Oa(r.parent===null),e.call(this),r.children=r.children.filter(function(n){return n._baseState.parent===this},this),Oa.equal(r.children.length,1,"Root node can have only one child")};_n.prototype._useArgs=function(e){var r=this._baseState,n=e.filter(function(i){return i instanceof this.constructor},this);e=e.filter(function(i){return!(i instanceof this.constructor)},this),n.length!==0&&(Oa(r.children===null),r.children=n,n.forEach(function(i){i._baseState.parent=this},this)),e.length!==0&&(Oa(r.args===null),r.args=e,r.reverseArgs=e.map(function(i){if(typeof i!="object"||i.constructor!==Object)return i;var o={};return Object.keys(i).forEach(function(s){s==(s|0)&&(s|=0);var a=i[s];o[a]=s}),o}))};ZBe.forEach(function(t){_n.prototype[t]=function(){var r=this._baseState;throw new Error(t+" not implemented for encoding: "+r.enc)}});ane.forEach(function(t){_n.prototype[t]=function(){var r=this._baseState,n=Array.prototype.slice.call(arguments);return Oa(r.tag===null),r.tag=t,this._useArgs(n),this}});_n.prototype.use=function(e){Oa(e);var r=this._baseState;return Oa(r.use===null),r.use=e,this};_n.prototype.optional=function(){var e=this._baseState;return e.optional=!0,this};_n.prototype.def=function(e){var r=this._baseState;return Oa(r.default===null),r.default=e,r.optional=!0,this};_n.prototype.explicit=function(e){var r=this._baseState;return Oa(r.explicit===null&&r.implicit===null),r.explicit=e,this};_n.prototype.implicit=function(e){var r=this._baseState;return Oa(r.explicit===null&&r.implicit===null),r.implicit=e,this};_n.prototype.obj=function(){var e=this._baseState,r=Array.prototype.slice.call(arguments);return e.obj=!0,r.length!==0&&this._useArgs(r),this};_n.prototype.key=function(e){var r=this._baseState;return Oa(r.key===null),r.key=e,this};_n.prototype.any=function(){var e=this._baseState;return e.any=!0,this};_n.prototype.choice=function(e){var r=this._baseState;return Oa(r.choice===null),r.choice=e,this._useArgs(Object.keys(e).map(function(n){return e[n]})),this};_n.prototype.contains=function(e){var r=this._baseState;return Oa(r.use===null),r.contains=e,this};_n.prototype._decode=function(e,r){var n=this._baseState;if(n.parent===null)return e.wrapResult(n.children[0]._decode(e,r));var i=n.default,o=!0,s=null;if(n.key!==null&&(s=e.enterKey(n.key)),n.optional){var a=null;if(n.explicit!==null?a=n.explicit:n.implicit!==null?a=n.implicit:n.tag!==null&&(a=n.tag),a===null&&!n.any){var d=e.save();try{n.choice===null?this._decodeGeneric(n.tag,e,r):this._decodeChoice(e,r),o=!0}catch{o=!1}e.restore(d)}else if(o=this._peekTag(e,a,n.any),e.isError(o))return o}var u;if(n.obj&&o&&(u=e.enterObject()),o){if(n.explicit!==null){var c=this._decodeTag(e,n.explicit);if(e.isError(c))return c;e=c}var l=e.offset;if(n.use===null&&n.choice===null){if(n.any)var d=e.save();var h=this._decodeTag(e,n.implicit!==null?n.implicit:n.tag,n.any);if(e.isError(h))return h;n.any?i=e.raw(d):e=h}if(r&&r.track&&n.tag!==null&&r.track(e.path(),l,e.length,"tagged"),r&&r.track&&n.tag!==null&&r.track(e.path(),e.offset,e.length,"content"),n.any?i=i:n.choice===null?i=this._decodeGeneric(n.tag,e,r):i=this._decodeChoice(e,r),e.isError(i))return i;if(!n.any&&n.choice===null&&n.children!==null&&n.children.forEach(function(v){v._decode(e,r)}),n.contains&&(n.tag==="octstr"||n.tag==="bitstr")){var y=new JBe(i);i=this._getUse(n.contains,e._reporterState.obj)._decode(y,r)}}return n.obj&&o&&(i=e.leaveObject(u)),n.key!==null&&(i!==null||o===!0)?e.leaveKey(s,n.key,i):s!==null&&e.exitKey(s),i};_n.prototype._decodeGeneric=function(e,r,n){var i=this._baseState;return e==="seq"||e==="set"?null:e==="seqof"||e==="setof"?this._decodeList(r,e,i.args[0],n):/str$/.test(e)?this._decodeStr(r,e,n):e==="objid"&&i.args?this._decodeObjid(r,i.args[0],i.args[1],n):e==="objid"?this._decodeObjid(r,null,null,n):e==="gentime"||e==="utctime"?this._decodeTime(r,e,n):e==="null_"?this._decodeNull(r,n):e==="bool"?this._decodeBool(r,n):e==="objDesc"?this._decodeStr(r,e,n):e==="int"||e==="enum"?this._decodeInt(r,i.args&&i.args[0],n):i.use!==null?this._getUse(i.use,r._reporterState.obj)._decode(r,n):r.error("unknown tag: "+e)};_n.prototype._getUse=function(e,r){var n=this._baseState;return n.useDecoder=this._use(e,r),Oa(n.useDecoder._baseState.parent===null),n.useDecoder=n.useDecoder._baseState.children[0],n.implicit!==n.useDecoder._baseState.implicit&&(n.useDecoder=n.useDecoder.clone(),n.useDecoder._baseState.implicit=n.implicit),n.useDecoder};_n.prototype._decodeChoice=function(e,r){var n=this._baseState,i=null,o=!1;return Object.keys(n.choice).some(function(s){var a=e.save(),d=n.choice[s];try{var u=d._decode(e,r);if(e.isError(u))return!1;i={type:s,value:u},o=!0}catch{return e.restore(a),!1}return!0},this),o?i:e.error("Choice not matched")};_n.prototype._createEncoderBuffer=function(e){return new GBe(e,this.reporter)};_n.prototype._encode=function(e,r,n){var i=this._baseState;if(!(i.default!==null&&i.default===e)){var o=this._encodeValue(e,r,n);if(o!==void 0&&!this._skipDefault(o,r,n))return o}};_n.prototype._encodeValue=function(e,r,n){var i=this._baseState;if(i.parent===null)return i.children[0]._encode(e,r||new WBe);var d=null;if(this.reporter=r,i.optional&&e===void 0)if(i.default!==null)e=i.default;else return;var o=null,s=!1;if(i.any)d=this._createEncoderBuffer(e);else if(i.choice)d=this._encodeChoice(e,r);else if(i.contains)o=this._getUse(i.contains,n)._encode(e,r),s=!0;else if(i.children)o=i.children.map(function(l){if(l._baseState.tag==="null_")return l._encode(null,r,e);if(l._baseState.key===null)return r.error("Child should have a key");var h=r.enterKey(l._baseState.key);if(typeof e!="object")return r.error("Child expected, but input is not object");var y=l._encode(e[l._baseState.key],r,e);return r.leaveKey(h),y},this).filter(function(l){return l}),o=this._createEncoderBuffer(o);else if(i.tag==="seqof"||i.tag==="setof"){if(!(i.args&&i.args.length===1))return r.error("Too many args for : "+i.tag);if(!Array.isArray(e))return r.error("seqof/setof, but data is not Array");var a=this.clone();a._baseState.implicit=null,o=this._createEncoderBuffer(e.map(function(l){var h=this._baseState;return this._getUse(h.args[0],e)._encode(l,r)},a))}else i.use!==null?d=this._getUse(i.use,n)._encode(e,r):(o=this._encodePrimitive(i.tag,e),s=!0);var d;if(!i.any&&i.choice===null){var u=i.implicit!==null?i.implicit:i.tag,c=i.implicit===null?"universal":"context";u===null?i.use===null&&r.error("Tag could be omitted only for .use()"):i.use===null&&(d=this._encodeComposite(u,s,c,o))}return i.explicit!==null&&(d=this._encodeComposite(i.explicit,!1,"context",d)),d};_n.prototype._encodeChoice=function(e,r){var n=this._baseState,i=n.choice[e.type];return i||Oa(!1,e.type+" not found in "+JSON.stringify(Object.keys(n.choice))),i._encode(e.value,r)};_n.prototype._encodePrimitive=function(e,r){var n=this._baseState;if(/str$/.test(e))return this._encodeStr(r,e);if(e==="objid"&&n.args)return this._encodeObjid(r,n.reverseArgs[0],n.args[1]);if(e==="objid")return this._encodeObjid(r,null,null);if(e==="gentime"||e==="utctime")return this._encodeTime(r,e);if(e==="null_")return this._encodeNull();if(e==="int"||e==="enum")return this._encodeInt(r,n.args&&n.reverseArgs[0]);if(e==="bool")return this._encodeBool(r);if(e==="objDesc")return this._encodeStr(r,e);throw new Error("Unsupported tag: "+e)};_n.prototype._isNumstr=function(e){return/^[0-9 ]*$/.test(e)};_n.prototype._isPrintstr=function(e){return/^[A-Za-z0-9 '\(\)\+,\-\.\/:=\?]*$/.test(e)}});var A1=W(une=>{f();var NA=une;NA.Reporter=sne().Reporter;NA.DecoderBuffer=XD().DecoderBuffer;NA.EncoderBuffer=XD().EncoderBuffer;NA.Node=dne()});var fne=W(Fg=>{f();var lne=QD();Fg.tagClass={0:"universal",1:"application",2:"context",3:"private"};Fg.tagClassByName=lne._reverse(Fg.tagClass);Fg.tag={0:"end",1:"bool",2:"int",3:"bitstr",4:"octstr",5:"null_",6:"objid",7:"objDesc",8:"external",9:"real",10:"enum",11:"embed",12:"utf8str",13:"relativeOid",16:"seq",17:"set",18:"numstr",19:"printstr",20:"t61str",21:"videostr",22:"ia5str",23:"utctime",24:"gentime",25:"graphstr",26:"iso646str",27:"genstr",28:"unistr",29:"charstr",30:"bmpstr"};Fg.tagByName=lne._reverse(Fg.tag)});var QD=W(pne=>{f();var hne=pne;hne._reverse=function(e){var r={};return Object.keys(e).forEach(function(n){(n|0)==n&&(n=n|0);var i=e[n];r[i]=n}),r};hne.der=fne()});var rC=W((Xwt,vne)=>{f();var QBe=Vt(),eC=S1(),UA=eC.base,e9e=eC.bignum,yne=eC.constants.der;function mne(t){this.enc="der",this.name=t.name,this.entity=t,this.tree=new Vc,this.tree._init(t.body)}vne.exports=mne;mne.prototype.decode=function(e,r){return e instanceof UA.DecoderBuffer||(e=new UA.DecoderBuffer(e,r)),this.tree._decode(e,r)};function Vc(t){UA.Node.call(this,"der",t)}QBe(Vc,UA.Node);Vc.prototype._peekTag=function(e,r,n){if(e.isEmpty())return!1;var i=e.save(),o=tC(e,'Failed to peek tag: "'+r+'"');return e.isError(o)?o:(e.restore(i),o.tag===r||o.tagStr===r||o.tagStr+"of"===r||n)};Vc.prototype._decodeTag=function(e,r,n){var i=tC(e,'Failed to decode tag of "'+r+'"');if(e.isError(i))return i;var o=gne(e,i.primitive,'Failed to get length of "'+r+'"');if(e.isError(o))return o;if(!n&&i.tag!==r&&i.tagStr!==r&&i.tagStr+"of"!==r)return e.error('Failed to match tag: "'+r+'"');if(i.primitive||o!==null)return e.skip(o,'Failed to match body of: "'+r+'"');var s=e.save(),a=this._skipUntilEnd(e,'Failed to skip indefinite length body: "'+this.tag+'"');return e.isError(a)?a:(o=e.offset-s.offset,e.restore(s),e.skip(o,'Failed to match body of: "'+r+'"'))};Vc.prototype._skipUntilEnd=function(e,r){for(;;){var n=tC(e,r);if(e.isError(n))return n;var i=gne(e,n.primitive,r);if(e.isError(i))return i;var o;if(n.primitive||i!==null?o=e.skip(i):o=this._skipUntilEnd(e,r),e.isError(o))return o;if(n.tagStr==="end")break}};Vc.prototype._decodeList=function(e,r,n,i){for(var o=[];!e.isEmpty();){var s=this._peekTag(e,"end");if(e.isError(s))return s;var a=n.decode(e,"der",i);if(e.isError(a)&&s)break;o.push(a)}return o};Vc.prototype._decodeStr=function(e,r){if(r==="bitstr"){var n=e.readUInt8();return e.isError(n)?n:{unused:n,data:e.raw()}}else if(r==="bmpstr"){var i=e.raw();if(i.length%2===1)return e.error("Decoding of string type: bmpstr length mismatch");for(var o="",s=0;s<i.length/2;s++)o+=String.fromCharCode(i.readUInt16BE(s*2));return o}else if(r==="numstr"){var a=e.raw().toString("ascii");return this._isNumstr(a)?a:e.error("Decoding of string type: numstr unsupported characters")}else{if(r==="octstr")return e.raw();if(r==="objDesc")return e.raw();if(r==="printstr"){var d=e.raw().toString("ascii");return this._isPrintstr(d)?d:e.error("Decoding of string type: printstr unsupported characters")}else return/str$/.test(r)?e.raw().toString():e.error("Decoding of string type: "+r+" unsupported")}};Vc.prototype._decodeObjid=function(e,r,n){for(var i,o=[],s=0;!e.isEmpty();){var a=e.readUInt8();s<<=7,s|=a&127,a&128||(o.push(s),s=0)}a&128&&o.push(s);var d=o[0]/40|0,u=o[0]%40;if(n?i=o:i=[d,u].concat(o.slice(1)),r){var c=r[i.join(" ")];c===void 0&&(c=r[i.join(".")]),c!==void 0&&(i=c)}return i};Vc.prototype._decodeTime=function(e,r){var n=e.raw().toString();if(r==="gentime")var i=n.slice(0,4)|0,o=n.slice(4,6)|0,s=n.slice(6,8)|0,a=n.slice(8,10)|0,d=n.slice(10,12)|0,u=n.slice(12,14)|0;else if(r==="utctime"){var i=n.slice(0,2)|0,o=n.slice(2,4)|0,s=n.slice(4,6)|0,a=n.slice(6,8)|0,d=n.slice(8,10)|0,u=n.slice(10,12)|0;i<70?i=2e3+i:i=1900+i}else return e.error("Decoding "+r+" time is not supported yet");return Date.UTC(i,o-1,s,a,d,u,0)};Vc.prototype._decodeNull=function(e){return null};Vc.prototype._decodeBool=function(e){var r=e.readUInt8();return e.isError(r)?r:r!==0};Vc.prototype._decodeInt=function(e,r){var n=e.raw(),i=new e9e(n);return r&&(i=r[i.toString(10)]||i),i};Vc.prototype._use=function(e,r){return typeof e=="function"&&(e=e(r)),e._getDecoder("der").tree};function tC(t,e){var r=t.readUInt8(e);if(t.isError(r))return r;var n=yne.tagClass[r>>6],i=(r&32)===0;if((r&31)===31){var o=r;for(r=0;(o&128)===128;){if(o=t.readUInt8(e),t.isError(o))return o;r<<=7,r|=o&127}}else r&=31;var s=yne.tag[r];return{cls:n,primitive:i,tag:r,tagStr:s}}function gne(t,e,r){var n=t.readUInt8(r);if(t.isError(n))return n;if(!e&&n===128)return null;if(!(n&128))return n;var i=n&127;if(i>4)return t.error("length octect is too long");n=0;for(var o=0;o<i;o++){n<<=8;var s=t.readUInt8(r);if(t.isError(s))return s;n|=s}return n}});var wne=W((e1t,bne)=>{f();var t9e=Vt(),r9e=bn().Buffer,nC=rC();function iC(t){nC.call(this,t),this.enc="pem"}t9e(iC,nC);bne.exports=iC;iC.prototype.decode=function(e,r){for(var n=e.toString().split(/[\r\n]+/g),i=r.label.toUpperCase(),o=/^-----(BEGIN|END) ([^-]+)-----$/,s=-1,a=-1,d=0;d<n.length;d++){var u=n[d].match(o);if(u!==null&&u[2]===i)if(s===-1){if(u[1]!=="BEGIN")break;s=d}else{if(u[1]!=="END")break;a=d;break}}if(s===-1||a===-1)throw new Error("PEM section not found for: "+i);var c=n.slice(s+1,a).join("");c.replace(/[^a-z0-9\+\/=]+/gi,"");var l=new r9e(c,"base64");return nC.prototype.decode.call(this,l,r)}});var Ene=W(xne=>{f();var _ne=xne;_ne.der=rC();_ne.pem=wne()});var sC=W((i1t,kne)=>{f();var n9e=Vt(),Nh=bn().Buffer,Sne=S1(),Tne=Sne.base,oC=Sne.constants.der;function Ane(t){this.enc="der",this.name=t.name,this.entity=t,this.tree=new qu,this.tree._init(t.body)}kne.exports=Ane;Ane.prototype.encode=function(e,r){return this.tree._encode(e,r).join()};function qu(t){Tne.Node.call(this,"der",t)}n9e(qu,Tne.Node);qu.prototype._encodeComposite=function(e,r,n,i){var o=i9e(e,r,n,this.reporter);if(i.length<128){var d=new Nh(2);return d[0]=o,d[1]=i.length,this._createEncoderBuffer([d,i])}for(var s=1,a=i.length;a>=256;a>>=8)s++;var d=new Nh(2+s);d[0]=o,d[1]=128|s;for(var a=1+s,u=i.length;u>0;a--,u>>=8)d[a]=u&255;return this._createEncoderBuffer([d,i])};qu.prototype._encodeStr=function(e,r){if(r==="bitstr")return this._createEncoderBuffer([e.unused|0,e.data]);if(r==="bmpstr"){for(var n=new Nh(e.length*2),i=0;i<e.length;i++)n.writeUInt16BE(e.charCodeAt(i),i*2);return this._createEncoderBuffer(n)}else return r==="numstr"?this._isNumstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: numstr supports only digits and space"):r==="printstr"?this._isPrintstr(e)?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: printstr supports only latin upper and lower case letters, digits, space, apostrophe, left and rigth parenthesis, plus sign, comma, hyphen, dot, slash, colon, equal sign, question mark"):/str$/.test(r)?this._createEncoderBuffer(e):r==="objDesc"?this._createEncoderBuffer(e):this.reporter.error("Encoding of string type: "+r+" unsupported")};qu.prototype._encodeObjid=function(e,r,n){if(typeof e=="string"){if(!r)return this.reporter.error("string objid given, but no values map found");if(!r.hasOwnProperty(e))return this.reporter.error("objid not found in values map");e=r[e].split(/[\s\.]+/g);for(var i=0;i<e.length;i++)e[i]|=0}else if(Array.isArray(e)){e=e.slice();for(var i=0;i<e.length;i++)e[i]|=0}if(!Array.isArray(e))return this.reporter.error("objid() should be either array or string, got: "+JSON.stringify(e));if(!n){if(e[1]>=40)return this.reporter.error("Second objid identifier OOB");e.splice(0,2,e[0]*40+e[1])}for(var o=0,i=0;i<e.length;i++){var s=e[i];for(o++;s>=128;s>>=7)o++}for(var a=new Nh(o),d=a.length-1,i=e.length-1;i>=0;i--){var s=e[i];for(a[d--]=s&127;(s>>=7)>0;)a[d--]=128|s&127}return this._createEncoderBuffer(a)};function Kd(t){return t<10?"0"+t:t}qu.prototype._encodeTime=function(e,r){var n,i=new Date(e);return r==="gentime"?n=[Kd(i.getFullYear()),Kd(i.getUTCMonth()+1),Kd(i.getUTCDate()),Kd(i.getUTCHours()),Kd(i.getUTCMinutes()),Kd(i.getUTCSeconds()),"Z"].join(""):r==="utctime"?n=[Kd(i.getFullYear()%100),Kd(i.getUTCMonth()+1),Kd(i.getUTCDate()),Kd(i.getUTCHours()),Kd(i.getUTCMinutes()),Kd(i.getUTCSeconds()),"Z"].join(""):this.reporter.error("Encoding "+r+" time is not supported yet"),this._encodeStr(n,"octstr")};qu.prototype._encodeNull=function(){return this._createEncoderBuffer("")};qu.prototype._encodeInt=function(e,r){if(typeof e=="string"){if(!r)return this.reporter.error("String int or enum given, but no values map");if(!r.hasOwnProperty(e))return this.reporter.error("Values map doesn't contain: "+JSON.stringify(e));e=r[e]}if(typeof e!="number"&&!Nh.isBuffer(e)){var n=e.toArray();!e.sign&&n[0]&128&&n.unshift(0),e=new Nh(n)}if(Nh.isBuffer(e)){var i=e.length;e.length===0&&i++;var s=new Nh(i);return e.copy(s),e.length===0&&(s[0]=0),this._createEncoderBuffer(s)}if(e<128)return this._createEncoderBuffer(e);if(e<256)return this._createEncoderBuffer([0,e]);for(var i=1,o=e;o>=256;o>>=8)i++;for(var s=new Array(i),o=s.length-1;o>=0;o--)s[o]=e&255,e>>=8;return s[0]&128&&s.unshift(0),this._createEncoderBuffer(new Nh(s))};qu.prototype._encodeBool=function(e){return this._createEncoderBuffer(e?255:0)};qu.prototype._use=function(e,r){return typeof e=="function"&&(e=e(r)),e._getEncoder("der").tree};qu.prototype._skipDefault=function(e,r,n){var i=this._baseState,o;if(i.default===null)return!1;var s=e.join();if(i.defaultBuffer===void 0&&(i.defaultBuffer=this._encodeValue(i.default,r,n).join()),s.length!==i.defaultBuffer.length)return!1;for(o=0;o<s.length;o++)if(s[o]!==i.defaultBuffer[o])return!1;return!0};function i9e(t,e,r,n){var i;if(t==="seqof"?t="seq":t==="setof"&&(t="set"),oC.tagByName.hasOwnProperty(t))i=oC.tagByName[t];else if(typeof t=="number"&&(t|0)===t)i=t;else return n.error("Unknown tag: "+t);return i>=31?n.error("Multi-octet tag encoding unsupported"):(e||(i|=32),i|=oC.tagClassByName[r||"universal"]<<6,i)}});var Ine=W((s1t,Pne)=>{f();var o9e=Vt(),aC=sC();function cC(t){aC.call(this,t),this.enc="pem"}o9e(cC,aC);Pne.exports=cC;cC.prototype.encode=function(e,r){for(var n=aC.prototype.encode.call(this,e),i=n.toString("base64"),o=["-----BEGIN "+r.label+"-----"],s=0;s<i.length;s+=64)o.push(i.slice(s,s+64));return o.push("-----END "+r.label+"-----"),o.join(`
`)}});var One=W(Bne=>{f();var Rne=Bne;Rne.der=sC();Rne.pem=Ine()});var S1=W(Mne=>{f();var k1=Mne;k1.bignum=Do();k1.define=ine().define;k1.base=A1();k1.constants=QD();k1.decoders=Ene();k1.encoders=One()});var $ne=W((f1t,jne)=>{"use strict";f();var Lu=S1(),Dne=Lu.define("Time",function(){this.choice({utcTime:this.utctime(),generalTime:this.gentime()})}),s9e=Lu.define("AttributeTypeValue",function(){this.seq().obj(this.key("type").objid(),this.key("value").any())}),dC=Lu.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("parameters").optional(),this.key("curve").objid().optional())}),a9e=Lu.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(dC),this.key("subjectPublicKey").bitstr())}),c9e=Lu.define("RelativeDistinguishedName",function(){this.setof(s9e)}),d9e=Lu.define("RDNSequence",function(){this.seqof(c9e)}),Cne=Lu.define("Name",function(){this.choice({rdnSequence:this.use(d9e)})}),u9e=Lu.define("Validity",function(){this.seq().obj(this.key("notBefore").use(Dne),this.key("notAfter").use(Dne))}),l9e=Lu.define("Extension",function(){this.seq().obj(this.key("extnID").objid(),this.key("critical").bool().def(!1),this.key("extnValue").octstr())}),f9e=Lu.define("TBSCertificate",function(){this.seq().obj(this.key("version").explicit(0).int().optional(),this.key("serialNumber").int(),this.key("signature").use(dC),this.key("issuer").use(Cne),this.key("validity").use(u9e),this.key("subject").use(Cne),this.key("subjectPublicKeyInfo").use(a9e),this.key("issuerUniqueID").implicit(1).bitstr().optional(),this.key("subjectUniqueID").implicit(2).bitstr().optional(),this.key("extensions").explicit(3).seqof(l9e).optional())}),h9e=Lu.define("X509Certificate",function(){this.seq().obj(this.key("tbsCertificate").use(f9e),this.key("signatureAlgorithm").use(dC),this.key("signatureValue").bitstr())});jne.exports=h9e});var Une=W(zu=>{"use strict";f();var Fu=S1();zu.certificate=$ne();var p9e=Fu.define("RSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("modulus").int(),this.key("publicExponent").int(),this.key("privateExponent").int(),this.key("prime1").int(),this.key("prime2").int(),this.key("exponent1").int(),this.key("exponent2").int(),this.key("coefficient").int())});zu.RSAPrivateKey=p9e;var y9e=Fu.define("RSAPublicKey",function(){this.seq().obj(this.key("modulus").int(),this.key("publicExponent").int())});zu.RSAPublicKey=y9e;var Nne=Fu.define("AlgorithmIdentifier",function(){this.seq().obj(this.key("algorithm").objid(),this.key("none").null_().optional(),this.key("curve").objid().optional(),this.key("params").seq().obj(this.key("p").int(),this.key("q").int(),this.key("g").int()).optional())}),m9e=Fu.define("SubjectPublicKeyInfo",function(){this.seq().obj(this.key("algorithm").use(Nne),this.key("subjectPublicKey").bitstr())});zu.PublicKey=m9e;var g9e=Fu.define("PrivateKeyInfo",function(){this.seq().obj(this.key("version").int(),this.key("algorithm").use(Nne),this.key("subjectPrivateKey").octstr())});zu.PrivateKey=g9e;var v9e=Fu.define("EncryptedPrivateKeyInfo",function(){this.seq().obj(this.key("algorithm").seq().obj(this.key("id").objid(),this.key("decrypt").seq().obj(this.key("kde").seq().obj(this.key("id").objid(),this.key("kdeparams").seq().obj(this.key("salt").octstr(),this.key("iters").int())),this.key("cipher").seq().obj(this.key("algo").objid(),this.key("iv").octstr()))),this.key("subjectPrivateKey").octstr())});zu.EncryptedPrivateKey=v9e;var b9e=Fu.define("DSAPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("p").int(),this.key("q").int(),this.key("g").int(),this.key("pub_key").int(),this.key("priv_key").int())});zu.DSAPrivateKey=b9e;zu.DSAparam=Fu.define("DSAparam",function(){this.int()});var w9e=Fu.define("ECParameters",function(){this.choice({namedCurve:this.objid()})}),_9e=Fu.define("ECPrivateKey",function(){this.seq().obj(this.key("version").int(),this.key("privateKey").octstr(),this.key("parameters").optional().explicit(0).use(w9e),this.key("publicKey").optional().explicit(1).bitstr())});zu.ECPrivateKey=_9e;zu.signature=Fu.define("signature",function(){this.seq().obj(this.key("r").int(),this.key("s").int())})});var Kne=W((m1t,x9e)=>{x9e.exports={"2.16.840.1.101.3.4.1.1":"aes-128-ecb","2.16.840.1.101.3.4.1.2":"aes-128-cbc","2.16.840.1.101.3.4.1.3":"aes-128-ofb","2.16.840.1.101.3.4.1.4":"aes-128-cfb","2.16.840.1.101.3.4.1.21":"aes-192-ecb","2.16.840.1.101.3.4.1.22":"aes-192-cbc","2.16.840.1.101.3.4.1.23":"aes-192-ofb","2.16.840.1.101.3.4.1.24":"aes-192-cfb","2.16.840.1.101.3.4.1.41":"aes-256-ecb","2.16.840.1.101.3.4.1.42":"aes-256-cbc","2.16.840.1.101.3.4.1.43":"aes-256-ofb","2.16.840.1.101.3.4.1.44":"aes-256-cfb"}});var Lne=W((g1t,qne)=>{"use strict";f();var E9e=/Proc-Type: 4,ENCRYPTED[\n\r]+DEK-Info: AES-((?:128)|(?:192)|(?:256))-CBC,([0-9A-H]+)[\n\r]+([0-9A-z\n\r+/=]+)[\n\r]+/m,S9e=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----/m,T9e=/^-----BEGIN ((?:.*? KEY)|CERTIFICATE)-----([0-9A-z\n\r+/=]+)-----END \1-----$/m,A9e=ME(),k9e=rA(),KA=ur().Buffer;qne.exports=function(t,e){var r=t.toString(),n=r.match(E9e),i;if(n){var s="aes"+n[1],a=KA.from(n[2],"hex"),d=KA.from(n[3].replace(/[\r\n]/g,""),"base64"),u=A9e(e,a.slice(0,8),parseInt(n[1],10)).key,c=[],l=k9e.createDecipheriv(s,u,a);c.push(l.update(d)),c.push(l.final()),i=KA.concat(c)}else{var o=r.match(T9e);i=KA.from(o[2].replace(/[\r\n]/g,""),"base64")}var h=r.match(S9e)[1];return{tag:h,data:i}}});var ZE=W((b1t,zne)=>{"use strict";f();var cc=Une(),P9e=Kne(),I9e=Lne(),R9e=rA(),B9e=O7(),uC=ur().Buffer;function O9e(t,e){var r=t.algorithm.decrypt.kde.kdeparams.salt,n=parseInt(t.algorithm.decrypt.kde.kdeparams.iters.toString(),10),i=P9e[t.algorithm.decrypt.cipher.algo.join(".")],o=t.algorithm.decrypt.cipher.iv,s=t.subjectPrivateKey,a=parseInt(i.split("-")[1],10)/8,d=B9e.pbkdf2Sync(e,r,n,a,"sha1"),u=R9e.createDecipheriv(i,d,o),c=[];return c.push(u.update(s)),c.push(u.final()),uC.concat(c)}function Fne(t){var e;typeof t=="object"&&!uC.isBuffer(t)&&(e=t.passphrase,t=t.key),typeof t=="string"&&(t=uC.from(t));var r=I9e(t,e),n=r.tag,i=r.data,o,s;switch(n){case"CERTIFICATE":s=cc.certificate.decode(i,"der").tbsCertificate.subjectPublicKeyInfo;case"PUBLIC KEY":switch(s||(s=cc.PublicKey.decode(i,"der")),o=s.algorithm.algorithm.join("."),o){case"1.2.840.113549.1.1.1":return cc.RSAPublicKey.decode(s.subjectPublicKey.data,"der");case"1.2.840.10045.2.1":return s.subjectPrivateKey=s.subjectPublicKey,{type:"ec",data:s};case"1.2.840.10040.4.1":return s.algorithm.params.pub_key=cc.DSAparam.decode(s.subjectPublicKey.data,"der"),{type:"dsa",data:s.algorithm.params};default:throw new Error("unknown key id "+o)}case"ENCRYPTED PRIVATE KEY":i=cc.EncryptedPrivateKey.decode(i,"der"),i=O9e(i,e);case"PRIVATE KEY":switch(s=cc.PrivateKey.decode(i,"der"),o=s.algorithm.algorithm.join("."),o){case"1.2.840.113549.1.1.1":return cc.RSAPrivateKey.decode(s.subjectPrivateKey,"der");case"1.2.840.10045.2.1":return{curve:s.algorithm.curve,privateKey:cc.ECPrivateKey.decode(s.subjectPrivateKey,"der").privateKey};case"1.2.840.10040.4.1":return s.algorithm.params.priv_key=cc.DSAparam.decode(s.subjectPrivateKey,"der"),{type:"dsa",params:s.algorithm.params};default:throw new Error("unknown key id "+o)}case"RSA PUBLIC KEY":return cc.RSAPublicKey.decode(i,"der");case"RSA PRIVATE KEY":return cc.RSAPrivateKey.decode(i,"der");case"DSA PRIVATE KEY":return{type:"dsa",params:cc.DSAPrivateKey.decode(i,"der")};case"EC PRIVATE KEY":return i=cc.ECPrivateKey.decode(i,"der"),{curve:i.parameters.value,privateKey:i.privateKey};default:throw new Error("unknown key type "+n)}}Fne.signature=cc.signature;zne.exports=Fne});var lC=W((_1t,M9e)=>{M9e.exports={"1.3.132.0.10":"secp256k1","1.3.132.0.33":"p224","1.2.840.10045.3.1.1":"p192","1.2.840.10045.3.1.7":"p256","1.3.132.0.34":"p384","1.3.132.0.35":"p521"}});var Wne=W((x1t,LA)=>{"use strict";f();var ia=ur().Buffer,zg=x7(),D9e=vA(),C9e=CA().ec,qA=gA(),j9e=ZE(),$9e=lC(),N9e=1;function U9e(t,e,r,n,i){var o=j9e(e);if(o.curve){if(n!=="ecdsa"&&n!=="ecdsa/rsa")throw new Error("wrong private key type");return K9e(t,o)}else if(o.type==="dsa"){if(n!=="dsa")throw new Error("wrong private key type");return q9e(t,o,r)}if(n!=="rsa"&&n!=="ecdsa/rsa")throw new Error("wrong private key type");if(e.padding!==void 0&&e.padding!==N9e)throw new Error("illegal or unsupported padding mode");t=ia.concat([i,t]);for(var s=o.modulus.byteLength(),a=[0,1];t.length+a.length+1<s;)a.push(255);a.push(0);for(var d=-1;++d<t.length;)a.push(t[d]);var u=D9e(a,o);return u}function K9e(t,e){var r=$9e[e.curve.join(".")];if(!r)throw new Error("unknown curve "+e.curve.join("."));var n=new C9e(r),i=n.keyFromPrivate(e.privateKey),o=i.sign(t);return ia.from(o.toDER())}function q9e(t,e,r){for(var n=e.params.priv_key,i=e.params.p,o=e.params.q,s=e.params.g,a=new qA(0),d,u=fC(t,o).mod(o),c=!1,l=Vne(n,o,t,r);c===!1;)d=Hne(o,l,r),a=z9e(s,d,i,o),c=d.invm(o).imul(u.add(n.mul(a))).mod(o),c.cmpn(0)===0&&(c=!1,a=new qA(0));return L9e(a,c)}function L9e(t,e){t=t.toArray(),e=e.toArray(),t[0]&128&&(t=[0].concat(t)),e[0]&128&&(e=[0].concat(e));var r=t.length+e.length+4,n=[48,r,2,t.length];return n=n.concat(t,[2,e.length],e),ia.from(n)}function Vne(t,e,r,n){if(t=ia.from(t.toArray()),t.length<e.byteLength()){var i=ia.alloc(e.byteLength()-t.length);t=ia.concat([i,t])}var o=r.length,s=F9e(r,e),a=ia.alloc(o);a.fill(1);var d=ia.alloc(o);return d=zg(n,d).update(a).update(ia.from([0])).update(t).update(s).digest(),a=zg(n,d).update(a).digest(),d=zg(n,d).update(a).update(ia.from([1])).update(t).update(s).digest(),a=zg(n,d).update(a).digest(),{k:d,v:a}}function fC(t,e){var r=new qA(t),n=(t.length<<3)-e.bitLength();return n>0&&r.ishrn(n),r}function F9e(t,e){t=fC(t,e),t=t.mod(e);var r=ia.from(t.toArray());if(r.length<e.byteLength()){var n=ia.alloc(e.byteLength()-r.length);r=ia.concat([n,r])}return r}function Hne(t,e,r){var n,i;do{for(n=ia.alloc(0);n.length*8<t.bitLength();)e.v=zg(r,e.k).update(e.v).digest(),n=ia.concat([n,e.v]);i=fC(n,t),e.k=zg(r,e.k).update(e.v).update(ia.from([0])).digest(),e.v=zg(r,e.k).update(e.v).digest()}while(i.cmp(t)!==-1);return i}function z9e(t,e,r,n){return t.toRed(qA.mont(r)).redPow(e).fromRed().mod(n)}LA.exports=U9e;LA.exports.getKey=Vne;LA.exports.makeKey=Hne});var Zne=W((S1t,Yne)=>{"use strict";f();var hC=ur().Buffer,XE=gA(),V9e=CA().ec,Jne=ZE(),H9e=lC();function W9e(t,e,r,n,i){var o=Jne(r);if(o.type==="ec"){if(n!=="ecdsa"&&n!=="ecdsa/rsa")throw new Error("wrong public key type");return G9e(t,e,o)}else if(o.type==="dsa"){if(n!=="dsa")throw new Error("wrong public key type");return J9e(t,e,o)}if(n!=="rsa"&&n!=="ecdsa/rsa")throw new Error("wrong public key type");e=hC.concat([i,e]);for(var s=o.modulus.byteLength(),a=[1],d=0;e.length+a.length+2<s;)a.push(255),d+=1;a.push(0);for(var u=-1;++u<e.length;)a.push(e[u]);a=hC.from(a);var c=XE.mont(o.modulus);t=new XE(t).toRed(c),t=t.redPow(new XE(o.publicExponent)),t=hC.from(t.fromRed().toArray());var l=d<8?1:0;for(s=Math.min(t.length,a.length),t.length!==a.length&&(l=1),u=-1;++u<s;)l|=t[u]^a[u];return l===0}function G9e(t,e,r){var n=H9e[r.data.algorithm.curve.join(".")];if(!n)throw new Error("unknown curve "+r.data.algorithm.curve.join("."));var i=new V9e(n),o=r.data.subjectPrivateKey.data;return i.verify(e,t,o)}function J9e(t,e,r){var n=r.data.p,i=r.data.q,o=r.data.g,s=r.data.pub_key,a=Jne.signature.decode(t,"der"),d=a.s,u=a.r;Gne(d,i),Gne(u,i);var c=XE.mont(n),l=d.invm(i),h=o.toRed(c).redPow(new XE(e).mul(l).mod(i)).fromRed().mul(s.toRed(c).redPow(u.mul(l).mod(i)).fromRed()).mod(n).mod(i);return h.cmp(u)===0}function Gne(t,e){if(t.cmpn(0)<=0)throw new Error("invalid sig");if(t.cmp(e)>=0)throw new Error("invalid sig")}Yne.exports=W9e});var nie=W((A1t,rie)=>{"use strict";f();var FA=ur().Buffer,eie=Qw(),zA=kte(),tie=Vt(),Y9e=Wne(),Z9e=Zne(),Vg=E7();Object.keys(Vg).forEach(function(t){Vg[t].id=FA.from(Vg[t].id,"hex"),Vg[t.toLowerCase()]=Vg[t]});function QE(t){zA.Writable.call(this);var e=Vg[t];if(!e)throw new Error("Unknown message digest");this._hashType=e.hash,this._hash=eie(e.hash),this._tag=e.id,this._signType=e.sign}tie(QE,zA.Writable);QE.prototype._write=function(e,r,n){this._hash.update(e),n()};QE.prototype.update=function(e,r){return this._hash.update(typeof e=="string"?FA.from(e,r):e),this};QE.prototype.sign=function(e,r){this.end();var n=this._hash.digest(),i=Y9e(n,e,this._hashType,this._signType,this._tag);return r?i.toString(r):i};function e6(t){zA.Writable.call(this);var e=Vg[t];if(!e)throw new Error("Unknown message digest");this._hash=eie(e.hash),this._tag=e.id,this._signType=e.sign}tie(e6,zA.Writable);e6.prototype._write=function(e,r,n){this._hash.update(e),n()};e6.prototype.update=function(e,r){return this._hash.update(typeof e=="string"?FA.from(e,r):e),this};e6.prototype.verify=function(e,r,n){var i=typeof r=="string"?FA.from(r,n):r;this.end();var o=this._hash.digest();return Z9e(i,o,e,this._signType,this._tag)};function Xne(t){return new QE(t)}function Qne(t){return new e6(t)}rie.exports={Sign:Xne,Verify:Qne,createSign:Xne,createVerify:Qne}});var oie=W((P1t,iie)=>{f();var X9e=CA(),Q9e=Do();iie.exports=function(e){return new Hg(e)};var Hc={secp256k1:{name:"secp256k1",byteLength:32},secp224r1:{name:"p224",byteLength:28},prime256v1:{name:"p256",byteLength:32},prime192v1:{name:"p192",byteLength:24},ed25519:{name:"ed25519",byteLength:32},secp384r1:{name:"p384",byteLength:48},secp521r1:{name:"p521",byteLength:66}};Hc.p224=Hc.secp224r1;Hc.p256=Hc.secp256r1=Hc.prime256v1;Hc.p192=Hc.secp192r1=Hc.prime192v1;Hc.p384=Hc.secp384r1;Hc.p521=Hc.secp521r1;function Hg(t){this.curveType=Hc[t],this.curveType||(this.curveType={name:t}),this.curve=new X9e.ec(this.curveType.name),this.keys=void 0}Hg.prototype.generateKeys=function(t,e){return this.keys=this.curve.genKeyPair(),this.getPublicKey(t,e)};Hg.prototype.computeSecret=function(t,e,r){e=e||"utf8",M.Buffer.isBuffer(t)||(t=new M.Buffer(t,e));var n=this.curve.keyFromPublic(t).getPublic(),i=n.mul(this.keys.getPrivate()).getX();return pC(i,r,this.curveType.byteLength)};Hg.prototype.getPublicKey=function(t,e){var r=this.keys.getPublic(e==="compressed",!0);return e==="hybrid"&&(r[r.length-1]%2?r[0]=7:r[0]=6),pC(r,t)};Hg.prototype.getPrivateKey=function(t){return pC(this.keys.getPrivate(),t)};Hg.prototype.setPublicKey=function(t,e){return e=e||"utf8",M.Buffer.isBuffer(t)||(t=new M.Buffer(t,e)),this.keys._importPublic(t),this};Hg.prototype.setPrivateKey=function(t,e){e=e||"utf8",M.Buffer.isBuffer(t)||(t=new M.Buffer(t,e));var r=new Q9e(t);return r=r.toString(16),this.keys=this.curve.genKeyPair(),this.keys._importPrivate(r),this};function pC(t,e,r){Array.isArray(t)||(t=t.toArray());var n=new M.Buffer(t);if(r&&n.length<r){var i=new M.Buffer(r-n.length);i.fill(0),n=M.Buffer.concat([i,n])}return e?n.toString(e):n}});var mC=W((R1t,sie)=>{f();var eOe=Qw(),yC=ur().Buffer;sie.exports=function(t,e){for(var r=yC.alloc(0),n=0,i;r.length<e;)i=tOe(n++),r=yC.concat([r,eOe("sha1").update(t).update(i).digest()]);return r.slice(0,e)};function tOe(t){var e=yC.allocUnsafe(4);return e.writeUInt32BE(t,0),e}});var gC=W((O1t,aie)=>{f();aie.exports=function(e,r){for(var n=e.length,i=-1;++i<n;)e[i]^=r[i];return e}});var vC=W((D1t,die)=>{f();var cie=Do(),rOe=ur().Buffer;function nOe(t,e){return rOe.from(t.toRed(cie.mont(e.modulus)).redPow(new cie(e.publicExponent)).fromRed().toArray())}die.exports=nOe});var hie=W((j1t,fie)=>{f();var iOe=ZE(),bC=bg(),oOe=Qw(),uie=mC(),lie=gC(),wC=Do(),sOe=vC(),aOe=vA(),Vu=ur().Buffer;fie.exports=function(e,r,n){var i;e.padding?i=e.padding:n?i=1:i=4;var o=iOe(e),s;if(i===4)s=cOe(o,r);else if(i===1)s=dOe(o,r,n);else if(i===3){if(s=new wC(r),s.cmp(o.modulus)>=0)throw new Error("data too long for modulus")}else throw new Error("unknown padding");return n?aOe(s,o):sOe(s,o)};function cOe(t,e){var r=t.modulus.byteLength(),n=e.length,i=oOe("sha1").update(Vu.alloc(0)).digest(),o=i.length,s=2*o;if(n>r-s-2)throw new Error("message too long");var a=Vu.alloc(r-n-s-2),d=r-o-1,u=bC(o),c=lie(Vu.concat([i,a,Vu.alloc(1,1),e],d),uie(u,d)),l=lie(u,uie(c,o));return new wC(Vu.concat([Vu.alloc(1),l,c],r))}function dOe(t,e,r){var n=e.length,i=t.modulus.byteLength();if(n>i-11)throw new Error("message too long");var o;return r?o=Vu.alloc(i-n-3,255):o=uOe(i-n-3),new wC(Vu.concat([Vu.from([0,r?1:2]),o,Vu.alloc(1),e],i))}function uOe(t){for(var e=Vu.allocUnsafe(t),r=0,n=bC(t*2),i=0,o;r<t;)i===n.length&&(n=bC(t*2),i=0),o=n[i++],o&&(e[r++]=o);return e}});var vie=W((N1t,gie)=>{f();var lOe=ZE(),pie=mC(),yie=gC(),mie=Do(),fOe=vA(),hOe=Qw(),pOe=vC(),t6=ur().Buffer;gie.exports=function(e,r,n){var i;e.padding?i=e.padding:n?i=1:i=4;var o=lOe(e),s=o.modulus.byteLength();if(r.length>s||new mie(r).cmp(o.modulus)>=0)throw new Error("decryption error");var a;n?a=pOe(new mie(r),o):a=fOe(r,o);var d=t6.alloc(s-a.length);if(a=t6.concat([d,a],s),i===4)return yOe(o,a);if(i===1)return mOe(o,a,n);if(i===3)return a;throw new Error("unknown padding")};function yOe(t,e){var r=t.modulus.byteLength(),n=hOe("sha1").update(t6.alloc(0)).digest(),i=n.length;if(e[0]!==0)throw new Error("decryption error");var o=e.slice(1,i+1),s=e.slice(i+1),a=yie(o,pie(s,i)),d=yie(s,pie(a,r-i-1));if(gOe(n,d.slice(0,i)))throw new Error("decryption error");for(var u=i;d[u]===0;)u++;if(d[u++]!==1)throw new Error("decryption error");return d.slice(u)}function mOe(t,e,r){for(var n=e.slice(0,2),i=2,o=0;e[i++]!==0;)if(i>=e.length){o++;break}var s=e.slice(2,i-1);if((n.toString("hex")!=="0002"&&!r||n.toString("hex")!=="0001"&&r)&&o++,s.length<8&&o++,o)throw new Error("decryption error");return e.slice(i)}function gOe(t,e){t=t6.from(t),e=t6.from(e);var r=0,n=t.length;t.length!==e.length&&(r++,n=Math.min(t.length,e.length));for(var i=-1;++i<n;)r+=t[i]^e[i];return r}});var bie=W(Wg=>{f();Wg.publicEncrypt=hie();Wg.privateDecrypt=vie();Wg.privateEncrypt=function(e,r){return Wg.publicEncrypt(e,r,!0)};Wg.publicDecrypt=function(e,r){return Wg.privateDecrypt(e,r,!0)}});var Iie=W(r6=>{"use strict";f();function wie(){throw new Error(`secure random number generation not supported by this browser
use chrome, FireFox or Internet Explorer 11`)}var xie=ur(),_ie=bg(),Eie=xie.Buffer,Sie=xie.kMaxLength,_C=globalThis.crypto||globalThis.msCrypto,Tie=Math.pow(2,32)-1;function Aie(t,e){if(typeof t!="number"||t!==t)throw new TypeError("offset must be a number");if(t>Tie||t<0)throw new TypeError("offset must be a uint32");if(t>Sie||t>e)throw new RangeError("offset out of range")}function kie(t,e,r){if(typeof t!="number"||t!==t)throw new TypeError("size must be a number");if(t>Tie||t<0)throw new TypeError("size must be a uint32");if(t+e>r||t>Sie)throw new RangeError("buffer too small")}_C&&_C.getRandomValues||!I.default.browser?(r6.randomFill=vOe,r6.randomFillSync=bOe):(r6.randomFill=wie,r6.randomFillSync=wie);function vOe(t,e,r,n){if(!Eie.isBuffer(t)&&!(t instanceof globalThis.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');if(typeof e=="function")n=e,e=0,r=t.length;else if(typeof r=="function")n=r,r=t.length-e;else if(typeof n!="function")throw new TypeError('"cb" argument must be a function');return Aie(e,t.length),kie(r,e,t.length),Pie(t,e,r,n)}function Pie(t,e,r,n){if(I.default.browser){var i=t.buffer,o=new Uint8Array(i,e,r);if(_C.getRandomValues(o),n){I.default.nextTick(function(){n(null,t)});return}return t}if(n){_ie(r,function(a,d){if(a)return n(a);d.copy(t,e),n(null,t)});return}var s=_ie(r);return s.copy(t,e),t}function bOe(t,e,r){if(typeof e>"u"&&(e=0),!Eie.isBuffer(t)&&!(t instanceof globalThis.Uint8Array))throw new TypeError('"buf" argument must be a Buffer or Uint8Array');return Aie(e,t.length),r===void 0&&(r=t.length-e),kie(r,e,t.length),Pie(t,e,r)}});var iA=W(lr=>{"use strict";f();lr.randomBytes=lr.rng=lr.pseudoRandomBytes=lr.prng=bg();lr.createHash=lr.Hash=Qw();lr.createHmac=lr.Hmac=x7();var wOe=nQ(),_Oe=Object.keys(wOe),xOe=["sha1","sha224","sha256","sha384","sha512","md5","rmd160"].concat(_Oe);lr.getHashes=function(){return xOe};var Rie=O7();lr.pbkdf2=Rie.pbkdf2;lr.pbkdf2Sync=Rie.pbkdf2Sync;var rf=Tee();lr.Cipher=rf.Cipher;lr.createCipher=rf.createCipher;lr.Cipheriv=rf.Cipheriv;lr.createCipheriv=rf.createCipheriv;lr.Decipher=rf.Decipher;lr.createDecipher=rf.createDecipher;lr.Decipheriv=rf.Decipheriv;lr.createDecipheriv=rf.createDecipheriv;lr.getCiphers=rf.getCiphers;lr.listCiphers=rf.listCiphers;var n6=Nee();lr.DiffieHellmanGroup=n6.DiffieHellmanGroup;lr.createDiffieHellmanGroup=n6.createDiffieHellmanGroup;lr.getDiffieHellman=n6.getDiffieHellman;lr.createDiffieHellman=n6.createDiffieHellman;lr.DiffieHellman=n6.DiffieHellman;var VA=nie();lr.createSign=VA.createSign;lr.Sign=VA.Sign;lr.createVerify=VA.createVerify;lr.Verify=VA.Verify;lr.createECDH=oie();var HA=bie();lr.publicEncrypt=HA.publicEncrypt;lr.privateEncrypt=HA.privateEncrypt;lr.publicDecrypt=HA.publicDecrypt;lr.privateDecrypt=HA.privateDecrypt;var Bie=Iie();lr.randomFill=Bie.randomFill;lr.randomFillSync=Bie.randomFillSync;lr.createCredentials=function(){throw new Error(["sorry, createCredentials is not implemented yet","we accept pull requests","https://github.com/crypto-browserify/crypto-browserify"].join(`
`))};lr.constants={DH_CHECK_P_NOT_SAFE_PRIME:2,DH_CHECK_P_NOT_PRIME:1,DH_UNABLE_TO_CHECK_GENERATOR:4,DH_NOT_SUITABLE_GENERATOR:8,NPN_ENABLED:1,ALPN_ENABLED:1,RSA_PKCS1_PADDING:1,RSA_SSLV23_PADDING:2,RSA_NO_PADDING:3,RSA_PKCS1_OAEP_PADDING:4,RSA_X931_PADDING:5,RSA_PKCS1_PSS_PADDING:6,POINT_CONVERSION_COMPRESSED:2,POINT_CONVERSION_UNCOMPRESSED:4,POINT_CONVERSION_HYBRID:6}});var Hu=W(fr=>{"use strict";f();Object.defineProperty(fr,"__esModule",{value:!0});fr.setBigUint64=fr.Hash=fr.equalBytes=fr.ensureBytes=fr.checkOpts=fr.concatBytes=fr.toBytes=fr.bytesToUtf8=fr.utf8ToBytes=fr.asyncLoop=fr.nextTick=fr.hexToBytes=fr.bytesToHex=fr.isLE=fr.createView=fr.u32=fr.u16=fr.u8=void 0;var EC=t=>t instanceof Uint8Array,EOe=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength);fr.u8=EOe;var SOe=t=>new Uint16Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/2));fr.u16=SOe;var TOe=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));fr.u32=TOe;var AOe=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);fr.createView=AOe;fr.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!fr.isLE)throw new Error("Non little-endian hardware is not supported");var kOe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function POe(t){if(!EC(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=kOe[t[r]];return e}fr.bytesToHex=POe;function IOe(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let r=new Uint8Array(e/2);for(let n=0;n<r.length;n++){let i=n*2,o=t.slice(i,i+2),s=Number.parseInt(o,16);if(Number.isNaN(s)||s<0)throw new Error("Invalid byte sequence");r[n]=s}return r}fr.hexToBytes=IOe;var ROe=async()=>{};fr.nextTick=ROe;async function BOe(t,e,r){let n=Date.now();for(let i=0;i<t;i++){r(i);let o=Date.now()-n;o>=0&&o<e||(await(0,fr.nextTick)(),n+=o)}}fr.asyncLoop=BOe;function Oie(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}fr.utf8ToBytes=Oie;function OOe(t){return new TextDecoder().decode(t)}fr.bytesToUtf8=OOe;function MOe(t){if(typeof t=="string"&&(t=Oie(t)),!EC(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}fr.toBytes=MOe;function DOe(...t){let e=new Uint8Array(t.reduce((n,i)=>n+i.length,0)),r=0;return t.forEach(n=>{if(!EC(n))throw new Error("Uint8Array expected");e.set(n,r),r+=n.length}),e}fr.concatBytes=DOe;var COe=t=>Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object;function jOe(t,e){if(e!==void 0&&(typeof e!="object"||!COe(e)))throw new Error("options must be object or undefined");return Object.assign(t,e)}fr.checkOpts=jOe;function $Oe(t,e){if(!(t instanceof Uint8Array))throw new Error("Uint8Array expected");if(typeof e=="number"&&t.length!==e)throw new Error(`Uint8Array length ${e} expected`)}fr.ensureBytes=$Oe;function NOe(t,e){if(t.length!==e.length)throw new Error("equalBytes: Different size of Uint8Arrays");let r=!0;for(let n=0;n<t.length;n++)r&&(r=t[n]===e[n]);return r}fr.equalBytes=NOe;var xC=class{};fr.Hash=xC;function UOe(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),d=n?4:0,u=n?0:4;t.setUint32(e+d,s,n),t.setUint32(e+u,a,n)}fr.setBigUint64=UOe});var i6=W(oa=>{"use strict";f();Object.defineProperty(oa,"__esModule",{value:!0});oa.AEAD_TAG_LENGTH=oa.XCHACHA20_NONCE_LENGTH=oa.CURVE25519_PUBLIC_KEY_SIZE=oa.ETH_PUBLIC_KEY_SIZE=oa.UNCOMPRESSED_PUBLIC_KEY_SIZE=oa.COMPRESSED_PUBLIC_KEY_SIZE=oa.SECRET_KEY_LENGTH=void 0;oa.SECRET_KEY_LENGTH=32;oa.COMPRESSED_PUBLIC_KEY_SIZE=33;oa.UNCOMPRESSED_PUBLIC_KEY_SIZE=65;oa.ETH_PUBLIC_KEY_SIZE=64;oa.CURVE25519_PUBLIC_KEY_SIZE=32;oa.XCHACHA20_NONCE_LENGTH=24;oa.AEAD_TAG_LENGTH=16});var Gg=W(Xn=>{"use strict";f();Object.defineProperty(Xn,"__esModule",{value:!0});Xn.ephemeralKeySize=Xn.symmetricNonceLength=Xn.symmetricAlgorithm=Xn.isHkdfKeyCompressed=Xn.isEphemeralKeyCompressed=Xn.ellipticCurve=Xn.ECIES_CONFIG=void 0;var WA=i6(),KOe=function(){function t(){this.ellipticCurve="secp256k1",this.isEphemeralKeyCompressed=!1,this.isHkdfKeyCompressed=!1,this.symmetricAlgorithm="aes-256-gcm",this.symmetricNonceLength=16}return t}();Xn.ECIES_CONFIG=new KOe;var qOe=function(){return Xn.ECIES_CONFIG.ellipticCurve};Xn.ellipticCurve=qOe;var LOe=function(){return Xn.ECIES_CONFIG.isEphemeralKeyCompressed};Xn.isEphemeralKeyCompressed=LOe;var FOe=function(){return Xn.ECIES_CONFIG.isHkdfKeyCompressed};Xn.isHkdfKeyCompressed=FOe;var zOe=function(){return Xn.ECIES_CONFIG.symmetricAlgorithm};Xn.symmetricAlgorithm=zOe;var VOe=function(){return Xn.ECIES_CONFIG.symmetricNonceLength};Xn.symmetricNonceLength=VOe;var HOe=function(){var t={secp256k1:Xn.ECIES_CONFIG.isEphemeralKeyCompressed?WA.COMPRESSED_PUBLIC_KEY_SIZE:WA.UNCOMPRESSED_PUBLIC_KEY_SIZE,x25519:WA.CURVE25519_PUBLIC_KEY_SIZE,ed25519:WA.CURVE25519_PUBLIC_KEY_SIZE};if(Xn.ECIES_CONFIG.ellipticCurve in t)return t[Xn.ECIES_CONFIG.ellipticCurve];throw new Error("Not implemented")};Xn.ephemeralKeySize=HOe});var Mie=W(GA=>{"use strict";f();Object.defineProperty(GA,"__esModule",{value:!0});GA.crypto=void 0;GA.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var SC=W(P1=>{"use strict";f();Object.defineProperty(P1,"__esModule",{value:!0});P1.getWebcryptoSubtle=P1.randomBytes=void 0;var Jg=Mie();function WOe(t=32){if(Jg.crypto&&typeof Jg.crypto.getRandomValues=="function")return Jg.crypto.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}P1.randomBytes=WOe;function GOe(){if(Jg.crypto&&typeof Jg.crypto.subtle=="object"&&Jg.crypto.subtle!=null)return Jg.crypto.subtle;throw new Error("crypto.subtle must be defined")}P1.getWebcryptoSubtle=GOe});var AC=W(Ma=>{"use strict";f();Object.defineProperty(Ma,"__esModule",{value:!0});Ma.output=Ma.exists=Ma.hash=Ma.bytes=Ma.bool=Ma.number=void 0;function JA(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}Ma.number=JA;function Die(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}Ma.bool=Die;function JOe(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function TC(t,...e){if(!JOe(t))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}Ma.bytes=TC;function Cie(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");JA(t.outputLen),JA(t.blockLen)}Ma.hash=Cie;function jie(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}Ma.exists=jie;function $ie(t,e){TC(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}Ma.output=$ie;var YOe={number:JA,bool:Die,bytes:TC,hash:Cie,exists:jie,output:$ie};Ma.default=YOe});var Nie=W(YA=>{"use strict";f();Object.defineProperty(YA,"__esModule",{value:!0});YA.crypto=void 0;YA.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var zy=W(hr=>{"use strict";f();Object.defineProperty(hr,"__esModule",{value:!0});hr.randomBytes=hr.wrapXOFConstructorWithOpts=hr.wrapConstructorWithOpts=hr.wrapConstructor=hr.checkOpts=hr.Hash=hr.concatBytes=hr.toBytes=hr.utf8ToBytes=hr.asyncLoop=hr.nextTick=hr.hexToBytes=hr.bytesToHex=hr.isLE=hr.rotr=hr.createView=hr.u32=hr.u8=void 0;var kC=Nie(),ZOe=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength);hr.u8=ZOe;var XOe=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));hr.u32=XOe;function IC(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}var QOe=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);hr.createView=QOe;var eMe=(t,e)=>t<<32-e|t>>>e;hr.rotr=eMe;hr.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!hr.isLE)throw new Error("Non little-endian hardware is not supported");var tMe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function rMe(t){if(!IC(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=tMe[t[r]];return e}hr.bytesToHex=rMe;var Uh={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Uie(t){if(t>=Uh._0&&t<=Uh._9)return t-Uh._0;if(t>=Uh._A&&t<=Uh._F)return t-(Uh._A-10);if(t>=Uh._a&&t<=Uh._f)return t-(Uh._a-10)}function nMe(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let i=0,o=0;i<r;i++,o+=2){let s=Uie(t.charCodeAt(o)),a=Uie(t.charCodeAt(o+1));if(s===void 0||a===void 0){let d=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+o)}n[i]=s*16+a}return n}hr.hexToBytes=nMe;var iMe=async()=>{};hr.nextTick=iMe;async function oMe(t,e,r){let n=Date.now();for(let i=0;i<t;i++){r(i);let o=Date.now()-n;o>=0&&o<e||(await(0,hr.nextTick)(),n+=o)}}hr.asyncLoop=oMe;function Kie(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}hr.utf8ToBytes=Kie;function ZA(t){if(typeof t=="string"&&(t=Kie(t)),!IC(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}hr.toBytes=ZA;function sMe(...t){let e=0;for(let n=0;n<t.length;n++){let i=t[n];if(!IC(i))throw new Error("Uint8Array expected");e+=i.length}let r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}hr.concatBytes=sMe;var PC=class{clone(){return this._cloneInto()}};hr.Hash=PC;var aMe={}.toString;function cMe(t,e){if(e!==void 0&&aMe.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(t,e)}hr.checkOpts=cMe;function dMe(t){let e=n=>t().update(ZA(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}hr.wrapConstructor=dMe;function uMe(t){let e=(n,i)=>t(i).update(ZA(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}hr.wrapConstructorWithOpts=uMe;function lMe(t){let e=(n,i)=>t(i).update(ZA(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}hr.wrapXOFConstructorWithOpts=lMe;function fMe(t=32){if(kC.crypto&&typeof kC.crypto.getRandomValues=="function")return kC.crypto.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}hr.randomBytes=fMe});var OC=W(XA=>{"use strict";f();Object.defineProperty(XA,"__esModule",{value:!0});XA.SHA2=void 0;var RC=AC(),o6=zy();function hMe(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),d=n?4:0,u=n?0:4;t.setUint32(e+d,s,n),t.setUint32(e+u,a,n)}var BC=class extends o6.Hash{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,o6.createView)(this.buffer)}update(e){(0,RC.exists)(this);let{view:r,buffer:n,blockLen:i}=this;e=(0,o6.toBytes)(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let d=(0,o6.createView)(e);for(;i<=o-s;s+=i)this.process(d,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,RC.exists)(this),(0,RC.output)(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let l=s;l<i;l++)r[l]=0;hMe(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=(0,o6.createView)(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=d/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)a.setUint32(4*l,c[l],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};XA.SHA2=BC});var coe=W(jt=>{"use strict";f();Object.defineProperty(jt,"__esModule",{value:!0});jt.add5L=jt.add5H=jt.add4H=jt.add4L=jt.add3H=jt.add3L=jt.add=jt.rotlBL=jt.rotlBH=jt.rotlSL=jt.rotlSH=jt.rotr32L=jt.rotr32H=jt.rotrBL=jt.rotrBH=jt.rotrSL=jt.rotrSH=jt.shrSL=jt.shrSH=jt.toBig=jt.split=jt.fromBig=void 0;var QA=BigInt(2**32-1),MC=BigInt(32);function DC(t,e=!1){return e?{h:Number(t&QA),l:Number(t>>MC&QA)}:{h:Number(t>>MC&QA)|0,l:Number(t&QA)|0}}jt.fromBig=DC;function qie(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=DC(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}jt.split=qie;var Lie=(t,e)=>BigInt(t>>>0)<<MC|BigInt(e>>>0);jt.toBig=Lie;var Fie=(t,e,r)=>t>>>r;jt.shrSH=Fie;var zie=(t,e,r)=>t<<32-r|e>>>r;jt.shrSL=zie;var Vie=(t,e,r)=>t>>>r|e<<32-r;jt.rotrSH=Vie;var Hie=(t,e,r)=>t<<32-r|e>>>r;jt.rotrSL=Hie;var Wie=(t,e,r)=>t<<64-r|e>>>r-32;jt.rotrBH=Wie;var Gie=(t,e,r)=>t>>>r-32|e<<64-r;jt.rotrBL=Gie;var Jie=(t,e)=>e;jt.rotr32H=Jie;var Yie=(t,e)=>t;jt.rotr32L=Yie;var Zie=(t,e,r)=>t<<r|e>>>32-r;jt.rotlSH=Zie;var Xie=(t,e,r)=>e<<r|t>>>32-r;jt.rotlSL=Xie;var Qie=(t,e,r)=>e<<r-32|t>>>64-r;jt.rotlBH=Qie;var eoe=(t,e,r)=>t<<r-32|e>>>64-r;jt.rotlBL=eoe;function toe(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}jt.add=toe;var roe=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0);jt.add3L=roe;var noe=(t,e,r,n)=>e+r+n+(t/2**32|0)|0;jt.add3H=noe;var ioe=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0);jt.add4L=ioe;var ooe=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0;jt.add4H=ooe;var soe=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0);jt.add5L=soe;var aoe=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0;jt.add5H=aoe;var pMe={fromBig:DC,split:qie,toBig:Lie,shrSH:Fie,shrSL:zie,rotrSH:Vie,rotrSL:Hie,rotrBH:Wie,rotrBL:Gie,rotr32H:Jie,rotr32L:Yie,rotlSH:Zie,rotlSL:Xie,rotlBH:Qie,rotlBL:eoe,add:toe,add3L:roe,add3H:noe,add4L:ioe,add4H:ooe,add5H:aoe,add5L:soe};jt.default=pMe});var doe=W(qd=>{"use strict";f();Object.defineProperty(qd,"__esModule",{value:!0});qd.sha384=qd.sha512_256=qd.sha512_224=qd.sha512=qd.SHA512=void 0;var yMe=OC(),pr=coe(),e4=zy(),[mMe,gMe]=pr.default.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),Vy=new Uint32Array(80),Hy=new Uint32Array(80),Yg=class extends yMe.SHA2{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:d,Eh:u,El:c,Fh:l,Fl:h,Gh:y,Gl:g,Hh:v,Hl:x}=this;return[e,r,n,i,o,s,a,d,u,c,l,h,y,g,v,x]}set(e,r,n,i,o,s,a,d,u,c,l,h,y,g,v,x){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=d|0,this.Eh=u|0,this.El=c|0,this.Fh=l|0,this.Fl=h|0,this.Gh=y|0,this.Gl=g|0,this.Hh=v|0,this.Hl=x|0}process(e,r){for(let T=0;T<16;T++,r+=4)Vy[T]=e.getUint32(r),Hy[T]=e.getUint32(r+=4);for(let T=16;T<80;T++){let $=Vy[T-15]|0,j=Hy[T-15]|0,K=pr.default.rotrSH($,j,1)^pr.default.rotrSH($,j,8)^pr.default.shrSH($,j,7),F=pr.default.rotrSL($,j,1)^pr.default.rotrSL($,j,8)^pr.default.shrSL($,j,7),L=Vy[T-2]|0,V=Hy[T-2]|0,q=pr.default.rotrSH(L,V,19)^pr.default.rotrBH(L,V,61)^pr.default.shrSH(L,V,6),k=pr.default.rotrSL(L,V,19)^pr.default.rotrBL(L,V,61)^pr.default.shrSL(L,V,6),P=pr.default.add4L(F,k,Hy[T-7],Hy[T-16]),B=pr.default.add4H(P,K,q,Vy[T-7],Vy[T-16]);Vy[T]=B|0,Hy[T]=P|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:d,Dh:u,Dl:c,Eh:l,El:h,Fh:y,Fl:g,Gh:v,Gl:x,Hh:S,Hl:A}=this;for(let T=0;T<80;T++){let $=pr.default.rotrSH(l,h,14)^pr.default.rotrSH(l,h,18)^pr.default.rotrBH(l,h,41),j=pr.default.rotrSL(l,h,14)^pr.default.rotrSL(l,h,18)^pr.default.rotrBL(l,h,41),K=l&y^~l&v,F=h&g^~h&x,L=pr.default.add5L(A,j,F,gMe[T],Hy[T]),V=pr.default.add5H(L,S,$,K,mMe[T],Vy[T]),q=L|0,k=pr.default.rotrSH(n,i,28)^pr.default.rotrBH(n,i,34)^pr.default.rotrBH(n,i,39),P=pr.default.rotrSL(n,i,28)^pr.default.rotrBL(n,i,34)^pr.default.rotrBL(n,i,39),B=n&o^n&a^o&a,p=i&s^i&d^s&d;S=v|0,A=x|0,v=y|0,x=g|0,y=l|0,g=h|0,{h:l,l:h}=pr.default.add(u|0,c|0,V|0,q|0),u=a|0,c=d|0,a=o|0,d=s|0,o=n|0,s=i|0;let m=pr.default.add3L(q,P,p);n=pr.default.add3H(m,V,k,B),i=m|0}({h:n,l:i}=pr.default.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=pr.default.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:d}=pr.default.add(this.Ch|0,this.Cl|0,a|0,d|0),{h:u,l:c}=pr.default.add(this.Dh|0,this.Dl|0,u|0,c|0),{h:l,l:h}=pr.default.add(this.Eh|0,this.El|0,l|0,h|0),{h:y,l:g}=pr.default.add(this.Fh|0,this.Fl|0,y|0,g|0),{h:v,l:x}=pr.default.add(this.Gh|0,this.Gl|0,v|0,x|0),{h:S,l:A}=pr.default.add(this.Hh|0,this.Hl|0,S|0,A|0),this.set(n,i,o,s,a,d,u,c,l,h,y,g,v,x,S,A)}roundClean(){Vy.fill(0),Hy.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};qd.SHA512=Yg;var CC=class extends Yg{constructor(){super(),this.Ah=-1942145080,this.Al=424955298,this.Bh=1944164710,this.Bl=-1982016298,this.Ch=502970286,this.Cl=855612546,this.Dh=1738396948,this.Dl=1479516111,this.Eh=258812777,this.El=2077511080,this.Fh=2011393907,this.Fl=79989058,this.Gh=1067287976,this.Gl=1780299464,this.Hh=286451373,this.Hl=-1848208735,this.outputLen=28}},jC=class extends Yg{constructor(){super(),this.Ah=573645204,this.Al=-64227540,this.Bh=-1621794909,this.Bl=-934517566,this.Ch=596883563,this.Cl=1867755857,this.Dh=-1774684391,this.Dl=1497426621,this.Eh=-1775747358,this.El=-1467023389,this.Fh=-1101128155,this.Fl=1401305490,this.Gh=721525244,this.Gl=746961066,this.Hh=246885852,this.Hl=-2117784414,this.outputLen=32}},$C=class extends Yg{constructor(){super(),this.Ah=-876896931,this.Al=-1056596264,this.Bh=1654270250,this.Bl=914150663,this.Ch=-1856437926,this.Cl=812702999,this.Dh=355462360,this.Dl=-150054599,this.Eh=1731405415,this.El=-4191439,this.Fh=-1900787065,this.Fl=1750603025,this.Gh=-619958771,this.Gl=1694076839,this.Hh=1203062813,this.Hl=-1090891868,this.outputLen=48}};qd.sha512=(0,e4.wrapConstructor)(()=>new Yg);qd.sha512_224=(0,e4.wrapConstructor)(()=>new CC);qd.sha512_256=(0,e4.wrapConstructor)(()=>new jC);qd.sha384=(0,e4.wrapConstructor)(()=>new $C)});var Wu=W(tr=>{"use strict";f();Object.defineProperty(tr,"__esModule",{value:!0});tr.validateObject=tr.createHmacDrbg=tr.bitMask=tr.bitSet=tr.bitGet=tr.bitLen=tr.utf8ToBytes=tr.equalBytes=tr.concatBytes=tr.ensureBytes=tr.numberToVarBytesBE=tr.numberToBytesLE=tr.numberToBytesBE=tr.bytesToNumberLE=tr.bytesToNumberBE=tr.hexToBytes=tr.hexToNumber=tr.numberToHexUnpadded=tr.bytesToHex=tr.isBytes=void 0;var foe=BigInt(0),t4=BigInt(1),vMe=BigInt(2);function I1(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}tr.isBytes=I1;var bMe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function UC(t){if(!I1(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=bMe[t[r]];return e}tr.bytesToHex=UC;function hoe(t){let e=t.toString(16);return e.length&1?`0${e}`:e}tr.numberToHexUnpadded=hoe;function KC(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}tr.hexToNumber=KC;var Kh={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function uoe(t){if(t>=Kh._0&&t<=Kh._9)return t-Kh._0;if(t>=Kh._A&&t<=Kh._F)return t-(Kh._A-10);if(t>=Kh._a&&t<=Kh._f)return t-(Kh._a-10)}function r4(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let i=0,o=0;i<r;i++,o+=2){let s=uoe(t.charCodeAt(o)),a=uoe(t.charCodeAt(o+1));if(s===void 0||a===void 0){let d=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+o)}n[i]=s*16+a}return n}tr.hexToBytes=r4;function wMe(t){return KC(UC(t))}tr.bytesToNumberBE=wMe;function _Me(t){if(!I1(t))throw new Error("Uint8Array expected");return KC(UC(Uint8Array.from(t).reverse()))}tr.bytesToNumberLE=_Me;function poe(t,e){return r4(t.toString(16).padStart(e*2,"0"))}tr.numberToBytesBE=poe;function xMe(t,e){return poe(t,e).reverse()}tr.numberToBytesLE=xMe;function EMe(t){return r4(hoe(t))}tr.numberToVarBytesBE=EMe;function SMe(t,e,r){let n;if(typeof e=="string")try{n=r4(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(I1(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}tr.ensureBytes=SMe;function yoe(...t){let e=0;for(let i=0;i<t.length;i++){let o=t[i];if(!I1(o))throw new Error("Uint8Array expected");e+=o.length}let r=new Uint8Array(e),n=0;for(let i=0;i<t.length;i++){let o=t[i];r.set(o,n),n+=o.length}return r}tr.concatBytes=yoe;function TMe(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}tr.equalBytes=TMe;function AMe(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}tr.utf8ToBytes=AMe;function kMe(t){let e;for(e=0;t>foe;t>>=t4,e+=1);return e}tr.bitLen=kMe;function PMe(t,e){return t>>BigInt(e)&t4}tr.bitGet=PMe;var IMe=(t,e,r)=>t|(r?t4:foe)<<BigInt(e);tr.bitSet=IMe;var RMe=t=>(vMe<<BigInt(t-1))-t4;tr.bitMask=RMe;var NC=t=>new Uint8Array(t),loe=t=>Uint8Array.from(t);function BMe(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=NC(t),i=NC(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...l)=>r(i,n,...l),d=(l=NC())=>{i=a(loe([0]),l),n=a(),l.length!==0&&(i=a(loe([1]),l),n=a())},u=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,h=[];for(;l<e;){n=a();let y=n.slice();h.push(y),l+=n.length}return yoe(...h)};return(l,h)=>{s(),d(l);let y;for(;!(y=h(u()));)d();return s(),y}}tr.createHmacDrbg=BMe;var OMe={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||I1(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function MMe(t,e,r={}){let n=(i,o,s)=>{let a=OMe[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let d=t[i];if(!(s&&d===void 0)&&!a(d,t))throw new Error(`Invalid param ${String(i)}=${d} (${typeof d}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return t}tr.validateObject=MMe});var Gy=W(rr=>{"use strict";f();Object.defineProperty(rr,"__esModule",{value:!0});rr.mapHashToField=rr.getMinHashLength=rr.getFieldBytesLength=rr.hashToPrivateScalar=rr.FpSqrtEven=rr.FpSqrtOdd=rr.Field=rr.nLength=rr.FpIsSquare=rr.FpDiv=rr.FpInvertBatch=rr.FpPow=rr.validateField=rr.isNegativeLE=rr.FpSqrt=rr.tonelliShanks=rr.invert=rr.pow2=rr.pow=rr.mod=void 0;var Gc=Wu(),oo=BigInt(0),Bn=BigInt(1),Wy=BigInt(2),DMe=BigInt(3),qC=BigInt(4),moe=BigInt(5),goe=BigInt(8),CMe=BigInt(9),jMe=BigInt(16);function Wc(t,e){let r=t%e;return r>=oo?r:e+r}rr.mod=Wc;function voe(t,e,r){if(r<=oo||e<oo)throw new Error("Expected power/modulo > 0");if(r===Bn)return oo;let n=Bn;for(;e>oo;)e&Bn&&(n=n*t%r),t=t*t%r,e>>=Bn;return n}rr.pow=voe;function $Me(t,e,r){let n=t;for(;e-- >oo;)n*=n,n%=r;return n}rr.pow2=$Me;function n4(t,e){if(t===oo||e<=oo)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Wc(t,e),n=e,i=oo,o=Bn,s=Bn,a=oo;for(;r!==oo;){let u=n/r,c=n%r,l=i-s*u,h=o-a*u;n=r,r=c,i=s,o=a,s=l,a=h}if(n!==Bn)throw new Error("invert: does not exist");return Wc(i,e)}rr.invert=n4;function boe(t){let e=(t-Bn)/Wy,r,n,i;for(r=t-Bn,n=0;r%Wy===oo;r/=Wy,n++);for(i=Wy;i<t&&voe(i,e,t)!==t-Bn;i++);if(n===1){let s=(t+Bn)/qC;return function(d,u){let c=d.pow(u,s);if(!d.eql(d.sqr(c),u))throw new Error("Cannot find square root");return c}}let o=(r+Bn)/Wy;return function(a,d){if(a.pow(d,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,c=a.pow(a.mul(a.ONE,i),r),l=a.pow(d,o),h=a.pow(d,r);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let y=1;for(let v=a.sqr(h);y<u&&!a.eql(v,a.ONE);y++)v=a.sqr(v);let g=a.pow(c,Bn<<BigInt(u-y-1));c=a.sqr(g),l=a.mul(l,g),h=a.mul(h,c),u=y}return l}}rr.tonelliShanks=boe;function woe(t){if(t%qC===DMe){let e=(t+Bn)/qC;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(t%goe===moe){let e=(t-moe)/goe;return function(n,i){let o=n.mul(i,Wy),s=n.pow(o,e),a=n.mul(i,s),d=n.mul(n.mul(a,Wy),s),u=n.mul(a,n.sub(d,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return t%jMe,boe(t)}rr.FpSqrt=woe;var NMe=(t,e)=>(Wc(t,e)&Bn)===Bn;rr.isNegativeLE=NMe;var UMe=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function KMe(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=UMe.reduce((n,i)=>(n[i]="function",n),e);return(0,Gc.validateObject)(t,r)}rr.validateField=KMe;function _oe(t,e,r){if(r<oo)throw new Error("Expected power > 0");if(r===oo)return t.ONE;if(r===Bn)return e;let n=t.ONE,i=e;for(;r>oo;)r&Bn&&(n=t.mul(n,i)),i=t.sqr(i),r>>=Bn;return n}rr.FpPow=_oe;function xoe(t,e){let r=new Array(e.length),n=e.reduce((o,s,a)=>t.is0(s)?o:(r[a]=o,t.mul(o,s)),t.ONE),i=t.inv(n);return e.reduceRight((o,s,a)=>t.is0(s)?o:(r[a]=t.mul(o,r[a]),t.mul(o,s)),i),r}rr.FpInvertBatch=xoe;function qMe(t,e,r){return t.mul(e,typeof r=="bigint"?n4(r,t.ORDER):t.inv(r))}rr.FpDiv=qMe;function LMe(t){let e=(t.ORDER-Bn)/Wy;return r=>{let n=t.pow(r,e);return t.eql(n,t.ZERO)||t.eql(n,t.ONE)}}rr.FpIsSquare=LMe;function LC(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}rr.nLength=LC;function FMe(t,e,r=!1,n={}){if(t<=oo)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=LC(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=woe(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:(0,Gc.bitMask)(i),ZERO:oo,ONE:Bn,create:d=>Wc(d,t),isValid:d=>{if(typeof d!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof d}`);return oo<=d&&d<t},is0:d=>d===oo,isOdd:d=>(d&Bn)===Bn,neg:d=>Wc(-d,t),eql:(d,u)=>d===u,sqr:d=>Wc(d*d,t),add:(d,u)=>Wc(d+u,t),sub:(d,u)=>Wc(d-u,t),mul:(d,u)=>Wc(d*u,t),pow:(d,u)=>_oe(a,d,u),div:(d,u)=>Wc(d*n4(u,t),t),sqrN:d=>d*d,addN:(d,u)=>d+u,subN:(d,u)=>d-u,mulN:(d,u)=>d*u,inv:d=>n4(d,t),sqrt:n.sqrt||(d=>s(a,d)),invertBatch:d=>xoe(a,d),cmov:(d,u,c)=>c?u:d,toBytes:d=>r?(0,Gc.numberToBytesLE)(d,o):(0,Gc.numberToBytesBE)(d,o),fromBytes:d=>{if(d.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${d.length}`);return r?(0,Gc.bytesToNumberLE)(d):(0,Gc.bytesToNumberBE)(d)}});return Object.freeze(a)}rr.Field=FMe;function zMe(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?r:t.neg(r)}rr.FpSqrtOdd=zMe;function VMe(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}rr.FpSqrtEven=VMe;function HMe(t,e,r=!1){t=(0,Gc.ensureBytes)("privateHash",t);let n=t.length,i=LC(e).nByteLength+8;if(i<24||n<i||n>1024)throw new Error(`hashToPrivateScalar: expected ${i}-1024 bytes of input, got ${n}`);let o=r?(0,Gc.bytesToNumberLE)(t):(0,Gc.bytesToNumberBE)(t);return Wc(o,e-Bn)+Bn}rr.hashToPrivateScalar=HMe;function FC(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}rr.getFieldBytesLength=FC;function Eoe(t){let e=FC(t);return e+Math.ceil(e/2)}rr.getMinHashLength=Eoe;function WMe(t,e,r=!1){let n=t.length,i=FC(e),o=Eoe(e);if(n<16||n<o||n>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${n}`);let s=r?(0,Gc.bytesToNumberBE)(t):(0,Gc.bytesToNumberLE)(t),a=Wc(s,e-Bn)+Bn;return r?(0,Gc.numberToBytesLE)(a,i):(0,Gc.numberToBytesBE)(a,i)}rr.mapHashToField=WMe});var VC=W(R1=>{"use strict";f();Object.defineProperty(R1,"__esModule",{value:!0});R1.validateBasic=R1.wNAF=void 0;var Soe=Gy(),GMe=Wu(),JMe=BigInt(0),zC=BigInt(1);function YMe(t,e){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=t.ZERO,a=i;for(;o>JMe;)o&zC&&(s=s.add(a)),a=a.double(),o>>=zC;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),d=[],u=i,c=u;for(let l=0;l<s;l++){c=u,d.push(c);for(let h=1;h<a;h++)c=c.add(u),d.push(c);u=c.double()}return d},wNAF(i,o,s){let{windows:a,windowSize:d}=n(i),u=t.ZERO,c=t.BASE,l=BigInt(2**i-1),h=2**i,y=BigInt(i);for(let g=0;g<a;g++){let v=g*d,x=Number(s&l);s>>=y,x>d&&(x-=h,s+=zC);let S=v,A=v+Math.abs(x)-1,T=g%2!==0,$=x<0;x===0?c=c.add(r(T,o[S])):u=u.add(r($,o[A]))}return{p:u,f:c}},wNAFCached(i,o,s,a){let d=i._WINDOW_SIZE||1,u=o.get(i);return u||(u=this.precomputeWindow(i,d),d!==1&&o.set(i,a(u))),this.wNAF(d,u,s)}}}R1.wNAF=YMe;function ZMe(t){return(0,Soe.validateField)(t.Fp),(0,GMe.validateObject)(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...(0,Soe.nLength)(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}R1.validateBasic=ZMe});var Aoe=W(o4=>{"use strict";f();Object.defineProperty(o4,"__esModule",{value:!0});o4.twistedEdwards=void 0;var XMe=Gy(),qh=Wu(),Jy=Wu(),Toe=VC(),Gu=BigInt(0),Jc=BigInt(1),i4=BigInt(2),QMe=BigInt(8),e7e={zip215:!0};function t7e(t){let e=(0,Toe.validateBasic)(t);return qh.validateObject(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function r7e(t){let e=t7e(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:d}=e,u=i4<<BigInt(a*8)-Jc,c=r.create,l=e.uvRatio||((_,b)=>{try{return{isValid:!0,value:r.sqrt(_*r.inv(b))}}catch{return{isValid:!1,value:Gu}}}),h=e.adjustScalarBytes||(_=>_),y=e.domain||((_,b,C)=>{if(b.length||C)throw new Error("Contexts/pre-hash are not supported");return _}),g=_=>typeof _=="bigint"&&Gu<_,v=(_,b)=>g(_)&&g(b)&&_<b,x=_=>_===Gu||v(_,u);function S(_,b){if(v(_,b))return _;throw new Error(`Expected valid scalar < ${b}, got ${typeof _} ${_}`)}function A(_){return _===Gu?_:S(_,n)}let T=new Map;function $(_){if(!(_ instanceof j))throw new Error("ExtendedPoint expected")}class j{constructor(b,C,N,D){if(this.ex=b,this.ey=C,this.ez=N,this.et=D,!x(b))throw new Error("x required");if(!x(C))throw new Error("y required");if(!x(N))throw new Error("z required");if(!x(D))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(b){if(b instanceof j)throw new Error("extended point not allowed");let{x:C,y:N}=b||{};if(!x(C)||!x(N))throw new Error("invalid affine point");return new j(C,N,Jc,c(C*N))}static normalizeZ(b){let C=r.invertBatch(b.map(N=>N.ez));return b.map((N,D)=>N.toAffine(C[D])).map(j.fromAffine)}_setWindowSize(b){this._WINDOW_SIZE=b,T.delete(this)}assertValidity(){let{a:b,d:C}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:N,ey:D,ez:U,et:G}=this,Y=c(N*N),J=c(D*D),H=c(U*U),X=c(H*H),te=c(Y*b),ne=c(H*c(te+J)),Q=c(X+c(C*c(Y*J)));if(ne!==Q)throw new Error("bad point: equation left != right (1)");let re=c(N*D),ae=c(U*G);if(re!==ae)throw new Error("bad point: equation left != right (2)")}equals(b){$(b);let{ex:C,ey:N,ez:D}=this,{ex:U,ey:G,ez:Y}=b,J=c(C*Y),H=c(U*D),X=c(N*Y),te=c(G*D);return J===H&&X===te}is0(){return this.equals(j.ZERO)}negate(){return new j(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){let{a:b}=e,{ex:C,ey:N,ez:D}=this,U=c(C*C),G=c(N*N),Y=c(i4*c(D*D)),J=c(b*U),H=C+N,X=c(c(H*H)-U-G),te=J+G,ne=te-Y,Q=J-G,re=c(X*ne),ae=c(te*Q),he=c(X*Q),ge=c(ne*te);return new j(re,ae,ge,he)}add(b){$(b);let{a:C,d:N}=e,{ex:D,ey:U,ez:G,et:Y}=this,{ex:J,ey:H,ez:X,et:te}=b;if(C===BigInt(-1)){let St=c((U-D)*(H+J)),Fe=c((U+D)*(H-J)),mt=c(Fe-St);if(mt===Gu)return this.double();let In=c(G*i4*te),Pe=c(Y*i4*X),Te=Pe+In,Wt=Fe+St,Re=Pe-In,xe=c(Te*mt),qr=c(Wt*Re),We=c(Te*Re),Ye=c(mt*Wt);return new j(xe,qr,Ye,We)}let ne=c(D*J),Q=c(U*H),re=c(Y*N*te),ae=c(G*X),he=c((D+U)*(J+H)-ne-Q),ge=ae-re,ie=ae+re,pe=c(Q-C*ne),be=c(he*ge),Ue=c(ie*pe),ke=c(he*pe),it=c(ge*ie);return new j(be,Ue,it,ke)}subtract(b){return this.add(b.negate())}wNAF(b){return L.wNAFCached(this,T,b,j.normalizeZ)}multiply(b){let{p:C,f:N}=this.wNAF(S(b,n));return j.normalizeZ([C,N])[0]}multiplyUnsafe(b){let C=A(b);return C===Gu?F:this.equals(F)||C===Jc?this:this.equals(K)?this.wNAF(C).p:L.unsafeLadder(this,C)}isSmallOrder(){return this.multiplyUnsafe(d).is0()}isTorsionFree(){return L.unsafeLadder(this,n).is0()}toAffine(b){let{ex:C,ey:N,ez:D}=this,U=this.is0();b==null&&(b=U?QMe:r.inv(D));let G=c(C*b),Y=c(N*b),J=c(D*b);if(U)return{x:Gu,y:Jc};if(J!==Jc)throw new Error("invZ was invalid");return{x:G,y:Y}}clearCofactor(){let{h:b}=e;return b===Jc?this:this.multiplyUnsafe(b)}static fromHex(b,C=!1){let{d:N,a:D}=e,U=r.BYTES;b=(0,Jy.ensureBytes)("pointHex",b,U);let G=b.slice(),Y=b[U-1];G[U-1]=Y&-129;let J=qh.bytesToNumberLE(G);J===Gu||(C?S(J,u):S(J,r.ORDER));let H=c(J*J),X=c(H-Jc),te=c(N*H-D),{isValid:ne,value:Q}=l(X,te);if(!ne)throw new Error("Point.fromHex: invalid y coordinate");let re=(Q&Jc)===Jc,ae=(Y&128)!==0;if(!C&&Q===Gu&&ae)throw new Error("Point.fromHex: x=0 and x_0=1");return ae!==re&&(Q=c(-Q)),j.fromAffine({x:Q,y:J})}static fromPrivateKey(b){return k(b).point}toRawBytes(){let{x:b,y:C}=this.toAffine(),N=qh.numberToBytesLE(C,r.BYTES);return N[N.length-1]|=b&Jc?128:0,N}toHex(){return qh.bytesToHex(this.toRawBytes())}}j.BASE=new j(e.Gx,e.Gy,Jc,c(e.Gx*e.Gy)),j.ZERO=new j(Gu,Jc,Jc,Gu);let{BASE:K,ZERO:F}=j,L=(0,Toe.wNAF)(j,a*8);function V(_){return(0,XMe.mod)(_,n)}function q(_){return V(qh.bytesToNumberLE(_))}function k(_){let b=a;_=(0,Jy.ensureBytes)("private key",_,b);let C=(0,Jy.ensureBytes)("hashed private key",o(_),2*b),N=h(C.slice(0,b)),D=C.slice(b,2*b),U=q(N),G=K.multiply(U),Y=G.toRawBytes();return{head:N,prefix:D,scalar:U,point:G,pointBytes:Y}}function P(_){return k(_).pointBytes}function B(_=new Uint8Array,...b){let C=qh.concatBytes(...b);return q(o(y(C,(0,Jy.ensureBytes)("context",_),!!i)))}function p(_,b,C={}){_=(0,Jy.ensureBytes)("message",_),i&&(_=i(_));let{prefix:N,scalar:D,pointBytes:U}=k(b),G=B(C.context,N,_),Y=K.multiply(G).toRawBytes(),J=B(C.context,Y,U,_),H=V(G+J*D);A(H);let X=qh.concatBytes(Y,qh.numberToBytesLE(H,r.BYTES));return(0,Jy.ensureBytes)("result",X,a*2)}let m=e7e;function w(_,b,C,N=m){let{context:D,zip215:U}=N,G=r.BYTES;_=(0,Jy.ensureBytes)("signature",_,2*G),b=(0,Jy.ensureBytes)("message",b),i&&(b=i(b));let Y=qh.bytesToNumberLE(_.slice(G,2*G)),J,H,X;try{J=j.fromHex(C,U),H=j.fromHex(_.slice(0,G),U),X=K.multiplyUnsafe(Y)}catch{return!1}if(!U&&J.isSmallOrder())return!1;let te=B(D,H.toRawBytes(),J.toRawBytes(),b);return H.add(J.multiplyUnsafe(te)).subtract(X).clearCofactor().equals(j.ZERO)}return K._setWindowSize(8),{CURVE:e,getPublicKey:P,sign:p,verify:w,ExtendedPoint:j,utils:{getExtendedPublicKey:k,randomPrivateKey:()=>s(r.BYTES),precompute(_=8,b=j.BASE){return b._setWindowSize(_),b.multiply(BigInt(3)),b}}}}o4.twistedEdwards=r7e});var Poe=W(s4=>{"use strict";f();Object.defineProperty(s4,"__esModule",{value:!0});s4.montgomery=void 0;var koe=Gy(),B1=Wu(),s6=BigInt(0),HC=BigInt(1);function n7e(t){return(0,B1.validateObject)(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function i7e(t){let e=n7e(t),{P:r}=e,n=T=>(0,koe.mod)(T,r),i=e.montgomeryBits,o=Math.ceil(i/8),s=e.nByteLength,a=e.adjustScalarBytes||(T=>T),d=e.powPminus2||(T=>(0,koe.pow)(T,r-BigInt(2),r));function u(T,$,j){let K=n(T*($-j));return $=n($-K),j=n(j+K),[$,j]}function c(T){if(typeof T=="bigint"&&s6<=T&&T<r)return T;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let l=(e.a-BigInt(2))/BigInt(4);function h(T,$){let j=c(T),K=c($),F=j,L=HC,V=s6,q=j,k=HC,P=s6,B;for(let m=BigInt(i-1);m>=s6;m--){let w=K>>m&HC;P^=w,B=u(P,L,q),L=B[0],q=B[1],B=u(P,V,k),V=B[0],k=B[1],P=w;let E=L+V,_=n(E*E),b=L-V,C=n(b*b),N=_-C,D=q+k,U=q-k,G=n(U*E),Y=n(D*b),J=G+Y,H=G-Y;q=n(J*J),k=n(F*n(H*H)),L=n(_*C),V=n(N*(_+n(l*N)))}B=u(P,L,q),L=B[0],q=B[1],B=u(P,V,k),V=B[0],k=B[1];let p=d(V);return n(L*p)}function y(T){return(0,B1.numberToBytesLE)(n(T),o)}function g(T){let $=(0,B1.ensureBytes)("u coordinate",T,o);return s===32&&($[31]&=127),(0,B1.bytesToNumberLE)($)}function v(T){let $=(0,B1.ensureBytes)("scalar",T),j=$.length;if(j!==o&&j!==s)throw new Error(`Expected ${o} or ${s} bytes, got ${j}`);return(0,B1.bytesToNumberLE)(a($))}function x(T,$){let j=g($),K=v(T),F=h(j,K);if(F===s6)throw new Error("Invalid private or public key received");return y(F)}let S=y(e.Gu);function A(T){return x(T,S)}return{scalarMult:x,scalarMultBase:A,getSharedSecret:(T,$)=>x(T,$),getPublicKey:T=>A(T),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:S}}s4.montgomery=i7e});var JC=W(Ld=>{"use strict";f();Object.defineProperty(Ld,"__esModule",{value:!0});Ld.createHasher=Ld.isogenyMap=Ld.hash_to_field=Ld.expand_message_xof=Ld.expand_message_xmd=void 0;var o7e=Gy(),Yc=Wu();function s7e(t){if((0,Yc.isBytes)(t))return t;if(typeof t=="string")return(0,Yc.utf8ToBytes)(t);throw new Error("DST must be Uint8Array or string")}var a7e=Yc.bytesToNumberBE;function Yy(t,e){if(t<0||t>=1<<8*e)throw new Error(`bad I2OSP call: value=${t} length=${e}`);let r=Array.from({length:e}).fill(0);for(let n=e-1;n>=0;n--)r[n]=t&255,t>>>=8;return new Uint8Array(r)}function c7e(t,e){let r=new Uint8Array(t.length);for(let n=0;n<t.length;n++)r[n]=t[n]^e[n];return r}function a6(t){if(!(0,Yc.isBytes)(t))throw new Error("Uint8Array expected")}function GC(t){if(!Number.isSafeInteger(t))throw new Error("number expected")}function Ioe(t,e,r,n){a6(t),a6(e),GC(r),e.length>255&&(e=n((0,Yc.concatBytes)((0,Yc.utf8ToBytes)("H2C-OVERSIZE-DST-"),e)));let{outputLen:i,blockLen:o}=n,s=Math.ceil(r/i);if(s>255)throw new Error("Invalid xmd length");let a=(0,Yc.concatBytes)(e,Yy(e.length,1)),d=Yy(0,o),u=Yy(r,2),c=new Array(s),l=n((0,Yc.concatBytes)(d,t,u,Yy(0,1),a));c[0]=n((0,Yc.concatBytes)(l,Yy(1,1),a));for(let y=1;y<=s;y++){let g=[c7e(l,c[y-1]),Yy(y+1,1),a];c[y]=n((0,Yc.concatBytes)(...g))}return(0,Yc.concatBytes)(...c).slice(0,r)}Ld.expand_message_xmd=Ioe;function Roe(t,e,r,n,i){if(a6(t),a6(e),GC(r),e.length>255){let o=Math.ceil(2*n/8);e=i.create({dkLen:o}).update((0,Yc.utf8ToBytes)("H2C-OVERSIZE-DST-")).update(e).digest()}if(r>65535||e.length>255)throw new Error("expand_message_xof: invalid lenInBytes");return i.create({dkLen:r}).update(t).update(Yy(r,2)).update(e).update(Yy(e.length,1)).digest()}Ld.expand_message_xof=Roe;function WC(t,e,r){(0,Yc.validateObject)(r,{DST:"stringOrUint8Array",p:"bigint",m:"isSafeInteger",k:"isSafeInteger",hash:"hash"});let{p:n,k:i,m:o,hash:s,expand:a,DST:d}=r;a6(t),GC(e);let u=s7e(d),c=n.toString(2).length,l=Math.ceil((c+i)/8),h=e*o*l,y;if(a==="xmd")y=Ioe(t,u,h,s);else if(a==="xof")y=Roe(t,u,h,i,s);else if(a==="_internal_pass")y=t;else throw new Error('expand must be "xmd" or "xof"');let g=new Array(e);for(let v=0;v<e;v++){let x=new Array(o);for(let S=0;S<o;S++){let A=l*(S+v*o),T=y.subarray(A,A+l);x[S]=(0,o7e.mod)(a7e(T),n)}g[v]=x}return g}Ld.hash_to_field=WC;function d7e(t,e){let r=e.map(n=>Array.from(n).reverse());return(n,i)=>{let[o,s,a,d]=r.map(u=>u.reduce((c,l)=>t.add(t.mul(c,n),l)));return n=t.div(o,s),i=t.mul(i,t.div(a,d)),{x:n,y:i}}}Ld.isogenyMap=d7e;function u7e(t,e,r){if(typeof e!="function")throw new Error("mapToCurve() must be defined");return{hashToCurve(n,i){let o=WC(n,2,{...r,DST:r.DST,...i}),s=t.fromAffine(e(o[0])),a=t.fromAffine(e(o[1])),d=s.add(a).clearCofactor();return d.assertValidity(),d},encodeToCurve(n,i){let o=WC(n,1,{...r,DST:r.encodeDST,...i}),s=t.fromAffine(e(o[0])).clearCofactor();return s.assertValidity(),s}}}Ld.createHasher=u7e});var Foe=W(Ut=>{"use strict";f();Object.defineProperty(Ut,"__esModule",{value:!0});Ut.hash_to_ristretto255=Ut.hashToRistretto255=Ut.RistrettoPoint=Ut.encodeToCurve=Ut.hashToCurve=Ut.edwardsToMontgomeryPriv=Ut.edwardsToMontgomery=Ut.edwardsToMontgomeryPub=Ut.x25519=Ut.ed25519ph=Ut.ed25519ctx=Ut.ed25519=Ut.ED25519_TORSION_SUBGROUP=void 0;var c4=doe(),c6=zy(),ej=Aoe(),l7e=Poe(),ln=Gy(),Zg=Wu(),$oe=JC(),d6=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),XC=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),f7e=BigInt(0),nf=BigInt(1),a4=BigInt(2),h7e=BigInt(5),Boe=BigInt(10),p7e=BigInt(20),y7e=BigInt(40),Ooe=BigInt(80);function Noe(t){let e=d6,n=t*t%e*t%e,i=(0,ln.pow2)(n,a4,e)*n%e,o=(0,ln.pow2)(i,nf,e)*t%e,s=(0,ln.pow2)(o,h7e,e)*o%e,a=(0,ln.pow2)(s,Boe,e)*s%e,d=(0,ln.pow2)(a,p7e,e)*a%e,u=(0,ln.pow2)(d,y7e,e)*d%e,c=(0,ln.pow2)(u,Ooe,e)*u%e,l=(0,ln.pow2)(c,Ooe,e)*u%e,h=(0,ln.pow2)(l,Boe,e)*s%e;return{pow_p_5_8:(0,ln.pow2)(h,a4,e)*t%e,b2:n}}function Uoe(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function tj(t,e){let r=d6,n=(0,ln.mod)(e*e*e,r),i=(0,ln.mod)(n*n*e,r),o=Noe(t*i).pow_p_5_8,s=(0,ln.mod)(t*n*o,r),a=(0,ln.mod)(e*s*s,r),d=s,u=(0,ln.mod)(s*XC,r),c=a===t,l=a===(0,ln.mod)(-t,r),h=a===(0,ln.mod)(-t*XC,r);return c&&(s=d),(l||h)&&(s=u),(0,ln.isNegativeLE)(s,r)&&(s=(0,ln.mod)(-s,r)),{isValid:c||l,value:s}}Ut.ED25519_TORSION_SUBGROUP=["0100000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac037a","0000000000000000000000000000000000000000000000000000000000000080","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc05","ecffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff7f","26e8958fc2b227b045c3f489f2ef98f0d5dfac05d3c63339b13802886d53fc85","0000000000000000000000000000000000000000000000000000000000000000","c7176a703d4dd84fba3c0b760d10670f2a2053fa2c39ccc64ec7fd7792ac03fa"];var qe=(0,ln.Field)(d6,void 0,!0),u6={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:qe,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:c4.sha512,randomBytes:c6.randomBytes,adjustScalarBytes:Uoe,uvRatio:tj};Ut.ed25519=(0,ej.twistedEdwards)(u6);function Koe(t,e,r){if(e.length>255)throw new Error("Context is too big");return(0,c6.concatBytes)((0,c6.utf8ToBytes)("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}Ut.ed25519ctx=(0,ej.twistedEdwards)({...u6,domain:Koe});Ut.ed25519ph=(0,ej.twistedEdwards)({...u6,domain:Koe,prehash:c4.sha512});Ut.x25519=(0,l7e.montgomery)({P:d6,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{let e=d6,{pow_p_5_8:r,b2:n}=Noe(t);return(0,ln.mod)((0,ln.pow2)(r,BigInt(3),e)*n,e)},adjustScalarBytes:Uoe,randomBytes:c6.randomBytes});function qoe(t){let{y:e}=Ut.ed25519.ExtendedPoint.fromHex(t),r=BigInt(1);return qe.toBytes(qe.create((r+e)*qe.inv(r-e)))}Ut.edwardsToMontgomeryPub=qoe;Ut.edwardsToMontgomery=qoe;function m7e(t){let e=u6.hash(t.subarray(0,32));return u6.adjustScalarBytes(e).subarray(0,32)}Ut.edwardsToMontgomeryPriv=m7e;var g7e=(qe.ORDER+BigInt(3))/BigInt(8),v7e=qe.pow(a4,g7e),Moe=qe.sqrt(qe.neg(qe.ONE)),b7e=(qe.ORDER-BigInt(5))/BigInt(8),Doe=BigInt(486662);function w7e(t){let e=qe.sqr(t);e=qe.mul(e,a4);let r=qe.add(e,qe.ONE),n=qe.neg(Doe),i=qe.sqr(r),o=qe.mul(i,r),s=qe.mul(e,Doe);s=qe.mul(s,n),s=qe.add(s,i),s=qe.mul(s,n);let a=qe.sqr(o);i=qe.sqr(a),a=qe.mul(a,o),a=qe.mul(a,s),i=qe.mul(i,a);let d=qe.pow(i,b7e);d=qe.mul(d,a);let u=qe.mul(d,Moe);i=qe.sqr(d),i=qe.mul(i,o);let c=qe.eql(i,s),l=qe.cmov(u,d,c),h=qe.mul(n,e),y=qe.mul(d,t);y=qe.mul(y,v7e);let g=qe.mul(y,Moe),v=qe.mul(s,e);i=qe.sqr(y),i=qe.mul(i,o);let x=qe.eql(i,v),S=qe.cmov(g,y,x);i=qe.sqr(l),i=qe.mul(i,o);let A=qe.eql(i,s),T=qe.cmov(h,n,A),$=qe.cmov(S,l,A),j=qe.isOdd($);return $=qe.cmov($,qe.neg($),A!==j),{xMn:T,xMd:r,yMn:$,yMd:nf}}var _7e=(0,ln.FpSqrtEven)(qe,qe.neg(BigInt(486664)));function x7e(t){let{xMn:e,xMd:r,yMn:n,yMd:i}=w7e(t),o=qe.mul(e,i);o=qe.mul(o,_7e);let s=qe.mul(r,n),a=qe.sub(e,r),d=qe.add(e,r),u=qe.mul(s,d),c=qe.eql(u,qe.ZERO);o=qe.cmov(o,qe.ZERO,c),s=qe.cmov(s,qe.ONE,c),a=qe.cmov(a,qe.ONE,c),d=qe.cmov(d,qe.ONE,c);let l=qe.invertBatch([s,d]);return{x:qe.mul(o,l[0]),y:qe.mul(a,l[1])}}var Loe=(0,$oe.createHasher)(Ut.ed25519.ExtendedPoint,t=>x7e(t[0]),{DST:"edwards25519_XMD:SHA-512_ELL2_RO_",encodeDST:"edwards25519_XMD:SHA-512_ELL2_NU_",p:qe.ORDER,m:1,k:128,expand:"xmd",hash:c4.sha512});Ut.hashToCurve=Loe.hashToCurve;Ut.encodeToCurve=Loe.encodeToCurve;function YC(t){if(!(t instanceof Ju))throw new Error("RistrettoPoint expected")}var QC=XC,E7e=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),S7e=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),T7e=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),A7e=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952"),Coe=t=>tj(nf,t),k7e=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff"),ZC=t=>Ut.ed25519.CURVE.Fp.create((0,Zg.bytesToNumberLE)(t)&k7e);function joe(t){let{d:e}=Ut.ed25519.CURVE,r=Ut.ed25519.CURVE.Fp.ORDER,n=Ut.ed25519.CURVE.Fp.create,i=n(QC*t*t),o=n((i+nf)*T7e),s=BigInt(-1),a=n((s-e*i)*n(i+e)),{isValid:d,value:u}=tj(o,a),c=n(u*t);(0,ln.isNegativeLE)(c,r)||(c=n(-c)),d||(u=c),d||(s=i);let l=n(s*(i-nf)*A7e-a),h=u*u,y=n((u+u)*a),g=n(l*E7e),v=n(nf-h),x=n(nf+h);return new Ut.ed25519.ExtendedPoint(n(y*x),n(v*g),n(g*x),n(y*v))}var Ju=class t{constructor(e){this.ep=e}static fromAffine(e){return new t(Ut.ed25519.ExtendedPoint.fromAffine(e))}static hashToCurve(e){e=(0,Zg.ensureBytes)("ristrettoHash",e,64);let r=ZC(e.slice(0,32)),n=joe(r),i=ZC(e.slice(32,64)),o=joe(i);return new t(n.add(o))}static fromHex(e){e=(0,Zg.ensureBytes)("ristrettoHex",e,32);let{a:r,d:n}=Ut.ed25519.CURVE,i=Ut.ed25519.CURVE.Fp.ORDER,o=Ut.ed25519.CURVE.Fp.create,s="RistrettoPoint.fromHex: the hex is not valid encoding of RistrettoPoint",a=ZC(e);if(!(0,Zg.equalBytes)((0,Zg.numberToBytesLE)(a,32),e)||(0,ln.isNegativeLE)(a,i))throw new Error(s);let d=o(a*a),u=o(nf+r*d),c=o(nf-r*d),l=o(u*u),h=o(c*c),y=o(r*n*l-h),{isValid:g,value:v}=Coe(o(y*h)),x=o(v*c),S=o(v*x*y),A=o((a+a)*x);(0,ln.isNegativeLE)(A,i)&&(A=o(-A));let T=o(u*S),$=o(A*T);if(!g||(0,ln.isNegativeLE)($,i)||T===f7e)throw new Error(s);return new t(new Ut.ed25519.ExtendedPoint(A,T,nf,$))}toRawBytes(){let{ex:e,ey:r,ez:n,et:i}=this.ep,o=Ut.ed25519.CURVE.Fp.ORDER,s=Ut.ed25519.CURVE.Fp.create,a=s(s(n+r)*s(n-r)),d=s(e*r),u=s(d*d),{value:c}=Coe(s(a*u)),l=s(c*a),h=s(c*d),y=s(l*h*i),g;if((0,ln.isNegativeLE)(i*y,o)){let x=s(r*QC),S=s(e*QC);e=x,r=S,g=s(l*S7e)}else g=h;(0,ln.isNegativeLE)(e*y,o)&&(r=s(-r));let v=s((n-r)*g);return(0,ln.isNegativeLE)(v,o)&&(v=s(-v)),(0,Zg.numberToBytesLE)(v,32)}toHex(){return(0,Zg.bytesToHex)(this.toRawBytes())}toString(){return this.toHex()}equals(e){YC(e);let{ex:r,ey:n}=this.ep,{ex:i,ey:o}=e.ep,s=Ut.ed25519.CURVE.Fp.create,a=s(r*o)===s(n*i),d=s(n*o)===s(r*i);return a||d}add(e){return YC(e),new t(this.ep.add(e.ep))}subtract(e){return YC(e),new t(this.ep.subtract(e.ep))}multiply(e){return new t(this.ep.multiply(e))}multiplyUnsafe(e){return new t(this.ep.multiplyUnsafe(e))}double(){return new t(this.ep.double())}negate(){return new t(this.ep.negate())}};Ut.RistrettoPoint=(Ju.BASE||(Ju.BASE=new Ju(Ut.ed25519.ExtendedPoint.BASE)),Ju.ZERO||(Ju.ZERO=new Ju(Ut.ed25519.ExtendedPoint.ZERO)),Ju);var P7e=(t,e)=>{let r=e.DST,n=typeof r=="string"?(0,c6.utf8ToBytes)(r):r,i=(0,$oe.expand_message_xmd)(t,n,64,c4.sha512);return Ju.hashToCurve(i)};Ut.hashToRistretto255=P7e;Ut.hash_to_ristretto255=Ut.hashToRistretto255});var zoe=W(O1=>{"use strict";f();Object.defineProperty(O1,"__esModule",{value:!0});O1.sha224=O1.sha256=void 0;var I7e=OC(),Fd=zy(),R7e=(t,e,r)=>t&e^~t&r,B7e=(t,e,r)=>t&e^t&r^e&r,O7e=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Zy=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),Xy=new Uint32Array(64),d4=class extends I7e.SHA2{constructor(){super(64,32,8,!1),this.A=Zy[0]|0,this.B=Zy[1]|0,this.C=Zy[2]|0,this.D=Zy[3]|0,this.E=Zy[4]|0,this.F=Zy[5]|0,this.G=Zy[6]|0,this.H=Zy[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:d}=this;return[e,r,n,i,o,s,a,d]}set(e,r,n,i,o,s,a,d){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=d|0}process(e,r){for(let l=0;l<16;l++,r+=4)Xy[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){let h=Xy[l-15],y=Xy[l-2],g=(0,Fd.rotr)(h,7)^(0,Fd.rotr)(h,18)^h>>>3,v=(0,Fd.rotr)(y,17)^(0,Fd.rotr)(y,19)^y>>>10;Xy[l]=v+Xy[l-7]+g+Xy[l-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:d,G:u,H:c}=this;for(let l=0;l<64;l++){let h=(0,Fd.rotr)(a,6)^(0,Fd.rotr)(a,11)^(0,Fd.rotr)(a,25),y=c+h+R7e(a,d,u)+O7e[l]+Xy[l]|0,v=((0,Fd.rotr)(n,2)^(0,Fd.rotr)(n,13)^(0,Fd.rotr)(n,22))+B7e(n,i,o)|0;c=u,u=d,d=a,a=s+y|0,s=o,o=i,i=n,n=y+v|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,d=d+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(n,i,o,s,a,d,u,c)}roundClean(){Xy.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},rj=class extends d4{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};O1.sha256=(0,Fd.wrapConstructor)(()=>new d4);O1.sha224=(0,Fd.wrapConstructor)(()=>new rj)});var ij=W(so=>{"use strict";f();Object.defineProperty(so,"__esModule",{value:!0});so.mapToCurveSimpleSWU=so.SWUFpSqrtRatio=so.weierstrass=so.weierstrassPoints=so.DER=void 0;var M1=Gy(),ai=Wu(),of=Wu(),nj=VC();function M7e(t){let e=(0,nj.validateBasic)(t);ai.validateObject(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:D7e,hexToBytes:C7e}=ai;so.DER={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=so.DER;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:D7e(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=so.DER,r=typeof t=="string"?C7e(t):t;if(!ai.isBytes(r))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=so.DER._parseInt(r.subarray(2)),{d:s,l:a}=so.DER._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let c=u.toString(16);return c.length&1?`0${c}`:c},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),d=r(s);return`30${r(s+o+4)}02${d}${i}02${a}${n}`}};var Yu=BigInt(0),Ti=BigInt(1),Qy=BigInt(2),u4=BigInt(3),Voe=BigInt(4);function Hoe(t){let e=M7e(t),{Fp:r}=e,n=e.toBytes||((g,v,x)=>{let S=v.toAffine();return ai.concatBytes(Uint8Array.from([4]),r.toBytes(S.x),r.toBytes(S.y))}),i=e.fromBytes||(g=>{let v=g.subarray(1),x=r.fromBytes(v.subarray(0,r.BYTES)),S=r.fromBytes(v.subarray(r.BYTES,2*r.BYTES));return{x,y:S}});function o(g){let{a:v,b:x}=e,S=r.sqr(g),A=r.mul(S,g);return r.add(r.add(A,r.mul(g,v)),x)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(g){return typeof g=="bigint"&&Yu<g&&g<e.n}function a(g){if(!s(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function d(g){let{allowedPrivateKeyLengths:v,nByteLength:x,wrapPrivateKey:S,n:A}=e;if(v&&typeof g!="bigint"){if(ai.isBytes(g)&&(g=ai.bytesToHex(g)),typeof g!="string"||!v.includes(g.length))throw new Error("Invalid key");g=g.padStart(x*2,"0")}let T;try{T=typeof g=="bigint"?g:ai.bytesToNumberBE((0,of.ensureBytes)("private key",g,x))}catch{throw new Error(`private key must be ${x} bytes, hex or bigint, not ${typeof g}`)}return S&&(T=M1.mod(T,A)),a(T),T}let u=new Map;function c(g){if(!(g instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(v,x,S){if(this.px=v,this.py=x,this.pz=S,v==null||!r.isValid(v))throw new Error("x required");if(x==null||!r.isValid(x))throw new Error("y required");if(S==null||!r.isValid(S))throw new Error("z required")}static fromAffine(v){let{x,y:S}=v||{};if(!v||!r.isValid(x)||!r.isValid(S))throw new Error("invalid affine point");if(v instanceof l)throw new Error("projective point not allowed");let A=T=>r.eql(T,r.ZERO);return A(x)&&A(S)?l.ZERO:new l(x,S,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){let x=r.invertBatch(v.map(S=>S.pz));return v.map((S,A)=>S.toAffine(x[A])).map(l.fromAffine)}static fromHex(v){let x=l.fromAffine(i((0,of.ensureBytes)("pointHex",v)));return x.assertValidity(),x}static fromPrivateKey(v){return l.BASE.multiply(d(v))}_setWindowSize(v){this._WINDOW_SIZE=v,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:v,y:x}=this.toAffine();if(!r.isValid(v)||!r.isValid(x))throw new Error("bad point: x or y not FE");let S=r.sqr(x),A=o(v);if(!r.eql(S,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:v}=this.toAffine();if(r.isOdd)return!r.isOdd(v);throw new Error("Field doesn't support isOdd")}equals(v){c(v);let{px:x,py:S,pz:A}=this,{px:T,py:$,pz:j}=v,K=r.eql(r.mul(x,j),r.mul(T,A)),F=r.eql(r.mul(S,j),r.mul($,A));return K&&F}negate(){return new l(this.px,r.neg(this.py),this.pz)}double(){let{a:v,b:x}=e,S=r.mul(x,u4),{px:A,py:T,pz:$}=this,j=r.ZERO,K=r.ZERO,F=r.ZERO,L=r.mul(A,A),V=r.mul(T,T),q=r.mul($,$),k=r.mul(A,T);return k=r.add(k,k),F=r.mul(A,$),F=r.add(F,F),j=r.mul(v,F),K=r.mul(S,q),K=r.add(j,K),j=r.sub(V,K),K=r.add(V,K),K=r.mul(j,K),j=r.mul(k,j),F=r.mul(S,F),q=r.mul(v,q),k=r.sub(L,q),k=r.mul(v,k),k=r.add(k,F),F=r.add(L,L),L=r.add(F,L),L=r.add(L,q),L=r.mul(L,k),K=r.add(K,L),q=r.mul(T,$),q=r.add(q,q),L=r.mul(q,k),j=r.sub(j,L),F=r.mul(q,V),F=r.add(F,F),F=r.add(F,F),new l(j,K,F)}add(v){c(v);let{px:x,py:S,pz:A}=this,{px:T,py:$,pz:j}=v,K=r.ZERO,F=r.ZERO,L=r.ZERO,V=e.a,q=r.mul(e.b,u4),k=r.mul(x,T),P=r.mul(S,$),B=r.mul(A,j),p=r.add(x,S),m=r.add(T,$);p=r.mul(p,m),m=r.add(k,P),p=r.sub(p,m),m=r.add(x,A);let w=r.add(T,j);return m=r.mul(m,w),w=r.add(k,B),m=r.sub(m,w),w=r.add(S,A),K=r.add($,j),w=r.mul(w,K),K=r.add(P,B),w=r.sub(w,K),L=r.mul(V,m),K=r.mul(q,B),L=r.add(K,L),K=r.sub(P,L),L=r.add(P,L),F=r.mul(K,L),P=r.add(k,k),P=r.add(P,k),B=r.mul(V,B),m=r.mul(q,m),P=r.add(P,B),B=r.sub(k,B),B=r.mul(V,B),m=r.add(m,B),k=r.mul(P,m),F=r.add(F,k),k=r.mul(w,m),K=r.mul(p,K),K=r.sub(K,k),k=r.mul(p,P),L=r.mul(w,L),L=r.add(L,k),new l(K,F,L)}subtract(v){return this.add(v.negate())}is0(){return this.equals(l.ZERO)}wNAF(v){return y.wNAFCached(this,u,v,x=>{let S=r.invertBatch(x.map(A=>A.pz));return x.map((A,T)=>A.toAffine(S[T])).map(l.fromAffine)})}multiplyUnsafe(v){let x=l.ZERO;if(v===Yu)return x;if(a(v),v===Ti)return this;let{endo:S}=e;if(!S)return y.unsafeLadder(this,v);let{k1neg:A,k1:T,k2neg:$,k2:j}=S.splitScalar(v),K=x,F=x,L=this;for(;T>Yu||j>Yu;)T&Ti&&(K=K.add(L)),j&Ti&&(F=F.add(L)),L=L.double(),T>>=Ti,j>>=Ti;return A&&(K=K.negate()),$&&(F=F.negate()),F=new l(r.mul(F.px,S.beta),F.py,F.pz),K.add(F)}multiply(v){a(v);let x=v,S,A,{endo:T}=e;if(T){let{k1neg:$,k1:j,k2neg:K,k2:F}=T.splitScalar(x),{p:L,f:V}=this.wNAF(j),{p:q,f:k}=this.wNAF(F);L=y.constTimeNegate($,L),q=y.constTimeNegate(K,q),q=new l(r.mul(q.px,T.beta),q.py,q.pz),S=L.add(q),A=V.add(k)}else{let{p:$,f:j}=this.wNAF(x);S=$,A=j}return l.normalizeZ([S,A])[0]}multiplyAndAddUnsafe(v,x,S){let A=l.BASE,T=(j,K)=>K===Yu||K===Ti||!j.equals(A)?j.multiplyUnsafe(K):j.multiply(K),$=T(this,x).add(T(v,S));return $.is0()?void 0:$}toAffine(v){let{px:x,py:S,pz:A}=this,T=this.is0();v==null&&(v=T?r.ONE:r.inv(A));let $=r.mul(x,v),j=r.mul(S,v),K=r.mul(A,v);if(T)return{x:r.ZERO,y:r.ZERO};if(!r.eql(K,r.ONE))throw new Error("invZ was invalid");return{x:$,y:j}}isTorsionFree(){let{h:v,isTorsionFree:x}=e;if(v===Ti)return!0;if(x)return x(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:v,clearCofactor:x}=e;return v===Ti?this:x?x(l,this):this.multiplyUnsafe(e.h)}toRawBytes(v=!0){return this.assertValidity(),n(l,this,v)}toHex(v=!0){return ai.bytesToHex(this.toRawBytes(v))}}l.BASE=new l(e.Gx,e.Gy,r.ONE),l.ZERO=new l(r.ZERO,r.ONE,r.ZERO);let h=e.nBitLength,y=(0,nj.wNAF)(l,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:l,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:s}}so.weierstrassPoints=Hoe;function j7e(t){let e=(0,nj.validateBasic)(t);return ai.validateObject(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function $7e(t){let e=j7e(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(m){return Yu<m&&m<r.ORDER}function a(m){return M1.mod(m,n)}function d(m){return M1.invert(m,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:l,isWithinCurveOrder:h}=Hoe({...e,toBytes(m,w,E){let _=w.toAffine(),b=r.toBytes(_.x),C=ai.concatBytes;return E?C(Uint8Array.from([w.hasEvenY()?2:3]),b):C(Uint8Array.from([4]),b,r.toBytes(_.y))},fromBytes(m){let w=m.length,E=m[0],_=m.subarray(1);if(w===i&&(E===2||E===3)){let b=ai.bytesToNumberBE(_);if(!s(b))throw new Error("Point is not on curve");let C=l(b),N=r.sqrt(C),D=(N&Ti)===Ti;return(E&1)===1!==D&&(N=r.neg(N)),{x:b,y:N}}else if(w===o&&E===4){let b=r.fromBytes(_.subarray(0,r.BYTES)),C=r.fromBytes(_.subarray(r.BYTES,2*r.BYTES));return{x:b,y:C}}else throw new Error(`Point of length ${w} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),y=m=>ai.bytesToHex(ai.numberToBytesBE(m,e.nByteLength));function g(m){let w=n>>Ti;return m>w}function v(m){return g(m)?a(-m):m}let x=(m,w,E)=>ai.bytesToNumberBE(m.slice(w,E));class S{constructor(w,E,_){this.r=w,this.s=E,this.recovery=_,this.assertValidity()}static fromCompact(w){let E=e.nByteLength;return w=(0,of.ensureBytes)("compactSignature",w,E*2),new S(x(w,0,E),x(w,E,2*E))}static fromDER(w){let{r:E,s:_}=so.DER.toSig((0,of.ensureBytes)("DER",w));return new S(E,_)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(w){return new S(this.r,this.s,w)}recoverPublicKey(w){let{r:E,s:_,recovery:b}=this,C=F((0,of.ensureBytes)("msgHash",w));if(b==null||![0,1,2,3].includes(b))throw new Error("recovery id invalid");let N=b===2||b===3?E+e.n:E;if(N>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let D=b&1?"03":"02",U=u.fromHex(D+y(N)),G=d(N),Y=a(-C*G),J=a(_*G),H=u.BASE.multiplyAndAddUnsafe(U,Y,J);if(!H)throw new Error("point at infinify");return H.assertValidity(),H}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new S(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return ai.hexToBytes(this.toDERHex())}toDERHex(){return so.DER.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return ai.hexToBytes(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}let A={isValidPrivateKey(m){try{return c(m),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{let m=M1.getMinHashLength(e.n);return M1.mapHashToField(e.randomBytes(m),e.n)},precompute(m=8,w=u.BASE){return w._setWindowSize(m),w.multiply(BigInt(3)),w}};function T(m,w=!0){return u.fromPrivateKey(m).toRawBytes(w)}function $(m){let w=ai.isBytes(m),E=typeof m=="string",_=(w||E)&&m.length;return w?_===i||_===o:E?_===2*i||_===2*o:m instanceof u}function j(m,w,E=!0){if($(m))throw new Error("first arg must be private key");if(!$(w))throw new Error("second arg must be public key");return u.fromHex(w).multiply(c(m)).toRawBytes(E)}let K=e.bits2int||function(m){let w=ai.bytesToNumberBE(m),E=m.length*8-e.nBitLength;return E>0?w>>BigInt(E):w},F=e.bits2int_modN||function(m){return a(K(m))},L=ai.bitMask(e.nBitLength);function V(m){if(typeof m!="bigint")throw new Error("bigint expected");if(!(Yu<=m&&m<L))throw new Error(`bigint expected < 2^${e.nBitLength}`);return ai.numberToBytesBE(m,e.nByteLength)}function q(m,w,E=k){if(["recovered","canonical"].some(te=>te in E))throw new Error("sign() legacy options not supported");let{hash:_,randomBytes:b}=e,{lowS:C,prehash:N,extraEntropy:D}=E;C==null&&(C=!0),m=(0,of.ensureBytes)("msgHash",m),N&&(m=(0,of.ensureBytes)("prehashed msgHash",_(m)));let U=F(m),G=c(w),Y=[V(G),V(U)];if(D!=null){let te=D===!0?b(r.BYTES):D;Y.push((0,of.ensureBytes)("extraEntropy",te))}let J=ai.concatBytes(...Y),H=U;function X(te){let ne=K(te);if(!h(ne))return;let Q=d(ne),re=u.BASE.multiply(ne).toAffine(),ae=a(re.x);if(ae===Yu)return;let he=a(Q*a(H+ae*G));if(he===Yu)return;let ge=(re.x===ae?0:2)|Number(re.y&Ti),ie=he;return C&&g(he)&&(ie=v(he),ge^=1),new S(ae,ie,ge)}return{seed:J,k2sig:X}}let k={lowS:e.lowS,prehash:!1},P={lowS:e.lowS,prehash:!1};function B(m,w,E=k){let{seed:_,k2sig:b}=q(m,w,E),C=e;return ai.createHmacDrbg(C.hash.outputLen,C.nByteLength,C.hmac)(_,b)}u.BASE._setWindowSize(8);function p(m,w,E,_=P){let b=m;if(w=(0,of.ensureBytes)("msgHash",w),E=(0,of.ensureBytes)("publicKey",E),"strict"in _)throw new Error("options.strict was renamed to lowS");let{lowS:C,prehash:N}=_,D,U;try{if(typeof b=="string"||ai.isBytes(b))try{D=S.fromDER(b)}catch(re){if(!(re instanceof so.DER.Err))throw re;D=S.fromCompact(b)}else if(typeof b=="object"&&typeof b.r=="bigint"&&typeof b.s=="bigint"){let{r:re,s:ae}=b;D=new S(re,ae)}else throw new Error("PARSE");U=u.fromHex(E)}catch(re){if(re.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(C&&D.hasHighS())return!1;N&&(w=e.hash(w));let{r:G,s:Y}=D,J=F(w),H=d(Y),X=a(J*H),te=a(G*H),ne=u.BASE.multiplyAndAddUnsafe(U,X,te)?.toAffine();return ne?a(ne.x)===G:!1}return{CURVE:e,getPublicKey:T,getSharedSecret:j,sign:B,verify:p,ProjectivePoint:u,Signature:S,utils:A}}so.weierstrass=$7e;function Woe(t,e){let r=t.ORDER,n=Yu;for(let g=r-Ti;g%Qy===Yu;g/=Qy)n+=Ti;let i=n,o=Qy<<i-Ti-Ti,s=o*Qy,a=(r-Ti)/s,d=(a-Ti)/Qy,u=s-Ti,c=o,l=t.pow(e,a),h=t.pow(e,(a+Ti)/Qy),y=(g,v)=>{let x=l,S=t.pow(v,u),A=t.sqr(S);A=t.mul(A,v);let T=t.mul(g,A);T=t.pow(T,d),T=t.mul(T,S),S=t.mul(T,v),A=t.mul(T,g);let $=t.mul(A,S);T=t.pow($,c);let j=t.eql(T,t.ONE);S=t.mul(A,h),T=t.mul($,x),A=t.cmov(S,A,j),$=t.cmov(T,$,j);for(let K=i;K>Ti;K--){let F=K-Qy;F=Qy<<F-Ti;let L=t.pow($,F),V=t.eql(L,t.ONE);S=t.mul(A,x),x=t.mul(x,x),L=t.mul($,x),A=t.cmov(S,A,V),$=t.cmov(L,$,V)}return{isValid:j,value:A}};if(t.ORDER%Voe===u4){let g=(t.ORDER-u4)/Voe,v=t.sqrt(t.neg(e));y=(x,S)=>{let A=t.sqr(S),T=t.mul(x,S);A=t.mul(A,T);let $=t.pow(A,g);$=t.mul($,T);let j=t.mul($,v),K=t.mul(t.sqr($),S),F=t.eql(K,x),L=t.cmov(j,$,F);return{isValid:F,value:L}}}return y}so.SWUFpSqrtRatio=Woe;function N7e(t,e){if(M1.validateField(t),!t.isValid(e.A)||!t.isValid(e.B)||!t.isValid(e.Z))throw new Error("mapToCurveSimpleSWU: invalid opts");let r=Woe(t,e.Z);if(!t.isOdd)throw new Error("Fp.isOdd is not implemented!");return n=>{let i,o,s,a,d,u,c,l;i=t.sqr(n),i=t.mul(i,e.Z),o=t.sqr(i),o=t.add(o,i),s=t.add(o,t.ONE),s=t.mul(s,e.B),a=t.cmov(e.Z,t.neg(o),!t.eql(o,t.ZERO)),a=t.mul(a,e.A),o=t.sqr(s),u=t.sqr(a),d=t.mul(u,e.A),o=t.add(o,d),o=t.mul(o,s),u=t.mul(u,a),d=t.mul(u,e.B),o=t.add(o,d),c=t.mul(i,s);let{isValid:h,value:y}=r(o,u);l=t.mul(i,n),l=t.mul(l,y),c=t.cmov(c,s,h),l=t.cmov(l,y,h);let g=t.isOdd(n)===t.isOdd(l);return l=t.cmov(t.neg(l),l,g),c=t.div(c,a),{x:c,y:l}}}so.mapToCurveSimpleSWU=N7e});var Joe=W(Xg=>{"use strict";f();Object.defineProperty(Xg,"__esModule",{value:!0});Xg.hmac=Xg.HMAC=void 0;var l4=AC(),Goe=zy(),l6=class extends Goe.Hash{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,(0,l4.hash)(e);let n=(0,Goe.toBytes)(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return(0,l4.exists)(this),this.iHash.update(e),this}digestInto(e){(0,l4.exists)(this),(0,l4.bytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};Xg.HMAC=l6;var U7e=(t,e,r)=>new l6(t,e).update(r).digest();Xg.hmac=U7e;Xg.hmac.create=(t,e)=>new l6(t,e)});var Xoe=W(D1=>{"use strict";f();Object.defineProperty(D1,"__esModule",{value:!0});D1.createCurve=D1.getHash=void 0;var K7e=Joe(),Yoe=zy(),q7e=ij();function Zoe(t){return{hash:t,hmac:(e,...r)=>(0,K7e.hmac)(t,e,(0,Yoe.concatBytes)(...r)),randomBytes:Yoe.randomBytes}}D1.getHash=Zoe;function L7e(t,e){let r=n=>(0,q7e.weierstrass)({...t,...Zoe(n)});return Object.freeze({...r(e),create:r})}D1.createCurve=L7e});var dse=W(dc=>{"use strict";f();Object.defineProperty(dc,"__esModule",{value:!0});dc.encodeToCurve=dc.hashToCurve=dc.schnorr=dc.secp256k1=void 0;var f4=zoe(),F7e=zy(),No=Gy(),z7e=ij(),sa=Wu(),tse=JC(),V7e=Xoe(),m4=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),h4=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),rse=BigInt(1),p4=BigInt(2),Qoe=(t,e)=>(t+e/p4)/e;function nse(t){let e=m4,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),d=BigInt(88),u=t*t*t%e,c=u*u*t%e,l=(0,No.pow2)(c,r,e)*c%e,h=(0,No.pow2)(l,r,e)*c%e,y=(0,No.pow2)(h,p4,e)*u%e,g=(0,No.pow2)(y,i,e)*y%e,v=(0,No.pow2)(g,o,e)*g%e,x=(0,No.pow2)(v,a,e)*v%e,S=(0,No.pow2)(x,d,e)*x%e,A=(0,No.pow2)(S,a,e)*v%e,T=(0,No.pow2)(A,r,e)*c%e,$=(0,No.pow2)(T,s,e)*g%e,j=(0,No.pow2)($,n,e)*u%e,K=(0,No.pow2)(j,p4,e);if(!em.eql(em.sqr(K),t))throw new Error("Cannot find square root");return K}var em=(0,No.Field)(m4,void 0,void 0,{sqrt:nse});dc.secp256k1=(0,V7e.createCurve)({a:BigInt(0),b:BigInt(7),Fp:em,n:h4,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=h4,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-rse*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=Qoe(o*t,e),d=Qoe(-n*t,e),u=(0,No.mod)(t-a*r-d*i,e),c=(0,No.mod)(-a*n-d*o,e),l=u>s,h=c>s;if(l&&(u=e-u),h&&(c=e-c),u>s||c>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:u,k2neg:h,k2:c}}}},f4.sha256);var g4=BigInt(0),ise=t=>typeof t=="bigint"&&g4<t&&t<m4,H7e=t=>typeof t=="bigint"&&g4<t&&t<h4,ese={};function y4(t,...e){let r=ese[t];if(r===void 0){let n=(0,f4.sha256)(Uint8Array.from(t,i=>i.charCodeAt(0)));r=(0,sa.concatBytes)(n,n),ese[t]=r}return(0,f4.sha256)((0,sa.concatBytes)(r,...e))}var cj=t=>t.toRawBytes(!0).slice(1),sj=t=>(0,sa.numberToBytesBE)(t,32),oj=t=>(0,No.mod)(t,m4),f6=t=>(0,No.mod)(t,h4),dj=dc.secp256k1.ProjectivePoint,W7e=(t,e,r)=>dj.BASE.multiplyAndAddUnsafe(t,e,r);function aj(t){let e=dc.secp256k1.utils.normPrivateKeyToScalar(t),r=dj.fromPrivateKey(e);return{scalar:r.hasEvenY()?e:f6(-e),bytes:cj(r)}}function ose(t){if(!ise(t))throw new Error("bad x: need 0 < x < p");let e=oj(t*t),r=oj(e*t+BigInt(7)),n=nse(r);n%p4!==g4&&(n=oj(-n));let i=new dj(t,n,rse);return i.assertValidity(),i}function sse(...t){return f6((0,sa.bytesToNumberBE)(y4("BIP0340/challenge",...t)))}function G7e(t){return aj(t).bytes}function J7e(t,e,r=(0,F7e.randomBytes)(32)){let n=(0,sa.ensureBytes)("message",t),{bytes:i,scalar:o}=aj(e),s=(0,sa.ensureBytes)("auxRand",r,32),a=sj(o^(0,sa.bytesToNumberBE)(y4("BIP0340/aux",s))),d=y4("BIP0340/nonce",a,i,n),u=f6((0,sa.bytesToNumberBE)(d));if(u===g4)throw new Error("sign failed: k is zero");let{bytes:c,scalar:l}=aj(u),h=sse(c,i,n),y=new Uint8Array(64);if(y.set(c,0),y.set(sj(f6(l+h*o)),32),!ase(y,n,i))throw new Error("sign: Invalid signature produced");return y}function ase(t,e,r){let n=(0,sa.ensureBytes)("signature",t,64),i=(0,sa.ensureBytes)("message",e),o=(0,sa.ensureBytes)("publicKey",r,32);try{let s=ose((0,sa.bytesToNumberBE)(o)),a=(0,sa.bytesToNumberBE)(n.subarray(0,32));if(!ise(a))return!1;let d=(0,sa.bytesToNumberBE)(n.subarray(32,64));if(!H7e(d))return!1;let u=sse(sj(a),cj(s),i),c=W7e(s,d,f6(-u));return!(!c||!c.hasEvenY()||c.toAffine().x!==a)}catch{return!1}}dc.schnorr={getPublicKey:G7e,sign:J7e,verify:ase,utils:{randomPrivateKey:dc.secp256k1.utils.randomPrivateKey,lift_x:ose,pointToBytes:cj,numberToBytesBE:sa.numberToBytesBE,bytesToNumberBE:sa.bytesToNumberBE,taggedHash:y4,mod:No.mod}};var Y7e=(0,tse.isogenyMap)(em,[["0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa8c7","0x7d3d4c80bc321d5b9f315cea7fd44c5d595d2fc0bf63b92dfff1044f17c6581","0x534c328d23f234e6e2a413deca25caece4506144037c40314ecbd0b53d9dd262","0x8e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38e38daaaaa88c"],["0xd35771193d94918a9ca34ccbb7b640dd86cd409542f8487d9fe6b745781eb49b","0xedadc6f64383dc1df7c4b2d51b54225406d36b641f5e41bbc52a56612a8c6d14","0x0000000000000000000000000000000000000000000000000000000000000001"],["0x4bda12f684bda12f684bda12f684bda12f684bda12f684bda12f684b8e38e23c","0xc75e0c32d5cb7c0fa9d0a54b12a0a6d5647ab046d686da6fdffc90fc201d71a3","0x29a6194691f91a73715209ef6512e576722830a201be2018a765e85a9ecee931","0x2f684bda12f684bda12f684bda12f684bda12f684bda12f684bda12f38e38d84"],["0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffff93b","0x7a06534bb8bdb49fd5e9e6632722c2989467c1bfc8e8d978dfb425d2685c2573","0x6484aa716545ca2cf3a70c3fa8fe337e0a3d21162f0d6299a7bf8192bfd2a76f","0x0000000000000000000000000000000000000000000000000000000000000001"]].map(t=>t.map(e=>BigInt(e)))),Z7e=(0,z7e.mapToCurveSimpleSWU)(em,{A:BigInt("0x3f8731abdd661adca08a5558f0f5d272e953d363cb6f0e5d405447c01a444533"),B:BigInt("1771"),Z:em.create(BigInt("-11"))}),cse=(0,tse.createHasher)(dc.secp256k1.ProjectivePoint,t=>{let{x:e,y:r}=Z7e(em.create(t[0]));return Y7e(e,r)},{DST:"secp256k1_XMD:SHA-256_SSWU_RO_",encodeDST:"secp256k1_XMD:SHA-256_SSWU_NU_",p:em.ORDER,m:1,k:128,expand:"xmd",hash:f4.sha256});dc.hashToCurve=cse.hashToCurve;dc.encodeToCurve=cse.encodeToCurve});var uj=W(C1=>{"use strict";f();Object.defineProperty(C1,"__esModule",{value:!0});C1.decodeHex=C1.remove0x=void 0;var X7e=Hu();function use(t){return t.startsWith("0x")||t.startsWith("0X")?t.slice(2):t}C1.remove0x=use;function Q7e(t){return(0,X7e.hexToBytes)(use(t))}C1.decodeHex=Q7e});var fj=W(Da=>{"use strict";f();Object.defineProperty(Da,"__esModule",{value:!0});Da.output=Da.exists=Da.hash=Da.bytes=Da.bool=Da.number=void 0;function v4(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}Da.number=v4;function lse(t){if(typeof t!="boolean")throw new Error(`Expected boolean, not ${t}`)}Da.bool=lse;function lj(t,...e){if(!(t instanceof Uint8Array))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}Da.bytes=lj;function fse(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("hash must be wrapped by utils.wrapConstructor");v4(t.outputLen),v4(t.blockLen)}Da.hash=fse;function hse(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}Da.exists=hse;function pse(t,e){lj(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}Da.output=pse;var eDe={number:v4,bool:lse,bytes:lj,hash:fse,exists:hse,output:pse};Da.default=eDe});var mse=W(j1=>{"use strict";f();Object.defineProperty(j1,"__esModule",{value:!0});j1.poly1305=j1.wrapConstructorWithKey=void 0;var b4=Hu(),hj=fj(),us=(t,e)=>t[e++]&255|(t[e++]&255)<<8,pj=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=(0,b4.toBytes)(e),(0,b4.ensureBytes)(e,32);let r=us(e,0),n=us(e,2),i=us(e,4),o=us(e,6),s=us(e,8),a=us(e,10),d=us(e,12),u=us(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|o<<9)&8191,this.r[4]=(o>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|a<<2)&8191,this.r[7]=(a>>>11|d<<5)&8065,this.r[8]=(d>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let c=0;c<8;c++)this.pad[c]=us(e,16+2*c)}process(e,r,n=!1){let i=n?0:2048,{h:o,r:s}=this,a=s[0],d=s[1],u=s[2],c=s[3],l=s[4],h=s[5],y=s[6],g=s[7],v=s[8],x=s[9],S=us(e,r+0),A=us(e,r+2),T=us(e,r+4),$=us(e,r+6),j=us(e,r+8),K=us(e,r+10),F=us(e,r+12),L=us(e,r+14),V=o[0]+(S&8191),q=o[1]+((S>>>13|A<<3)&8191),k=o[2]+((A>>>10|T<<6)&8191),P=o[3]+((T>>>7|$<<9)&8191),B=o[4]+(($>>>4|j<<12)&8191),p=o[5]+(j>>>1&8191),m=o[6]+((j>>>14|K<<2)&8191),w=o[7]+((K>>>11|F<<5)&8191),E=o[8]+((F>>>8|L<<8)&8191),_=o[9]+(L>>>5|i),b=0,C=b+V*a+q*(5*x)+k*(5*v)+P*(5*g)+B*(5*y);b=C>>>13,C&=8191,C+=p*(5*h)+m*(5*l)+w*(5*c)+E*(5*u)+_*(5*d),b+=C>>>13,C&=8191;let N=b+V*d+q*a+k*(5*x)+P*(5*v)+B*(5*g);b=N>>>13,N&=8191,N+=p*(5*y)+m*(5*h)+w*(5*l)+E*(5*c)+_*(5*u),b+=N>>>13,N&=8191;let D=b+V*u+q*d+k*a+P*(5*x)+B*(5*v);b=D>>>13,D&=8191,D+=p*(5*g)+m*(5*y)+w*(5*h)+E*(5*l)+_*(5*c),b+=D>>>13,D&=8191;let U=b+V*c+q*u+k*d+P*a+B*(5*x);b=U>>>13,U&=8191,U+=p*(5*v)+m*(5*g)+w*(5*y)+E*(5*h)+_*(5*l),b+=U>>>13,U&=8191;let G=b+V*l+q*c+k*u+P*d+B*a;b=G>>>13,G&=8191,G+=p*(5*x)+m*(5*v)+w*(5*g)+E*(5*y)+_*(5*h),b+=G>>>13,G&=8191;let Y=b+V*h+q*l+k*c+P*u+B*d;b=Y>>>13,Y&=8191,Y+=p*a+m*(5*x)+w*(5*v)+E*(5*g)+_*(5*y),b+=Y>>>13,Y&=8191;let J=b+V*y+q*h+k*l+P*c+B*u;b=J>>>13,J&=8191,J+=p*d+m*a+w*(5*x)+E*(5*v)+_*(5*g),b+=J>>>13,J&=8191;let H=b+V*g+q*y+k*h+P*l+B*c;b=H>>>13,H&=8191,H+=p*u+m*d+w*a+E*(5*x)+_*(5*v),b+=H>>>13,H&=8191;let X=b+V*v+q*g+k*y+P*h+B*l;b=X>>>13,X&=8191,X+=p*c+m*u+w*d+E*a+_*(5*x),b+=X>>>13,X&=8191;let te=b+V*x+q*v+k*g+P*y+B*h;b=te>>>13,te&=8191,te+=p*l+m*c+w*u+E*d+_*a,b+=te>>>13,te&=8191,b=(b<<2)+b|0,b=b+C|0,C=b&8191,b=b>>>13,N+=b,o[0]=C,o[1]=N,o[2]=D,o[3]=U,o[4]=G,o[5]=Y,o[6]=J,o[7]=H,o[8]=X,o[9]=te}finalize(){let{h:e,pad:r}=this,n=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let o=(i^1)-1;for(let a=0;a<10;a++)n[a]&=o;o=~o;for(let a=0;a<10;a++)e[a]=e[a]&o|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let s=e[0]+r[0];e[0]=s&65535;for(let a=1;a<8;a++)s=(e[a]+r[a]|0)+(s>>>16)|0,e[a]=s&65535}update(e){hj.default.exists(this);let{buffer:r,blockLen:n}=this;e=(0,b4.toBytes)(e);let i=e.length;for(let o=0;o<i;){let s=Math.min(n-this.pos,i-o);if(s===n){for(;n<=i-o;o+=n)this.process(e,o);continue}r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){hj.default.exists(this),hj.default.output(e,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let o=0;for(let s=0;s<8;s++)e[o++]=n[s]>>>0,e[o++]=n[s]>>>8;return e}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}};function yse(t){let e=(n,i)=>t(i).update((0,b4.toBytes)(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}j1.wrapConstructorWithKey=yse;j1.poly1305=yse(t=>new pj(t))});var gse=W(_4=>{"use strict";f();Object.defineProperty(_4,"__esModule",{value:!0});_4.salsaBasic=void 0;var sf=fj(),af=Hu(),tDe=(0,af.utf8ToBytes)("expand 16-byte k"),rDe=(0,af.utf8ToBytes)("expand 32-byte k"),nDe=(0,af.u32)(tDe),iDe=(0,af.u32)(rDe),w4=t=>!(t.byteOffset%4),oDe=t=>{let{core:e,rounds:r,counterRight:n,counterLen:i,allow128bitKeys:o,extendNonceFn:s,blockLen:a}=(0,af.checkOpts)({rounds:20,counterRight:!1,counterLen:8,allow128bitKeys:!0,blockLen:64},t);sf.default.number(i),sf.default.number(r),sf.default.number(a),sf.default.bool(n),sf.default.bool(o);let d=a/4;if(a%4!==0)throw new Error("Salsa/ChaCha: blockLen must be aligned to 4 bytes");return(u,c,l,h,y=0)=>{if(sf.default.bytes(u),sf.default.bytes(c),sf.default.bytes(l),h||(h=new Uint8Array(l.length)),sf.default.bytes(h),sf.default.number(y),y<0||y>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");if(h.length<l.length)throw new Error(`Salsa/ChaCha: output (${h.length}) is shorter than data (${l.length})`);let g=[],v,x;if(u.length===32)w4(u)?v=u:(v=u.slice(),g.push(v)),x=iDe;else if(u.length===16&&o)v=new Uint8Array(32),v.set(u),v.set(u,16),x=nDe,g.push(v);else throw new Error(`Salsa/ChaCha: invalid 32-byte key, got length=${u.length}`);if(w4(c)||(c=c.slice(),g.push(c)),s){if(c.length<=16)throw new Error("Salsa/ChaCha: extended nonce must be bigger than 16 bytes");v=s(x,v,c.subarray(0,16),new Uint8Array(32)),g.push(v),c=c.subarray(16)}let S=16-i;if(c.length!==S)throw new Error(`Salsa/ChaCha: nonce must be ${S} or 16 bytes`);if(S!==12){let V=new Uint8Array(12);V.set(c,n?0:12-c.length),g.push(c=V)}let A=new Uint8Array(a),T=(0,af.u32)(A),$=(0,af.u32)(v),j=(0,af.u32)(c),K=w4(l)&&(0,af.u32)(l),F=w4(h)&&(0,af.u32)(h);g.push(T);let L=l.length;for(let V=0,q=y;V<L;q++){if(e(x,$,j,T,q,r),q>=2**32-1)throw new Error("Salsa/ChaCha: counter overflow");let k=Math.min(a,L-V);if(k===a&&F&&K){let P=V/4;if(V%4!==0)throw new Error("Salsa/ChaCha: invalid block position");for(let B=0;B<d;B++)F[P+B]=K[P+B]^T[B];V+=a;continue}for(let P=0;P<k;P++)h[V+P]=l[V+P]^A[P];V+=k}for(let V=0;V<g.length;V++)g[V].fill(0);return h}};_4.salsaBasic=oDe});var _se=W(Qn=>{"use strict";f();Object.defineProperty(Qn,"__esModule",{value:!0});Qn.xchacha20poly1305=Qn.chacha20poly1305=Qn._poly1305_aead=Qn.chacha12=Qn.chacha8=Qn.xchacha20=Qn.chacha20=Qn.chacha20orig=Qn.hchacha=void 0;var Zu=Hu(),sDe=mse(),h6=gse(),et=(t,e)=>t<<e|t>>>32-e;function p6(t,e,r,n,i,o=20){let s=t[0],a=t[1],d=t[2],u=t[3],c=e[0],l=e[1],h=e[2],y=e[3],g=e[4],v=e[5],x=e[6],S=e[7],A=i,T=r[0],$=r[1],j=r[2],K=s,F=a,L=d,V=u,q=c,k=l,P=h,B=y,p=g,m=v,w=x,E=S,_=A,b=T,C=$,N=j;for(let U=0;U<o;U+=2)K=K+q|0,_=et(_^K,16),p=p+_|0,q=et(q^p,12),K=K+q|0,_=et(_^K,8),p=p+_|0,q=et(q^p,7),F=F+k|0,b=et(b^F,16),m=m+b|0,k=et(k^m,12),F=F+k|0,b=et(b^F,8),m=m+b|0,k=et(k^m,7),L=L+P|0,C=et(C^L,16),w=w+C|0,P=et(P^w,12),L=L+P|0,C=et(C^L,8),w=w+C|0,P=et(P^w,7),V=V+B|0,N=et(N^V,16),E=E+N|0,B=et(B^E,12),V=V+B|0,N=et(N^V,8),E=E+N|0,B=et(B^E,7),K=K+k|0,N=et(N^K,16),w=w+N|0,k=et(k^w,12),K=K+k|0,N=et(N^K,8),w=w+N|0,k=et(k^w,7),F=F+P|0,_=et(_^F,16),E=E+_|0,P=et(P^E,12),F=F+P|0,_=et(_^F,8),E=E+_|0,P=et(P^E,7),L=L+B|0,b=et(b^L,16),p=p+b|0,B=et(B^p,12),L=L+B|0,b=et(b^L,8),p=p+b|0,B=et(B^p,7),V=V+q|0,C=et(C^V,16),m=m+C|0,q=et(q^m,12),V=V+q|0,C=et(C^V,8),m=m+C|0,q=et(q^m,7);let D=0;n[D++]=s+K|0,n[D++]=a+F|0,n[D++]=d+L|0,n[D++]=u+V|0,n[D++]=c+q|0,n[D++]=l+k|0,n[D++]=h+P|0,n[D++]=y+B|0,n[D++]=g+p|0,n[D++]=v+m|0,n[D++]=x+w|0,n[D++]=S+E|0,n[D++]=A+_|0,n[D++]=T+b|0,n[D++]=$+C|0,n[D++]=j+N|0}function wse(t,e,r,n){let i=(0,Zu.u32)(e),o=(0,Zu.u32)(r),s=(0,Zu.u32)(n),a=t[0],d=t[1],u=t[2],c=t[3],l=i[0],h=i[1],y=i[2],g=i[3],v=i[4],x=i[5],S=i[6],A=i[7],T=o[0],$=o[1],j=o[2],K=o[3];for(let F=0;F<20;F+=2)a=a+l|0,T=et(T^a,16),v=v+T|0,l=et(l^v,12),a=a+l|0,T=et(T^a,8),v=v+T|0,l=et(l^v,7),d=d+h|0,$=et($^d,16),x=x+$|0,h=et(h^x,12),d=d+h|0,$=et($^d,8),x=x+$|0,h=et(h^x,7),u=u+y|0,j=et(j^u,16),S=S+j|0,y=et(y^S,12),u=u+y|0,j=et(j^u,8),S=S+j|0,y=et(y^S,7),c=c+g|0,K=et(K^c,16),A=A+K|0,g=et(g^A,12),c=c+g|0,K=et(K^c,8),A=A+K|0,g=et(g^A,7),a=a+h|0,K=et(K^a,16),S=S+K|0,h=et(h^S,12),a=a+h|0,K=et(K^a,8),S=S+K|0,h=et(h^S,7),d=d+y|0,T=et(T^d,16),A=A+T|0,y=et(y^A,12),d=d+y|0,T=et(T^d,8),A=A+T|0,y=et(y^A,7),u=u+g|0,$=et($^u,16),v=v+$|0,g=et(g^v,12),u=u+g|0,$=et($^u,8),v=v+$|0,g=et(g^v,7),c=c+l|0,j=et(j^c,16),x=x+j|0,l=et(l^x,12),c=c+l|0,j=et(j^c,8),x=x+j|0,l=et(l^x,7);return s[0]=a,s[1]=d,s[2]=u,s[3]=c,s[4]=T,s[5]=$,s[6]=j,s[7]=K,n}Qn.hchacha=wse;Qn.chacha20orig=(0,h6.salsaBasic)({core:p6,counterRight:!1,counterLen:8});Qn.chacha20=(0,h6.salsaBasic)({core:p6,counterRight:!1,counterLen:4,allow128bitKeys:!1});Qn.xchacha20=(0,h6.salsaBasic)({core:p6,counterRight:!1,counterLen:8,extendNonceFn:wse,allow128bitKeys:!1});Qn.chacha8=(0,h6.salsaBasic)({core:p6,counterRight:!1,counterLen:4,rounds:8});Qn.chacha12=(0,h6.salsaBasic)({core:p6,counterRight:!1,counterLen:4,rounds:12});var aDe=new Uint8Array(16),vse=(t,e)=>{t.update(e);let r=e.length%16;r&&t.update(aDe.subarray(r))},bse=(t,e,r,n,i)=>{let o=t(e,r,new Uint8Array(32)),s=sDe.poly1305.create(o);i&&vse(s,i),vse(s,n);let a=new Uint8Array(16),d=(0,Zu.createView)(a);(0,Zu.setBigUint64)(d,0,BigInt(i?i.length:0),!0),(0,Zu.setBigUint64)(d,8,BigInt(n.length),!0),s.update(a);let u=s.digest();return o.fill(0),u},cDe=t=>(e,r,n)=>((0,Zu.ensureBytes)(e,32),(0,Zu.ensureBytes)(r),{tagLength:16,encrypt:(o,s)=>{let a=o.length,d=a+16;s?(0,Zu.ensureBytes)(s,d):s=new Uint8Array(d),t(e,r,o,s,1);let u=bse(t,e,r,s.subarray(0,-16),n);return s.set(u,a),s},decrypt:(o,s)=>{let a=o.length,d=a-16;if(a<16)throw new Error("encrypted data must be at least 16 bytes");s?(0,Zu.ensureBytes)(s,d):s=new Uint8Array(d);let u=o.subarray(0,-16),c=o.subarray(-16),l=bse(t,e,r,u,n);if(!(0,Zu.equalBytes)(c,l))throw new Error("invalid tag");return t(e,r,u,s,1),s}});Qn._poly1305_aead=cDe;Qn.chacha20poly1305=(0,Qn._poly1305_aead)(Qn.chacha20);Qn.xchacha20poly1305=(0,Qn._poly1305_aead)(Qn.xchacha20)});var y6=W(ls=>{"use strict";f();Object.defineProperty(ls,"__esModule",{value:!0});ls.output=ls.exists=ls.hash=ls.bytes=ls.bool=ls.number=ls.isBytes=void 0;function x4(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}ls.number=x4;function xse(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}ls.bool=xse;function Ese(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}ls.isBytes=Ese;function yj(t,...e){if(!Ese(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}ls.bytes=yj;function Sse(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");x4(t.outputLen),x4(t.blockLen)}ls.hash=Sse;function Tse(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}ls.exists=Tse;function Ase(t,e){yj(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}ls.output=Ase;var dDe={number:x4,bool:xse,bytes:yj,hash:Sse,exists:Tse,output:Ase};ls.default=dDe});var kse=W(E4=>{"use strict";f();Object.defineProperty(E4,"__esModule",{value:!0});E4.crypto=void 0;E4.crypto=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0});var m6=W(_t=>{"use strict";f();Object.defineProperty(_t,"__esModule",{value:!0});_t.randomBytes=_t.wrapXOFConstructorWithOpts=_t.wrapConstructorWithOpts=_t.wrapConstructor=_t.checkOpts=_t.Hash=_t.concatBytes=_t.toBytes=_t.utf8ToBytes=_t.asyncLoop=_t.nextTick=_t.hexToBytes=_t.bytesToHex=_t.byteSwap32=_t.byteSwapIfBE=_t.byteSwap=_t.isLE=_t.rotl=_t.rotr=_t.createView=_t.u32=_t.u8=_t.isBytes=void 0;var mj=kse(),vj=y6();function uDe(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}_t.isBytes=uDe;var lDe=t=>new Uint8Array(t.buffer,t.byteOffset,t.byteLength);_t.u8=lDe;var fDe=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));_t.u32=fDe;var hDe=t=>new DataView(t.buffer,t.byteOffset,t.byteLength);_t.createView=hDe;var pDe=(t,e)=>t<<32-e|t>>>e;_t.rotr=pDe;var yDe=(t,e)=>t<<e|t>>>32-e>>>0;_t.rotl=yDe;_t.isLE=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;var mDe=t=>t<<24&4278190080|t<<8&16711680|t>>>8&65280|t>>>24&255;_t.byteSwap=mDe;_t.byteSwapIfBE=_t.isLE?t=>t:t=>(0,_t.byteSwap)(t);function gDe(t){for(let e=0;e<t.length;e++)t[e]=(0,_t.byteSwap)(t[e])}_t.byteSwap32=gDe;var vDe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function bDe(t){(0,vj.bytes)(t);let e="";for(let r=0;r<t.length;r++)e+=vDe[t[r]];return e}_t.bytesToHex=bDe;var Lh={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function Pse(t){if(t>=Lh._0&&t<=Lh._9)return t-Lh._0;if(t>=Lh._A&&t<=Lh._F)return t-(Lh._A-10);if(t>=Lh._a&&t<=Lh._f)return t-(Lh._a-10)}function wDe(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let i=0,o=0;i<r;i++,o+=2){let s=Pse(t.charCodeAt(o)),a=Pse(t.charCodeAt(o+1));if(s===void 0||a===void 0){let d=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+o)}n[i]=s*16+a}return n}_t.hexToBytes=wDe;var _De=async()=>{};_t.nextTick=_De;async function xDe(t,e,r){let n=Date.now();for(let i=0;i<t;i++){r(i);let o=Date.now()-n;o>=0&&o<e||(await(0,_t.nextTick)(),n+=o)}}_t.asyncLoop=xDe;function Ise(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}_t.utf8ToBytes=Ise;function S4(t){return typeof t=="string"&&(t=Ise(t)),(0,vj.bytes)(t),t}_t.toBytes=S4;function EDe(...t){let e=0;for(let n=0;n<t.length;n++){let i=t[n];(0,vj.bytes)(i),e+=i.length}let r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}_t.concatBytes=EDe;var gj=class{clone(){return this._cloneInto()}};_t.Hash=gj;var SDe={}.toString;function TDe(t,e){if(e!==void 0&&SDe.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(t,e)}_t.checkOpts=TDe;function ADe(t){let e=n=>t().update(S4(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}_t.wrapConstructor=ADe;function kDe(t){let e=(n,i)=>t(i).update(S4(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}_t.wrapConstructorWithOpts=kDe;function PDe(t){let e=(n,i)=>t(i).update(S4(n)).digest(),r=t({});return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}_t.wrapXOFConstructorWithOpts=PDe;function IDe(t=32){if(mj.crypto&&typeof mj.crypto.getRandomValues=="function")return mj.crypto.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}_t.randomBytes=IDe});var Bse=W(Qg=>{"use strict";f();Object.defineProperty(Qg,"__esModule",{value:!0});Qg.hmac=Qg.HMAC=void 0;var T4=y6(),Rse=m6(),g6=class extends Rse.Hash{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,(0,T4.hash)(e);let n=(0,Rse.toBytes)(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return(0,T4.exists)(this),this.iHash.update(e),this}digestInto(e){(0,T4.exists)(this),(0,T4.bytes)(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}};Qg.HMAC=g6;var RDe=(t,e,r)=>new g6(t,e).update(r).digest();Qg.hmac=RDe;Qg.hmac.create=(t,e)=>new g6(t,e)});var $se=W(tm=>{"use strict";f();Object.defineProperty(tm,"__esModule",{value:!0});tm.hkdf=tm.expand=tm.extract=void 0;var wj=y6(),Ose=m6(),Dse=Bse();function Cse(t,e,r){return(0,wj.hash)(t),r===void 0&&(r=new Uint8Array(t.outputLen)),(0,Dse.hmac)(t,(0,Ose.toBytes)(r),(0,Ose.toBytes)(e))}tm.extract=Cse;var bj=new Uint8Array([0]),Mse=new Uint8Array;function jse(t,e,r,n=32){if((0,wj.hash)(t),(0,wj.number)(n),n>255*t.outputLen)throw new Error("Length should be <= 255*HashLen");let i=Math.ceil(n/t.outputLen);r===void 0&&(r=Mse);let o=new Uint8Array(i*t.outputLen),s=Dse.hmac.create(t,e),a=s._cloneInto(),d=new Uint8Array(s.outputLen);for(let u=0;u<i;u++)bj[0]=u+1,a.update(u===0?Mse:d).update(r).update(bj).digestInto(d),o.set(d,t.outputLen*u),s._cloneInto(a);return s.destroy(),a.destroy(),d.fill(0),bj.fill(0),o.slice(0,n)}tm.expand=jse;var BDe=(t,e,r,n,i)=>jse(t,Cse(t,e,r),n,i);tm.hkdf=BDe});var Nse=W(rm=>{"use strict";f();Object.defineProperty(rm,"__esModule",{value:!0});rm.HashMD=rm.Maj=rm.Chi=void 0;var _j=y6(),v6=m6();function ODe(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),d=n?4:0,u=n?0:4;t.setUint32(e+d,s,n),t.setUint32(e+u,a,n)}var MDe=(t,e,r)=>t&e^~t&r;rm.Chi=MDe;var DDe=(t,e,r)=>t&e^t&r^e&r;rm.Maj=DDe;var xj=class extends v6.Hash{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=(0,v6.createView)(this.buffer)}update(e){(0,_j.exists)(this);let{view:r,buffer:n,blockLen:i}=this;e=(0,v6.toBytes)(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let d=(0,v6.createView)(e);for(;i<=o-s;s+=i)this.process(d,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){(0,_j.exists)(this),(0,_j.output)(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let l=s;l<i;l++)r[l]=0;ODe(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=(0,v6.createView)(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=d/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)a.setUint32(4*l,c[l],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};rm.HashMD=xj});var Use=W($1=>{"use strict";f();Object.defineProperty($1,"__esModule",{value:!0});$1.sha224=$1.sha256=void 0;var Ej=Nse(),zd=m6(),CDe=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),nm=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),im=new Uint32Array(64),A4=class extends Ej.HashMD{constructor(){super(64,32,8,!1),this.A=nm[0]|0,this.B=nm[1]|0,this.C=nm[2]|0,this.D=nm[3]|0,this.E=nm[4]|0,this.F=nm[5]|0,this.G=nm[6]|0,this.H=nm[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:d}=this;return[e,r,n,i,o,s,a,d]}set(e,r,n,i,o,s,a,d){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=d|0}process(e,r){for(let l=0;l<16;l++,r+=4)im[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){let h=im[l-15],y=im[l-2],g=(0,zd.rotr)(h,7)^(0,zd.rotr)(h,18)^h>>>3,v=(0,zd.rotr)(y,17)^(0,zd.rotr)(y,19)^y>>>10;im[l]=v+im[l-7]+g+im[l-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:d,G:u,H:c}=this;for(let l=0;l<64;l++){let h=(0,zd.rotr)(a,6)^(0,zd.rotr)(a,11)^(0,zd.rotr)(a,25),y=c+h+(0,Ej.Chi)(a,d,u)+CDe[l]+im[l]|0,v=((0,zd.rotr)(n,2)^(0,zd.rotr)(n,13)^(0,zd.rotr)(n,22))+(0,Ej.Maj)(n,i,o)|0;c=u,u=d,d=a,a=s+y|0,s=o,o=i,i=n,n=y+v|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,d=d+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(n,i,o,s,a,d,u,c)}roundClean(){im.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}},Sj=class extends A4{constructor(){super(),this.A=-1056596264,this.B=914150663,this.C=812702999,this.D=-150054599,this.E=-4191439,this.F=1750603025,this.G=1694076839,this.H=-1090891868,this.outputLen=28}};$1.sha256=(0,zd.wrapConstructor)(()=>new A4);$1.sha224=(0,zd.wrapConstructor)(()=>new Sj)});var Lse=W(k4=>{"use strict";f();Object.defineProperty(k4,"__esModule",{value:!0});k4.aes256gcm=void 0;var Kse=Hu(),qse=iA(),Tj=i6();function jDe(t,e,r){var n=function(o){var s=(0,qse.createCipheriv)("aes-256-gcm",t,e);r&&s.setAAD(r);var a=s.update(o),d=s.final();return(0,Kse.concatBytes)(a,d,s.getAuthTag())},i=function(o){var s=o.subarray(0,o.length-Tj.AEAD_TAG_LENGTH),a=o.subarray(-Tj.AEAD_TAG_LENGTH),d=(0,qse.createDecipheriv)("aes-256-gcm",t,e);r&&d.setAAD(r),d.setAuthTag(a);var u=d.update(s),c=d.final();return(0,Kse.concatBytes)(u,c)};return{tagLength:Tj.AEAD_TAG_LENGTH,encrypt:n,decrypt:i}}k4.aes256gcm=jDe});var Aj=W(om=>{"use strict";f();Object.defineProperty(om,"__esModule",{value:!0});om.deriveKey=om.aesDecrypt=om.aesEncrypt=void 0;var $De=_se(),zse=Hu(),NDe=SC(),UDe=$se(),KDe=Use(),Fse=Gg(),P4=i6(),qDe=Lse();function LDe(t,e){return Vse(!0,t,e)}om.aesEncrypt=LDe;function FDe(t,e){return Vse(!1,t,e)}om.aesDecrypt=FDe;function zDe(t){return(0,UDe.hkdf)(KDe.sha256,t,void 0,void 0,32)}om.deriveKey=zDe;function Vse(t,e,r){var n=(0,Fse.symmetricAlgorithm)(),i=t?VDe:HDe;if(n==="aes-256-gcm")return i(qDe.aes256gcm,e,r,(0,Fse.symmetricNonceLength)());if(n==="xchacha20")return i($De.xchacha20poly1305,e,r,P4.XCHACHA20_NONCE_LENGTH);throw new Error("Not implemented")}function VDe(t,e,r,n){var i=(0,NDe.randomBytes)(n),o=t(e,i),s=o.encrypt(r),a=s.subarray(0,s.length-P4.AEAD_TAG_LENGTH),d=s.subarray(-P4.AEAD_TAG_LENGTH);return(0,zse.concatBytes)(i,d,a)}function HDe(t,e,r,n){var i=n+P4.AEAD_TAG_LENGTH,o=r.subarray(0,n),s=r.subarray(n,i),a=r.subarray(i),d=t(e,Uint8Array.from(o)),u=(0,zse.concatBytes)(a,s);return d.decrypt(u)}});var Jse=W(aa=>{"use strict";f();Object.defineProperty(aa,"__esModule",{value:!0});aa.hexToPublicKey=aa.convertPublicKeyFormat=aa.getSharedPoint=aa.getSharedKey=aa.getPublicKey=aa.isValidPrivateKey=aa.getValidSecret=void 0;var WDe=Hu(),GDe=SC(),Hse=Foe(),JDe=dse(),kj=Gg(),Wse=i6(),YDe=uj(),ZDe=Aj();function XDe(){var t;do t=(0,GDe.randomBytes)(Wse.SECRET_KEY_LENGTH);while(!Gse(t));return t}aa.getValidSecret=XDe;function Gse(t){return b6(function(e){return e.utils.isValidPrivateKey(t)},function(){return!0},function(){return!0})}aa.isValidPrivateKey=Gse;function QDe(t){return b6(function(e){return e.getPublicKey(t)},function(e){return e.getPublicKey(t)},function(e){return e.getPublicKey(t)})}aa.getPublicKey=QDe;function eCe(t,e){return(0,ZDe.deriveKey)((0,WDe.concatBytes)(t,e))}aa.getSharedKey=eCe;function tCe(t,e,r){return b6(function(n){return n.getSharedSecret(t,e,r)},function(n){return n.getSharedSecret(t,e)},function(n){var i=n.utils.getExtendedPublicKey(t).scalar,o=n.ExtendedPoint.fromHex(e).multiply(i);return o.toRawBytes()})}aa.getSharedPoint=tCe;function rCe(t,e){return b6(function(r){return r.getSharedSecret(BigInt(1),t,e)},function(){return t},function(){return t})}aa.convertPublicKeyFormat=rCe;function nCe(t){var e=(0,YDe.decodeHex)(t);return b6(function(){if(e.length===Wse.ETH_PUBLIC_KEY_SIZE){var r=new Uint8Array(1+e.length);return r.set([4]),r.set(e,1),r}return e},function(){return e},function(){return e})}aa.hexToPublicKey=nCe;function b6(t,e,r){if((0,kj.ellipticCurve)()==="secp256k1")return t(JDe.secp256k1);if((0,kj.ellipticCurve)()==="x25519")return e(Hse.x25519);if((0,kj.ellipticCurve)()==="ed25519")return r(Hse.ed25519);throw new Error("Not implemented")}});var I4=W(Fh=>{"use strict";f();var iCe=Fh&&Fh.__createBinding||(Object.create?function(t,e,r,n){n===void 0&&(n=r);var i=Object.getOwnPropertyDescriptor(e,r);(!i||("get"in i?!e.__esModule:i.writable||i.configurable))&&(i={enumerable:!0,get:function(){return e[r]}}),Object.defineProperty(t,n,i)}:function(t,e,r,n){n===void 0&&(n=r),t[n]=e[r]}),Pj=Fh&&Fh.__exportStar||function(t,e){for(var r in t)r!=="default"&&!Object.prototype.hasOwnProperty.call(e,r)&&iCe(e,t,r)};Object.defineProperty(Fh,"__esModule",{value:!0});Pj(Jse(),Fh);Pj(uj(),Fh);Pj(Aj(),Fh)});var Rj=W(B4=>{"use strict";f();Object.defineProperty(B4,"__esModule",{value:!0});B4.PublicKey=void 0;var Ij=Hu(),oCe=Gg(),R4=I4(),sCe=function(){function t(e){this.data=(0,R4.convertPublicKeyFormat)(e,!0)}return t.fromHex=function(e){return new t((0,R4.hexToPublicKey)(e))},Object.defineProperty(t.prototype,"uncompressed",{get:function(){return M.Buffer.from((0,R4.convertPublicKeyFormat)(this.data,!1))},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"compressed",{get:function(){return M.Buffer.from(this.data)},enumerable:!1,configurable:!0}),t.prototype.toHex=function(e){return e===void 0&&(e=!0),e?(0,Ij.bytesToHex)(this.data):(0,Ij.bytesToHex)(this.uncompressed)},t.prototype.decapsulate=function(e){var r,n;return(0,oCe.isHkdfKeyCompressed)()?(r=this.data,n=e.multiply(this,!0)):(r=this.uncompressed,n=e.multiply(this,!1)),(0,R4.getSharedKey)(r,n)},t.prototype.equals=function(e){return(0,Ij.equalBytes)(this.data,e.data)},t}();B4.PublicKey=sCe});var Zse=W(O4=>{"use strict";f();Object.defineProperty(O4,"__esModule",{value:!0});O4.PrivateKey=void 0;var Yse=Hu(),aCe=Gg(),N1=I4(),cCe=Rj(),dCe=function(){function t(e){var r=e===void 0?(0,N1.getValidSecret)():e;if(!(0,N1.isValidPrivateKey)(r))throw new Error("Invalid private key");this.data=r,this.publicKey=new cCe.PublicKey((0,N1.getPublicKey)(r))}return t.fromHex=function(e){return new t((0,N1.decodeHex)(e))},Object.defineProperty(t.prototype,"secret",{get:function(){return M.Buffer.from(this.data)},enumerable:!1,configurable:!0}),t.prototype.toHex=function(){return(0,Yse.bytesToHex)(this.data)},t.prototype.encapsulate=function(e){var r,n;return(0,aCe.isHkdfKeyCompressed)()?(r=this.publicKey.compressed,n=this.multiply(e,!0)):(r=this.publicKey.uncompressed,n=this.multiply(e,!1)),(0,N1.getSharedKey)(r,n)},t.prototype.multiply=function(e,r){return r===void 0&&(r=!1),(0,N1.getSharedPoint)(this.data,e.compressed,r)},t.prototype.equals=function(e){return(0,Yse.equalBytes)(this.data,e.data)},t}();O4.PrivateKey=dCe});var Bj=W(U1=>{"use strict";f();Object.defineProperty(U1,"__esModule",{value:!0});U1.PublicKey=U1.PrivateKey=void 0;var uCe=Zse();Object.defineProperty(U1,"PrivateKey",{enumerable:!0,get:function(){return uCe.PrivateKey}});var lCe=Rj();Object.defineProperty(U1,"PublicKey",{enumerable:!0,get:function(){return lCe.PublicKey}})});var eae=W(uc=>{"use strict";f();Object.defineProperty(uc,"__esModule",{value:!0});uc.utils=uc.PublicKey=uc.PrivateKey=uc.ECIES_CONFIG=uc.decrypt=uc.encrypt=void 0;var fCe=Hu(),Xse=Gg(),K1=Bj(),ev=I4();function hCe(t,e){var r=new K1.PrivateKey,n=t instanceof Uint8Array?new K1.PublicKey(t):K1.PublicKey.fromHex(t),i=r.encapsulate(n),o=(0,ev.aesEncrypt)(i,e),s;return(0,Xse.isEphemeralKeyCompressed)()?s=r.publicKey.compressed:s=r.publicKey.uncompressed,M.Buffer.from((0,fCe.concatBytes)(s,o))}uc.encrypt=hCe;function pCe(t,e){var r=t instanceof Uint8Array?new K1.PrivateKey(t):K1.PrivateKey.fromHex(t),n=(0,Xse.ephemeralKeySize)(),i=new K1.PublicKey(e.subarray(0,n)),o=e.subarray(n),s=i.decapsulate(r);return M.Buffer.from((0,ev.aesDecrypt)(s,o))}uc.decrypt=pCe;var yCe=Gg();Object.defineProperty(uc,"ECIES_CONFIG",{enumerable:!0,get:function(){return yCe.ECIES_CONFIG}});var Qse=Bj();Object.defineProperty(uc,"PrivateKey",{enumerable:!0,get:function(){return Qse.PrivateKey}});Object.defineProperty(uc,"PublicKey",{enumerable:!0,get:function(){return Qse.PublicKey}});uc.utils={aesDecrypt:ev.aesDecrypt,aesEncrypt:ev.aesEncrypt,decodeHex:ev.decodeHex,getValidSecret:ev.getValidSecret,remove0x:ev.remove0x}});var ci=W((T_t,tae)=>{"use strict";f();tae.exports={ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,e){return t.includes(e)},ArrayPrototypeIndexOf(t,e){return t.indexOf(e)},ArrayPrototypeJoin(t,e){return t.join(e)},ArrayPrototypeMap(t,e){return t.map(e)},ArrayPrototypePop(t,e){return t.pop(e)},ArrayPrototypePush(t,e){return t.push(e)},ArrayPrototypeSlice(t,e,r){return t.slice(e,r)},Error,FunctionPrototypeCall(t,e,...r){return t.call(e,...r)},FunctionPrototypeSymbolHasInstance(t,e){return Function.prototype[Symbol.hasInstance].call(t,e)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,e){return Object.defineProperties(t,e)},ObjectDefineProperty(t,e,r){return Object.defineProperty(t,e,r)},ObjectGetOwnPropertyDescriptor(t,e){return Object.getOwnPropertyDescriptor(t,e)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,e){return Object.setPrototypeOf(t,e)},Promise,PromisePrototypeCatch(t,e){return t.catch(e)},PromisePrototypeThen(t,e,r){return t.then(e,r)},PromiseReject(t){return Promise.reject(t)},PromiseResolve(t){return Promise.resolve(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,e){return t.test(e)},SafeSet:Set,String,StringPrototypeSlice(t,e,r){return t.slice(e,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,SymbolDispose:Symbol.dispose||Symbol("Symbol.dispose"),SymbolAsyncDispose:Symbol.asyncDispose||Symbol("Symbol.asyncDispose"),TypedArrayPrototypeSet(t,e,r){return t.set(e,r)},Boolean,Uint8Array}});var zh=W((k_t,M4)=>{"use strict";f();var{AbortController:rae,AbortSignal:mCe}=typeof self<"u"?self:typeof window<"u"?window:void 0;M4.exports=rae;M4.exports.AbortSignal=mCe;M4.exports.default=rae});var ca=W((I_t,Mj)=>{"use strict";f();var gCe=bn(),{kResistStopPropagation:vCe,SymbolDispose:bCe}=ci(),wCe=globalThis.AbortSignal||zh().AbortSignal,_Ce=globalThis.AbortController||zh().AbortController,xCe=Object.getPrototypeOf(async function(){}).constructor,nae=globalThis.Blob||gCe.Blob,ECe=typeof nae<"u"?function(e){return e instanceof nae}:function(e){return!1},iae=(t,e)=>{if(t!==void 0&&(t===null||typeof t!="object"||!("aborted"in t)))throw new ERR_INVALID_ARG_TYPE(e,"AbortSignal",t)},SCe=(t,e)=>{if(typeof t!="function")throw new ERR_INVALID_ARG_TYPE(e,"Function",t)},Oj=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);let r="";for(let n=0;n<e.length;n++)r+=`    ${e[n].stack}
`;super(r),this.name="AggregateError",this.errors=e}};Mj.exports={AggregateError:Oj,kEmptyObject:Object.freeze({}),once(t){let e=!1;return function(...r){e||(e=!0,t.apply(this,r))}},createDeferredPromise:function(){let t,e;return{promise:new Promise((n,i)=>{t=n,e=i}),resolve:t,reject:e}},promisify(t){return new Promise((e,r)=>{t((n,...i)=>n?r(n):e(...i))})},debuglog(){return function(){}},format(t,...e){return t.replace(/%([sdifj])/g,function(...[r,n]){let i=e.shift();return n==="f"?i.toFixed(6):n==="j"?JSON.stringify(i):n==="s"&&typeof i=="object"?`${i.constructor!==Object?i.constructor.name:""} {}`.trim():i.toString()})},inspect(t){switch(typeof t){case"string":if(t.includes("'"))if(t.includes('"')){if(!t.includes("`")&&!t.includes("${"))return`\`${t}\``}else return`"${t}"`;return`'${t}'`;case"number":return isNaN(t)?"NaN":Object.is(t,-0)?String(t):t;case"bigint":return`${String(t)}n`;case"boolean":case"undefined":return String(t);case"object":return"{}"}},types:{isAsyncFunction(t){return t instanceof xCe},isArrayBufferView(t){return ArrayBuffer.isView(t)}},isBlob:ECe,deprecate(t,e){return t},addAbortListener:Ba().addAbortListener||function(e,r){if(e===void 0)throw new ERR_INVALID_ARG_TYPE("signal","AbortSignal",e);iae(e,"signal"),SCe(r,"listener");let n;return e.aborted?queueMicrotask(()=>r()):(e.addEventListener("abort",r,{__proto__:null,once:!0,[vCe]:!0}),n=()=>{e.removeEventListener("abort",r)}),{__proto__:null,[bCe](){var i;(i=n)===null||i===void 0||i()}}},AbortSignalAny:wCe.any||function(e){if(e.length===1)return e[0];let r=new _Ce,n=()=>r.abort();return e.forEach(i=>{iae(i,"signals"),i.addEventListener("abort",n,{once:!0})}),r.signal.addEventListener("abort",()=>{e.forEach(i=>i.removeEventListener("abort",n))},{once:!0}),r.signal}};Mj.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")});var Ca=W((B_t,aae)=>{"use strict";f();var{format:TCe,inspect:D4,AggregateError:ACe}=ca(),kCe=globalThis.AggregateError||ACe,PCe=Symbol("kIsNodeError"),ICe=["string","function","number","object","Function","Object","boolean","bigint","symbol"],RCe=/^([A-Z][a-z0-9]*)+$/,BCe="__node_internal_",C4={};function tv(t,e){if(!t)throw new C4.ERR_INTERNAL_ASSERTION(e)}function oae(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function OCe(t,e,r){if(typeof e=="function")return tv(e.length<=r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${e.length}).`),e(...r);let n=(e.match(/%[dfijoOs]/g)||[]).length;return tv(n===r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${n}).`),r.length===0?e:TCe(e,...r)}function fs(t,e,r){r||(r=Error);class n extends r{constructor(...o){super(OCe(t,e,o))}toString(){return`${this.name} [${t}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${t}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=t,n.prototype[PCe]=!0,C4[t]=n}function sae(t){let e=BCe+t.name;return Object.defineProperty(t,"name",{value:e}),t}function MCe(t,e){if(t&&e&&t!==e){if(Array.isArray(e.errors))return e.errors.push(t),e;let r=new kCe([e,t],e.message);return r.code=e.code,r}return t||e}var Dj=class extends Error{constructor(e="The operation was aborted",r=void 0){if(r!==void 0&&typeof r!="object")throw new C4.ERR_INVALID_ARG_TYPE("options","Object",r);super(e,r),this.code="ABORT_ERR",this.name="AbortError"}};fs("ERR_ASSERTION","%s",Error);fs("ERR_INVALID_ARG_TYPE",(t,e,r)=>{tv(typeof t=="string","'name' must be a string"),Array.isArray(e)||(e=[e]);let n="The ";t.endsWith(" argument")?n+=`${t} `:n+=`"${t}" ${t.includes(".")?"property":"argument"} `,n+="must be ";let i=[],o=[],s=[];for(let d of e)tv(typeof d=="string","All expected entries have to be of type string"),ICe.includes(d)?i.push(d.toLowerCase()):RCe.test(d)?o.push(d):(tv(d!=="object",'The value "object" should be written as "Object"'),s.push(d));if(o.length>0){let d=i.indexOf("object");d!==-1&&(i.splice(i,d,1),o.push("Object"))}if(i.length>0){switch(i.length){case 1:n+=`of type ${i[0]}`;break;case 2:n+=`one of type ${i[0]} or ${i[1]}`;break;default:{let d=i.pop();n+=`one of type ${i.join(", ")}, or ${d}`}}(o.length>0||s.length>0)&&(n+=" or ")}if(o.length>0){switch(o.length){case 1:n+=`an instance of ${o[0]}`;break;case 2:n+=`an instance of ${o[0]} or ${o[1]}`;break;default:{let d=o.pop();n+=`an instance of ${o.join(", ")}, or ${d}`}}s.length>0&&(n+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(n+="an "),n+=`${s[0]}`;break;case 2:n+=`one of ${s[0]} or ${s[1]}`;break;default:{let d=s.pop();n+=`one of ${s.join(", ")}, or ${d}`}}if(r==null)n+=`. Received ${r}`;else if(typeof r=="function"&&r.name)n+=`. Received function ${r.name}`;else if(typeof r=="object"){var a;if((a=r.constructor)!==null&&a!==void 0&&a.name)n+=`. Received an instance of ${r.constructor.name}`;else{let d=D4(r,{depth:-1});n+=`. Received ${d}`}}else{let d=D4(r,{colors:!1});d.length>25&&(d=`${d.slice(0,25)}...`),n+=`. Received type ${typeof r} (${d})`}return n},TypeError);fs("ERR_INVALID_ARG_VALUE",(t,e,r="is invalid")=>{let n=D4(e);return n.length>128&&(n=n.slice(0,128)+"..."),`The ${t.includes(".")?"property":"argument"} '${t}' ${r}. Received ${n}`},TypeError);fs("ERR_INVALID_RETURN_VALUE",(t,e,r)=>{var n;let i=r!=null&&(n=r.constructor)!==null&&n!==void 0&&n.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${t} to be returned from the "${e}" function but got ${i}.`},TypeError);fs("ERR_MISSING_ARGS",(...t)=>{tv(t.length>0,"At least one arg needs to be specified");let e,r=t.length;switch(t=(Array.isArray(t)?t:[t]).map(n=>`"${n}"`).join(" or "),r){case 1:e+=`The ${t[0]} argument`;break;case 2:e+=`The ${t[0]} and ${t[1]} arguments`;break;default:{let n=t.pop();e+=`The ${t.join(", ")}, and ${n} arguments`}break}return`${e} must be specified`},TypeError);fs("ERR_OUT_OF_RANGE",(t,e,r)=>{tv(e,'Missing "range" argument');let n;return Number.isInteger(r)&&Math.abs(r)>2**32?n=oae(String(r)):typeof r=="bigint"?(n=String(r),(r>2n**32n||r<-(2n**32n))&&(n=oae(n)),n+="n"):n=D4(r),`The value of "${t}" is out of range. It must be ${e}. Received ${n}`},RangeError);fs("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);fs("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);fs("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);fs("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);fs("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);fs("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);fs("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);fs("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);fs("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);fs("ERR_STREAM_WRITE_AFTER_END","write after end",Error);fs("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);aae.exports={AbortError:Dj,aggregateTwoErrors:sae(MCe),hideStackFrames:sae,codes:C4}});var L1=W((M_t,gae)=>{"use strict";f();var{ArrayIsArray:jj,ArrayPrototypeIncludes:lae,ArrayPrototypeJoin:fae,ArrayPrototypeMap:DCe,NumberIsInteger:$j,NumberIsNaN:CCe,NumberMAX_SAFE_INTEGER:jCe,NumberMIN_SAFE_INTEGER:$Ce,NumberParseInt:NCe,ObjectPrototypeHasOwnProperty:UCe,RegExpPrototypeExec:hae,String:KCe,StringPrototypeToUpperCase:qCe,StringPrototypeTrim:LCe}=ci(),{hideStackFrames:Vd,codes:{ERR_SOCKET_BAD_PORT:FCe,ERR_INVALID_ARG_TYPE:da,ERR_INVALID_ARG_VALUE:q1,ERR_OUT_OF_RANGE:rv,ERR_UNKNOWN_SIGNAL:cae}}=Ca(),{normalizeEncoding:zCe}=ca(),{isAsyncFunction:VCe,isArrayBufferView:HCe}=ca().types,dae={};function WCe(t){return t===(t|0)}function GCe(t){return t===t>>>0}var JCe=/^[0-7]+$/,YCe="must be a 32-bit unsigned integer or an octal string";function ZCe(t,e,r){if(typeof t>"u"&&(t=r),typeof t=="string"){if(hae(JCe,t)===null)throw new q1(e,t,YCe);t=NCe(t,8)}return pae(t,e),t}var XCe=Vd((t,e,r=$Ce,n=jCe)=>{if(typeof t!="number")throw new da(e,"number",t);if(!$j(t))throw new rv(e,"an integer",t);if(t<r||t>n)throw new rv(e,`>= ${r} && <= ${n}`,t)}),QCe=Vd((t,e,r=-2147483648,n=2147483647)=>{if(typeof t!="number")throw new da(e,"number",t);if(!$j(t))throw new rv(e,"an integer",t);if(t<r||t>n)throw new rv(e,`>= ${r} && <= ${n}`,t)}),pae=Vd((t,e,r=!1)=>{if(typeof t!="number")throw new da(e,"number",t);if(!$j(t))throw new rv(e,"an integer",t);let n=r?1:0,i=4294967295;if(t<n||t>i)throw new rv(e,`>= ${n} && <= ${i}`,t)});function Nj(t,e){if(typeof t!="string")throw new da(e,"string",t)}function eje(t,e,r=void 0,n){if(typeof t!="number")throw new da(e,"number",t);if(r!=null&&t<r||n!=null&&t>n||(r!=null||n!=null)&&CCe(t))throw new rv(e,`${r!=null?`>= ${r}`:""}${r!=null&&n!=null?" && ":""}${n!=null?`<= ${n}`:""}`,t)}var tje=Vd((t,e,r)=>{if(!lae(r,t)){let i="must be one of: "+fae(DCe(r,o=>typeof o=="string"?`'${o}'`:KCe(o)),", ");throw new q1(e,t,i)}});function yae(t,e){if(typeof t!="boolean")throw new da(e,"boolean",t)}function Cj(t,e,r){return t==null||!UCe(t,e)?r:t[e]}var rje=Vd((t,e,r=null)=>{let n=Cj(r,"allowArray",!1),i=Cj(r,"allowFunction",!1);if(!Cj(r,"nullable",!1)&&t===null||!n&&jj(t)||typeof t!="object"&&(!i||typeof t!="function"))throw new da(e,"Object",t)}),nje=Vd((t,e)=>{if(t!=null&&typeof t!="object"&&typeof t!="function")throw new da(e,"a dictionary",t)}),j4=Vd((t,e,r=0)=>{if(!jj(t))throw new da(e,"Array",t);if(t.length<r){let n=`must be longer than ${r}`;throw new q1(e,t,n)}});function ije(t,e){j4(t,e);for(let r=0;r<t.length;r++)Nj(t[r],`${e}[${r}]`)}function oje(t,e){j4(t,e);for(let r=0;r<t.length;r++)yae(t[r],`${e}[${r}]`)}function sje(t,e){j4(t,e);for(let r=0;r<t.length;r++){let n=t[r],i=`${e}[${r}]`;if(n==null)throw new da(i,"AbortSignal",n);mae(n,i)}}function aje(t,e="signal"){if(Nj(t,e),dae[t]===void 0)throw dae[qCe(t)]!==void 0?new cae(t+" (signals must use all capital letters)"):new cae(t)}var cje=Vd((t,e="buffer")=>{if(!HCe(t))throw new da(e,["Buffer","TypedArray","DataView"],t)});function dje(t,e){let r=zCe(e),n=t.length;if(r==="hex"&&n%2!==0)throw new q1("encoding",e,`is invalid for data of length ${n}`)}function uje(t,e="Port",r=!0){if(typeof t!="number"&&typeof t!="string"||typeof t=="string"&&LCe(t).length===0||+t!==+t>>>0||t>65535||t===0&&!r)throw new FCe(e,t,r);return t|0}var mae=Vd((t,e)=>{if(t!==void 0&&(t===null||typeof t!="object"||!("aborted"in t)))throw new da(e,"AbortSignal",t)}),lje=Vd((t,e)=>{if(typeof t!="function")throw new da(e,"Function",t)}),fje=Vd((t,e)=>{if(typeof t!="function"||VCe(t))throw new da(e,"Function",t)}),hje=Vd((t,e)=>{if(t!==void 0)throw new da(e,"undefined",t)});function pje(t,e,r){if(!lae(r,t))throw new da(e,`('${fae(r,"|")}')`,t)}var yje=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function uae(t,e){if(typeof t>"u"||!hae(yje,t))throw new q1(e,t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function mje(t){if(typeof t=="string")return uae(t,"hints"),t;if(jj(t)){let e=t.length,r="";if(e===0)return r;for(let n=0;n<e;n++){let i=t[n];uae(i,"hints"),r+=i,n!==e-1&&(r+=", ")}return r}throw new q1("hints",t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}gae.exports={isInt32:WCe,isUint32:GCe,parseFileMode:ZCe,validateArray:j4,validateStringArray:ije,validateBooleanArray:oje,validateAbortSignalArray:sje,validateBoolean:yae,validateBuffer:cje,validateDictionary:nje,validateEncoding:dje,validateFunction:lje,validateInt32:QCe,validateInteger:XCe,validateNumber:eje,validateObject:rje,validateOneOf:tje,validatePlainFunction:fje,validatePort:uje,validateSignalName:aje,validateString:Nj,validateUint32:pae,validateUndefined:hje,validateUnion:pje,validateAbortSignal:mae,validateLinkHeaderValue:mje}});var df=W((C_t,Oae)=>{"use strict";f();var{SymbolAsyncIterator:vae,SymbolIterator:bae,SymbolFor:nv}=ci(),wae=nv("nodejs.stream.destroyed"),_ae=nv("nodejs.stream.errored"),Uj=nv("nodejs.stream.readable"),Kj=nv("nodejs.stream.writable"),xae=nv("nodejs.stream.disturbed"),gje=nv("nodejs.webstream.isClosedPromise"),vje=nv("nodejs.webstream.controllerErrorFunction");function $4(t,e=!1){var r;return!!(t&&typeof t.pipe=="function"&&typeof t.on=="function"&&(!e||typeof t.pause=="function"&&typeof t.resume=="function")&&(!t._writableState||((r=t._readableState)===null||r===void 0?void 0:r.readable)!==!1)&&(!t._writableState||t._readableState))}function N4(t){var e;return!!(t&&typeof t.write=="function"&&typeof t.on=="function"&&(!t._readableState||((e=t._writableState)===null||e===void 0?void 0:e.writable)!==!1))}function bje(t){return!!(t&&typeof t.pipe=="function"&&t._readableState&&typeof t.on=="function"&&typeof t.write=="function")}function cf(t){return t&&(t._readableState||t._writableState||typeof t.write=="function"&&typeof t.on=="function"||typeof t.pipe=="function"&&typeof t.on=="function")}function Eae(t){return!!(t&&!cf(t)&&typeof t.pipeThrough=="function"&&typeof t.getReader=="function"&&typeof t.cancel=="function")}function Sae(t){return!!(t&&!cf(t)&&typeof t.getWriter=="function"&&typeof t.abort=="function")}function Tae(t){return!!(t&&!cf(t)&&typeof t.readable=="object"&&typeof t.writable=="object")}function wje(t){return Eae(t)||Sae(t)||Tae(t)}function _je(t,e){return t==null?!1:e===!0?typeof t[vae]=="function":e===!1?typeof t[bae]=="function":typeof t[vae]=="function"||typeof t[bae]=="function"}function U4(t){if(!cf(t))return null;let e=t._writableState,r=t._readableState,n=e||r;return!!(t.destroyed||t[wae]||n!=null&&n.destroyed)}function Aae(t){if(!N4(t))return null;if(t.writableEnded===!0)return!0;let e=t._writableState;return e!=null&&e.errored?!1:typeof e?.ended!="boolean"?null:e.ended}function xje(t,e){if(!N4(t))return null;if(t.writableFinished===!0)return!0;let r=t._writableState;return r!=null&&r.errored?!1:typeof r?.finished!="boolean"?null:!!(r.finished||e===!1&&r.ended===!0&&r.length===0)}function Eje(t){if(!$4(t))return null;if(t.readableEnded===!0)return!0;let e=t._readableState;return!e||e.errored?!1:typeof e?.ended!="boolean"?null:e.ended}function kae(t,e){if(!$4(t))return null;let r=t._readableState;return r!=null&&r.errored?!1:typeof r?.endEmitted!="boolean"?null:!!(r.endEmitted||e===!1&&r.ended===!0&&r.length===0)}function Pae(t){return t&&t[Uj]!=null?t[Uj]:typeof t?.readable!="boolean"?null:U4(t)?!1:$4(t)&&t.readable&&!kae(t)}function Iae(t){return t&&t[Kj]!=null?t[Kj]:typeof t?.writable!="boolean"?null:U4(t)?!1:N4(t)&&t.writable&&!Aae(t)}function Sje(t,e){return cf(t)?U4(t)?!0:!(e?.readable!==!1&&Pae(t)||e?.writable!==!1&&Iae(t)):null}function Tje(t){var e,r;return cf(t)?t.writableErrored?t.writableErrored:(e=(r=t._writableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}function Aje(t){var e,r;return cf(t)?t.readableErrored?t.readableErrored:(e=(r=t._readableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}function kje(t){if(!cf(t))return null;if(typeof t.closed=="boolean")return t.closed;let e=t._writableState,r=t._readableState;return typeof e?.closed=="boolean"||typeof r?.closed=="boolean"?e?.closed||r?.closed:typeof t._closed=="boolean"&&Rae(t)?t._closed:null}function Rae(t){return typeof t._closed=="boolean"&&typeof t._defaultKeepAlive=="boolean"&&typeof t._removedConnection=="boolean"&&typeof t._removedContLen=="boolean"}function Bae(t){return typeof t._sent100=="boolean"&&Rae(t)}function Pje(t){var e;return typeof t._consuming=="boolean"&&typeof t._dumped=="boolean"&&((e=t.req)===null||e===void 0?void 0:e.upgradeOrConnect)===void 0}function Ije(t){if(!cf(t))return null;let e=t._writableState,r=t._readableState,n=e||r;return!n&&Bae(t)||!!(n&&n.autoDestroy&&n.emitClose&&n.closed===!1)}function Rje(t){var e;return!!(t&&((e=t[xae])!==null&&e!==void 0?e:t.readableDidRead||t.readableAborted))}function Bje(t){var e,r,n,i,o,s,a,d,u,c;return!!(t&&((e=(r=(n=(i=(o=(s=t[_ae])!==null&&s!==void 0?s:t.readableErrored)!==null&&o!==void 0?o:t.writableErrored)!==null&&i!==void 0?i:(a=t._readableState)===null||a===void 0?void 0:a.errorEmitted)!==null&&n!==void 0?n:(d=t._writableState)===null||d===void 0?void 0:d.errorEmitted)!==null&&r!==void 0?r:(u=t._readableState)===null||u===void 0?void 0:u.errored)!==null&&e!==void 0?e:!((c=t._writableState)===null||c===void 0)&&c.errored))}Oae.exports={isDestroyed:U4,kIsDestroyed:wae,isDisturbed:Rje,kIsDisturbed:xae,isErrored:Bje,kIsErrored:_ae,isReadable:Pae,kIsReadable:Uj,kIsClosedPromise:gje,kControllerErrorFunction:vje,kIsWritable:Kj,isClosed:kje,isDuplexNodeStream:bje,isFinished:Sje,isIterable:_je,isReadableNodeStream:$4,isReadableStream:Eae,isReadableEnded:Eje,isReadableFinished:kae,isReadableErrored:Aje,isNodeStream:cf,isWebStream:wje,isWritable:Iae,isWritableNodeStream:N4,isWritableStream:Sae,isWritableEnded:Aae,isWritableFinished:xje,isWritableErrored:Tje,isServerRequest:Pje,isServerResponse:Bae,willEmitClose:Ije,isTransformStream:Tae}});var Vh=W(($_t,Vj)=>{f();var sm=Fs(),{AbortError:qae,codes:Oje}=Ca(),{ERR_INVALID_ARG_TYPE:Mje,ERR_STREAM_PREMATURE_CLOSE:Mae}=Oje,{kEmptyObject:Lj,once:Fj}=ca(),{validateAbortSignal:Dje,validateFunction:Cje,validateObject:jje,validateBoolean:$je}=L1(),{Promise:Nje,PromisePrototypeThen:Uje,SymbolDispose:Lae}=ci(),{isClosed:Kje,isReadable:Dae,isReadableNodeStream:qj,isReadableStream:qje,isReadableFinished:Cae,isReadableErrored:jae,isWritable:$ae,isWritableNodeStream:Nae,isWritableStream:Lje,isWritableFinished:Uae,isWritableErrored:Kae,isNodeStream:Fje,willEmitClose:zje,kIsClosedPromise:Vje}=df(),F1;function Hje(t){return t.setHeader&&typeof t.abort=="function"}var zj=()=>{};function Fae(t,e,r){var n,i;if(arguments.length===2?(r=e,e=Lj):e==null?e=Lj:jje(e,"options"),Cje(r,"callback"),Dje(e.signal,"options.signal"),r=Fj(r),qje(t)||Lje(t))return Wje(t,e,r);if(!Fje(t))throw new Mje("stream",["ReadableStream","WritableStream","Stream"],t);let o=(n=e.readable)!==null&&n!==void 0?n:qj(t),s=(i=e.writable)!==null&&i!==void 0?i:Nae(t),a=t._writableState,d=t._readableState,u=()=>{t.writable||h()},c=zje(t)&&qj(t)===o&&Nae(t)===s,l=Uae(t,!1),h=()=>{l=!0,t.destroyed&&(c=!1),!(c&&(!t.readable||o))&&(!o||y)&&r.call(t)},y=Cae(t,!1),g=()=>{y=!0,t.destroyed&&(c=!1),!(c&&(!t.writable||s))&&(!s||l)&&r.call(t)},v=j=>{r.call(t,j)},x=Kje(t),S=()=>{x=!0;let j=Kae(t)||jae(t);if(j&&typeof j!="boolean")return r.call(t,j);if(o&&!y&&qj(t,!0)&&!Cae(t,!1))return r.call(t,new Mae);if(s&&!l&&!Uae(t,!1))return r.call(t,new Mae);r.call(t)},A=()=>{x=!0;let j=Kae(t)||jae(t);if(j&&typeof j!="boolean")return r.call(t,j);r.call(t)},T=()=>{t.req.on("finish",h)};Hje(t)?(t.on("complete",h),c||t.on("abort",S),t.req?T():t.on("request",T)):s&&!a&&(t.on("end",u),t.on("close",u)),!c&&typeof t.aborted=="boolean"&&t.on("aborted",S),t.on("end",g),t.on("finish",h),e.error!==!1&&t.on("error",v),t.on("close",S),x?sm.nextTick(S):a!=null&&a.errorEmitted||d!=null&&d.errorEmitted?c||sm.nextTick(A):(!o&&(!c||Dae(t))&&(l||$ae(t)===!1)||!s&&(!c||$ae(t))&&(y||Dae(t)===!1)||d&&t.req&&t.aborted)&&sm.nextTick(A);let $=()=>{r=zj,t.removeListener("aborted",S),t.removeListener("complete",h),t.removeListener("abort",S),t.removeListener("request",T),t.req&&t.req.removeListener("finish",h),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",h),t.removeListener("end",g),t.removeListener("error",v),t.removeListener("close",S)};if(e.signal&&!x){let j=()=>{let K=r;$(),K.call(t,new qae(void 0,{cause:e.signal.reason}))};if(e.signal.aborted)sm.nextTick(j);else{F1=F1||ca().addAbortListener;let K=F1(e.signal,j),F=r;r=Fj((...L)=>{K[Lae](),F.apply(t,L)})}}return $}function Wje(t,e,r){let n=!1,i=zj;if(e.signal)if(i=()=>{n=!0,r.call(t,new qae(void 0,{cause:e.signal.reason}))},e.signal.aborted)sm.nextTick(i);else{F1=F1||ca().addAbortListener;let s=F1(e.signal,i),a=r;r=Fj((...d)=>{s[Lae](),a.apply(t,d)})}let o=(...s)=>{n||sm.nextTick(()=>r.apply(t,s))};return Uje(t[Vje].promise,o,o),zj}function Gje(t,e){var r;let n=!1;return e===null&&(e=Lj),(r=e)!==null&&r!==void 0&&r.cleanup&&($je(e.cleanup,"cleanup"),n=e.cleanup),new Nje((i,o)=>{let s=Fae(t,e,a=>{n&&s(),a?o(a):i()})})}Vj.exports=Fae;Vj.exports.finished=Gje});var iv=W((U_t,Zae)=>{"use strict";f();var uf=Fs(),{aggregateTwoErrors:Jje,codes:{ERR_MULTIPLE_CALLBACK:Yje},AbortError:Zje}=Ca(),{Symbol:Hae}=ci(),{kIsDestroyed:Xje,isDestroyed:Qje,isFinished:e$e,isServerRequest:t$e}=df(),Wae=Hae("kDestroy"),Hj=Hae("kConstruct");function Gae(t,e,r){t&&(t.stack,e&&!e.errored&&(e.errored=t),r&&!r.errored&&(r.errored=t))}function r$e(t,e){let r=this._readableState,n=this._writableState,i=n||r;return n!=null&&n.destroyed||r!=null&&r.destroyed?(typeof e=="function"&&e(),this):(Gae(t,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),i.constructed?zae(this,t,e):this.once(Wae,function(o){zae(this,Jje(o,t),e)}),this)}function zae(t,e,r){let n=!1;function i(o){if(n)return;n=!0;let s=t._readableState,a=t._writableState;Gae(o,a,s),a&&(a.closed=!0),s&&(s.closed=!0),typeof r=="function"&&r(o),o?uf.nextTick(n$e,t,o):uf.nextTick(Jae,t)}try{t._destroy(e||null,i)}catch(o){i(o)}}function n$e(t,e){Wj(t,e),Jae(t)}function Jae(t){let e=t._readableState,r=t._writableState;r&&(r.closeEmitted=!0),e&&(e.closeEmitted=!0),(r!=null&&r.emitClose||e!=null&&e.emitClose)&&t.emit("close")}function Wj(t,e){let r=t._readableState,n=t._writableState;n!=null&&n.errorEmitted||r!=null&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),t.emit("error",e))}function i$e(){let t=this._readableState,e=this._writableState;t&&(t.constructed=!0,t.closed=!1,t.closeEmitted=!1,t.destroyed=!1,t.errored=null,t.errorEmitted=!1,t.reading=!1,t.ended=t.readable===!1,t.endEmitted=t.readable===!1),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=e.writable===!1,e.ending=e.writable===!1,e.finished=e.writable===!1)}function Gj(t,e,r){let n=t._readableState,i=t._writableState;if(i!=null&&i.destroyed||n!=null&&n.destroyed)return this;n!=null&&n.autoDestroy||i!=null&&i.autoDestroy?t.destroy(e):e&&(e.stack,i&&!i.errored&&(i.errored=e),n&&!n.errored&&(n.errored=e),r?uf.nextTick(Wj,t,e):Wj(t,e))}function o$e(t,e){if(typeof t._construct!="function")return;let r=t._readableState,n=t._writableState;r&&(r.constructed=!1),n&&(n.constructed=!1),t.once(Hj,e),!(t.listenerCount(Hj)>1)&&uf.nextTick(s$e,t)}function s$e(t){let e=!1;function r(n){if(e){Gj(t,n??new Yje);return}e=!0;let i=t._readableState,o=t._writableState,s=o||i;i&&(i.constructed=!0),o&&(o.constructed=!0),s.destroyed?t.emit(Wae,n):n?Gj(t,n,!0):uf.nextTick(a$e,t)}try{t._construct(n=>{uf.nextTick(r,n)})}catch(n){uf.nextTick(r,n)}}function a$e(t){t.emit(Hj)}function Vae(t){return t?.setHeader&&typeof t.abort=="function"}function Yae(t){t.emit("close")}function c$e(t,e){t.emit("error",e),uf.nextTick(Yae,t)}function d$e(t,e){!t||Qje(t)||(!e&&!e$e(t)&&(e=new Zje),t$e(t)?(t.socket=null,t.destroy(e)):Vae(t)?t.abort():Vae(t.req)?t.req.abort():typeof t.destroy=="function"?t.destroy(e):typeof t.close=="function"?t.close():e?uf.nextTick(c$e,t,e):uf.nextTick(Yae,t),t.destroyed||(t[Xje]=!0))}Zae.exports={construct:o$e,destroyer:d$e,destroy:r$e,undestroy:i$e,errorOrDestroy:Gj}});var L4=W((q_t,Qae)=>{"use strict";f();var{ArrayIsArray:u$e,ObjectSetPrototypeOf:Xae}=ci(),{EventEmitter:K4}=Ba();function q4(t){K4.call(this,t)}Xae(q4.prototype,K4.prototype);Xae(q4,K4);q4.prototype.pipe=function(t,e){let r=this;function n(c){t.writable&&t.write(c)===!1&&r.pause&&r.pause()}r.on("data",n);function i(){r.readable&&r.resume&&r.resume()}t.on("drain",i),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",s),r.on("close",a));let o=!1;function s(){o||(o=!0,t.end())}function a(){o||(o=!0,typeof t.destroy=="function"&&t.destroy())}function d(c){u(),K4.listenerCount(this,"error")===0&&this.emit("error",c)}Jj(r,"error",d),Jj(t,"error",d);function u(){r.removeListener("data",n),t.removeListener("drain",i),r.removeListener("end",s),r.removeListener("close",a),r.removeListener("error",d),t.removeListener("error",d),r.removeListener("end",u),r.removeListener("close",u),t.removeListener("close",u)}return r.on("end",u),r.on("close",u),t.on("close",u),t.emit("pipe",r),t};function Jj(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):u$e(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}Qae.exports={Stream:q4,prependListener:Jj}});var w6=W((F_t,F4)=>{"use strict";f();var{SymbolDispose:l$e}=ci(),{AbortError:ece,codes:f$e}=Ca(),{isNodeStream:tce,isWebStream:h$e,kControllerErrorFunction:p$e}=df(),y$e=Vh(),{ERR_INVALID_ARG_TYPE:rce}=f$e,Yj,m$e=(t,e)=>{if(typeof t!="object"||!("aborted"in t))throw new rce(e,"AbortSignal",t)};F4.exports.addAbortSignal=function(e,r){if(m$e(e,"signal"),!tce(r)&&!h$e(r))throw new rce("stream",["ReadableStream","WritableStream","Stream"],r);return F4.exports.addAbortSignalNoValidate(e,r)};F4.exports.addAbortSignalNoValidate=function(t,e){if(typeof t!="object"||!("aborted"in t))return e;let r=tce(e)?()=>{e.destroy(new ece(void 0,{cause:t.reason}))}:()=>{e[p$e](new ece(void 0,{cause:t.reason}))};if(t.aborted)r();else{Yj=Yj||ca().addAbortListener;let n=Yj(t,r);y$e(e,n[l$e])}return e}});var oce=W((H_t,ice)=>{"use strict";f();var{StringPrototypeSlice:nce,SymbolIterator:g$e,TypedArrayPrototypeSet:z4,Uint8Array:v$e}=ci(),{Buffer:Zj}=bn(),{inspect:b$e}=ca();ice.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){let r={data:e,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length}unshift(e){let r={data:e,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length}shift(){if(this.length===0)return;let e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let r=this.head,n=""+r.data;for(;(r=r.next)!==null;)n+=e+r.data;return n}concat(e){if(this.length===0)return Zj.alloc(0);let r=Zj.allocUnsafe(e>>>0),n=this.head,i=0;for(;n;)z4(r,n.data,i),i+=n.data.length,n=n.next;return r}consume(e,r){let n=this.head.data;if(e<n.length){let i=n.slice(0,e);return this.head.data=n.slice(e),i}return e===n.length?this.shift():r?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[g$e](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let r="",n=this.head,i=0;do{let o=n.data;if(e>o.length)r+=o,e-=o.length;else{e===o.length?(r+=o,++i,n.next?this.head=n.next:this.head=this.tail=null):(r+=nce(o,0,e),this.head=n,n.data=nce(o,e));break}++i}while((n=n.next)!==null);return this.length-=i,r}_getBuffer(e){let r=Zj.allocUnsafe(e),n=e,i=this.head,o=0;do{let s=i.data;if(e>s.length)z4(r,s,n-e),e-=s.length;else{e===s.length?(z4(r,s,n-e),++o,i.next?this.head=i.next:this.head=this.tail=null):(z4(r,new v$e(s.buffer,s.byteOffset,e),n-e),this.head=i,i.data=s.slice(e));break}++o}while((i=i.next)!==null);return this.length-=o,r}[Symbol.for("nodejs.util.inspect.custom")](e,r){return b$e(this,{...r,depth:0,customInspect:!1})}}});var _6=W((G_t,dce)=>{"use strict";f();var{MathFloor:w$e,NumberIsInteger:_$e}=ci(),{validateInteger:x$e}=L1(),{ERR_INVALID_ARG_VALUE:E$e}=Ca().codes,sce=16*1024,ace=16;function S$e(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function cce(t){return t?ace:sce}function T$e(t,e){x$e(e,"value",0),t?ace=e:sce=e}function A$e(t,e,r,n){let i=S$e(e,n,r);if(i!=null){if(!_$e(i)||i<0){let o=n?`options.${r}`:"options.highWaterMark";throw new E$e(o,i)}return w$e(i)}return cce(t.objectMode)}dce.exports={getHighWaterMark:A$e,getDefaultHighWaterMark:cce,setDefaultHighWaterMark:T$e}});var Xj=W((Y_t,hce)=>{"use strict";f();var uce=Fs(),{PromisePrototypeThen:k$e,SymbolAsyncIterator:lce,SymbolIterator:fce}=ci(),{Buffer:P$e}=bn(),{ERR_INVALID_ARG_TYPE:I$e,ERR_STREAM_NULL_VALUES:R$e}=Ca().codes;function B$e(t,e,r){let n;if(typeof e=="string"||e instanceof P$e)return new t({objectMode:!0,...r,read(){this.push(e),this.push(null)}});let i;if(e&&e[lce])i=!0,n=e[lce]();else if(e&&e[fce])i=!1,n=e[fce]();else throw new I$e("iterable",["Iterable"],e);let o=new t({objectMode:!0,highWaterMark:1,...r}),s=!1;o._read=function(){s||(s=!0,d())},o._destroy=function(u,c){k$e(a(u),()=>uce.nextTick(c,u),l=>uce.nextTick(c,l||u))};async function a(u){let c=u!=null,l=typeof n.throw=="function";if(c&&l){let{value:h,done:y}=await n.throw(u);if(await h,y)return}if(typeof n.return=="function"){let{value:h}=await n.return();await h}}async function d(){for(;;){try{let{value:u,done:c}=i?await n.next():n.next();if(c)o.push(null);else{let l=u&&typeof u.then=="function"?await u:u;if(l===null)throw s=!1,new R$e;if(o.push(l))continue;s=!1}}catch(u){o.destroy(u)}break}}return o}hce.exports=B$e});var E6=W((X_t,Bce)=>{f();var Xu=Fs(),{ArrayPrototypeIndexOf:O$e,NumberIsInteger:M$e,NumberIsNaN:D$e,NumberParseInt:C$e,ObjectDefineProperties:s$,ObjectKeys:j$e,ObjectSetPrototypeOf:mce,Promise:gce,SafeSet:$$e,SymbolAsyncDispose:N$e,SymbolAsyncIterator:U$e,Symbol:K$e}=ci();Bce.exports=yr;yr.ReadableState=G4;var{EventEmitter:q$e}=Ba(),{Stream:am,prependListener:L$e}=L4(),{Buffer:Qj}=bn(),{addAbortSignal:F$e}=w6(),vce=Vh(),Ur=ca().debuglog("stream",t=>{Ur=t}),z$e=oce(),H1=iv(),{getHighWaterMark:V$e,getDefaultHighWaterMark:H$e}=_6(),{aggregateTwoErrors:pce,codes:{ERR_INVALID_ARG_TYPE:W$e,ERR_METHOD_NOT_IMPLEMENTED:G$e,ERR_OUT_OF_RANGE:J$e,ERR_STREAM_PUSH_AFTER_EOF:Y$e,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:Z$e},AbortError:X$e}=Ca(),{validateObject:Q$e}=L1(),ov=K$e("kPaused"),{StringDecoder:bce}=Yw(),eNe=Xj();mce(yr.prototype,am.prototype);mce(yr,am);var e$=()=>{},{errorOrDestroy:z1}=H1,V1=1,tNe=2,wce=4,x6=8,_ce=16,V4=32,H4=64,xce=128,rNe=256,nNe=512,iNe=1024,i$=2048,o$=4096,oNe=8192,sNe=16384,aNe=32768,Ece=65536,cNe=1<<17,dNe=1<<18;function ao(t){return{enumerable:!1,get(){return(this.state&t)!==0},set(e){e?this.state|=t:this.state&=~t}}}s$(G4.prototype,{objectMode:ao(V1),ended:ao(tNe),endEmitted:ao(wce),reading:ao(x6),constructed:ao(_ce),sync:ao(V4),needReadable:ao(H4),emittedReadable:ao(xce),readableListening:ao(rNe),resumeScheduled:ao(nNe),errorEmitted:ao(iNe),emitClose:ao(i$),autoDestroy:ao(o$),destroyed:ao(oNe),closed:ao(sNe),closeEmitted:ao(aNe),multiAwaitDrain:ao(Ece),readingMore:ao(cNe),dataEmitted:ao(dNe)});function G4(t,e,r){typeof r!="boolean"&&(r=e instanceof lf()),this.state=i$|o$|_ce|V4,t&&t.objectMode&&(this.state|=V1),r&&t&&t.readableObjectMode&&(this.state|=V1),this.highWaterMark=t?V$e(this,t,"readableHighWaterMark",r):H$e(!1),this.buffer=new z$e,this.length=0,this.pipes=[],this.flowing=null,this[ov]=null,t&&t.emitClose===!1&&(this.state&=~i$),t&&t.autoDestroy===!1&&(this.state&=~o$),this.errored=null,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.decoder=null,this.encoding=null,t&&t.encoding&&(this.decoder=new bce(t.encoding),this.encoding=t.encoding)}function yr(t){if(!(this instanceof yr))return new yr(t);let e=this instanceof lf();this._readableState=new G4(t,this,e),t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.construct=="function"&&(this._construct=t.construct),t.signal&&!e&&F$e(t.signal,this)),am.call(this,t),H1.construct(this,()=>{this._readableState.needReadable&&W4(this,this._readableState)})}yr.prototype.destroy=H1.destroy;yr.prototype._undestroy=H1.undestroy;yr.prototype._destroy=function(t,e){e(t)};yr.prototype[q$e.captureRejectionSymbol]=function(t){this.destroy(t)};yr.prototype[N$e]=function(){let t;return this.destroyed||(t=this.readableEnded?null:new X$e,this.destroy(t)),new gce((e,r)=>vce(this,n=>n&&n!==t?r(n):e(null)))};yr.prototype.push=function(t,e){return Sce(this,t,e,!1)};yr.prototype.unshift=function(t,e){return Sce(this,t,e,!0)};function Sce(t,e,r,n){Ur("readableAddChunk",e);let i=t._readableState,o;if(i.state&V1||(typeof e=="string"?(r=r||i.defaultEncoding,i.encoding!==r&&(n&&i.encoding?e=Qj.from(e,r).toString(i.encoding):(e=Qj.from(e,r),r=""))):e instanceof Qj?r="":am._isUint8Array(e)?(e=am._uint8ArrayToBuffer(e),r=""):e!=null&&(o=new W$e("chunk",["string","Buffer","Uint8Array"],e))),o)z1(t,o);else if(e===null)i.state&=~x6,fNe(t,i);else if(i.state&V1||e&&e.length>0)if(n)if(i.state&wce)z1(t,new Z$e);else{if(i.destroyed||i.errored)return!1;t$(t,i,e,!0)}else if(i.ended)z1(t,new Y$e);else{if(i.destroyed||i.errored)return!1;i.state&=~x6,i.decoder&&!r?(e=i.decoder.write(e),i.objectMode||e.length!==0?t$(t,i,e,!1):W4(t,i)):t$(t,i,e,!1)}else n||(i.state&=~x6,W4(t,i));return!i.ended&&(i.length<i.highWaterMark||i.length===0)}function t$(t,e,r,n){e.flowing&&e.length===0&&!e.sync&&t.listenerCount("data")>0?(e.state&Ece?e.awaitDrainWriters.clear():e.awaitDrainWriters=null,e.dataEmitted=!0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.state&H4&&J4(t)),W4(t,e)}yr.prototype.isPaused=function(){let t=this._readableState;return t[ov]===!0||t.flowing===!1};yr.prototype.setEncoding=function(t){let e=new bce(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;let r=this._readableState.buffer,n="";for(let i of r)n+=e.write(i);return r.clear(),n!==""&&r.push(n),this._readableState.length=n.length,this};var uNe=1073741824;function lNe(t){if(t>uNe)throw new J$e("size","<= 1GiB",t);return t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++,t}function yce(t,e){return t<=0||e.length===0&&e.ended?0:e.state&V1?1:D$e(t)?e.flowing&&e.length?e.buffer.first().length:e.length:t<=e.length?t:e.ended?e.length:0}yr.prototype.read=function(t){Ur("read",t),t===void 0?t=NaN:M$e(t)||(t=C$e(t,10));let e=this._readableState,r=t;if(t>e.highWaterMark&&(e.highWaterMark=lNe(t)),t!==0&&(e.state&=~xce),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return Ur("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?r$(this):J4(this),null;if(t=yce(t,e),t===0&&e.ended)return e.length===0&&r$(this),null;let n=(e.state&H4)!==0;if(Ur("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,Ur("length less than watermark",n)),e.ended||e.reading||e.destroyed||e.errored||!e.constructed)n=!1,Ur("reading, ended or constructing",n);else if(n){Ur("do read"),e.state|=x6|V4,e.length===0&&(e.state|=H4);try{this._read(e.highWaterMark)}catch(o){z1(this,o)}e.state&=~V4,e.reading||(t=yce(r,e))}let i;return t>0?i=Ice(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.multiAwaitDrain?e.awaitDrainWriters.clear():e.awaitDrainWriters=null),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&r$(this)),i!==null&&!e.errorEmitted&&!e.closeEmitted&&(e.dataEmitted=!0,this.emit("data",i)),i};function fNe(t,e){if(Ur("onEofChunk"),!e.ended){if(e.decoder){let r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?J4(t):(e.needReadable=!1,e.emittedReadable=!0,Tce(t))}}function J4(t){let e=t._readableState;Ur("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(Ur("emitReadable",e.flowing),e.emittedReadable=!0,Xu.nextTick(Tce,t))}function Tce(t){let e=t._readableState;Ur("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&!e.errored&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,kce(t)}function W4(t,e){!e.readingMore&&e.constructed&&(e.readingMore=!0,Xu.nextTick(hNe,t,e))}function hNe(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){let r=e.length;if(Ur("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}yr.prototype._read=function(t){throw new G$e("_read()")};yr.prototype.pipe=function(t,e){let r=this,n=this._readableState;n.pipes.length===1&&(n.multiAwaitDrain||(n.multiAwaitDrain=!0,n.awaitDrainWriters=new $$e(n.awaitDrainWriters?[n.awaitDrainWriters]:[]))),n.pipes.push(t),Ur("pipe count=%d opts=%j",n.pipes.length,e);let o=(!e||e.end!==!1)&&t!==Xu.stdout&&t!==Xu.stderr?a:x;n.endEmitted?Xu.nextTick(o):r.once("end",o),t.on("unpipe",s);function s(S,A){Ur("onunpipe"),S===r&&A&&A.hasUnpiped===!1&&(A.hasUnpiped=!0,c())}function a(){Ur("onend"),t.end()}let d,u=!1;function c(){Ur("cleanup"),t.removeListener("close",g),t.removeListener("finish",v),d&&t.removeListener("drain",d),t.removeListener("error",y),t.removeListener("unpipe",s),r.removeListener("end",a),r.removeListener("end",x),r.removeListener("data",h),u=!0,d&&n.awaitDrainWriters&&(!t._writableState||t._writableState.needDrain)&&d()}function l(){u||(n.pipes.length===1&&n.pipes[0]===t?(Ur("false write response, pause",0),n.awaitDrainWriters=t,n.multiAwaitDrain=!1):n.pipes.length>1&&n.pipes.includes(t)&&(Ur("false write response, pause",n.awaitDrainWriters.size),n.awaitDrainWriters.add(t)),r.pause()),d||(d=pNe(r,t),t.on("drain",d))}r.on("data",h);function h(S){Ur("ondata");let A=t.write(S);Ur("dest.write",A),A===!1&&l()}function y(S){if(Ur("onerror",S),x(),t.removeListener("error",y),t.listenerCount("error")===0){let A=t._writableState||t._readableState;A&&!A.errorEmitted?z1(t,S):t.emit("error",S)}}L$e(t,"error",y);function g(){t.removeListener("finish",v),x()}t.once("close",g);function v(){Ur("onfinish"),t.removeListener("close",g),x()}t.once("finish",v);function x(){Ur("unpipe"),r.unpipe(t)}return t.emit("pipe",r),t.writableNeedDrain===!0?l():n.flowing||(Ur("pipe resume"),r.resume()),t};function pNe(t,e){return function(){let n=t._readableState;n.awaitDrainWriters===e?(Ur("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(Ur("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(e)),(!n.awaitDrainWriters||n.awaitDrainWriters.size===0)&&t.listenerCount("data")&&t.resume()}}yr.prototype.unpipe=function(t){let e=this._readableState,r={hasUnpiped:!1};if(e.pipes.length===0)return this;if(!t){let i=e.pipes;e.pipes=[],this.pause();for(let o=0;o<i.length;o++)i[o].emit("unpipe",this,{hasUnpiped:!1});return this}let n=O$e(e.pipes,t);return n===-1?this:(e.pipes.splice(n,1),e.pipes.length===0&&this.pause(),t.emit("unpipe",this,r),this)};yr.prototype.on=function(t,e){let r=am.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,Ur("on readable",n.length,n.reading),n.length?J4(this):n.reading||Xu.nextTick(yNe,this)),r};yr.prototype.addListener=yr.prototype.on;yr.prototype.removeListener=function(t,e){let r=am.prototype.removeListener.call(this,t,e);return t==="readable"&&Xu.nextTick(Ace,this),r};yr.prototype.off=yr.prototype.removeListener;yr.prototype.removeAllListeners=function(t){let e=am.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&Xu.nextTick(Ace,this),e};function Ace(t){let e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&e[ov]===!1?e.flowing=!0:t.listenerCount("data")>0?t.resume():e.readableListening||(e.flowing=null)}function yNe(t){Ur("readable nexttick read 0"),t.read(0)}yr.prototype.resume=function(){let t=this._readableState;return t.flowing||(Ur("resume"),t.flowing=!t.readableListening,mNe(this,t)),t[ov]=!1,this};function mNe(t,e){e.resumeScheduled||(e.resumeScheduled=!0,Xu.nextTick(gNe,t,e))}function gNe(t,e){Ur("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),kce(t),e.flowing&&!e.reading&&t.read(0)}yr.prototype.pause=function(){return Ur("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Ur("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[ov]=!0,this};function kce(t){let e=t._readableState;for(Ur("flow",e.flowing);e.flowing&&t.read()!==null;);}yr.prototype.wrap=function(t){let e=!1;t.on("data",n=>{!this.push(n)&&t.pause&&(e=!0,t.pause())}),t.on("end",()=>{this.push(null)}),t.on("error",n=>{z1(this,n)}),t.on("close",()=>{this.destroy()}),t.on("destroy",()=>{this.destroy()}),this._read=()=>{e&&t.resume&&(e=!1,t.resume())};let r=j$e(t);for(let n=1;n<r.length;n++){let i=r[n];this[i]===void 0&&typeof t[i]=="function"&&(this[i]=t[i].bind(t))}return this};yr.prototype[U$e]=function(){return Pce(this)};yr.prototype.iterator=function(t){return t!==void 0&&Q$e(t,"options"),Pce(this,t)};function Pce(t,e){typeof t.read!="function"&&(t=yr.wrap(t,{objectMode:!0}));let r=vNe(t,e);return r.stream=t,r}async function*vNe(t,e){let r=e$;function n(s){this===t?(r(),r=e$):r=s}t.on("readable",n);let i,o=vce(t,{writable:!1},s=>{i=s?pce(i,s):null,r(),r=e$});try{for(;;){let s=t.destroyed?null:t.read();if(s!==null)yield s;else{if(i)throw i;if(i===null)return;await new gce(n)}}}catch(s){throw i=pce(i,s),i}finally{(i||e?.destroyOnReturn!==!1)&&(i===void 0||t._readableState.autoDestroy)?H1.destroyer(t,null):(t.off("readable",n),o())}}s$(yr.prototype,{readable:{__proto__:null,get(){let t=this._readableState;return!!t&&t.readable!==!1&&!t.destroyed&&!t.errorEmitted&&!t.endEmitted},set(t){this._readableState&&(this._readableState.readable=!!t)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(t){this._readableState&&(this._readableState.destroyed=t)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}});s$(G4.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[ov]!==!1},set(t){this[ov]=!!t}}});yr._fromList=Ice;function Ice(t,e){if(e.length===0)return null;let r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function r$(t){let e=t._readableState;Ur("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,Xu.nextTick(bNe,e,t))}function bNe(t,e){if(Ur("endReadableNT",t.endEmitted,t.length),!t.errored&&!t.closeEmitted&&!t.endEmitted&&t.length===0){if(t.endEmitted=!0,e.emit("end"),e.writable&&e.allowHalfOpen===!1)Xu.nextTick(wNe,e);else if(t.autoDestroy){let r=e._writableState;(!r||r.autoDestroy&&(r.finished||r.writable===!1))&&e.destroy()}}}function wNe(t){t.writable&&!t.writableEnded&&!t.destroyed&&t.end()}yr.from=function(t,e){return eNe(yr,t,e)};var n$;function Rce(){return n$===void 0&&(n$={}),n$}yr.fromWeb=function(t,e){return Rce().newStreamReadableFromReadableStream(t,e)};yr.toWeb=function(t,e){return Rce().newReadableStreamFromStreamReadable(t,e)};yr.wrap=function(t,e){var r,n;return new yr({objectMode:(r=(n=t.readableObjectMode)!==null&&n!==void 0?n:t.objectMode)!==null&&r!==void 0?r:!0,...e,destroy(i,o){H1.destroyer(t,i),o(i)}}).wrap(t)}});var ek=W((ext,Fce)=>{f();var sv=Fs(),{ArrayPrototypeSlice:Dce,Error:_Ne,FunctionPrototypeSymbolHasInstance:Cce,ObjectDefineProperty:jce,ObjectDefineProperties:xNe,ObjectSetPrototypeOf:$ce,StringPrototypeToLowerCase:ENe,Symbol:SNe,SymbolHasInstance:TNe}=ci();Fce.exports=di;di.WritableState=A6;var{EventEmitter:ANe}=Ba(),S6=L4().Stream,{Buffer:Y4}=bn(),Q4=iv(),{addAbortSignal:kNe}=w6(),{getHighWaterMark:PNe,getDefaultHighWaterMark:INe}=_6(),{ERR_INVALID_ARG_TYPE:RNe,ERR_METHOD_NOT_IMPLEMENTED:BNe,ERR_MULTIPLE_CALLBACK:Nce,ERR_STREAM_CANNOT_PIPE:ONe,ERR_STREAM_DESTROYED:T6,ERR_STREAM_ALREADY_FINISHED:MNe,ERR_STREAM_NULL_VALUES:DNe,ERR_STREAM_WRITE_AFTER_END:CNe,ERR_UNKNOWN_ENCODING:Uce}=Ca().codes,{errorOrDestroy:W1}=Q4;$ce(di.prototype,S6.prototype);$ce(di,S6);function d$(){}var G1=SNe("kOnFinished");function A6(t,e,r){typeof r!="boolean"&&(r=e instanceof lf()),this.objectMode=!!(t&&t.objectMode),r&&(this.objectMode=this.objectMode||!!(t&&t.writableObjectMode)),this.highWaterMark=t?PNe(this,t,"writableHighWaterMark",r):INe(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let n=!!(t&&t.decodeStrings===!1);this.decodeStrings=!n,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=$Ne.bind(void 0,e),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,X4(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!t||t.emitClose!==!1,this.autoDestroy=!t||t.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[G1]=[]}function X4(t){t.buffered=[],t.bufferedIndex=0,t.allBuffers=!0,t.allNoop=!0}A6.prototype.getBuffer=function(){return Dce(this.buffered,this.bufferedIndex)};jce(A6.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function di(t){let e=this instanceof lf();if(!e&&!Cce(di,this))return new di(t);this._writableState=new A6(t,this,e),t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final),typeof t.construct=="function"&&(this._construct=t.construct),t.signal&&kNe(t.signal,this)),S6.call(this,t),Q4.construct(this,()=>{let r=this._writableState;r.writing||l$(this,r),f$(this,r)})}jce(di,TNe,{__proto__:null,value:function(t){return Cce(this,t)?!0:this!==di?!1:t&&t._writableState instanceof A6}});di.prototype.pipe=function(){W1(this,new ONe)};function Kce(t,e,r,n){let i=t._writableState;if(typeof r=="function")n=r,r=i.defaultEncoding;else{if(!r)r=i.defaultEncoding;else if(r!=="buffer"&&!Y4.isEncoding(r))throw new Uce(r);typeof n!="function"&&(n=d$)}if(e===null)throw new DNe;if(!i.objectMode)if(typeof e=="string")i.decodeStrings!==!1&&(e=Y4.from(e,r),r="buffer");else if(e instanceof Y4)r="buffer";else if(S6._isUint8Array(e))e=S6._uint8ArrayToBuffer(e),r="buffer";else throw new RNe("chunk",["string","Buffer","Uint8Array"],e);let o;return i.ending?o=new CNe:i.destroyed&&(o=new T6("write")),o?(sv.nextTick(n,o),W1(t,o,!0),o):(i.pendingcb++,jNe(t,i,e,r,n))}di.prototype.write=function(t,e,r){return Kce(this,t,e,r)===!0};di.prototype.cork=function(){this._writableState.corked++};di.prototype.uncork=function(){let t=this._writableState;t.corked&&(t.corked--,t.writing||l$(this,t))};di.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=ENe(e)),!Y4.isEncoding(e))throw new Uce(e);return this._writableState.defaultEncoding=e,this};function jNe(t,e,r,n,i){let o=e.objectMode?1:r.length;e.length+=o;let s=e.length<e.highWaterMark;return s||(e.needDrain=!0),e.writing||e.corked||e.errored||!e.constructed?(e.buffered.push({chunk:r,encoding:n,callback:i}),e.allBuffers&&n!=="buffer"&&(e.allBuffers=!1),e.allNoop&&i!==d$&&(e.allNoop=!1)):(e.writelen=o,e.writecb=i,e.writing=!0,e.sync=!0,t._write(r,n,e.onwrite),e.sync=!1),s&&!e.errored&&!e.destroyed}function Oce(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new T6("write")):r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function Mce(t,e,r,n){--e.pendingcb,n(r),u$(e),W1(t,r)}function $Ne(t,e){let r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function"){W1(t,new Nce);return}r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,e?(e.stack,r.errored||(r.errored=e),t._readableState&&!t._readableState.errored&&(t._readableState.errored=e),n?sv.nextTick(Mce,t,r,e,i):Mce(t,r,e,i)):(r.buffered.length>r.bufferedIndex&&l$(t,r),n?r.afterWriteTickInfo!==null&&r.afterWriteTickInfo.cb===i?r.afterWriteTickInfo.count++:(r.afterWriteTickInfo={count:1,cb:i,stream:t,state:r},sv.nextTick(NNe,r.afterWriteTickInfo)):qce(t,r,1,i))}function NNe({stream:t,state:e,count:r,cb:n}){return e.afterWriteTickInfo=null,qce(t,e,r,n)}function qce(t,e,r,n){for(!e.ending&&!t.destroyed&&e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"));r-- >0;)e.pendingcb--,n();e.destroyed&&u$(e),f$(t,e)}function u$(t){if(t.writing)return;for(let i=t.bufferedIndex;i<t.buffered.length;++i){var e;let{chunk:o,callback:s}=t.buffered[i],a=t.objectMode?1:o.length;t.length-=a,s((e=t.errored)!==null&&e!==void 0?e:new T6("write"))}let r=t[G1].splice(0);for(let i=0;i<r.length;i++){var n;r[i]((n=t.errored)!==null&&n!==void 0?n:new T6("end"))}X4(t)}function l$(t,e){if(e.corked||e.bufferProcessing||e.destroyed||!e.constructed)return;let{buffered:r,bufferedIndex:n,objectMode:i}=e,o=r.length-n;if(!o)return;let s=n;if(e.bufferProcessing=!0,o>1&&t._writev){e.pendingcb-=o-1;let a=e.allNoop?d$:u=>{for(let c=s;c<r.length;++c)r[c].callback(u)},d=e.allNoop&&s===0?r:Dce(r,s);d.allBuffers=e.allBuffers,Oce(t,e,!0,e.length,d,"",a),X4(e)}else{do{let{chunk:a,encoding:d,callback:u}=r[s];r[s++]=null;let c=i?1:a.length;Oce(t,e,!1,c,a,d,u)}while(s<r.length&&!e.writing);s===r.length?X4(e):s>256?(r.splice(0,s),e.bufferedIndex=0):e.bufferedIndex=s}e.bufferProcessing=!1}di.prototype._write=function(t,e,r){if(this._writev)this._writev([{chunk:t,encoding:e}],r);else throw new BNe("_write()")};di.prototype._writev=null;di.prototype.end=function(t,e,r){let n=this._writableState;typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null);let i;if(t!=null){let o=Kce(this,t,e);o instanceof _Ne&&(i=o)}return n.corked&&(n.corked=1,this.uncork()),i||(!n.errored&&!n.ending?(n.ending=!0,f$(this,n,!0),n.ended=!0):n.finished?i=new MNe("end"):n.destroyed&&(i=new T6("end"))),typeof r=="function"&&(i||n.finished?sv.nextTick(r,i):n[G1].push(r)),this};function Z4(t){return t.ending&&!t.destroyed&&t.constructed&&t.length===0&&!t.errored&&t.buffered.length===0&&!t.finished&&!t.writing&&!t.errorEmitted&&!t.closeEmitted}function UNe(t,e){let r=!1;function n(i){if(r){W1(t,i??Nce());return}if(r=!0,e.pendingcb--,i){let o=e[G1].splice(0);for(let s=0;s<o.length;s++)o[s](i);W1(t,i,e.sync)}else Z4(e)&&(e.prefinished=!0,t.emit("prefinish"),e.pendingcb++,sv.nextTick(c$,t,e))}e.sync=!0,e.pendingcb++;try{t._final(n)}catch(i){n(i)}e.sync=!1}function KNe(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.finalCalled=!0,UNe(t,e)):(e.prefinished=!0,t.emit("prefinish")))}function f$(t,e,r){Z4(e)&&(KNe(t,e),e.pendingcb===0&&(r?(e.pendingcb++,sv.nextTick((n,i)=>{Z4(i)?c$(n,i):i.pendingcb--},t,e)):Z4(e)&&(e.pendingcb++,c$(t,e))))}function c$(t,e){e.pendingcb--,e.finished=!0;let r=e[G1].splice(0);for(let n=0;n<r.length;n++)r[n]();if(t.emit("finish"),e.autoDestroy){let n=t._readableState;(!n||n.autoDestroy&&(n.endEmitted||n.readable===!1))&&t.destroy()}}xNe(di.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(t){this._writableState&&(this._writableState.destroyed=t)}},writable:{__proto__:null,get(){let t=this._writableState;return!!t&&t.writable!==!1&&!t.destroyed&&!t.errored&&!t.ending&&!t.ended},set(t){this._writableState&&(this._writableState.writable=!!t)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){let t=this._writableState;return t?!t.destroyed&&!t.ending&&t.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});var qNe=Q4.destroy;di.prototype.destroy=function(t,e){let r=this._writableState;return!r.destroyed&&(r.bufferedIndex<r.buffered.length||r[G1].length)&&sv.nextTick(u$,r),qNe.call(this,t,e),this};di.prototype._undestroy=Q4.undestroy;di.prototype._destroy=function(t,e){e(t)};di.prototype[ANe.captureRejectionSymbol]=function(t){this.destroy(t)};var a$;function Lce(){return a$===void 0&&(a$={}),a$}di.fromWeb=function(t,e){return Lce().newStreamWritableFromWritableStream(t,e)};di.toWeb=function(t){return Lce().newWritableStreamFromStreamWritable(t)}});var ide=W((rxt,nde)=>{f();var h$=Fs(),LNe=bn(),{isReadable:FNe,isWritable:zNe,isIterable:zce,isNodeStream:VNe,isReadableNodeStream:Vce,isWritableNodeStream:Hce,isDuplexNodeStream:HNe,isReadableStream:Wce,isWritableStream:Gce}=df(),Jce=Vh(),{AbortError:tde,codes:{ERR_INVALID_ARG_TYPE:WNe,ERR_INVALID_RETURN_VALUE:Yce}}=Ca(),{destroyer:Y1}=iv(),GNe=lf(),rde=E6(),JNe=ek(),{createDeferredPromise:Zce}=ca(),Xce=Xj(),Qce=globalThis.Blob||LNe.Blob,YNe=typeof Qce<"u"?function(e){return e instanceof Qce}:function(e){return!1},ZNe=globalThis.AbortController||zh().AbortController,{FunctionPrototypeCall:ede}=ci(),cm=class extends GNe{constructor(e){super(e),e?.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),e?.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};nde.exports=function t(e,r){if(HNe(e))return e;if(Vce(e))return J1({readable:e});if(Hce(e))return J1({writable:e});if(VNe(e))return J1({writable:!1,readable:!1});if(Wce(e))return J1({readable:rde.fromWeb(e)});if(Gce(e))return J1({writable:JNe.fromWeb(e)});if(typeof e=="function"){let{value:i,write:o,final:s,destroy:a}=XNe(e);if(zce(i))return Xce(cm,i,{objectMode:!0,write:o,final:s,destroy:a});let d=i?.then;if(typeof d=="function"){let u,c=ede(d,i,l=>{if(l!=null)throw new Yce("nully","body",l)},l=>{Y1(u,l)});return u=new cm({objectMode:!0,readable:!1,write:o,final(l){s(async()=>{try{await c,h$.nextTick(l,null)}catch(h){h$.nextTick(l,h)}})},destroy:a})}throw new Yce("Iterable, AsyncIterable or AsyncFunction",r,i)}if(YNe(e))return t(e.arrayBuffer());if(zce(e))return Xce(cm,e,{objectMode:!0,writable:!1});if(Wce(e?.readable)&&Gce(e?.writable))return cm.fromWeb(e);if(typeof e?.writable=="object"||typeof e?.readable=="object"){let i=e!=null&&e.readable?Vce(e?.readable)?e?.readable:t(e.readable):void 0,o=e!=null&&e.writable?Hce(e?.writable)?e?.writable:t(e.writable):void 0;return J1({readable:i,writable:o})}let n=e?.then;if(typeof n=="function"){let i;return ede(n,e,o=>{o!=null&&i.push(o),i.push(null)},o=>{Y1(i,o)}),i=new cm({objectMode:!0,writable:!1,read(){}})}throw new WNe(r,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],e)};function XNe(t){let{promise:e,resolve:r}=Zce(),n=new ZNe,i=n.signal;return{value:t(async function*(){for(;;){let s=e;e=null;let{chunk:a,done:d,cb:u}=await s;if(h$.nextTick(u),d)return;if(i.aborted)throw new tde(void 0,{cause:i.reason});({promise:e,resolve:r}=Zce()),yield a}}(),{signal:i}),write(s,a,d){let u=r;r=null,u({chunk:s,done:!1,cb:d})},final(s){let a=r;r=null,a({done:!0,cb:s})},destroy(s,a){n.abort(),a(s)}}}function J1(t){let e=t.readable&&typeof t.readable.read!="function"?rde.wrap(t.readable):t.readable,r=t.writable,n=!!FNe(e),i=!!zNe(r),o,s,a,d,u;function c(l){let h=d;d=null,h?h(l):l&&u.destroy(l)}return u=new cm({readableObjectMode:!!(e!=null&&e.readableObjectMode),writableObjectMode:!!(r!=null&&r.writableObjectMode),readable:n,writable:i}),i&&(Jce(r,l=>{i=!1,l&&Y1(e,l),c(l)}),u._write=function(l,h,y){r.write(l,h)?y():o=y},u._final=function(l){r.end(),s=l},r.on("drain",function(){if(o){let l=o;o=null,l()}}),r.on("finish",function(){if(s){let l=s;s=null,l()}})),n&&(Jce(e,l=>{n=!1,l&&Y1(e,l),c(l)}),e.on("readable",function(){if(a){let l=a;a=null,l()}}),e.on("end",function(){u.push(null)}),u._read=function(){for(;;){let l=e.read();if(l===null){a=u._read;return}if(!u.push(l))return}}),u._destroy=function(l,h){!l&&d!==null&&(l=new tde),a=null,o=null,s=null,d===null?h(l):(d=h,Y1(r,l),Y1(e,l))},u}});var lf=W((ixt,ade)=>{"use strict";f();var{ObjectDefineProperties:QNe,ObjectGetOwnPropertyDescriptor:Hh,ObjectKeys:eUe,ObjectSetPrototypeOf:ode}=ci();ade.exports=Qu;var m$=E6(),Hd=ek();ode(Qu.prototype,m$.prototype);ode(Qu,m$);{let t=eUe(Hd.prototype);for(let e=0;e<t.length;e++){let r=t[e];Qu.prototype[r]||(Qu.prototype[r]=Hd.prototype[r])}}function Qu(t){if(!(this instanceof Qu))return new Qu(t);m$.call(this,t),Hd.call(this,t),t?(this.allowHalfOpen=t.allowHalfOpen!==!1,t.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),t.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}QNe(Qu.prototype,{writable:{__proto__:null,...Hh(Hd.prototype,"writable")},writableHighWaterMark:{__proto__:null,...Hh(Hd.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...Hh(Hd.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...Hh(Hd.prototype,"writableBuffer")},writableLength:{__proto__:null,...Hh(Hd.prototype,"writableLength")},writableFinished:{__proto__:null,...Hh(Hd.prototype,"writableFinished")},writableCorked:{__proto__:null,...Hh(Hd.prototype,"writableCorked")},writableEnded:{__proto__:null,...Hh(Hd.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...Hh(Hd.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(t){this._readableState&&this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}});var p$;function sde(){return p$===void 0&&(p$={}),p$}Qu.fromWeb=function(t,e){return sde().newStreamDuplexFromReadableWritablePair(t,e)};Qu.toWeb=function(t){return sde().newReadableWritablePairFromDuplex(t)};var y$;Qu.from=function(t){return y$||(y$=ide()),y$(t,"body")}});var b$=W((sxt,dde)=>{"use strict";f();var{ObjectSetPrototypeOf:cde,Symbol:tUe}=ci();dde.exports=Wh;var{ERR_METHOD_NOT_IMPLEMENTED:rUe}=Ca().codes,v$=lf(),{getHighWaterMark:nUe}=_6();cde(Wh.prototype,v$.prototype);cde(Wh,v$);var k6=tUe("kCallback");function Wh(t){if(!(this instanceof Wh))return new Wh(t);let e=t?nUe(this,t,"readableHighWaterMark",!0):null;e===0&&(t={...t,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:t.writableHighWaterMark||0}),v$.call(this,t),this._readableState.sync=!1,this[k6]=null,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",iUe)}function g$(t){typeof this._flush=="function"&&!this.destroyed?this._flush((e,r)=>{if(e){t?t(e):this.destroy(e);return}r!=null&&this.push(r),this.push(null),t&&t()}):(this.push(null),t&&t())}function iUe(){this._final!==g$&&g$.call(this)}Wh.prototype._final=g$;Wh.prototype._transform=function(t,e,r){throw new rUe("_transform()")};Wh.prototype._write=function(t,e,r){let n=this._readableState,i=this._writableState,o=n.length;this._transform(t,e,(s,a)=>{if(s){r(s);return}a!=null&&this.push(a),i.ended||o===n.length||n.length<n.highWaterMark?r():this[k6]=r})};Wh.prototype._read=function(){if(this[k6]){let t=this[k6];this[k6]=null,t()}}});var _$=W((cxt,lde)=>{"use strict";f();var{ObjectSetPrototypeOf:ude}=ci();lde.exports=Z1;var w$=b$();ude(Z1.prototype,w$.prototype);ude(Z1,w$);function Z1(t){if(!(this instanceof Z1))return new Z1(t);w$.call(this,t)}Z1.prototype._transform=function(t,e,r){r(null,t)}});var ik=W((uxt,mde)=>{f();var P6=Fs(),{ArrayIsArray:oUe,Promise:sUe,SymbolAsyncIterator:aUe,SymbolDispose:cUe}=ci(),nk=Vh(),{once:dUe}=ca(),uUe=iv(),fde=lf(),{aggregateTwoErrors:lUe,codes:{ERR_INVALID_ARG_TYPE:R$,ERR_INVALID_RETURN_VALUE:x$,ERR_MISSING_ARGS:fUe,ERR_STREAM_DESTROYED:hUe,ERR_STREAM_PREMATURE_CLOSE:pUe},AbortError:yUe}=Ca(),{validateFunction:mUe,validateAbortSignal:gUe}=L1(),{isIterable:av,isReadable:E$,isReadableNodeStream:rk,isNodeStream:hde,isTransformStream:X1,isWebStream:vUe,isReadableStream:S$,isReadableFinished:bUe}=df(),wUe=globalThis.AbortController||zh().AbortController,T$,A$,k$;function pde(t,e,r){let n=!1;t.on("close",()=>{n=!0});let i=nk(t,{readable:e,writable:r},o=>{n=!o});return{destroy:o=>{n||(n=!0,uUe.destroyer(t,o||new hUe("pipe")))},cleanup:i}}function _Ue(t){return mUe(t[t.length-1],"streams[stream.length - 1]"),t.pop()}function P$(t){if(av(t))return t;if(rk(t))return xUe(t);throw new R$("val",["Readable","Iterable","AsyncIterable"],t)}async function*xUe(t){A$||(A$=E6()),yield*A$.prototype[aUe].call(t)}async function tk(t,e,r,{end:n}){let i,o=null,s=u=>{if(u&&(i=u),o){let c=o;o=null,c()}},a=()=>new sUe((u,c)=>{i?c(i):o=()=>{i?c(i):u()}});e.on("drain",s);let d=nk(e,{readable:!1},s);try{e.writableNeedDrain&&await a();for await(let u of t)e.write(u)||await a();n&&(e.end(),await a()),r()}catch(u){r(i!==u?lUe(i,u):u)}finally{d(),e.off("drain",s)}}async function I$(t,e,r,{end:n}){X1(e)&&(e=e.writable);let i=e.getWriter();try{for await(let o of t)await i.ready,i.write(o).catch(()=>{});await i.ready,n&&await i.close(),r()}catch(o){try{await i.abort(o),r(o)}catch(s){r(s)}}}function EUe(...t){return yde(t,dUe(_Ue(t)))}function yde(t,e,r){if(t.length===1&&oUe(t[0])&&(t=t[0]),t.length<2)throw new fUe("streams");let n=new wUe,i=n.signal,o=r?.signal,s=[];gUe(o,"options.signal");function a(){g(new yUe)}k$=k$||ca().addAbortListener;let d;o&&(d=k$(o,a));let u,c,l=[],h=0;function y(T){g(T,--h===0)}function g(T,$){var j;if(T&&(!u||u.code==="ERR_STREAM_PREMATURE_CLOSE")&&(u=T),!(!u&&!$)){for(;l.length;)l.shift()(u);(j=d)===null||j===void 0||j[cUe](),n.abort(),$&&(u||s.forEach(K=>K()),P6.nextTick(e,u,c))}}let v;for(let T=0;T<t.length;T++){let $=t[T],j=T<t.length-1,K=T>0,F=j||r?.end!==!1,L=T===t.length-1;if(hde($)){let V=function(q){q&&q.name!=="AbortError"&&q.code!=="ERR_STREAM_PREMATURE_CLOSE"&&y(q)};var A=V;if(F){let{destroy:q,cleanup:k}=pde($,j,K);l.push(q),E$($)&&L&&s.push(k)}$.on("error",V),E$($)&&L&&s.push(()=>{$.removeListener("error",V)})}if(T===0)if(typeof $=="function"){if(v=$({signal:i}),!av(v))throw new x$("Iterable, AsyncIterable or Stream","source",v)}else av($)||rk($)||X1($)?v=$:v=fde.from($);else if(typeof $=="function"){if(X1(v)){var x;v=P$((x=v)===null||x===void 0?void 0:x.readable)}else v=P$(v);if(v=$(v,{signal:i}),j){if(!av(v,!0))throw new x$("AsyncIterable",`transform[${T-1}]`,v)}else{var S;T$||(T$=_$());let V=new T$({objectMode:!0}),q=(S=v)===null||S===void 0?void 0:S.then;if(typeof q=="function")h++,q.call(v,B=>{c=B,B!=null&&V.write(B),F&&V.end(),P6.nextTick(y)},B=>{V.destroy(B),P6.nextTick(y,B)});else if(av(v,!0))h++,tk(v,V,y,{end:F});else if(S$(v)||X1(v)){let B=v.readable||v;h++,tk(B,V,y,{end:F})}else throw new x$("AsyncIterable or Promise","destination",v);v=V;let{destroy:k,cleanup:P}=pde(v,!1,!0);l.push(k),L&&s.push(P)}}else if(hde($)){if(rk(v)){h+=2;let V=SUe(v,$,y,{end:F});E$($)&&L&&s.push(V)}else if(X1(v)||S$(v)){let V=v.readable||v;h++,tk(V,$,y,{end:F})}else if(av(v))h++,tk(v,$,y,{end:F});else throw new R$("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],v);v=$}else if(vUe($)){if(rk(v))h++,I$(P$(v),$,y,{end:F});else if(S$(v)||av(v))h++,I$(v,$,y,{end:F});else if(X1(v))h++,I$(v.readable,$,y,{end:F});else throw new R$("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],v);v=$}else v=fde.from($)}return(i!=null&&i.aborted||o!=null&&o.aborted)&&P6.nextTick(a),v}function SUe(t,e,r,{end:n}){let i=!1;if(e.on("close",()=>{i||r(new pUe)}),t.pipe(e,{end:!1}),n){let s=function(){i=!0,e.end()};var o=s;bUe(t)?P6.nextTick(s):t.once("end",s)}else r();return nk(t,{readable:!0,writable:!1},s=>{let a=t._readableState;s&&s.code==="ERR_STREAM_PREMATURE_CLOSE"&&a&&a.ended&&!a.errored&&!a.errorEmitted?t.once("end",r).once("error",r):r(s)}),nk(e,{readable:!1,writable:!0},r)}mde.exports={pipelineImpl:yde,pipeline:EUe}});var O$=W((fxt,xde)=>{"use strict";f();var{pipeline:TUe}=ik(),ok=lf(),{destroyer:AUe}=iv(),{isNodeStream:sk,isReadable:gde,isWritable:vde,isWebStream:B$,isTransformStream:cv,isWritableStream:bde,isReadableStream:wde}=df(),{AbortError:kUe,codes:{ERR_INVALID_ARG_VALUE:_de,ERR_MISSING_ARGS:PUe}}=Ca(),IUe=Vh();xde.exports=function(...e){if(e.length===0)throw new PUe("streams");if(e.length===1)return ok.from(e[0]);let r=[...e];if(typeof e[0]=="function"&&(e[0]=ok.from(e[0])),typeof e[e.length-1]=="function"){let y=e.length-1;e[y]=ok.from(e[y])}for(let y=0;y<e.length;++y)if(!(!sk(e[y])&&!B$(e[y]))){if(y<e.length-1&&!(gde(e[y])||wde(e[y])||cv(e[y])))throw new _de(`streams[${y}]`,r[y],"must be readable");if(y>0&&!(vde(e[y])||bde(e[y])||cv(e[y])))throw new _de(`streams[${y}]`,r[y],"must be writable")}let n,i,o,s,a;function d(y){let g=s;s=null,g?g(y):y?a.destroy(y):!h&&!l&&a.destroy()}let u=e[0],c=TUe(e,d),l=!!(vde(u)||bde(u)||cv(u)),h=!!(gde(c)||wde(c)||cv(c));if(a=new ok({writableObjectMode:!!(u!=null&&u.writableObjectMode),readableObjectMode:!!(c!=null&&c.readableObjectMode),writable:l,readable:h}),l){if(sk(u))a._write=function(g,v,x){u.write(g,v)?x():n=x},a._final=function(g){u.end(),i=g},u.on("drain",function(){if(n){let g=n;n=null,g()}});else if(B$(u)){let v=(cv(u)?u.writable:u).getWriter();a._write=async function(x,S,A){try{await v.ready,v.write(x).catch(()=>{}),A()}catch(T){A(T)}},a._final=async function(x){try{await v.ready,v.close().catch(()=>{}),i=x}catch(S){x(S)}}}let y=cv(c)?c.readable:c;IUe(y,()=>{if(i){let g=i;i=null,g()}})}if(h){if(sk(c))c.on("readable",function(){if(o){let y=o;o=null,y()}}),c.on("end",function(){a.push(null)}),a._read=function(){for(;;){let y=c.read();if(y===null){o=a._read;return}if(!a.push(y))return}};else if(B$(c)){let g=(cv(c)?c.readable:c).getReader();a._read=async function(){for(;;)try{let{value:v,done:x}=await g.read();if(!a.push(v))return;if(x){a.push(null);return}}catch{return}}}}return a._destroy=function(y,g){!y&&s!==null&&(y=new kUe),o=null,n=null,i=null,s===null?g(y):(s=g,sk(c)&&AUe(c,y))},a}});var Ode=W((pxt,C$)=>{"use strict";f();var RUe=globalThis.AbortController||zh().AbortController,{codes:{ERR_INVALID_ARG_VALUE:BUe,ERR_INVALID_ARG_TYPE:I6,ERR_MISSING_ARGS:OUe,ERR_OUT_OF_RANGE:MUe},AbortError:ff}=Ca(),{validateAbortSignal:dv,validateInteger:Ede,validateObject:uv}=L1(),DUe=ci().Symbol("kWeak"),CUe=ci().Symbol("kResistStopPropagation"),{finished:jUe}=Vh(),$Ue=O$(),{addAbortSignalNoValidate:NUe}=w6(),{isWritable:UUe,isNodeStream:KUe}=df(),{deprecate:qUe}=ca(),{ArrayPrototypePush:LUe,Boolean:FUe,MathFloor:Sde,Number:zUe,NumberIsNaN:VUe,Promise:Tde,PromiseReject:Ade,PromiseResolve:HUe,PromisePrototypeThen:kde,Symbol:Ide}=ci(),ak=Ide("kEmpty"),Pde=Ide("kEof");function WUe(t,e){if(e!=null&&uv(e,"options"),e?.signal!=null&&dv(e.signal,"options.signal"),KUe(t)&&!UUe(t))throw new BUe("stream",t,"must be writable");let r=$Ue(this,t);return e!=null&&e.signal&&NUe(e.signal,r),r}function ck(t,e){if(typeof t!="function")throw new I6("fn",["Function","AsyncFunction"],t);e!=null&&uv(e,"options"),e?.signal!=null&&dv(e.signal,"options.signal");let r=1;e?.concurrency!=null&&(r=Sde(e.concurrency));let n=r-1;return e?.highWaterMark!=null&&(n=Sde(e.highWaterMark)),Ede(r,"options.concurrency",1),Ede(n,"options.highWaterMark",0),n+=r,(async function*(){let o=ca().AbortSignalAny([e?.signal].filter(FUe)),s=this,a=[],d={signal:o},u,c,l=!1,h=0;function y(){l=!0,g()}function g(){h-=1,v()}function v(){c&&!l&&h<r&&a.length<n&&(c(),c=null)}async function x(){try{for await(let S of s){if(l)return;if(o.aborted)throw new ff;try{if(S=t(S,d),S===ak)continue;S=HUe(S)}catch(A){S=Ade(A)}h+=1,kde(S,g,y),a.push(S),u&&(u(),u=null),!l&&(a.length>=n||h>=r)&&await new Tde(A=>{c=A})}a.push(Pde)}catch(S){let A=Ade(S);kde(A,g,y),a.push(A)}finally{l=!0,u&&(u(),u=null)}}x();try{for(;;){for(;a.length>0;){let S=await a[0];if(S===Pde)return;if(o.aborted)throw new ff;S!==ak&&(yield S),a.shift(),v()}await new Tde(S=>{u=S})}}finally{l=!0,c&&(c(),c=null)}}).call(this)}function GUe(t=void 0){return t!=null&&uv(t,"options"),t?.signal!=null&&dv(t.signal,"options.signal"),(async function*(){let r=0;for await(let i of this){var n;if(t!=null&&(n=t.signal)!==null&&n!==void 0&&n.aborted)throw new ff({cause:t.signal.reason});yield[r++,i]}}).call(this)}async function Rde(t,e=void 0){for await(let r of D$.call(this,t,e))return!0;return!1}async function JUe(t,e=void 0){if(typeof t!="function")throw new I6("fn",["Function","AsyncFunction"],t);return!await Rde.call(this,async(...r)=>!await t(...r),e)}async function YUe(t,e){for await(let r of D$.call(this,t,e))return r}async function ZUe(t,e){if(typeof t!="function")throw new I6("fn",["Function","AsyncFunction"],t);async function r(n,i){return await t(n,i),ak}for await(let n of ck.call(this,r,e));}function D$(t,e){if(typeof t!="function")throw new I6("fn",["Function","AsyncFunction"],t);async function r(n,i){return await t(n,i)?n:ak}return ck.call(this,r,e)}var M$=class extends OUe{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function XUe(t,e,r){var n;if(typeof t!="function")throw new I6("reducer",["Function","AsyncFunction"],t);r!=null&&uv(r,"options"),r?.signal!=null&&dv(r.signal,"options.signal");let i=arguments.length>1;if(r!=null&&(n=r.signal)!==null&&n!==void 0&&n.aborted){let u=new ff(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await jUe(this.destroy(u)),u}let o=new RUe,s=o.signal;if(r!=null&&r.signal){let u={once:!0,[DUe]:this,[CUe]:!0};r.signal.addEventListener("abort",()=>o.abort(),u)}let a=!1;try{for await(let u of this){var d;if(a=!0,r!=null&&(d=r.signal)!==null&&d!==void 0&&d.aborted)throw new ff;i?e=await t(e,u,{signal:s}):(e=u,i=!0)}if(!a&&!i)throw new M$}finally{o.abort()}return e}async function QUe(t){t!=null&&uv(t,"options"),t?.signal!=null&&dv(t.signal,"options.signal");let e=[];for await(let n of this){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new ff(void 0,{cause:t.signal.reason});LUe(e,n)}return e}function eKe(t,e){let r=ck.call(this,t,e);return(async function*(){for await(let i of r)yield*i}).call(this)}function Bde(t){if(t=zUe(t),VUe(t))return 0;if(t<0)throw new MUe("number",">= 0",t);return t}function tKe(t,e=void 0){return e!=null&&uv(e,"options"),e?.signal!=null&&dv(e.signal,"options.signal"),t=Bde(t),(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new ff;for await(let o of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new ff;t--<=0&&(yield o)}}).call(this)}function rKe(t,e=void 0){return e!=null&&uv(e,"options"),e?.signal!=null&&dv(e.signal,"options.signal"),t=Bde(t),(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new ff;for await(let o of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new ff;if(t-- >0&&(yield o),t<=0)return}}).call(this)}C$.exports.streamReturningOperators={asIndexedPairs:qUe(GUe,"readable.asIndexedPairs will be removed in a future version."),drop:tKe,filter:D$,flatMap:eKe,map:ck,take:rKe,compose:WUe};C$.exports.promiseReturningOperators={every:JUe,forEach:ZUe,reduce:XUe,toArray:QUe,some:Rde,find:YUe}});var j$=W((mxt,Mde)=>{"use strict";f();var{ArrayPrototypePop:nKe,Promise:iKe}=ci(),{isIterable:oKe,isNodeStream:sKe,isWebStream:aKe}=df(),{pipelineImpl:cKe}=ik(),{finished:dKe}=Vh();$$();function uKe(...t){return new iKe((e,r)=>{let n,i,o=t[t.length-1];if(o&&typeof o=="object"&&!sKe(o)&&!oKe(o)&&!aKe(o)){let s=nKe(t);n=s.signal,i=s.end}cKe(t,(s,a)=>{s?r(s):e(a)},{signal:n,end:i})})}Mde.exports={finished:dKe,pipeline:uKe}});var $$=W((vxt,Lde)=>{f();var{Buffer:lKe}=bn(),{ObjectDefineProperty:Gh,ObjectKeys:jde,ReflectApply:$de}=ci(),{promisify:{custom:Nde}}=ca(),{streamReturningOperators:Dde,promiseReturningOperators:Cde}=Ode(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:Ude}}=Ca(),fKe=O$(),{setDefaultHighWaterMark:hKe,getDefaultHighWaterMark:pKe}=_6(),{pipeline:Kde}=ik(),{destroyer:yKe}=iv(),qde=Vh(),N$=j$(),R6=df(),Wn=Lde.exports=L4().Stream;Wn.isDestroyed=R6.isDestroyed;Wn.isDisturbed=R6.isDisturbed;Wn.isErrored=R6.isErrored;Wn.isReadable=R6.isReadable;Wn.isWritable=R6.isWritable;Wn.Readable=E6();for(let t of jde(Dde)){let r=function(...n){if(new.target)throw Ude();return Wn.Readable.from($de(e,this,n))};U$=r;let e=Dde[t];Gh(r,"name",{__proto__:null,value:e.name}),Gh(r,"length",{__proto__:null,value:e.length}),Gh(Wn.Readable.prototype,t,{__proto__:null,value:r,enumerable:!1,configurable:!0,writable:!0})}var U$;for(let t of jde(Cde)){let r=function(...i){if(new.target)throw Ude();return $de(e,this,i)};U$=r;let e=Cde[t];Gh(r,"name",{__proto__:null,value:e.name}),Gh(r,"length",{__proto__:null,value:e.length}),Gh(Wn.Readable.prototype,t,{__proto__:null,value:r,enumerable:!1,configurable:!0,writable:!0})}var U$;Wn.Writable=ek();Wn.Duplex=lf();Wn.Transform=b$();Wn.PassThrough=_$();Wn.pipeline=Kde;var{addAbortSignal:mKe}=w6();Wn.addAbortSignal=mKe;Wn.finished=qde;Wn.destroy=yKe;Wn.compose=fKe;Wn.setDefaultHighWaterMark=hKe;Wn.getDefaultHighWaterMark=pKe;Gh(Wn,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return N$}});Gh(Kde,Nde,{__proto__:null,enumerable:!0,get(){return N$.pipeline}});Gh(qde,Nde,{__proto__:null,enumerable:!0,get(){return N$.finished}});Wn.Stream=Wn;Wn._isUint8Array=function(e){return e instanceof Uint8Array};Wn._uint8ArrayToBuffer=function(e){return lKe.from(e.buffer,e.byteOffset,e.byteLength)}});var dk=W((wxt,Di)=>{"use strict";f();var co=$$(),gKe=j$(),vKe=co.Readable.destroy;Di.exports=co.Readable;Di.exports._uint8ArrayToBuffer=co._uint8ArrayToBuffer;Di.exports._isUint8Array=co._isUint8Array;Di.exports.isDisturbed=co.isDisturbed;Di.exports.isErrored=co.isErrored;Di.exports.isReadable=co.isReadable;Di.exports.Readable=co.Readable;Di.exports.Writable=co.Writable;Di.exports.Duplex=co.Duplex;Di.exports.Transform=co.Transform;Di.exports.PassThrough=co.PassThrough;Di.exports.addAbortSignal=co.addAbortSignal;Di.exports.finished=co.finished;Di.exports.destroy=co.destroy;Di.exports.destroy=vKe;Di.exports.pipeline=co.pipeline;Di.exports.compose=co.compose;Object.defineProperty(co,"promises",{configurable:!0,enumerable:!0,get(){return gKe}});Di.exports.Stream=co.Stream;Di.exports.default=Di.exports});var Hde=W((z$,V$)=>{f();(function(t,e){typeof z$=="object"&&typeof V$<"u"?V$.exports=e():typeof define=="function"&&define.amd?define(e):(t=t||self,t.JSBI=e())})(z$,function(){"use strict";var t=Math.imul,e=Math.clz32;function r(L){"@babel/helpers - typeof";return r=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(V){return typeof V}:function(V){return V&&typeof Symbol=="function"&&V.constructor===Symbol&&V!==Symbol.prototype?"symbol":typeof V},r(L)}function n(L,V){if(!(L instanceof V))throw new TypeError("Cannot call a class as a function")}function i(L,V){for(var q,k=0;k<V.length;k++)q=V[k],q.enumerable=q.enumerable||!1,q.configurable=!0,"value"in q&&(q.writable=!0),Object.defineProperty(L,q.key,q)}function o(L,V,q){return V&&i(L.prototype,V),q&&i(L,q),Object.defineProperty(L,"prototype",{writable:!1}),L}function s(L,V){if(typeof V!="function"&&V!==null)throw new TypeError("Super expression must either be null or a function");L.prototype=Object.create(V&&V.prototype,{constructor:{value:L,writable:!0,configurable:!0}}),Object.defineProperty(L,"prototype",{writable:!1}),V&&d(L,V)}function a(L){return a=Object.setPrototypeOf?Object.getPrototypeOf:function(V){return V.__proto__||Object.getPrototypeOf(V)},a(L)}function d(L,V){return d=Object.setPrototypeOf||function(q,k){return q.__proto__=k,q},d(L,V)}function u(){if(typeof Reflect>"u"||!Reflect.construct||Reflect.construct.sham)return!1;if(typeof Proxy=="function")return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch{return!1}}function c(){return c=u()?Reflect.construct:function(L,V,q){var k=[null];k.push.apply(k,V);var P=Function.bind.apply(L,k),B=new P;return q&&d(B,q.prototype),B},c.apply(null,arguments)}function l(L){return Function.toString.call(L).indexOf("[native code]")!==-1}function h(L){var V=typeof Map=="function"?new Map:void 0;return h=function(q){function k(){return c(q,arguments,a(this).constructor)}if(q===null||!l(q))return q;if(typeof q!="function")throw new TypeError("Super expression must either be null or a function");if(typeof V<"u"){if(V.has(q))return V.get(q);V.set(q,k)}return k.prototype=Object.create(q.prototype,{constructor:{value:k,enumerable:!1,writable:!0,configurable:!0}}),d(k,q)},h(L)}function y(L){if(L===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return L}function g(L,V){if(V&&(typeof V=="object"||typeof V=="function"))return V;if(V!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return y(L)}function v(L){var V=u();return function(){var q,k=a(L);if(V){var P=a(this).constructor;q=Reflect.construct(k,arguments,P)}else q=k.apply(this,arguments);return g(this,q)}}function x(L,V){return S(L)||A(L,V)||T(L,V)||j()}function S(L){if(Array.isArray(L))return L}function A(L,V){var q=L==null?null:typeof Symbol<"u"&&L[Symbol.iterator]||L["@@iterator"];if(q!=null){var k,P,B=[],p=!0,m=!1;try{for(q=q.call(L);!(p=(k=q.next()).done)&&(B.push(k.value),!(V&&B.length===V));p=!0);}catch(w){m=!0,P=w}finally{try{p||q.return==null||q.return()}finally{if(m)throw P}}return B}}function T(L,V){if(L){if(typeof L=="string")return $(L,V);var q=Object.prototype.toString.call(L).slice(8,-1);return q==="Object"&&L.constructor&&(q=L.constructor.name),q==="Map"||q==="Set"?Array.from(L):q==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(q)?$(L,V):void 0}}function $(L,V){(V==null||V>L.length)&&(V=L.length);for(var q=0,k=Array(V);q<V;q++)k[q]=L[q];return k}function j(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function K(L,V){var q=typeof Symbol<"u"&&L[Symbol.iterator]||L["@@iterator"];if(!q){if(Array.isArray(L)||(q=T(L))||V&&L&&typeof L.length=="number"){q&&(L=q);var k=0,P=function(){};return{s:P,n:function(){return k>=L.length?{done:!0}:{done:!1,value:L[k++]}},e:function(w){throw w},f:P}}throw new TypeError(`Invalid attempt to iterate non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}var B,p=!0,m=!1;return{s:function(){q=q.call(L)},n:function(){var w=q.next();return p=w.done,w},e:function(w){m=!0,B=w},f:function(){try{p||q.return==null||q.return()}finally{if(m)throw B}}}}var F=function(L){var V=Math.abs,q=Math.max,k=Math.floor;function P(p,m){var w;if(n(this,P),w=B.call(this,p),w.sign=m,Object.setPrototypeOf(y(w),P.prototype),p>P.__kMaxLength)throw new RangeError("Maximum BigInt size exceeded");return w}s(P,L);var B=v(P);return o(P,[{key:"toDebugString",value:function(){var p,m=["BigInt["],w=K(this);try{for(w.s();!(p=w.n()).done;){var E=p.value;m.push((E&&(E>>>0).toString(16))+", ")}}catch(_){w.e(_)}finally{w.f()}return m.push("]"),m.join("")}},{key:"toString",value:function(){var p=0<arguments.length&&arguments[0]!==void 0?arguments[0]:10;if(2>p||36<p)throw new RangeError("toString() radix argument must be between 2 and 36");return this.length===0?"0":p&p-1?P.__toStringGeneric(this,p,!1):P.__toStringBasePowerOfTwo(this,p)}},{key:"valueOf",value:function(){throw new Error("Convert JSBI instances to native numbers using `toNumber`.")}},{key:"__copy",value:function(){for(var p=new P(this.length,this.sign),m=0;m<this.length;m++)p[m]=this[m];return p}},{key:"__trim",value:function(){for(var p=this.length,m=this[p-1];m===0;)p--,m=this[p-1],this.pop();return p===0&&(this.sign=!1),this}},{key:"__initializeDigits",value:function(){for(var p=0;p<this.length;p++)this[p]=0}},{key:"__clzmsd",value:function(){return P.__clz30(this.__digit(this.length-1))}},{key:"__inplaceMultiplyAdd",value:function(p,m,w){w>this.length&&(w=this.length);for(var E=32767&p,_=p>>>15,b=0,C=m,N=0;N<w;N++){var D=this.__digit(N),U=32767&D,G=D>>>15,Y=P.__imul(U,E),J=P.__imul(U,_),H=P.__imul(G,E),X=P.__imul(G,_),te=C+Y+b;b=te>>>30,te&=1073741823,te+=((32767&J)<<15)+((32767&H)<<15),b+=te>>>30,C=X+(J>>>15)+(H>>>15),this.__setDigit(N,1073741823&te)}if(b!==0||C!==0)throw new Error("implementation bug")}},{key:"__inplaceAdd",value:function(p,m,w){for(var E,_=0,b=0;b<w;b++)E=this.__halfDigit(m+b)+p.__halfDigit(b)+_,_=E>>>15,this.__setHalfDigit(m+b,32767&E);return _}},{key:"__inplaceSub",value:function(p,m,w){var E=0;if(1&m){m>>=1;for(var _=this.__digit(m),b=32767&_,C=0;C<w-1>>>1;C++){var N=p.__digit(C),D=(_>>>15)-(32767&N)-E;E=1&D>>>15,this.__setDigit(m+C,(32767&D)<<15|32767&b),_=this.__digit(m+C+1),b=(32767&_)-(N>>>15)-E,E=1&b>>>15}var U=p.__digit(C),G=(_>>>15)-(32767&U)-E;if(E=1&G>>>15,this.__setDigit(m+C,(32767&G)<<15|32767&b),m+C+1>=this.length)throw new RangeError("out of bounds");!(1&w)&&(_=this.__digit(m+C+1),b=(32767&_)-(U>>>15)-E,E=1&b>>>15,this.__setDigit(m+p.length,1073709056&_|32767&b))}else{m>>=1;for(var Y=0;Y<p.length-1;Y++){var J=this.__digit(m+Y),H=p.__digit(Y),X=(32767&J)-(32767&H)-E;E=1&X>>>15;var te=(J>>>15)-(H>>>15)-E;E=1&te>>>15,this.__setDigit(m+Y,(32767&te)<<15|32767&X)}var ne=this.__digit(m+Y),Q=p.__digit(Y),re=(32767&ne)-(32767&Q)-E;E=1&re>>>15;var ae=0;!(1&w)&&(ae=(ne>>>15)-(Q>>>15)-E,E=1&ae>>>15),this.__setDigit(m+Y,(32767&ae)<<15|32767&re)}return E}},{key:"__inplaceRightShift",value:function(p){if(p!==0){for(var m,w=this.__digit(0)>>>p,E=this.length-1,_=0;_<E;_++)m=this.__digit(_+1),this.__setDigit(_,1073741823&m<<30-p|w),w=m>>>p;this.__setDigit(E,w)}}},{key:"__digit",value:function(p){return this[p]}},{key:"__unsignedDigit",value:function(p){return this[p]>>>0}},{key:"__setDigit",value:function(p,m){this[p]=0|m}},{key:"__setDigitGrow",value:function(p,m){this[p]=0|m}},{key:"__halfDigitLength",value:function(){var p=this.length;return 32767>=this.__unsignedDigit(p-1)?2*p-1:2*p}},{key:"__halfDigit",value:function(p){return 32767&this[p>>>1]>>>15*(1&p)}},{key:"__setHalfDigit",value:function(p,m){var w=p>>>1,E=this.__digit(w),_=1&p?32767&E|m<<15:1073709056&E|32767&m;this.__setDigit(w,_)}}],[{key:"BigInt",value:function(p){var m=Number.isFinite;if(typeof p=="number"){if(p===0)return P.__zero();if(P.__isOneDigitInt(p))return 0>p?P.__oneDigit(-p,!0):P.__oneDigit(p,!1);if(!m(p)||k(p)!==p)throw new RangeError("The number "+p+" cannot be converted to BigInt because it is not an integer");return P.__fromDouble(p)}if(typeof p=="string"){var w=P.__fromString(p);if(w===null)throw new SyntaxError("Cannot convert "+p+" to a BigInt");return w}if(typeof p=="boolean")return p===!0?P.__oneDigit(1,!1):P.__zero();if(r(p)==="object"){if(p.constructor===P)return p;var E=P.__toPrimitive(p);return P.BigInt(E)}throw new TypeError("Cannot convert "+p+" to a BigInt")}},{key:"toNumber",value:function(p){var m=p.length;if(m===0)return 0;if(m===1){var w=p.__unsignedDigit(0);return p.sign?-w:w}var E=p.__digit(m-1),_=P.__clz30(E),b=30*m-_;if(1024<b)return p.sign?-1/0:1/0;var C=b-1,N=E,D=m-1,U=_+3,G=U===32?0:N<<U;G>>>=12;var Y=U-12,J=12<=U?0:N<<20+U,H=20+U;for(0<Y&&0<D&&(D--,N=p.__digit(D),G|=N>>>30-Y,J=N<<Y+2,H=Y+2);0<H&&0<D;)D--,N=p.__digit(D),J|=30<=H?N<<H-30:N>>>30-H,H-=30;var X=P.__decideRounding(p,H,D,N);if((X===1||X===0&&(1&J)==1)&&(J=J+1>>>0,J===0&&(G++,G>>>20!=0&&(G=0,C++,1023<C))))return p.sign?-1/0:1/0;var te=p.sign?-2147483648:0;return C=C+1023<<20,P.__kBitConversionInts[1]=te|C|G,P.__kBitConversionInts[0]=J,P.__kBitConversionDouble[0]}},{key:"unaryMinus",value:function(p){if(p.length===0)return p;var m=p.__copy();return m.sign=!p.sign,m}},{key:"bitwiseNot",value:function(p){return p.sign?P.__absoluteSubOne(p).__trim():P.__absoluteAddOne(p,!0)}},{key:"exponentiate",value:function(p,m){if(m.sign)throw new RangeError("Exponent must be positive");if(m.length===0)return P.__oneDigit(1,!1);if(p.length===0)return p;if(p.length===1&&p.__digit(0)===1)return p.sign&&!(1&m.__digit(0))?P.unaryMinus(p):p;if(1<m.length)throw new RangeError("BigInt too big");var w=m.__unsignedDigit(0);if(w===1)return p;if(w>=P.__kMaxLengthBits)throw new RangeError("BigInt too big");if(p.length===1&&p.__digit(0)===2){var E=1+(0|w/30),_=p.sign&&(1&w)!=0,b=new P(E,_);b.__initializeDigits();var C=1<<w%30;return b.__setDigit(E-1,C),b}var N=null,D=p;for(1&w&&(N=p),w>>=1;w!==0;w>>=1)D=P.multiply(D,D),1&w&&(N===null?N=D:N=P.multiply(N,D));return N}},{key:"multiply",value:function(p,m){if(p.length===0)return p;if(m.length===0)return m;var w=p.length+m.length;30<=p.__clzmsd()+m.__clzmsd()&&w--;var E=new P(w,p.sign!==m.sign);E.__initializeDigits();for(var _=0;_<p.length;_++)P.__multiplyAccumulate(m,p.__digit(_),E,_);return E.__trim()}},{key:"divide",value:function(p,m){if(m.length===0)throw new RangeError("Division by zero");if(0>P.__absoluteCompare(p,m))return P.__zero();var w,E=p.sign!==m.sign,_=m.__unsignedDigit(0);if(m.length===1&&32767>=_){if(_===1)return E===p.sign?p:P.unaryMinus(p);w=P.__absoluteDivSmall(p,_,null)}else w=P.__absoluteDivLarge(p,m,!0,!1);return w.sign=E,w.__trim()}},{key:"remainder",value:function(m,w){if(w.length===0)throw new RangeError("Division by zero");if(0>P.__absoluteCompare(m,w))return m;var E=w.__unsignedDigit(0);if(w.length===1&&32767>=E){if(E===1)return P.__zero();var _=P.__absoluteModSmall(m,E);return _===0?P.__zero():P.__oneDigit(_,m.sign)}var b=P.__absoluteDivLarge(m,w,!1,!0);return b.sign=m.sign,b.__trim()}},{key:"add",value:function(p,m){var w=p.sign;return w===m.sign?P.__absoluteAdd(p,m,w):0<=P.__absoluteCompare(p,m)?P.__absoluteSub(p,m,w):P.__absoluteSub(m,p,!w)}},{key:"subtract",value:function(p,m){var w=p.sign;return w===m.sign?0<=P.__absoluteCompare(p,m)?P.__absoluteSub(p,m,w):P.__absoluteSub(m,p,!w):P.__absoluteAdd(p,m,w)}},{key:"leftShift",value:function(p,m){return m.length===0||p.length===0?p:m.sign?P.__rightShiftByAbsolute(p,m):P.__leftShiftByAbsolute(p,m)}},{key:"signedRightShift",value:function(p,m){return m.length===0||p.length===0?p:m.sign?P.__leftShiftByAbsolute(p,m):P.__rightShiftByAbsolute(p,m)}},{key:"unsignedRightShift",value:function(){throw new TypeError("BigInts have no unsigned right shift; use >> instead")}},{key:"lessThan",value:function(p,m){return 0>P.__compareToBigInt(p,m)}},{key:"lessThanOrEqual",value:function(p,m){return 0>=P.__compareToBigInt(p,m)}},{key:"greaterThan",value:function(p,m){return 0<P.__compareToBigInt(p,m)}},{key:"greaterThanOrEqual",value:function(p,m){return 0<=P.__compareToBigInt(p,m)}},{key:"equal",value:function(p,m){if(p.sign!==m.sign||p.length!==m.length)return!1;for(var w=0;w<p.length;w++)if(p.__digit(w)!==m.__digit(w))return!1;return!0}},{key:"notEqual",value:function(p,m){return!P.equal(p,m)}},{key:"bitwiseAnd",value:function(p,m){if(!p.sign&&!m.sign)return P.__absoluteAnd(p,m).__trim();if(p.sign&&m.sign){var w=q(p.length,m.length)+1,E=P.__absoluteSubOne(p,w),_=P.__absoluteSubOne(m);return E=P.__absoluteOr(E,_,E),P.__absoluteAddOne(E,!0,E).__trim()}if(p.sign){var b=[m,p];p=b[0],m=b[1]}return P.__absoluteAndNot(p,P.__absoluteSubOne(m)).__trim()}},{key:"bitwiseXor",value:function(p,m){if(!p.sign&&!m.sign)return P.__absoluteXor(p,m).__trim();if(p.sign&&m.sign){var w=q(p.length,m.length),E=P.__absoluteSubOne(p,w),_=P.__absoluteSubOne(m);return P.__absoluteXor(E,_,E).__trim()}var b=q(p.length,m.length)+1;if(p.sign){var C=[m,p];p=C[0],m=C[1]}var N=P.__absoluteSubOne(m,b);return N=P.__absoluteXor(N,p,N),P.__absoluteAddOne(N,!0,N).__trim()}},{key:"bitwiseOr",value:function(p,m){var w=q(p.length,m.length);if(!p.sign&&!m.sign)return P.__absoluteOr(p,m).__trim();if(p.sign&&m.sign){var E=P.__absoluteSubOne(p,w),_=P.__absoluteSubOne(m);return E=P.__absoluteAnd(E,_,E),P.__absoluteAddOne(E,!0,E).__trim()}if(p.sign){var b=[m,p];p=b[0],m=b[1]}var C=P.__absoluteSubOne(m,w);return C=P.__absoluteAndNot(C,p,C),P.__absoluteAddOne(C,!0,C).__trim()}},{key:"asIntN",value:function(p,m){if(m.length===0)return m;if(p=k(p),0>p)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(p===0)return P.__zero();if(p>=P.__kMaxLengthBits)return m;var w=0|(p+29)/30;if(m.length<w)return m;var E=m.__unsignedDigit(w-1),_=1<<(p-1)%30;if(m.length===w&&E<_)return m;if((E&_)!==_)return P.__truncateToNBits(p,m);if(!m.sign)return P.__truncateAndSubFromPowerOfTwo(p,m,!0);if(!(E&_-1)){for(var b=w-2;0<=b;b--)if(m.__digit(b)!==0)return P.__truncateAndSubFromPowerOfTwo(p,m,!1);return m.length===w&&E===_?m:P.__truncateToNBits(p,m)}return P.__truncateAndSubFromPowerOfTwo(p,m,!1)}},{key:"asUintN",value:function(p,m){if(m.length===0)return m;if(p=k(p),0>p)throw new RangeError("Invalid value: not (convertible to) a safe integer");if(p===0)return P.__zero();if(m.sign){if(p>P.__kMaxLengthBits)throw new RangeError("BigInt too big");return P.__truncateAndSubFromPowerOfTwo(p,m,!1)}if(p>=P.__kMaxLengthBits)return m;var w=0|(p+29)/30;if(m.length<w)return m;var E=p%30;if(m.length==w){if(E===0)return m;var _=m.__digit(w-1);if(!(_>>>E))return m}return P.__truncateToNBits(p,m)}},{key:"ADD",value:function(p,m){if(p=P.__toPrimitive(p),m=P.__toPrimitive(m),typeof p=="string")return typeof m!="string"&&(m=m.toString()),p+m;if(typeof m=="string")return p.toString()+m;if(p=P.__toNumeric(p),m=P.__toNumeric(m),P.__isBigInt(p)&&P.__isBigInt(m))return P.add(p,m);if(typeof p=="number"&&typeof m=="number")return p+m;throw new TypeError("Cannot mix BigInt and other types, use explicit conversions")}},{key:"LT",value:function(p,m){return P.__compare(p,m,0)}},{key:"LE",value:function(p,m){return P.__compare(p,m,1)}},{key:"GT",value:function(p,m){return P.__compare(p,m,2)}},{key:"GE",value:function(p,m){return P.__compare(p,m,3)}},{key:"EQ",value:function(p,m){for(;;){if(P.__isBigInt(p))return P.__isBigInt(m)?P.equal(p,m):P.EQ(m,p);if(typeof p=="number"){if(P.__isBigInt(m))return P.__equalToNumber(m,p);if(r(m)!=="object")return p==m;m=P.__toPrimitive(m)}else if(typeof p=="string"){if(P.__isBigInt(m))return p=P.__fromString(p),p!==null&&P.equal(p,m);if(r(m)!=="object")return p==m;m=P.__toPrimitive(m)}else if(typeof p=="boolean"){if(P.__isBigInt(m))return P.__equalToNumber(m,+p);if(r(m)!=="object")return p==m;m=P.__toPrimitive(m)}else if(r(p)==="symbol"){if(P.__isBigInt(m))return!1;if(r(m)!=="object")return p==m;m=P.__toPrimitive(m)}else if(r(p)==="object"){if(r(m)==="object"&&m.constructor!==P)return p==m;p=P.__toPrimitive(p)}else return p==m}}},{key:"NE",value:function(p,m){return!P.EQ(p,m)}},{key:"DataViewGetBigInt64",value:function(p,m){var w=2<arguments.length&&arguments[2]!==void 0&&arguments[2];return P.asIntN(64,P.DataViewGetBigUint64(p,m,w))}},{key:"DataViewGetBigUint64",value:function(p,m){var w=2<arguments.length&&arguments[2]!==void 0&&arguments[2],E=w?[4,0]:[0,4],_=x(E,2),b=_[0],C=_[1],N=p.getUint32(m+b,w),D=p.getUint32(m+C,w),U=new P(3,!1);return U.__setDigit(0,1073741823&D),U.__setDigit(1,(268435455&N)<<2|D>>>30),U.__setDigit(2,N>>>28),U.__trim()}},{key:"DataViewSetBigInt64",value:function(p,m,w){var E=3<arguments.length&&arguments[3]!==void 0&&arguments[3];P.DataViewSetBigUint64(p,m,w,E)}},{key:"DataViewSetBigUint64",value:function(p,m,w){var E=3<arguments.length&&arguments[3]!==void 0&&arguments[3];w=P.asUintN(64,w);var _=0,b=0;if(0<w.length&&(b=w.__digit(0),1<w.length)){var C=w.__digit(1);b|=C<<30,_=C>>>2,2<w.length&&(_|=w.__digit(2)<<28)}var N=E?[4,0]:[0,4],D=x(N,2),U=D[0],G=D[1];p.setUint32(m+U,_,E),p.setUint32(m+G,b,E)}},{key:"__zero",value:function(){return new P(0,!1)}},{key:"__oneDigit",value:function(p,m){var w=new P(1,m);return w.__setDigit(0,p),w}},{key:"__decideRounding",value:function(p,m,w,E){if(0<m)return-1;var _;if(0>m)_=-m-1;else{if(w===0)return-1;w--,E=p.__digit(w),_=29}var b=1<<_;if(!(E&b))return-1;if(b-=1,(E&b)!=0)return 1;for(;0<w;)if(w--,p.__digit(w)!==0)return 1;return 0}},{key:"__fromDouble",value:function(p){P.__kBitConversionDouble[0]=p;var m,w=2047&P.__kBitConversionInts[1]>>>20,E=w-1023,_=(0|E/30)+1,b=new P(_,0>p),C=1048575&P.__kBitConversionInts[1]|1048576,N=P.__kBitConversionInts[0],D=20,U=E%30,G=0;if(U<D){var Y=D-U;G=Y+32,m=C>>>Y,C=C<<32-Y|N>>>Y,N<<=32-Y}else if(U===D)G=32,m=C,C=N,N=0;else{var J=U-D;G=32-J,m=C<<J|N>>>32-J,C=N<<J,N=0}b.__setDigit(_-1,m);for(var H=_-2;0<=H;H--)0<G?(G-=30,m=C>>>2,C=C<<30|N>>>2,N<<=30):m=0,b.__setDigit(H,m);return b.__trim()}},{key:"__isWhitespace",value:function(p){return 13>=p&&9<=p||(159>=p?p==32:131071>=p?p==160||p==5760:196607>=p?(p&=131071,10>=p||p==40||p==41||p==47||p==95||p==4096):p==65279)}},{key:"__fromString",value:function(p){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:0,w=0,E=p.length,_=0;if(_===E)return P.__zero();for(var b=p.charCodeAt(_);P.__isWhitespace(b);){if(++_===E)return P.__zero();b=p.charCodeAt(_)}if(b===43){if(++_===E)return null;b=p.charCodeAt(_),w=1}else if(b===45){if(++_===E)return null;b=p.charCodeAt(_),w=-1}if(m===0){if(m=10,b===48){if(++_===E)return P.__zero();if(b=p.charCodeAt(_),b===88||b===120){if(m=16,++_===E)return null;b=p.charCodeAt(_)}else if(b===79||b===111){if(m=8,++_===E)return null;b=p.charCodeAt(_)}else if(b===66||b===98){if(m=2,++_===E)return null;b=p.charCodeAt(_)}}}else if(m===16&&b===48){if(++_===E)return P.__zero();if(b=p.charCodeAt(_),b===88||b===120){if(++_===E)return null;b=p.charCodeAt(_)}}if(w!==0&&m!==10)return null;for(;b===48;){if(++_===E)return P.__zero();b=p.charCodeAt(_)}var C=E-_,N=P.__kMaxBitsPerChar[m],D=P.__kBitsPerCharTableMultiplier-1;if(C>1073741824/N)return null;var U=N*C+D>>>P.__kBitsPerCharTableShift,G=new P(0|(U+29)/30,!1),Y=10>m?m:10,J=10<m?m-10:0;if(m&m-1){G.__initializeDigits();var ae=!1,he=0;do{for(var ge,ie=0,pe=1;;){if(ge=void 0,b-48>>>0<Y)ge=b-48;else if((32|b)-97>>>0<J)ge=(32|b)-87;else{ae=!0;break}var be=pe*m;if(1073741823<be)break;if(pe=be,ie=ie*m+ge,he++,++_===E){ae=!0;break}b=p.charCodeAt(_)}D=30*P.__kBitsPerCharTableMultiplier-1;var Ue=0|(N*he+D>>>P.__kBitsPerCharTableShift)/30;G.__inplaceMultiplyAdd(pe,ie,Ue)}while(!ae)}else{N>>=P.__kBitsPerCharTableShift;var H=[],X=[],te=!1;do{for(var ne,Q=0,re=0;;){if(ne=void 0,b-48>>>0<Y)ne=b-48;else if((32|b)-97>>>0<J)ne=(32|b)-87;else{te=!0;break}if(re+=N,Q=Q<<N|ne,++_===E){te=!0;break}if(b=p.charCodeAt(_),30<re+N)break}H.push(Q),X.push(re)}while(!te);P.__fillFromParts(G,H,X)}if(_!==E){if(!P.__isWhitespace(b))return null;for(_++;_<E;_++)if(b=p.charCodeAt(_),!P.__isWhitespace(b))return null}return G.sign=w===-1,G.__trim()}},{key:"__fillFromParts",value:function(p,m,w){for(var E=0,_=0,b=0,C=m.length-1;0<=C;C--){var N=m[C],D=w[C];_|=N<<b,b+=D,b===30?(p.__setDigit(E++,_),b=0,_=0):30<b&&(p.__setDigit(E++,1073741823&_),b-=30,_=N>>>D-b)}if(_!==0){if(E>=p.length)throw new Error("implementation bug");p.__setDigit(E++,_)}for(;E<p.length;E++)p.__setDigit(E,0)}},{key:"__toStringBasePowerOfTwo",value:function(p,m){var w=p.length,E=m-1;E=(85&E>>>1)+(85&E),E=(51&E>>>2)+(51&E),E=(15&E>>>4)+(15&E);var _=E,b=m-1,C=p.__digit(w-1),N=P.__clz30(C),D=0|(30*w-N+_-1)/_;if(p.sign&&D++,268435456<D)throw new Error("string too long");for(var U=Array(D),G=D-1,Y=0,J=0,H=0;H<w-1;H++){var X=p.__digit(H),te=(Y|X<<J)&b;U[G--]=P.__kConversionChars[te];var ne=_-J;for(Y=X>>>ne,J=30-ne;J>=_;)U[G--]=P.__kConversionChars[Y&b],Y>>>=_,J-=_}var Q=(Y|C<<J)&b;for(U[G--]=P.__kConversionChars[Q],Y=C>>>_-J;Y!==0;)U[G--]=P.__kConversionChars[Y&b],Y>>>=_;if(p.sign&&(U[G--]="-"),G!==-1)throw new Error("implementation bug");return U.join("")}},{key:"__toStringGeneric",value:function(p,m,w){var E=p.length;if(E===0)return"";if(E===1){var _=p.__unsignedDigit(0).toString(m);return w===!1&&p.sign&&(_="-"+_),_}var b=30*E-P.__clz30(p.__digit(E-1)),C=P.__kMaxBitsPerChar[m],N=C-1,D=b*P.__kBitsPerCharTableMultiplier;D+=N-1,D=0|D/N;var U,G,Y=D+1>>1,J=P.exponentiate(P.__oneDigit(m,!1),P.__oneDigit(Y,!1)),H=J.__unsignedDigit(0);if(J.length===1&&32767>=H){U=new P(p.length,!1),U.__initializeDigits();for(var X,te=0,ne=2*p.length-1;0<=ne;ne--)X=te<<15|p.__halfDigit(ne),U.__setHalfDigit(ne,0|X/H),te=0|X%H;G=te.toString(m)}else{var Q=P.__absoluteDivLarge(p,J,!0,!0);U=Q.quotient;var re=Q.remainder.__trim();G=P.__toStringGeneric(re,m,!0)}U.__trim();for(var ae=P.__toStringGeneric(U,m,!0);G.length<Y;)G="0"+G;return w===!1&&p.sign&&(ae="-"+ae),ae+G}},{key:"__unequalSign",value:function(p){return p?-1:1}},{key:"__absoluteGreater",value:function(p){return p?-1:1}},{key:"__absoluteLess",value:function(p){return p?1:-1}},{key:"__compareToBigInt",value:function(p,m){var w=p.sign;if(w!==m.sign)return P.__unequalSign(w);var E=P.__absoluteCompare(p,m);return 0<E?P.__absoluteGreater(w):0>E?P.__absoluteLess(w):0}},{key:"__compareToNumber",value:function(p,m){if(P.__isOneDigitInt(m)){var w=p.sign,E=0>m;if(w!==E)return P.__unequalSign(w);if(p.length===0){if(E)throw new Error("implementation bug");return m===0?0:-1}if(1<p.length)return P.__absoluteGreater(w);var _=V(m),b=p.__unsignedDigit(0);return b>_?P.__absoluteGreater(w):b<_?P.__absoluteLess(w):0}return P.__compareToDouble(p,m)}},{key:"__compareToDouble",value:function(p,m){if(m!==m)return m;if(m===1/0)return-1;if(m===-1/0)return 1;var w=p.sign;if(w!==0>m)return P.__unequalSign(w);if(m===0)throw new Error("implementation bug: should be handled elsewhere");if(p.length===0)return-1;P.__kBitConversionDouble[0]=m;var E=2047&P.__kBitConversionInts[1]>>>20;if(E==2047)throw new Error("implementation bug: handled elsewhere");var _=E-1023;if(0>_)return P.__absoluteGreater(w);var b=p.length,C=p.__digit(b-1),N=P.__clz30(C),D=30*b-N,U=_+1;if(D<U)return P.__absoluteLess(w);if(D>U)return P.__absoluteGreater(w);var G=1048576|1048575&P.__kBitConversionInts[1],Y=P.__kBitConversionInts[0],J=20,H=29-N;if(H!==(0|(D-1)%30))throw new Error("implementation bug");var X,te=0;if(H<J){var ne=J-H;te=ne+32,X=G>>>ne,G=G<<32-ne|Y>>>ne,Y<<=32-ne}else if(H===J)te=32,X=G,G=Y,Y=0;else{var Q=H-J;te=32-Q,X=G<<Q|Y>>>32-Q,G=Y<<Q,Y=0}if(C>>>=0,X>>>=0,C>X)return P.__absoluteGreater(w);if(C<X)return P.__absoluteLess(w);for(var re=b-2;0<=re;re--){0<te?(te-=30,X=G>>>2,G=G<<30|Y>>>2,Y<<=30):X=0;var ae=p.__unsignedDigit(re);if(ae>X)return P.__absoluteGreater(w);if(ae<X)return P.__absoluteLess(w)}if(G!==0||Y!==0){if(te===0)throw new Error("implementation bug");return P.__absoluteLess(w)}return 0}},{key:"__equalToNumber",value:function(p,m){return P.__isOneDigitInt(m)?m===0?p.length===0:p.length===1&&p.sign===0>m&&p.__unsignedDigit(0)===V(m):P.__compareToDouble(p,m)===0}},{key:"__comparisonResultToBool",value:function(p,m){return m===0?0>p:m===1?0>=p:m===2?0<p:m===3?0<=p:void 0}},{key:"__compare",value:function(p,m,w){if(p=P.__toPrimitive(p),m=P.__toPrimitive(m),typeof p=="string"&&typeof m=="string")switch(w){case 0:return p<m;case 1:return p<=m;case 2:return p>m;case 3:return p>=m}if(P.__isBigInt(p)&&typeof m=="string")return m=P.__fromString(m),m!==null&&P.__comparisonResultToBool(P.__compareToBigInt(p,m),w);if(typeof p=="string"&&P.__isBigInt(m))return p=P.__fromString(p),p!==null&&P.__comparisonResultToBool(P.__compareToBigInt(p,m),w);if(p=P.__toNumeric(p),m=P.__toNumeric(m),P.__isBigInt(p)){if(P.__isBigInt(m))return P.__comparisonResultToBool(P.__compareToBigInt(p,m),w);if(typeof m!="number")throw new Error("implementation bug");return P.__comparisonResultToBool(P.__compareToNumber(p,m),w)}if(typeof p!="number")throw new Error("implementation bug");if(P.__isBigInt(m))return P.__comparisonResultToBool(P.__compareToNumber(m,p),2^w);if(typeof m!="number")throw new Error("implementation bug");return w===0?p<m:w===1?p<=m:w===2?p>m:w===3?p>=m:void 0}},{key:"__absoluteAdd",value:function(p,m,w){if(p.length<m.length)return P.__absoluteAdd(m,p,w);if(p.length===0)return p;if(m.length===0)return p.sign===w?p:P.unaryMinus(p);var E=p.length;(p.__clzmsd()===0||m.length===p.length&&m.__clzmsd()===0)&&E++;for(var _,b=new P(E,w),C=0,N=0;N<m.length;N++)_=p.__digit(N)+m.__digit(N)+C,C=_>>>30,b.__setDigit(N,1073741823&_);for(;N<p.length;N++){var D=p.__digit(N)+C;C=D>>>30,b.__setDigit(N,1073741823&D)}return N<b.length&&b.__setDigit(N,C),b.__trim()}},{key:"__absoluteSub",value:function(p,m,w){if(p.length===0)return p;if(m.length===0)return p.sign===w?p:P.unaryMinus(p);for(var E,_=new P(p.length,w),b=0,C=0;C<m.length;C++)E=p.__digit(C)-m.__digit(C)-b,b=1&E>>>30,_.__setDigit(C,1073741823&E);for(;C<p.length;C++){var N=p.__digit(C)-b;b=1&N>>>30,_.__setDigit(C,1073741823&N)}return _.__trim()}},{key:"__absoluteAddOne",value:function(p,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,E=p.length;w===null?w=new P(E,m):w.sign=m;for(var _,b=1,C=0;C<E;C++)_=p.__digit(C)+b,b=_>>>30,w.__setDigit(C,1073741823&_);return b!==0&&w.__setDigitGrow(E,1),w}},{key:"__absoluteSubOne",value:function(p,m){var w=p.length;m=m||w;for(var E,_=new P(m,!1),b=1,C=0;C<w;C++)E=p.__digit(C)-b,b=1&E>>>30,_.__setDigit(C,1073741823&E);if(b!==0)throw new Error("implementation bug");for(var N=w;N<m;N++)_.__setDigit(N,0);return _}},{key:"__absoluteAnd",value:function(p,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,E=p.length,_=m.length,b=_;if(E<_){b=E;var C=p,N=E;p=m,E=_,m=C,_=N}var D=b;w===null?w=new P(D,!1):D=w.length;for(var U=0;U<b;U++)w.__setDigit(U,p.__digit(U)&m.__digit(U));for(;U<D;U++)w.__setDigit(U,0);return w}},{key:"__absoluteAndNot",value:function(p,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,E=p.length,_=m.length,b=_;E<_&&(b=E);var C=E;w===null?w=new P(C,!1):C=w.length;for(var N=0;N<b;N++)w.__setDigit(N,p.__digit(N)&~m.__digit(N));for(;N<E;N++)w.__setDigit(N,p.__digit(N));for(;N<C;N++)w.__setDigit(N,0);return w}},{key:"__absoluteOr",value:function(p,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,E=p.length,_=m.length,b=_;if(E<_){b=E;var C=p,N=E;p=m,E=_,m=C,_=N}var D=E;w===null?w=new P(D,!1):D=w.length;for(var U=0;U<b;U++)w.__setDigit(U,p.__digit(U)|m.__digit(U));for(;U<E;U++)w.__setDigit(U,p.__digit(U));for(;U<D;U++)w.__setDigit(U,0);return w}},{key:"__absoluteXor",value:function(p,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null,E=p.length,_=m.length,b=_;if(E<_){b=E;var C=p,N=E;p=m,E=_,m=C,_=N}var D=E;w===null?w=new P(D,!1):D=w.length;for(var U=0;U<b;U++)w.__setDigit(U,p.__digit(U)^m.__digit(U));for(;U<E;U++)w.__setDigit(U,p.__digit(U));for(;U<D;U++)w.__setDigit(U,0);return w}},{key:"__absoluteCompare",value:function(p,m){var w=p.length-m.length;if(w!=0)return w;for(var E=p.length-1;0<=E&&p.__digit(E)===m.__digit(E);)E--;return 0>E?0:p.__unsignedDigit(E)>m.__unsignedDigit(E)?1:-1}},{key:"__multiplyAccumulate",value:function(p,m,w,E){if(m!==0){for(var _=32767&m,b=m>>>15,C=0,N=0,D=0;D<p.length;D++,E++){var U=w.__digit(E),G=p.__digit(D),Y=32767&G,J=G>>>15,H=P.__imul(Y,_),X=P.__imul(Y,b),te=P.__imul(J,_),ne=P.__imul(J,b);U+=N+H+C,C=U>>>30,U&=1073741823,U+=((32767&X)<<15)+((32767&te)<<15),C+=U>>>30,N=ne+(X>>>15)+(te>>>15),w.__setDigit(E,1073741823&U)}for(;C!==0||N!==0;E++){var Q=w.__digit(E);Q+=C+N,N=0,C=Q>>>30,w.__setDigit(E,1073741823&Q)}}}},{key:"__internalMultiplyAdd",value:function(p,m,w,E,_){for(var b=w,C=0,N=0;N<E;N++){var D=p.__digit(N),U=P.__imul(32767&D,m),G=P.__imul(D>>>15,m),Y=U+((32767&G)<<15)+C+b;b=Y>>>30,C=G>>>15,_.__setDigit(N,1073741823&Y)}if(_.length>E)for(_.__setDigit(E++,b+C);E<_.length;)_.__setDigit(E++,0);else if(b+C!==0)throw new Error("implementation bug")}},{key:"__absoluteDivSmall",value:function(p,m){var w=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;w===null&&(w=new P(p.length,!1));for(var E=0,_=2*p.length-1;0<=_;_-=2){var b=(E<<15|p.__halfDigit(_))>>>0,C=0|b/m;E=0|b%m,b=(E<<15|p.__halfDigit(_-1))>>>0;var N=0|b/m;E=0|b%m,w.__setDigit(_>>>1,C<<15|N)}return w}},{key:"__absoluteModSmall",value:function(p,m){for(var w,E=0,_=2*p.length-1;0<=_;_--)w=(E<<15|p.__halfDigit(_))>>>0,E=0|w%m;return E}},{key:"__absoluteDivLarge",value:function(p,m,w,E){var _=m.__halfDigitLength(),b=m.length,C=p.__halfDigitLength()-_,N=null;w&&(N=new P(C+2>>>1,!1),N.__initializeDigits());var D=new P(_+2>>>1,!1);D.__initializeDigits();var U=P.__clz15(m.__halfDigit(_-1));0<U&&(m=P.__specialLeftShift(m,U,0));for(var G=P.__specialLeftShift(p,U,1),Y=m.__halfDigit(_-1),J=0,H=C;0<=H;H--){var X=32767,te=G.__halfDigit(H+_);if(te!==Y){var ne=(te<<15|G.__halfDigit(H+_-1))>>>0;X=0|ne/Y;for(var Q=0|ne%Y,re=m.__halfDigit(_-2),ae=G.__halfDigit(H+_-2);P.__imul(X,re)>>>0>(Q<<16|ae)>>>0&&(X--,Q+=Y,!(32767<Q)););}P.__internalMultiplyAdd(m,X,0,b,D);var he=G.__inplaceSub(D,H,_+1);he!==0&&(he=G.__inplaceAdd(m,H,_),G.__setHalfDigit(H+_,32767&G.__halfDigit(H+_)+he),X--),w&&(1&H?J=X<<15:N.__setDigit(H>>>1,J|X))}if(E)return G.__inplaceRightShift(U),w?{quotient:N,remainder:G}:G;if(w)return N;throw new Error("unreachable")}},{key:"__clz15",value:function(p){return P.__clz30(p)-15}},{key:"__specialLeftShift",value:function(p,m,w){var E=p.length,_=new P(E+w,!1);if(m===0){for(var b=0;b<E;b++)_.__setDigit(b,p.__digit(b));return 0<w&&_.__setDigit(E,0),_}for(var C,N=0,D=0;D<E;D++)C=p.__digit(D),_.__setDigit(D,1073741823&C<<m|N),N=C>>>30-m;return 0<w&&_.__setDigit(E,N),_}},{key:"__leftShiftByAbsolute",value:function(p,m){var w=P.__toShiftAmount(m);if(0>w)throw new RangeError("BigInt too big");var E=0|w/30,_=w%30,b=p.length,C=_!==0&&p.__digit(b-1)>>>30-_!=0,N=b+E+(C?1:0),D=new P(N,p.sign);if(_===0){for(var U=0;U<E;U++)D.__setDigit(U,0);for(;U<N;U++)D.__setDigit(U,p.__digit(U-E))}else{for(var G=0,Y=0;Y<E;Y++)D.__setDigit(Y,0);for(var J,H=0;H<b;H++)J=p.__digit(H),D.__setDigit(H+E,1073741823&J<<_|G),G=J>>>30-_;if(C)D.__setDigit(b+E,G);else if(G!==0)throw new Error("implementation bug")}return D.__trim()}},{key:"__rightShiftByAbsolute",value:function(p,m){var w=p.length,E=p.sign,_=P.__toShiftAmount(m);if(0>_)return P.__rightShiftByMaximum(E);var b=0|_/30,C=_%30,N=w-b;if(0>=N)return P.__rightShiftByMaximum(E);var D=!1;if(E){if(p.__digit(b)&(1<<C)-1)D=!0;else for(var U=0;U<b;U++)if(p.__digit(U)!==0){D=!0;break}}if(D&&C===0){var G=p.__digit(w-1);!~G&&N++}var Y=new P(N,E);if(C===0){Y.__setDigit(N-1,0);for(var J=b;J<w;J++)Y.__setDigit(J-b,p.__digit(J))}else{for(var H,X=p.__digit(b)>>>C,te=w-b-1,ne=0;ne<te;ne++)H=p.__digit(ne+b+1),Y.__setDigit(ne,1073741823&H<<30-C|X),X=H>>>C;Y.__setDigit(te,X)}return D&&(Y=P.__absoluteAddOne(Y,!0,Y)),Y.__trim()}},{key:"__rightShiftByMaximum",value:function(p){return p?P.__oneDigit(1,!0):P.__zero()}},{key:"__toShiftAmount",value:function(p){if(1<p.length)return-1;var m=p.__unsignedDigit(0);return m>P.__kMaxLengthBits?-1:m}},{key:"__toPrimitive",value:function(p){var m=1<arguments.length&&arguments[1]!==void 0?arguments[1]:"default";if(r(p)!=="object"||p.constructor===P)return p;if(typeof Symbol<"u"&&r(Symbol.toPrimitive)==="symbol"){var w=p[Symbol.toPrimitive];if(w){var E=w(m);if(r(E)!=="object")return E;throw new TypeError("Cannot convert object to primitive value")}}var _=p.valueOf;if(_){var b=_.call(p);if(r(b)!=="object")return b}var C=p.toString;if(C){var N=C.call(p);if(r(N)!=="object")return N}throw new TypeError("Cannot convert object to primitive value")}},{key:"__toNumeric",value:function(p){return P.__isBigInt(p)?p:+p}},{key:"__isBigInt",value:function(p){return r(p)==="object"&&p!==null&&p.constructor===P}},{key:"__truncateToNBits",value:function(p,m){for(var w=0|(p+29)/30,E=new P(w,m.sign),_=w-1,b=0;b<_;b++)E.__setDigit(b,m.__digit(b));var C=m.__digit(_);if(p%30!=0){var N=32-p%30;C=C<<N>>>N}return E.__setDigit(_,C),E.__trim()}},{key:"__truncateAndSubFromPowerOfTwo",value:function(p,m,w){for(var E=Math.min,_,b=0|(p+29)/30,C=new P(b,w),N=0,D=b-1,U=0,G=E(D,m.length);N<G;N++)_=0-m.__digit(N)-U,U=1&_>>>30,C.__setDigit(N,1073741823&_);for(;N<D;N++)C.__setDigit(N,0|1073741823&-U);var Y,J=D<m.length?m.__digit(D):0,H=p%30;if(H===0)Y=0-J-U,Y&=1073741823;else{var X=32-H;J=J<<X>>>X;var te=1<<32-X;Y=te-J-U,Y&=te-1}return C.__setDigit(D,Y),C.__trim()}},{key:"__digitPow",value:function(p,m){for(var w=1;0<m;)1&m&&(w*=p),m>>>=1,p*=p;return w}},{key:"__isOneDigitInt",value:function(p){return(1073741823&p)===p}}]),P}(h(Array));return F.__kMaxLength=33554432,F.__kMaxLengthBits=F.__kMaxLength<<5,F.__kMaxBitsPerChar=[0,0,32,51,64,75,83,90,96,102,107,111,115,119,122,126,128,131,134,136,139,141,143,145,147,149,151,153,154,156,158,159,160,162,163,165,166],F.__kBitsPerCharTableShift=5,F.__kBitsPerCharTableMultiplier=1<<F.__kBitsPerCharTableShift,F.__kConversionChars=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],F.__kBitConversionBuffer=new ArrayBuffer(8),F.__kBitConversionDouble=new Float64Array(F.__kBitConversionBuffer),F.__kBitConversionInts=new Int32Array(F.__kBitConversionBuffer),F.__clz30=e?function(L){return e(L)-2}:function(L){var V=Math.LN2,q=Math.log;return L===0?30:0|29-(0|q(L>>>0)/V)},F.__imul=t||function(L,V){return 0|L*V},F})});var pS=W(Yr=>{"use strict";f();Object.defineProperty(Yr,"__esModule",{value:!0});Yr.regexpCode=Yr.getEsmExportName=Yr.getProperty=Yr.safeStringify=Yr.stringify=Yr.strConcat=Yr.addCodeArg=Yr.str=Yr._=Yr.nil=Yr._Code=Yr.Name=Yr.IDENTIFIER=Yr._CodeOrName=void 0;var fS=class{};Yr._CodeOrName=fS;Yr.IDENTIFIER=/^[a-z$_][a-z$_0-9]*$/i;var Bv=class extends fS{constructor(e){if(super(),!Yr.IDENTIFIER.test(e))throw new Error("CodeGen: name must be a valid identifier");this.str=e}toString(){return this.str}emptyStr(){return!1}get names(){return{[this.str]:1}}};Yr.Name=Bv;var Yd=class extends fS{constructor(e){super(),this._items=typeof e=="string"?[e]:e}toString(){return this.str}emptyStr(){if(this._items.length>1)return!1;let e=this._items[0];return e===""||e==='""'}get str(){var e;return(e=this._str)!==null&&e!==void 0?e:this._str=this._items.reduce((r,n)=>`${r}${n}`,"")}get names(){var e;return(e=this._names)!==null&&e!==void 0?e:this._names=this._items.reduce((r,n)=>(n instanceof Bv&&(r[n.str]=(r[n.str]||0)+1),r),{})}};Yr._Code=Yd;Yr.nil=new Yd("");function Fle(t,...e){let r=[t[0]],n=0;for(;n<e.length;)rU(r,e[n]),r.push(t[++n]);return new Yd(r)}Yr._=Fle;var tU=new Yd("+");function zle(t,...e){let r=[hS(t[0])],n=0;for(;n<e.length;)r.push(tU),rU(r,e[n]),r.push(tU,hS(t[++n]));return pqe(r),new Yd(r)}Yr.str=zle;function rU(t,e){e instanceof Yd?t.push(...e._items):e instanceof Bv?t.push(e):t.push(gqe(e))}Yr.addCodeArg=rU;function pqe(t){let e=1;for(;e<t.length-1;){if(t[e]===tU){let r=yqe(t[e-1],t[e+1]);if(r!==void 0){t.splice(e-1,3,r);continue}t[e++]="+"}e++}}function yqe(t,e){if(e==='""')return t;if(t==='""')return e;if(typeof t=="string")return e instanceof Bv||t[t.length-1]!=='"'?void 0:typeof e!="string"?`${t.slice(0,-1)}${e}"`:e[0]==='"'?t.slice(0,-1)+e.slice(1):void 0;if(typeof e=="string"&&e[0]==='"'&&!(t instanceof Bv))return`"${t}${e.slice(1)}`}function mqe(t,e){return e.emptyStr()?t:t.emptyStr()?e:zle`${t}${e}`}Yr.strConcat=mqe;function gqe(t){return typeof t=="number"||typeof t=="boolean"||t===null?t:hS(Array.isArray(t)?t.join(","):t)}function vqe(t){return new Yd(hS(t))}Yr.stringify=vqe;function hS(t){return JSON.stringify(t).replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")}Yr.safeStringify=hS;function bqe(t){return typeof t=="string"&&Yr.IDENTIFIER.test(t)?new Yd(`.${t}`):Fle`[${t}]`}Yr.getProperty=bqe;function wqe(t){if(typeof t=="string"&&Yr.IDENTIFIER.test(t))return new Yd(`${t}`);throw new Error(`CodeGen: invalid export name: ${t}, use explicit $id name mapping`)}Yr.getEsmExportName=wqe;function _qe(t){return new Yd(t.toString())}Yr.regexpCode=_qe});var sU=W(qa=>{"use strict";f();Object.defineProperty(qa,"__esModule",{value:!0});qa.ValueScope=qa.ValueScopeName=qa.Scope=qa.varKinds=qa.UsedValueState=void 0;var yc=pS(),nU=class extends Error{constructor(e){super(`CodeGen: "code" for ${e} not defined`),this.value=e.value}},iU;(function(t){t[t.Started=0]="Started",t[t.Completed=1]="Completed"})(iU=qa.UsedValueState||(qa.UsedValueState={}));qa.varKinds={const:new yc.Name("const"),let:new yc.Name("let"),var:new yc.Name("var")};var nP=class{constructor({prefixes:e,parent:r}={}){this._names={},this._prefixes=e,this._parent=r}toName(e){return e instanceof yc.Name?e:this.name(e)}name(e){return new yc.Name(this._newName(e))}_newName(e){let r=this._names[e]||this._nameGroup(e);return`${e}${r.index++}`}_nameGroup(e){var r,n;if(!((n=(r=this._parent)===null||r===void 0?void 0:r._prefixes)===null||n===void 0)&&n.has(e)||this._prefixes&&!this._prefixes.has(e))throw new Error(`CodeGen: prefix "${e}" is not allowed in this scope`);return this._names[e]={prefix:e,index:0}}};qa.Scope=nP;var iP=class extends yc.Name{constructor(e,r){super(r),this.prefix=e}setValue(e,{property:r,itemIndex:n}){this.value=e,this.scopePath=(0,yc._)`.${new yc.Name(r)}[${n}]`}};qa.ValueScopeName=iP;var xqe=(0,yc._)`\n`,oU=class extends nP{constructor(e){super(e),this._values={},this._scope=e.scope,this.opts={...e,_n:e.lines?xqe:yc.nil}}get(){return this._scope}name(e){return new iP(e,this._newName(e))}value(e,r){var n;if(r.ref===void 0)throw new Error("CodeGen: ref must be passed in value");let i=this.toName(e),{prefix:o}=i,s=(n=r.key)!==null&&n!==void 0?n:r.ref,a=this._values[o];if(a){let c=a.get(s);if(c)return c}else a=this._values[o]=new Map;a.set(s,i);let d=this._scope[o]||(this._scope[o]=[]),u=d.length;return d[u]=r.ref,i.setValue(r,{property:o,itemIndex:u}),i}getValue(e,r){let n=this._values[e];if(n)return n.get(r)}scopeRefs(e,r=this._values){return this._reduceValues(r,n=>{if(n.scopePath===void 0)throw new Error(`CodeGen: name "${n}" has no value`);return(0,yc._)`${e}${n.scopePath}`})}scopeCode(e=this._values,r,n){return this._reduceValues(e,i=>{if(i.value===void 0)throw new Error(`CodeGen: name "${i}" has no value`);return i.value.code},r,n)}_reduceValues(e,r,n={},i){let o=yc.nil;for(let s in e){let a=e[s];if(!a)continue;let d=n[s]=n[s]||new Map;a.forEach(u=>{if(d.has(u))return;d.set(u,iU.Started);let c=r(u);if(c){let l=this.opts.es5?qa.varKinds.var:qa.varKinds.const;o=(0,yc._)`${o}${l} ${u} = ${c};${this.opts._n}`}else if(c=i?.(u))o=(0,yc._)`${o}${c}${this.opts._n}`;else throw new nU(u);d.set(u,iU.Completed)})}return o}};qa.ValueScope=oU});var ir=W(Er=>{"use strict";f();Object.defineProperty(Er,"__esModule",{value:!0});Er.or=Er.and=Er.not=Er.CodeGen=Er.operators=Er.varKinds=Er.ValueScopeName=Er.ValueScope=Er.Scope=Er.Name=Er.regexpCode=Er.stringify=Er.getProperty=Er.nil=Er.strConcat=Er.str=Er._=void 0;var Hr=pS(),ol=sU(),Pm=pS();Object.defineProperty(Er,"_",{enumerable:!0,get:function(){return Pm._}});Object.defineProperty(Er,"str",{enumerable:!0,get:function(){return Pm.str}});Object.defineProperty(Er,"strConcat",{enumerable:!0,get:function(){return Pm.strConcat}});Object.defineProperty(Er,"nil",{enumerable:!0,get:function(){return Pm.nil}});Object.defineProperty(Er,"getProperty",{enumerable:!0,get:function(){return Pm.getProperty}});Object.defineProperty(Er,"stringify",{enumerable:!0,get:function(){return Pm.stringify}});Object.defineProperty(Er,"regexpCode",{enumerable:!0,get:function(){return Pm.regexpCode}});Object.defineProperty(Er,"Name",{enumerable:!0,get:function(){return Pm.Name}});var cP=sU();Object.defineProperty(Er,"Scope",{enumerable:!0,get:function(){return cP.Scope}});Object.defineProperty(Er,"ValueScope",{enumerable:!0,get:function(){return cP.ValueScope}});Object.defineProperty(Er,"ValueScopeName",{enumerable:!0,get:function(){return cP.ValueScopeName}});Object.defineProperty(Er,"varKinds",{enumerable:!0,get:function(){return cP.varKinds}});Er.operators={GT:new Hr._Code(">"),GTE:new Hr._Code(">="),LT:new Hr._Code("<"),LTE:new Hr._Code("<="),EQ:new Hr._Code("==="),NEQ:new Hr._Code("!=="),NOT:new Hr._Code("!"),OR:new Hr._Code("||"),AND:new Hr._Code("&&"),ADD:new Hr._Code("+")};var ap=class{optimizeNodes(){return this}optimizeNames(e,r){return this}},aU=class extends ap{constructor(e,r,n){super(),this.varKind=e,this.name=r,this.rhs=n}render({es5:e,_n:r}){let n=e?ol.varKinds.var:this.varKind,i=this.rhs===void 0?"":` = ${this.rhs}`;return`${n} ${this.name}${i};`+r}optimizeNames(e,r){if(e[this.name.str])return this.rhs&&(this.rhs=T2(this.rhs,e,r)),this}get names(){return this.rhs instanceof Hr._CodeOrName?this.rhs.names:{}}},oP=class extends ap{constructor(e,r,n){super(),this.lhs=e,this.rhs=r,this.sideEffects=n}render({_n:e}){return`${this.lhs} = ${this.rhs};`+e}optimizeNames(e,r){if(!(this.lhs instanceof Hr.Name&&!e[this.lhs.str]&&!this.sideEffects))return this.rhs=T2(this.rhs,e,r),this}get names(){let e=this.lhs instanceof Hr.Name?{}:{...this.lhs.names};return aP(e,this.rhs)}},cU=class extends oP{constructor(e,r,n,i){super(e,n,i),this.op=r}render({_n:e}){return`${this.lhs} ${this.op}= ${this.rhs};`+e}},dU=class extends ap{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`${this.label}:`+e}},uU=class extends ap{constructor(e){super(),this.label=e,this.names={}}render({_n:e}){return`break${this.label?` ${this.label}`:""};`+e}},lU=class extends ap{constructor(e){super(),this.error=e}render({_n:e}){return`throw ${this.error};`+e}get names(){return this.error.names}},fU=class extends ap{constructor(e){super(),this.code=e}render({_n:e}){return`${this.code};`+e}optimizeNodes(){return`${this.code}`?this:void 0}optimizeNames(e,r){return this.code=T2(this.code,e,r),this}get names(){return this.code instanceof Hr._CodeOrName?this.code.names:{}}},yS=class extends ap{constructor(e=[]){super(),this.nodes=e}render(e){return this.nodes.reduce((r,n)=>r+n.render(e),"")}optimizeNodes(){let{nodes:e}=this,r=e.length;for(;r--;){let n=e[r].optimizeNodes();Array.isArray(n)?e.splice(r,1,...n):n?e[r]=n:e.splice(r,1)}return e.length>0?this:void 0}optimizeNames(e,r){let{nodes:n}=this,i=n.length;for(;i--;){let o=n[i];o.optimizeNames(e,r)||(Eqe(e,o.names),n.splice(i,1))}return n.length>0?this:void 0}get names(){return this.nodes.reduce((e,r)=>Dv(e,r.names),{})}},cp=class extends yS{render(e){return"{"+e._n+super.render(e)+"}"+e._n}},hU=class extends yS{},S2=class extends cp{};S2.kind="else";var Ov=class t extends cp{constructor(e,r){super(r),this.condition=e}render(e){let r=`if(${this.condition})`+super.render(e);return this.else&&(r+="else "+this.else.render(e)),r}optimizeNodes(){super.optimizeNodes();let e=this.condition;if(e===!0)return this.nodes;let r=this.else;if(r){let n=r.optimizeNodes();r=this.else=Array.isArray(n)?new S2(n):n}if(r)return e===!1?r instanceof t?r:r.nodes:this.nodes.length?this:new t(Vle(e),r instanceof t?[r]:r.nodes);if(!(e===!1||!this.nodes.length))return this}optimizeNames(e,r){var n;if(this.else=(n=this.else)===null||n===void 0?void 0:n.optimizeNames(e,r),!!(super.optimizeNames(e,r)||this.else))return this.condition=T2(this.condition,e,r),this}get names(){let e=super.names;return aP(e,this.condition),this.else&&Dv(e,this.else.names),e}};Ov.kind="if";var Mv=class extends cp{};Mv.kind="for";var pU=class extends Mv{constructor(e){super(),this.iteration=e}render(e){return`for(${this.iteration})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iteration=T2(this.iteration,e,r),this}get names(){return Dv(super.names,this.iteration.names)}},yU=class extends Mv{constructor(e,r,n,i){super(),this.varKind=e,this.name=r,this.from=n,this.to=i}render(e){let r=e.es5?ol.varKinds.var:this.varKind,{name:n,from:i,to:o}=this;return`for(${r} ${n}=${i}; ${n}<${o}; ${n}++)`+super.render(e)}get names(){let e=aP(super.names,this.from);return aP(e,this.to)}},sP=class extends Mv{constructor(e,r,n,i){super(),this.loop=e,this.varKind=r,this.name=n,this.iterable=i}render(e){return`for(${this.varKind} ${this.name} ${this.loop} ${this.iterable})`+super.render(e)}optimizeNames(e,r){if(super.optimizeNames(e,r))return this.iterable=T2(this.iterable,e,r),this}get names(){return Dv(super.names,this.iterable.names)}},mS=class extends cp{constructor(e,r,n){super(),this.name=e,this.args=r,this.async=n}render(e){return`${this.async?"async ":""}function ${this.name}(${this.args})`+super.render(e)}};mS.kind="func";var gS=class extends yS{render(e){return"return "+super.render(e)}};gS.kind="return";var mU=class extends cp{render(e){let r="try"+super.render(e);return this.catch&&(r+=this.catch.render(e)),this.finally&&(r+=this.finally.render(e)),r}optimizeNodes(){var e,r;return super.optimizeNodes(),(e=this.catch)===null||e===void 0||e.optimizeNodes(),(r=this.finally)===null||r===void 0||r.optimizeNodes(),this}optimizeNames(e,r){var n,i;return super.optimizeNames(e,r),(n=this.catch)===null||n===void 0||n.optimizeNames(e,r),(i=this.finally)===null||i===void 0||i.optimizeNames(e,r),this}get names(){let e=super.names;return this.catch&&Dv(e,this.catch.names),this.finally&&Dv(e,this.finally.names),e}},vS=class extends cp{constructor(e){super(),this.error=e}render(e){return`catch(${this.error})`+super.render(e)}};vS.kind="catch";var bS=class extends cp{render(e){return"finally"+super.render(e)}};bS.kind="finally";var gU=class{constructor(e,r={}){this._values={},this._blockStarts=[],this._constants={},this.opts={...r,_n:r.lines?`
`:""},this._extScope=e,this._scope=new ol.Scope({parent:e}),this._nodes=[new hU]}toString(){return this._root.render(this.opts)}name(e){return this._scope.name(e)}scopeName(e){return this._extScope.name(e)}scopeValue(e,r){let n=this._extScope.value(e,r);return(this._values[n.prefix]||(this._values[n.prefix]=new Set)).add(n),n}getScopeValue(e,r){return this._extScope.getValue(e,r)}scopeRefs(e){return this._extScope.scopeRefs(e,this._values)}scopeCode(){return this._extScope.scopeCode(this._values)}_def(e,r,n,i){let o=this._scope.toName(r);return n!==void 0&&i&&(this._constants[o.str]=n),this._leafNode(new aU(e,o,n)),o}const(e,r,n){return this._def(ol.varKinds.const,e,r,n)}let(e,r,n){return this._def(ol.varKinds.let,e,r,n)}var(e,r,n){return this._def(ol.varKinds.var,e,r,n)}assign(e,r,n){return this._leafNode(new oP(e,r,n))}add(e,r){return this._leafNode(new cU(e,Er.operators.ADD,r))}code(e){return typeof e=="function"?e():e!==Hr.nil&&this._leafNode(new fU(e)),this}object(...e){let r=["{"];for(let[n,i]of e)r.length>1&&r.push(","),r.push(n),(n!==i||this.opts.es5)&&(r.push(":"),(0,Hr.addCodeArg)(r,i));return r.push("}"),new Hr._Code(r)}if(e,r,n){if(this._blockNode(new Ov(e)),r&&n)this.code(r).else().code(n).endIf();else if(r)this.code(r).endIf();else if(n)throw new Error('CodeGen: "else" body without "then" body');return this}elseIf(e){return this._elseNode(new Ov(e))}else(){return this._elseNode(new S2)}endIf(){return this._endBlockNode(Ov,S2)}_for(e,r){return this._blockNode(e),r&&this.code(r).endFor(),this}for(e,r){return this._for(new pU(e),r)}forRange(e,r,n,i,o=this.opts.es5?ol.varKinds.var:ol.varKinds.let){let s=this._scope.toName(e);return this._for(new yU(o,s,r,n),()=>i(s))}forOf(e,r,n,i=ol.varKinds.const){let o=this._scope.toName(e);if(this.opts.es5){let s=r instanceof Hr.Name?r:this.var("_arr",r);return this.forRange("_i",0,(0,Hr._)`${s}.length`,a=>{this.var(o,(0,Hr._)`${s}[${a}]`),n(o)})}return this._for(new sP("of",i,o,r),()=>n(o))}forIn(e,r,n,i=this.opts.es5?ol.varKinds.var:ol.varKinds.const){if(this.opts.ownProperties)return this.forOf(e,(0,Hr._)`Object.keys(${r})`,n);let o=this._scope.toName(e);return this._for(new sP("in",i,o,r),()=>n(o))}endFor(){return this._endBlockNode(Mv)}label(e){return this._leafNode(new dU(e))}break(e){return this._leafNode(new uU(e))}return(e){let r=new gS;if(this._blockNode(r),this.code(e),r.nodes.length!==1)throw new Error('CodeGen: "return" should have one node');return this._endBlockNode(gS)}try(e,r,n){if(!r&&!n)throw new Error('CodeGen: "try" without "catch" and "finally"');let i=new mU;if(this._blockNode(i),this.code(e),r){let o=this.name("e");this._currNode=i.catch=new vS(o),r(o)}return n&&(this._currNode=i.finally=new bS,this.code(n)),this._endBlockNode(vS,bS)}throw(e){return this._leafNode(new lU(e))}block(e,r){return this._blockStarts.push(this._nodes.length),e&&this.code(e).endBlock(r),this}endBlock(e){let r=this._blockStarts.pop();if(r===void 0)throw new Error("CodeGen: not in self-balancing block");let n=this._nodes.length-r;if(n<0||e!==void 0&&n!==e)throw new Error(`CodeGen: wrong number of nodes: ${n} vs ${e} expected`);return this._nodes.length=r,this}func(e,r=Hr.nil,n,i){return this._blockNode(new mS(e,r,n)),i&&this.code(i).endFunc(),this}endFunc(){return this._endBlockNode(mS)}optimize(e=1){for(;e-- >0;)this._root.optimizeNodes(),this._root.optimizeNames(this._root.names,this._constants)}_leafNode(e){return this._currNode.nodes.push(e),this}_blockNode(e){this._currNode.nodes.push(e),this._nodes.push(e)}_endBlockNode(e,r){let n=this._currNode;if(n instanceof e||r&&n instanceof r)return this._nodes.pop(),this;throw new Error(`CodeGen: not in block "${r?`${e.kind}/${r.kind}`:e.kind}"`)}_elseNode(e){let r=this._currNode;if(!(r instanceof Ov))throw new Error('CodeGen: "else" without "if"');return this._currNode=r.else=e,this}get _root(){return this._nodes[0]}get _currNode(){let e=this._nodes;return e[e.length-1]}set _currNode(e){let r=this._nodes;r[r.length-1]=e}};Er.CodeGen=gU;function Dv(t,e){for(let r in e)t[r]=(t[r]||0)+(e[r]||0);return t}function aP(t,e){return e instanceof Hr._CodeOrName?Dv(t,e.names):t}function T2(t,e,r){if(t instanceof Hr.Name)return n(t);if(!i(t))return t;return new Hr._Code(t._items.reduce((o,s)=>(s instanceof Hr.Name&&(s=n(s)),s instanceof Hr._Code?o.push(...s._items):o.push(s),o),[]));function n(o){let s=r[o.str];return s===void 0||e[o.str]!==1?o:(delete e[o.str],s)}function i(o){return o instanceof Hr._Code&&o._items.some(s=>s instanceof Hr.Name&&e[s.str]===1&&r[s.str]!==void 0)}}function Eqe(t,e){for(let r in e)t[r]=(t[r]||0)-(e[r]||0)}function Vle(t){return typeof t=="boolean"||typeof t=="number"||t===null?!t:(0,Hr._)`!${vU(t)}`}Er.not=Vle;var Sqe=Hle(Er.operators.AND);function Tqe(...t){return t.reduce(Sqe)}Er.and=Tqe;var Aqe=Hle(Er.operators.OR);function kqe(...t){return t.reduce(Aqe)}Er.or=kqe;function Hle(t){return(e,r)=>e===Hr.nil?r:r===Hr.nil?e:(0,Hr._)`${vU(e)} ${t} ${vU(r)}`}function vU(t){return t instanceof Hr.Name?t:(0,Hr._)`(${t})`}});var Cr=W(Sr=>{"use strict";f();Object.defineProperty(Sr,"__esModule",{value:!0});Sr.checkStrictMode=Sr.getErrorPath=Sr.Type=Sr.useFunc=Sr.setEvaluated=Sr.evaluatedPropsToName=Sr.mergeEvaluated=Sr.eachItem=Sr.unescapeJsonPointer=Sr.escapeJsonPointer=Sr.escapeFragment=Sr.unescapeFragment=Sr.schemaRefOrVal=Sr.schemaHasRulesButRef=Sr.schemaHasRules=Sr.checkUnknownRules=Sr.alwaysValidSchema=Sr.toHash=void 0;var Cn=ir(),Pqe=pS();function Iqe(t){let e={};for(let r of t)e[r]=!0;return e}Sr.toHash=Iqe;function Rqe(t,e){return typeof e=="boolean"?e:Object.keys(e).length===0?!0:(Jle(t,e),!Yle(e,t.self.RULES.all))}Sr.alwaysValidSchema=Rqe;function Jle(t,e=t.schema){let{opts:r,self:n}=t;if(!r.strictSchema||typeof e=="boolean")return;let i=n.RULES.keywords;for(let o in e)i[o]||efe(t,`unknown keyword: "${o}"`)}Sr.checkUnknownRules=Jle;function Yle(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(e[r])return!0;return!1}Sr.schemaHasRules=Yle;function Bqe(t,e){if(typeof t=="boolean")return!t;for(let r in t)if(r!=="$ref"&&e.all[r])return!0;return!1}Sr.schemaHasRulesButRef=Bqe;function Oqe({topSchemaRef:t,schemaPath:e},r,n,i){if(!i){if(typeof r=="number"||typeof r=="boolean")return r;if(typeof r=="string")return(0,Cn._)`${r}`}return(0,Cn._)`${t}${e}${(0,Cn.getProperty)(n)}`}Sr.schemaRefOrVal=Oqe;function Mqe(t){return Zle(decodeURIComponent(t))}Sr.unescapeFragment=Mqe;function Dqe(t){return encodeURIComponent(bU(t))}Sr.escapeFragment=Dqe;function bU(t){return typeof t=="number"?`${t}`:t.replace(/~/g,"~0").replace(/\//g,"~1")}Sr.escapeJsonPointer=bU;function Zle(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}Sr.unescapeJsonPointer=Zle;function Cqe(t,e){if(Array.isArray(t))for(let r of t)e(r);else e(t)}Sr.eachItem=Cqe;function Wle({mergeNames:t,mergeToName:e,mergeValues:r,resultToName:n}){return(i,o,s,a)=>{let d=s===void 0?o:s instanceof Cn.Name?(o instanceof Cn.Name?t(i,o,s):e(i,o,s),s):o instanceof Cn.Name?(e(i,s,o),o):r(o,s);return a===Cn.Name&&!(d instanceof Cn.Name)?n(i,d):d}}Sr.mergeEvaluated={props:Wle({mergeNames:(t,e,r)=>t.if((0,Cn._)`${r} !== true && ${e} !== undefined`,()=>{t.if((0,Cn._)`${e} === true`,()=>t.assign(r,!0),()=>t.assign(r,(0,Cn._)`${r} || {}`).code((0,Cn._)`Object.assign(${r}, ${e})`))}),mergeToName:(t,e,r)=>t.if((0,Cn._)`${r} !== true`,()=>{e===!0?t.assign(r,!0):(t.assign(r,(0,Cn._)`${r} || {}`),wU(t,r,e))}),mergeValues:(t,e)=>t===!0?!0:{...t,...e},resultToName:Xle}),items:Wle({mergeNames:(t,e,r)=>t.if((0,Cn._)`${r} !== true && ${e} !== undefined`,()=>t.assign(r,(0,Cn._)`${e} === true ? true : ${r} > ${e} ? ${r} : ${e}`)),mergeToName:(t,e,r)=>t.if((0,Cn._)`${r} !== true`,()=>t.assign(r,e===!0?!0:(0,Cn._)`${r} > ${e} ? ${r} : ${e}`)),mergeValues:(t,e)=>t===!0?!0:Math.max(t,e),resultToName:(t,e)=>t.var("items",e)})};function Xle(t,e){if(e===!0)return t.var("props",!0);let r=t.var("props",(0,Cn._)`{}`);return e!==void 0&&wU(t,r,e),r}Sr.evaluatedPropsToName=Xle;function wU(t,e,r){Object.keys(r).forEach(n=>t.assign((0,Cn._)`${e}${(0,Cn.getProperty)(n)}`,!0))}Sr.setEvaluated=wU;var Gle={};function jqe(t,e){return t.scopeValue("func",{ref:e,code:Gle[e.code]||(Gle[e.code]=new Pqe._Code(e.code))})}Sr.useFunc=jqe;var Qle;(function(t){t[t.Num=0]="Num",t[t.Str=1]="Str"})(Qle=Sr.Type||(Sr.Type={}));function $qe(t,e,r){if(t instanceof Cn.Name){let n=e===Qle.Num;return r?n?(0,Cn._)`"[" + ${t} + "]"`:(0,Cn._)`"['" + ${t} + "']"`:n?(0,Cn._)`"/" + ${t}`:(0,Cn._)`"/" + ${t}.replace(/~/g, "~0").replace(/\\//g, "~1")`}return r?(0,Cn.getProperty)(t).toString():"/"+bU(t)}Sr.getErrorPath=$qe;function efe(t,e,r=t.opts.strictSchema){if(r){if(e=`strict mode: ${e}`,r===!0)throw new Error(e);t.self.logger.warn(e)}}Sr.checkStrictMode=efe});var Zd=W(_U=>{"use strict";f();Object.defineProperty(_U,"__esModule",{value:!0});var fa=ir(),Nqe={data:new fa.Name("data"),valCxt:new fa.Name("valCxt"),instancePath:new fa.Name("instancePath"),parentData:new fa.Name("parentData"),parentDataProperty:new fa.Name("parentDataProperty"),rootData:new fa.Name("rootData"),dynamicAnchors:new fa.Name("dynamicAnchors"),vErrors:new fa.Name("vErrors"),errors:new fa.Name("errors"),this:new fa.Name("this"),self:new fa.Name("self"),scope:new fa.Name("scope"),json:new fa.Name("json"),jsonPos:new fa.Name("jsonPos"),jsonLen:new fa.Name("jsonLen"),jsonPart:new fa.Name("jsonPart")};_U.default=Nqe});var wS=W(ha=>{"use strict";f();Object.defineProperty(ha,"__esModule",{value:!0});ha.extendErrors=ha.resetErrorsCount=ha.reportExtraError=ha.reportError=ha.keyword$DataError=ha.keywordError=void 0;var Gr=ir(),dP=Cr(),La=Zd();ha.keywordError={message:({keyword:t})=>(0,Gr.str)`must pass "${t}" keyword validation`};ha.keyword$DataError={message:({keyword:t,schemaType:e})=>e?(0,Gr.str)`"${t}" keyword must be ${e} ($data)`:(0,Gr.str)`"${t}" keyword is invalid ($data)`};function Uqe(t,e=ha.keywordError,r,n){let{it:i}=t,{gen:o,compositeRule:s,allErrors:a}=i,d=nfe(t,e,r);n??(s||a)?tfe(o,d):rfe(i,(0,Gr._)`[${d}]`)}ha.reportError=Uqe;function Kqe(t,e=ha.keywordError,r){let{it:n}=t,{gen:i,compositeRule:o,allErrors:s}=n,a=nfe(t,e,r);tfe(i,a),o||s||rfe(n,La.default.vErrors)}ha.reportExtraError=Kqe;function qqe(t,e){t.assign(La.default.errors,e),t.if((0,Gr._)`${La.default.vErrors} !== null`,()=>t.if(e,()=>t.assign((0,Gr._)`${La.default.vErrors}.length`,e),()=>t.assign(La.default.vErrors,null)))}ha.resetErrorsCount=qqe;function Lqe({gen:t,keyword:e,schemaValue:r,data:n,errsCount:i,it:o}){if(i===void 0)throw new Error("ajv implementation error");let s=t.name("err");t.forRange("i",i,La.default.errors,a=>{t.const(s,(0,Gr._)`${La.default.vErrors}[${a}]`),t.if((0,Gr._)`${s}.instancePath === undefined`,()=>t.assign((0,Gr._)`${s}.instancePath`,(0,Gr.strConcat)(La.default.instancePath,o.errorPath))),t.assign((0,Gr._)`${s}.schemaPath`,(0,Gr.str)`${o.errSchemaPath}/${e}`),o.opts.verbose&&(t.assign((0,Gr._)`${s}.schema`,r),t.assign((0,Gr._)`${s}.data`,n))})}ha.extendErrors=Lqe;function tfe(t,e){let r=t.const("err",e);t.if((0,Gr._)`${La.default.vErrors} === null`,()=>t.assign(La.default.vErrors,(0,Gr._)`[${r}]`),(0,Gr._)`${La.default.vErrors}.push(${r})`),t.code((0,Gr._)`${La.default.errors}++`)}function rfe(t,e){let{gen:r,validateName:n,schemaEnv:i}=t;i.$async?r.throw((0,Gr._)`new ${t.ValidationError}(${e})`):(r.assign((0,Gr._)`${n}.errors`,e),r.return(!1))}var Cv={keyword:new Gr.Name("keyword"),schemaPath:new Gr.Name("schemaPath"),params:new Gr.Name("params"),propertyName:new Gr.Name("propertyName"),message:new Gr.Name("message"),schema:new Gr.Name("schema"),parentSchema:new Gr.Name("parentSchema")};function nfe(t,e,r){let{createErrors:n}=t.it;return n===!1?(0,Gr._)`{}`:Fqe(t,e,r)}function Fqe(t,e,r={}){let{gen:n,it:i}=t,o=[zqe(i,r),Vqe(t,r)];return Hqe(t,e,o),n.object(...o)}function zqe({errorPath:t},{instancePath:e}){let r=e?(0,Gr.str)`${t}${(0,dP.getErrorPath)(e,dP.Type.Str)}`:t;return[La.default.instancePath,(0,Gr.strConcat)(La.default.instancePath,r)]}function Vqe({keyword:t,it:{errSchemaPath:e}},{schemaPath:r,parentSchema:n}){let i=n?e:(0,Gr.str)`${e}/${t}`;return r&&(i=(0,Gr.str)`${i}${(0,dP.getErrorPath)(r,dP.Type.Str)}`),[Cv.schemaPath,i]}function Hqe(t,{params:e,message:r},n){let{keyword:i,data:o,schemaValue:s,it:a}=t,{opts:d,propertyName:u,topSchemaRef:c,schemaPath:l}=a;n.push([Cv.keyword,i],[Cv.params,typeof e=="function"?e(t):e||(0,Gr._)`{}`]),d.messages&&n.push([Cv.message,typeof r=="function"?r(t):r]),d.verbose&&n.push([Cv.schema,s],[Cv.parentSchema,(0,Gr._)`${c}${l}`],[La.default.data,o]),u&&n.push([Cv.propertyName,u])}});var ofe=W(A2=>{"use strict";f();Object.defineProperty(A2,"__esModule",{value:!0});A2.boolOrEmptySchema=A2.topBoolOrEmptySchema=void 0;var Wqe=wS(),Gqe=ir(),Jqe=Zd(),Yqe={message:"boolean schema is false"};function Zqe(t){let{gen:e,schema:r,validateName:n}=t;r===!1?ife(t,!1):typeof r=="object"&&r.$async===!0?e.return(Jqe.default.data):(e.assign((0,Gqe._)`${n}.errors`,null),e.return(!0))}A2.topBoolOrEmptySchema=Zqe;function Xqe(t,e){let{gen:r,schema:n}=t;n===!1?(r.var(e,!1),ife(t)):r.var(e,!0)}A2.boolOrEmptySchema=Xqe;function ife(t,e){let{gen:r,data:n}=t,i={gen:r,keyword:"false schema",data:n,schema:!1,schemaCode:!1,schemaValue:!1,params:{},it:t};(0,Wqe.reportError)(i,Yqe,void 0,e)}});var xU=W(k2=>{"use strict";f();Object.defineProperty(k2,"__esModule",{value:!0});k2.getRules=k2.isJSONType=void 0;var Qqe=["string","number","integer","boolean","null","object","array"],eLe=new Set(Qqe);function tLe(t){return typeof t=="string"&&eLe.has(t)}k2.isJSONType=tLe;function rLe(){let t={number:{type:"number",rules:[]},string:{type:"string",rules:[]},array:{type:"array",rules:[]},object:{type:"object",rules:[]}};return{types:{...t,integer:!0,boolean:!0,null:!0},rules:[{rules:[]},t.number,t.string,t.array,t.object],post:{rules:[]},all:{},keywords:{}}}k2.getRules=rLe});var EU=W(Im=>{"use strict";f();Object.defineProperty(Im,"__esModule",{value:!0});Im.shouldUseRule=Im.shouldUseGroup=Im.schemaHasRulesForType=void 0;function nLe({schema:t,self:e},r){let n=e.RULES.types[r];return n&&n!==!0&&sfe(t,n)}Im.schemaHasRulesForType=nLe;function sfe(t,e){return e.rules.some(r=>afe(t,r))}Im.shouldUseGroup=sfe;function afe(t,e){var r;return t[e.keyword]!==void 0||((r=e.definition.implements)===null||r===void 0?void 0:r.some(n=>t[n]!==void 0))}Im.shouldUseRule=afe});var xS=W(As=>{"use strict";f();Object.defineProperty(As,"__esModule",{value:!0});As.reportTypeError=As.checkDataTypes=As.checkDataType=As.coerceAndCheckDataType=As.getJSONTypes=As.getSchemaTypes=As.DataType=void 0;var iLe=xU(),oLe=EU(),sLe=wS(),or=ir(),cfe=Cr(),_S;(function(t){t[t.Correct=0]="Correct",t[t.Wrong=1]="Wrong"})(_S=As.DataType||(As.DataType={}));function aLe(t){let e=dfe(t.type);if(e.includes("null")){if(t.nullable===!1)throw new Error("type: null contradicts nullable: false")}else{if(!e.length&&t.nullable!==void 0)throw new Error('"nullable" cannot be used without "type"');t.nullable===!0&&e.push("null")}return e}As.getSchemaTypes=aLe;function dfe(t){let e=Array.isArray(t)?t:t?[t]:[];if(e.every(iLe.isJSONType))return e;throw new Error("type must be JSONType or JSONType[]: "+e.join(","))}As.getJSONTypes=dfe;function cLe(t,e){let{gen:r,data:n,opts:i}=t,o=dLe(e,i.coerceTypes),s=e.length>0&&!(o.length===0&&e.length===1&&(0,oLe.schemaHasRulesForType)(t,e[0]));if(s){let a=TU(e,n,i.strictNumbers,_S.Wrong);r.if(a,()=>{o.length?uLe(t,e,o):AU(t)})}return s}As.coerceAndCheckDataType=cLe;var ufe=new Set(["string","number","integer","boolean","null"]);function dLe(t,e){return e?t.filter(r=>ufe.has(r)||e==="array"&&r==="array"):[]}function uLe(t,e,r){let{gen:n,data:i,opts:o}=t,s=n.let("dataType",(0,or._)`typeof ${i}`),a=n.let("coerced",(0,or._)`undefined`);o.coerceTypes==="array"&&n.if((0,or._)`${s} == 'object' && Array.isArray(${i}) && ${i}.length == 1`,()=>n.assign(i,(0,or._)`${i}[0]`).assign(s,(0,or._)`typeof ${i}`).if(TU(e,i,o.strictNumbers),()=>n.assign(a,i))),n.if((0,or._)`${a} !== undefined`);for(let u of r)(ufe.has(u)||u==="array"&&o.coerceTypes==="array")&&d(u);n.else(),AU(t),n.endIf(),n.if((0,or._)`${a} !== undefined`,()=>{n.assign(i,a),lLe(t,a)});function d(u){switch(u){case"string":n.elseIf((0,or._)`${s} == "number" || ${s} == "boolean"`).assign(a,(0,or._)`"" + ${i}`).elseIf((0,or._)`${i} === null`).assign(a,(0,or._)`""`);return;case"number":n.elseIf((0,or._)`${s} == "boolean" || ${i} === null
              || (${s} == "string" && ${i} && ${i} == +${i})`).assign(a,(0,or._)`+${i}`);return;case"integer":n.elseIf((0,or._)`${s} === "boolean" || ${i} === null
              || (${s} === "string" && ${i} && ${i} == +${i} && !(${i} % 1))`).assign(a,(0,or._)`+${i}`);return;case"boolean":n.elseIf((0,or._)`${i} === "false" || ${i} === 0 || ${i} === null`).assign(a,!1).elseIf((0,or._)`${i} === "true" || ${i} === 1`).assign(a,!0);return;case"null":n.elseIf((0,or._)`${i} === "" || ${i} === 0 || ${i} === false`),n.assign(a,null);return;case"array":n.elseIf((0,or._)`${s} === "string" || ${s} === "number"
              || ${s} === "boolean" || ${i} === null`).assign(a,(0,or._)`[${i}]`)}}}function lLe({gen:t,parentData:e,parentDataProperty:r},n){t.if((0,or._)`${e} !== undefined`,()=>t.assign((0,or._)`${e}[${r}]`,n))}function SU(t,e,r,n=_S.Correct){let i=n===_S.Correct?or.operators.EQ:or.operators.NEQ,o;switch(t){case"null":return(0,or._)`${e} ${i} null`;case"array":o=(0,or._)`Array.isArray(${e})`;break;case"object":o=(0,or._)`${e} && typeof ${e} == "object" && !Array.isArray(${e})`;break;case"integer":o=s((0,or._)`!(${e} % 1) && !isNaN(${e})`);break;case"number":o=s();break;default:return(0,or._)`typeof ${e} ${i} ${t}`}return n===_S.Correct?o:(0,or.not)(o);function s(a=or.nil){return(0,or.and)((0,or._)`typeof ${e} == "number"`,a,r?(0,or._)`isFinite(${e})`:or.nil)}}As.checkDataType=SU;function TU(t,e,r,n){if(t.length===1)return SU(t[0],e,r,n);let i,o=(0,cfe.toHash)(t);if(o.array&&o.object){let s=(0,or._)`typeof ${e} != "object"`;i=o.null?s:(0,or._)`!${e} || ${s}`,delete o.null,delete o.array,delete o.object}else i=or.nil;o.number&&delete o.integer;for(let s in o)i=(0,or.and)(i,SU(s,e,r,n));return i}As.checkDataTypes=TU;var fLe={message:({schema:t})=>`must be ${t}`,params:({schema:t,schemaValue:e})=>typeof t=="string"?(0,or._)`{type: ${t}}`:(0,or._)`{type: ${e}}`};function AU(t){let e=hLe(t);(0,sLe.reportError)(e,fLe)}As.reportTypeError=AU;function hLe(t){let{gen:e,data:r,schema:n}=t,i=(0,cfe.schemaRefOrVal)(t,n,"type");return{gen:e,keyword:"type",data:r,schema:n.type,schemaCode:i,schemaValue:i,parentSchema:n,params:{},it:t}}});var ffe=W(uP=>{"use strict";f();Object.defineProperty(uP,"__esModule",{value:!0});uP.assignDefaults=void 0;var P2=ir(),pLe=Cr();function yLe(t,e){let{properties:r,items:n}=t.schema;if(e==="object"&&r)for(let i in r)lfe(t,i,r[i].default);else e==="array"&&Array.isArray(n)&&n.forEach((i,o)=>lfe(t,o,i.default))}uP.assignDefaults=yLe;function lfe(t,e,r){let{gen:n,compositeRule:i,data:o,opts:s}=t;if(r===void 0)return;let a=(0,P2._)`${o}${(0,P2.getProperty)(e)}`;if(i){(0,pLe.checkStrictMode)(t,`default is ignored for: ${a}`);return}let d=(0,P2._)`${a} === undefined`;s.useDefaults==="empty"&&(d=(0,P2._)`${d} || ${a} === null || ${a} === ""`),n.if(d,(0,P2._)`${a} = ${(0,P2.stringify)(r)}`)}});var Xd=W(Tn=>{"use strict";f();Object.defineProperty(Tn,"__esModule",{value:!0});Tn.validateUnion=Tn.validateArray=Tn.usePattern=Tn.callValidateCode=Tn.schemaProperties=Tn.allSchemaProperties=Tn.noPropertyInData=Tn.propertyInData=Tn.isOwnProperty=Tn.hasPropFunc=Tn.reportMissingProp=Tn.checkMissingProp=Tn.checkReportMissingProp=void 0;var Gn=ir(),kU=Cr(),Rm=Zd(),mLe=Cr();function gLe(t,e){let{gen:r,data:n,it:i}=t;r.if(IU(r,n,e,i.opts.ownProperties),()=>{t.setParams({missingProperty:(0,Gn._)`${e}`},!0),t.error()})}Tn.checkReportMissingProp=gLe;function vLe({gen:t,data:e,it:{opts:r}},n,i){return(0,Gn.or)(...n.map(o=>(0,Gn.and)(IU(t,e,o,r.ownProperties),(0,Gn._)`${i} = ${o}`)))}Tn.checkMissingProp=vLe;function bLe(t,e){t.setParams({missingProperty:e},!0),t.error()}Tn.reportMissingProp=bLe;function hfe(t){return t.scopeValue("func",{ref:Object.prototype.hasOwnProperty,code:(0,Gn._)`Object.prototype.hasOwnProperty`})}Tn.hasPropFunc=hfe;function PU(t,e,r){return(0,Gn._)`${hfe(t)}.call(${e}, ${r})`}Tn.isOwnProperty=PU;function wLe(t,e,r,n){let i=(0,Gn._)`${e}${(0,Gn.getProperty)(r)} !== undefined`;return n?(0,Gn._)`${i} && ${PU(t,e,r)}`:i}Tn.propertyInData=wLe;function IU(t,e,r,n){let i=(0,Gn._)`${e}${(0,Gn.getProperty)(r)} === undefined`;return n?(0,Gn.or)(i,(0,Gn.not)(PU(t,e,r))):i}Tn.noPropertyInData=IU;function pfe(t){return t?Object.keys(t).filter(e=>e!=="__proto__"):[]}Tn.allSchemaProperties=pfe;function _Le(t,e){return pfe(e).filter(r=>!(0,kU.alwaysValidSchema)(t,e[r]))}Tn.schemaProperties=_Le;function xLe({schemaCode:t,data:e,it:{gen:r,topSchemaRef:n,schemaPath:i,errorPath:o},it:s},a,d,u){let c=u?(0,Gn._)`${t}, ${e}, ${n}${i}`:e,l=[[Rm.default.instancePath,(0,Gn.strConcat)(Rm.default.instancePath,o)],[Rm.default.parentData,s.parentData],[Rm.default.parentDataProperty,s.parentDataProperty],[Rm.default.rootData,Rm.default.rootData]];s.opts.dynamicRef&&l.push([Rm.default.dynamicAnchors,Rm.default.dynamicAnchors]);let h=(0,Gn._)`${c}, ${r.object(...l)}`;return d!==Gn.nil?(0,Gn._)`${a}.call(${d}, ${h})`:(0,Gn._)`${a}(${h})`}Tn.callValidateCode=xLe;var ELe=(0,Gn._)`new RegExp`;function SLe({gen:t,it:{opts:e}},r){let n=e.unicodeRegExp?"u":"",{regExp:i}=e.code,o=i(r,n);return t.scopeValue("pattern",{key:o.toString(),ref:o,code:(0,Gn._)`${i.code==="new RegExp"?ELe:(0,mLe.useFunc)(t,i)}(${r}, ${n})`})}Tn.usePattern=SLe;function TLe(t){let{gen:e,data:r,keyword:n,it:i}=t,o=e.name("valid");if(i.allErrors){let a=e.let("valid",!0);return s(()=>e.assign(a,!1)),a}return e.var(o,!0),s(()=>e.break()),o;function s(a){let d=e.const("len",(0,Gn._)`${r}.length`);e.forRange("i",0,d,u=>{t.subschema({keyword:n,dataProp:u,dataPropType:kU.Type.Num},o),e.if((0,Gn.not)(o),a)})}}Tn.validateArray=TLe;function ALe(t){let{gen:e,schema:r,keyword:n,it:i}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(r.some(d=>(0,kU.alwaysValidSchema)(i,d))&&!i.opts.unevaluated)return;let s=e.let("valid",!1),a=e.name("_valid");e.block(()=>r.forEach((d,u)=>{let c=t.subschema({keyword:n,schemaProp:u,compositeRule:!0},a);e.assign(s,(0,Gn._)`${s} || ${a}`),t.mergeValidEvaluated(c,a)||e.if((0,Gn.not)(s))})),t.result(s,()=>t.reset(),()=>t.error(!0))}Tn.validateUnion=ALe});var gfe=W(Af=>{"use strict";f();Object.defineProperty(Af,"__esModule",{value:!0});Af.validateKeywordUsage=Af.validSchemaType=Af.funcKeywordCode=Af.macroKeywordCode=void 0;var Fa=ir(),jv=Zd(),kLe=Xd(),PLe=wS();function ILe(t,e){let{gen:r,keyword:n,schema:i,parentSchema:o,it:s}=t,a=e.macro.call(s.self,i,o,s),d=mfe(r,n,a);s.opts.validateSchema!==!1&&s.self.validateSchema(a,!0);let u=r.name("valid");t.subschema({schema:a,schemaPath:Fa.nil,errSchemaPath:`${s.errSchemaPath}/${n}`,topSchemaRef:d,compositeRule:!0},u),t.pass(u,()=>t.error(!0))}Af.macroKeywordCode=ILe;function RLe(t,e){var r;let{gen:n,keyword:i,schema:o,parentSchema:s,$data:a,it:d}=t;OLe(d,e);let u=!a&&e.compile?e.compile.call(d.self,o,s,d):e.validate,c=mfe(n,i,u),l=n.let("valid");t.block$data(l,h),t.ok((r=e.valid)!==null&&r!==void 0?r:l);function h(){if(e.errors===!1)v(),e.modifying&&yfe(t),x(()=>t.error());else{let S=e.async?y():g();e.modifying&&yfe(t),x(()=>BLe(t,S))}}function y(){let S=n.let("ruleErrs",null);return n.try(()=>v((0,Fa._)`await `),A=>n.assign(l,!1).if((0,Fa._)`${A} instanceof ${d.ValidationError}`,()=>n.assign(S,(0,Fa._)`${A}.errors`),()=>n.throw(A))),S}function g(){let S=(0,Fa._)`${c}.errors`;return n.assign(S,null),v(Fa.nil),S}function v(S=e.async?(0,Fa._)`await `:Fa.nil){let A=d.opts.passContext?jv.default.this:jv.default.self,T=!("compile"in e&&!a||e.schema===!1);n.assign(l,(0,Fa._)`${S}${(0,kLe.callValidateCode)(t,c,A,T)}`,e.modifying)}function x(S){var A;n.if((0,Fa.not)((A=e.valid)!==null&&A!==void 0?A:l),S)}}Af.funcKeywordCode=RLe;function yfe(t){let{gen:e,data:r,it:n}=t;e.if(n.parentData,()=>e.assign(r,(0,Fa._)`${n.parentData}[${n.parentDataProperty}]`))}function BLe(t,e){let{gen:r}=t;r.if((0,Fa._)`Array.isArray(${e})`,()=>{r.assign(jv.default.vErrors,(0,Fa._)`${jv.default.vErrors} === null ? ${e} : ${jv.default.vErrors}.concat(${e})`).assign(jv.default.errors,(0,Fa._)`${jv.default.vErrors}.length`),(0,PLe.extendErrors)(t)},()=>t.error())}function OLe({schemaEnv:t},e){if(e.async&&!t.$async)throw new Error("async keyword in sync schema")}function mfe(t,e,r){if(r===void 0)throw new Error(`keyword "${e}" failed to compile`);return t.scopeValue("keyword",typeof r=="function"?{ref:r}:{ref:r,code:(0,Fa.stringify)(r)})}function MLe(t,e,r=!1){return!e.length||e.some(n=>n==="array"?Array.isArray(t):n==="object"?t&&typeof t=="object"&&!Array.isArray(t):typeof t==n||r&&typeof t>"u")}Af.validSchemaType=MLe;function DLe({schema:t,opts:e,self:r,errSchemaPath:n},i,o){if(Array.isArray(i.keyword)?!i.keyword.includes(o):i.keyword!==o)throw new Error("ajv implementation error");let s=i.dependencies;if(s?.some(a=>!Object.prototype.hasOwnProperty.call(t,a)))throw new Error(`parent schema must have dependencies of ${o}: ${s.join(",")}`);if(i.validateSchema&&!i.validateSchema(t[o])){let d=`keyword "${o}" value is invalid at path "${n}": `+r.errorsText(i.validateSchema.errors);if(e.validateSchema==="log")r.logger.error(d);else throw new Error(d)}}Af.validateKeywordUsage=DLe});var bfe=W(Bm=>{"use strict";f();Object.defineProperty(Bm,"__esModule",{value:!0});Bm.extendSubschemaMode=Bm.extendSubschemaData=Bm.getSubschema=void 0;var kf=ir(),vfe=Cr();function CLe(t,{keyword:e,schemaProp:r,schema:n,schemaPath:i,errSchemaPath:o,topSchemaRef:s}){if(e!==void 0&&n!==void 0)throw new Error('both "keyword" and "schema" passed, only one allowed');if(e!==void 0){let a=t.schema[e];return r===void 0?{schema:a,schemaPath:(0,kf._)`${t.schemaPath}${(0,kf.getProperty)(e)}`,errSchemaPath:`${t.errSchemaPath}/${e}`}:{schema:a[r],schemaPath:(0,kf._)`${t.schemaPath}${(0,kf.getProperty)(e)}${(0,kf.getProperty)(r)}`,errSchemaPath:`${t.errSchemaPath}/${e}/${(0,vfe.escapeFragment)(r)}`}}if(n!==void 0){if(i===void 0||o===void 0||s===void 0)throw new Error('"schemaPath", "errSchemaPath" and "topSchemaRef" are required with "schema"');return{schema:n,schemaPath:i,topSchemaRef:s,errSchemaPath:o}}throw new Error('either "keyword" or "schema" must be passed')}Bm.getSubschema=CLe;function jLe(t,e,{dataProp:r,dataPropType:n,data:i,dataTypes:o,propertyName:s}){if(i!==void 0&&r!==void 0)throw new Error('both "data" and "dataProp" passed, only one allowed');let{gen:a}=e;if(r!==void 0){let{errorPath:u,dataPathArr:c,opts:l}=e,h=a.let("data",(0,kf._)`${e.data}${(0,kf.getProperty)(r)}`,!0);d(h),t.errorPath=(0,kf.str)`${u}${(0,vfe.getErrorPath)(r,n,l.jsPropertySyntax)}`,t.parentDataProperty=(0,kf._)`${r}`,t.dataPathArr=[...c,t.parentDataProperty]}if(i!==void 0){let u=i instanceof kf.Name?i:a.let("data",i,!0);d(u),s!==void 0&&(t.propertyName=s)}o&&(t.dataTypes=o);function d(u){t.data=u,t.dataLevel=e.dataLevel+1,t.dataTypes=[],e.definedProperties=new Set,t.parentData=e.data,t.dataNames=[...e.dataNames,u]}}Bm.extendSubschemaData=jLe;function $Le(t,{jtdDiscriminator:e,jtdMetadata:r,compositeRule:n,createErrors:i,allErrors:o}){n!==void 0&&(t.compositeRule=n),i!==void 0&&(t.createErrors=i),o!==void 0&&(t.allErrors=o),t.jtdDiscriminator=e,t.jtdMetadata=r}Bm.extendSubschemaMode=$Le});var RU=W((Q5t,wfe)=>{"use strict";f();wfe.exports=function t(e,r){if(e===r)return!0;if(e&&r&&typeof e=="object"&&typeof r=="object"){if(e.constructor!==r.constructor)return!1;var n,i,o;if(Array.isArray(e)){if(n=e.length,n!=r.length)return!1;for(i=n;i--!==0;)if(!t(e[i],r[i]))return!1;return!0}if(e.constructor===RegExp)return e.source===r.source&&e.flags===r.flags;if(e.valueOf!==Object.prototype.valueOf)return e.valueOf()===r.valueOf();if(e.toString!==Object.prototype.toString)return e.toString()===r.toString();if(o=Object.keys(e),n=o.length,n!==Object.keys(r).length)return!1;for(i=n;i--!==0;)if(!Object.prototype.hasOwnProperty.call(r,o[i]))return!1;for(i=n;i--!==0;){var s=o[i];if(!t(e[s],r[s]))return!1}return!0}return e!==e&&r!==r}});var xfe=W((t3t,_fe)=>{"use strict";f();var Om=_fe.exports=function(t,e,r){typeof e=="function"&&(r=e,e={}),r=e.cb||r;var n=typeof r=="function"?r:r.pre||function(){},i=r.post||function(){};lP(e,n,i,t,"",t)};Om.keywords={additionalItems:!0,items:!0,contains:!0,additionalProperties:!0,propertyNames:!0,not:!0,if:!0,then:!0,else:!0};Om.arrayKeywords={items:!0,allOf:!0,anyOf:!0,oneOf:!0};Om.propsKeywords={$defs:!0,definitions:!0,properties:!0,patternProperties:!0,dependencies:!0};Om.skipKeywords={default:!0,enum:!0,const:!0,required:!0,maximum:!0,minimum:!0,exclusiveMaximum:!0,exclusiveMinimum:!0,multipleOf:!0,maxLength:!0,minLength:!0,pattern:!0,format:!0,maxItems:!0,minItems:!0,uniqueItems:!0,maxProperties:!0,minProperties:!0};function lP(t,e,r,n,i,o,s,a,d,u){if(n&&typeof n=="object"&&!Array.isArray(n)){e(n,i,o,s,a,d,u);for(var c in n){var l=n[c];if(Array.isArray(l)){if(c in Om.arrayKeywords)for(var h=0;h<l.length;h++)lP(t,e,r,l[h],i+"/"+c+"/"+h,o,i,c,n,h)}else if(c in Om.propsKeywords){if(l&&typeof l=="object")for(var y in l)lP(t,e,r,l[y],i+"/"+c+"/"+NLe(y),o,i,c,n,y)}else(c in Om.keywords||t.allKeys&&!(c in Om.skipKeywords))&&lP(t,e,r,l,i+"/"+c,o,i,c,n)}r(n,i,o,s,a,d,u)}}function NLe(t){return t.replace(/~/g,"~0").replace(/\//g,"~1")}});var ES=W(mc=>{"use strict";f();Object.defineProperty(mc,"__esModule",{value:!0});mc.getSchemaRefs=mc.resolveUrl=mc.normalizeId=mc._getFullPath=mc.getFullPath=mc.inlineRef=void 0;var ULe=Cr(),KLe=RU(),qLe=xfe(),LLe=new Set(["type","format","pattern","maxLength","minLength","maxProperties","minProperties","maxItems","minItems","maximum","minimum","uniqueItems","multipleOf","required","enum","const"]);function FLe(t,e=!0){return typeof t=="boolean"?!0:e===!0?!BU(t):e?Efe(t)<=e:!1}mc.inlineRef=FLe;var zLe=new Set(["$ref","$recursiveRef","$recursiveAnchor","$dynamicRef","$dynamicAnchor"]);function BU(t){for(let e in t){if(zLe.has(e))return!0;let r=t[e];if(Array.isArray(r)&&r.some(BU)||typeof r=="object"&&BU(r))return!0}return!1}function Efe(t){let e=0;for(let r in t){if(r==="$ref")return 1/0;if(e++,!LLe.has(r)&&(typeof t[r]=="object"&&(0,ULe.eachItem)(t[r],n=>e+=Efe(n)),e===1/0))return 1/0}return e}function Sfe(t,e="",r){r!==!1&&(e=I2(e));let n=t.parse(e);return Tfe(t,n)}mc.getFullPath=Sfe;function Tfe(t,e){return t.serialize(e).split("#")[0]+"#"}mc._getFullPath=Tfe;var VLe=/#\/?$/;function I2(t){return t?t.replace(VLe,""):""}mc.normalizeId=I2;function HLe(t,e,r){return r=I2(r),t.resolve(e,r)}mc.resolveUrl=HLe;var WLe=/^[a-z_][-a-z0-9._]*$/i;function GLe(t,e){if(typeof t=="boolean")return{};let{schemaId:r,uriResolver:n}=this.opts,i=I2(t[r]||e),o={"":i},s=Sfe(n,i,!1),a={},d=new Set;return qLe(t,{allKeys:!0},(l,h,y,g)=>{if(g===void 0)return;let v=s+h,x=o[g];typeof l[r]=="string"&&(x=S.call(this,l[r])),A.call(this,l.$anchor),A.call(this,l.$dynamicAnchor),o[h]=x;function S(T){let $=this.opts.uriResolver.resolve;if(T=I2(x?$(x,T):T),d.has(T))throw c(T);d.add(T);let j=this.refs[T];return typeof j=="string"&&(j=this.refs[j]),typeof j=="object"?u(l,j.schema,T):T!==I2(v)&&(T[0]==="#"?(u(l,a[T],T),a[T]=l):this.refs[T]=v),T}function A(T){if(typeof T=="string"){if(!WLe.test(T))throw new Error(`invalid anchor "${T}"`);S.call(this,`#${T}`)}}}),a;function u(l,h,y){if(h!==void 0&&!KLe(l,h))throw c(y)}function c(l){return new Error(`reference "${l}" resolves to more than one schema`)}}mc.getSchemaRefs=GLe});var AS=W(Mm=>{"use strict";f();Object.defineProperty(Mm,"__esModule",{value:!0});Mm.getData=Mm.KeywordCxt=Mm.validateFunctionCode=void 0;var Rfe=ofe(),Afe=xS(),MU=EU(),fP=xS(),JLe=ffe(),TS=gfe(),OU=bfe(),yt=ir(),Kt=Zd(),YLe=ES(),dp=Cr(),SS=wS();function ZLe(t){if(Mfe(t)&&(Dfe(t),Ofe(t))){eFe(t);return}Bfe(t,()=>(0,Rfe.topBoolOrEmptySchema)(t))}Mm.validateFunctionCode=ZLe;function Bfe({gen:t,validateName:e,schema:r,schemaEnv:n,opts:i},o){i.code.es5?t.func(e,(0,yt._)`${Kt.default.data}, ${Kt.default.valCxt}`,n.$async,()=>{t.code((0,yt._)`"use strict"; ${kfe(r,i)}`),QLe(t,i),t.code(o)}):t.func(e,(0,yt._)`${Kt.default.data}, ${XLe(i)}`,n.$async,()=>t.code(kfe(r,i)).code(o))}function XLe(t){return(0,yt._)`{${Kt.default.instancePath}="", ${Kt.default.parentData}, ${Kt.default.parentDataProperty}, ${Kt.default.rootData}=${Kt.default.data}${t.dynamicRef?(0,yt._)`, ${Kt.default.dynamicAnchors}={}`:yt.nil}}={}`}function QLe(t,e){t.if(Kt.default.valCxt,()=>{t.var(Kt.default.instancePath,(0,yt._)`${Kt.default.valCxt}.${Kt.default.instancePath}`),t.var(Kt.default.parentData,(0,yt._)`${Kt.default.valCxt}.${Kt.default.parentData}`),t.var(Kt.default.parentDataProperty,(0,yt._)`${Kt.default.valCxt}.${Kt.default.parentDataProperty}`),t.var(Kt.default.rootData,(0,yt._)`${Kt.default.valCxt}.${Kt.default.rootData}`),e.dynamicRef&&t.var(Kt.default.dynamicAnchors,(0,yt._)`${Kt.default.valCxt}.${Kt.default.dynamicAnchors}`)},()=>{t.var(Kt.default.instancePath,(0,yt._)`""`),t.var(Kt.default.parentData,(0,yt._)`undefined`),t.var(Kt.default.parentDataProperty,(0,yt._)`undefined`),t.var(Kt.default.rootData,Kt.default.data),e.dynamicRef&&t.var(Kt.default.dynamicAnchors,(0,yt._)`{}`)})}function eFe(t){let{schema:e,opts:r,gen:n}=t;Bfe(t,()=>{r.$comment&&e.$comment&&jfe(t),oFe(t),n.let(Kt.default.vErrors,null),n.let(Kt.default.errors,0),r.unevaluated&&tFe(t),Cfe(t),cFe(t)})}function tFe(t){let{gen:e,validateName:r}=t;t.evaluated=e.const("evaluated",(0,yt._)`${r}.evaluated`),e.if((0,yt._)`${t.evaluated}.dynamicProps`,()=>e.assign((0,yt._)`${t.evaluated}.props`,(0,yt._)`undefined`)),e.if((0,yt._)`${t.evaluated}.dynamicItems`,()=>e.assign((0,yt._)`${t.evaluated}.items`,(0,yt._)`undefined`))}function kfe(t,e){let r=typeof t=="object"&&t[e.schemaId];return r&&(e.code.source||e.code.process)?(0,yt._)`/*# sourceURL=${r} */`:yt.nil}function rFe(t,e){if(Mfe(t)&&(Dfe(t),Ofe(t))){nFe(t,e);return}(0,Rfe.boolOrEmptySchema)(t,e)}function Ofe({schema:t,self:e}){if(typeof t=="boolean")return!t;for(let r in t)if(e.RULES.all[r])return!0;return!1}function Mfe(t){return typeof t.schema!="boolean"}function nFe(t,e){let{schema:r,gen:n,opts:i}=t;i.$comment&&r.$comment&&jfe(t),sFe(t),aFe(t);let o=n.const("_errs",Kt.default.errors);Cfe(t,o),n.var(e,(0,yt._)`${o} === ${Kt.default.errors}`)}function Dfe(t){(0,dp.checkUnknownRules)(t),iFe(t)}function Cfe(t,e){if(t.opts.jtd)return Pfe(t,[],!1,e);let r=(0,Afe.getSchemaTypes)(t.schema),n=(0,Afe.coerceAndCheckDataType)(t,r);Pfe(t,r,!n,e)}function iFe(t){let{schema:e,errSchemaPath:r,opts:n,self:i}=t;e.$ref&&n.ignoreKeywordsWithRef&&(0,dp.schemaHasRulesButRef)(e,i.RULES)&&i.logger.warn(`$ref: keywords ignored in schema at path "${r}"`)}function oFe(t){let{schema:e,opts:r}=t;e.default!==void 0&&r.useDefaults&&r.strictSchema&&(0,dp.checkStrictMode)(t,"default is ignored in the schema root")}function sFe(t){let e=t.schema[t.opts.schemaId];e&&(t.baseId=(0,YLe.resolveUrl)(t.opts.uriResolver,t.baseId,e))}function aFe(t){if(t.schema.$async&&!t.schemaEnv.$async)throw new Error("async schema in sync schema")}function jfe({gen:t,schemaEnv:e,schema:r,errSchemaPath:n,opts:i}){let o=r.$comment;if(i.$comment===!0)t.code((0,yt._)`${Kt.default.self}.logger.log(${o})`);else if(typeof i.$comment=="function"){let s=(0,yt.str)`${n}/$comment`,a=t.scopeValue("root",{ref:e.root});t.code((0,yt._)`${Kt.default.self}.opts.$comment(${o}, ${s}, ${a}.schema)`)}}function cFe(t){let{gen:e,schemaEnv:r,validateName:n,ValidationError:i,opts:o}=t;r.$async?e.if((0,yt._)`${Kt.default.errors} === 0`,()=>e.return(Kt.default.data),()=>e.throw((0,yt._)`new ${i}(${Kt.default.vErrors})`)):(e.assign((0,yt._)`${n}.errors`,Kt.default.vErrors),o.unevaluated&&dFe(t),e.return((0,yt._)`${Kt.default.errors} === 0`))}function dFe({gen:t,evaluated:e,props:r,items:n}){r instanceof yt.Name&&t.assign((0,yt._)`${e}.props`,r),n instanceof yt.Name&&t.assign((0,yt._)`${e}.items`,n)}function Pfe(t,e,r,n){let{gen:i,schema:o,data:s,allErrors:a,opts:d,self:u}=t,{RULES:c}=u;if(o.$ref&&(d.ignoreKeywordsWithRef||!(0,dp.schemaHasRulesButRef)(o,c))){i.block(()=>Nfe(t,"$ref",c.all.$ref.definition));return}d.jtd||uFe(t,e),i.block(()=>{for(let h of c.rules)l(h);l(c.post)});function l(h){(0,MU.shouldUseGroup)(o,h)&&(h.type?(i.if((0,fP.checkDataType)(h.type,s,d.strictNumbers)),Ife(t,h),e.length===1&&e[0]===h.type&&r&&(i.else(),(0,fP.reportTypeError)(t)),i.endIf()):Ife(t,h),a||i.if((0,yt._)`${Kt.default.errors} === ${n||0}`))}}function Ife(t,e){let{gen:r,schema:n,opts:{useDefaults:i}}=t;i&&(0,JLe.assignDefaults)(t,e.type),r.block(()=>{for(let o of e.rules)(0,MU.shouldUseRule)(n,o)&&Nfe(t,o.keyword,o.definition,e.type)})}function uFe(t,e){t.schemaEnv.meta||!t.opts.strictTypes||(lFe(t,e),t.opts.allowUnionTypes||fFe(t,e),hFe(t,t.dataTypes))}function lFe(t,e){if(e.length){if(!t.dataTypes.length){t.dataTypes=e;return}e.forEach(r=>{$fe(t.dataTypes,r)||DU(t,`type "${r}" not allowed by context "${t.dataTypes.join(",")}"`)}),yFe(t,e)}}function fFe(t,e){e.length>1&&!(e.length===2&&e.includes("null"))&&DU(t,"use allowUnionTypes to allow union type keyword")}function hFe(t,e){let r=t.self.RULES.all;for(let n in r){let i=r[n];if(typeof i=="object"&&(0,MU.shouldUseRule)(t.schema,i)){let{type:o}=i.definition;o.length&&!o.some(s=>pFe(e,s))&&DU(t,`missing type "${o.join(",")}" for keyword "${n}"`)}}}function pFe(t,e){return t.includes(e)||e==="number"&&t.includes("integer")}function $fe(t,e){return t.includes(e)||e==="integer"&&t.includes("number")}function yFe(t,e){let r=[];for(let n of t.dataTypes)$fe(e,n)?r.push(n):e.includes("integer")&&n==="number"&&r.push("integer");t.dataTypes=r}function DU(t,e){let r=t.schemaEnv.baseId+t.errSchemaPath;e+=` at "${r}" (strictTypes)`,(0,dp.checkStrictMode)(t,e,t.opts.strictTypes)}var hP=class{constructor(e,r,n){if((0,TS.validateKeywordUsage)(e,r,n),this.gen=e.gen,this.allErrors=e.allErrors,this.keyword=n,this.data=e.data,this.schema=e.schema[n],this.$data=r.$data&&e.opts.$data&&this.schema&&this.schema.$data,this.schemaValue=(0,dp.schemaRefOrVal)(e,this.schema,n,this.$data),this.schemaType=r.schemaType,this.parentSchema=e.schema,this.params={},this.it=e,this.def=r,this.$data)this.schemaCode=e.gen.const("vSchema",Ufe(this.$data,e));else if(this.schemaCode=this.schemaValue,!(0,TS.validSchemaType)(this.schema,r.schemaType,r.allowUndefined))throw new Error(`${n} value must be ${JSON.stringify(r.schemaType)}`);("code"in r?r.trackErrors:r.errors!==!1)&&(this.errsCount=e.gen.const("_errs",Kt.default.errors))}result(e,r,n){this.failResult((0,yt.not)(e),r,n)}failResult(e,r,n){this.gen.if(e),n?n():this.error(),r?(this.gen.else(),r(),this.allErrors&&this.gen.endIf()):this.allErrors?this.gen.endIf():this.gen.else()}pass(e,r){this.failResult((0,yt.not)(e),void 0,r)}fail(e){if(e===void 0){this.error(),this.allErrors||this.gen.if(!1);return}this.gen.if(e),this.error(),this.allErrors?this.gen.endIf():this.gen.else()}fail$data(e){if(!this.$data)return this.fail(e);let{schemaCode:r}=this;this.fail((0,yt._)`${r} !== undefined && (${(0,yt.or)(this.invalid$data(),e)})`)}error(e,r,n){if(r){this.setParams(r),this._error(e,n),this.setParams({});return}this._error(e,n)}_error(e,r){(e?SS.reportExtraError:SS.reportError)(this,this.def.error,r)}$dataError(){(0,SS.reportError)(this,this.def.$dataError||SS.keyword$DataError)}reset(){if(this.errsCount===void 0)throw new Error('add "trackErrors" to keyword definition');(0,SS.resetErrorsCount)(this.gen,this.errsCount)}ok(e){this.allErrors||this.gen.if(e)}setParams(e,r){r?Object.assign(this.params,e):this.params=e}block$data(e,r,n=yt.nil){this.gen.block(()=>{this.check$data(e,n),r()})}check$data(e=yt.nil,r=yt.nil){if(!this.$data)return;let{gen:n,schemaCode:i,schemaType:o,def:s}=this;n.if((0,yt.or)((0,yt._)`${i} === undefined`,r)),e!==yt.nil&&n.assign(e,!0),(o.length||s.validateSchema)&&(n.elseIf(this.invalid$data()),this.$dataError(),e!==yt.nil&&n.assign(e,!1)),n.else()}invalid$data(){let{gen:e,schemaCode:r,schemaType:n,def:i,it:o}=this;return(0,yt.or)(s(),a());function s(){if(n.length){if(!(r instanceof yt.Name))throw new Error("ajv implementation error");let d=Array.isArray(n)?n:[n];return(0,yt._)`${(0,fP.checkDataTypes)(d,r,o.opts.strictNumbers,fP.DataType.Wrong)}`}return yt.nil}function a(){if(i.validateSchema){let d=e.scopeValue("validate$data",{ref:i.validateSchema});return(0,yt._)`!${d}(${r})`}return yt.nil}}subschema(e,r){let n=(0,OU.getSubschema)(this.it,e);(0,OU.extendSubschemaData)(n,this.it,e),(0,OU.extendSubschemaMode)(n,e);let i={...this.it,...n,items:void 0,props:void 0};return rFe(i,r),i}mergeEvaluated(e,r){let{it:n,gen:i}=this;n.opts.unevaluated&&(n.props!==!0&&e.props!==void 0&&(n.props=dp.mergeEvaluated.props(i,e.props,n.props,r)),n.items!==!0&&e.items!==void 0&&(n.items=dp.mergeEvaluated.items(i,e.items,n.items,r)))}mergeValidEvaluated(e,r){let{it:n,gen:i}=this;if(n.opts.unevaluated&&(n.props!==!0||n.items!==!0))return i.if(r,()=>this.mergeEvaluated(e,yt.Name)),!0}};Mm.KeywordCxt=hP;function Nfe(t,e,r,n){let i=new hP(t,r,e);"code"in r?r.code(i,n):i.$data&&r.validate?(0,TS.funcKeywordCode)(i,r):"macro"in r?(0,TS.macroKeywordCode)(i,r):(r.compile||r.validate)&&(0,TS.funcKeywordCode)(i,r)}var mFe=/^\/(?:[^~]|~0|~1)*$/,gFe=/^([0-9]+)(#|\/(?:[^~]|~0|~1)*)?$/;function Ufe(t,{dataLevel:e,dataNames:r,dataPathArr:n}){let i,o;if(t==="")return Kt.default.rootData;if(t[0]==="/"){if(!mFe.test(t))throw new Error(`Invalid JSON-pointer: ${t}`);i=t,o=Kt.default.rootData}else{let u=gFe.exec(t);if(!u)throw new Error(`Invalid JSON-pointer: ${t}`);let c=+u[1];if(i=u[2],i==="#"){if(c>=e)throw new Error(d("property/index",c));return n[e-c]}if(c>e)throw new Error(d("data",c));if(o=r[e-c],!i)return o}let s=o,a=i.split("/");for(let u of a)u&&(o=(0,yt._)`${o}${(0,yt.getProperty)((0,dp.unescapeJsonPointer)(u))}`,s=(0,yt._)`${s} && ${o}`);return s;function d(u,c){return`Cannot access ${u} ${c} levels up, current level is ${e}`}}Mm.getData=Ufe});var pP=W(jU=>{"use strict";f();Object.defineProperty(jU,"__esModule",{value:!0});var CU=class extends Error{constructor(e){super("validation failed"),this.errors=e,this.ajv=this.validation=!0}};jU.default=CU});var yP=W(UU=>{"use strict";f();Object.defineProperty(UU,"__esModule",{value:!0});var $U=ES(),NU=class extends Error{constructor(e,r,n,i){super(i||`can't resolve reference ${n} from id ${r}`),this.missingRef=(0,$U.resolveUrl)(e,r,n),this.missingSchema=(0,$U.normalizeId)((0,$U.getFullPath)(e,this.missingRef))}};UU.default=NU});var kS=W(Qd=>{"use strict";f();Object.defineProperty(Qd,"__esModule",{value:!0});Qd.resolveSchema=Qd.getCompilingSchema=Qd.resolveRef=Qd.compileSchema=Qd.SchemaEnv=void 0;var sl=ir(),vFe=pP(),$v=Zd(),al=ES(),Kfe=Cr(),bFe=AS(),R2=class{constructor(e){var r;this.refs={},this.dynamicAnchors={};let n;typeof e.schema=="object"&&(n=e.schema),this.schema=e.schema,this.schemaId=e.schemaId,this.root=e.root||this,this.baseId=(r=e.baseId)!==null&&r!==void 0?r:(0,al.normalizeId)(n?.[e.schemaId||"$id"]),this.schemaPath=e.schemaPath,this.localRefs=e.localRefs,this.meta=e.meta,this.$async=n?.$async,this.refs={}}};Qd.SchemaEnv=R2;function qU(t){let e=qfe.call(this,t);if(e)return e;let r=(0,al.getFullPath)(this.opts.uriResolver,t.root.baseId),{es5:n,lines:i}=this.opts.code,{ownProperties:o}=this.opts,s=new sl.CodeGen(this.scope,{es5:n,lines:i,ownProperties:o}),a;t.$async&&(a=s.scopeValue("Error",{ref:vFe.default,code:(0,sl._)`require("ajv/dist/runtime/validation_error").default`}));let d=s.scopeName("validate");t.validateName=d;let u={gen:s,allErrors:this.opts.allErrors,data:$v.default.data,parentData:$v.default.parentData,parentDataProperty:$v.default.parentDataProperty,dataNames:[$v.default.data],dataPathArr:[sl.nil],dataLevel:0,dataTypes:[],definedProperties:new Set,topSchemaRef:s.scopeValue("schema",this.opts.code.source===!0?{ref:t.schema,code:(0,sl.stringify)(t.schema)}:{ref:t.schema}),validateName:d,ValidationError:a,schema:t.schema,schemaEnv:t,rootId:r,baseId:t.baseId||r,schemaPath:sl.nil,errSchemaPath:t.schemaPath||(this.opts.jtd?"":"#"),errorPath:(0,sl._)`""`,opts:this.opts,self:this},c;try{this._compilations.add(t),(0,bFe.validateFunctionCode)(u),s.optimize(this.opts.code.optimize);let l=s.toString();c=`${s.scopeRefs($v.default.scope)}return ${l}`,this.opts.code.process&&(c=this.opts.code.process(c,t));let y=new Function(`${$v.default.self}`,`${$v.default.scope}`,c)(this,this.scope.get());if(this.scope.value(d,{ref:y}),y.errors=null,y.schema=t.schema,y.schemaEnv=t,t.$async&&(y.$async=!0),this.opts.code.source===!0&&(y.source={validateName:d,validateCode:l,scopeValues:s._values}),this.opts.unevaluated){let{props:g,items:v}=u;y.evaluated={props:g instanceof sl.Name?void 0:g,items:v instanceof sl.Name?void 0:v,dynamicProps:g instanceof sl.Name,dynamicItems:v instanceof sl.Name},y.source&&(y.source.evaluated=(0,sl.stringify)(y.evaluated))}return t.validate=y,t}catch(l){throw delete t.validate,delete t.validateName,c&&this.logger.error("Error compiling schema, function code:",c),l}finally{this._compilations.delete(t)}}Qd.compileSchema=qU;function wFe(t,e,r){var n;r=(0,al.resolveUrl)(this.opts.uriResolver,e,r);let i=t.refs[r];if(i)return i;let o=EFe.call(this,t,r);if(o===void 0){let s=(n=t.localRefs)===null||n===void 0?void 0:n[r],{schemaId:a}=this.opts;s&&(o=new R2({schema:s,schemaId:a,root:t,baseId:e}))}if(o!==void 0)return t.refs[r]=_Fe.call(this,o)}Qd.resolveRef=wFe;function _Fe(t){return(0,al.inlineRef)(t.schema,this.opts.inlineRefs)?t.schema:t.validate?t:qU.call(this,t)}function qfe(t){for(let e of this._compilations)if(xFe(e,t))return e}Qd.getCompilingSchema=qfe;function xFe(t,e){return t.schema===e.schema&&t.root===e.root&&t.baseId===e.baseId}function EFe(t,e){let r;for(;typeof(r=this.refs[e])=="string";)e=r;return r||this.schemas[e]||mP.call(this,t,e)}function mP(t,e){let r=this.opts.uriResolver.parse(e),n=(0,al._getFullPath)(this.opts.uriResolver,r),i=(0,al.getFullPath)(this.opts.uriResolver,t.baseId,void 0);if(Object.keys(t.schema).length>0&&n===i)return KU.call(this,r,t);let o=(0,al.normalizeId)(n),s=this.refs[o]||this.schemas[o];if(typeof s=="string"){let a=mP.call(this,t,s);return typeof a?.schema!="object"?void 0:KU.call(this,r,a)}if(typeof s?.schema=="object"){if(s.validate||qU.call(this,s),o===(0,al.normalizeId)(e)){let{schema:a}=s,{schemaId:d}=this.opts,u=a[d];return u&&(i=(0,al.resolveUrl)(this.opts.uriResolver,i,u)),new R2({schema:a,schemaId:d,root:t,baseId:i})}return KU.call(this,r,s)}}Qd.resolveSchema=mP;var SFe=new Set(["properties","patternProperties","enum","dependencies","definitions"]);function KU(t,{baseId:e,schema:r,root:n}){var i;if(((i=t.fragment)===null||i===void 0?void 0:i[0])!=="/")return;for(let a of t.fragment.slice(1).split("/")){if(typeof r=="boolean")return;let d=r[(0,Kfe.unescapeFragment)(a)];if(d===void 0)return;r=d;let u=typeof r=="object"&&r[this.opts.schemaId];!SFe.has(a)&&u&&(e=(0,al.resolveUrl)(this.opts.uriResolver,e,u))}let o;if(typeof r!="boolean"&&r.$ref&&!(0,Kfe.schemaHasRulesButRef)(r,this.RULES)){let a=(0,al.resolveUrl)(this.opts.uriResolver,e,r.$ref);o=mP.call(this,n,a)}let{schemaId:s}=this.opts;if(o=o||new R2({schema:r,schemaId:s,root:n,baseId:e}),o.schema!==o.root.schema)return o}});var Lfe=W((h3t,TFe)=>{TFe.exports={$id:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#",description:"Meta-schema for $data reference (JSON AnySchema extension proposal)",type:"object",required:["$data"],properties:{$data:{type:"string",anyOf:[{format:"relative-json-pointer"},{format:"json-pointer"}]}},additionalProperties:!1}});var LU=W((gP,Ffe)=>{f();(function(t,e){typeof gP=="object"&&typeof Ffe<"u"?e(gP):typeof define=="function"&&define.amd?define(["exports"],e):e(t.URI=t.URI||{})})(gP,function(t){"use strict";function e(){for(var ee=arguments.length,Z=Array(ee),oe=0;oe<ee;oe++)Z[oe]=arguments[oe];if(Z.length>1){Z[0]=Z[0].slice(0,-1);for(var ce=Z.length-1,ue=1;ue<ce;++ue)Z[ue]=Z[ue].slice(1,-1);return Z[ce]=Z[ce].slice(1),Z.join("")}else return Z[0]}function r(ee){return"(?:"+ee+")"}function n(ee){return ee===void 0?"undefined":ee===null?"null":Object.prototype.toString.call(ee).split(" ").pop().split("]").shift().toLowerCase()}function i(ee){return ee.toUpperCase()}function o(ee){return ee!=null?ee instanceof Array?ee:typeof ee.length!="number"||ee.split||ee.setInterval||ee.call?[ee]:Array.prototype.slice.call(ee):[]}function s(ee,Z){var oe=ee;if(Z)for(var ce in Z)oe[ce]=Z[ce];return oe}function a(ee){var Z="[A-Za-z]",oe="[\\x0D]",ce="[0-9]",ue="[\\x22]",$e=e(ce,"[A-Fa-f]"),Be="[\\x0A]",Ne="[\\x20]",Br=r(r("%[EFef]"+$e+"%"+$e+$e+"%"+$e+$e)+"|"+r("%[89A-Fa-f]"+$e+"%"+$e+$e)+"|"+r("%"+$e+$e)),Ft="[\\:\\/\\?\\#\\[\\]\\@]",pt="[\\!\\$\\&\\'\\(\\)\\*\\+\\,\\;\\=]",tn=e(Ft,pt),yn=ee?"[\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF]":"[]",Zr=ee?"[\\uE000-\\uF8FF]":"[]",dr=e(Z,ce,"[\\-\\.\\_\\~]",yn),rn=r(Z+e(Z,ce,"[\\+\\-\\.]")+"*"),Nr=r(r(Br+"|"+e(dr,pt,"[\\:]"))+"*"),wa=r(r("25[0-5]")+"|"+r("2[0-4]"+ce)+"|"+r("1"+ce+ce)+"|"+r("[1-9]"+ce)+"|"+ce),Ri=r(r("25[0-5]")+"|"+r("2[0-4]"+ce)+"|"+r("1"+ce+ce)+"|"+r("0?[1-9]"+ce)+"|0?0?"+ce),Vi=r(Ri+"\\."+Ri+"\\."+Ri+"\\."+Ri),Lr=r($e+"{1,4}"),Bi=r(r(Lr+"\\:"+Lr)+"|"+Vi),Hi=r(r(Lr+"\\:")+"{6}"+Bi),Eo=r("\\:\\:"+r(Lr+"\\:")+"{5}"+Bi),_a=r(r(Lr)+"?\\:\\:"+r(Lr+"\\:")+"{4}"+Bi),rs=r(r(r(Lr+"\\:")+"{0,1}"+Lr)+"?\\:\\:"+r(Lr+"\\:")+"{3}"+Bi),Rc=r(r(r(Lr+"\\:")+"{0,2}"+Lr)+"?\\:\\:"+r(Lr+"\\:")+"{2}"+Bi),sy=r(r(r(Lr+"\\:")+"{0,3}"+Lr)+"?\\:\\:"+Lr+"\\:"+Bi),ay=r(r(r(Lr+"\\:")+"{0,4}"+Lr)+"?\\:\\:"+Bi),Pl=r(r(r(Lr+"\\:")+"{0,5}"+Lr)+"?\\:\\:"+Lr),Xb=r(r(r(Lr+"\\:")+"{0,6}"+Lr)+"?\\:\\:"),ih=r([Hi,Eo,_a,rs,Rc,sy,ay,Pl,Xb].join("|")),Qb=r(r(dr+"|"+Br)+"+"),GB=r(ih+"\\%25"+Qb),U0=r(ih+r("\\%25|\\%(?!"+$e+"{2})")+Qb),p2e=r("[vV]"+$e+"+\\."+e(dr,pt,"[\\:]")+"+"),y2e=r("\\["+r(U0+"|"+ih+"|"+p2e)+"\\]"),fV=r(r(Br+"|"+e(dr,pt))+"*"),sx=r(y2e+"|"+Vi+"(?!"+fV+")|"+fV),ax=r(ce+"*"),hV=r(r(Nr+"@")+"?"+sx+r("\\:"+ax)+"?"),cx=r(Br+"|"+e(dr,pt,"[\\:\\@]")),m2e=r(cx+"*"),pV=r(cx+"+"),g2e=r(r(Br+"|"+e(dr,pt,"[\\@]"))+"+"),oh=r(r("\\/"+m2e)+"*"),ew=r("\\/"+r(pV+oh)+"?"),JB=r(g2e+oh),n8=r(pV+oh),tw="(?!"+cx+")",qit=r(oh+"|"+ew+"|"+JB+"|"+n8+"|"+tw),rw=r(r(cx+"|"+e("[\\/\\?]",Zr))+"*"),dx=r(r(cx+"|[\\/\\?]")+"*"),yV=r(r("\\/\\/"+hV+oh)+"|"+ew+"|"+n8+"|"+tw),v2e=r(rn+"\\:"+yV+r("\\?"+rw)+"?"+r("\\#"+dx)+"?"),b2e=r(r("\\/\\/"+hV+oh)+"|"+ew+"|"+JB+"|"+tw),w2e=r(b2e+r("\\?"+rw)+"?"+r("\\#"+dx)+"?"),Lit=r(v2e+"|"+w2e),Fit=r(rn+"\\:"+yV+r("\\?"+rw)+"?"),zit="^("+rn+")\\:"+r(r("\\/\\/("+r("("+Nr+")@")+"?("+sx+")"+r("\\:("+ax+")")+"?)")+"?("+oh+"|"+ew+"|"+n8+"|"+tw+")")+r("\\?("+rw+")")+"?"+r("\\#("+dx+")")+"?$",Vit="^(){0}"+r(r("\\/\\/("+r("("+Nr+")@")+"?("+sx+")"+r("\\:("+ax+")")+"?)")+"?("+oh+"|"+ew+"|"+JB+"|"+tw+")")+r("\\?("+rw+")")+"?"+r("\\#("+dx+")")+"?$",Hit="^("+rn+")\\:"+r(r("\\/\\/("+r("("+Nr+")@")+"?("+sx+")"+r("\\:("+ax+")")+"?)")+"?("+oh+"|"+ew+"|"+n8+"|"+tw+")")+r("\\?("+rw+")")+"?$",Wit="^"+r("\\#("+dx+")")+"?$",Git="^"+r("("+Nr+")@")+"?("+sx+")"+r("\\:("+ax+")")+"?$";return{NOT_SCHEME:new RegExp(e("[^]",Z,ce,"[\\+\\-\\.]"),"g"),NOT_USERINFO:new RegExp(e("[^\\%\\:]",dr,pt),"g"),NOT_HOST:new RegExp(e("[^\\%\\[\\]\\:]",dr,pt),"g"),NOT_PATH:new RegExp(e("[^\\%\\/\\:\\@]",dr,pt),"g"),NOT_PATH_NOSCHEME:new RegExp(e("[^\\%\\/\\@]",dr,pt),"g"),NOT_QUERY:new RegExp(e("[^\\%]",dr,pt,"[\\:\\@\\/\\?]",Zr),"g"),NOT_FRAGMENT:new RegExp(e("[^\\%]",dr,pt,"[\\:\\@\\/\\?]"),"g"),ESCAPE:new RegExp(e("[^]",dr,pt),"g"),UNRESERVED:new RegExp(dr,"g"),OTHER_CHARS:new RegExp(e("[^\\%]",dr,tn),"g"),PCT_ENCODED:new RegExp(Br,"g"),IPV4ADDRESS:new RegExp("^("+Vi+")$"),IPV6ADDRESS:new RegExp("^\\[?("+ih+")"+r(r("\\%25|\\%(?!"+$e+"{2})")+"("+Qb+")")+"?\\]?$")}}var d=a(!1),u=a(!0),c=function(){function ee(Z,oe){var ce=[],ue=!0,$e=!1,Be=void 0;try{for(var Ne=Z[Symbol.iterator](),Br;!(ue=(Br=Ne.next()).done)&&(ce.push(Br.value),!(oe&&ce.length===oe));ue=!0);}catch(Ft){$e=!0,Be=Ft}finally{try{!ue&&Ne.return&&Ne.return()}finally{if($e)throw Be}}return ce}return function(Z,oe){if(Array.isArray(Z))return Z;if(Symbol.iterator in Object(Z))return ee(Z,oe);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),l=function(ee){if(Array.isArray(ee)){for(var Z=0,oe=Array(ee.length);Z<ee.length;Z++)oe[Z]=ee[Z];return oe}else return Array.from(ee)},h=2147483647,y=36,g=1,v=26,x=38,S=700,A=72,T=128,$="-",j=/^xn--/,K=/[^\0-\x7E]/,F=/[\x2E\u3002\uFF0E\uFF61]/g,L={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},V=y-g,q=Math.floor,k=String.fromCharCode;function P(ee){throw new RangeError(L[ee])}function B(ee,Z){for(var oe=[],ce=ee.length;ce--;)oe[ce]=Z(ee[ce]);return oe}function p(ee,Z){var oe=ee.split("@"),ce="";oe.length>1&&(ce=oe[0]+"@",ee=oe[1]),ee=ee.replace(F,".");var ue=ee.split("."),$e=B(ue,Z).join(".");return ce+$e}function m(ee){for(var Z=[],oe=0,ce=ee.length;oe<ce;){var ue=ee.charCodeAt(oe++);if(ue>=55296&&ue<=56319&&oe<ce){var $e=ee.charCodeAt(oe++);($e&64512)==56320?Z.push(((ue&1023)<<10)+($e&1023)+65536):(Z.push(ue),oe--)}else Z.push(ue)}return Z}var w=function(Z){return String.fromCodePoint.apply(String,l(Z))},E=function(Z){return Z-48<10?Z-22:Z-65<26?Z-65:Z-97<26?Z-97:y},_=function(Z,oe){return Z+22+75*(Z<26)-((oe!=0)<<5)},b=function(Z,oe,ce){var ue=0;for(Z=ce?q(Z/S):Z>>1,Z+=q(Z/oe);Z>V*v>>1;ue+=y)Z=q(Z/V);return q(ue+(V+1)*Z/(Z+x))},C=function(Z){var oe=[],ce=Z.length,ue=0,$e=T,Be=A,Ne=Z.lastIndexOf($);Ne<0&&(Ne=0);for(var Br=0;Br<Ne;++Br)Z.charCodeAt(Br)>=128&&P("not-basic"),oe.push(Z.charCodeAt(Br));for(var Ft=Ne>0?Ne+1:0;Ft<ce;){for(var pt=ue,tn=1,yn=y;;yn+=y){Ft>=ce&&P("invalid-input");var Zr=E(Z.charCodeAt(Ft++));(Zr>=y||Zr>q((h-ue)/tn))&&P("overflow"),ue+=Zr*tn;var dr=yn<=Be?g:yn>=Be+v?v:yn-Be;if(Zr<dr)break;var rn=y-dr;tn>q(h/rn)&&P("overflow"),tn*=rn}var Nr=oe.length+1;Be=b(ue-pt,Nr,pt==0),q(ue/Nr)>h-$e&&P("overflow"),$e+=q(ue/Nr),ue%=Nr,oe.splice(ue++,0,$e)}return String.fromCodePoint.apply(String,oe)},N=function(Z){var oe=[];Z=m(Z);var ce=Z.length,ue=T,$e=0,Be=A,Ne=!0,Br=!1,Ft=void 0;try{for(var pt=Z[Symbol.iterator](),tn;!(Ne=(tn=pt.next()).done);Ne=!0){var yn=tn.value;yn<128&&oe.push(k(yn))}}catch(U0){Br=!0,Ft=U0}finally{try{!Ne&&pt.return&&pt.return()}finally{if(Br)throw Ft}}var Zr=oe.length,dr=Zr;for(Zr&&oe.push($);dr<ce;){var rn=h,Nr=!0,wa=!1,Ri=void 0;try{for(var Vi=Z[Symbol.iterator](),Lr;!(Nr=(Lr=Vi.next()).done);Nr=!0){var Bi=Lr.value;Bi>=ue&&Bi<rn&&(rn=Bi)}}catch(U0){wa=!0,Ri=U0}finally{try{!Nr&&Vi.return&&Vi.return()}finally{if(wa)throw Ri}}var Hi=dr+1;rn-ue>q((h-$e)/Hi)&&P("overflow"),$e+=(rn-ue)*Hi,ue=rn;var Eo=!0,_a=!1,rs=void 0;try{for(var Rc=Z[Symbol.iterator](),sy;!(Eo=(sy=Rc.next()).done);Eo=!0){var ay=sy.value;if(ay<ue&&++$e>h&&P("overflow"),ay==ue){for(var Pl=$e,Xb=y;;Xb+=y){var ih=Xb<=Be?g:Xb>=Be+v?v:Xb-Be;if(Pl<ih)break;var Qb=Pl-ih,GB=y-ih;oe.push(k(_(ih+Qb%GB,0))),Pl=q(Qb/GB)}oe.push(k(_(Pl,0))),Be=b($e,Hi,dr==Zr),$e=0,++dr}}}catch(U0){_a=!0,rs=U0}finally{try{!Eo&&Rc.return&&Rc.return()}finally{if(_a)throw rs}}++$e,++ue}return oe.join("")},D=function(Z){return p(Z,function(oe){return j.test(oe)?C(oe.slice(4).toLowerCase()):oe})},U=function(Z){return p(Z,function(oe){return K.test(oe)?"xn--"+N(oe):oe})},G={version:"2.1.0",ucs2:{decode:m,encode:w},decode:C,encode:N,toASCII:U,toUnicode:D},Y={};function J(ee){var Z=ee.charCodeAt(0),oe=void 0;return Z<16?oe="%0"+Z.toString(16).toUpperCase():Z<128?oe="%"+Z.toString(16).toUpperCase():Z<2048?oe="%"+(Z>>6|192).toString(16).toUpperCase()+"%"+(Z&63|128).toString(16).toUpperCase():oe="%"+(Z>>12|224).toString(16).toUpperCase()+"%"+(Z>>6&63|128).toString(16).toUpperCase()+"%"+(Z&63|128).toString(16).toUpperCase(),oe}function H(ee){for(var Z="",oe=0,ce=ee.length;oe<ce;){var ue=parseInt(ee.substr(oe+1,2),16);if(ue<128)Z+=String.fromCharCode(ue),oe+=3;else if(ue>=194&&ue<224){if(ce-oe>=6){var $e=parseInt(ee.substr(oe+4,2),16);Z+=String.fromCharCode((ue&31)<<6|$e&63)}else Z+=ee.substr(oe,6);oe+=6}else if(ue>=224){if(ce-oe>=9){var Be=parseInt(ee.substr(oe+4,2),16),Ne=parseInt(ee.substr(oe+7,2),16);Z+=String.fromCharCode((ue&15)<<12|(Be&63)<<6|Ne&63)}else Z+=ee.substr(oe,9);oe+=9}else Z+=ee.substr(oe,3),oe+=3}return Z}function X(ee,Z){function oe(ce){var ue=H(ce);return ue.match(Z.UNRESERVED)?ue:ce}return ee.scheme&&(ee.scheme=String(ee.scheme).replace(Z.PCT_ENCODED,oe).toLowerCase().replace(Z.NOT_SCHEME,"")),ee.userinfo!==void 0&&(ee.userinfo=String(ee.userinfo).replace(Z.PCT_ENCODED,oe).replace(Z.NOT_USERINFO,J).replace(Z.PCT_ENCODED,i)),ee.host!==void 0&&(ee.host=String(ee.host).replace(Z.PCT_ENCODED,oe).toLowerCase().replace(Z.NOT_HOST,J).replace(Z.PCT_ENCODED,i)),ee.path!==void 0&&(ee.path=String(ee.path).replace(Z.PCT_ENCODED,oe).replace(ee.scheme?Z.NOT_PATH:Z.NOT_PATH_NOSCHEME,J).replace(Z.PCT_ENCODED,i)),ee.query!==void 0&&(ee.query=String(ee.query).replace(Z.PCT_ENCODED,oe).replace(Z.NOT_QUERY,J).replace(Z.PCT_ENCODED,i)),ee.fragment!==void 0&&(ee.fragment=String(ee.fragment).replace(Z.PCT_ENCODED,oe).replace(Z.NOT_FRAGMENT,J).replace(Z.PCT_ENCODED,i)),ee}function te(ee){return ee.replace(/^0*(.*)/,"$1")||"0"}function ne(ee,Z){var oe=ee.match(Z.IPV4ADDRESS)||[],ce=c(oe,2),ue=ce[1];return ue?ue.split(".").map(te).join("."):ee}function Q(ee,Z){var oe=ee.match(Z.IPV6ADDRESS)||[],ce=c(oe,3),ue=ce[1],$e=ce[2];if(ue){for(var Be=ue.toLowerCase().split("::").reverse(),Ne=c(Be,2),Br=Ne[0],Ft=Ne[1],pt=Ft?Ft.split(":").map(te):[],tn=Br.split(":").map(te),yn=Z.IPV4ADDRESS.test(tn[tn.length-1]),Zr=yn?7:8,dr=tn.length-Zr,rn=Array(Zr),Nr=0;Nr<Zr;++Nr)rn[Nr]=pt[Nr]||tn[dr+Nr]||"";yn&&(rn[Zr-1]=ne(rn[Zr-1],Z));var wa=rn.reduce(function(Hi,Eo,_a){if(!Eo||Eo==="0"){var rs=Hi[Hi.length-1];rs&&rs.index+rs.length===_a?rs.length++:Hi.push({index:_a,length:1})}return Hi},[]),Ri=wa.sort(function(Hi,Eo){return Eo.length-Hi.length})[0],Vi=void 0;if(Ri&&Ri.length>1){var Lr=rn.slice(0,Ri.index),Bi=rn.slice(Ri.index+Ri.length);Vi=Lr.join(":")+"::"+Bi.join(":")}else Vi=rn.join(":");return $e&&(Vi+="%"+$e),Vi}else return ee}var re=/^(?:([^:\/?#]+):)?(?:\/\/((?:([^\/?#@]*)@)?(\[[^\/?#\]]+\]|[^\/?#:]*)(?:\:(\d*))?))?([^?#]*)(?:\?([^#]*))?(?:#((?:.|\n|\r)*))?/i,ae="".match(/(){0}/)[1]===void 0;function he(ee){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe={},ce=Z.iri!==!1?u:d;Z.reference==="suffix"&&(ee=(Z.scheme?Z.scheme+":":"")+"//"+ee);var ue=ee.match(re);if(ue){ae?(oe.scheme=ue[1],oe.userinfo=ue[3],oe.host=ue[4],oe.port=parseInt(ue[5],10),oe.path=ue[6]||"",oe.query=ue[7],oe.fragment=ue[8],isNaN(oe.port)&&(oe.port=ue[5])):(oe.scheme=ue[1]||void 0,oe.userinfo=ee.indexOf("@")!==-1?ue[3]:void 0,oe.host=ee.indexOf("//")!==-1?ue[4]:void 0,oe.port=parseInt(ue[5],10),oe.path=ue[6]||"",oe.query=ee.indexOf("?")!==-1?ue[7]:void 0,oe.fragment=ee.indexOf("#")!==-1?ue[8]:void 0,isNaN(oe.port)&&(oe.port=ee.match(/\/\/(?:.|\n)*\:(?:\/|\?|\#|$)/)?ue[4]:void 0)),oe.host&&(oe.host=Q(ne(oe.host,ce),ce)),oe.scheme===void 0&&oe.userinfo===void 0&&oe.host===void 0&&oe.port===void 0&&!oe.path&&oe.query===void 0?oe.reference="same-document":oe.scheme===void 0?oe.reference="relative":oe.fragment===void 0?oe.reference="absolute":oe.reference="uri",Z.reference&&Z.reference!=="suffix"&&Z.reference!==oe.reference&&(oe.error=oe.error||"URI is not a "+Z.reference+" reference.");var $e=Y[(Z.scheme||oe.scheme||"").toLowerCase()];if(!Z.unicodeSupport&&(!$e||!$e.unicodeSupport)){if(oe.host&&(Z.domainHost||$e&&$e.domainHost))try{oe.host=G.toASCII(oe.host.replace(ce.PCT_ENCODED,H).toLowerCase())}catch(Be){oe.error=oe.error||"Host's domain name can not be converted to ASCII via punycode: "+Be}X(oe,d)}else X(oe,ce);$e&&$e.parse&&$e.parse(oe,Z)}else oe.error=oe.error||"URI can not be parsed.";return oe}function ge(ee,Z){var oe=Z.iri!==!1?u:d,ce=[];return ee.userinfo!==void 0&&(ce.push(ee.userinfo),ce.push("@")),ee.host!==void 0&&ce.push(Q(ne(String(ee.host),oe),oe).replace(oe.IPV6ADDRESS,function(ue,$e,Be){return"["+$e+(Be?"%25"+Be:"")+"]"})),(typeof ee.port=="number"||typeof ee.port=="string")&&(ce.push(":"),ce.push(String(ee.port))),ce.length?ce.join(""):void 0}var ie=/^\.\.?\//,pe=/^\/\.(\/|$)/,be=/^\/\.\.(\/|$)/,Ue=/^\/?(?:.|\n)*?(?=\/|$)/;function ke(ee){for(var Z=[];ee.length;)if(ee.match(ie))ee=ee.replace(ie,"");else if(ee.match(pe))ee=ee.replace(pe,"/");else if(ee.match(be))ee=ee.replace(be,"/"),Z.pop();else if(ee==="."||ee==="..")ee="";else{var oe=ee.match(Ue);if(oe){var ce=oe[0];ee=ee.slice(ce.length),Z.push(ce)}else throw new Error("Unexpected dot segment condition")}return Z.join("")}function it(ee){var Z=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},oe=Z.iri?u:d,ce=[],ue=Y[(Z.scheme||ee.scheme||"").toLowerCase()];if(ue&&ue.serialize&&ue.serialize(ee,Z),ee.host&&!oe.IPV6ADDRESS.test(ee.host)){if(Z.domainHost||ue&&ue.domainHost)try{ee.host=Z.iri?G.toUnicode(ee.host):G.toASCII(ee.host.replace(oe.PCT_ENCODED,H).toLowerCase())}catch(Ne){ee.error=ee.error||"Host's domain name can not be converted to "+(Z.iri?"Unicode":"ASCII")+" via punycode: "+Ne}}X(ee,oe),Z.reference!=="suffix"&&ee.scheme&&(ce.push(ee.scheme),ce.push(":"));var $e=ge(ee,Z);if($e!==void 0&&(Z.reference!=="suffix"&&ce.push("//"),ce.push($e),ee.path&&ee.path.charAt(0)!=="/"&&ce.push("/")),ee.path!==void 0){var Be=ee.path;!Z.absolutePath&&(!ue||!ue.absolutePath)&&(Be=ke(Be)),$e===void 0&&(Be=Be.replace(/^\/\//,"/%2F")),ce.push(Be)}return ee.query!==void 0&&(ce.push("?"),ce.push(ee.query)),ee.fragment!==void 0&&(ce.push("#"),ce.push(ee.fragment)),ce.join("")}function St(ee,Z){var oe=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{},ce=arguments[3],ue={};return ce||(ee=he(it(ee,oe),oe),Z=he(it(Z,oe),oe)),oe=oe||{},!oe.tolerant&&Z.scheme?(ue.scheme=Z.scheme,ue.userinfo=Z.userinfo,ue.host=Z.host,ue.port=Z.port,ue.path=ke(Z.path||""),ue.query=Z.query):(Z.userinfo!==void 0||Z.host!==void 0||Z.port!==void 0?(ue.userinfo=Z.userinfo,ue.host=Z.host,ue.port=Z.port,ue.path=ke(Z.path||""),ue.query=Z.query):(Z.path?(Z.path.charAt(0)==="/"?ue.path=ke(Z.path):((ee.userinfo!==void 0||ee.host!==void 0||ee.port!==void 0)&&!ee.path?ue.path="/"+Z.path:ee.path?ue.path=ee.path.slice(0,ee.path.lastIndexOf("/")+1)+Z.path:ue.path=Z.path,ue.path=ke(ue.path)),ue.query=Z.query):(ue.path=ee.path,Z.query!==void 0?ue.query=Z.query:ue.query=ee.query),ue.userinfo=ee.userinfo,ue.host=ee.host,ue.port=ee.port),ue.scheme=ee.scheme),ue.fragment=Z.fragment,ue}function Fe(ee,Z,oe){var ce=s({scheme:"null"},oe);return it(St(he(ee,ce),he(Z,ce),ce,!0),ce)}function mt(ee,Z){return typeof ee=="string"?ee=it(he(ee,Z),Z):n(ee)==="object"&&(ee=he(it(ee,Z),Z)),ee}function In(ee,Z,oe){return typeof ee=="string"?ee=it(he(ee,oe),oe):n(ee)==="object"&&(ee=it(ee,oe)),typeof Z=="string"?Z=it(he(Z,oe),oe):n(Z)==="object"&&(Z=it(Z,oe)),ee===Z}function Pe(ee,Z){return ee&&ee.toString().replace(!Z||!Z.iri?d.ESCAPE:u.ESCAPE,J)}function Te(ee,Z){return ee&&ee.toString().replace(!Z||!Z.iri?d.PCT_ENCODED:u.PCT_ENCODED,H)}var Wt={scheme:"http",domainHost:!0,parse:function(Z,oe){return Z.host||(Z.error=Z.error||"HTTP URIs must have a host."),Z},serialize:function(Z,oe){var ce=String(Z.scheme).toLowerCase()==="https";return(Z.port===(ce?443:80)||Z.port==="")&&(Z.port=void 0),Z.path||(Z.path="/"),Z}},Re={scheme:"https",domainHost:Wt.domainHost,parse:Wt.parse,serialize:Wt.serialize};function xe(ee){return typeof ee.secure=="boolean"?ee.secure:String(ee.scheme).toLowerCase()==="wss"}var qr={scheme:"ws",domainHost:!0,parse:function(Z,oe){var ce=Z;return ce.secure=xe(ce),ce.resourceName=(ce.path||"/")+(ce.query?"?"+ce.query:""),ce.path=void 0,ce.query=void 0,ce},serialize:function(Z,oe){if((Z.port===(xe(Z)?443:80)||Z.port==="")&&(Z.port=void 0),typeof Z.secure=="boolean"&&(Z.scheme=Z.secure?"wss":"ws",Z.secure=void 0),Z.resourceName){var ce=Z.resourceName.split("?"),ue=c(ce,2),$e=ue[0],Be=ue[1];Z.path=$e&&$e!=="/"?$e:void 0,Z.query=Be,Z.resourceName=void 0}return Z.fragment=void 0,Z}},We={scheme:"wss",domainHost:qr.domainHost,parse:qr.parse,serialize:qr.serialize},Ye={},an=!0,Bt="[A-Za-z0-9\\-\\.\\_\\~"+(an?"\\xA0-\\u200D\\u2010-\\u2029\\u202F-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFEF":"")+"]",Ze="[0-9A-Fa-f]",xd=r(r("%[EFef]"+Ze+"%"+Ze+Ze+"%"+Ze+Ze)+"|"+r("%[89A-Fa-f]"+Ze+"%"+Ze+Ze)+"|"+r("%"+Ze+Ze)),Ot="[A-Za-z0-9\\!\\$\\%\\'\\*\\+\\-\\^\\_\\`\\{\\|\\}\\~]",qt="[\\!\\$\\%\\'\\(\\)\\*\\+\\,\\-\\.0-9\\<\\>A-Z\\x5E-\\x7E]",j0=e(qt,'[\\"\\\\]'),Nt="[\\!\\$\\'\\(\\)\\*\\+\\,\\;\\:\\@]",Xt=new RegExp(Bt,"g"),Ed=new RegExp(xd,"g"),Qt=new RegExp(e("[^]",Ot,"[\\.]",'[\\"]',j0),"g"),Gt=new RegExp(e("[^]",Bt,Nt),"g"),$0=Gt;function Lt(ee){var Z=H(ee);return Z.match(Xt)?Z:ee}var Jt={scheme:"mailto",parse:function(Z,oe){var ce=Z,ue=ce.to=ce.path?ce.path.split(","):[];if(ce.path=void 0,ce.query){for(var $e=!1,Be={},Ne=ce.query.split("&"),Br=0,Ft=Ne.length;Br<Ft;++Br){var pt=Ne[Br].split("=");switch(pt[0]){case"to":for(var tn=pt[1].split(","),yn=0,Zr=tn.length;yn<Zr;++yn)ue.push(tn[yn]);break;case"subject":ce.subject=Te(pt[1],oe);break;case"body":ce.body=Te(pt[1],oe);break;default:$e=!0,Be[Te(pt[0],oe)]=Te(pt[1],oe);break}}$e&&(ce.headers=Be)}ce.query=void 0;for(var dr=0,rn=ue.length;dr<rn;++dr){var Nr=ue[dr].split("@");if(Nr[0]=Te(Nr[0]),oe.unicodeSupport)Nr[1]=Te(Nr[1],oe).toLowerCase();else try{Nr[1]=G.toASCII(Te(Nr[1],oe).toLowerCase())}catch(wa){ce.error=ce.error||"Email address's domain name can not be converted to ASCII via punycode: "+wa}ue[dr]=Nr.join("@")}return ce},serialize:function(Z,oe){var ce=Z,ue=o(Z.to);if(ue){for(var $e=0,Be=ue.length;$e<Be;++$e){var Ne=String(ue[$e]),Br=Ne.lastIndexOf("@"),Ft=Ne.slice(0,Br).replace(Ed,Lt).replace(Ed,i).replace(Qt,J),pt=Ne.slice(Br+1);try{pt=oe.iri?G.toUnicode(pt):G.toASCII(Te(pt,oe).toLowerCase())}catch(dr){ce.error=ce.error||"Email address's domain name can not be converted to "+(oe.iri?"Unicode":"ASCII")+" via punycode: "+dr}ue[$e]=Ft+"@"+pt}ce.path=ue.join(",")}var tn=Z.headers=Z.headers||{};Z.subject&&(tn.subject=Z.subject),Z.body&&(tn.body=Z.body);var yn=[];for(var Zr in tn)tn[Zr]!==Ye[Zr]&&yn.push(Zr.replace(Ed,Lt).replace(Ed,i).replace(Gt,J)+"="+tn[Zr].replace(Ed,Lt).replace(Ed,i).replace($0,J));return yn.length&&(ce.query=yn.join("&")),ce}},N0=/^([^\:]+)\:(.*)/,Yt={scheme:"urn",parse:function(Z,oe){var ce=Z.path&&Z.path.match(N0),ue=Z;if(ce){var $e=oe.scheme||ue.scheme||"urn",Be=ce[1].toLowerCase(),Ne=ce[2],Br=$e+":"+(oe.nid||Be),Ft=Y[Br];ue.nid=Be,ue.nss=Ne,ue.path=void 0,Ft&&(ue=Ft.parse(ue,oe))}else ue.error=ue.error||"URN can not be parsed.";return ue},serialize:function(Z,oe){var ce=oe.scheme||Z.scheme||"urn",ue=Z.nid,$e=ce+":"+(oe.nid||ue),Be=Y[$e];Be&&(Z=Be.serialize(Z,oe));var Ne=Z,Br=Z.nss;return Ne.path=(ue||oe.nid)+":"+Br,Ne}},er=/^[0-9A-Fa-f]{8}(?:\-[0-9A-Fa-f]{4}){3}\-[0-9A-Fa-f]{12}$/,oy={scheme:"urn:uuid",parse:function(Z,oe){var ce=Z;return ce.uuid=ce.nss,ce.nss=void 0,!oe.tolerant&&(!ce.uuid||!ce.uuid.match(er))&&(ce.error=ce.error||"UUID is not valid."),ce},serialize:function(Z,oe){var ce=Z;return ce.nss=(Z.uuid||"").toLowerCase(),ce}};Y[Wt.scheme]=Wt,Y[Re.scheme]=Re,Y[qr.scheme]=qr,Y[We.scheme]=We,Y[Jt.scheme]=Jt,Y[Yt.scheme]=Yt,Y[oy.scheme]=oy,t.SCHEMES=Y,t.pctEncChar=J,t.pctDecChars=H,t.parse=he,t.removeDotSegments=ke,t.serialize=it,t.resolveComponents=St,t.resolve=Fe,t.normalize=mt,t.equal=In,t.escapeComponent=Pe,t.unescapeComponent=Te,Object.defineProperty(t,"__esModule",{value:!0})})});var Vfe=W(FU=>{"use strict";f();Object.defineProperty(FU,"__esModule",{value:!0});var zfe=LU();zfe.code='require("ajv/dist/runtime/uri").default';FU.default=zfe});var Qfe=W(ks=>{"use strict";f();Object.defineProperty(ks,"__esModule",{value:!0});ks.CodeGen=ks.Name=ks.nil=ks.stringify=ks.str=ks._=ks.KeywordCxt=void 0;var AFe=AS();Object.defineProperty(ks,"KeywordCxt",{enumerable:!0,get:function(){return AFe.KeywordCxt}});var B2=ir();Object.defineProperty(ks,"_",{enumerable:!0,get:function(){return B2._}});Object.defineProperty(ks,"str",{enumerable:!0,get:function(){return B2.str}});Object.defineProperty(ks,"stringify",{enumerable:!0,get:function(){return B2.stringify}});Object.defineProperty(ks,"nil",{enumerable:!0,get:function(){return B2.nil}});Object.defineProperty(ks,"Name",{enumerable:!0,get:function(){return B2.Name}});Object.defineProperty(ks,"CodeGen",{enumerable:!0,get:function(){return B2.CodeGen}});var kFe=pP(),Yfe=yP(),PFe=xU(),PS=kS(),IFe=ir(),IS=ES(),vP=xS(),VU=Cr(),Hfe=Lfe(),RFe=Vfe(),Zfe=(t,e)=>new RegExp(t,e);Zfe.code="new RegExp";var BFe=["removeAdditional","useDefaults","coerceTypes"],OFe=new Set(["validate","serialize","parse","wrapper","root","schema","keyword","pattern","formats","validate$data","func","obj","Error"]),MFe={errorDataPath:"",format:"`validateFormats: false` can be used instead.",nullable:'"nullable" keyword is supported by default.',jsonPointers:"Deprecated jsPropertySyntax can be used instead.",extendRefs:"Deprecated ignoreKeywordsWithRef can be used instead.",missingRefs:"Pass empty schema with $id that should be ignored to ajv.addSchema.",processCode:"Use option `code: {process: (code, schemaEnv: object) => string}`",sourceCode:"Use option `code: {source: true}`",strictDefaults:"It is default now, see option `strict`.",strictKeywords:"It is default now, see option `strict`.",uniqueItems:'"uniqueItems" keyword is always validated.',unknownFormats:"Disable strict mode or pass `true` to `ajv.addFormat` (or `formats` option).",cache:"Map is used as cache, schema object as key.",serialize:"Map is used as cache, schema object as key.",ajvErrors:"It is default now."},DFe={ignoreKeywordsWithRef:"",jsPropertySyntax:"",unicode:'"minLength"/"maxLength" account for unicode characters by default.'},Wfe=200;function CFe(t){var e,r,n,i,o,s,a,d,u,c,l,h,y,g,v,x,S,A,T,$,j,K,F,L,V;let q=t.strict,k=(e=t.code)===null||e===void 0?void 0:e.optimize,P=k===!0||k===void 0?1:k||0,B=(n=(r=t.code)===null||r===void 0?void 0:r.regExp)!==null&&n!==void 0?n:Zfe,p=(i=t.uriResolver)!==null&&i!==void 0?i:RFe.default;return{strictSchema:(s=(o=t.strictSchema)!==null&&o!==void 0?o:q)!==null&&s!==void 0?s:!0,strictNumbers:(d=(a=t.strictNumbers)!==null&&a!==void 0?a:q)!==null&&d!==void 0?d:!0,strictTypes:(c=(u=t.strictTypes)!==null&&u!==void 0?u:q)!==null&&c!==void 0?c:"log",strictTuples:(h=(l=t.strictTuples)!==null&&l!==void 0?l:q)!==null&&h!==void 0?h:"log",strictRequired:(g=(y=t.strictRequired)!==null&&y!==void 0?y:q)!==null&&g!==void 0?g:!1,code:t.code?{...t.code,optimize:P,regExp:B}:{optimize:P,regExp:B},loopRequired:(v=t.loopRequired)!==null&&v!==void 0?v:Wfe,loopEnum:(x=t.loopEnum)!==null&&x!==void 0?x:Wfe,meta:(S=t.meta)!==null&&S!==void 0?S:!0,messages:(A=t.messages)!==null&&A!==void 0?A:!0,inlineRefs:(T=t.inlineRefs)!==null&&T!==void 0?T:!0,schemaId:($=t.schemaId)!==null&&$!==void 0?$:"$id",addUsedSchema:(j=t.addUsedSchema)!==null&&j!==void 0?j:!0,validateSchema:(K=t.validateSchema)!==null&&K!==void 0?K:!0,validateFormats:(F=t.validateFormats)!==null&&F!==void 0?F:!0,unicodeRegExp:(L=t.unicodeRegExp)!==null&&L!==void 0?L:!0,int32range:(V=t.int32range)!==null&&V!==void 0?V:!0,uriResolver:p}}var RS=class{constructor(e={}){this.schemas={},this.refs={},this.formats={},this._compilations=new Set,this._loading={},this._cache=new Map,e=this.opts={...e,...CFe(e)};let{es5:r,lines:n}=this.opts.code;this.scope=new IFe.ValueScope({scope:{},prefixes:OFe,es5:r,lines:n}),this.logger=qFe(e.logger);let i=e.validateFormats;e.validateFormats=!1,this.RULES=(0,PFe.getRules)(),Gfe.call(this,MFe,e,"NOT SUPPORTED"),Gfe.call(this,DFe,e,"DEPRECATED","warn"),this._metaOpts=UFe.call(this),e.formats&&$Fe.call(this),this._addVocabularies(),this._addDefaultMetaSchema(),e.keywords&&NFe.call(this,e.keywords),typeof e.meta=="object"&&this.addMetaSchema(e.meta),jFe.call(this),e.validateFormats=i}_addVocabularies(){this.addKeyword("$async")}_addDefaultMetaSchema(){let{$data:e,meta:r,schemaId:n}=this.opts,i=Hfe;n==="id"&&(i={...Hfe},i.id=i.$id,delete i.$id),r&&e&&this.addMetaSchema(i,i[n],!1)}defaultMeta(){let{meta:e,schemaId:r}=this.opts;return this.opts.defaultMeta=typeof e=="object"?e[r]||e:void 0}validate(e,r){let n;if(typeof e=="string"){if(n=this.getSchema(e),!n)throw new Error(`no schema with key or ref "${e}"`)}else n=this.compile(e);let i=n(r);return"$async"in n||(this.errors=n.errors),i}compile(e,r){let n=this._addSchema(e,r);return n.validate||this._compileSchemaEnv(n)}compileAsync(e,r){if(typeof this.opts.loadSchema!="function")throw new Error("options.loadSchema should be a function");let{loadSchema:n}=this.opts;return i.call(this,e,r);async function i(c,l){await o.call(this,c.$schema);let h=this._addSchema(c,l);return h.validate||s.call(this,h)}async function o(c){c&&!this.getSchema(c)&&await i.call(this,{$ref:c},!0)}async function s(c){try{return this._compileSchemaEnv(c)}catch(l){if(!(l instanceof Yfe.default))throw l;return a.call(this,l),await d.call(this,l.missingSchema),s.call(this,c)}}function a({missingSchema:c,missingRef:l}){if(this.refs[c])throw new Error(`AnySchema ${c} is loaded but ${l} cannot be resolved`)}async function d(c){let l=await u.call(this,c);this.refs[c]||await o.call(this,l.$schema),this.refs[c]||this.addSchema(l,c,r)}async function u(c){let l=this._loading[c];if(l)return l;try{return await(this._loading[c]=n(c))}finally{delete this._loading[c]}}}addSchema(e,r,n,i=this.opts.validateSchema){if(Array.isArray(e)){for(let s of e)this.addSchema(s,void 0,n,i);return this}let o;if(typeof e=="object"){let{schemaId:s}=this.opts;if(o=e[s],o!==void 0&&typeof o!="string")throw new Error(`schema ${s} must be string`)}return r=(0,IS.normalizeId)(r||o),this._checkUnique(r),this.schemas[r]=this._addSchema(e,n,r,i,!0),this}addMetaSchema(e,r,n=this.opts.validateSchema){return this.addSchema(e,r,!0,n),this}validateSchema(e,r){if(typeof e=="boolean")return!0;let n;if(n=e.$schema,n!==void 0&&typeof n!="string")throw new Error("$schema must be a string");if(n=n||this.opts.defaultMeta||this.defaultMeta(),!n)return this.logger.warn("meta-schema not available"),this.errors=null,!0;let i=this.validate(n,e);if(!i&&r){let o="schema is invalid: "+this.errorsText();if(this.opts.validateSchema==="log")this.logger.error(o);else throw new Error(o)}return i}getSchema(e){let r;for(;typeof(r=Jfe.call(this,e))=="string";)e=r;if(r===void 0){let{schemaId:n}=this.opts,i=new PS.SchemaEnv({schema:{},schemaId:n});if(r=PS.resolveSchema.call(this,i,e),!r)return;this.refs[e]=r}return r.validate||this._compileSchemaEnv(r)}removeSchema(e){if(e instanceof RegExp)return this._removeAllSchemas(this.schemas,e),this._removeAllSchemas(this.refs,e),this;switch(typeof e){case"undefined":return this._removeAllSchemas(this.schemas),this._removeAllSchemas(this.refs),this._cache.clear(),this;case"string":{let r=Jfe.call(this,e);return typeof r=="object"&&this._cache.delete(r.schema),delete this.schemas[e],delete this.refs[e],this}case"object":{let r=e;this._cache.delete(r);let n=e[this.opts.schemaId];return n&&(n=(0,IS.normalizeId)(n),delete this.schemas[n],delete this.refs[n]),this}default:throw new Error("ajv.removeSchema: invalid parameter")}}addVocabulary(e){for(let r of e)this.addKeyword(r);return this}addKeyword(e,r){let n;if(typeof e=="string")n=e,typeof r=="object"&&(this.logger.warn("these parameters are deprecated, see docs for addKeyword"),r.keyword=n);else if(typeof e=="object"&&r===void 0){if(r=e,n=r.keyword,Array.isArray(n)&&!n.length)throw new Error("addKeywords: keyword must be string or non-empty array")}else throw new Error("invalid addKeywords parameters");if(FFe.call(this,n,r),!r)return(0,VU.eachItem)(n,o=>zU.call(this,o)),this;VFe.call(this,r);let i={...r,type:(0,vP.getJSONTypes)(r.type),schemaType:(0,vP.getJSONTypes)(r.schemaType)};return(0,VU.eachItem)(n,i.type.length===0?o=>zU.call(this,o,i):o=>i.type.forEach(s=>zU.call(this,o,i,s))),this}getKeyword(e){let r=this.RULES.all[e];return typeof r=="object"?r.definition:!!r}removeKeyword(e){let{RULES:r}=this;delete r.keywords[e],delete r.all[e];for(let n of r.rules){let i=n.rules.findIndex(o=>o.keyword===e);i>=0&&n.rules.splice(i,1)}return this}addFormat(e,r){return typeof r=="string"&&(r=new RegExp(r)),this.formats[e]=r,this}errorsText(e=this.errors,{separator:r=", ",dataVar:n="data"}={}){return!e||e.length===0?"No errors":e.map(i=>`${n}${i.instancePath} ${i.message}`).reduce((i,o)=>i+r+o)}$dataMetaSchema(e,r){let n=this.RULES.all;e=JSON.parse(JSON.stringify(e));for(let i of r){let o=i.split("/").slice(1),s=e;for(let a of o)s=s[a];for(let a in n){let d=n[a];if(typeof d!="object")continue;let{$data:u}=d.definition,c=s[a];u&&c&&(s[a]=Xfe(c))}}return e}_removeAllSchemas(e,r){for(let n in e){let i=e[n];(!r||r.test(n))&&(typeof i=="string"?delete e[n]:i&&!i.meta&&(this._cache.delete(i.schema),delete e[n]))}}_addSchema(e,r,n,i=this.opts.validateSchema,o=this.opts.addUsedSchema){let s,{schemaId:a}=this.opts;if(typeof e=="object")s=e[a];else{if(this.opts.jtd)throw new Error("schema must be object");if(typeof e!="boolean")throw new Error("schema must be object or boolean")}let d=this._cache.get(e);if(d!==void 0)return d;n=(0,IS.normalizeId)(s||n);let u=IS.getSchemaRefs.call(this,e,n);return d=new PS.SchemaEnv({schema:e,schemaId:a,meta:r,baseId:n,localRefs:u}),this._cache.set(d.schema,d),o&&!n.startsWith("#")&&(n&&this._checkUnique(n),this.refs[n]=d),i&&this.validateSchema(e,!0),d}_checkUnique(e){if(this.schemas[e]||this.refs[e])throw new Error(`schema with key or id "${e}" already exists`)}_compileSchemaEnv(e){if(e.meta?this._compileMetaSchema(e):PS.compileSchema.call(this,e),!e.validate)throw new Error("ajv implementation error");return e.validate}_compileMetaSchema(e){let r=this.opts;this.opts=this._metaOpts;try{PS.compileSchema.call(this,e)}finally{this.opts=r}}};ks.default=RS;RS.ValidationError=kFe.default;RS.MissingRefError=Yfe.default;function Gfe(t,e,r,n="error"){for(let i in t){let o=i;o in e&&this.logger[n](`${r}: option ${i}. ${t[o]}`)}}function Jfe(t){return t=(0,IS.normalizeId)(t),this.schemas[t]||this.refs[t]}function jFe(){let t=this.opts.schemas;if(t)if(Array.isArray(t))this.addSchema(t);else for(let e in t)this.addSchema(t[e],e)}function $Fe(){for(let t in this.opts.formats){let e=this.opts.formats[t];e&&this.addFormat(t,e)}}function NFe(t){if(Array.isArray(t)){this.addVocabulary(t);return}this.logger.warn("keywords option as map is deprecated, pass array");for(let e in t){let r=t[e];r.keyword||(r.keyword=e),this.addKeyword(r)}}function UFe(){let t={...this.opts};for(let e of BFe)delete t[e];return t}var KFe={log(){},warn(){},error(){}};function qFe(t){if(t===!1)return KFe;if(t===void 0)return console;if(t.log&&t.warn&&t.error)return t;throw new Error("logger must implement log, warn and error methods")}var LFe=/^[a-z_$][a-z0-9_$:-]*$/i;function FFe(t,e){let{RULES:r}=this;if((0,VU.eachItem)(t,n=>{if(r.keywords[n])throw new Error(`Keyword ${n} is already defined`);if(!LFe.test(n))throw new Error(`Keyword ${n} has invalid name`)}),!!e&&e.$data&&!("code"in e||"validate"in e))throw new Error('$data keyword must have "code" or "validate" function')}function zU(t,e,r){var n;let i=e?.post;if(r&&i)throw new Error('keyword with "post" flag cannot have "type"');let{RULES:o}=this,s=i?o.post:o.rules.find(({type:d})=>d===r);if(s||(s={type:r,rules:[]},o.rules.push(s)),o.keywords[t]=!0,!e)return;let a={keyword:t,definition:{...e,type:(0,vP.getJSONTypes)(e.type),schemaType:(0,vP.getJSONTypes)(e.schemaType)}};e.before?zFe.call(this,s,a,e.before):s.rules.push(a),o.all[t]=a,(n=e.implements)===null||n===void 0||n.forEach(d=>this.addKeyword(d))}function zFe(t,e,r){let n=t.rules.findIndex(i=>i.keyword===r);n>=0?t.rules.splice(n,0,e):(t.rules.push(e),this.logger.warn(`rule ${r} is not defined`))}function VFe(t){let{metaSchema:e}=t;e!==void 0&&(t.$data&&this.opts.$data&&(e=Xfe(e)),t.validateSchema=this.compile(e,!0))}var HFe={$ref:"https://raw.githubusercontent.com/ajv-validator/ajv/master/lib/refs/data.json#"};function Xfe(t){return{anyOf:[t,HFe]}}});var ehe=W(HU=>{"use strict";f();Object.defineProperty(HU,"__esModule",{value:!0});var WFe={keyword:"id",code(){throw new Error('NOT SUPPORTED: keyword "id", use "$id" for schema ID')}};HU.default=WFe});var _P=W(Nv=>{"use strict";f();Object.defineProperty(Nv,"__esModule",{value:!0});Nv.callRef=Nv.getValidate=void 0;var GFe=yP(),the=Xd(),gc=ir(),O2=Zd(),rhe=kS(),bP=Cr(),JFe={keyword:"$ref",schemaType:"string",code(t){let{gen:e,schema:r,it:n}=t,{baseId:i,schemaEnv:o,validateName:s,opts:a,self:d}=n,{root:u}=o;if((r==="#"||r==="#/")&&i===u.baseId)return l();let c=rhe.resolveRef.call(d,u,i,r);if(c===void 0)throw new GFe.default(n.opts.uriResolver,i,r);if(c instanceof rhe.SchemaEnv)return h(c);return y(c);function l(){if(o===u)return wP(t,s,o,o.$async);let g=e.scopeValue("root",{ref:u});return wP(t,(0,gc._)`${g}.validate`,u,u.$async)}function h(g){let v=nhe(t,g);wP(t,v,g,g.$async)}function y(g){let v=e.scopeValue("schema",a.code.source===!0?{ref:g,code:(0,gc.stringify)(g)}:{ref:g}),x=e.name("valid"),S=t.subschema({schema:g,dataTypes:[],schemaPath:gc.nil,topSchemaRef:v,errSchemaPath:r},x);t.mergeEvaluated(S),t.ok(x)}}};function nhe(t,e){let{gen:r}=t;return e.validate?r.scopeValue("validate",{ref:e.validate}):(0,gc._)`${r.scopeValue("wrapper",{ref:e})}.validate`}Nv.getValidate=nhe;function wP(t,e,r,n){let{gen:i,it:o}=t,{allErrors:s,schemaEnv:a,opts:d}=o,u=d.passContext?O2.default.this:gc.nil;n?c():l();function c(){if(!a.$async)throw new Error("async schema referenced by sync schema");let g=i.let("valid");i.try(()=>{i.code((0,gc._)`await ${(0,the.callValidateCode)(t,e,u)}`),y(e),s||i.assign(g,!0)},v=>{i.if((0,gc._)`!(${v} instanceof ${o.ValidationError})`,()=>i.throw(v)),h(v),s||i.assign(g,!1)}),t.ok(g)}function l(){t.result((0,the.callValidateCode)(t,e,u),()=>y(e),()=>h(e))}function h(g){let v=(0,gc._)`${g}.errors`;i.assign(O2.default.vErrors,(0,gc._)`${O2.default.vErrors} === null ? ${v} : ${O2.default.vErrors}.concat(${v})`),i.assign(O2.default.errors,(0,gc._)`${O2.default.vErrors}.length`)}function y(g){var v;if(!o.opts.unevaluated)return;let x=(v=r?.validate)===null||v===void 0?void 0:v.evaluated;if(o.props!==!0)if(x&&!x.dynamicProps)x.props!==void 0&&(o.props=bP.mergeEvaluated.props(i,x.props,o.props));else{let S=i.var("props",(0,gc._)`${g}.evaluated.props`);o.props=bP.mergeEvaluated.props(i,S,o.props,gc.Name)}if(o.items!==!0)if(x&&!x.dynamicItems)x.items!==void 0&&(o.items=bP.mergeEvaluated.items(i,x.items,o.items));else{let S=i.var("items",(0,gc._)`${g}.evaluated.items`);o.items=bP.mergeEvaluated.items(i,S,o.items,gc.Name)}}}Nv.callRef=wP;Nv.default=JFe});var ihe=W(WU=>{"use strict";f();Object.defineProperty(WU,"__esModule",{value:!0});var YFe=ehe(),ZFe=_P(),XFe=["$schema","$id","$defs","$vocabulary",{keyword:"$comment"},"definitions",YFe.default,ZFe.default];WU.default=XFe});var ohe=W(GU=>{"use strict";f();Object.defineProperty(GU,"__esModule",{value:!0});var xP=ir(),Dm=xP.operators,EP={maximum:{okStr:"<=",ok:Dm.LTE,fail:Dm.GT},minimum:{okStr:">=",ok:Dm.GTE,fail:Dm.LT},exclusiveMaximum:{okStr:"<",ok:Dm.LT,fail:Dm.GTE},exclusiveMinimum:{okStr:">",ok:Dm.GT,fail:Dm.LTE}},QFe={message:({keyword:t,schemaCode:e})=>(0,xP.str)`must be ${EP[t].okStr} ${e}`,params:({keyword:t,schemaCode:e})=>(0,xP._)`{comparison: ${EP[t].okStr}, limit: ${e}}`},eze={keyword:Object.keys(EP),type:"number",schemaType:"number",$data:!0,error:QFe,code(t){let{keyword:e,data:r,schemaCode:n}=t;t.fail$data((0,xP._)`${r} ${EP[e].fail} ${n} || isNaN(${r})`)}};GU.default=eze});var she=W(JU=>{"use strict";f();Object.defineProperty(JU,"__esModule",{value:!0});var BS=ir(),tze={message:({schemaCode:t})=>(0,BS.str)`must be multiple of ${t}`,params:({schemaCode:t})=>(0,BS._)`{multipleOf: ${t}}`},rze={keyword:"multipleOf",type:"number",schemaType:"number",$data:!0,error:tze,code(t){let{gen:e,data:r,schemaCode:n,it:i}=t,o=i.opts.multipleOfPrecision,s=e.let("res"),a=o?(0,BS._)`Math.abs(Math.round(${s}) - ${s}) > 1e-${o}`:(0,BS._)`${s} !== parseInt(${s})`;t.fail$data((0,BS._)`(${n} === 0 || (${s} = ${r}/${n}, ${a}))`)}};JU.default=rze});var che=W(YU=>{"use strict";f();Object.defineProperty(YU,"__esModule",{value:!0});function ahe(t){let e=t.length,r=0,n=0,i;for(;n<e;)r++,i=t.charCodeAt(n++),i>=55296&&i<=56319&&n<e&&(i=t.charCodeAt(n),(i&64512)===56320&&n++);return r}YU.default=ahe;ahe.code='require("ajv/dist/runtime/ucs2length").default'});var dhe=W(ZU=>{"use strict";f();Object.defineProperty(ZU,"__esModule",{value:!0});var Uv=ir(),nze=Cr(),ize=che(),oze={message({keyword:t,schemaCode:e}){let r=t==="maxLength"?"more":"fewer";return(0,Uv.str)`must NOT have ${r} than ${e} characters`},params:({schemaCode:t})=>(0,Uv._)`{limit: ${t}}`},sze={keyword:["maxLength","minLength"],type:"string",schemaType:"number",$data:!0,error:oze,code(t){let{keyword:e,data:r,schemaCode:n,it:i}=t,o=e==="maxLength"?Uv.operators.GT:Uv.operators.LT,s=i.opts.unicode===!1?(0,Uv._)`${r}.length`:(0,Uv._)`${(0,nze.useFunc)(t.gen,ize.default)}(${r})`;t.fail$data((0,Uv._)`${s} ${o} ${n}`)}};ZU.default=sze});var uhe=W(XU=>{"use strict";f();Object.defineProperty(XU,"__esModule",{value:!0});var aze=Xd(),SP=ir(),cze={message:({schemaCode:t})=>(0,SP.str)`must match pattern "${t}"`,params:({schemaCode:t})=>(0,SP._)`{pattern: ${t}}`},dze={keyword:"pattern",type:"string",schemaType:"string",$data:!0,error:cze,code(t){let{data:e,$data:r,schema:n,schemaCode:i,it:o}=t,s=o.opts.unicodeRegExp?"u":"",a=r?(0,SP._)`(new RegExp(${i}, ${s}))`:(0,aze.usePattern)(t,n);t.fail$data((0,SP._)`!${a}.test(${e})`)}};XU.default=dze});var lhe=W(QU=>{"use strict";f();Object.defineProperty(QU,"__esModule",{value:!0});var OS=ir(),uze={message({keyword:t,schemaCode:e}){let r=t==="maxProperties"?"more":"fewer";return(0,OS.str)`must NOT have ${r} than ${e} properties`},params:({schemaCode:t})=>(0,OS._)`{limit: ${t}}`},lze={keyword:["maxProperties","minProperties"],type:"object",schemaType:"number",$data:!0,error:uze,code(t){let{keyword:e,data:r,schemaCode:n}=t,i=e==="maxProperties"?OS.operators.GT:OS.operators.LT;t.fail$data((0,OS._)`Object.keys(${r}).length ${i} ${n}`)}};QU.default=lze});var fhe=W(eK=>{"use strict";f();Object.defineProperty(eK,"__esModule",{value:!0});var MS=Xd(),DS=ir(),fze=Cr(),hze={message:({params:{missingProperty:t}})=>(0,DS.str)`must have required property '${t}'`,params:({params:{missingProperty:t}})=>(0,DS._)`{missingProperty: ${t}}`},pze={keyword:"required",type:"object",schemaType:"array",$data:!0,error:hze,code(t){let{gen:e,schema:r,schemaCode:n,data:i,$data:o,it:s}=t,{opts:a}=s;if(!o&&r.length===0)return;let d=r.length>=a.loopRequired;if(s.allErrors?u():c(),a.strictRequired){let y=t.parentSchema.properties,{definedProperties:g}=t.it;for(let v of r)if(y?.[v]===void 0&&!g.has(v)){let x=s.schemaEnv.baseId+s.errSchemaPath,S=`required property "${v}" is not defined at "${x}" (strictRequired)`;(0,fze.checkStrictMode)(s,S,s.opts.strictRequired)}}function u(){if(d||o)t.block$data(DS.nil,l);else for(let y of r)(0,MS.checkReportMissingProp)(t,y)}function c(){let y=e.let("missing");if(d||o){let g=e.let("valid",!0);t.block$data(g,()=>h(y,g)),t.ok(g)}else e.if((0,MS.checkMissingProp)(t,r,y)),(0,MS.reportMissingProp)(t,y),e.else()}function l(){e.forOf("prop",n,y=>{t.setParams({missingProperty:y}),e.if((0,MS.noPropertyInData)(e,i,y,a.ownProperties),()=>t.error())})}function h(y,g){t.setParams({missingProperty:y}),e.forOf(y,n,()=>{e.assign(g,(0,MS.propertyInData)(e,i,y,a.ownProperties)),e.if((0,DS.not)(g),()=>{t.error(),e.break()})},DS.nil)}}};eK.default=pze});var hhe=W(tK=>{"use strict";f();Object.defineProperty(tK,"__esModule",{value:!0});var CS=ir(),yze={message({keyword:t,schemaCode:e}){let r=t==="maxItems"?"more":"fewer";return(0,CS.str)`must NOT have ${r} than ${e} items`},params:({schemaCode:t})=>(0,CS._)`{limit: ${t}}`},mze={keyword:["maxItems","minItems"],type:"array",schemaType:"number",$data:!0,error:yze,code(t){let{keyword:e,data:r,schemaCode:n}=t,i=e==="maxItems"?CS.operators.GT:CS.operators.LT;t.fail$data((0,CS._)`${r}.length ${i} ${n}`)}};tK.default=mze});var TP=W(rK=>{"use strict";f();Object.defineProperty(rK,"__esModule",{value:!0});var phe=RU();phe.code='require("ajv/dist/runtime/equal").default';rK.default=phe});var yhe=W(iK=>{"use strict";f();Object.defineProperty(iK,"__esModule",{value:!0});var nK=xS(),Ps=ir(),gze=Cr(),vze=TP(),bze={message:({params:{i:t,j:e}})=>(0,Ps.str)`must NOT have duplicate items (items ## ${e} and ${t} are identical)`,params:({params:{i:t,j:e}})=>(0,Ps._)`{i: ${t}, j: ${e}}`},wze={keyword:"uniqueItems",type:"array",schemaType:"boolean",$data:!0,error:bze,code(t){let{gen:e,data:r,$data:n,schema:i,parentSchema:o,schemaCode:s,it:a}=t;if(!n&&!i)return;let d=e.let("valid"),u=o.items?(0,nK.getSchemaTypes)(o.items):[];t.block$data(d,c,(0,Ps._)`${s} === false`),t.ok(d);function c(){let g=e.let("i",(0,Ps._)`${r}.length`),v=e.let("j");t.setParams({i:g,j:v}),e.assign(d,!0),e.if((0,Ps._)`${g} > 1`,()=>(l()?h:y)(g,v))}function l(){return u.length>0&&!u.some(g=>g==="object"||g==="array")}function h(g,v){let x=e.name("item"),S=(0,nK.checkDataTypes)(u,x,a.opts.strictNumbers,nK.DataType.Wrong),A=e.const("indices",(0,Ps._)`{}`);e.for((0,Ps._)`;${g}--;`,()=>{e.let(x,(0,Ps._)`${r}[${g}]`),e.if(S,(0,Ps._)`continue`),u.length>1&&e.if((0,Ps._)`typeof ${x} == "string"`,(0,Ps._)`${x} += "_"`),e.if((0,Ps._)`typeof ${A}[${x}] == "number"`,()=>{e.assign(v,(0,Ps._)`${A}[${x}]`),t.error(),e.assign(d,!1).break()}).code((0,Ps._)`${A}[${x}] = ${g}`)})}function y(g,v){let x=(0,gze.useFunc)(e,vze.default),S=e.name("outer");e.label(S).for((0,Ps._)`;${g}--;`,()=>e.for((0,Ps._)`${v} = ${g}; ${v}--;`,()=>e.if((0,Ps._)`${x}(${r}[${g}], ${r}[${v}])`,()=>{t.error(),e.assign(d,!1).break(S)})))}}};iK.default=wze});var mhe=W(sK=>{"use strict";f();Object.defineProperty(sK,"__esModule",{value:!0});var oK=ir(),_ze=Cr(),xze=TP(),Eze={message:"must be equal to constant",params:({schemaCode:t})=>(0,oK._)`{allowedValue: ${t}}`},Sze={keyword:"const",$data:!0,error:Eze,code(t){let{gen:e,data:r,$data:n,schemaCode:i,schema:o}=t;n||o&&typeof o=="object"?t.fail$data((0,oK._)`!${(0,_ze.useFunc)(e,xze.default)}(${r}, ${i})`):t.fail((0,oK._)`${o} !== ${r}`)}};sK.default=Sze});var ghe=W(aK=>{"use strict";f();Object.defineProperty(aK,"__esModule",{value:!0});var jS=ir(),Tze=Cr(),Aze=TP(),kze={message:"must be equal to one of the allowed values",params:({schemaCode:t})=>(0,jS._)`{allowedValues: ${t}}`},Pze={keyword:"enum",schemaType:"array",$data:!0,error:kze,code(t){let{gen:e,data:r,$data:n,schema:i,schemaCode:o,it:s}=t;if(!n&&i.length===0)throw new Error("enum must have non-empty array");let a=i.length>=s.opts.loopEnum,d,u=()=>d??(d=(0,Tze.useFunc)(e,Aze.default)),c;if(a||n)c=e.let("valid"),t.block$data(c,l);else{if(!Array.isArray(i))throw new Error("ajv implementation error");let y=e.const("vSchema",o);c=(0,jS.or)(...i.map((g,v)=>h(y,v)))}t.pass(c);function l(){e.assign(c,!1),e.forOf("v",o,y=>e.if((0,jS._)`${u()}(${r}, ${y})`,()=>e.assign(c,!0).break()))}function h(y,g){let v=i[g];return typeof v=="object"&&v!==null?(0,jS._)`${u()}(${r}, ${y}[${g}])`:(0,jS._)`${r} === ${v}`}}};aK.default=Pze});var vhe=W(cK=>{"use strict";f();Object.defineProperty(cK,"__esModule",{value:!0});var Ize=ohe(),Rze=she(),Bze=dhe(),Oze=uhe(),Mze=lhe(),Dze=fhe(),Cze=hhe(),jze=yhe(),$ze=mhe(),Nze=ghe(),Uze=[Ize.default,Rze.default,Bze.default,Oze.default,Mze.default,Dze.default,Cze.default,jze.default,{keyword:"type",schemaType:["string","array"]},{keyword:"nullable",schemaType:"boolean"},$ze.default,Nze.default];cK.default=Uze});var uK=W($S=>{"use strict";f();Object.defineProperty($S,"__esModule",{value:!0});$S.validateAdditionalItems=void 0;var Kv=ir(),dK=Cr(),Kze={message:({params:{len:t}})=>(0,Kv.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Kv._)`{limit: ${t}}`},qze={keyword:"additionalItems",type:"array",schemaType:["boolean","object"],before:"uniqueItems",error:Kze,code(t){let{parentSchema:e,it:r}=t,{items:n}=e;if(!Array.isArray(n)){(0,dK.checkStrictMode)(r,'"additionalItems" is ignored when "items" is not an array of schemas');return}bhe(t,n)}};function bhe(t,e){let{gen:r,schema:n,data:i,keyword:o,it:s}=t;s.items=!0;let a=r.const("len",(0,Kv._)`${i}.length`);if(n===!1)t.setParams({len:e.length}),t.pass((0,Kv._)`${a} <= ${e.length}`);else if(typeof n=="object"&&!(0,dK.alwaysValidSchema)(s,n)){let u=r.var("valid",(0,Kv._)`${a} <= ${e.length}`);r.if((0,Kv.not)(u),()=>d(u)),t.ok(u)}function d(u){r.forRange("i",e.length,a,c=>{t.subschema({keyword:o,dataProp:c,dataPropType:dK.Type.Num},u),s.allErrors||r.if((0,Kv.not)(u),()=>r.break())})}}$S.validateAdditionalItems=bhe;$S.default=qze});var lK=W(NS=>{"use strict";f();Object.defineProperty(NS,"__esModule",{value:!0});NS.validateTuple=void 0;var whe=ir(),AP=Cr(),Lze=Xd(),Fze={keyword:"items",type:"array",schemaType:["object","array","boolean"],before:"uniqueItems",code(t){let{schema:e,it:r}=t;if(Array.isArray(e))return _he(t,"additionalItems",e);r.items=!0,!(0,AP.alwaysValidSchema)(r,e)&&t.ok((0,Lze.validateArray)(t))}};function _he(t,e,r=t.schema){let{gen:n,parentSchema:i,data:o,keyword:s,it:a}=t;c(i),a.opts.unevaluated&&r.length&&a.items!==!0&&(a.items=AP.mergeEvaluated.items(n,r.length,a.items));let d=n.name("valid"),u=n.const("len",(0,whe._)`${o}.length`);r.forEach((l,h)=>{(0,AP.alwaysValidSchema)(a,l)||(n.if((0,whe._)`${u} > ${h}`,()=>t.subschema({keyword:s,schemaProp:h,dataProp:h},d)),t.ok(d))});function c(l){let{opts:h,errSchemaPath:y}=a,g=r.length,v=g===l.minItems&&(g===l.maxItems||l[e]===!1);if(h.strictTuples&&!v){let x=`"${s}" is ${g}-tuple, but minItems or maxItems/${e} are not specified or different at path "${y}"`;(0,AP.checkStrictMode)(a,x,h.strictTuples)}}}NS.validateTuple=_he;NS.default=Fze});var xhe=W(fK=>{"use strict";f();Object.defineProperty(fK,"__esModule",{value:!0});var zze=lK(),Vze={keyword:"prefixItems",type:"array",schemaType:["array"],before:"uniqueItems",code:t=>(0,zze.validateTuple)(t,"items")};fK.default=Vze});var She=W(hK=>{"use strict";f();Object.defineProperty(hK,"__esModule",{value:!0});var Ehe=ir(),Hze=Cr(),Wze=Xd(),Gze=uK(),Jze={message:({params:{len:t}})=>(0,Ehe.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,Ehe._)`{limit: ${t}}`},Yze={keyword:"items",type:"array",schemaType:["object","boolean"],before:"uniqueItems",error:Jze,code(t){let{schema:e,parentSchema:r,it:n}=t,{prefixItems:i}=r;n.items=!0,!(0,Hze.alwaysValidSchema)(n,e)&&(i?(0,Gze.validateAdditionalItems)(t,i):t.ok((0,Wze.validateArray)(t)))}};hK.default=Yze});var The=W(pK=>{"use strict";f();Object.defineProperty(pK,"__esModule",{value:!0});var eu=ir(),kP=Cr(),Zze={message:({params:{min:t,max:e}})=>e===void 0?(0,eu.str)`must contain at least ${t} valid item(s)`:(0,eu.str)`must contain at least ${t} and no more than ${e} valid item(s)`,params:({params:{min:t,max:e}})=>e===void 0?(0,eu._)`{minContains: ${t}}`:(0,eu._)`{minContains: ${t}, maxContains: ${e}}`},Xze={keyword:"contains",type:"array",schemaType:["object","boolean"],before:"uniqueItems",trackErrors:!0,error:Zze,code(t){let{gen:e,schema:r,parentSchema:n,data:i,it:o}=t,s,a,{minContains:d,maxContains:u}=n;o.opts.next?(s=d===void 0?1:d,a=u):s=1;let c=e.const("len",(0,eu._)`${i}.length`);if(t.setParams({min:s,max:a}),a===void 0&&s===0){(0,kP.checkStrictMode)(o,'"minContains" == 0 without "maxContains": "contains" keyword ignored');return}if(a!==void 0&&s>a){(0,kP.checkStrictMode)(o,'"minContains" > "maxContains" is always invalid'),t.fail();return}if((0,kP.alwaysValidSchema)(o,r)){let v=(0,eu._)`${c} >= ${s}`;a!==void 0&&(v=(0,eu._)`${v} && ${c} <= ${a}`),t.pass(v);return}o.items=!0;let l=e.name("valid");a===void 0&&s===1?y(l,()=>e.if(l,()=>e.break())):s===0?(e.let(l,!0),a!==void 0&&e.if((0,eu._)`${i}.length > 0`,h)):(e.let(l,!1),h()),t.result(l,()=>t.reset());function h(){let v=e.name("_valid"),x=e.let("count",0);y(v,()=>e.if(v,()=>g(x)))}function y(v,x){e.forRange("i",0,c,S=>{t.subschema({keyword:"contains",dataProp:S,dataPropType:kP.Type.Num,compositeRule:!0},v),x()})}function g(v){e.code((0,eu._)`${v}++`),a===void 0?e.if((0,eu._)`${v} >= ${s}`,()=>e.assign(l,!0).break()):(e.if((0,eu._)`${v} > ${a}`,()=>e.assign(l,!1).break()),s===1?e.assign(l,!0):e.if((0,eu._)`${v} >= ${s}`,()=>e.assign(l,!0)))}}};pK.default=Xze});var PP=W(Pf=>{"use strict";f();Object.defineProperty(Pf,"__esModule",{value:!0});Pf.validateSchemaDeps=Pf.validatePropertyDeps=Pf.error=void 0;var yK=ir(),Qze=Cr(),US=Xd();Pf.error={message:({params:{property:t,depsCount:e,deps:r}})=>{let n=e===1?"property":"properties";return(0,yK.str)`must have ${n} ${r} when property ${t} is present`},params:({params:{property:t,depsCount:e,deps:r,missingProperty:n}})=>(0,yK._)`{property: ${t},
    missingProperty: ${n},
    depsCount: ${e},
    deps: ${r}}`};var eVe={keyword:"dependencies",type:"object",schemaType:"object",error:Pf.error,code(t){let[e,r]=tVe(t);Ahe(t,e),khe(t,r)}};function tVe({schema:t}){let e={},r={};for(let n in t){if(n==="__proto__")continue;let i=Array.isArray(t[n])?e:r;i[n]=t[n]}return[e,r]}function Ahe(t,e=t.schema){let{gen:r,data:n,it:i}=t;if(Object.keys(e).length===0)return;let o=r.let("missing");for(let s in e){let a=e[s];if(a.length===0)continue;let d=(0,US.propertyInData)(r,n,s,i.opts.ownProperties);t.setParams({property:s,depsCount:a.length,deps:a.join(", ")}),i.allErrors?r.if(d,()=>{for(let u of a)(0,US.checkReportMissingProp)(t,u)}):(r.if((0,yK._)`${d} && (${(0,US.checkMissingProp)(t,a,o)})`),(0,US.reportMissingProp)(t,o),r.else())}}Pf.validatePropertyDeps=Ahe;function khe(t,e=t.schema){let{gen:r,data:n,keyword:i,it:o}=t,s=r.name("valid");for(let a in e)(0,Qze.alwaysValidSchema)(o,e[a])||(r.if((0,US.propertyInData)(r,n,a,o.opts.ownProperties),()=>{let d=t.subschema({keyword:i,schemaProp:a},s);t.mergeValidEvaluated(d,s)},()=>r.var(s,!0)),t.ok(s))}Pf.validateSchemaDeps=khe;Pf.default=eVe});var Ihe=W(mK=>{"use strict";f();Object.defineProperty(mK,"__esModule",{value:!0});var Phe=ir(),rVe=Cr(),nVe={message:"property name must be valid",params:({params:t})=>(0,Phe._)`{propertyName: ${t.propertyName}}`},iVe={keyword:"propertyNames",type:"object",schemaType:["object","boolean"],error:nVe,code(t){let{gen:e,schema:r,data:n,it:i}=t;if((0,rVe.alwaysValidSchema)(i,r))return;let o=e.name("valid");e.forIn("key",n,s=>{t.setParams({propertyName:s}),t.subschema({keyword:"propertyNames",data:s,dataTypes:["string"],propertyName:s,compositeRule:!0},o),e.if((0,Phe.not)(o),()=>{t.error(!0),i.allErrors||e.break()})}),t.ok(o)}};mK.default=iVe});var vK=W(gK=>{"use strict";f();Object.defineProperty(gK,"__esModule",{value:!0});var IP=Xd(),cl=ir(),oVe=Zd(),RP=Cr(),sVe={message:"must NOT have additional properties",params:({params:t})=>(0,cl._)`{additionalProperty: ${t.additionalProperty}}`},aVe={keyword:"additionalProperties",type:["object"],schemaType:["boolean","object"],allowUndefined:!0,trackErrors:!0,error:sVe,code(t){let{gen:e,schema:r,parentSchema:n,data:i,errsCount:o,it:s}=t;if(!o)throw new Error("ajv implementation error");let{allErrors:a,opts:d}=s;if(s.props=!0,d.removeAdditional!=="all"&&(0,RP.alwaysValidSchema)(s,r))return;let u=(0,IP.allSchemaProperties)(n.properties),c=(0,IP.allSchemaProperties)(n.patternProperties);l(),t.ok((0,cl._)`${o} === ${oVe.default.errors}`);function l(){e.forIn("key",i,x=>{!u.length&&!c.length?g(x):e.if(h(x),()=>g(x))})}function h(x){let S;if(u.length>8){let A=(0,RP.schemaRefOrVal)(s,n.properties,"properties");S=(0,IP.isOwnProperty)(e,A,x)}else u.length?S=(0,cl.or)(...u.map(A=>(0,cl._)`${x} === ${A}`)):S=cl.nil;return c.length&&(S=(0,cl.or)(S,...c.map(A=>(0,cl._)`${(0,IP.usePattern)(t,A)}.test(${x})`))),(0,cl.not)(S)}function y(x){e.code((0,cl._)`delete ${i}[${x}]`)}function g(x){if(d.removeAdditional==="all"||d.removeAdditional&&r===!1){y(x);return}if(r===!1){t.setParams({additionalProperty:x}),t.error(),a||e.break();return}if(typeof r=="object"&&!(0,RP.alwaysValidSchema)(s,r)){let S=e.name("valid");d.removeAdditional==="failing"?(v(x,S,!1),e.if((0,cl.not)(S),()=>{t.reset(),y(x)})):(v(x,S),a||e.if((0,cl.not)(S),()=>e.break()))}}function v(x,S,A){let T={keyword:"additionalProperties",dataProp:x,dataPropType:RP.Type.Str};A===!1&&Object.assign(T,{compositeRule:!0,createErrors:!1,allErrors:!1}),t.subschema(T,S)}}};gK.default=aVe});var Ohe=W(wK=>{"use strict";f();Object.defineProperty(wK,"__esModule",{value:!0});var cVe=AS(),Rhe=Xd(),bK=Cr(),Bhe=vK(),dVe={keyword:"properties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,parentSchema:n,data:i,it:o}=t;o.opts.removeAdditional==="all"&&n.additionalProperties===void 0&&Bhe.default.code(new cVe.KeywordCxt(o,Bhe.default,"additionalProperties"));let s=(0,Rhe.allSchemaProperties)(r);for(let l of s)o.definedProperties.add(l);o.opts.unevaluated&&s.length&&o.props!==!0&&(o.props=bK.mergeEvaluated.props(e,(0,bK.toHash)(s),o.props));let a=s.filter(l=>!(0,bK.alwaysValidSchema)(o,r[l]));if(a.length===0)return;let d=e.name("valid");for(let l of a)u(l)?c(l):(e.if((0,Rhe.propertyInData)(e,i,l,o.opts.ownProperties)),c(l),o.allErrors||e.else().var(d,!0),e.endIf()),t.it.definedProperties.add(l),t.ok(d);function u(l){return o.opts.useDefaults&&!o.compositeRule&&r[l].default!==void 0}function c(l){t.subschema({keyword:"properties",schemaProp:l,dataProp:l},d)}}};wK.default=dVe});var jhe=W(_K=>{"use strict";f();Object.defineProperty(_K,"__esModule",{value:!0});var Mhe=Xd(),BP=ir(),Dhe=Cr(),Che=Cr(),uVe={keyword:"patternProperties",type:"object",schemaType:"object",code(t){let{gen:e,schema:r,data:n,parentSchema:i,it:o}=t,{opts:s}=o,a=(0,Mhe.allSchemaProperties)(r),d=a.filter(v=>(0,Dhe.alwaysValidSchema)(o,r[v]));if(a.length===0||d.length===a.length&&(!o.opts.unevaluated||o.props===!0))return;let u=s.strictSchema&&!s.allowMatchingProperties&&i.properties,c=e.name("valid");o.props!==!0&&!(o.props instanceof BP.Name)&&(o.props=(0,Che.evaluatedPropsToName)(e,o.props));let{props:l}=o;h();function h(){for(let v of a)u&&y(v),o.allErrors?g(v):(e.var(c,!0),g(v),e.if(c))}function y(v){for(let x in u)new RegExp(v).test(x)&&(0,Dhe.checkStrictMode)(o,`property ${x} matches pattern ${v} (use allowMatchingProperties)`)}function g(v){e.forIn("key",n,x=>{e.if((0,BP._)`${(0,Mhe.usePattern)(t,v)}.test(${x})`,()=>{let S=d.includes(v);S||t.subschema({keyword:"patternProperties",schemaProp:v,dataProp:x,dataPropType:Che.Type.Str},c),o.opts.unevaluated&&l!==!0?e.assign((0,BP._)`${l}[${x}]`,!0):!S&&!o.allErrors&&e.if((0,BP.not)(c),()=>e.break())})})}}};_K.default=uVe});var $he=W(xK=>{"use strict";f();Object.defineProperty(xK,"__esModule",{value:!0});var lVe=Cr(),fVe={keyword:"not",schemaType:["object","boolean"],trackErrors:!0,code(t){let{gen:e,schema:r,it:n}=t;if((0,lVe.alwaysValidSchema)(n,r)){t.fail();return}let i=e.name("valid");t.subschema({keyword:"not",compositeRule:!0,createErrors:!1,allErrors:!1},i),t.failResult(i,()=>t.reset(),()=>t.error())},error:{message:"must NOT be valid"}};xK.default=fVe});var Nhe=W(EK=>{"use strict";f();Object.defineProperty(EK,"__esModule",{value:!0});var hVe=Xd(),pVe={keyword:"anyOf",schemaType:"array",trackErrors:!0,code:hVe.validateUnion,error:{message:"must match a schema in anyOf"}};EK.default=pVe});var Uhe=W(SK=>{"use strict";f();Object.defineProperty(SK,"__esModule",{value:!0});var OP=ir(),yVe=Cr(),mVe={message:"must match exactly one schema in oneOf",params:({params:t})=>(0,OP._)`{passingSchemas: ${t.passing}}`},gVe={keyword:"oneOf",schemaType:"array",trackErrors:!0,error:mVe,code(t){let{gen:e,schema:r,parentSchema:n,it:i}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");if(i.opts.discriminator&&n.discriminator)return;let o=r,s=e.let("valid",!1),a=e.let("passing",null),d=e.name("_valid");t.setParams({passing:a}),e.block(u),t.result(s,()=>t.reset(),()=>t.error(!0));function u(){o.forEach((c,l)=>{let h;(0,yVe.alwaysValidSchema)(i,c)?e.var(d,!0):h=t.subschema({keyword:"oneOf",schemaProp:l,compositeRule:!0},d),l>0&&e.if((0,OP._)`${d} && ${s}`).assign(s,!1).assign(a,(0,OP._)`[${a}, ${l}]`).else(),e.if(d,()=>{e.assign(s,!0),e.assign(a,l),h&&t.mergeEvaluated(h,OP.Name)})})}}};SK.default=gVe});var Khe=W(TK=>{"use strict";f();Object.defineProperty(TK,"__esModule",{value:!0});var vVe=Cr(),bVe={keyword:"allOf",schemaType:"array",code(t){let{gen:e,schema:r,it:n}=t;if(!Array.isArray(r))throw new Error("ajv implementation error");let i=e.name("valid");r.forEach((o,s)=>{if((0,vVe.alwaysValidSchema)(n,o))return;let a=t.subschema({keyword:"allOf",schemaProp:s},i);t.ok(i),t.mergeEvaluated(a)})}};TK.default=bVe});var Fhe=W(AK=>{"use strict";f();Object.defineProperty(AK,"__esModule",{value:!0});var MP=ir(),Lhe=Cr(),wVe={message:({params:t})=>(0,MP.str)`must match "${t.ifClause}" schema`,params:({params:t})=>(0,MP._)`{failingKeyword: ${t.ifClause}}`},_Ve={keyword:"if",schemaType:["object","boolean"],trackErrors:!0,error:wVe,code(t){let{gen:e,parentSchema:r,it:n}=t;r.then===void 0&&r.else===void 0&&(0,Lhe.checkStrictMode)(n,'"if" without "then" and "else" is ignored');let i=qhe(n,"then"),o=qhe(n,"else");if(!i&&!o)return;let s=e.let("valid",!0),a=e.name("_valid");if(d(),t.reset(),i&&o){let c=e.let("ifClause");t.setParams({ifClause:c}),e.if(a,u("then",c),u("else",c))}else i?e.if(a,u("then")):e.if((0,MP.not)(a),u("else"));t.pass(s,()=>t.error(!0));function d(){let c=t.subschema({keyword:"if",compositeRule:!0,createErrors:!1,allErrors:!1},a);t.mergeEvaluated(c)}function u(c,l){return()=>{let h=t.subschema({keyword:c},a);e.assign(s,a),t.mergeValidEvaluated(h,s),l?e.assign(l,(0,MP._)`${c}`):t.setParams({ifClause:c})}}}};function qhe(t,e){let r=t.schema[e];return r!==void 0&&!(0,Lhe.alwaysValidSchema)(t,r)}AK.default=_Ve});var zhe=W(kK=>{"use strict";f();Object.defineProperty(kK,"__esModule",{value:!0});var xVe=Cr(),EVe={keyword:["then","else"],schemaType:["object","boolean"],code({keyword:t,parentSchema:e,it:r}){e.if===void 0&&(0,xVe.checkStrictMode)(r,`"${t}" without "if" is ignored`)}};kK.default=EVe});var Vhe=W(PK=>{"use strict";f();Object.defineProperty(PK,"__esModule",{value:!0});var SVe=uK(),TVe=xhe(),AVe=lK(),kVe=She(),PVe=The(),IVe=PP(),RVe=Ihe(),BVe=vK(),OVe=Ohe(),MVe=jhe(),DVe=$he(),CVe=Nhe(),jVe=Uhe(),$Ve=Khe(),NVe=Fhe(),UVe=zhe();function KVe(t=!1){let e=[DVe.default,CVe.default,jVe.default,$Ve.default,NVe.default,UVe.default,RVe.default,BVe.default,IVe.default,OVe.default,MVe.default];return t?e.push(TVe.default,kVe.default):e.push(SVe.default,AVe.default),e.push(PVe.default),e}PK.default=KVe});var RK=W(KS=>{"use strict";f();Object.defineProperty(KS,"__esModule",{value:!0});KS.dynamicAnchor=void 0;var IK=ir(),qVe=Zd(),Hhe=kS(),LVe=_P(),FVe={keyword:"$dynamicAnchor",schemaType:"string",code:t=>Whe(t,t.schema)};function Whe(t,e){let{gen:r,it:n}=t;n.schemaEnv.root.dynamicAnchors[e]=!0;let i=(0,IK._)`${qVe.default.dynamicAnchors}${(0,IK.getProperty)(e)}`,o=n.errSchemaPath==="#"?n.validateName:zVe(t);r.if((0,IK._)`!${i}`,()=>r.assign(i,o))}KS.dynamicAnchor=Whe;function zVe(t){let{schemaEnv:e,schema:r,self:n}=t.it,{root:i,baseId:o,localRefs:s,meta:a}=e.root,{schemaId:d}=n.opts,u=new Hhe.SchemaEnv({schema:r,schemaId:d,root:i,baseId:o,localRefs:s,meta:a});return Hhe.compileSchema.call(n,u),(0,LVe.getValidate)(t,u)}KS.default=FVe});var BK=W(qS=>{"use strict";f();Object.defineProperty(qS,"__esModule",{value:!0});qS.dynamicRef=void 0;var Ghe=ir(),VVe=Zd(),Jhe=_P(),HVe={keyword:"$dynamicRef",schemaType:"string",code:t=>Yhe(t,t.schema)};function Yhe(t,e){let{gen:r,keyword:n,it:i}=t;if(e[0]!=="#")throw new Error(`"${n}" only supports hash fragment reference`);let o=e.slice(1);if(i.allErrors)s();else{let d=r.let("valid",!1);s(d),t.ok(d)}function s(d){if(i.schemaEnv.root.dynamicAnchors[o]){let u=r.let("_v",(0,Ghe._)`${VVe.default.dynamicAnchors}${(0,Ghe.getProperty)(o)}`);r.if(u,a(u,d),a(i.validateName,d))}else a(i.validateName,d)()}function a(d,u){return u?()=>r.block(()=>{(0,Jhe.callRef)(t,d),r.let(u,!0)}):()=>(0,Jhe.callRef)(t,d)}}qS.dynamicRef=Yhe;qS.default=HVe});var Zhe=W(OK=>{"use strict";f();Object.defineProperty(OK,"__esModule",{value:!0});var WVe=RK(),GVe=Cr(),JVe={keyword:"$recursiveAnchor",schemaType:"boolean",code(t){t.schema?(0,WVe.dynamicAnchor)(t,""):(0,GVe.checkStrictMode)(t.it,"$recursiveAnchor: false is ignored")}};OK.default=JVe});var Xhe=W(MK=>{"use strict";f();Object.defineProperty(MK,"__esModule",{value:!0});var YVe=BK(),ZVe={keyword:"$recursiveRef",schemaType:"string",code:t=>(0,YVe.dynamicRef)(t,t.schema)};MK.default=ZVe});var Qhe=W(DK=>{"use strict";f();Object.defineProperty(DK,"__esModule",{value:!0});var XVe=RK(),QVe=BK(),eHe=Zhe(),tHe=Xhe(),rHe=[XVe.default,QVe.default,eHe.default,tHe.default];DK.default=rHe});var tpe=W(CK=>{"use strict";f();Object.defineProperty(CK,"__esModule",{value:!0});var epe=PP(),nHe={keyword:"dependentRequired",type:"object",schemaType:"object",error:epe.error,code:t=>(0,epe.validatePropertyDeps)(t)};CK.default=nHe});var rpe=W(jK=>{"use strict";f();Object.defineProperty(jK,"__esModule",{value:!0});var iHe=PP(),oHe={keyword:"dependentSchemas",type:"object",schemaType:"object",code:t=>(0,iHe.validateSchemaDeps)(t)};jK.default=oHe});var npe=W($K=>{"use strict";f();Object.defineProperty($K,"__esModule",{value:!0});var sHe=Cr(),aHe={keyword:["maxContains","minContains"],type:"array",schemaType:"number",code({keyword:t,parentSchema:e,it:r}){e.contains===void 0&&(0,sHe.checkStrictMode)(r,`"${t}" without "contains" is ignored`)}};$K.default=aHe});var ipe=W(NK=>{"use strict";f();Object.defineProperty(NK,"__esModule",{value:!0});var cHe=tpe(),dHe=rpe(),uHe=npe(),lHe=[cHe.default,dHe.default,uHe.default];NK.default=lHe});var spe=W(UK=>{"use strict";f();Object.defineProperty(UK,"__esModule",{value:!0});var Cm=ir(),ope=Cr(),fHe=Zd(),hHe={message:"must NOT have unevaluated properties",params:({params:t})=>(0,Cm._)`{unevaluatedProperty: ${t.unevaluatedProperty}}`},pHe={keyword:"unevaluatedProperties",type:"object",schemaType:["boolean","object"],trackErrors:!0,error:hHe,code(t){let{gen:e,schema:r,data:n,errsCount:i,it:o}=t;if(!i)throw new Error("ajv implementation error");let{allErrors:s,props:a}=o;a instanceof Cm.Name?e.if((0,Cm._)`${a} !== true`,()=>e.forIn("key",n,l=>e.if(u(a,l),()=>d(l)))):a!==!0&&e.forIn("key",n,l=>a===void 0?d(l):e.if(c(a,l),()=>d(l))),o.props=!0,t.ok((0,Cm._)`${i} === ${fHe.default.errors}`);function d(l){if(r===!1){t.setParams({unevaluatedProperty:l}),t.error(),s||e.break();return}if(!(0,ope.alwaysValidSchema)(o,r)){let h=e.name("valid");t.subschema({keyword:"unevaluatedProperties",dataProp:l,dataPropType:ope.Type.Str},h),s||e.if((0,Cm.not)(h),()=>e.break())}}function u(l,h){return(0,Cm._)`!${l} || !${l}[${h}]`}function c(l,h){let y=[];for(let g in l)l[g]===!0&&y.push((0,Cm._)`${h} !== ${g}`);return(0,Cm.and)(...y)}}};UK.default=pHe});var cpe=W(KK=>{"use strict";f();Object.defineProperty(KK,"__esModule",{value:!0});var qv=ir(),ape=Cr(),yHe={message:({params:{len:t}})=>(0,qv.str)`must NOT have more than ${t} items`,params:({params:{len:t}})=>(0,qv._)`{limit: ${t}}`},mHe={keyword:"unevaluatedItems",type:"array",schemaType:["boolean","object"],error:yHe,code(t){let{gen:e,schema:r,data:n,it:i}=t,o=i.items||0;if(o===!0)return;let s=e.const("len",(0,qv._)`${n}.length`);if(r===!1)t.setParams({len:o}),t.fail((0,qv._)`${s} > ${o}`);else if(typeof r=="object"&&!(0,ape.alwaysValidSchema)(i,r)){let d=e.var("valid",(0,qv._)`${s} <= ${o}`);e.if((0,qv.not)(d),()=>a(d,o)),t.ok(d)}i.items=!0;function a(d,u){e.forRange("i",u,s,c=>{t.subschema({keyword:"unevaluatedItems",dataProp:c,dataPropType:ape.Type.Num},d),i.allErrors||e.if((0,qv.not)(d),()=>e.break())})}}};KK.default=mHe});var dpe=W(qK=>{"use strict";f();Object.defineProperty(qK,"__esModule",{value:!0});var gHe=spe(),vHe=cpe(),bHe=[gHe.default,vHe.default];qK.default=bHe});var upe=W(LK=>{"use strict";f();Object.defineProperty(LK,"__esModule",{value:!0});var Ui=ir(),wHe={message:({schemaCode:t})=>(0,Ui.str)`must match format "${t}"`,params:({schemaCode:t})=>(0,Ui._)`{format: ${t}}`},_He={keyword:"format",type:["number","string"],schemaType:"string",$data:!0,error:wHe,code(t,e){let{gen:r,data:n,$data:i,schema:o,schemaCode:s,it:a}=t,{opts:d,errSchemaPath:u,schemaEnv:c,self:l}=a;if(!d.validateFormats)return;i?h():y();function h(){let g=r.scopeValue("formats",{ref:l.formats,code:d.code.formats}),v=r.const("fDef",(0,Ui._)`${g}[${s}]`),x=r.let("fType"),S=r.let("format");r.if((0,Ui._)`typeof ${v} == "object" && !(${v} instanceof RegExp)`,()=>r.assign(x,(0,Ui._)`${v}.type || "string"`).assign(S,(0,Ui._)`${v}.validate`),()=>r.assign(x,(0,Ui._)`"string"`).assign(S,v)),t.fail$data((0,Ui.or)(A(),T()));function A(){return d.strictSchema===!1?Ui.nil:(0,Ui._)`${s} && !${S}`}function T(){let $=c.$async?(0,Ui._)`(${v}.async ? await ${S}(${n}) : ${S}(${n}))`:(0,Ui._)`${S}(${n})`,j=(0,Ui._)`(typeof ${S} == "function" ? ${$} : ${S}.test(${n}))`;return(0,Ui._)`${S} && ${S} !== true && ${x} === ${e} && !${j}`}}function y(){let g=l.formats[o];if(!g){A();return}if(g===!0)return;let[v,x,S]=T(g);v===e&&t.pass($());function A(){if(d.strictSchema===!1){l.logger.warn(j());return}throw new Error(j());function j(){return`unknown format "${o}" ignored in schema at path "${u}"`}}function T(j){let K=j instanceof RegExp?(0,Ui.regexpCode)(j):d.code.formats?(0,Ui._)`${d.code.formats}${(0,Ui.getProperty)(o)}`:void 0,F=r.scopeValue("formats",{key:o,ref:j,code:K});return typeof j=="object"&&!(j instanceof RegExp)?[j.type||"string",j.validate,(0,Ui._)`${F}.validate`]:["string",j,F]}function $(){if(typeof g=="object"&&!(g instanceof RegExp)&&g.async){if(!c.$async)throw new Error("async format in sync schema");return(0,Ui._)`await ${S}(${n})`}return typeof x=="function"?(0,Ui._)`${S}(${n})`:(0,Ui._)`${S}.test(${n})`}}}};LK.default=_He});var lpe=W(FK=>{"use strict";f();Object.defineProperty(FK,"__esModule",{value:!0});var xHe=upe(),EHe=[xHe.default];FK.default=EHe});var fpe=W(M2=>{"use strict";f();Object.defineProperty(M2,"__esModule",{value:!0});M2.contentVocabulary=M2.metadataVocabulary=void 0;M2.metadataVocabulary=["title","description","default","deprecated","readOnly","writeOnly","examples"];M2.contentVocabulary=["contentMediaType","contentEncoding","contentSchema"]});var ppe=W(zK=>{"use strict";f();Object.defineProperty(zK,"__esModule",{value:!0});var SHe=ihe(),THe=vhe(),AHe=Vhe(),kHe=Qhe(),PHe=ipe(),IHe=dpe(),RHe=lpe(),hpe=fpe(),BHe=[kHe.default,SHe.default,THe.default,(0,AHe.default)(!0),RHe.default,hpe.metadataVocabulary,hpe.contentVocabulary,PHe.default,IHe.default];zK.default=BHe});var ype=W(LS=>{"use strict";f();Object.defineProperty(LS,"__esModule",{value:!0});LS.DiscrError=void 0;var OHe;(function(t){t.Tag="tag",t.Mapping="mapping"})(OHe=LS.DiscrError||(LS.DiscrError={}))});var gpe=W(HK=>{"use strict";f();Object.defineProperty(HK,"__esModule",{value:!0});var D2=ir(),VK=ype(),mpe=kS(),MHe=Cr(),DHe={message:({params:{discrError:t,tagName:e}})=>t===VK.DiscrError.Tag?`tag "${e}" must be string`:`value of tag "${e}" must be in oneOf`,params:({params:{discrError:t,tag:e,tagName:r}})=>(0,D2._)`{error: ${t}, tag: ${r}, tagValue: ${e}}`},CHe={keyword:"discriminator",type:"object",schemaType:"object",error:DHe,code(t){let{gen:e,data:r,schema:n,parentSchema:i,it:o}=t,{oneOf:s}=i;if(!o.opts.discriminator)throw new Error("discriminator: requires discriminator option");let a=n.propertyName;if(typeof a!="string")throw new Error("discriminator: requires propertyName");if(n.mapping)throw new Error("discriminator: mapping is not supported");if(!s)throw new Error("discriminator: requires oneOf keyword");let d=e.let("valid",!1),u=e.const("tag",(0,D2._)`${r}${(0,D2.getProperty)(a)}`);e.if((0,D2._)`typeof ${u} == "string"`,()=>c(),()=>t.error(!1,{discrError:VK.DiscrError.Tag,tag:u,tagName:a})),t.ok(d);function c(){let y=h();e.if(!1);for(let g in y)e.elseIf((0,D2._)`${u} === ${g}`),e.assign(d,l(y[g]));e.else(),t.error(!1,{discrError:VK.DiscrError.Mapping,tag:u,tagName:a}),e.endIf()}function l(y){let g=e.name("valid"),v=t.subschema({keyword:"oneOf",schemaProp:y},g);return t.mergeEvaluated(v,D2.Name),g}function h(){var y;let g={},v=S(i),x=!0;for(let $=0;$<s.length;$++){let j=s[$];j?.$ref&&!(0,MHe.schemaHasRulesButRef)(j,o.self.RULES)&&(j=mpe.resolveRef.call(o.self,o.schemaEnv.root,o.baseId,j?.$ref),j instanceof mpe.SchemaEnv&&(j=j.schema));let K=(y=j?.properties)===null||y===void 0?void 0:y[a];if(typeof K!="object")throw new Error(`discriminator: oneOf subschemas (or referenced schemas) must have "properties/${a}"`);x=x&&(v||S(j)),A(K,$)}if(!x)throw new Error(`discriminator: "${a}" must be required`);return g;function S({required:$}){return Array.isArray($)&&$.includes(a)}function A($,j){if($.const)T($.const,j);else if($.enum)for(let K of $.enum)T(K,j);else throw new Error(`discriminator: "properties/${a}" must have "const" or "enum"`)}function T($,j){if(typeof $!="string"||$ in g)throw new Error(`discriminator: "${a}" values must be unique strings`);g[$]=j}}}};HK.default=CHe});var vpe=W((hTt,jHe)=>{jHe.exports={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://json-schema.org/draft/2020-12/schema",$vocabulary:{"https://json-schema.org/draft/2020-12/vocab/core":!0,"https://json-schema.org/draft/2020-12/vocab/applicator":!0,"https://json-schema.org/draft/2020-12/vocab/unevaluated":!0,"https://json-schema.org/draft/2020-12/vocab/validation":!0,"https://json-schema.org/draft/2020-12/vocab/meta-data":!0,"https://json-schema.org/draft/2020-12/vocab/format-annotation":!0,"https://json-schema.org/draft/2020-12/vocab/content":!0},$dynamicAnchor:"meta",title:"Core and Validation specifications meta-schema",allOf:[{$ref:"meta/core"},{$ref:"meta/applicator"},{$ref:"meta/unevaluated"},{$ref:"meta/validation"},{$ref:"meta/meta-data"},{$ref:"meta/format-annotation"},{$ref:"meta/content"}],type:["object","boolean"],$comment:"This meta-schema also defines keywords that have appeared in previous drafts in order to prevent incompatible extensions as they remain in common use.",properties:{definitions:{$comment:'"definitions" has been replaced by "$defs".',type:"object",additionalProperties:{$dynamicRef:"#meta"},deprecated:!0,default:{}},dependencies:{$comment:'"dependencies" has been split and replaced by "dependentSchemas" and "dependentRequired" in order to serve their differing semantics.',type:"object",additionalProperties:{anyOf:[{$dynamicRef:"#meta"},{$ref:"meta/validation#/$defs/stringArray"}]},deprecated:!0,default:{}},$recursiveAnchor:{$comment:'"$recursiveAnchor" has been replaced by "$dynamicAnchor".',$ref:"meta/core#/$defs/anchorString",deprecated:!0},$recursiveRef:{$comment:'"$recursiveRef" has been replaced by "$dynamicRef".',$ref:"meta/core#/$defs/uriReferenceString",deprecated:!0}}}});var bpe=W((pTt,$He)=>{$He.exports={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://json-schema.org/draft/2020-12/meta/applicator",$vocabulary:{"https://json-schema.org/draft/2020-12/vocab/applicator":!0},$dynamicAnchor:"meta",title:"Applicator vocabulary meta-schema",type:["object","boolean"],properties:{prefixItems:{$ref:"#/$defs/schemaArray"},items:{$dynamicRef:"#meta"},contains:{$dynamicRef:"#meta"},additionalProperties:{$dynamicRef:"#meta"},properties:{type:"object",additionalProperties:{$dynamicRef:"#meta"},default:{}},patternProperties:{type:"object",additionalProperties:{$dynamicRef:"#meta"},propertyNames:{format:"regex"},default:{}},dependentSchemas:{type:"object",additionalProperties:{$dynamicRef:"#meta"},default:{}},propertyNames:{$dynamicRef:"#meta"},if:{$dynamicRef:"#meta"},then:{$dynamicRef:"#meta"},else:{$dynamicRef:"#meta"},allOf:{$ref:"#/$defs/schemaArray"},anyOf:{$ref:"#/$defs/schemaArray"},oneOf:{$ref:"#/$defs/schemaArray"},not:{$dynamicRef:"#meta"}},$defs:{schemaArray:{type:"array",minItems:1,items:{$dynamicRef:"#meta"}}}}});var wpe=W((yTt,NHe)=>{NHe.exports={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://json-schema.org/draft/2020-12/meta/unevaluated",$vocabulary:{"https://json-schema.org/draft/2020-12/vocab/unevaluated":!0},$dynamicAnchor:"meta",title:"Unevaluated applicator vocabulary meta-schema",type:["object","boolean"],properties:{unevaluatedItems:{$dynamicRef:"#meta"},unevaluatedProperties:{$dynamicRef:"#meta"}}}});var _pe=W((mTt,UHe)=>{UHe.exports={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://json-schema.org/draft/2020-12/meta/content",$vocabulary:{"https://json-schema.org/draft/2020-12/vocab/content":!0},$dynamicAnchor:"meta",title:"Content vocabulary meta-schema",type:["object","boolean"],properties:{contentEncoding:{type:"string"},contentMediaType:{type:"string"},contentSchema:{$dynamicRef:"#meta"}}}});var xpe=W((gTt,KHe)=>{KHe.exports={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://json-schema.org/draft/2020-12/meta/core",$vocabulary:{"https://json-schema.org/draft/2020-12/vocab/core":!0},$dynamicAnchor:"meta",title:"Core vocabulary meta-schema",type:["object","boolean"],properties:{$id:{$ref:"#/$defs/uriReferenceString",$comment:"Non-empty fragments not allowed.",pattern:"^[^#]*#?$"},$schema:{$ref:"#/$defs/uriString"},$ref:{$ref:"#/$defs/uriReferenceString"},$anchor:{$ref:"#/$defs/anchorString"},$dynamicRef:{$ref:"#/$defs/uriReferenceString"},$dynamicAnchor:{$ref:"#/$defs/anchorString"},$vocabulary:{type:"object",propertyNames:{$ref:"#/$defs/uriString"},additionalProperties:{type:"boolean"}},$comment:{type:"string"},$defs:{type:"object",additionalProperties:{$dynamicRef:"#meta"}}},$defs:{anchorString:{type:"string",pattern:"^[A-Za-z_][-A-Za-z0-9._]*$"},uriString:{type:"string",format:"uri"},uriReferenceString:{type:"string",format:"uri-reference"}}}});var Epe=W((vTt,qHe)=>{qHe.exports={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://json-schema.org/draft/2020-12/meta/format-annotation",$vocabulary:{"https://json-schema.org/draft/2020-12/vocab/format-annotation":!0},$dynamicAnchor:"meta",title:"Format vocabulary meta-schema for annotation results",type:["object","boolean"],properties:{format:{type:"string"}}}});var Spe=W((bTt,LHe)=>{LHe.exports={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://json-schema.org/draft/2020-12/meta/meta-data",$vocabulary:{"https://json-schema.org/draft/2020-12/vocab/meta-data":!0},$dynamicAnchor:"meta",title:"Meta-data vocabulary meta-schema",type:["object","boolean"],properties:{title:{type:"string"},description:{type:"string"},default:!0,deprecated:{type:"boolean",default:!1},readOnly:{type:"boolean",default:!1},writeOnly:{type:"boolean",default:!1},examples:{type:"array",items:!0}}}});var Tpe=W((wTt,FHe)=>{FHe.exports={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://json-schema.org/draft/2020-12/meta/validation",$vocabulary:{"https://json-schema.org/draft/2020-12/vocab/validation":!0},$dynamicAnchor:"meta",title:"Validation vocabulary meta-schema",type:["object","boolean"],properties:{type:{anyOf:[{$ref:"#/$defs/simpleTypes"},{type:"array",items:{$ref:"#/$defs/simpleTypes"},minItems:1,uniqueItems:!0}]},const:!0,enum:{type:"array",items:!0},multipleOf:{type:"number",exclusiveMinimum:0},maximum:{type:"number"},exclusiveMaximum:{type:"number"},minimum:{type:"number"},exclusiveMinimum:{type:"number"},maxLength:{$ref:"#/$defs/nonNegativeInteger"},minLength:{$ref:"#/$defs/nonNegativeIntegerDefault0"},pattern:{type:"string",format:"regex"},maxItems:{$ref:"#/$defs/nonNegativeInteger"},minItems:{$ref:"#/$defs/nonNegativeIntegerDefault0"},uniqueItems:{type:"boolean",default:!1},maxContains:{$ref:"#/$defs/nonNegativeInteger"},minContains:{$ref:"#/$defs/nonNegativeInteger",default:1},maxProperties:{$ref:"#/$defs/nonNegativeInteger"},minProperties:{$ref:"#/$defs/nonNegativeIntegerDefault0"},required:{$ref:"#/$defs/stringArray"},dependentRequired:{type:"object",additionalProperties:{$ref:"#/$defs/stringArray"}}},$defs:{nonNegativeInteger:{type:"integer",minimum:0},nonNegativeIntegerDefault0:{$ref:"#/$defs/nonNegativeInteger",default:0},simpleTypes:{enum:["array","boolean","integer","null","number","object","string"]},stringArray:{type:"array",items:{type:"string"},uniqueItems:!0,default:[]}}}});var Ape=W(WK=>{"use strict";f();Object.defineProperty(WK,"__esModule",{value:!0});var zHe=vpe(),VHe=bpe(),HHe=wpe(),WHe=_pe(),GHe=xpe(),JHe=Epe(),YHe=Spe(),ZHe=Tpe(),XHe=["/properties"];function QHe(t){return[zHe,VHe,HHe,WHe,GHe,e(this,JHe),YHe,e(this,ZHe)].forEach(r=>this.addMetaSchema(r,void 0,!1)),this;function e(r,n){return t?r.$dataMetaSchema(n,XHe):n}}WK.default=QHe});var JK=W((fi,kpe)=>{"use strict";f();Object.defineProperty(fi,"__esModule",{value:!0});fi.MissingRefError=fi.ValidationError=fi.CodeGen=fi.Name=fi.nil=fi.stringify=fi.str=fi._=fi.KeywordCxt=void 0;var eWe=Qfe(),tWe=ppe(),rWe=gpe(),nWe=Ape(),GK="https://json-schema.org/draft/2020-12/schema",DP=class extends eWe.default{constructor(e={}){super({...e,dynamicRef:!0,next:!0,unevaluated:!0})}_addVocabularies(){super._addVocabularies(),tWe.default.forEach(e=>this.addVocabulary(e)),this.opts.discriminator&&this.addKeyword(rWe.default)}_addDefaultMetaSchema(){super._addDefaultMetaSchema();let{$data:e,meta:r}=this.opts;r&&(nWe.default.call(this,e),this.refs["http://json-schema.org/schema"]=GK)}defaultMeta(){return this.opts.defaultMeta=super.defaultMeta()||(this.getSchema(GK)?GK:void 0)}};kpe.exports=fi=DP;Object.defineProperty(fi,"__esModule",{value:!0});fi.default=DP;var iWe=AS();Object.defineProperty(fi,"KeywordCxt",{enumerable:!0,get:function(){return iWe.KeywordCxt}});var C2=ir();Object.defineProperty(fi,"_",{enumerable:!0,get:function(){return C2._}});Object.defineProperty(fi,"str",{enumerable:!0,get:function(){return C2.str}});Object.defineProperty(fi,"stringify",{enumerable:!0,get:function(){return C2.stringify}});Object.defineProperty(fi,"nil",{enumerable:!0,get:function(){return C2.nil}});Object.defineProperty(fi,"Name",{enumerable:!0,get:function(){return C2.Name}});Object.defineProperty(fi,"CodeGen",{enumerable:!0,get:function(){return C2.CodeGen}});var oWe=pP();Object.defineProperty(fi,"ValidationError",{enumerable:!0,get:function(){return oWe.default}});var sWe=yP();Object.defineProperty(fi,"MissingRefError",{enumerable:!0,get:function(){return sWe.default}})});var rq=W((Pkt,Dpe)=>{f();var lWe=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,FP=()=>lWe.now(),fWe=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),eq=t=>t===1/0||fWe(t),tq=class t{constructor({max:e=1/0,ttl:r,updateAgeOnGet:n=!1,checkAgeOnGet:i=!1,noUpdateTTL:o=!1,dispose:s,noDisposeOnSet:a=!1}={}){if(this.expirations=Object.create(null),this.data=new Map,this.expirationMap=new Map,r!==void 0&&!eq(r))throw new TypeError("ttl must be positive integer or Infinity if set");if(!eq(e))throw new TypeError("max must be positive integer or Infinity");if(this.ttl=r,this.max=e,this.updateAgeOnGet=!!n,this.checkAgeOnGet=!!i,this.noUpdateTTL=!!o,this.noDisposeOnSet=!!a,s!==void 0){if(typeof s!="function")throw new TypeError("dispose must be function if set");this.dispose=s}this.timer=void 0,this.timerExpiration=void 0}setTimer(e,r){if(this.timerExpiration<e)return;this.timer&&clearTimeout(this.timer);let n=setTimeout(()=>{this.timer=void 0,this.timerExpiration=void 0,this.purgeStale();for(let i in this.expirations){this.setTimer(i,i-FP());break}},r);n.unref&&n.unref(),this.timerExpiration=e,this.timer=n}cancelTimer(){this.timer&&(clearTimeout(this.timer),this.timerExpiration=void 0,this.timer=void 0)}cancelTimers(){return I.default.emitWarning('TTLCache.cancelTimers has been renamed to TTLCache.cancelTimer (no "s"), and will be removed in the next major version update'),this.cancelTimer()}clear(){let e=this.dispose!==t.prototype.dispose?[...this]:[];this.data.clear(),this.expirationMap.clear(),this.cancelTimer(),this.expirations=Object.create(null);for(let[r,n]of e)this.dispose(n,r,"delete")}setTTL(e,r=this.ttl){let n=this.expirationMap.get(e);if(n!==void 0){let i=this.expirations[n];!i||i.length<=1?delete this.expirations[n]:this.expirations[n]=i.filter(o=>o!==e)}if(r!==1/0){let i=Math.floor(FP()+r);this.expirationMap.set(e,i),this.expirations[i]||(this.expirations[i]=[],this.setTimer(i,r)),this.expirations[i].push(e)}else this.expirationMap.set(e,1/0)}set(e,r,{ttl:n=this.ttl,noUpdateTTL:i=this.noUpdateTTL,noDisposeOnSet:o=this.noDisposeOnSet}={}){if(!eq(n))throw new TypeError("ttl must be positive integer or Infinity");if(this.expirationMap.has(e)){i||this.setTTL(e,n);let s=this.data.get(e);s!==r&&(this.data.set(e,r),o||this.dispose(s,e,"set"))}else this.setTTL(e,n),this.data.set(e,r);for(;this.size>this.max;)this.purgeToCapacity();return this}has(e){return this.data.has(e)}getRemainingTTL(e){let r=this.expirationMap.get(e);return r===1/0?r:r!==void 0?Math.max(0,Math.ceil(r-FP())):0}get(e,{updateAgeOnGet:r=this.updateAgeOnGet,ttl:n=this.ttl,checkAgeOnGet:i=this.checkAgeOnGet}={}){let o=this.data.get(e);if(i&&this.getRemainingTTL(e)===0){this.delete(e);return}return r&&this.setTTL(e,n),o}dispose(e,r){}delete(e){let r=this.expirationMap.get(e);if(r!==void 0){let n=this.data.get(e);this.data.delete(e),this.expirationMap.delete(e);let i=this.expirations[r];return i&&(i.length<=1?delete this.expirations[r]:this.expirations[r]=i.filter(o=>o!==e)),this.dispose(n,e,"delete"),this.size===0&&this.cancelTimer(),!0}return!1}purgeToCapacity(){for(let e in this.expirations){let r=this.expirations[e];if(this.size-r.length>=this.max){delete this.expirations[e];let n=[];for(let i of r)n.push([i,this.data.get(i)]),this.data.delete(i),this.expirationMap.delete(i);for(let[i,o]of n)this.dispose(o,i,"evict")}else{let n=this.size-this.max,i=[];for(let o of r.splice(0,n))i.push([o,this.data.get(o)]),this.data.delete(o),this.expirationMap.delete(o);for(let[o,s]of i)this.dispose(s,o,"evict");return}}}get size(){return this.data.size}purgeStale(){let e=Math.ceil(FP());for(let r in this.expirations){if(r==="Infinity"||r>e)return;let n=[...this.expirations[r]||[]],i=[];delete this.expirations[r];for(let o of n)i.push([o,this.data.get(o)]),this.data.delete(o),this.expirationMap.delete(o);for(let[o,s]of i)this.dispose(s,o,"stale")}this.size===0&&this.cancelTimer()}*entries(){for(let e in this.expirations)for(let r of this.expirations[e])yield[r,this.data.get(r)]}*keys(){for(let e in this.expirations)for(let r of this.expirations[e])yield r}*values(){for(let e in this.expirations)for(let r of this.expirations[e])yield this.data.get(r)}[Symbol.iterator](){return this.entries()}};Dpe.exports=tq});var Upe=W(Npe=>{"use strict";f();Npe.supports=function(...e){let r=e.reduce((n,i)=>Object.assign(n,i),{});return Object.assign(r,{snapshots:r.snapshots||!1,permanence:r.permanence||!1,seek:r.seek||!1,clear:r.clear||!1,getMany:r.getMany||!1,keyIterator:r.keyIterator||!1,valueIterator:r.valueIterator||!1,iteratorNextv:r.iteratorNextv||!1,iteratorAll:r.iteratorAll||!1,status:r.status||!1,createIfMissing:r.createIfMissing||!1,errorIfExists:r.errorIfExists||!1,deferredOpen:r.deferredOpen||!1,promises:r.promises||!1,streams:r.streams||!1,encodings:Object.assign({},r.encodings),events:Object.assign({},r.events),additionalMethods:Object.assign({},r.additionalMethods)})}});var dl=W((Gkt,Kpe)=>{"use strict";f();Kpe.exports=class extends Error{constructor(e,r){super(e||""),typeof r=="object"&&r!==null&&(r.code&&(this.code=String(r.code)),r.expected&&(this.expected=!0),r.transient&&(this.transient=!0),r.cause&&(this.cause=r.cause)),Error.captureStackTrace&&Error.captureStackTrace(this,this.constructor)}}});var iq=W((Ykt,qpe)=>{"use strict";f();var nq=null;qpe.exports=function(){return nq===null&&(nq={textEncoder:new TextEncoder,textDecoder:new TextDecoder}),nq}});var aq=W(Lpe=>{"use strict";f();var oq=dl(),pWe=new Set(["buffer","view","utf8"]),sq=class{constructor(e){if(this.encode=e.encode||this.encode,this.decode=e.decode||this.decode,this.name=e.name||this.name,this.format=e.format||this.format,typeof this.encode!="function")throw new TypeError("The 'encode' property must be a function");if(typeof this.decode!="function")throw new TypeError("The 'decode' property must be a function");if(this.encode=this.encode.bind(this),this.decode=this.decode.bind(this),typeof this.name!="string"||this.name==="")throw new TypeError("The 'name' property must be a string");if(typeof this.format!="string"||!pWe.has(this.format))throw new TypeError("The 'format' property must be one of 'buffer', 'view', 'utf8'");e.createViewTranscoder&&(this.createViewTranscoder=e.createViewTranscoder),e.createBufferTranscoder&&(this.createBufferTranscoder=e.createBufferTranscoder),e.createUTF8Transcoder&&(this.createUTF8Transcoder=e.createUTF8Transcoder)}get commonName(){return this.name.split("+")[0]}createBufferTranscoder(){throw new oq(`Encoding '${this.name}' cannot be transcoded to 'buffer'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createViewTranscoder(){throw new oq(`Encoding '${this.name}' cannot be transcoded to 'view'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}createUTF8Transcoder(){throw new oq(`Encoding '${this.name}' cannot be transcoded to 'utf8'`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"})}};Lpe.Encoding=sq});var lq=W(VP=>{"use strict";f();var{Buffer:dq}=bn()||{},{Encoding:uq}=aq(),yWe=iq(),YS=class extends uq{constructor(e){super({...e,format:"buffer"})}createViewTranscoder(){return new ZS({encode:this.encode,decode:e=>this.decode(dq.from(e.buffer,e.byteOffset,e.byteLength)),name:`${this.name}+view`})}createBufferTranscoder(){return this}},ZS=class extends uq{constructor(e){super({...e,format:"view"})}createBufferTranscoder(){return new YS({encode:e=>{let r=this.encode(e);return dq.from(r.buffer,r.byteOffset,r.byteLength)},decode:this.decode,name:`${this.name}+buffer`})}createViewTranscoder(){return this}},cq=class extends uq{constructor(e){super({...e,format:"utf8"})}createBufferTranscoder(){return new YS({encode:e=>dq.from(this.encode(e),"utf8"),decode:e=>this.decode(e.toString("utf8")),name:`${this.name}+buffer`})}createViewTranscoder(){let{textEncoder:e,textDecoder:r}=yWe();return new ZS({encode:n=>e.encode(this.encode(n)),decode:n=>this.decode(r.decode(n)),name:`${this.name}+view`})}createUTF8Transcoder(){return this}};VP.BufferFormat=YS;VP.ViewFormat=ZS;VP.UTF8Format=cq});var Hpe=W(Hv=>{"use strict";f();var{Buffer:pa}=bn()||{Buffer:{isBuffer:()=>!1}},{textEncoder:zpe,textDecoder:Fpe}=iq()(),{BufferFormat:XS,ViewFormat:fq,UTF8Format:Vpe}=lq(),HP=t=>t;Hv.utf8=new Vpe({encode:function(t){return pa.isBuffer(t)?t.toString("utf8"):ArrayBuffer.isView(t)?Fpe.decode(t):String(t)},decode:HP,name:"utf8",createViewTranscoder(){return new fq({encode:function(t){return ArrayBuffer.isView(t)?t:zpe.encode(t)},decode:function(t){return Fpe.decode(t)},name:`${this.name}+view`})},createBufferTranscoder(){return new XS({encode:function(t){return pa.isBuffer(t)?t:ArrayBuffer.isView(t)?pa.from(t.buffer,t.byteOffset,t.byteLength):pa.from(String(t),"utf8")},decode:function(t){return t.toString("utf8")},name:`${this.name}+buffer`})}});Hv.json=new Vpe({encode:JSON.stringify,decode:JSON.parse,name:"json"});Hv.buffer=new XS({encode:function(t){return pa.isBuffer(t)?t:ArrayBuffer.isView(t)?pa.from(t.buffer,t.byteOffset,t.byteLength):pa.from(String(t),"utf8")},decode:HP,name:"buffer",createViewTranscoder(){return new fq({encode:function(t){return ArrayBuffer.isView(t)?t:pa.from(String(t),"utf8")},decode:function(t){return pa.from(t.buffer,t.byteOffset,t.byteLength)},name:`${this.name}+view`})}});Hv.view=new fq({encode:function(t){return ArrayBuffer.isView(t)?t:zpe.encode(t)},decode:HP,name:"view",createBufferTranscoder(){return new XS({encode:function(t){return pa.isBuffer(t)?t:ArrayBuffer.isView(t)?pa.from(t.buffer,t.byteOffset,t.byteLength):pa.from(String(t),"utf8")},decode:HP,name:`${this.name}+buffer`})}});Hv.hex=new XS({encode:function(t){return pa.isBuffer(t)?t:pa.from(String(t),"hex")},decode:function(t){return t.toString("hex")},name:"hex"});Hv.base64=new XS({encode:function(t){return pa.isBuffer(t)?t:pa.from(String(t),"base64")},decode:function(t){return t.toString("base64")},name:"base64"})});var Jpe=W(Gpe=>{"use strict";f();var Wpe=dl(),GP=Hpe(),{Encoding:mWe}=aq(),{BufferFormat:gWe,ViewFormat:vWe,UTF8Format:bWe}=lq(),QS=Symbol("formats"),WP=Symbol("encodings"),wWe=new Set(["buffer","view","utf8"]),hq=class{constructor(e){if(Array.isArray(e)){if(!e.every(r=>wWe.has(r)))throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}else throw new TypeError("The first argument 'formats' must be an array");this[WP]=new Map,this[QS]=new Set(e);for(let r in GP)try{this.encoding(r)}catch(n){if(n.code!=="LEVEL_ENCODING_NOT_SUPPORTED")throw n}}encodings(){return Array.from(new Set(this[WP].values()))}encoding(e){let r=this[WP].get(e);if(r===void 0){if(typeof e=="string"&&e!==""){if(r=SWe[e],!r)throw new Wpe(`Encoding '${e}' is not found`,{code:"LEVEL_ENCODING_NOT_FOUND"})}else{if(typeof e!="object"||e===null)throw new TypeError("First argument 'encoding' must be a string or object");r=_We(e)}let{name:n,format:i}=r;if(!this[QS].has(i))if(this[QS].has("view"))r=r.createViewTranscoder();else if(this[QS].has("buffer"))r=r.createBufferTranscoder();else if(this[QS].has("utf8"))r=r.createUTF8Transcoder();else throw new Wpe(`Encoding '${n}' cannot be transcoded`,{code:"LEVEL_ENCODING_NOT_SUPPORTED"});for(let o of[e,n,r.name,r.commonName])this[WP].set(o,r)}return r}};Gpe.Transcoder=hq;function _We(t){if(t instanceof mWe)return t;let e="type"in t&&typeof t.type=="string"?t.type:void 0,r=t.name||e||`anonymous-${TWe++}`;switch(xWe(t)){case"view":return new vWe({...t,name:r});case"utf8":return new bWe({...t,name:r});case"buffer":return new gWe({...t,name:r});default:throw new TypeError("Format must be one of 'buffer', 'view', 'utf8'")}}function xWe(t){return"format"in t&&t.format!==void 0?t.format:"buffer"in t&&typeof t.buffer=="boolean"?t.buffer?"buffer":"utf8":"code"in t&&Number.isInteger(t.code)?"view":"buffer"}var EWe={binary:GP.buffer,"utf-8":GP.utf8},SWe={...GP,...EWe},TWe=0});var Zpe=W((sPt,Ype)=>{f();Ype.exports=typeof queueMicrotask=="function"?queueMicrotask:t=>Promise.resolve().then(t)});var e5=W(pq=>{"use strict";f();var Xpe=Zpe();pq.fromCallback=function(t,e){if(t===void 0){var r=new Promise(function(n,i){t=function(o,s){o?i(o):n(s)}});t[e!==void 0?e:"promise"]=r}else if(typeof t!="function")throw new TypeError("Callback must be a function");return t};pq.fromPromise=function(t,e){if(e===void 0)return t;t.then(function(r){Xpe(()=>e(null,r))}).catch(function(r){Xpe(()=>e(r))})}});var JP=W(yq=>{"use strict";f();yq.getCallback=function(t,e){return typeof t=="function"?t:e};yq.getOptions=function(t,e){return typeof t=="object"&&t!==null?t:e!==void 0?e:{}}});var zm=W(QP=>{"use strict";f();var{fromCallback:mq}=e5(),nd=dl(),{getOptions:gq,getCallback:Qpe}=JP(),Wv=Symbol("promise"),N2=Symbol("callback"),Of=Symbol("working"),Gv=Symbol("handleOne"),lp=Symbol("handleMany"),vq=Symbol("autoClose"),Lm=Symbol("finishWork"),Mf=Symbol("returnMany"),Um=Symbol("closing"),t5=Symbol("handleClose"),YP=Symbol("closed"),r5=Symbol("closeCallbacks"),qm=Symbol("keyEncoding"),Jv=Symbol("valueEncoding"),bq=Symbol("abortOnClose"),ZP=Symbol("legacy"),wq=Symbol("keys"),_q=Symbol("values"),Km=Symbol("limit"),tu=Symbol("count"),XP=Object.freeze({}),AWe=()=>{},eye=!1,n5=class{constructor(e,r,n){if(typeof e!="object"||e===null){let i=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${i}`)}if(typeof r!="object"||r===null)throw new TypeError("The second argument must be an options object");this[YP]=!1,this[r5]=[],this[Of]=!1,this[Um]=!1,this[vq]=!1,this[N2]=null,this[Gv]=this[Gv].bind(this),this[lp]=this[lp].bind(this),this[t5]=this[t5].bind(this),this[qm]=r[qm],this[Jv]=r[Jv],this[ZP]=n,this[Km]=Number.isInteger(r.limit)&&r.limit>=0?r.limit:1/0,this[tu]=0,this[bq]=!!r.abortOnClose,this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get count(){return this[tu]}get limit(){return this[Km]}next(e){let r;if(e===void 0)r=new Promise((n,i)=>{e=(o,s,a)=>{o?i(o):this[ZP]?s===void 0&&a===void 0?n():n([s,a]):n(s)}});else if(typeof e!="function")throw new TypeError("Callback must be a function");return this[Um]?this.nextTick(e,new nd("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Of]?this.nextTick(e,new nd("Iterator is busy: cannot call next() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[Of]=!0,this[N2]=e,this[tu]>=this[Km]?this.nextTick(this[Gv],null):this._next(this[Gv])),r}_next(e){this.nextTick(e)}nextv(e,r,n){return n=Qpe(r,n),n=mq(n,Wv),r=gq(r,XP),Number.isInteger(e)?(this[Um]?this.nextTick(n,new nd("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Of]?this.nextTick(n,new nd("Iterator is busy: cannot call nextv() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(e<1&&(e=1),this[Km]<1/0&&(e=Math.min(e,this[Km]-this[tu])),this[Of]=!0,this[N2]=n,e<=0?this.nextTick(this[lp],null,[]):this._nextv(e,r,this[lp])),n[Wv]):(this.nextTick(n,new TypeError("The first argument 'size' must be an integer")),n[Wv])}_nextv(e,r,n){let i=[],o=(s,a,d)=>{if(s)return n(s);if(this[ZP]?a===void 0&&d===void 0:a===void 0)return n(null,i);i.push(this[ZP]?[a,d]:a),i.length===e?n(null,i):this._next(o)};this._next(o)}all(e,r){return r=Qpe(e,r),r=mq(r,Wv),e=gq(e,XP),this[Um]?this.nextTick(r,new nd("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this[Of]?this.nextTick(r,new nd("Iterator is busy: cannot call all() until previous call has completed",{code:"LEVEL_ITERATOR_BUSY"})):(this[Of]=!0,this[N2]=r,this[vq]=!0,this[tu]>=this[Km]?this.nextTick(this[lp],null,[]):this._all(e,this[lp])),r[Wv]}_all(e,r){let n=this[tu],i=[],o=()=>{let a=this[Km]<1/0?Math.min(1e3,this[Km]-n):1e3;a<=0?this.nextTick(r,null,i):this._nextv(a,XP,s)},s=(a,d)=>{a?r(a):d.length===0?r(null,i):(i.push.apply(i,d),n+=d.length,o())};o()}[Lm](){let e=this[N2];return this[bq]&&e===null?AWe:(this[Of]=!1,this[N2]=null,this[Um]&&this._close(this[t5]),e)}[Mf](e,r,n){this[vq]?this.close(e.bind(null,r,n)):e(r,n)}seek(e,r){if(r=gq(r,XP),!this[Um]){if(this[Of])throw new nd("Iterator is busy: cannot call seek() until next() has completed",{code:"LEVEL_ITERATOR_BUSY"});{let n=this.db.keyEncoding(r.keyEncoding||this[qm]),i=n.format;r.keyEncoding!==i&&(r={...r,keyEncoding:i});let o=this.db.prefixKey(n.encode(e),i);this._seek(o,r)}}}_seek(e,r){throw new nd("Iterator does not support seek()",{code:"LEVEL_NOT_SUPPORTED"})}close(e){return e=mq(e,Wv),this[YP]?this.nextTick(e):this[Um]?this[r5].push(e):(this[Um]=!0,this[r5].push(e),this[Of]?this[bq]&&this[Lm]()(new nd("Aborted on iterator close()",{code:"LEVEL_ITERATOR_NOT_OPEN"})):this._close(this[t5])),e[Wv]}_close(e){this.nextTick(e)}[t5](){this[YP]=!0,this.db.detachResource(this);let e=this[r5];this[r5]=[];for(let r of e)r()}async*[Symbol.asyncIterator](){try{let e;for(;(e=await this.next())!==void 0;)yield e}finally{this[YP]||await this.close()}}},U2=class extends n5{constructor(e,r){super(e,r,!0),this[wq]=r.keys!==!1,this[_q]=r.values!==!1}[Gv](e,r,n){let i=this[Lm]();if(e)return i(e);try{r=this[wq]&&r!==void 0?this[qm].decode(r):void 0,n=this[_q]&&n!==void 0?this[Jv].decode(n):void 0}catch(o){return i(new Fm("entry",o))}r===void 0&&n===void 0||this[tu]++,i(null,r,n)}[lp](e,r){let n=this[Lm]();if(e)return this[Mf](n,e);try{for(let i of r){let o=i[0],s=i[1];i[0]=this[wq]&&o!==void 0?this[qm].decode(o):void 0,i[1]=this[_q]&&s!==void 0?this[Jv].decode(s):void 0}}catch(i){return this[Mf](n,new Fm("entries",i))}this[tu]+=r.length,this[Mf](n,null,r)}end(e){return!eye&&typeof console<"u"&&(eye=!0,console.warn(new nd("The iterator.end() method was renamed to close() and end() is an alias that will be removed in a future version",{code:"LEVEL_LEGACY"}))),this.close(e)}},xq=class extends n5{constructor(e,r){super(e,r,!1)}[Gv](e,r){let n=this[Lm]();if(e)return n(e);try{r=r!==void 0?this[qm].decode(r):void 0}catch(i){return n(new Fm("key",i))}r!==void 0&&this[tu]++,n(null,r)}[lp](e,r){let n=this[Lm]();if(e)return this[Mf](n,e);try{for(let i=0;i<r.length;i++){let o=r[i];r[i]=o!==void 0?this[qm].decode(o):void 0}}catch(i){return this[Mf](n,new Fm("keys",i))}this[tu]+=r.length,this[Mf](n,null,r)}},Eq=class extends n5{constructor(e,r){super(e,r,!1)}[Gv](e,r){let n=this[Lm]();if(e)return n(e);try{r=r!==void 0?this[Jv].decode(r):void 0}catch(i){return n(new Fm("value",i))}r!==void 0&&this[tu]++,n(null,r)}[lp](e,r){let n=this[Lm]();if(e)return this[Mf](n,e);try{for(let i=0;i<r.length;i++){let o=r[i];r[i]=o!==void 0?this[Jv].decode(o):void 0}}catch(i){return this[Mf](n,new Fm("values",i))}this[tu]+=r.length,this[Mf](n,null,r)}},Fm=class extends nd{constructor(e,r){super(`Iterator could not decode ${e}`,{code:"LEVEL_DECODE_ERROR",cause:r})}};for(let t of["_ended property","_nexting property","_end method"])Object.defineProperty(U2.prototype,t.split(" ")[0],{get(){throw new nd(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})},set(){throw new nd(`The ${t} has been removed`,{code:"LEVEL_LEGACY"})}});U2.keyEncoding=qm;U2.valueEncoding=Jv;QP.AbstractIterator=U2;QP.AbstractKeyIterator=xq;QP.AbstractValueIterator=Eq});var tye=W(Sq=>{"use strict";f();var{AbstractKeyIterator:kWe,AbstractValueIterator:PWe}=zm(),Yv=Symbol("iterator"),i5=Symbol("callback"),K2=Symbol("handleOne"),Zv=Symbol("handleMany"),o5=class extends kWe{constructor(e,r){super(e,r),this[Yv]=e.iterator({...r,keys:!0,values:!1}),this[K2]=this[K2].bind(this),this[Zv]=this[Zv].bind(this)}},eI=class extends PWe{constructor(e,r){super(e,r),this[Yv]=e.iterator({...r,keys:!1,values:!0}),this[K2]=this[K2].bind(this),this[Zv]=this[Zv].bind(this)}};for(let t of[o5,eI]){let e=t===o5,r=e?n=>n[0]:n=>n[1];t.prototype._next=function(n){this[i5]=n,this[Yv].next(this[K2])},t.prototype[K2]=function(n,i,o){let s=this[i5];n?s(n):s(null,e?i:o)},t.prototype._nextv=function(n,i,o){this[i5]=o,this[Yv].nextv(n,i,this[Zv])},t.prototype._all=function(n,i){this[i5]=i,this[Yv].all(n,this[Zv])},t.prototype[Zv]=function(n,i){let o=this[i5];n?o(n):o(null,i.map(r))},t.prototype._seek=function(n,i){this[Yv].seek(n,i)},t.prototype._close=function(n){this[Yv].close(n)}}Sq.DefaultKeyIterator=o5;Sq.DefaultValueIterator=eI});var rye=W(sI=>{"use strict";f();var{AbstractIterator:IWe,AbstractKeyIterator:RWe,AbstractValueIterator:BWe}=zm(),Tq=dl(),bc=Symbol("nut"),iI=Symbol("undefer"),oI=Symbol("factory"),tI=class extends IWe{constructor(e,r){super(e,r),this[bc]=null,this[oI]=()=>e.iterator(r),this.db.defer(()=>this[iI]())}},rI=class extends RWe{constructor(e,r){super(e,r),this[bc]=null,this[oI]=()=>e.keys(r),this.db.defer(()=>this[iI]())}},nI=class extends BWe{constructor(e,r){super(e,r),this[bc]=null,this[oI]=()=>e.values(r),this.db.defer(()=>this[iI]())}};for(let t of[tI,rI,nI])t.prototype[iI]=function(){this.db.status==="open"&&(this[bc]=this[oI]())},t.prototype._next=function(e){this[bc]!==null?this[bc].next(e):this.db.status==="opening"?this.db.defer(()=>this._next(e)):this.nextTick(e,new Tq("Iterator is not open: cannot call next() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._nextv=function(e,r,n){this[bc]!==null?this[bc].nextv(e,r,n):this.db.status==="opening"?this.db.defer(()=>this._nextv(e,r,n)):this.nextTick(n,new Tq("Iterator is not open: cannot call nextv() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._all=function(e,r){this[bc]!==null?this[bc].all(r):this.db.status==="opening"?this.db.defer(()=>this._all(e,r)):this.nextTick(r,new Tq("Iterator is not open: cannot call all() after close()",{code:"LEVEL_ITERATOR_NOT_OPEN"}))},t.prototype._seek=function(e,r){this[bc]!==null?this[bc]._seek(e,r):this.db.status==="opening"&&this.db.defer(()=>this._seek(e,r))},t.prototype._close=function(e){this[bc]!==null?this[bc].close(e):this.db.status==="opening"?this.db.defer(()=>this._close(e)):this.nextTick(e)};sI.DeferredIterator=tI;sI.DeferredKeyIterator=rI;sI.DeferredValueIterator=nI});var kq=W(iye=>{"use strict";f();var{fromCallback:nye}=e5(),aI=dl(),{getCallback:OWe,getOptions:MWe}=JP(),cI=Symbol("promise"),ru=Symbol("status"),q2=Symbol("operations"),s5=Symbol("finishClose"),L2=Symbol("closeCallbacks"),Aq=class{constructor(e){if(typeof e!="object"||e===null){let r=e===null?"null":typeof e;throw new TypeError(`The first argument must be an abstract-level database, received ${r}`)}this[q2]=[],this[L2]=[],this[ru]="open",this[s5]=this[s5].bind(this),this.db=e,this.db.attachResource(this),this.nextTick=e.nextTick}get length(){return this[q2].length}put(e,r,n){if(this[ru]!=="open")throw new aI("Batch is not open: cannot call put() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});let i=this.db._checkKey(e)||this.db._checkValue(r);if(i)throw i;let o=n&&n.sublevel!=null?n.sublevel:this.db,s=n,a=o.keyEncoding(n&&n.keyEncoding),d=o.valueEncoding(n&&n.valueEncoding),u=a.format;n={...n,keyEncoding:u,valueEncoding:d.format},o!==this.db&&(n.sublevel=null);let c=o.prefixKey(a.encode(e),u),l=d.encode(r);return this._put(c,l,n),this[q2].push({...s,type:"put",key:e,value:r}),this}_put(e,r,n){}del(e,r){if(this[ru]!=="open")throw new aI("Batch is not open: cannot call del() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});let n=this.db._checkKey(e);if(n)throw n;let i=r&&r.sublevel!=null?r.sublevel:this.db,o=r,s=i.keyEncoding(r&&r.keyEncoding),a=s.format;return r={...r,keyEncoding:a},i!==this.db&&(r.sublevel=null),this._del(i.prefixKey(s.encode(e),a),r),this[q2].push({...o,type:"del",key:e}),this}_del(e,r){}clear(){if(this[ru]!=="open")throw new aI("Batch is not open: cannot call clear() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"});return this._clear(),this[q2]=[],this}_clear(){}write(e,r){return r=OWe(e,r),r=nye(r,cI),e=MWe(e),this[ru]!=="open"?this.nextTick(r,new aI("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"})):this.length===0?this.close(r):(this[ru]="writing",this._write(e,n=>{this[ru]="closing",this[L2].push(()=>r(n)),n||this.db.emit("batch",this[q2]),this._close(this[s5])})),r[cI]}_write(e,r){}close(e){return e=nye(e,cI),this[ru]==="closing"?this[L2].push(e):this[ru]==="closed"?this.nextTick(e):(this[L2].push(e),this[ru]!=="writing"&&(this[ru]="closing",this._close(this[s5]))),e[cI]}_close(e){this.nextTick(e)}[s5](){this[ru]="closed",this.db.detachResource(this);let e=this[L2];this[L2]=[];for(let r of e)r()}};iye.AbstractChainedBatch=Aq});var sye=W(oye=>{"use strict";f();var{AbstractChainedBatch:DWe}=kq(),CWe=dl(),F2=Symbol("encoded"),Pq=class extends DWe{constructor(e){super(e),this[F2]=[]}_put(e,r,n){this[F2].push({...n,type:"put",key:e,value:r})}_del(e,r){this[F2].push({...r,type:"del",key:e})}_clear(){this[F2]=[]}_write(e,r){this.db.status==="opening"?this.db.defer(()=>this._write(e,r)):this.db.status==="open"?this[F2].length===0?this.nextTick(r):this.db._batch(this[F2],e,r):this.nextTick(r,new CWe("Batch is not open: cannot call write() after write() or close()",{code:"LEVEL_BATCH_NOT_OPEN"}))}};oye.DefaultChainedBatch=Pq});var dye=W((xPt,cye)=>{"use strict";f();var aye=dl(),jWe=Object.prototype.hasOwnProperty,$We=new Set(["lt","lte","gt","gte"]);cye.exports=function(t,e){let r={};for(let n in t)if(jWe.call(t,n)&&!(n==="keyEncoding"||n==="valueEncoding")){if(n==="start"||n==="end")throw new aye(`The legacy range option '${n}' has been removed`,{code:"LEVEL_LEGACY"});if(n==="encoding")throw new aye("The levelup-style 'encoding' alias has been removed, use 'valueEncoding' instead",{code:"LEVEL_LEGACY"});$We.has(n)?r[n]=e.encode(t[n]):r[n]=t[n]}return r.reverse=!!r.reverse,r.limit=Number.isInteger(r.limit)&&r.limit>=0?r.limit:-1,r}});var Iq=W((SPt,lye)=>{f();var uye;lye.exports=typeof queueMicrotask=="function"?queueMicrotask.bind(typeof window<"u"?window:globalThis):t=>(uye||(uye=Promise.resolve())).then(t).catch(e=>setTimeout(()=>{throw e},0))});var pye=W((APt,hye)=>{"use strict";f();var fye=Iq();hye.exports=function(t,...e){e.length===0?fye(t):fye(()=>t(...e))}});var yye=W(dI=>{"use strict";f();var{AbstractIterator:NWe,AbstractKeyIterator:UWe,AbstractValueIterator:KWe}=zm(),z2=Symbol("unfix"),ul=Symbol("iterator"),Xv=Symbol("handleOne"),Vm=Symbol("handleMany"),fp=Symbol("callback"),a5=class extends NWe{constructor(e,r,n,i){super(e,r),this[ul]=n,this[z2]=i,this[Xv]=this[Xv].bind(this),this[Vm]=this[Vm].bind(this),this[fp]=null}[Xv](e,r,n){let i=this[fp];if(e)return i(e);r!==void 0&&(r=this[z2](r)),i(e,r,n)}[Vm](e,r){let n=this[fp];if(e)return n(e);for(let i of r){let o=i[0];o!==void 0&&(i[0]=this[z2](o))}n(e,r)}},c5=class extends UWe{constructor(e,r,n,i){super(e,r),this[ul]=n,this[z2]=i,this[Xv]=this[Xv].bind(this),this[Vm]=this[Vm].bind(this),this[fp]=null}[Xv](e,r){let n=this[fp];if(e)return n(e);r!==void 0&&(r=this[z2](r)),n(e,r)}[Vm](e,r){let n=this[fp];if(e)return n(e);for(let i=0;i<r.length;i++){let o=r[i];o!==void 0&&(r[i]=this[z2](o))}n(e,r)}},d5=class extends KWe{constructor(e,r,n){super(e,r),this[ul]=n}};for(let t of[a5,c5])t.prototype._next=function(e){this[fp]=e,this[ul].next(this[Xv])},t.prototype._nextv=function(e,r,n){this[fp]=n,this[ul].nextv(e,r,this[Vm])},t.prototype._all=function(e,r){this[fp]=r,this[ul].all(e,this[Vm])};for(let t of[d5])t.prototype._next=function(e){this[ul].next(e)},t.prototype._nextv=function(e,r,n){this[ul].nextv(e,r,n)},t.prototype._all=function(e,r){this[ul].all(e,r)};for(let t of[a5,c5,d5])t.prototype._seek=function(e,r){this[ul].seek(e,r)},t.prototype._close=function(e){this[ul].close(e)};dI.AbstractSublevelIterator=a5;dI.AbstractSublevelKeyIterator=c5;dI.AbstractSublevelValueIterator=d5});var bye=W((RPt,vye)=>{"use strict";f();var Rq=dl(),{Buffer:Mq}=bn()||{},{AbstractSublevelIterator:qWe,AbstractSublevelKeyIterator:LWe,AbstractSublevelValueIterator:FWe}=yye(),hp=Symbol("prefix"),mye=Symbol("upperBound"),u5=Symbol("prefixRange"),id=Symbol("parent"),Bq=Symbol("unfix"),gye=new TextEncoder,zWe={separator:"!"};vye.exports=function({AbstractLevel:t}){class e extends t{static defaults(n){if(typeof n=="string")throw new Rq("The subleveldown string shorthand for { separator } has been removed",{code:"LEVEL_LEGACY"});if(n&&n.open)throw new Rq("The subleveldown open option has been removed",{code:"LEVEL_LEGACY"});return n==null?zWe:n.separator?n:{...n,separator:"!"}}constructor(n,i,o){let{separator:s,manifest:a,...d}=e.defaults(o);i=HWe(i,s);let u=s.charCodeAt(0)+1,c=n[id]||n;if(!gye.encode(i).every(y=>y>u&&y<127))throw new Rq(`Prefix must use bytes > ${u} < 127`,{code:"LEVEL_INVALID_PREFIX"});super(VWe(c,a),d);let l=(n.prefix||"")+s+i+s,h=l.slice(0,-1)+String.fromCharCode(u);this[id]=c,this[hp]=new uI(l),this[mye]=new uI(h),this[Bq]=new Dq,this.nextTick=c.nextTick}prefixKey(n,i){if(i==="utf8")return this[hp].utf8+n;if(n.byteLength===0)return this[hp][i];if(i==="view"){let o=this[hp].view,s=new Uint8Array(o.byteLength+n.byteLength);return s.set(o,0),s.set(n,o.byteLength),s}else{let o=this[hp].buffer;return Mq.concat([o,n],o.byteLength+n.byteLength)}}[u5](n,i){n.gte!==void 0?n.gte=this.prefixKey(n.gte,i):n.gt!==void 0?n.gt=this.prefixKey(n.gt,i):n.gte=this[hp][i],n.lte!==void 0?n.lte=this.prefixKey(n.lte,i):n.lt!==void 0?n.lt=this.prefixKey(n.lt,i):n.lte=this[mye][i]}get prefix(){return this[hp].utf8}get db(){return this[id]}_open(n,i){this[id].open({passive:!0},i)}_put(n,i,o,s){this[id].put(n,i,o,s)}_get(n,i,o){this[id].get(n,i,o)}_getMany(n,i,o){this[id].getMany(n,i,o)}_del(n,i,o){this[id].del(n,i,o)}_batch(n,i,o){this[id].batch(n,i,o)}_clear(n,i){this[u5](n,n.keyEncoding),this[id].clear(n,i)}_iterator(n){this[u5](n,n.keyEncoding);let i=this[id].iterator(n),o=this[Bq].get(this[hp].utf8.length,n.keyEncoding);return new qWe(this,n,i,o)}_keys(n){this[u5](n,n.keyEncoding);let i=this[id].keys(n),o=this[Bq].get(this[hp].utf8.length,n.keyEncoding);return new LWe(this,n,i,o)}_values(n){this[u5](n,n.keyEncoding);let i=this[id].values(n);return new FWe(this,n,i)}}return{AbstractSublevel:e}};var VWe=function(t,e){return{...t.supports,createIfMissing:!1,errorIfExists:!1,events:{},additionalMethods:{},...e,encodings:{utf8:Oq(t,"utf8"),buffer:Oq(t,"buffer"),view:Oq(t,"view")}}},Oq=function(t,e){return t.supports.encodings[e]?t.keyEncoding(e).name===e:!1},uI=class{constructor(e){this.utf8=e,this.view=gye.encode(e),this.buffer=Mq?Mq.from(this.view.buffer,0,this.view.byteLength):{}}},Dq=class{constructor(){this.cache=new Map}get(e,r){let n=this.cache.get(r);return n===void 0&&(r==="view"?n=(function(i,o){return o.subarray(i)}).bind(null,e):n=(function(i,o){return o.slice(i)}).bind(null,e),this.cache.set(r,n)),n}},HWe=function(t,e){let r=0,n=t.length;for(;r<n&&t[r]===e;)r++;for(;n>r&&t[n-1]===e;)n--;return t.slice(r,n)}});var Uq=W(Nq=>{"use strict";f();var{supports:WWe}=Upe(),{Transcoder:GWe}=Jpe(),{EventEmitter:JWe}=Ba(),{fromCallback:Hm}=e5(),ll=dl(),{AbstractIterator:Qv}=zm(),{DefaultKeyIterator:YWe,DefaultValueIterator:ZWe}=tye(),{DeferredIterator:XWe,DeferredKeyIterator:QWe,DeferredValueIterator:eGe}=rye(),{DefaultChainedBatch:wye}=sye(),{getCallback:eb,getOptions:Wm}=JP(),lI=dye(),vr=Symbol("promise"),pp=Symbol("landed"),tb=Symbol("resources"),Cq=Symbol("closeResources"),l5=Symbol("operations"),f5=Symbol("undefer"),fI=Symbol("deferOpen"),_ye=Symbol("options"),jr=Symbol("status"),rb=Symbol("defaultOptions"),V2=Symbol("transcoder"),hI=Symbol("keyEncoding"),jq=Symbol("valueEncoding"),tGe=()=>{},h5=class extends JWe{constructor(e,r){if(super(),typeof e!="object"||e===null)throw new TypeError("The first argument 'manifest' must be an object");r=Wm(r);let{keyEncoding:n,valueEncoding:i,passive:o,...s}=r;this[tb]=new Set,this[l5]=[],this[fI]=!0,this[_ye]=s,this[jr]="opening",this.supports=WWe(e,{status:!0,promises:!0,clear:!0,getMany:!0,deferredOpen:!0,snapshots:e.snapshots!==!1,permanence:e.permanence!==!1,keyIterator:!0,valueIterator:!0,iteratorNextv:!0,iteratorAll:!0,encodings:e.encodings||{},events:Object.assign({},e.events,{opening:!0,open:!0,closing:!0,closed:!0,put:!0,del:!0,batch:!0,clear:!0})}),this[V2]=new GWe(rGe(this)),this[hI]=this[V2].encoding(n||"utf8"),this[jq]=this[V2].encoding(i||"utf8");for(let a of this[V2].encodings())this.supports.encodings[a.commonName]||(this.supports.encodings[a.commonName]=!0);this[rb]={empty:Object.freeze({}),entry:Object.freeze({keyEncoding:this[hI].commonName,valueEncoding:this[jq].commonName}),key:Object.freeze({keyEncoding:this[hI].commonName})},this.nextTick(()=>{this[fI]&&this.open({passive:!1},tGe)})}get status(){return this[jr]}keyEncoding(e){return this[V2].encoding(e??this[hI])}valueEncoding(e){return this[V2].encoding(e??this[jq])}open(e,r){r=eb(e,r),r=Hm(r,vr),e={...this[_ye],...Wm(e)},e.createIfMissing=e.createIfMissing!==!1,e.errorIfExists=!!e.errorIfExists;let n=i=>{this[jr]==="closing"||this[jr]==="opening"?this.once(pp,i?()=>n(i):n):this[jr]!=="open"?r(new ll("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN",cause:i})):r()};return e.passive?this[jr]==="opening"?this.once(pp,n):this.nextTick(n):this[jr]==="closed"||this[fI]?(this[fI]=!1,this[jr]="opening",this.emit("opening"),this._open(e,i=>{if(i){this[jr]="closed",this[Cq](()=>{this.emit(pp),n(i)}),this[f5]();return}this[jr]="open",this[f5](),this.emit(pp),this[jr]==="open"&&this.emit("open"),this[jr]==="open"&&this.emit("ready"),n()})):this[jr]==="open"?this.nextTick(n):this.once(pp,()=>this.open(e,r)),r[vr]}_open(e,r){this.nextTick(r)}close(e){e=Hm(e,vr);let r=n=>{this[jr]==="opening"||this[jr]==="closing"?this.once(pp,n?r(n):r):this[jr]!=="closed"?e(new ll("Database is not closed",{code:"LEVEL_DATABASE_NOT_CLOSED",cause:n})):e()};if(this[jr]==="open"){this[jr]="closing",this.emit("closing");let n=i=>{this[jr]="open",this[f5](),this.emit(pp),r(i)};this[Cq](()=>{this._close(i=>{if(i)return n(i);this[jr]="closed",this[f5](),this.emit(pp),this[jr]==="closed"&&this.emit("closed"),r()})})}else this[jr]==="closed"?this.nextTick(r):this.once(pp,()=>this.close(e));return e[vr]}[Cq](e){if(this[tb].size===0)return this.nextTick(e);let r=this[tb].size,n=!0,i=()=>{--r===0&&(n?this.nextTick(e):e())};for(let o of this[tb])o.close(i);n=!1,this[tb].clear()}_close(e){this.nextTick(e)}get(e,r,n){if(n=eb(r,n),n=Hm(n,vr),r=Wm(r,this[rb].entry),this[jr]==="opening")return this.defer(()=>this.get(e,r,n)),n[vr];if(H2(this,n))return n[vr];let i=this._checkKey(e);if(i)return this.nextTick(n,i),n[vr];let o=this.keyEncoding(r.keyEncoding),s=this.valueEncoding(r.valueEncoding),a=o.format,d=s.format;return(r.keyEncoding!==a||r.valueEncoding!==d)&&(r=Object.assign({},r,{keyEncoding:a,valueEncoding:d})),this._get(this.prefixKey(o.encode(e),a),r,(u,c)=>{if(u)return(u.code==="LEVEL_NOT_FOUND"||u.notFound||/NotFound/i.test(u))&&(u.code||(u.code="LEVEL_NOT_FOUND"),u.notFound||(u.notFound=!0),u.status||(u.status=404)),n(u);try{c=s.decode(c)}catch(l){return n(new ll("Could not decode value",{code:"LEVEL_DECODE_ERROR",cause:l}))}n(null,c)}),n[vr]}_get(e,r,n){this.nextTick(n,new Error("NotFound"))}getMany(e,r,n){if(n=eb(r,n),n=Hm(n,vr),r=Wm(r,this[rb].entry),this[jr]==="opening")return this.defer(()=>this.getMany(e,r,n)),n[vr];if(H2(this,n))return n[vr];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'keys' must be an array")),n[vr];if(e.length===0)return this.nextTick(n,null,[]),n[vr];let i=this.keyEncoding(r.keyEncoding),o=this.valueEncoding(r.valueEncoding),s=i.format,a=o.format;(r.keyEncoding!==s||r.valueEncoding!==a)&&(r=Object.assign({},r,{keyEncoding:s,valueEncoding:a}));let d=new Array(e.length);for(let u=0;u<e.length;u++){let c=e[u],l=this._checkKey(c);if(l)return this.nextTick(n,l),n[vr];d[u]=this.prefixKey(i.encode(c),s)}return this._getMany(d,r,(u,c)=>{if(u)return n(u);try{for(let l=0;l<c.length;l++)c[l]!==void 0&&(c[l]=o.decode(c[l]))}catch(l){return n(new ll(`Could not decode one or more of ${c.length} value(s)`,{code:"LEVEL_DECODE_ERROR",cause:l}))}n(null,c)}),n[vr]}_getMany(e,r,n){this.nextTick(n,null,new Array(e.length).fill(void 0))}put(e,r,n,i){if(i=eb(n,i),i=Hm(i,vr),n=Wm(n,this[rb].entry),this[jr]==="opening")return this.defer(()=>this.put(e,r,n,i)),i[vr];if(H2(this,i))return i[vr];let o=this._checkKey(e)||this._checkValue(r);if(o)return this.nextTick(i,o),i[vr];let s=this.keyEncoding(n.keyEncoding),a=this.valueEncoding(n.valueEncoding),d=s.format,u=a.format;(n.keyEncoding!==d||n.valueEncoding!==u)&&(n=Object.assign({},n,{keyEncoding:d,valueEncoding:u}));let c=this.prefixKey(s.encode(e),d),l=a.encode(r);return this._put(c,l,n,h=>{if(h)return i(h);this.emit("put",e,r),i()}),i[vr]}_put(e,r,n,i){this.nextTick(i)}del(e,r,n){if(n=eb(r,n),n=Hm(n,vr),r=Wm(r,this[rb].key),this[jr]==="opening")return this.defer(()=>this.del(e,r,n)),n[vr];if(H2(this,n))return n[vr];let i=this._checkKey(e);if(i)return this.nextTick(n,i),n[vr];let o=this.keyEncoding(r.keyEncoding),s=o.format;return r.keyEncoding!==s&&(r=Object.assign({},r,{keyEncoding:s})),this._del(this.prefixKey(o.encode(e),s),r,a=>{if(a)return n(a);this.emit("del",e),n()}),n[vr]}_del(e,r,n){this.nextTick(n)}batch(e,r,n){if(!arguments.length){if(this[jr]==="opening")return new wye(this);if(this[jr]!=="open")throw new ll("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._chainedBatch()}if(typeof e=="function"?n=e:n=eb(r,n),n=Hm(n,vr),r=Wm(r,this[rb].empty),this[jr]==="opening")return this.defer(()=>this.batch(e,r,n)),n[vr];if(H2(this,n))return n[vr];if(!Array.isArray(e))return this.nextTick(n,new TypeError("The first argument 'operations' must be an array")),n[vr];if(e.length===0)return this.nextTick(n),n[vr];let i=new Array(e.length),{keyEncoding:o,valueEncoding:s,...a}=r;for(let d=0;d<e.length;d++){if(typeof e[d]!="object"||e[d]===null)return this.nextTick(n,new TypeError("A batch operation must be an object")),n[vr];let u=Object.assign({},e[d]);if(u.type!=="put"&&u.type!=="del")return this.nextTick(n,new TypeError("A batch operation must have a type property that is 'put' or 'del'")),n[vr];let c=this._checkKey(u.key);if(c)return this.nextTick(n,c),n[vr];let l=u.sublevel!=null?u.sublevel:this,h=l.keyEncoding(u.keyEncoding||o),y=h.format;if(u.key=l.prefixKey(h.encode(u.key),y),u.keyEncoding=y,u.type==="put"){let g=this._checkValue(u.value);if(g)return this.nextTick(n,g),n[vr];let v=l.valueEncoding(u.valueEncoding||s);u.value=v.encode(u.value),u.valueEncoding=v.format}l!==this&&(u.sublevel=null),i[d]=u}return this._batch(i,a,d=>{if(d)return n(d);this.emit("batch",e),n()}),n[vr]}_batch(e,r,n){this.nextTick(n)}sublevel(e,r){return this._sublevel(e,$q.defaults(r))}_sublevel(e,r){return new $q(this,e,r)}prefixKey(e,r){return e}clear(e,r){if(r=eb(e,r),r=Hm(r,vr),e=Wm(e,this[rb].empty),this[jr]==="opening")return this.defer(()=>this.clear(e,r)),r[vr];if(H2(this,r))return r[vr];let n=e,i=this.keyEncoding(e.keyEncoding);return e=lI(e,i),e.keyEncoding=i.format,e.limit===0?this.nextTick(r):this._clear(e,o=>{if(o)return r(o);this.emit("clear",n),r()}),r[vr]}_clear(e,r){this.nextTick(r)}iterator(e){let r=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=lI(e,r),e.keys=e.keys!==!1,e.values=e.values!==!1,e[Qv.keyEncoding]=r,e[Qv.valueEncoding]=n,e.keyEncoding=r.format,e.valueEncoding=n.format,this[jr]==="opening")return new XWe(this,e);if(this[jr]!=="open")throw new ll("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._iterator(e)}_iterator(e){return new Qv(this,e)}keys(e){let r=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=lI(e,r),e[Qv.keyEncoding]=r,e[Qv.valueEncoding]=n,e.keyEncoding=r.format,e.valueEncoding=n.format,this[jr]==="opening")return new QWe(this,e);if(this[jr]!=="open")throw new ll("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._keys(e)}_keys(e){return new YWe(this,e)}values(e){let r=this.keyEncoding(e&&e.keyEncoding),n=this.valueEncoding(e&&e.valueEncoding);if(e=lI(e,r),e[Qv.keyEncoding]=r,e[Qv.valueEncoding]=n,e.keyEncoding=r.format,e.valueEncoding=n.format,this[jr]==="opening")return new eGe(this,e);if(this[jr]!=="open")throw new ll("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"});return this._values(e)}_values(e){return new ZWe(this,e)}defer(e){if(typeof e!="function")throw new TypeError("The first argument must be a function");this[l5].push(e)}[f5](){if(this[l5].length===0)return;let e=this[l5];this[l5]=[];for(let r of e)r()}attachResource(e){if(typeof e!="object"||e===null||typeof e.close!="function")throw new TypeError("The first argument must be a resource object");this[tb].add(e)}detachResource(e){this[tb].delete(e)}_chainedBatch(){return new wye(this)}_checkKey(e){if(e==null)return new ll("Key cannot be null or undefined",{code:"LEVEL_INVALID_KEY"})}_checkValue(e){if(e==null)return new ll("Value cannot be null or undefined",{code:"LEVEL_INVALID_VALUE"})}};h5.prototype.nextTick=pye();var{AbstractSublevel:$q}=bye()({AbstractLevel:h5});Nq.AbstractLevel=h5;Nq.AbstractSublevel=$q;var H2=function(t,e){return t[jr]!=="open"?(t.nextTick(e,new ll("Database is not open",{code:"LEVEL_DATABASE_NOT_OPEN"})),!0):!1},rGe=function(t){return Object.keys(t.supports.encodings).filter(e=>!!t.supports.encodings[e])}});var Kq=W(nb=>{"use strict";f();nb.AbstractLevel=Uq().AbstractLevel;nb.AbstractSublevel=Uq().AbstractSublevel;nb.AbstractIterator=zm().AbstractIterator;nb.AbstractKeyIterator=zm().AbstractKeyIterator;nb.AbstractValueIterator=zm().AbstractValueIterator;nb.AbstractChainedBatch=kq().AbstractChainedBatch});var Eye=W((jPt,xye)=>{f();xye.exports=iGe;var nGe=Iq();function iGe(t,e,r){if(typeof e!="number")throw new Error("second argument must be a Number");let n,i,o,s,a,d=!0,u;Array.isArray(t)?(n=[],o=i=t.length):(s=Object.keys(t),n={},o=i=s.length);function c(h){function y(){r&&r(h,n),r=null}d?nGe(y):y()}function l(h,y,g){if(n[h]=g,y&&(a=!0),--o===0||y)c(y);else if(!a&&u<i){let v;s?(v=s[u],u+=1,t[v](function(x,S){l(v,x,S)})):(v=u,u+=1,t[v](function(x,S){l(v,x,S)}))}}u=e,o?s?s.some(function(h,y){return t[h](function(g,v){l(h,g,v)}),y===e-1}):t.some(function(h,y){return h(function(g,v){l(y,g,v)}),y===e-1}):c(null),d=!1}});var qq=W((NPt,Sye)=>{"use strict";f();Sye.exports=function(e){let r=e.gte!==void 0?e.gte:e.gt!==void 0?e.gt:void 0,n=e.lte!==void 0?e.lte:e.lt!==void 0?e.lt:void 0,i=e.gte===void 0,o=e.lte===void 0;return r!==void 0&&n!==void 0?IDBKeyRange.bound(r,n,i,o):r!==void 0?IDBKeyRange.lowerBound(r,i):n!==void 0?IDBKeyRange.upperBound(n,o):null}});var Lq=W((KPt,Tye)=>{"use strict";f();var oGe=new TextEncoder;Tye.exports=function(t){return t instanceof Uint8Array?t:t instanceof ArrayBuffer?new Uint8Array(t):oGe.encode(t)}});var Rye=W(Iye=>{"use strict";f();var{AbstractIterator:sGe}=Kq(),Aye=qq(),pI=Lq(),Df=Symbol("cache"),yp=Symbol("finished"),od=Symbol("options"),mp=Symbol("currentOptions"),ib=Symbol("position"),Fq=Symbol("location"),W2=Symbol("first"),kye={},zq=class extends sGe{constructor(e,r,n){super(e,n),this[Df]=[],this[yp]=this.limit===0,this[od]=n,this[mp]={...n},this[ib]=void 0,this[Fq]=r,this[W2]=!0}_nextv(e,r,n){if(this[W2]=!1,this[yp])return this.nextTick(n,null,[]);if(this[Df].length>0)return e=Math.min(e,this[Df].length),this.nextTick(n,null,this[Df].splice(0,e));this[ib]!==void 0&&(this[od].reverse?(this[mp].lt=this[ib],this[mp].lte=void 0):(this[mp].gt=this[ib],this[mp].gte=void 0));let i;try{i=Aye(this[mp])}catch{return this[yp]=!0,this.nextTick(n,null,[])}let o=this.db.db.transaction([this[Fq]],"readonly"),s=o.objectStore(this[Fq]),a=[];if(this[od].reverse){let d=!this[od].values&&s.openKeyCursor?"openKeyCursor":"openCursor";s[d](i,"prev").onsuccess=u=>{let c=u.target.result;if(c){let{key:l,value:h}=c;this[ib]=l,a.push([this[od].keys&&l!==void 0?pI(l):void 0,this[od].values&&h!==void 0?pI(h):void 0]),a.length<e?c.continue():Pye(o)}else this[yp]=!0}}else{let d,u,c=()=>{if(d===void 0||u===void 0)return;let l=Math.max(d.length,u.length);l===0||e===1/0?this[yp]=!0:this[ib]=d[l-1],a.length=l;for(let h=0;h<l;h++){let y=d[h],g=u[h];a[h]=[this[od].keys&&y!==void 0?pI(y):void 0,this[od].values&&g!==void 0?pI(g):void 0]}Pye(o)};this[od].keys||e<1/0?s.getAllKeys(i,e<1/0?e:void 0).onsuccess=l=>{d=l.target.result,c()}:(d=[],this.nextTick(c)),this[od].values?s.getAll(i,e<1/0?e:void 0).onsuccess=l=>{u=l.target.result,c()}:(u=[],this.nextTick(c))}o.onabort=()=>{n(o.error||new Error("aborted by user")),n=null},o.oncomplete=()=>{n(null,a),n=null}}_next(e){if(this[Df].length>0){let[r,n]=this[Df].shift();this.nextTick(e,null,r,n)}else if(this[yp])this.nextTick(e);else{let r=Math.min(100,this.limit-this.count);this[W2]&&(this[W2]=!1,r=1),this._nextv(r,kye,(n,i)=>{if(n)return e(n);this[Df]=i,this._next(e)})}}_all(e,r){this[W2]=!1;let n=this[Df].splice(0,this[Df].length),i=this.limit-this.count-n.length;if(i<=0)return this.nextTick(r,null,n);this._nextv(i,kye,(o,s)=>{if(o)return r(o);n.length>0&&(s=n.concat(s)),r(null,s)})}_seek(e,r){this[W2]=!0,this[Df]=[],this[yp]=!1,this[ib]=void 0,this[mp]={...this[od]};let n;try{n=Aye(this[od])}catch{this[yp]=!0;return}n!==null&&!n.includes(e)?this[yp]=!0:this[od].reverse?this[mp].lte=e:this[mp].gte=e}};Iye.Iterator=zq;function Pye(t){typeof t.commit=="function"&&t.commit()}});var Oye=W((zPt,Bye)=>{"use strict";f();Bye.exports=function(e,r,n,i,o){if(i.limit===0)return e.nextTick(o);let s=e.db.transaction([r],"readwrite"),a=s.objectStore(r),d=0;s.oncomplete=function(){o()},s.onabort=function(){o(s.error||new Error("aborted by user"))};let u=a.openKeyCursor?"openKeyCursor":"openCursor",c=i.reverse?"prev":"next";a[u](n,c).onsuccess=function(l){let h=l.target.result;h&&(a.delete(h.key).onsuccess=function(){(i.limit<=0||++d<i.limit)&&h.continue()})}}});var Wq=W($ye=>{"use strict";f();var{AbstractLevel:aGe}=Kq(),Mye=dl(),cGe=Eye(),{fromCallback:dGe}=e5(),{Iterator:uGe}=Rye(),Dye=Lq(),lGe=Oye(),fGe=qq(),jye="level-js-",p5=Symbol("idb"),Vq=Symbol("namePrefix"),gp=Symbol("location"),Hq=Symbol("version"),ob=Symbol("store"),y5=Symbol("onComplete"),Cye=Symbol("promise"),yI=class extends aGe{constructor(e,r,n){if(typeof r=="function"||typeof n=="function")throw new Mye("The levelup-style callback argument has been removed",{code:"LEVEL_LEGACY"});let{prefix:i,version:o,...s}=r||{};if(super({encodings:{view:!0},snapshots:!1,createIfMissing:!1,errorIfExists:!1,seek:!0},s),typeof e!="string")throw new Error("constructor requires a location string argument");this[gp]=e,this[Vq]=i??jye,this[Hq]=parseInt(o||1,10),this[p5]=null}get location(){return this[gp]}get namePrefix(){return this[Vq]}get version(){return this[Hq]}get db(){return this[p5]}get type(){return"browser-level"}_open(e,r){let n=indexedDB.open(this[Vq]+this[gp],this[Hq]);n.onerror=function(){r(n.error||new Error("unknown error"))},n.onsuccess=()=>{this[p5]=n.result,r()},n.onupgradeneeded=i=>{let o=i.target.result;o.objectStoreNames.contains(this[gp])||o.createObjectStore(this[gp])}}[ob](e){return this[p5].transaction([this[gp]],e).objectStore(this[gp])}[y5](e,r){let n=e.transaction;n.onabort=function(){r(n.error||new Error("aborted by user"))},n.oncomplete=function(){r(null,e.result)}}_get(e,r,n){let i=this[ob]("readonly"),o;try{o=i.get(e)}catch(s){return this.nextTick(n,s)}this[y5](o,function(s,a){if(s)return n(s);if(a===void 0)return n(new Mye("Entry not found",{code:"LEVEL_NOT_FOUND"}));n(null,Dye(a))})}_getMany(e,r,n){let i=this[ob]("readonly"),o=e.map(s=>a=>{let d;try{d=i.get(s)}catch(u){return a(u)}d.onsuccess=()=>{let u=d.result;a(null,u===void 0?u:Dye(u))},d.onerror=u=>{u.stopPropagation(),a(d.error)}});cGe(o,16,n)}_del(e,r,n){let i=this[ob]("readwrite"),o;try{o=i.delete(e)}catch(s){return this.nextTick(n,s)}this[y5](o,n)}_put(e,r,n,i){let o=this[ob]("readwrite"),s;try{s=o.put(r,e)}catch(a){return this.nextTick(i,a)}this[y5](s,i)}_iterator(e){return new uGe(this,this[gp],e)}_batch(e,r,n){let i=this[ob]("readwrite"),o=i.transaction,s=0,a;o.onabort=function(){n(a||o.error||new Error("aborted by user"))},o.oncomplete=function(){n()};function d(){let u=e[s++],c=u.key,l;try{l=u.type==="del"?i.delete(c):i.put(u.value,c)}catch(h){a=h,o.abort();return}s<e.length?l.onsuccess=d:typeof o.commit=="function"&&o.commit()}d()}_clear(e,r){let n,i;try{n=fGe(e)}catch{return this.nextTick(r)}if(e.limit>=0)return lGe(this,this[gp],n,e,r);try{let o=this[ob]("readwrite");i=n?o.delete(n):o.clear()}catch(o){return this.nextTick(r,o)}this[y5](i,r)}_close(e){this[p5].close(),this.nextTick(e)}};yI.destroy=function(t,e,r){typeof e=="function"&&(r=e,e=jye),r=dGe(r,Cye);let n=indexedDB.deleteDatabase(e+t);return n.onsuccess=function(){r()},n.onerror=function(i){r(i)},r[Cye]};$ye.BrowserLevel=yI});var m5=W(Nye=>{f();Nye.Level=Wq().BrowserLevel});var eo=W((tIt,Uye)=>{"use strict";f();Uye.exports={ArrayIsArray(t){return Array.isArray(t)},ArrayPrototypeIncludes(t,e){return t.includes(e)},ArrayPrototypeIndexOf(t,e){return t.indexOf(e)},ArrayPrototypeJoin(t,e){return t.join(e)},ArrayPrototypeMap(t,e){return t.map(e)},ArrayPrototypePop(t,e){return t.pop(e)},ArrayPrototypePush(t,e){return t.push(e)},ArrayPrototypeSlice(t,e,r){return t.slice(e,r)},Error,FunctionPrototypeCall(t,e,...r){return t.call(e,...r)},FunctionPrototypeSymbolHasInstance(t,e){return Function.prototype[Symbol.hasInstance].call(t,e)},MathFloor:Math.floor,Number,NumberIsInteger:Number.isInteger,NumberIsNaN:Number.isNaN,NumberMAX_SAFE_INTEGER:Number.MAX_SAFE_INTEGER,NumberMIN_SAFE_INTEGER:Number.MIN_SAFE_INTEGER,NumberParseInt:Number.parseInt,ObjectDefineProperties(t,e){return Object.defineProperties(t,e)},ObjectDefineProperty(t,e,r){return Object.defineProperty(t,e,r)},ObjectGetOwnPropertyDescriptor(t,e){return Object.getOwnPropertyDescriptor(t,e)},ObjectKeys(t){return Object.keys(t)},ObjectSetPrototypeOf(t,e){return Object.setPrototypeOf(t,e)},Promise,PromisePrototypeCatch(t,e){return t.catch(e)},PromisePrototypeThen(t,e,r){return t.then(e,r)},PromiseReject(t){return Promise.reject(t)},ReflectApply:Reflect.apply,RegExpPrototypeTest(t,e){return t.test(e)},SafeSet:Set,String,StringPrototypeSlice(t,e,r){return t.slice(e,r)},StringPrototypeToLowerCase(t){return t.toLowerCase()},StringPrototypeToUpperCase(t){return t.toUpperCase()},StringPrototypeTrim(t){return t.trim()},Symbol,SymbolFor:Symbol.for,SymbolAsyncIterator:Symbol.asyncIterator,SymbolHasInstance:Symbol.hasInstance,SymbolIterator:Symbol.iterator,TypedArrayPrototypeSet(t,e,r){return t.set(e,r)},Uint8Array}});var Cf=W((nIt,Jq)=>{"use strict";f();var pGe=bn(),yGe=Object.getPrototypeOf(async function(){}).constructor,Kye=globalThis.Blob||pGe.Blob,mGe=typeof Kye<"u"?function(e){return e instanceof Kye}:function(e){return!1},Gq=class extends Error{constructor(e){if(!Array.isArray(e))throw new TypeError(`Expected input to be an Array, got ${typeof e}`);let r="";for(let n=0;n<e.length;n++)r+=`    ${e[n].stack}
`;super(r),this.name="AggregateError",this.errors=e}};Jq.exports={AggregateError:Gq,kEmptyObject:Object.freeze({}),once(t){let e=!1;return function(...r){e||(e=!0,t.apply(this,r))}},createDeferredPromise:function(){let t,e;return{promise:new Promise((n,i)=>{t=n,e=i}),resolve:t,reject:e}},promisify(t){return new Promise((e,r)=>{t((n,...i)=>n?r(n):e(...i))})},debuglog(){return function(){}},format(t,...e){return t.replace(/%([sdifj])/g,function(...[r,n]){let i=e.shift();return n==="f"?i.toFixed(6):n==="j"?JSON.stringify(i):n==="s"&&typeof i=="object"?`${i.constructor!==Object?i.constructor.name:""} {}`.trim():i.toString()})},inspect(t){switch(typeof t){case"string":if(t.includes("'"))if(t.includes('"')){if(!t.includes("`")&&!t.includes("${"))return`\`${t}\``}else return`"${t}"`;return`'${t}'`;case"number":return isNaN(t)?"NaN":Object.is(t,-0)?String(t):t;case"bigint":return`${String(t)}n`;case"boolean":case"undefined":return String(t);case"object":return"{}"}},types:{isAsyncFunction(t){return t instanceof yGe},isArrayBufferView(t){return ArrayBuffer.isView(t)}},isBlob:mGe};Jq.exports.promisify.custom=Symbol.for("nodejs.util.promisify.custom")});var za=W((oIt,Fye)=>{"use strict";f();var{format:gGe,inspect:mI,AggregateError:vGe}=Cf(),bGe=globalThis.AggregateError||vGe,wGe=Symbol("kIsNodeError"),_Ge=["string","function","number","object","Function","Object","boolean","bigint","symbol"],xGe=/^([A-Z][a-z0-9]*)+$/,EGe="__node_internal_",gI={};function ab(t,e){if(!t)throw new gI.ERR_INTERNAL_ASSERTION(e)}function qye(t){let e="",r=t.length,n=t[0]==="-"?1:0;for(;r>=n+4;r-=3)e=`_${t.slice(r-3,r)}${e}`;return`${t.slice(0,r)}${e}`}function SGe(t,e,r){if(typeof e=="function")return ab(e.length<=r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${e.length}).`),e(...r);let n=(e.match(/%[dfijoOs]/g)||[]).length;return ab(n===r.length,`Code: ${t}; The provided arguments length (${r.length}) does not match the required ones (${n}).`),r.length===0?e:gGe(e,...r)}function Rs(t,e,r){r||(r=Error);class n extends r{constructor(...o){super(SGe(t,e,o))}toString(){return`${this.name} [${t}]: ${this.message}`}}Object.defineProperties(n.prototype,{name:{value:r.name,writable:!0,enumerable:!1,configurable:!0},toString:{value(){return`${this.name} [${t}]: ${this.message}`},writable:!0,enumerable:!1,configurable:!0}}),n.prototype.code=t,n.prototype[wGe]=!0,gI[t]=n}function Lye(t){let e=EGe+t.name;return Object.defineProperty(t,"name",{value:e}),t}function TGe(t,e){if(t&&e&&t!==e){if(Array.isArray(e.errors))return e.errors.push(t),e;let r=new bGe([e,t],e.message);return r.code=e.code,r}return t||e}var Yq=class extends Error{constructor(e="The operation was aborted",r=void 0){if(r!==void 0&&typeof r!="object")throw new gI.ERR_INVALID_ARG_TYPE("options","Object",r);super(e,r),this.code="ABORT_ERR",this.name="AbortError"}};Rs("ERR_ASSERTION","%s",Error);Rs("ERR_INVALID_ARG_TYPE",(t,e,r)=>{ab(typeof t=="string","'name' must be a string"),Array.isArray(e)||(e=[e]);let n="The ";t.endsWith(" argument")?n+=`${t} `:n+=`"${t}" ${t.includes(".")?"property":"argument"} `,n+="must be ";let i=[],o=[],s=[];for(let d of e)ab(typeof d=="string","All expected entries have to be of type string"),_Ge.includes(d)?i.push(d.toLowerCase()):xGe.test(d)?o.push(d):(ab(d!=="object",'The value "object" should be written as "Object"'),s.push(d));if(o.length>0){let d=i.indexOf("object");d!==-1&&(i.splice(i,d,1),o.push("Object"))}if(i.length>0){switch(i.length){case 1:n+=`of type ${i[0]}`;break;case 2:n+=`one of type ${i[0]} or ${i[1]}`;break;default:{let d=i.pop();n+=`one of type ${i.join(", ")}, or ${d}`}}(o.length>0||s.length>0)&&(n+=" or ")}if(o.length>0){switch(o.length){case 1:n+=`an instance of ${o[0]}`;break;case 2:n+=`an instance of ${o[0]} or ${o[1]}`;break;default:{let d=o.pop();n+=`an instance of ${o.join(", ")}, or ${d}`}}s.length>0&&(n+=" or ")}switch(s.length){case 0:break;case 1:s[0].toLowerCase()!==s[0]&&(n+="an "),n+=`${s[0]}`;break;case 2:n+=`one of ${s[0]} or ${s[1]}`;break;default:{let d=s.pop();n+=`one of ${s.join(", ")}, or ${d}`}}if(r==null)n+=`. Received ${r}`;else if(typeof r=="function"&&r.name)n+=`. Received function ${r.name}`;else if(typeof r=="object"){var a;if((a=r.constructor)!==null&&a!==void 0&&a.name)n+=`. Received an instance of ${r.constructor.name}`;else{let d=mI(r,{depth:-1});n+=`. Received ${d}`}}else{let d=mI(r,{colors:!1});d.length>25&&(d=`${d.slice(0,25)}...`),n+=`. Received type ${typeof r} (${d})`}return n},TypeError);Rs("ERR_INVALID_ARG_VALUE",(t,e,r="is invalid")=>{let n=mI(e);return n.length>128&&(n=n.slice(0,128)+"..."),`The ${t.includes(".")?"property":"argument"} '${t}' ${r}. Received ${n}`},TypeError);Rs("ERR_INVALID_RETURN_VALUE",(t,e,r)=>{var n;let i=r!=null&&(n=r.constructor)!==null&&n!==void 0&&n.name?`instance of ${r.constructor.name}`:`type ${typeof r}`;return`Expected ${t} to be returned from the "${e}" function but got ${i}.`},TypeError);Rs("ERR_MISSING_ARGS",(...t)=>{ab(t.length>0,"At least one arg needs to be specified");let e,r=t.length;switch(t=(Array.isArray(t)?t:[t]).map(n=>`"${n}"`).join(" or "),r){case 1:e+=`The ${t[0]} argument`;break;case 2:e+=`The ${t[0]} and ${t[1]} arguments`;break;default:{let n=t.pop();e+=`The ${t.join(", ")}, and ${n} arguments`}break}return`${e} must be specified`},TypeError);Rs("ERR_OUT_OF_RANGE",(t,e,r)=>{ab(e,'Missing "range" argument');let n;return Number.isInteger(r)&&Math.abs(r)>2**32?n=qye(String(r)):typeof r=="bigint"?(n=String(r),(r>2n**32n||r<-(2n**32n))&&(n=qye(n)),n+="n"):n=mI(r),`The value of "${t}" is out of range. It must be ${e}. Received ${n}`},RangeError);Rs("ERR_MULTIPLE_CALLBACK","Callback called multiple times",Error);Rs("ERR_METHOD_NOT_IMPLEMENTED","The %s method is not implemented",Error);Rs("ERR_STREAM_ALREADY_FINISHED","Cannot call %s after a stream was finished",Error);Rs("ERR_STREAM_CANNOT_PIPE","Cannot pipe, not readable",Error);Rs("ERR_STREAM_DESTROYED","Cannot call %s after a stream was destroyed",Error);Rs("ERR_STREAM_NULL_VALUES","May not write null values to stream",TypeError);Rs("ERR_STREAM_PREMATURE_CLOSE","Premature close",Error);Rs("ERR_STREAM_PUSH_AFTER_EOF","stream.push() after EOF",Error);Rs("ERR_STREAM_UNSHIFT_AFTER_END_EVENT","stream.unshift() after end event",Error);Rs("ERR_STREAM_WRITE_AFTER_END","write after end",Error);Rs("ERR_UNKNOWN_ENCODING","Unknown encoding: %s",TypeError);Fye.exports={AbortError:Yq,aggregateTwoErrors:Lye(TGe),hideStackFrames:Lye,codes:gI}});var g5=W((aIt,Xye)=>{"use strict";f();var{ArrayIsArray:Xq,ArrayPrototypeIncludes:Wye,ArrayPrototypeJoin:Gye,ArrayPrototypeMap:AGe,NumberIsInteger:Qq,NumberIsNaN:kGe,NumberMAX_SAFE_INTEGER:PGe,NumberMIN_SAFE_INTEGER:IGe,NumberParseInt:RGe,ObjectPrototypeHasOwnProperty:BGe,RegExpPrototypeExec:Jye,String:OGe,StringPrototypeToUpperCase:MGe,StringPrototypeTrim:DGe}=eo(),{hideStackFrames:nu,codes:{ERR_SOCKET_BAD_PORT:CGe,ERR_INVALID_ARG_TYPE:Va,ERR_INVALID_ARG_VALUE:J2,ERR_OUT_OF_RANGE:cb,ERR_UNKNOWN_SIGNAL:zye}}=za(),{normalizeEncoding:jGe}=Cf(),{isAsyncFunction:$Ge,isArrayBufferView:NGe}=Cf().types,Vye={};function UGe(t){return t===(t|0)}function KGe(t){return t===t>>>0}var qGe=/^[0-7]+$/,LGe="must be a 32-bit unsigned integer or an octal string";function FGe(t,e,r){if(typeof t>"u"&&(t=r),typeof t=="string"){if(Jye(qGe,t)===null)throw new J2(e,t,LGe);t=RGe(t,8)}return Yye(t,e),t}var zGe=nu((t,e,r=IGe,n=PGe)=>{if(typeof t!="number")throw new Va(e,"number",t);if(!Qq(t))throw new cb(e,"an integer",t);if(t<r||t>n)throw new cb(e,`>= ${r} && <= ${n}`,t)}),VGe=nu((t,e,r=-2147483648,n=2147483647)=>{if(typeof t!="number")throw new Va(e,"number",t);if(!Qq(t))throw new cb(e,"an integer",t);if(t<r||t>n)throw new cb(e,`>= ${r} && <= ${n}`,t)}),Yye=nu((t,e,r=!1)=>{if(typeof t!="number")throw new Va(e,"number",t);if(!Qq(t))throw new cb(e,"an integer",t);let n=r?1:0,i=4294967295;if(t<n||t>i)throw new cb(e,`>= ${n} && <= ${i}`,t)});function eL(t,e){if(typeof t!="string")throw new Va(e,"string",t)}function HGe(t,e,r=void 0,n){if(typeof t!="number")throw new Va(e,"number",t);if(r!=null&&t<r||n!=null&&t>n||(r!=null||n!=null)&&kGe(t))throw new cb(e,`${r!=null?`>= ${r}`:""}${r!=null&&n!=null?" && ":""}${n!=null?`<= ${n}`:""}`,t)}var WGe=nu((t,e,r)=>{if(!Wye(r,t)){let i="must be one of: "+Gye(AGe(r,o=>typeof o=="string"?`'${o}'`:OGe(o)),", ");throw new J2(e,t,i)}});function Zye(t,e){if(typeof t!="boolean")throw new Va(e,"boolean",t)}function Zq(t,e,r){return t==null||!BGe(t,e)?r:t[e]}var GGe=nu((t,e,r=null)=>{let n=Zq(r,"allowArray",!1),i=Zq(r,"allowFunction",!1);if(!Zq(r,"nullable",!1)&&t===null||!n&&Xq(t)||typeof t!="object"&&(!i||typeof t!="function"))throw new Va(e,"Object",t)}),JGe=nu((t,e)=>{if(t!=null&&typeof t!="object"&&typeof t!="function")throw new Va(e,"a dictionary",t)}),tL=nu((t,e,r=0)=>{if(!Xq(t))throw new Va(e,"Array",t);if(t.length<r){let n=`must be longer than ${r}`;throw new J2(e,t,n)}});function YGe(t,e){tL(t,e);for(let r=0;r<t.length;r++)eL(t[r],`${e}[${r}]`)}function ZGe(t,e){tL(t,e);for(let r=0;r<t.length;r++)Zye(t[r],`${e}[${r}]`)}function XGe(t,e="signal"){if(eL(t,e),Vye[t]===void 0)throw Vye[MGe(t)]!==void 0?new zye(t+" (signals must use all capital letters)"):new zye(t)}var QGe=nu((t,e="buffer")=>{if(!NGe(t))throw new Va(e,["Buffer","TypedArray","DataView"],t)});function eJe(t,e){let r=jGe(e),n=t.length;if(r==="hex"&&n%2!==0)throw new J2("encoding",e,`is invalid for data of length ${n}`)}function tJe(t,e="Port",r=!0){if(typeof t!="number"&&typeof t!="string"||typeof t=="string"&&DGe(t).length===0||+t!==+t>>>0||t>65535||t===0&&!r)throw new CGe(e,t,r);return t|0}var rJe=nu((t,e)=>{if(t!==void 0&&(t===null||typeof t!="object"||!("aborted"in t)))throw new Va(e,"AbortSignal",t)}),nJe=nu((t,e)=>{if(typeof t!="function")throw new Va(e,"Function",t)}),iJe=nu((t,e)=>{if(typeof t!="function"||$Ge(t))throw new Va(e,"Function",t)}),oJe=nu((t,e)=>{if(t!==void 0)throw new Va(e,"undefined",t)});function sJe(t,e,r){if(!Wye(r,t))throw new Va(e,`('${Gye(r,"|")}')`,t)}var aJe=/^(?:<[^>]*>)(?:\s*;\s*[^;"\s]+(?:=(")?[^;"\s]*\1)?)*$/;function Hye(t,e){if(typeof t>"u"||!Jye(aJe,t))throw new J2(e,t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}function cJe(t){if(typeof t=="string")return Hye(t,"hints"),t;if(Xq(t)){let e=t.length,r="";if(e===0)return r;for(let n=0;n<e;n++){let i=t[n];Hye(i,"hints"),r+=i,n!==e-1&&(r+=", ")}return r}throw new J2("hints",t,'must be an array or string of format "</styles.css>; rel=preload; as=style"')}Xye.exports={isInt32:UGe,isUint32:KGe,parseFileMode:FGe,validateArray:tL,validateStringArray:YGe,validateBooleanArray:ZGe,validateBoolean:Zye,validateBuffer:QGe,validateDictionary:JGe,validateEncoding:eJe,validateFunction:nJe,validateInt32:VGe,validateInteger:zGe,validateNumber:HGe,validateObject:GGe,validateOneOf:WGe,validatePlainFunction:iJe,validatePort:tJe,validateSignalName:XGe,validateString:eL,validateUint32:Yye,validateUndefined:oJe,validateUnion:sJe,validateAbortSignal:rJe,validateLinkHeaderValue:cJe}});var $f=W((dIt,pme)=>{"use strict";f();var{Symbol:vI,SymbolAsyncIterator:Qye,SymbolIterator:eme,SymbolFor:tme}=eo(),rme=vI("kDestroyed"),nme=vI("kIsErrored"),rL=vI("kIsReadable"),ime=vI("kIsDisturbed"),dJe=tme("nodejs.webstream.isClosedPromise"),uJe=tme("nodejs.webstream.controllerErrorFunction");function bI(t,e=!1){var r;return!!(t&&typeof t.pipe=="function"&&typeof t.on=="function"&&(!e||typeof t.pause=="function"&&typeof t.resume=="function")&&(!t._writableState||((r=t._readableState)===null||r===void 0?void 0:r.readable)!==!1)&&(!t._writableState||t._readableState))}function wI(t){var e;return!!(t&&typeof t.write=="function"&&typeof t.on=="function"&&(!t._readableState||((e=t._writableState)===null||e===void 0?void 0:e.writable)!==!1))}function lJe(t){return!!(t&&typeof t.pipe=="function"&&t._readableState&&typeof t.on=="function"&&typeof t.write=="function")}function jf(t){return t&&(t._readableState||t._writableState||typeof t.write=="function"&&typeof t.on=="function"||typeof t.pipe=="function"&&typeof t.on=="function")}function ome(t){return!!(t&&!jf(t)&&typeof t.pipeThrough=="function"&&typeof t.getReader=="function"&&typeof t.cancel=="function")}function sme(t){return!!(t&&!jf(t)&&typeof t.getWriter=="function"&&typeof t.abort=="function")}function ame(t){return!!(t&&!jf(t)&&typeof t.readable=="object"&&typeof t.writable=="object")}function fJe(t){return ome(t)||sme(t)||ame(t)}function hJe(t,e){return t==null?!1:e===!0?typeof t[Qye]=="function":e===!1?typeof t[eme]=="function":typeof t[Qye]=="function"||typeof t[eme]=="function"}function _I(t){if(!jf(t))return null;let e=t._writableState,r=t._readableState,n=e||r;return!!(t.destroyed||t[rme]||n!=null&&n.destroyed)}function cme(t){if(!wI(t))return null;if(t.writableEnded===!0)return!0;let e=t._writableState;return e!=null&&e.errored?!1:typeof e?.ended!="boolean"?null:e.ended}function pJe(t,e){if(!wI(t))return null;if(t.writableFinished===!0)return!0;let r=t._writableState;return r!=null&&r.errored?!1:typeof r?.finished!="boolean"?null:!!(r.finished||e===!1&&r.ended===!0&&r.length===0)}function yJe(t){if(!bI(t))return null;if(t.readableEnded===!0)return!0;let e=t._readableState;return!e||e.errored?!1:typeof e?.ended!="boolean"?null:e.ended}function dme(t,e){if(!bI(t))return null;let r=t._readableState;return r!=null&&r.errored?!1:typeof r?.endEmitted!="boolean"?null:!!(r.endEmitted||e===!1&&r.ended===!0&&r.length===0)}function ume(t){return t&&t[rL]!=null?t[rL]:typeof t?.readable!="boolean"?null:_I(t)?!1:bI(t)&&t.readable&&!dme(t)}function lme(t){return typeof t?.writable!="boolean"?null:_I(t)?!1:wI(t)&&t.writable&&!cme(t)}function mJe(t,e){return jf(t)?_I(t)?!0:!(e?.readable!==!1&&ume(t)||e?.writable!==!1&&lme(t)):null}function gJe(t){var e,r;return jf(t)?t.writableErrored?t.writableErrored:(e=(r=t._writableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}function vJe(t){var e,r;return jf(t)?t.readableErrored?t.readableErrored:(e=(r=t._readableState)===null||r===void 0?void 0:r.errored)!==null&&e!==void 0?e:null:null}function bJe(t){if(!jf(t))return null;if(typeof t.closed=="boolean")return t.closed;let e=t._writableState,r=t._readableState;return typeof e?.closed=="boolean"||typeof r?.closed=="boolean"?e?.closed||r?.closed:typeof t._closed=="boolean"&&fme(t)?t._closed:null}function fme(t){return typeof t._closed=="boolean"&&typeof t._defaultKeepAlive=="boolean"&&typeof t._removedConnection=="boolean"&&typeof t._removedContLen=="boolean"}function hme(t){return typeof t._sent100=="boolean"&&fme(t)}function wJe(t){var e;return typeof t._consuming=="boolean"&&typeof t._dumped=="boolean"&&((e=t.req)===null||e===void 0?void 0:e.upgradeOrConnect)===void 0}function _Je(t){if(!jf(t))return null;let e=t._writableState,r=t._readableState,n=e||r;return!n&&hme(t)||!!(n&&n.autoDestroy&&n.emitClose&&n.closed===!1)}function xJe(t){var e;return!!(t&&((e=t[ime])!==null&&e!==void 0?e:t.readableDidRead||t.readableAborted))}function EJe(t){var e,r,n,i,o,s,a,d,u,c;return!!(t&&((e=(r=(n=(i=(o=(s=t[nme])!==null&&s!==void 0?s:t.readableErrored)!==null&&o!==void 0?o:t.writableErrored)!==null&&i!==void 0?i:(a=t._readableState)===null||a===void 0?void 0:a.errorEmitted)!==null&&n!==void 0?n:(d=t._writableState)===null||d===void 0?void 0:d.errorEmitted)!==null&&r!==void 0?r:(u=t._readableState)===null||u===void 0?void 0:u.errored)!==null&&e!==void 0?e:!((c=t._writableState)===null||c===void 0)&&c.errored))}pme.exports={kDestroyed:rme,isDisturbed:xJe,kIsDisturbed:ime,isErrored:EJe,kIsErrored:nme,isReadable:ume,kIsReadable:rL,kIsClosedPromise:dJe,kControllerErrorFunction:uJe,isClosed:bJe,isDestroyed:_I,isDuplexNodeStream:lJe,isFinished:mJe,isIterable:hJe,isReadableNodeStream:bI,isReadableStream:ome,isReadableEnded:yJe,isReadableFinished:dme,isReadableErrored:vJe,isNodeStream:jf,isWebStream:fJe,isWritable:lme,isWritableNodeStream:wI,isWritableStream:sme,isWritableEnded:cme,isWritableFinished:pJe,isWritableErrored:gJe,isServerRequest:wJe,isServerResponse:hme,willEmitClose:_Je,isTransformStream:ame}});var vp=W((lIt,aL)=>{f();var Gm=Fs(),{AbortError:Eme,codes:SJe}=za(),{ERR_INVALID_ARG_TYPE:TJe,ERR_STREAM_PREMATURE_CLOSE:yme}=SJe,{kEmptyObject:iL,once:oL}=Cf(),{validateAbortSignal:AJe,validateFunction:kJe,validateObject:PJe,validateBoolean:IJe}=g5(),{Promise:RJe,PromisePrototypeThen:BJe}=eo(),{isClosed:OJe,isReadable:mme,isReadableNodeStream:nL,isReadableStream:MJe,isReadableFinished:gme,isReadableErrored:vme,isWritable:bme,isWritableNodeStream:wme,isWritableStream:DJe,isWritableFinished:_me,isWritableErrored:xme,isNodeStream:CJe,willEmitClose:jJe,kIsClosedPromise:$Je}=$f();function NJe(t){return t.setHeader&&typeof t.abort=="function"}var sL=()=>{};function Sme(t,e,r){var n,i;if(arguments.length===2?(r=e,e=iL):e==null?e=iL:PJe(e,"options"),kJe(r,"callback"),AJe(e.signal,"options.signal"),r=oL(r),MJe(t)||DJe(t))return UJe(t,e,r);if(!CJe(t))throw new TJe("stream",["ReadableStream","WritableStream","Stream"],t);let o=(n=e.readable)!==null&&n!==void 0?n:nL(t),s=(i=e.writable)!==null&&i!==void 0?i:wme(t),a=t._writableState,d=t._readableState,u=()=>{t.writable||h()},c=jJe(t)&&nL(t)===o&&wme(t)===s,l=_me(t,!1),h=()=>{l=!0,t.destroyed&&(c=!1),!(c&&(!t.readable||o))&&(!o||y)&&r.call(t)},y=gme(t,!1),g=()=>{y=!0,t.destroyed&&(c=!1),!(c&&(!t.writable||s))&&(!s||l)&&r.call(t)},v=j=>{r.call(t,j)},x=OJe(t),S=()=>{x=!0;let j=xme(t)||vme(t);if(j&&typeof j!="boolean")return r.call(t,j);if(o&&!y&&nL(t,!0)&&!gme(t,!1))return r.call(t,new yme);if(s&&!l&&!_me(t,!1))return r.call(t,new yme);r.call(t)},A=()=>{x=!0;let j=xme(t)||vme(t);if(j&&typeof j!="boolean")return r.call(t,j);r.call(t)},T=()=>{t.req.on("finish",h)};NJe(t)?(t.on("complete",h),c||t.on("abort",S),t.req?T():t.on("request",T)):s&&!a&&(t.on("end",u),t.on("close",u)),!c&&typeof t.aborted=="boolean"&&t.on("aborted",S),t.on("end",g),t.on("finish",h),e.error!==!1&&t.on("error",v),t.on("close",S),x?Gm.nextTick(S):a!=null&&a.errorEmitted||d!=null&&d.errorEmitted?c||Gm.nextTick(A):(!o&&(!c||mme(t))&&(l||bme(t)===!1)||!s&&(!c||bme(t))&&(y||mme(t)===!1)||d&&t.req&&t.aborted)&&Gm.nextTick(A);let $=()=>{r=sL,t.removeListener("aborted",S),t.removeListener("complete",h),t.removeListener("abort",S),t.removeListener("request",T),t.req&&t.req.removeListener("finish",h),t.removeListener("end",u),t.removeListener("close",u),t.removeListener("finish",h),t.removeListener("end",g),t.removeListener("error",v),t.removeListener("close",S)};if(e.signal&&!x){let j=()=>{let K=r;$(),K.call(t,new Eme(void 0,{cause:e.signal.reason}))};if(e.signal.aborted)Gm.nextTick(j);else{let K=r;r=oL((...F)=>{e.signal.removeEventListener("abort",j),K.apply(t,F)}),e.signal.addEventListener("abort",j)}}return $}function UJe(t,e,r){let n=!1,i=sL;if(e.signal)if(i=()=>{n=!0,r.call(t,new Eme(void 0,{cause:e.signal.reason}))},e.signal.aborted)Gm.nextTick(i);else{let s=r;r=oL((...a)=>{e.signal.removeEventListener("abort",i),s.apply(t,a)}),e.signal.addEventListener("abort",i)}let o=(...s)=>{n||Gm.nextTick(()=>r.apply(t,s))};return BJe(t[$Je].promise,o,o),sL}function KJe(t,e){var r;let n=!1;return e===null&&(e=iL),(r=e)!==null&&r!==void 0&&r.cleanup&&(IJe(e.cleanup,"cleanup"),n=e.cleanup),new RJe((i,o)=>{let s=Sme(t,e,a=>{n&&s(),a?o(a):i()})})}aL.exports=Sme;aL.exports.finished=KJe});var db=W((hIt,Ome)=>{"use strict";f();var Nf=Fs(),{aggregateTwoErrors:qJe,codes:{ERR_MULTIPLE_CALLBACK:LJe},AbortError:FJe}=za(),{Symbol:kme}=eo(),{kDestroyed:zJe,isDestroyed:VJe,isFinished:HJe,isServerRequest:WJe}=$f(),Pme=kme("kDestroy"),cL=kme("kConstruct");function Ime(t,e,r){t&&(t.stack,e&&!e.errored&&(e.errored=t),r&&!r.errored&&(r.errored=t))}function GJe(t,e){let r=this._readableState,n=this._writableState,i=n||r;return n!=null&&n.destroyed||r!=null&&r.destroyed?(typeof e=="function"&&e(),this):(Ime(t,n,r),n&&(n.destroyed=!0),r&&(r.destroyed=!0),i.constructed?Tme(this,t,e):this.once(Pme,function(o){Tme(this,qJe(o,t),e)}),this)}function Tme(t,e,r){let n=!1;function i(o){if(n)return;n=!0;let s=t._readableState,a=t._writableState;Ime(o,a,s),a&&(a.closed=!0),s&&(s.closed=!0),typeof r=="function"&&r(o),o?Nf.nextTick(JJe,t,o):Nf.nextTick(Rme,t)}try{t._destroy(e||null,i)}catch(o){i(o)}}function JJe(t,e){dL(t,e),Rme(t)}function Rme(t){let e=t._readableState,r=t._writableState;r&&(r.closeEmitted=!0),e&&(e.closeEmitted=!0),(r!=null&&r.emitClose||e!=null&&e.emitClose)&&t.emit("close")}function dL(t,e){let r=t._readableState,n=t._writableState;n!=null&&n.errorEmitted||r!=null&&r.errorEmitted||(n&&(n.errorEmitted=!0),r&&(r.errorEmitted=!0),t.emit("error",e))}function YJe(){let t=this._readableState,e=this._writableState;t&&(t.constructed=!0,t.closed=!1,t.closeEmitted=!1,t.destroyed=!1,t.errored=null,t.errorEmitted=!1,t.reading=!1,t.ended=t.readable===!1,t.endEmitted=t.readable===!1),e&&(e.constructed=!0,e.destroyed=!1,e.closed=!1,e.closeEmitted=!1,e.errored=null,e.errorEmitted=!1,e.finalCalled=!1,e.prefinished=!1,e.ended=e.writable===!1,e.ending=e.writable===!1,e.finished=e.writable===!1)}function uL(t,e,r){let n=t._readableState,i=t._writableState;if(i!=null&&i.destroyed||n!=null&&n.destroyed)return this;n!=null&&n.autoDestroy||i!=null&&i.autoDestroy?t.destroy(e):e&&(e.stack,i&&!i.errored&&(i.errored=e),n&&!n.errored&&(n.errored=e),r?Nf.nextTick(dL,t,e):dL(t,e))}function ZJe(t,e){if(typeof t._construct!="function")return;let r=t._readableState,n=t._writableState;r&&(r.constructed=!1),n&&(n.constructed=!1),t.once(cL,e),!(t.listenerCount(cL)>1)&&Nf.nextTick(XJe,t)}function XJe(t){let e=!1;function r(n){if(e){uL(t,n??new LJe);return}e=!0;let i=t._readableState,o=t._writableState,s=o||i;i&&(i.constructed=!0),o&&(o.constructed=!0),s.destroyed?t.emit(Pme,n):n?uL(t,n,!0):Nf.nextTick(QJe,t)}try{t._construct(n=>{Nf.nextTick(r,n)})}catch(n){Nf.nextTick(r,n)}}function QJe(t){t.emit(cL)}function Ame(t){return t?.setHeader&&typeof t.abort=="function"}function Bme(t){t.emit("close")}function eYe(t,e){t.emit("error",e),Nf.nextTick(Bme,t)}function tYe(t,e){!t||VJe(t)||(!e&&!HJe(t)&&(e=new FJe),WJe(t)?(t.socket=null,t.destroy(e)):Ame(t)?t.abort():Ame(t.req)?t.req.abort():typeof t.destroy=="function"?t.destroy(e):typeof t.close=="function"?t.close():e?Nf.nextTick(eYe,t,e):Nf.nextTick(Bme,t),t.destroyed||(t[zJe]=!0))}Ome.exports={construct:ZJe,destroyer:tYe,destroy:GJe,undestroy:YJe,errorOrDestroy:uL}});var SI=W((yIt,Dme)=>{"use strict";f();var{ArrayIsArray:rYe,ObjectSetPrototypeOf:Mme}=eo(),{EventEmitter:xI}=Ba();function EI(t){xI.call(this,t)}Mme(EI.prototype,xI.prototype);Mme(EI,xI);EI.prototype.pipe=function(t,e){let r=this;function n(c){t.writable&&t.write(c)===!1&&r.pause&&r.pause()}r.on("data",n);function i(){r.readable&&r.resume&&r.resume()}t.on("drain",i),!t._isStdio&&(!e||e.end!==!1)&&(r.on("end",s),r.on("close",a));let o=!1;function s(){o||(o=!0,t.end())}function a(){o||(o=!0,typeof t.destroy=="function"&&t.destroy())}function d(c){u(),xI.listenerCount(this,"error")===0&&this.emit("error",c)}lL(r,"error",d),lL(t,"error",d);function u(){r.removeListener("data",n),t.removeListener("drain",i),r.removeListener("end",s),r.removeListener("close",a),r.removeListener("error",d),t.removeListener("error",d),r.removeListener("end",u),r.removeListener("close",u),t.removeListener("close",u)}return r.on("end",u),r.on("close",u),t.on("close",u),t.emit("pipe",r),t};function lL(t,e,r){if(typeof t.prependListener=="function")return t.prependListener(e,r);!t._events||!t._events[e]?t.on(e,r):rYe(t._events[e])?t._events[e].unshift(r):t._events[e]=[r,t._events[e]]}Dme.exports={Stream:EI,prependListener:lL}});var v5=W((gIt,TI)=>{"use strict";f();var{AbortError:Cme,codes:nYe}=za(),{isNodeStream:jme,isWebStream:iYe,kControllerErrorFunction:oYe}=$f(),sYe=vp(),{ERR_INVALID_ARG_TYPE:$me}=nYe,aYe=(t,e)=>{if(typeof t!="object"||!("aborted"in t))throw new $me(e,"AbortSignal",t)};TI.exports.addAbortSignal=function(e,r){if(aYe(e,"signal"),!jme(r)&&!iYe(r))throw new $me("stream",["ReadableStream","WritableStream","Stream"],r);return TI.exports.addAbortSignalNoValidate(e,r)};TI.exports.addAbortSignalNoValidate=function(t,e){if(typeof t!="object"||!("aborted"in t))return e;let r=jme(e)?()=>{e.destroy(new Cme(void 0,{cause:t.reason}))}:()=>{e[oYe](new Cme(void 0,{cause:t.reason}))};return t.aborted?r():(t.addEventListener("abort",r),sYe(e,()=>t.removeEventListener("abort",r))),e}});var Kme=W((wIt,Ume)=>{"use strict";f();var{StringPrototypeSlice:Nme,SymbolIterator:cYe,TypedArrayPrototypeSet:AI,Uint8Array:dYe}=eo(),{Buffer:fL}=bn(),{inspect:uYe}=Cf();Ume.exports=class{constructor(){this.head=null,this.tail=null,this.length=0}push(e){let r={data:e,next:null};this.length>0?this.tail.next=r:this.head=r,this.tail=r,++this.length}unshift(e){let r={data:e,next:this.head};this.length===0&&(this.tail=r),this.head=r,++this.length}shift(){if(this.length===0)return;let e=this.head.data;return this.length===1?this.head=this.tail=null:this.head=this.head.next,--this.length,e}clear(){this.head=this.tail=null,this.length=0}join(e){if(this.length===0)return"";let r=this.head,n=""+r.data;for(;(r=r.next)!==null;)n+=e+r.data;return n}concat(e){if(this.length===0)return fL.alloc(0);let r=fL.allocUnsafe(e>>>0),n=this.head,i=0;for(;n;)AI(r,n.data,i),i+=n.data.length,n=n.next;return r}consume(e,r){let n=this.head.data;if(e<n.length){let i=n.slice(0,e);return this.head.data=n.slice(e),i}return e===n.length?this.shift():r?this._getString(e):this._getBuffer(e)}first(){return this.head.data}*[cYe](){for(let e=this.head;e;e=e.next)yield e.data}_getString(e){let r="",n=this.head,i=0;do{let o=n.data;if(e>o.length)r+=o,e-=o.length;else{e===o.length?(r+=o,++i,n.next?this.head=n.next:this.head=this.tail=null):(r+=Nme(o,0,e),this.head=n,n.data=Nme(o,e));break}++i}while((n=n.next)!==null);return this.length-=i,r}_getBuffer(e){let r=fL.allocUnsafe(e),n=e,i=this.head,o=0;do{let s=i.data;if(e>s.length)AI(r,s,n-e),e-=s.length;else{e===s.length?(AI(r,s,n-e),++o,i.next?this.head=i.next:this.head=this.tail=null):(AI(r,new dYe(s.buffer,s.byteOffset,e),n-e),this.head=i,i.data=s.slice(e));break}++o}while((i=i.next)!==null);return this.length-=o,r}[Symbol.for("nodejs.util.inspect.custom")](e,r){return uYe(this,{...r,depth:0,customInspect:!1})}}});var kI=W((xIt,Lme)=>{"use strict";f();var{MathFloor:lYe,NumberIsInteger:fYe}=eo(),{ERR_INVALID_ARG_VALUE:hYe}=za().codes;function pYe(t,e,r){return t.highWaterMark!=null?t.highWaterMark:e?t[r]:null}function qme(t){return t?16:16*1024}function yYe(t,e,r,n){let i=pYe(e,n,r);if(i!=null){if(!fYe(i)||i<0){let o=n?`options.${r}`:"options.highWaterMark";throw new hYe(o,i)}return lYe(i)}return qme(t.objectMode)}Lme.exports={getHighWaterMark:yYe,getDefaultHighWaterMark:qme}});var hL=W((SIt,Hme)=>{"use strict";f();var Fme=Fs(),{PromisePrototypeThen:mYe,SymbolAsyncIterator:zme,SymbolIterator:Vme}=eo(),{Buffer:gYe}=bn(),{ERR_INVALID_ARG_TYPE:vYe,ERR_STREAM_NULL_VALUES:bYe}=za().codes;function wYe(t,e,r){let n;if(typeof e=="string"||e instanceof gYe)return new t({objectMode:!0,...r,read(){this.push(e),this.push(null)}});let i;if(e&&e[zme])i=!0,n=e[zme]();else if(e&&e[Vme])i=!1,n=e[Vme]();else throw new vYe("iterable",["Iterable"],e);let o=new t({objectMode:!0,highWaterMark:1,...r}),s=!1;o._read=function(){s||(s=!0,d())},o._destroy=function(u,c){mYe(a(u),()=>Fme.nextTick(c,u),l=>Fme.nextTick(c,l||u))};async function a(u){let c=u!=null,l=typeof n.throw=="function";if(c&&l){let{value:h,done:y}=await n.throw(u);if(await h,y)return}if(typeof n.return=="function"){let{value:h}=await n.return();await h}}async function d(){for(;;){try{let{value:u,done:c}=i?await n.next():n.next();if(c)o.push(null);else{let l=u&&typeof u.then=="function"?await u:u;if(l===null)throw s=!1,new bYe;if(o.push(l))continue;s=!1}}catch(u){o.destroy(u)}break}}return o}Hme.exports=wYe});var b5=W((AIt,o0e)=>{f();var fl=Fs(),{ArrayPrototypeIndexOf:_Ye,NumberIsInteger:xYe,NumberIsNaN:EYe,NumberParseInt:SYe,ObjectDefineProperties:Jme,ObjectKeys:TYe,ObjectSetPrototypeOf:Yme,Promise:AYe,SafeSet:kYe,SymbolAsyncIterator:PYe,Symbol:IYe}=eo();o0e.exports=Ar;Ar.ReadableState=bL;var{EventEmitter:RYe}=Ba(),{Stream:Jm,prependListener:BYe}=SI(),{Buffer:pL}=bn(),{addAbortSignal:OYe}=v5(),MYe=vp(),Kr=Cf().debuglog("stream",t=>{Kr=t}),DYe=Kme(),Z2=db(),{getHighWaterMark:CYe,getDefaultHighWaterMark:jYe}=kI(),{aggregateTwoErrors:Wme,codes:{ERR_INVALID_ARG_TYPE:$Ye,ERR_METHOD_NOT_IMPLEMENTED:NYe,ERR_OUT_OF_RANGE:UYe,ERR_STREAM_PUSH_AFTER_EOF:KYe,ERR_STREAM_UNSHIFT_AFTER_END_EVENT:qYe}}=za(),{validateObject:LYe}=g5(),ub=IYe("kPaused"),{StringDecoder:Zme}=Yw(),FYe=hL();Yme(Ar.prototype,Jm.prototype);Yme(Ar,Jm);var yL=()=>{},{errorOrDestroy:Y2}=Z2;function bL(t,e,r){typeof r!="boolean"&&(r=e instanceof Uf()),this.objectMode=!!(t&&t.objectMode),r&&(this.objectMode=this.objectMode||!!(t&&t.readableObjectMode)),this.highWaterMark=t?CYe(this,t,"readableHighWaterMark",r):jYe(!1),this.buffer=new DYe,this.length=0,this.pipes=[],this.flowing=null,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.constructed=!0,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.resumeScheduled=!1,this[ub]=null,this.errorEmitted=!1,this.emitClose=!t||t.emitClose!==!1,this.autoDestroy=!t||t.autoDestroy!==!1,this.destroyed=!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.awaitDrainWriters=null,this.multiAwaitDrain=!1,this.readingMore=!1,this.dataEmitted=!1,this.decoder=null,this.encoding=null,t&&t.encoding&&(this.decoder=new Zme(t.encoding),this.encoding=t.encoding)}function Ar(t){if(!(this instanceof Ar))return new Ar(t);let e=this instanceof Uf();this._readableState=new bL(t,this,e),t&&(typeof t.read=="function"&&(this._read=t.read),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.construct=="function"&&(this._construct=t.construct),t.signal&&!e&&OYe(t.signal,this)),Jm.call(this,t),Z2.construct(this,()=>{this._readableState.needReadable&&PI(this,this._readableState)})}Ar.prototype.destroy=Z2.destroy;Ar.prototype._undestroy=Z2.undestroy;Ar.prototype._destroy=function(t,e){e(t)};Ar.prototype[RYe.captureRejectionSymbol]=function(t){this.destroy(t)};Ar.prototype.push=function(t,e){return Xme(this,t,e,!1)};Ar.prototype.unshift=function(t,e){return Xme(this,t,e,!0)};function Xme(t,e,r,n){Kr("readableAddChunk",e);let i=t._readableState,o;if(i.objectMode||(typeof e=="string"?(r=r||i.defaultEncoding,i.encoding!==r&&(n&&i.encoding?e=pL.from(e,r).toString(i.encoding):(e=pL.from(e,r),r=""))):e instanceof pL?r="":Jm._isUint8Array(e)?(e=Jm._uint8ArrayToBuffer(e),r=""):e!=null&&(o=new $Ye("chunk",["string","Buffer","Uint8Array"],e))),o)Y2(t,o);else if(e===null)i.reading=!1,HYe(t,i);else if(i.objectMode||e&&e.length>0)if(n)if(i.endEmitted)Y2(t,new qYe);else{if(i.destroyed||i.errored)return!1;mL(t,i,e,!0)}else if(i.ended)Y2(t,new KYe);else{if(i.destroyed||i.errored)return!1;i.reading=!1,i.decoder&&!r?(e=i.decoder.write(e),i.objectMode||e.length!==0?mL(t,i,e,!1):PI(t,i)):mL(t,i,e,!1)}else n||(i.reading=!1,PI(t,i));return!i.ended&&(i.length<i.highWaterMark||i.length===0)}function mL(t,e,r,n){e.flowing&&e.length===0&&!e.sync&&t.listenerCount("data")>0?(e.multiAwaitDrain?e.awaitDrainWriters.clear():e.awaitDrainWriters=null,e.dataEmitted=!0,t.emit("data",r)):(e.length+=e.objectMode?1:r.length,n?e.buffer.unshift(r):e.buffer.push(r),e.needReadable&&II(t)),PI(t,e)}Ar.prototype.isPaused=function(){let t=this._readableState;return t[ub]===!0||t.flowing===!1};Ar.prototype.setEncoding=function(t){let e=new Zme(t);this._readableState.decoder=e,this._readableState.encoding=this._readableState.decoder.encoding;let r=this._readableState.buffer,n="";for(let i of r)n+=e.write(i);return r.clear(),n!==""&&r.push(n),this._readableState.length=n.length,this};var zYe=1073741824;function VYe(t){if(t>zYe)throw new UYe("size","<= 1GiB",t);return t--,t|=t>>>1,t|=t>>>2,t|=t>>>4,t|=t>>>8,t|=t>>>16,t++,t}function Gme(t,e){return t<=0||e.length===0&&e.ended?0:e.objectMode?1:EYe(t)?e.flowing&&e.length?e.buffer.first().length:e.length:t<=e.length?t:e.ended?e.length:0}Ar.prototype.read=function(t){Kr("read",t),t===void 0?t=NaN:xYe(t)||(t=SYe(t,10));let e=this._readableState,r=t;if(t>e.highWaterMark&&(e.highWaterMark=VYe(t)),t!==0&&(e.emittedReadable=!1),t===0&&e.needReadable&&((e.highWaterMark!==0?e.length>=e.highWaterMark:e.length>0)||e.ended))return Kr("read: emitReadable",e.length,e.ended),e.length===0&&e.ended?gL(this):II(this),null;if(t=Gme(t,e),t===0&&e.ended)return e.length===0&&gL(this),null;let n=e.needReadable;if(Kr("need readable",n),(e.length===0||e.length-t<e.highWaterMark)&&(n=!0,Kr("length less than watermark",n)),e.ended||e.reading||e.destroyed||e.errored||!e.constructed)n=!1,Kr("reading, ended or constructing",n);else if(n){Kr("do read"),e.reading=!0,e.sync=!0,e.length===0&&(e.needReadable=!0);try{this._read(e.highWaterMark)}catch(o){Y2(this,o)}e.sync=!1,e.reading||(t=Gme(r,e))}let i;return t>0?i=n0e(t,e):i=null,i===null?(e.needReadable=e.length<=e.highWaterMark,t=0):(e.length-=t,e.multiAwaitDrain?e.awaitDrainWriters.clear():e.awaitDrainWriters=null),e.length===0&&(e.ended||(e.needReadable=!0),r!==t&&e.ended&&gL(this)),i!==null&&!e.errorEmitted&&!e.closeEmitted&&(e.dataEmitted=!0,this.emit("data",i)),i};function HYe(t,e){if(Kr("onEofChunk"),!e.ended){if(e.decoder){let r=e.decoder.end();r&&r.length&&(e.buffer.push(r),e.length+=e.objectMode?1:r.length)}e.ended=!0,e.sync?II(t):(e.needReadable=!1,e.emittedReadable=!0,Qme(t))}}function II(t){let e=t._readableState;Kr("emitReadable",e.needReadable,e.emittedReadable),e.needReadable=!1,e.emittedReadable||(Kr("emitReadable",e.flowing),e.emittedReadable=!0,fl.nextTick(Qme,t))}function Qme(t){let e=t._readableState;Kr("emitReadable_",e.destroyed,e.length,e.ended),!e.destroyed&&!e.errored&&(e.length||e.ended)&&(t.emit("readable"),e.emittedReadable=!1),e.needReadable=!e.flowing&&!e.ended&&e.length<=e.highWaterMark,t0e(t)}function PI(t,e){!e.readingMore&&e.constructed&&(e.readingMore=!0,fl.nextTick(WYe,t,e))}function WYe(t,e){for(;!e.reading&&!e.ended&&(e.length<e.highWaterMark||e.flowing&&e.length===0);){let r=e.length;if(Kr("maybeReadMore read 0"),t.read(0),r===e.length)break}e.readingMore=!1}Ar.prototype._read=function(t){throw new NYe("_read()")};Ar.prototype.pipe=function(t,e){let r=this,n=this._readableState;n.pipes.length===1&&(n.multiAwaitDrain||(n.multiAwaitDrain=!0,n.awaitDrainWriters=new kYe(n.awaitDrainWriters?[n.awaitDrainWriters]:[]))),n.pipes.push(t),Kr("pipe count=%d opts=%j",n.pipes.length,e);let o=(!e||e.end!==!1)&&t!==fl.stdout&&t!==fl.stderr?a:x;n.endEmitted?fl.nextTick(o):r.once("end",o),t.on("unpipe",s);function s(S,A){Kr("onunpipe"),S===r&&A&&A.hasUnpiped===!1&&(A.hasUnpiped=!0,c())}function a(){Kr("onend"),t.end()}let d,u=!1;function c(){Kr("cleanup"),t.removeListener("close",g),t.removeListener("finish",v),d&&t.removeListener("drain",d),t.removeListener("error",y),t.removeListener("unpipe",s),r.removeListener("end",a),r.removeListener("end",x),r.removeListener("data",h),u=!0,d&&n.awaitDrainWriters&&(!t._writableState||t._writableState.needDrain)&&d()}function l(){u||(n.pipes.length===1&&n.pipes[0]===t?(Kr("false write response, pause",0),n.awaitDrainWriters=t,n.multiAwaitDrain=!1):n.pipes.length>1&&n.pipes.includes(t)&&(Kr("false write response, pause",n.awaitDrainWriters.size),n.awaitDrainWriters.add(t)),r.pause()),d||(d=GYe(r,t),t.on("drain",d))}r.on("data",h);function h(S){Kr("ondata");let A=t.write(S);Kr("dest.write",A),A===!1&&l()}function y(S){if(Kr("onerror",S),x(),t.removeListener("error",y),t.listenerCount("error")===0){let A=t._writableState||t._readableState;A&&!A.errorEmitted?Y2(t,S):t.emit("error",S)}}BYe(t,"error",y);function g(){t.removeListener("finish",v),x()}t.once("close",g);function v(){Kr("onfinish"),t.removeListener("close",g),x()}t.once("finish",v);function x(){Kr("unpipe"),r.unpipe(t)}return t.emit("pipe",r),t.writableNeedDrain===!0?n.flowing&&l():n.flowing||(Kr("pipe resume"),r.resume()),t};function GYe(t,e){return function(){let n=t._readableState;n.awaitDrainWriters===e?(Kr("pipeOnDrain",1),n.awaitDrainWriters=null):n.multiAwaitDrain&&(Kr("pipeOnDrain",n.awaitDrainWriters.size),n.awaitDrainWriters.delete(e)),(!n.awaitDrainWriters||n.awaitDrainWriters.size===0)&&t.listenerCount("data")&&t.resume()}}Ar.prototype.unpipe=function(t){let e=this._readableState,r={hasUnpiped:!1};if(e.pipes.length===0)return this;if(!t){let i=e.pipes;e.pipes=[],this.pause();for(let o=0;o<i.length;o++)i[o].emit("unpipe",this,{hasUnpiped:!1});return this}let n=_Ye(e.pipes,t);return n===-1?this:(e.pipes.splice(n,1),e.pipes.length===0&&this.pause(),t.emit("unpipe",this,r),this)};Ar.prototype.on=function(t,e){let r=Jm.prototype.on.call(this,t,e),n=this._readableState;return t==="data"?(n.readableListening=this.listenerCount("readable")>0,n.flowing!==!1&&this.resume()):t==="readable"&&!n.endEmitted&&!n.readableListening&&(n.readableListening=n.needReadable=!0,n.flowing=!1,n.emittedReadable=!1,Kr("on readable",n.length,n.reading),n.length?II(this):n.reading||fl.nextTick(JYe,this)),r};Ar.prototype.addListener=Ar.prototype.on;Ar.prototype.removeListener=function(t,e){let r=Jm.prototype.removeListener.call(this,t,e);return t==="readable"&&fl.nextTick(e0e,this),r};Ar.prototype.off=Ar.prototype.removeListener;Ar.prototype.removeAllListeners=function(t){let e=Jm.prototype.removeAllListeners.apply(this,arguments);return(t==="readable"||t===void 0)&&fl.nextTick(e0e,this),e};function e0e(t){let e=t._readableState;e.readableListening=t.listenerCount("readable")>0,e.resumeScheduled&&e[ub]===!1?e.flowing=!0:t.listenerCount("data")>0?t.resume():e.readableListening||(e.flowing=null)}function JYe(t){Kr("readable nexttick read 0"),t.read(0)}Ar.prototype.resume=function(){let t=this._readableState;return t.flowing||(Kr("resume"),t.flowing=!t.readableListening,YYe(this,t)),t[ub]=!1,this};function YYe(t,e){e.resumeScheduled||(e.resumeScheduled=!0,fl.nextTick(ZYe,t,e))}function ZYe(t,e){Kr("resume",e.reading),e.reading||t.read(0),e.resumeScheduled=!1,t.emit("resume"),t0e(t),e.flowing&&!e.reading&&t.read(0)}Ar.prototype.pause=function(){return Kr("call pause flowing=%j",this._readableState.flowing),this._readableState.flowing!==!1&&(Kr("pause"),this._readableState.flowing=!1,this.emit("pause")),this._readableState[ub]=!0,this};function t0e(t){let e=t._readableState;for(Kr("flow",e.flowing);e.flowing&&t.read()!==null;);}Ar.prototype.wrap=function(t){let e=!1;t.on("data",n=>{!this.push(n)&&t.pause&&(e=!0,t.pause())}),t.on("end",()=>{this.push(null)}),t.on("error",n=>{Y2(this,n)}),t.on("close",()=>{this.destroy()}),t.on("destroy",()=>{this.destroy()}),this._read=()=>{e&&t.resume&&(e=!1,t.resume())};let r=TYe(t);for(let n=1;n<r.length;n++){let i=r[n];this[i]===void 0&&typeof t[i]=="function"&&(this[i]=t[i].bind(t))}return this};Ar.prototype[PYe]=function(){return r0e(this)};Ar.prototype.iterator=function(t){return t!==void 0&&LYe(t,"options"),r0e(this,t)};function r0e(t,e){typeof t.read!="function"&&(t=Ar.wrap(t,{objectMode:!0}));let r=XYe(t,e);return r.stream=t,r}async function*XYe(t,e){let r=yL;function n(s){this===t?(r(),r=yL):r=s}t.on("readable",n);let i,o=MYe(t,{writable:!1},s=>{i=s?Wme(i,s):null,r(),r=yL});try{for(;;){let s=t.destroyed?null:t.read();if(s!==null)yield s;else{if(i)throw i;if(i===null)return;await new AYe(n)}}}catch(s){throw i=Wme(i,s),i}finally{(i||e?.destroyOnReturn!==!1)&&(i===void 0||t._readableState.autoDestroy)?Z2.destroyer(t,null):(t.off("readable",n),o())}}Jme(Ar.prototype,{readable:{__proto__:null,get(){let t=this._readableState;return!!t&&t.readable!==!1&&!t.destroyed&&!t.errorEmitted&&!t.endEmitted},set(t){this._readableState&&(this._readableState.readable=!!t)}},readableDidRead:{__proto__:null,enumerable:!1,get:function(){return this._readableState.dataEmitted}},readableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._readableState.readable!==!1&&(this._readableState.destroyed||this._readableState.errored)&&!this._readableState.endEmitted)}},readableHighWaterMark:{__proto__:null,enumerable:!1,get:function(){return this._readableState.highWaterMark}},readableBuffer:{__proto__:null,enumerable:!1,get:function(){return this._readableState&&this._readableState.buffer}},readableFlowing:{__proto__:null,enumerable:!1,get:function(){return this._readableState.flowing},set:function(t){this._readableState&&(this._readableState.flowing=t)}},readableLength:{__proto__:null,enumerable:!1,get(){return this._readableState.length}},readableObjectMode:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.objectMode:!1}},readableEncoding:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.encoding:null}},errored:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.errored:null}},closed:{__proto__:null,get(){return this._readableState?this._readableState.closed:!1}},destroyed:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.destroyed:!1},set(t){this._readableState&&(this._readableState.destroyed=t)}},readableEnded:{__proto__:null,enumerable:!1,get(){return this._readableState?this._readableState.endEmitted:!1}}});Jme(bL.prototype,{pipesCount:{__proto__:null,get(){return this.pipes.length}},paused:{__proto__:null,get(){return this[ub]!==!1},set(t){this[ub]=!!t}}});Ar._fromList=n0e;function n0e(t,e){if(e.length===0)return null;let r;return e.objectMode?r=e.buffer.shift():!t||t>=e.length?(e.decoder?r=e.buffer.join(""):e.buffer.length===1?r=e.buffer.first():r=e.buffer.concat(e.length),e.buffer.clear()):r=e.buffer.consume(t,e.decoder),r}function gL(t){let e=t._readableState;Kr("endReadable",e.endEmitted),e.endEmitted||(e.ended=!0,fl.nextTick(QYe,e,t))}function QYe(t,e){if(Kr("endReadableNT",t.endEmitted,t.length),!t.errored&&!t.closeEmitted&&!t.endEmitted&&t.length===0){if(t.endEmitted=!0,e.emit("end"),e.writable&&e.allowHalfOpen===!1)fl.nextTick(eZe,e);else if(t.autoDestroy){let r=e._writableState;(!r||r.autoDestroy&&(r.finished||r.writable===!1))&&e.destroy()}}}function eZe(t){t.writable&&!t.writableEnded&&!t.destroyed&&t.end()}Ar.from=function(t,e){return FYe(Ar,t,e)};var vL;function i0e(){return vL===void 0&&(vL={}),vL}Ar.fromWeb=function(t,e){return i0e().newStreamReadableFromReadableStream(t,e)};Ar.toWeb=function(t,e){return i0e().newReadableStreamFromStreamReadable(t,e)};Ar.wrap=function(t,e){var r,n;return new Ar({objectMode:(r=(n=t.readableObjectMode)!==null&&n!==void 0?n:t.objectMode)!==null&&r!==void 0?r:!0,...e,destroy(i,o){Z2.destroyer(t,i),o(i)}}).wrap(t)}});var AL=W((PIt,g0e)=>{f();var lb=Fs(),{ArrayPrototypeSlice:c0e,Error:tZe,FunctionPrototypeSymbolHasInstance:d0e,ObjectDefineProperty:u0e,ObjectDefineProperties:rZe,ObjectSetPrototypeOf:l0e,StringPrototypeToLowerCase:nZe,Symbol:iZe,SymbolHasInstance:oZe}=eo();g0e.exports=pi;pi.WritableState=x5;var{EventEmitter:sZe}=Ba(),w5=SI().Stream,{Buffer:RI}=bn(),MI=db(),{addAbortSignal:aZe}=v5(),{getHighWaterMark:cZe,getDefaultHighWaterMark:dZe}=kI(),{ERR_INVALID_ARG_TYPE:uZe,ERR_METHOD_NOT_IMPLEMENTED:lZe,ERR_MULTIPLE_CALLBACK:f0e,ERR_STREAM_CANNOT_PIPE:fZe,ERR_STREAM_DESTROYED:_5,ERR_STREAM_ALREADY_FINISHED:hZe,ERR_STREAM_NULL_VALUES:pZe,ERR_STREAM_WRITE_AFTER_END:yZe,ERR_UNKNOWN_ENCODING:h0e}=za().codes,{errorOrDestroy:X2}=MI;l0e(pi.prototype,w5.prototype);l0e(pi,w5);function xL(){}var Q2=iZe("kOnFinished");function x5(t,e,r){typeof r!="boolean"&&(r=e instanceof Uf()),this.objectMode=!!(t&&t.objectMode),r&&(this.objectMode=this.objectMode||!!(t&&t.writableObjectMode)),this.highWaterMark=t?cZe(this,t,"writableHighWaterMark",r):dZe(!1),this.finalCalled=!1,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1,this.destroyed=!1;let n=!!(t&&t.decodeStrings===!1);this.decodeStrings=!n,this.defaultEncoding=t&&t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.corked=0,this.sync=!0,this.bufferProcessing=!1,this.onwrite=gZe.bind(void 0,e),this.writecb=null,this.writelen=0,this.afterWriteTickInfo=null,OI(this),this.pendingcb=0,this.constructed=!0,this.prefinished=!1,this.errorEmitted=!1,this.emitClose=!t||t.emitClose!==!1,this.autoDestroy=!t||t.autoDestroy!==!1,this.errored=null,this.closed=!1,this.closeEmitted=!1,this[Q2]=[]}function OI(t){t.buffered=[],t.bufferedIndex=0,t.allBuffers=!0,t.allNoop=!0}x5.prototype.getBuffer=function(){return c0e(this.buffered,this.bufferedIndex)};u0e(x5.prototype,"bufferedRequestCount",{__proto__:null,get(){return this.buffered.length-this.bufferedIndex}});function pi(t){let e=this instanceof Uf();if(!e&&!d0e(pi,this))return new pi(t);this._writableState=new x5(t,this,e),t&&(typeof t.write=="function"&&(this._write=t.write),typeof t.writev=="function"&&(this._writev=t.writev),typeof t.destroy=="function"&&(this._destroy=t.destroy),typeof t.final=="function"&&(this._final=t.final),typeof t.construct=="function"&&(this._construct=t.construct),t.signal&&aZe(t.signal,this)),w5.call(this,t),MI.construct(this,()=>{let r=this._writableState;r.writing||SL(this,r),TL(this,r)})}u0e(pi,oZe,{__proto__:null,value:function(t){return d0e(this,t)?!0:this!==pi?!1:t&&t._writableState instanceof x5}});pi.prototype.pipe=function(){X2(this,new fZe)};function p0e(t,e,r,n){let i=t._writableState;if(typeof r=="function")n=r,r=i.defaultEncoding;else{if(!r)r=i.defaultEncoding;else if(r!=="buffer"&&!RI.isEncoding(r))throw new h0e(r);typeof n!="function"&&(n=xL)}if(e===null)throw new pZe;if(!i.objectMode)if(typeof e=="string")i.decodeStrings!==!1&&(e=RI.from(e,r),r="buffer");else if(e instanceof RI)r="buffer";else if(w5._isUint8Array(e))e=w5._uint8ArrayToBuffer(e),r="buffer";else throw new uZe("chunk",["string","Buffer","Uint8Array"],e);let o;return i.ending?o=new yZe:i.destroyed&&(o=new _5("write")),o?(lb.nextTick(n,o),X2(t,o,!0),o):(i.pendingcb++,mZe(t,i,e,r,n))}pi.prototype.write=function(t,e,r){return p0e(this,t,e,r)===!0};pi.prototype.cork=function(){this._writableState.corked++};pi.prototype.uncork=function(){let t=this._writableState;t.corked&&(t.corked--,t.writing||SL(this,t))};pi.prototype.setDefaultEncoding=function(e){if(typeof e=="string"&&(e=nZe(e)),!RI.isEncoding(e))throw new h0e(e);return this._writableState.defaultEncoding=e,this};function mZe(t,e,r,n,i){let o=e.objectMode?1:r.length;e.length+=o;let s=e.length<e.highWaterMark;return s||(e.needDrain=!0),e.writing||e.corked||e.errored||!e.constructed?(e.buffered.push({chunk:r,encoding:n,callback:i}),e.allBuffers&&n!=="buffer"&&(e.allBuffers=!1),e.allNoop&&i!==xL&&(e.allNoop=!1)):(e.writelen=o,e.writecb=i,e.writing=!0,e.sync=!0,t._write(r,n,e.onwrite),e.sync=!1),s&&!e.errored&&!e.destroyed}function s0e(t,e,r,n,i,o,s){e.writelen=n,e.writecb=s,e.writing=!0,e.sync=!0,e.destroyed?e.onwrite(new _5("write")):r?t._writev(i,e.onwrite):t._write(i,o,e.onwrite),e.sync=!1}function a0e(t,e,r,n){--e.pendingcb,n(r),EL(e),X2(t,r)}function gZe(t,e){let r=t._writableState,n=r.sync,i=r.writecb;if(typeof i!="function"){X2(t,new f0e);return}r.writing=!1,r.writecb=null,r.length-=r.writelen,r.writelen=0,e?(e.stack,r.errored||(r.errored=e),t._readableState&&!t._readableState.errored&&(t._readableState.errored=e),n?lb.nextTick(a0e,t,r,e,i):a0e(t,r,e,i)):(r.buffered.length>r.bufferedIndex&&SL(t,r),n?r.afterWriteTickInfo!==null&&r.afterWriteTickInfo.cb===i?r.afterWriteTickInfo.count++:(r.afterWriteTickInfo={count:1,cb:i,stream:t,state:r},lb.nextTick(vZe,r.afterWriteTickInfo)):y0e(t,r,1,i))}function vZe({stream:t,state:e,count:r,cb:n}){return e.afterWriteTickInfo=null,y0e(t,e,r,n)}function y0e(t,e,r,n){for(!e.ending&&!t.destroyed&&e.length===0&&e.needDrain&&(e.needDrain=!1,t.emit("drain"));r-- >0;)e.pendingcb--,n();e.destroyed&&EL(e),TL(t,e)}function EL(t){if(t.writing)return;for(let i=t.bufferedIndex;i<t.buffered.length;++i){var e;let{chunk:o,callback:s}=t.buffered[i],a=t.objectMode?1:o.length;t.length-=a,s((e=t.errored)!==null&&e!==void 0?e:new _5("write"))}let r=t[Q2].splice(0);for(let i=0;i<r.length;i++){var n;r[i]((n=t.errored)!==null&&n!==void 0?n:new _5("end"))}OI(t)}function SL(t,e){if(e.corked||e.bufferProcessing||e.destroyed||!e.constructed)return;let{buffered:r,bufferedIndex:n,objectMode:i}=e,o=r.length-n;if(!o)return;let s=n;if(e.bufferProcessing=!0,o>1&&t._writev){e.pendingcb-=o-1;let a=e.allNoop?xL:u=>{for(let c=s;c<r.length;++c)r[c].callback(u)},d=e.allNoop&&s===0?r:c0e(r,s);d.allBuffers=e.allBuffers,s0e(t,e,!0,e.length,d,"",a),OI(e)}else{do{let{chunk:a,encoding:d,callback:u}=r[s];r[s++]=null;let c=i?1:a.length;s0e(t,e,!1,c,a,d,u)}while(s<r.length&&!e.writing);s===r.length?OI(e):s>256?(r.splice(0,s),e.bufferedIndex=0):e.bufferedIndex=s}e.bufferProcessing=!1}pi.prototype._write=function(t,e,r){if(this._writev)this._writev([{chunk:t,encoding:e}],r);else throw new lZe("_write()")};pi.prototype._writev=null;pi.prototype.end=function(t,e,r){let n=this._writableState;typeof t=="function"?(r=t,t=null,e=null):typeof e=="function"&&(r=e,e=null);let i;if(t!=null){let o=p0e(this,t,e);o instanceof tZe&&(i=o)}return n.corked&&(n.corked=1,this.uncork()),i||(!n.errored&&!n.ending?(n.ending=!0,TL(this,n,!0),n.ended=!0):n.finished?i=new hZe("end"):n.destroyed&&(i=new _5("end"))),typeof r=="function"&&(i||n.finished?lb.nextTick(r,i):n[Q2].push(r)),this};function BI(t){return t.ending&&!t.destroyed&&t.constructed&&t.length===0&&!t.errored&&t.buffered.length===0&&!t.finished&&!t.writing&&!t.errorEmitted&&!t.closeEmitted}function bZe(t,e){let r=!1;function n(i){if(r){X2(t,i??f0e());return}if(r=!0,e.pendingcb--,i){let o=e[Q2].splice(0);for(let s=0;s<o.length;s++)o[s](i);X2(t,i,e.sync)}else BI(e)&&(e.prefinished=!0,t.emit("prefinish"),e.pendingcb++,lb.nextTick(_L,t,e))}e.sync=!0,e.pendingcb++;try{t._final(n)}catch(i){n(i)}e.sync=!1}function wZe(t,e){!e.prefinished&&!e.finalCalled&&(typeof t._final=="function"&&!e.destroyed?(e.finalCalled=!0,bZe(t,e)):(e.prefinished=!0,t.emit("prefinish")))}function TL(t,e,r){BI(e)&&(wZe(t,e),e.pendingcb===0&&(r?(e.pendingcb++,lb.nextTick((n,i)=>{BI(i)?_L(n,i):i.pendingcb--},t,e)):BI(e)&&(e.pendingcb++,_L(t,e))))}function _L(t,e){e.pendingcb--,e.finished=!0;let r=e[Q2].splice(0);for(let n=0;n<r.length;n++)r[n]();if(t.emit("finish"),e.autoDestroy){let n=t._readableState;(!n||n.autoDestroy&&(n.endEmitted||n.readable===!1))&&t.destroy()}}rZe(pi.prototype,{closed:{__proto__:null,get(){return this._writableState?this._writableState.closed:!1}},destroyed:{__proto__:null,get(){return this._writableState?this._writableState.destroyed:!1},set(t){this._writableState&&(this._writableState.destroyed=t)}},writable:{__proto__:null,get(){let t=this._writableState;return!!t&&t.writable!==!1&&!t.destroyed&&!t.errored&&!t.ending&&!t.ended},set(t){this._writableState&&(this._writableState.writable=!!t)}},writableFinished:{__proto__:null,get(){return this._writableState?this._writableState.finished:!1}},writableObjectMode:{__proto__:null,get(){return this._writableState?this._writableState.objectMode:!1}},writableBuffer:{__proto__:null,get(){return this._writableState&&this._writableState.getBuffer()}},writableEnded:{__proto__:null,get(){return this._writableState?this._writableState.ending:!1}},writableNeedDrain:{__proto__:null,get(){let t=this._writableState;return t?!t.destroyed&&!t.ending&&t.needDrain:!1}},writableHighWaterMark:{__proto__:null,get(){return this._writableState&&this._writableState.highWaterMark}},writableCorked:{__proto__:null,get(){return this._writableState?this._writableState.corked:0}},writableLength:{__proto__:null,get(){return this._writableState&&this._writableState.length}},errored:{__proto__:null,enumerable:!1,get(){return this._writableState?this._writableState.errored:null}},writableAborted:{__proto__:null,enumerable:!1,get:function(){return!!(this._writableState.writable!==!1&&(this._writableState.destroyed||this._writableState.errored)&&!this._writableState.finished)}}});var _Ze=MI.destroy;pi.prototype.destroy=function(t,e){let r=this._writableState;return!r.destroyed&&(r.bufferedIndex<r.buffered.length||r[Q2].length)&&lb.nextTick(EL,r),_Ze.call(this,t,e),this};pi.prototype._undestroy=MI.undestroy;pi.prototype._destroy=function(t,e){e(t)};pi.prototype[sZe.captureRejectionSymbol]=function(t){this.destroy(t)};var wL;function m0e(){return wL===void 0&&(wL={}),wL}pi.fromWeb=function(t,e){return m0e().newStreamWritableFromWritableStream(t,e)};pi.toWeb=function(t){return m0e().newWritableStreamFromStreamWritable(t)}});var I0e=W((RIt,P0e)=>{f();var kL=Fs(),xZe=bn(),{isReadable:EZe,isWritable:SZe,isIterable:v0e,isNodeStream:TZe,isReadableNodeStream:b0e,isWritableNodeStream:w0e,isDuplexNodeStream:AZe}=$f(),_0e=vp(),{AbortError:k0e,codes:{ERR_INVALID_ARG_TYPE:kZe,ERR_INVALID_RETURN_VALUE:x0e}}=za(),{destroyer:e_}=db(),PZe=Uf(),IZe=b5(),{createDeferredPromise:E0e}=Cf(),S0e=hL(),T0e=globalThis.Blob||xZe.Blob,RZe=typeof T0e<"u"?function(e){return e instanceof T0e}:function(e){return!1},BZe=globalThis.AbortController||zh().AbortController,{FunctionPrototypeCall:A0e}=eo(),fb=class extends PZe{constructor(e){super(e),e?.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),e?.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)}};P0e.exports=function t(e,r){if(AZe(e))return e;if(b0e(e))return DI({readable:e});if(w0e(e))return DI({writable:e});if(TZe(e))return DI({writable:!1,readable:!1});if(typeof e=="function"){let{value:i,write:o,final:s,destroy:a}=OZe(e);if(v0e(i))return S0e(fb,i,{objectMode:!0,write:o,final:s,destroy:a});let d=i?.then;if(typeof d=="function"){let u,c=A0e(d,i,l=>{if(l!=null)throw new x0e("nully","body",l)},l=>{e_(u,l)});return u=new fb({objectMode:!0,readable:!1,write:o,final(l){s(async()=>{try{await c,kL.nextTick(l,null)}catch(h){kL.nextTick(l,h)}})},destroy:a})}throw new x0e("Iterable, AsyncIterable or AsyncFunction",r,i)}if(RZe(e))return t(e.arrayBuffer());if(v0e(e))return S0e(fb,e,{objectMode:!0,writable:!1});if(typeof e?.writable=="object"||typeof e?.readable=="object"){let i=e!=null&&e.readable?b0e(e?.readable)?e?.readable:t(e.readable):void 0,o=e!=null&&e.writable?w0e(e?.writable)?e?.writable:t(e.writable):void 0;return DI({readable:i,writable:o})}let n=e?.then;if(typeof n=="function"){let i;return A0e(n,e,o=>{o!=null&&i.push(o),i.push(null)},o=>{e_(i,o)}),i=new fb({objectMode:!0,writable:!1,read(){}})}throw new kZe(r,["Blob","ReadableStream","WritableStream","Stream","Iterable","AsyncIterable","Function","{ readable, writable } pair","Promise"],e)};function OZe(t){let{promise:e,resolve:r}=E0e(),n=new BZe,i=n.signal;return{value:t(async function*(){for(;;){let s=e;e=null;let{chunk:a,done:d,cb:u}=await s;if(kL.nextTick(u),d)return;if(i.aborted)throw new k0e(void 0,{cause:i.reason});({promise:e,resolve:r}=E0e()),yield a}}(),{signal:i}),write(s,a,d){let u=r;r=null,u({chunk:s,done:!1,cb:d})},final(s){let a=r;r=null,a({done:!0,cb:s})},destroy(s,a){n.abort(),a(s)}}}function DI(t){let e=t.readable&&typeof t.readable.read!="function"?IZe.wrap(t.readable):t.readable,r=t.writable,n=!!EZe(e),i=!!SZe(r),o,s,a,d,u;function c(l){let h=d;d=null,h?h(l):l&&u.destroy(l)}return u=new fb({readableObjectMode:!!(e!=null&&e.readableObjectMode),writableObjectMode:!!(r!=null&&r.writableObjectMode),readable:n,writable:i}),i&&(_0e(r,l=>{i=!1,l&&e_(e,l),c(l)}),u._write=function(l,h,y){r.write(l,h)?y():o=y},u._final=function(l){r.end(),s=l},r.on("drain",function(){if(o){let l=o;o=null,l()}}),r.on("finish",function(){if(s){let l=s;s=null,l()}})),n&&(_0e(e,l=>{n=!1,l&&e_(e,l),c(l)}),e.on("readable",function(){if(a){let l=a;a=null,l()}}),e.on("end",function(){u.push(null)}),u._read=function(){for(;;){let l=e.read();if(l===null){a=u._read;return}if(!u.push(l))return}}),u._destroy=function(l,h){!l&&d!==null&&(l=new k0e),a=null,o=null,s=null,d===null?h(l):(d=h,e_(r,l),e_(e,l))},u}});var Uf=W((OIt,O0e)=>{"use strict";f();var{ObjectDefineProperties:MZe,ObjectGetOwnPropertyDescriptor:bp,ObjectKeys:DZe,ObjectSetPrototypeOf:R0e}=eo();O0e.exports=hl;var RL=b5(),iu=AL();R0e(hl.prototype,RL.prototype);R0e(hl,RL);{let t=DZe(iu.prototype);for(let e=0;e<t.length;e++){let r=t[e];hl.prototype[r]||(hl.prototype[r]=iu.prototype[r])}}function hl(t){if(!(this instanceof hl))return new hl(t);RL.call(this,t),iu.call(this,t),t?(this.allowHalfOpen=t.allowHalfOpen!==!1,t.readable===!1&&(this._readableState.readable=!1,this._readableState.ended=!0,this._readableState.endEmitted=!0),t.writable===!1&&(this._writableState.writable=!1,this._writableState.ending=!0,this._writableState.ended=!0,this._writableState.finished=!0)):this.allowHalfOpen=!0}MZe(hl.prototype,{writable:{__proto__:null,...bp(iu.prototype,"writable")},writableHighWaterMark:{__proto__:null,...bp(iu.prototype,"writableHighWaterMark")},writableObjectMode:{__proto__:null,...bp(iu.prototype,"writableObjectMode")},writableBuffer:{__proto__:null,...bp(iu.prototype,"writableBuffer")},writableLength:{__proto__:null,...bp(iu.prototype,"writableLength")},writableFinished:{__proto__:null,...bp(iu.prototype,"writableFinished")},writableCorked:{__proto__:null,...bp(iu.prototype,"writableCorked")},writableEnded:{__proto__:null,...bp(iu.prototype,"writableEnded")},writableNeedDrain:{__proto__:null,...bp(iu.prototype,"writableNeedDrain")},destroyed:{__proto__:null,get(){return this._readableState===void 0||this._writableState===void 0?!1:this._readableState.destroyed&&this._writableState.destroyed},set(t){this._readableState&&this._writableState&&(this._readableState.destroyed=t,this._writableState.destroyed=t)}}});var PL;function B0e(){return PL===void 0&&(PL={}),PL}hl.fromWeb=function(t,e){return B0e().newStreamDuplexFromReadableWritablePair(t,e)};hl.toWeb=function(t){return B0e().newReadableWritablePairFromDuplex(t)};var IL;hl.from=function(t){return IL||(IL=I0e()),IL(t,"body")}});var ML=W((DIt,D0e)=>{"use strict";f();var{ObjectSetPrototypeOf:M0e,Symbol:CZe}=eo();D0e.exports=wp;var{ERR_METHOD_NOT_IMPLEMENTED:jZe}=za().codes,OL=Uf(),{getHighWaterMark:$Ze}=kI();M0e(wp.prototype,OL.prototype);M0e(wp,OL);var E5=CZe("kCallback");function wp(t){if(!(this instanceof wp))return new wp(t);let e=t?$Ze(this,t,"readableHighWaterMark",!0):null;e===0&&(t={...t,highWaterMark:null,readableHighWaterMark:e,writableHighWaterMark:t.writableHighWaterMark||0}),OL.call(this,t),this._readableState.sync=!1,this[E5]=null,t&&(typeof t.transform=="function"&&(this._transform=t.transform),typeof t.flush=="function"&&(this._flush=t.flush)),this.on("prefinish",NZe)}function BL(t){typeof this._flush=="function"&&!this.destroyed?this._flush((e,r)=>{if(e){t?t(e):this.destroy(e);return}r!=null&&this.push(r),this.push(null),t&&t()}):(this.push(null),t&&t())}function NZe(){this._final!==BL&&BL.call(this)}wp.prototype._final=BL;wp.prototype._transform=function(t,e,r){throw new jZe("_transform()")};wp.prototype._write=function(t,e,r){let n=this._readableState,i=this._writableState,o=n.length;this._transform(t,e,(s,a)=>{if(s){r(s);return}a!=null&&this.push(a),i.ended||o===n.length||n.length<n.highWaterMark?r():this[E5]=r})};wp.prototype._read=function(){if(this[E5]){let t=this[E5];this[E5]=null,t()}}});var CL=W((jIt,j0e)=>{"use strict";f();var{ObjectSetPrototypeOf:C0e}=eo();j0e.exports=t_;var DL=ML();C0e(t_.prototype,DL.prototype);C0e(t_,DL);function t_(t){if(!(this instanceof t_))return new t_(t);DL.call(this,t)}t_.prototype._transform=function(t,e,r){r(null,t)}});var NI=W((NIt,q0e)=>{f();var S5=Fs(),{ArrayIsArray:UZe,Promise:KZe,SymbolAsyncIterator:qZe}=eo(),$I=vp(),{once:LZe}=Cf(),FZe=db(),$0e=Uf(),{aggregateTwoErrors:zZe,codes:{ERR_INVALID_ARG_TYPE:FL,ERR_INVALID_RETURN_VALUE:jL,ERR_MISSING_ARGS:VZe,ERR_STREAM_DESTROYED:HZe,ERR_STREAM_PREMATURE_CLOSE:WZe},AbortError:GZe}=za(),{validateFunction:JZe,validateAbortSignal:YZe}=g5(),{isIterable:hb,isReadable:$L,isReadableNodeStream:jI,isNodeStream:N0e,isTransformStream:r_,isWebStream:ZZe,isReadableStream:NL,isReadableEnded:XZe}=$f(),QZe=globalThis.AbortController||zh().AbortController,UL,KL;function U0e(t,e,r){let n=!1;t.on("close",()=>{n=!0});let i=$I(t,{readable:e,writable:r},o=>{n=!o});return{destroy:o=>{n||(n=!0,FZe.destroyer(t,o||new HZe("pipe")))},cleanup:i}}function eXe(t){return JZe(t[t.length-1],"streams[stream.length - 1]"),t.pop()}function qL(t){if(hb(t))return t;if(jI(t))return tXe(t);throw new FL("val",["Readable","Iterable","AsyncIterable"],t)}async function*tXe(t){KL||(KL=b5()),yield*KL.prototype[qZe].call(t)}async function CI(t,e,r,{end:n}){let i,o=null,s=u=>{if(u&&(i=u),o){let c=o;o=null,c()}},a=()=>new KZe((u,c)=>{i?c(i):o=()=>{i?c(i):u()}});e.on("drain",s);let d=$I(e,{readable:!1},s);try{e.writableNeedDrain&&await a();for await(let u of t)e.write(u)||await a();n&&e.end(),await a(),r()}catch(u){r(i!==u?zZe(i,u):u)}finally{d(),e.off("drain",s)}}async function LL(t,e,r,{end:n}){r_(e)&&(e=e.writable);let i=e.getWriter();try{for await(let o of t)await i.ready,i.write(o).catch(()=>{});await i.ready,n&&await i.close(),r()}catch(o){try{await i.abort(o),r(o)}catch(s){r(s)}}}function rXe(...t){return K0e(t,LZe(eXe(t)))}function K0e(t,e,r){if(t.length===1&&UZe(t[0])&&(t=t[0]),t.length<2)throw new VZe("streams");let n=new QZe,i=n.signal,o=r?.signal,s=[];YZe(o,"options.signal");function a(){y(new GZe)}o?.addEventListener("abort",a);let d,u,c=[],l=0;function h(A){y(A,--l===0)}function y(A,T){if(A&&(!d||d.code==="ERR_STREAM_PREMATURE_CLOSE")&&(d=A),!(!d&&!T)){for(;c.length;)c.shift()(d);o?.removeEventListener("abort",a),n.abort(),T&&(d||s.forEach($=>$()),S5.nextTick(e,d,u))}}let g;for(let A=0;A<t.length;A++){let T=t[A],$=A<t.length-1,j=A>0,K=$||r?.end!==!1,F=A===t.length-1;if(N0e(T)){let L=function(V){V&&V.name!=="AbortError"&&V.code!=="ERR_STREAM_PREMATURE_CLOSE"&&h(V)};var S=L;if(K){let{destroy:V,cleanup:q}=U0e(T,$,j);c.push(V),$L(T)&&F&&s.push(q)}T.on("error",L),$L(T)&&F&&s.push(()=>{T.removeListener("error",L)})}if(A===0)if(typeof T=="function"){if(g=T({signal:i}),!hb(g))throw new jL("Iterable, AsyncIterable or Stream","source",g)}else hb(T)||jI(T)||r_(T)?g=T:g=$0e.from(T);else if(typeof T=="function"){if(r_(g)){var v;g=qL((v=g)===null||v===void 0?void 0:v.readable)}else g=qL(g);if(g=T(g,{signal:i}),$){if(!hb(g,!0))throw new jL("AsyncIterable",`transform[${A-1}]`,g)}else{var x;UL||(UL=CL());let L=new UL({objectMode:!0}),V=(x=g)===null||x===void 0?void 0:x.then;if(typeof V=="function")l++,V.call(g,P=>{u=P,P!=null&&L.write(P),K&&L.end(),S5.nextTick(h)},P=>{L.destroy(P),S5.nextTick(h,P)});else if(hb(g,!0))l++,CI(g,L,h,{end:K});else if(NL(g)||r_(g)){let P=g.readable||g;l++,CI(P,L,h,{end:K})}else throw new jL("AsyncIterable or Promise","destination",g);g=L;let{destroy:q,cleanup:k}=U0e(g,!1,!0);c.push(q),F&&s.push(k)}}else if(N0e(T)){if(jI(g)){l+=2;let L=nXe(g,T,h,{end:K});$L(T)&&F&&s.push(L)}else if(r_(g)||NL(g)){let L=g.readable||g;l++,CI(L,T,h,{end:K})}else if(hb(g))l++,CI(g,T,h,{end:K});else throw new FL("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=T}else if(ZZe(T)){if(jI(g))l++,LL(qL(g),T,h,{end:K});else if(NL(g)||hb(g))l++,LL(g,T,h,{end:K});else if(r_(g))l++,LL(g.readable,T,h,{end:K});else throw new FL("val",["Readable","Iterable","AsyncIterable","ReadableStream","TransformStream"],g);g=T}else g=$0e.from(T)}return(i!=null&&i.aborted||o!=null&&o.aborted)&&S5.nextTick(a),g}function nXe(t,e,r,{end:n}){let i=!1;if(e.on("close",()=>{i||r(new WZe)}),t.pipe(e,{end:!1}),n){let s=function(){i=!0,e.end()};var o=s;XZe(t)?S5.nextTick(s):t.once("end",s)}else r();return $I(t,{readable:!0,writable:!1},s=>{let a=t._readableState;s&&s.code==="ERR_STREAM_PREMATURE_CLOSE"&&a&&a.ended&&!a.errored&&!a.errorEmitted?t.once("end",r).once("error",r):r(s)}),$I(e,{readable:!1,writable:!0},r)}q0e.exports={pipelineImpl:K0e,pipeline:rXe}});var VL=W((KIt,W0e)=>{"use strict";f();var{pipeline:iXe}=NI(),UI=Uf(),{destroyer:oXe}=db(),{isNodeStream:KI,isReadable:L0e,isWritable:F0e,isWebStream:zL,isTransformStream:pb,isWritableStream:z0e,isReadableStream:V0e}=$f(),{AbortError:sXe,codes:{ERR_INVALID_ARG_VALUE:H0e,ERR_MISSING_ARGS:aXe}}=za(),cXe=vp();W0e.exports=function(...e){if(e.length===0)throw new aXe("streams");if(e.length===1)return UI.from(e[0]);let r=[...e];if(typeof e[0]=="function"&&(e[0]=UI.from(e[0])),typeof e[e.length-1]=="function"){let y=e.length-1;e[y]=UI.from(e[y])}for(let y=0;y<e.length;++y)if(!(!KI(e[y])&&!zL(e[y]))){if(y<e.length-1&&!(L0e(e[y])||V0e(e[y])||pb(e[y])))throw new H0e(`streams[${y}]`,r[y],"must be readable");if(y>0&&!(F0e(e[y])||z0e(e[y])||pb(e[y])))throw new H0e(`streams[${y}]`,r[y],"must be writable")}let n,i,o,s,a;function d(y){let g=s;s=null,g?g(y):y?a.destroy(y):!h&&!l&&a.destroy()}let u=e[0],c=iXe(e,d),l=!!(F0e(u)||z0e(u)||pb(u)),h=!!(L0e(c)||V0e(c)||pb(c));if(a=new UI({writableObjectMode:!!(u!=null&&u.writableObjectMode),readableObjectMode:!!(c!=null&&c.writableObjectMode),writable:l,readable:h}),l){if(KI(u))a._write=function(g,v,x){u.write(g,v)?x():n=x},a._final=function(g){u.end(),i=g},u.on("drain",function(){if(n){let g=n;n=null,g()}});else if(zL(u)){let v=(pb(u)?u.writable:u).getWriter();a._write=async function(x,S,A){try{await v.ready,v.write(x).catch(()=>{}),A()}catch(T){A(T)}},a._final=async function(x){try{await v.ready,v.close().catch(()=>{}),i=x}catch(S){x(S)}}}let y=pb(c)?c.readable:c;cXe(y,()=>{if(i){let g=i;i=null,g()}})}if(h){if(KI(c))c.on("readable",function(){if(o){let y=o;o=null,y()}}),c.on("end",function(){a.push(null)}),a._read=function(){for(;;){let y=c.read();if(y===null){o=a._read;return}if(!a.push(y))return}};else if(zL(c)){let g=(pb(c)?c.readable:c).getReader();a._read=async function(){for(;;)try{let{value:v,done:x}=await g.read();if(!a.push(v))return;if(x){a.push(null);return}}catch{return}}}}return a._destroy=function(y,g){!y&&s!==null&&(y=new sXe),o=null,n=null,i=null,s===null?g(y):(s=g,KI(c)&&oXe(c,y))},a}});var tge=W((LIt,GL)=>{"use strict";f();var Z0e=globalThis.AbortController||zh().AbortController,{codes:{ERR_INVALID_ARG_VALUE:dXe,ERR_INVALID_ARG_TYPE:T5,ERR_MISSING_ARGS:uXe,ERR_OUT_OF_RANGE:lXe},AbortError:Kf}=za(),{validateAbortSignal:yb,validateInteger:fXe,validateObject:mb}=g5(),hXe=eo().Symbol("kWeak"),{finished:pXe}=vp(),yXe=VL(),{addAbortSignalNoValidate:mXe}=v5(),{isWritable:gXe,isNodeStream:vXe}=$f(),{ArrayPrototypePush:bXe,MathFloor:wXe,Number:_Xe,NumberIsNaN:xXe,Promise:G0e,PromiseReject:J0e,PromisePrototypeThen:EXe,Symbol:X0e}=eo(),qI=X0e("kEmpty"),Y0e=X0e("kEof");function SXe(t,e){if(e!=null&&mb(e,"options"),e?.signal!=null&&yb(e.signal,"options.signal"),vXe(t)&&!gXe(t))throw new dXe("stream",t,"must be writable");let r=yXe(this,t);return e!=null&&e.signal&&mXe(e.signal,r),r}function LI(t,e){if(typeof t!="function")throw new T5("fn",["Function","AsyncFunction"],t);e!=null&&mb(e,"options"),e?.signal!=null&&yb(e.signal,"options.signal");let r=1;return e?.concurrency!=null&&(r=wXe(e.concurrency)),fXe(r,"concurrency",1),(async function*(){var i,o;let s=new Z0e,a=this,d=[],u=s.signal,c={signal:u},l=()=>s.abort();e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted&&l(),e==null||(o=e.signal)===null||o===void 0||o.addEventListener("abort",l);let h,y,g=!1;function v(){g=!0}async function x(){try{for await(let T of a){var S;if(g)return;if(u.aborted)throw new Kf;try{T=t(T,c)}catch($){T=J0e($)}T!==qI&&(typeof((S=T)===null||S===void 0?void 0:S.catch)=="function"&&T.catch(v),d.push(T),h&&(h(),h=null),!g&&d.length&&d.length>=r&&await new G0e($=>{y=$}))}d.push(Y0e)}catch(T){let $=J0e(T);EXe($,void 0,v),d.push($)}finally{var A;g=!0,h&&(h(),h=null),e==null||(A=e.signal)===null||A===void 0||A.removeEventListener("abort",l)}}x();try{for(;;){for(;d.length>0;){let S=await d[0];if(S===Y0e)return;if(u.aborted)throw new Kf;S!==qI&&(yield S),d.shift(),y&&(y(),y=null)}await new G0e(S=>{h=S})}}finally{s.abort(),g=!0,y&&(y(),y=null)}}).call(this)}function TXe(t=void 0){return t!=null&&mb(t,"options"),t?.signal!=null&&yb(t.signal,"options.signal"),(async function*(){let r=0;for await(let i of this){var n;if(t!=null&&(n=t.signal)!==null&&n!==void 0&&n.aborted)throw new Kf({cause:t.signal.reason});yield[r++,i]}}).call(this)}async function Q0e(t,e=void 0){for await(let r of WL.call(this,t,e))return!0;return!1}async function AXe(t,e=void 0){if(typeof t!="function")throw new T5("fn",["Function","AsyncFunction"],t);return!await Q0e.call(this,async(...r)=>!await t(...r),e)}async function kXe(t,e){for await(let r of WL.call(this,t,e))return r}async function PXe(t,e){if(typeof t!="function")throw new T5("fn",["Function","AsyncFunction"],t);async function r(n,i){return await t(n,i),qI}for await(let n of LI.call(this,r,e));}function WL(t,e){if(typeof t!="function")throw new T5("fn",["Function","AsyncFunction"],t);async function r(n,i){return await t(n,i)?n:qI}return LI.call(this,r,e)}var HL=class extends uXe{constructor(){super("reduce"),this.message="Reduce of an empty stream requires an initial value"}};async function IXe(t,e,r){var n;if(typeof t!="function")throw new T5("reducer",["Function","AsyncFunction"],t);r!=null&&mb(r,"options"),r?.signal!=null&&yb(r.signal,"options.signal");let i=arguments.length>1;if(r!=null&&(n=r.signal)!==null&&n!==void 0&&n.aborted){let u=new Kf(void 0,{cause:r.signal.reason});throw this.once("error",()=>{}),await pXe(this.destroy(u)),u}let o=new Z0e,s=o.signal;if(r!=null&&r.signal){let u={once:!0,[hXe]:this};r.signal.addEventListener("abort",()=>o.abort(),u)}let a=!1;try{for await(let u of this){var d;if(a=!0,r!=null&&(d=r.signal)!==null&&d!==void 0&&d.aborted)throw new Kf;i?e=await t(e,u,{signal:s}):(e=u,i=!0)}if(!a&&!i)throw new HL}finally{o.abort()}return e}async function RXe(t){t!=null&&mb(t,"options"),t?.signal!=null&&yb(t.signal,"options.signal");let e=[];for await(let n of this){var r;if(t!=null&&(r=t.signal)!==null&&r!==void 0&&r.aborted)throw new Kf(void 0,{cause:t.signal.reason});bXe(e,n)}return e}function BXe(t,e){let r=LI.call(this,t,e);return(async function*(){for await(let i of r)yield*i}).call(this)}function ege(t){if(t=_Xe(t),xXe(t))return 0;if(t<0)throw new lXe("number",">= 0",t);return t}function OXe(t,e=void 0){return e!=null&&mb(e,"options"),e?.signal!=null&&yb(e.signal,"options.signal"),t=ege(t),(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Kf;for await(let o of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new Kf;t--<=0&&(yield o)}}).call(this)}function MXe(t,e=void 0){return e!=null&&mb(e,"options"),e?.signal!=null&&yb(e.signal,"options.signal"),t=ege(t),(async function*(){var n;if(e!=null&&(n=e.signal)!==null&&n!==void 0&&n.aborted)throw new Kf;for await(let o of this){var i;if(e!=null&&(i=e.signal)!==null&&i!==void 0&&i.aborted)throw new Kf;if(t-- >0)yield o;else return}}).call(this)}GL.exports.streamReturningOperators={asIndexedPairs:TXe,drop:OXe,filter:WL,flatMap:BXe,map:LI,take:MXe,compose:SXe};GL.exports.promiseReturningOperators={every:AXe,forEach:PXe,reduce:IXe,toArray:RXe,some:Q0e,find:kXe}});var JL=W((zIt,rge)=>{"use strict";f();var{ArrayPrototypePop:DXe,Promise:CXe}=eo(),{isIterable:jXe,isNodeStream:$Xe,isWebStream:NXe}=$f(),{pipelineImpl:UXe}=NI(),{finished:KXe}=vp();YL();function qXe(...t){return new CXe((e,r)=>{let n,i,o=t[t.length-1];if(o&&typeof o=="object"&&!$Xe(o)&&!jXe(o)&&!NXe(o)){let s=DXe(t);n=s.signal,i=s.end}UXe(t,(s,a)=>{s?r(s):e(a)},{signal:n,end:i})})}rge.exports={finished:KXe,pipeline:qXe}});var YL=W((HIt,lge)=>{f();var{Buffer:LXe}=bn(),{ObjectDefineProperty:_p,ObjectKeys:oge,ReflectApply:sge}=eo(),{promisify:{custom:age}}=Cf(),{streamReturningOperators:nge,promiseReturningOperators:ige}=tge(),{codes:{ERR_ILLEGAL_CONSTRUCTOR:cge}}=za(),FXe=VL(),{pipeline:dge}=NI(),{destroyer:zXe}=db(),uge=vp(),ZL=JL(),XL=$f(),Ki=lge.exports=SI().Stream;Ki.isDisturbed=XL.isDisturbed;Ki.isErrored=XL.isErrored;Ki.isReadable=XL.isReadable;Ki.Readable=b5();for(let t of oge(nge)){let r=function(...n){if(new.target)throw cge();return Ki.Readable.from(sge(e,this,n))};QL=r;let e=nge[t];_p(r,"name",{__proto__:null,value:e.name}),_p(r,"length",{__proto__:null,value:e.length}),_p(Ki.Readable.prototype,t,{__proto__:null,value:r,enumerable:!1,configurable:!0,writable:!0})}var QL;for(let t of oge(ige)){let r=function(...i){if(new.target)throw cge();return sge(e,this,i)};QL=r;let e=ige[t];_p(r,"name",{__proto__:null,value:e.name}),_p(r,"length",{__proto__:null,value:e.length}),_p(Ki.Readable.prototype,t,{__proto__:null,value:r,enumerable:!1,configurable:!0,writable:!0})}var QL;Ki.Writable=AL();Ki.Duplex=Uf();Ki.Transform=ML();Ki.PassThrough=CL();Ki.pipeline=dge;var{addAbortSignal:VXe}=v5();Ki.addAbortSignal=VXe;Ki.finished=uge;Ki.destroy=zXe;Ki.compose=FXe;_p(Ki,"promises",{__proto__:null,configurable:!0,enumerable:!0,get(){return ZL}});_p(dge,age,{__proto__:null,enumerable:!0,get(){return ZL.pipeline}});_p(uge,age,{__proto__:null,enumerable:!0,get(){return ZL.finished}});Ki.Stream=Ki;Ki._isUint8Array=function(e){return e instanceof Uint8Array};Ki._uint8ArrayToBuffer=function(e){return LXe.from(e.buffer,e.byteOffset,e.byteLength)}});var A5=W((GIt,qi)=>{"use strict";f();var yo=YL(),HXe=JL(),WXe=yo.Readable.destroy;qi.exports=yo.Readable;qi.exports._uint8ArrayToBuffer=yo._uint8ArrayToBuffer;qi.exports._isUint8Array=yo._isUint8Array;qi.exports.isDisturbed=yo.isDisturbed;qi.exports.isErrored=yo.isErrored;qi.exports.isReadable=yo.isReadable;qi.exports.Readable=yo.Readable;qi.exports.Writable=yo.Writable;qi.exports.Duplex=yo.Duplex;qi.exports.Transform=yo.Transform;qi.exports.PassThrough=yo.PassThrough;qi.exports.addAbortSignal=yo.addAbortSignal;qi.exports.finished=yo.finished;qi.exports.destroy=yo.destroy;qi.exports.destroy=WXe;qi.exports.pipeline=yo.pipeline;qi.exports.compose=yo.compose;Object.defineProperty(yo,"promises",{configurable:!0,enumerable:!0,get(){return HXe}});qi.exports.Stream=yo.Stream;qi.exports.default=qi.exports});var $5=W(Xge=>{f();Xge.Level=Wq().BrowserLevel});var jve=W((mDt,Cve)=>{"use strict";f();Cve.exports=function t(e){if(typeof e=="number"&&isNaN(e))throw new Error("NaN is not allowed");if(typeof e=="number"&&!isFinite(e))throw new Error("Infinity is not allowed");return e===null||typeof e!="object"?JSON.stringify(e):e.toJSON instanceof Function?t(e.toJSON()):Array.isArray(e)?`[${e.reduce((i,o,s)=>`${i}${s===0?"":","}${t(o===void 0||typeof o=="symbol"?null:o)}`,"")}]`:`{${Object.keys(e).sort().reduce((n,i)=>{if(e[i]===void 0||typeof e[i]=="symbol")return n;let o=n.length===0?"":",";return`${n}${o}${t(i)}:${t(e[i])}`},"")}}`}});var f0=W((sjt,Fve)=>{f();var T_=1e3,A_=T_*60,k_=A_*60,Ab=k_*24,dtt=Ab*7,utt=Ab*365.25;Fve.exports=function(t,e){e=e||{};var r=typeof t;if(r==="string"&&t.length>0)return ltt(t);if(r==="number"&&isFinite(t))return e.long?htt(t):ftt(t);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(t))};function ltt(t){if(t=String(t),!(t.length>100)){var e=/^(-?(?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|weeks?|w|years?|yrs?|y)?$/i.exec(t);if(e){var r=parseFloat(e[1]),n=(e[2]||"ms").toLowerCase();switch(n){case"years":case"year":case"yrs":case"yr":case"y":return r*utt;case"weeks":case"week":case"w":return r*dtt;case"days":case"day":case"d":return r*Ab;case"hours":case"hour":case"hrs":case"hr":case"h":return r*k_;case"minutes":case"minute":case"mins":case"min":case"m":return r*A_;case"seconds":case"second":case"secs":case"sec":case"s":return r*T_;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return r;default:return}}}}function ftt(t){var e=Math.abs(t);return e>=Ab?Math.round(t/Ab)+"d":e>=k_?Math.round(t/k_)+"h":e>=A_?Math.round(t/A_)+"m":e>=T_?Math.round(t/T_)+"s":t+"ms"}function htt(t){var e=Math.abs(t);return e>=Ab?kR(t,e,Ab,"day"):e>=k_?kR(t,e,k_,"hour"):e>=A_?kR(t,e,A_,"minute"):e>=T_?kR(t,e,T_,"second"):t+" ms"}function kR(t,e,r,n){var i=e>=r*1.5;return Math.round(t/r)+" "+n+(i?"s":"")}});var xwe=W((NUt,nz)=>{"use strict";f();var vrt=Object.prototype.hasOwnProperty,Ja="~";function c3(){}Object.create&&(c3.prototype=Object.create(null),new c3().__proto__||(Ja=!1));function brt(t,e,r){this.fn=t,this.context=e,this.once=r||!1}function _we(t,e,r,n,i){if(typeof r!="function")throw new TypeError("The listener must be a function");var o=new brt(r,n||t,i),s=Ja?Ja+e:e;return t._events[s]?t._events[s].fn?t._events[s]=[t._events[s],o]:t._events[s].push(o):(t._events[s]=o,t._eventsCount++),t}function WR(t,e){--t._eventsCount===0?t._events=new c3:delete t._events[e]}function ga(){this._events=new c3,this._eventsCount=0}ga.prototype.eventNames=function(){var e=[],r,n;if(this._eventsCount===0)return e;for(n in r=this._events)vrt.call(r,n)&&e.push(Ja?n.slice(1):n);return Object.getOwnPropertySymbols?e.concat(Object.getOwnPropertySymbols(r)):e};ga.prototype.listeners=function(e){var r=Ja?Ja+e:e,n=this._events[r];if(!n)return[];if(n.fn)return[n.fn];for(var i=0,o=n.length,s=new Array(o);i<o;i++)s[i]=n[i].fn;return s};ga.prototype.listenerCount=function(e){var r=Ja?Ja+e:e,n=this._events[r];return n?n.fn?1:n.length:0};ga.prototype.emit=function(e,r,n,i,o,s){var a=Ja?Ja+e:e;if(!this._events[a])return!1;var d=this._events[a],u=arguments.length,c,l;if(d.fn){switch(d.once&&this.removeListener(e,d.fn,void 0,!0),u){case 1:return d.fn.call(d.context),!0;case 2:return d.fn.call(d.context,r),!0;case 3:return d.fn.call(d.context,r,n),!0;case 4:return d.fn.call(d.context,r,n,i),!0;case 5:return d.fn.call(d.context,r,n,i,o),!0;case 6:return d.fn.call(d.context,r,n,i,o,s),!0}for(l=1,c=new Array(u-1);l<u;l++)c[l-1]=arguments[l];d.fn.apply(d.context,c)}else{var h=d.length,y;for(l=0;l<h;l++)switch(d[l].once&&this.removeListener(e,d[l].fn,void 0,!0),u){case 1:d[l].fn.call(d[l].context);break;case 2:d[l].fn.call(d[l].context,r);break;case 3:d[l].fn.call(d[l].context,r,n);break;case 4:d[l].fn.call(d[l].context,r,n,i);break;default:if(!c)for(y=1,c=new Array(u-1);y<u;y++)c[y-1]=arguments[y];d[l].fn.apply(d[l].context,c)}}return!0};ga.prototype.on=function(e,r,n){return _we(this,e,r,n,!1)};ga.prototype.once=function(e,r,n){return _we(this,e,r,n,!0)};ga.prototype.removeListener=function(e,r,n,i){var o=Ja?Ja+e:e;if(!this._events[o])return this;if(!r)return WR(this,o),this;var s=this._events[o];if(s.fn)s.fn===r&&(!i||s.once)&&(!n||s.context===n)&&WR(this,o);else{for(var a=0,d=[],u=s.length;a<u;a++)(s[a].fn!==r||i&&!s[a].once||n&&s[a].context!==n)&&d.push(s[a]);d.length?this._events[o]=d.length===1?d[0]:d:WR(this,o)}return this};ga.prototype.removeAllListeners=function(e){var r;return e?(r=Ja?Ja+e:e,this._events[r]&&WR(this,r)):(this._events=new c3,this._eventsCount=0),this};ga.prototype.off=ga.prototype.removeListener;ga.prototype.addListener=ga.prototype.on;ga.prefixed=Ja;ga.EventEmitter=ga;typeof nz<"u"&&(nz.exports=ga)});var d1e=W(mB=>{"use strict";f();Object.defineProperty(mB,"__esModule",{value:!0});mB.ReadableWebToNodeStream=void 0;var ynt=h7(),kz=class extends ynt.Readable{constructor(e){super(),this.bytesRead=0,this.released=!1,this.reader=e.getReader()}async _read(){if(this.released){this.push(null);return}this.pendingRead=this.reader.read();let e=await this.pendingRead;delete this.pendingRead,e.done||this.released?this.push(null):(this.bytesRead+=e.value.length,this.push(e.value))}async waitForReadToComplete(){this.pendingRead&&await this.pendingRead}async close(){await this.syncAndRelease()}async syncAndRelease(){this.released=!0,await this.waitForReadToComplete(),await this.reader.releaseLock()}};mB.ReadableWebToNodeStream=kz});var Kit={};Or(Kit,{Web5UserAgent:()=>lV});f();f();f();f();f();f();f();f();var CW=xt(oH(),1);f();f();f();f();function $_e(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,d=t.charAt(0),u=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function l(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var v=0,x=0,S=0,A=g.length;S!==A&&g[S]===0;)S++,v++;for(var T=(A-S)*c+1>>>0,$=new Uint8Array(T);S!==A;){for(var j=g[S],K=0,F=T-1;(j!==0||K<x)&&F!==-1;F--,K++)j+=256*$[F]>>>0,$[F]=j%a>>>0,j=j/a>>>0;if(j!==0)throw new Error("Non-zero carry");x=K,S++}for(var L=T-x;L!==T&&$[L]===0;)L++;for(var V=d.repeat(v);L<T;++L)V+=t.charAt($[L]);return V}function h(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var v=0;if(g[v]!==" "){for(var x=0,S=0;g[v]===d;)x++,v++;for(var A=(g.length-v)*u+1>>>0,T=new Uint8Array(A);g[v];){var $=r[g.charCodeAt(v)];if($===255)return;for(var j=0,K=A-1;($!==0||j<S)&&K!==-1;K--,j++)$+=a*T[K]>>>0,T[K]=$%256>>>0,$=$/256>>>0;if($!==0)throw new Error("Non-zero carry");S=j,v++}if(g[v]!==" "){for(var F=A-S;F!==A&&T[F]===0;)F++;for(var L=new Uint8Array(x+(A-F)),V=x;F!==A;)L[V++]=T[F++];return L}}}function y(g){var v=h(g);if(v)return v;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:h,decode:y}}var N_e=$_e,U_e=N_e,sH=U_e;f();var Pot=new Uint8Array(0);var aH=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},Eu=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};f();var u9=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},l9=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return dH(this,e)}},f9=class{constructor(e){this.decoders=e}or(e){return dH(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},dH=(t,e)=>new f9({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),h9=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new u9(e,r,n),this.decoder=new l9(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},uH=({name:t,prefix:e,encode:r,decode:n})=>new h9(t,e,r,n),p9=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=sH(r,e);return uH({prefix:t,name:e,encode:n,decode:o=>Eu(i(o))})},K_e=(t,e,r,n)=>{let i={};for(let c=0;c<e.length;++c)i[e[c]]=c;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,d=0,u=0;for(let c=0;c<o;++c){let l=i[t[c]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);d=d<<r|l,a+=r,a>=8&&(a-=8,s[u++]=255&d>>a)}if(a>=r||255&d<<8-a)throw new SyntaxError("Unexpected end of data");return s},q_e=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let d=0;d<t.length;++d)for(a=a<<8|t[d],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},xa=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>uH({prefix:e,name:t,encode(i){return q_e(i,n,r)},decode(i){return K_e(i,n,r,t)}});var $ot=xa({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),Not=xa({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Ea=xa({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),Uot=xa({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var y9=new TextEncoder,L_e=new TextDecoder,Ke=class t{static base64UrlToBytes(e){return Ea.baseDecode(e)}static base64UrlToObject(e){let r=Ea.baseDecode(e);return t.bytesToObject(r)}static bytesToBase64Url(e){return Ea.baseEncode(e)}static bytesToString(e){return L_e.decode(e)}static bytesToObject(e){let r=t.bytesToString(e);return JSON.parse(r)}static objectToBytes(e){let r=JSON.stringify(e);return y9.encode(r)}static stringToBase64Url(e){let r=y9.encode(e);return Ea.baseEncode(r)}static stringToBytes(e){return y9.encode(e)}};f();f();f();f();var ns=2n**255n-19n,sw=2n**252n+27742317777372353535851937790883648493n,m9=0x216936d3cd6e53fec0a4e231fdd6dc5c692cc7609525a7b2c9562d608f25d51an,g9=0x6666666666666666666666666666666666666666666666666666666666666658n,d8={a:-1n,d:37095705934669439343138083508754565189542113879843219016388785533085940283555n,p:ns,n:sw,h:8,Gx:m9,Gy:g9},Sa=(t="")=>{throw new Error(t)},yH=t=>typeof t=="string",f8=(t,e)=>!(t instanceof Uint8Array)||typeof e=="number"&&e>0&&t.length!==e?Sa("Uint8Array expected"):t,aw=t=>new Uint8Array(t),cw=(t,e)=>f8(yH(t)?b9(t):aw(t),e),bt=(t,e=ns)=>{let r=t%e;return r>=0n?r:e+r},lH=t=>t instanceof Dl?t:Sa("Point expected"),fH,Dl=class t{constructor(e,r,n,i){this.ex=e,this.ey=r,this.ez=n,this.et=i}static fromAffine(e){return new t(e.x,e.y,1n,bt(e.x*e.y))}static fromHex(e,r=!0){let{d:n}=d8;e=cw(e,32);let i=e.slice();i[31]=e[31]&-129;let o=w9(i);o===0n||(r&&!(0n<o&&o<ns)&&Sa("bad y coord 1"),!r&&!(0n<o&&o<2n**256n)&&Sa("bad y coord 2"));let s=bt(o*o),a=bt(s-1n),d=bt(n*s+1n),{isValid:u,value:c}=z_e(a,d);u||Sa("bad y coordinate 3");let l=(c&1n)===1n;return(e[31]&128)!==0!==l&&(c=bt(-c)),new t(c,o,1n,bt(c*o))}get x(){return this.toAffine().x}get y(){return this.toAffine().y}equals(e){let{ex:r,ey:n,ez:i}=this,{ex:o,ey:s,ez:a}=lH(e),d=bt(r*a),u=bt(o*i),c=bt(n*a),l=bt(s*i);return d===u&&c===l}is0(){return this.equals(u8)}negate(){return new t(bt(-this.ex),this.ey,this.ez,bt(-this.et))}double(){let{ex:e,ey:r,ez:n}=this,{a:i}=d8,o=bt(e*e),s=bt(r*r),a=bt(2n*bt(n*n)),d=bt(i*o),u=e+r,c=bt(bt(u*u)-o-s),l=d+s,h=l-a,y=d-s,g=bt(c*h),v=bt(l*y),x=bt(c*y),S=bt(h*l);return new t(g,v,S,x)}add(e){let{ex:r,ey:n,ez:i,et:o}=this,{ex:s,ey:a,ez:d,et:u}=lH(e),{a:c,d:l}=d8,h=bt(r*s),y=bt(n*a),g=bt(o*l*u),v=bt(i*d),x=bt((r+n)*(s+a)-h-y),S=bt(v-g),A=bt(v+g),T=bt(y-c*h),$=bt(x*S),j=bt(A*T),K=bt(x*T),F=bt(S*A);return new t($,j,F,K)}mul(e,r=!0){if(e===0n)return r===!0?Sa("cannot multiply by 0"):u8;if(typeof e=="bigint"&&0n<e&&e<sw||Sa("invalid scalar, must be < L"),!r&&this.is0()||e===1n)return this;if(this.equals(cy))return J_e(e).p;let n=u8,i=cy;for(let o=this;e>0n;o=o.double(),e>>=1n)e&1n?n=n.add(o):r&&(i=i.add(o));return n}multiply(e){return this.mul(e)}clearCofactor(){return this.mul(BigInt(d8.h),!1)}isSmallOrder(){return this.clearCofactor().is0()}isTorsionFree(){let e=this.mul(sw/2n,!1).double();return sw%2n&&(e=e.add(this)),e.is0()}toAffine(){let{ex:e,ey:r,ez:n}=this;if(this.is0())return{x:0n,y:0n};let i=vH(n);return bt(n*i)!==1n&&Sa("invalid inverse"),{x:bt(e*i),y:bt(r*i)}}toRawBytes(){let{x:e,y:r}=this.toAffine(),n=gH(r);return n[31]|=e&1n?128:0,n}toHex(){return v9(this.toRawBytes())}};Dl.BASE=new Dl(m9,g9,1n,bt(m9*g9));Dl.ZERO=new Dl(0n,1n,1n,0n);var{BASE:cy,ZERO:u8}=Dl,mH=(t,e)=>t.toString(16).padStart(e,"0"),v9=t=>Array.from(t).map(e=>mH(e,2)).join(""),b9=t=>{let e=t.length;(!yH(t)||e%2)&&Sa("hex invalid 1");let r=aw(e/2);for(let n=0;n<r.length;n++){let i=n*2,o=t.slice(i,i+2),s=Number.parseInt(o,16);(Number.isNaN(s)||s<0)&&Sa("hex invalid 2"),r[n]=s}return r},gH=t=>b9(mH(t,32*2)).reverse(),w9=t=>BigInt("0x"+v9(aw(f8(t)).reverse())),fx=(...t)=>{let e=aw(t.reduce((n,i)=>n+f8(i).length,0)),r=0;return t.forEach(n=>{e.set(n,r),r+=n.length}),e},vH=(t,e=ns)=>{(t===0n||e<=0n)&&Sa("no inverse n="+t+" mod="+e);let r=bt(t,e),n=e,i=0n,o=1n,s=1n,a=0n;for(;r!==0n;){let d=n/r,u=n%r,c=i-s*d,l=o-a*d;n=r,r=u,i=s,o=a,s=c,a=l}return n===1n?bt(i,e):Sa("no inverse")},Ml=(t,e)=>{let r=t;for(;e-- >0n;)r*=r,r%=ns;return r},F_e=t=>{let r=t*t%ns*t%ns,n=Ml(r,2n)*r%ns,i=Ml(n,1n)*t%ns,o=Ml(i,5n)*i%ns,s=Ml(o,10n)*o%ns,a=Ml(s,20n)*s%ns,d=Ml(a,40n)*a%ns,u=Ml(d,80n)*d%ns,c=Ml(u,80n)*d%ns,l=Ml(c,10n)*o%ns;return{pow_p_5_8:Ml(l,2n)*t%ns,b2:r}},hH=19681161376707505956807079304988542015446066515923890162744021073123829784752n,z_e=(t,e)=>{let r=bt(e*e*e),n=bt(r*r*e),i=F_e(t*n).pow_p_5_8,o=bt(t*r*i),s=bt(e*o*o),a=o,d=bt(o*hH),u=s===t,c=s===bt(-t),l=s===bt(-t*hH);return u&&(o=a),(c||l)&&(o=d),(bt(o)&1n)===1n&&(o=bt(-o)),{isValid:u||c,value:o}},l8=t=>bt(w9(t),sw),lx,_9=(...t)=>E9.sha512Async(...t),bH=(...t)=>typeof lx=="function"?lx(...t):Sa("etc.sha512Sync not set"),wH=t=>{let e=t.slice(0,32);e[0]&=248,e[31]&=127,e[31]|=64;let r=t.slice(32,64),n=l8(e),i=cy.mul(n),o=i.toRawBytes();return{head:e,prefix:r,scalar:n,point:i,pointBytes:o}},x9=t=>_9(cw(t,32)).then(wH),V_e=t=>wH(bH(cw(t,32))),_H=t=>x9(t).then(e=>e.pointBytes);function xH(t,e){return t?_9(e.hashable).then(e.finish):e.finish(bH(e.hashable))}var H_e=(t,e,r)=>{let{pointBytes:n,scalar:i}=t,o=l8(e),s=cy.mul(o).toRawBytes();return{hashable:fx(s,n,r),finish:u=>{let c=bt(o+l8(u)*i,sw);return f8(fx(s,gH(c)),64)}}},EH=async(t,e)=>{let r=cw(t),n=await x9(e),i=await _9(n.prefix,r);return xH(!0,H_e(n,i,r))};var W_e=(t,e,r)=>{e=cw(e),t=cw(t,64);let n=Dl.fromHex(r,!1),i=Dl.fromHex(t.slice(0,32),!1),o=w9(t.slice(32,64)),s=cy.mul(o,!1);return{hashable:fx(i.toRawBytes(),n.toRawBytes(),e),finish:u=>{let c=l8(u);return i.add(n.mul(c,!1)).add(s.negate()).clearCofactor().is0()}}},SH=async(t,e,r)=>xH(!0,W_e(t,e,r));var pH=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,E9={bytesToHex:v9,hexToBytes:b9,concatBytes:fx,mod:bt,invert:vH,randomBytes:t=>{let e=pH();return e||Sa("crypto.getRandomValues must be defined"),e.getRandomValues(aw(t))},sha512Async:async(...t)=>{let e=pH();e||Sa("crypto.subtle or etc.sha512Async must be defined");let r=fx(...t);return aw(await e.subtle.digest("SHA-512",r.buffer))},sha512Sync:void 0};Object.defineProperties(E9,{sha512Sync:{configurable:!1,get(){return lx},set(t){lx||(lx=t)}}});var TH={getExtendedPublicKeyAsync:x9,getExtendedPublicKey:V_e,randomPrivateKey:()=>E9.randomBytes(32),precompute(t=8,e=cy){return e.multiply(3n),e}},F0=8,G_e=()=>{let t=[],e=256/F0+1,r=cy,n=r;for(let i=0;i<e;i++){n=r,t.push(n);for(let o=1;o<2**(F0-1);o++)n=n.add(r),t.push(n);r=n.double()}return t},J_e=t=>{let e=fH||(fH=G_e()),r=(c,l)=>{let h=l.negate();return c?h:l},n=u8,i=cy,o=1+256/F0,s=2**(F0-1),a=BigInt(2**F0-1),d=2**F0,u=BigInt(F0);for(let c=0;c<o;c++){let l=c*s,h=Number(t&a);t>>=u,h>s&&(h-=d,t+=1n);let y=l,g=l+Math.abs(h)-1,v=c%2!==0,x=h<0;h===0?i=i.add(r(v,e[y])):n=n.add(r(x,e[g]))}return{p:n,f:i}};f();var de=class extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,this.name="DwnError"}},se;(function(t){t.AuthenticateJwsMissing="AuthenticateJwsMissing",t.AuthenticateDescriptorCidMismatch="AuthenticateDescriptorCidMismatch",t.AuthenticationMoreThanOneSignatureNotSupported="AuthenticationMoreThanOneSignatureNotSupported",t.AuthorizationAuthorNotOwner="AuthorizationAuthorNotOwner",t.AuthorizationNotGrantedToAuthor="AuthorizationNotGrantedToAuthor",t.ComputeCidCodecNotSupported="ComputeCidCodecNotSupported",t.ComputeCidMultihashNotSupported="ComputeCidMultihashNotSupported",t.Ed25519InvalidJwk="Ed25519InvalidJwk",t.EventEmitterStreamNotOpenError="EventEmitterStreamNotOpenError",t.MessagesGrantAuthorizationMismatchedProtocol="EventsGrantAuthorizationMismatchedProtocol",t.MessagesSubscribeAuthorizationFailed="MessagesSubscribeAuthorizationFailed",t.MessagesSubscribeEventStreamUnimplemented="MessagesSubscribeEventStreamUnimplemented",t.GeneralJwsVerifierGetPublicKeyNotFound="GeneralJwsVerifierGetPublicKeyNotFound",t.GeneralJwsVerifierInvalidSignature="GeneralJwsVerifierInvalidSignature",t.GrantAuthorizationGrantExpired="GrantAuthorizationGrantExpired",t.GrantAuthorizationGrantMissing="GrantAuthorizationGrantMissing",t.GrantAuthorizationGrantRevoked="GrantAuthorizationGrantRevoked",t.GrantAuthorizationInterfaceMismatch="GrantAuthorizationInterfaceMismatch",t.GrantAuthorizationMethodMismatch="GrantAuthorizationMethodMismatch",t.GrantAuthorizationNotGrantedForTenant="GrantAuthorizationNotGrantedForTenant",t.GrantAuthorizationNotGrantedToAuthor="GrantAuthorizationNotGrantedToAuthor",t.GrantAuthorizationGrantNotYetActive="GrantAuthorizationGrantNotYetActive",t.HdKeyDerivationPathInvalid="HdKeyDerivationPathInvalid",t.JwsVerifySignatureUnsupportedCrv="JwsVerifySignatureUnsupportedCrv",t.IndexInvalidCursorValueType="IndexInvalidCursorValueType",t.IndexInvalidCursorSortProperty="IndexInvalidCursorSortProperty",t.IndexInvalidSortPropertyInMemory="IndexInvalidSortPropertyInMemory",t.IndexMissingIndexableProperty="IndexMissingIndexableProperty",t.JwsDecodePlainObjectPayloadInvalid="JwsDecodePlainObjectPayloadInvalid",t.MessagesReadInvalidCid="MessagesReadInvalidCid",t.MessagesReadAuthorizationFailed="MessagesReadAuthorizationFailed",t.MessageGetInvalidCid="MessageGetInvalidCid",t.MessagesQueryAuthorizationFailed="MessagesQueryAuthorizationFailed",t.MessagesReadVerifyScopeFailed="MessagesReadVerifyScopeFailed",t.ParseCidCodecNotSupported="ParseCidCodecNotSupported",t.ParseCidMultihashNotSupported="ParseCidMultihashNotSupported",t.PermissionsProtocolCreateGrantRecordsScopeMissingProtocol="PermissionsProtocolCreateGrantRecordsScopeMissingProtocol",t.PermissionsProtocolCreateRequestRecordsScopeMissingProtocol="PermissionsProtocolCreateRequestRecordsScopeMissingProtocol",t.PermissionsProtocolGetScopeInvalidProtocol="PermissionsProtocolGetScopeInvalidProtocol",t.PermissionsProtocolValidateSchemaUnexpectedRecord="PermissionsProtocolValidateSchemaUnexpectedRecord",t.PermissionsProtocolValidateScopeContextIdProhibitedProperties="PermissionsProtocolValidateScopeContextIdProhibitedProperties",t.PermissionsProtocolValidateScopeProtocolMismatch="PermissionsProtocolValidateScopeProtocolMismatch",t.PermissionsProtocolValidateScopeMissingProtocolTag="PermissionsProtocolValidateScopeMissingProtocolTag",t.PermissionsProtocolValidateRevocationProtocolTagMismatch="PermissionsProtocolValidateRevocationProtocolTagMismatch",t.PrivateKeySignerUnableToDeduceAlgorithm="PrivateKeySignerUnableToDeduceAlgorithm",t.PrivateKeySignerUnableToDeduceKeyId="PrivateKeySignerUnableToDeduceKeyId",t.PrivateKeySignerUnsupportedCurve="PrivateKeySignerUnsupportedCurve",t.ProtocolAuthorizationActionNotAllowed="ProtocolAuthorizationActionNotAllowed",t.ProtocolAuthorizationActionRulesNotFound="ProtocolAuthorizationActionRulesNotFound",t.ProtocolAuthorizationIncorrectDataFormat="ProtocolAuthorizationIncorrectDataFormat",t.ProtocolAuthorizationIncorrectContextId="ProtocolAuthorizationIncorrectContextId",t.ProtocolAuthorizationIncorrectProtocolPath="ProtocolAuthorizationIncorrectProtocolPath",t.ProtocolAuthorizationDuplicateRoleRecipient="ProtocolAuthorizationDuplicateRoleRecipient",t.ProtocolAuthorizationInvalidSchema="ProtocolAuthorizationInvalidSchema",t.ProtocolAuthorizationInvalidType="ProtocolAuthorizationInvalidType",t.ProtocolAuthorizationMatchingRoleRecordNotFound="ProtocolAuthorizationMatchingRoleRecordNotFound",t.ProtocolAuthorizationMaxSizeInvalid="ProtocolAuthorizationMaxSizeInvalid",t.ProtocolAuthorizationMinSizeInvalid="ProtocolAuthorizationMinSizeInvalid",t.ProtocolAuthorizationMissingContextId="ProtocolAuthorizationMissingContextId",t.ProtocolAuthorizationMissingRuleSet="ProtocolAuthorizationMissingRuleSet",t.ProtocolAuthorizationParentlessIncorrectProtocolPath="ProtocolAuthorizationParentlessIncorrectProtocolPath",t.ProtocolAuthorizationNotARole="ProtocolAuthorizationNotARole",t.ProtocolAuthorizationParentNotFoundConstructingRecordChain="ProtocolAuthorizationParentNotFoundConstructingRecordChain",t.ProtocolAuthorizationProtocolNotFound="ProtocolAuthorizationProtocolNotFound",t.ProtocolAuthorizationRoleMissingRecipient="ProtocolAuthorizationRoleMissingRecipient",t.ProtocolAuthorizationTagsInvalidSchema="ProtocolAuthorizationTagsInvalidSchema",t.ProtocolsConfigureDuplicateActorInRuleSet="ProtocolsConfigureDuplicateActorInRuleSet",t.ProtocolsConfigureDuplicateRoleInRuleSet="ProtocolsConfigureDuplicateRoleInRuleSet",t.ProtocolsConfigureInvalidSize="ProtocolsConfigureInvalidSize",t.ProtocolsConfigureInvalidActionMissingOf="ProtocolsConfigureInvalidActionMissingOf",t.ProtocolsConfigureInvalidActionOfNotAllowed="ProtocolsConfigureInvalidActionOfNotAllowed",t.ProtocolsConfigureInvalidActionDeleteWithoutCreate="ProtocolsConfigureInvalidActionDeleteWithoutCreate",t.ProtocolsConfigureInvalidActionUpdateWithoutCreate="ProtocolsConfigureInvalidActionUpdateWithoutCreate",t.ProtocolsConfigureInvalidRecipientOfAction="ProtocolsConfigureInvalidRecipientOfAction",t.ProtocolsConfigureInvalidRuleSetRecordType="ProtocolsConfigureInvalidRuleSetRecordType",t.ProtocolsConfigureInvalidTagSchema="ProtocolsConfigureInvalidTagSchema",t.ProtocolsConfigureRecordNestingDepthExceeded="ProtocolsConfigureRecordNestingDepthExceeded",t.ProtocolsConfigureRoleDoesNotExistAtGivenPath="ProtocolsConfigureRoleDoesNotExistAtGivenPath",t.ProtocolsQueryUnauthorized="ProtocolsQueryUnauthorized",t.RecordsAuthorDelegatedGrantAndIdExistenceMismatch="RecordsAuthorDelegatedGrantAndIdExistenceMismatch",t.RecordsAuthorDelegatedGrantCidMismatch="RecordsAuthorDelegatedGrantCidMismatch",t.RecordsAuthorDelegatedGrantGrantedToAndOwnerSignatureMismatch="RecordsAuthorDelegatedGrantGrantedToAndOwnerSignatureMismatch",t.RecordsAuthorDelegatedGrantNotADelegatedGrant="RecordsAuthorDelegatedGrantNotADelegatedGrant",t.RecordsDecryptNoMatchingKeyEncryptedFound="RecordsDecryptNoMatchingKeyEncryptedFound",t.RecordsDeleteAuthorizationFailed="RecordsDeleteAuthorizationFailed",t.RecordsQueryCreateFilterPublishedSortInvalid="RecordsQueryCreateFilterPublishedSortInvalid",t.RecordsQueryParseFilterPublishedSortInvalid="RecordsQueryParseFilterPublishedSortInvalid",t.RecordsGrantAuthorizationConditionPublicationProhibited="RecordsGrantAuthorizationConditionPublicationProhibited",t.RecordsGrantAuthorizationConditionPublicationRequired="RecordsGrantAuthorizationConditionPublicationRequired",t.RecordsGrantAuthorizationDeleteProtocolScopeMismatch="RecordsGrantAuthorizationDeleteProtocolScopeMismatch",t.RecordsGrantAuthorizationQueryOrSubscribeProtocolScopeMismatch="RecordsGrantAuthorizationQueryOrSubscribeProtocolScopeMismatch",t.RecordsGrantAuthorizationScopeContextIdMismatch="RecordsGrantAuthorizationScopeContextIdMismatch",t.RecordsGrantAuthorizationScopeProtocolMismatch="RecordsGrantAuthorizationScopeProtocolMismatch",t.RecordsGrantAuthorizationScopeProtocolPathMismatch="RecordsGrantAuthorizationScopeProtocolPathMismatch",t.RecordsDerivePrivateKeyUnSupportedCurve="RecordsDerivePrivateKeyUnSupportedCurve",t.RecordsInvalidAncestorKeyDerivationSegment="RecordsInvalidAncestorKeyDerivationSegment",t.RecordsOwnerDelegatedGrantAndIdExistenceMismatch="RecordsOwnerDelegatedGrantAndIdExistenceMismatch",t.RecordsOwnerDelegatedGrantCidMismatch="RecordsOwnerDelegatedGrantCidMismatch",t.RecordsOwnerDelegatedGrantGrantedToAndOwnerSignatureMismatch="RecordsOwnerDelegatedGrantGrantedToAndOwnerSignatureMismatch",t.RecordsOwnerDelegatedGrantNotADelegatedGrant="RecordsOwnerDelegatedGrantNotADelegatedGrant",t.RecordsProtocolContextDerivationSchemeMissingContextId="RecordsProtocolContextDerivationSchemeMissingContextId",t.RecordsProtocolPathDerivationSchemeMissingProtocol="RecordsProtocolPathDerivationSchemeMissingProtocol",t.RecordsQueryFilterMissingRequiredProperties="RecordsQueryFilterMissingRequiredProperties",t.RecordsReadReturnedMultiple="RecordsReadReturnedMultiple",t.RecordsReadAuthorizationFailed="RecordsReadAuthorizationFailed",t.RecordsSubscribeEventStreamUnimplemented="RecordsSubscribeEventStreamUnimplemented",t.RecordsSubscribeFilterMissingRequiredProperties="RecordsSubscribeFilterMissingRequiredProperties",t.RecordsSchemasDerivationSchemeMissingSchema="RecordsSchemasDerivationSchemeMissingSchema",t.RecordsWriteAttestationIntegrityMoreThanOneSignature="RecordsWriteAttestationIntegrityMoreThanOneSignature",t.RecordsWriteAttestationIntegrityDescriptorCidMismatch="RecordsWriteAttestationIntegrityDescriptorCidMismatch",t.RecordsWriteAttestationIntegrityInvalidPayloadProperty="RecordsWriteAttestationIntegrityInvalidPayloadProperty",t.RecordsWriteAuthorizationFailed="RecordsWriteAuthorizationFailed",t.RecordsWriteCreateMissingSigner="RecordsWriteCreateMissingSigner",t.RecordsWriteCreateDataAndDataCidMutuallyExclusive="RecordsWriteCreateDataAndDataCidMutuallyExclusive",t.RecordsWriteCreateDataCidAndDataSizeMutuallyInclusive="RecordsWriteCreateDataCidAndDataSizeMutuallyInclusive",t.RecordsWriteCreateProtocolAndProtocolPathMutuallyInclusive="RecordsWriteCreateProtocolAndProtocolPathMutuallyInclusive",t.RecordsWriteDataCidMismatch="RecordsWriteDataCidMismatch",t.RecordsWriteDataSizeMismatch="RecordsWriteDataSizeMismatch",t.RecordsWriteGetEntryIdUndefinedAuthor="RecordsWriteGetEntryIdUndefinedAuthor",t.RecordsWriteGetNewestWriteRecordNotFound="RecordsWriteGetNewestWriteRecordNotFound",t.RecordsWriteGetInitialWriteNotFound="RecordsWriteGetInitialWriteNotFound",t.RecordsWriteImmutablePropertyChanged="RecordsWriteImmutablePropertyChanged",t.RecordsWriteMissingSigner="RecordsWriteMissingSigner",t.RecordsWriteMissingDataInPrevious="RecordsWriteMissingDataInPrevious",t.RecordsWriteMissingEncodedDataInPrevious="RecordsWriteMissingEncodedDataInPrevious",t.RecordsWriteMissingProtocol="RecordsWriteMissingProtocol",t.RecordsWriteMissingSchema="RecordsWriteMissingSchema",t.RecordsWriteNotAllowedAfterDelete="RecordsWriteNotAllowedAfterDelete",t.RecordsWriteOwnerAndTenantMismatch="RecordsWriteOwnerAndTenantMismatch",t.RecordsWriteSignAsOwnerDelegateUnknownAuthor="RecordsWriteSignAsOwnerDelegateUnknownAuthor",t.RecordsWriteSignAsOwnerUnknownAuthor="RecordsWriteSignAsOwnerUnknownAuthor",t.RecordsWriteValidateIntegrityAttestationMismatch="RecordsWriteValidateIntegrityAttestationMismatch",t.RecordsWriteValidateIntegrityContextIdMismatch="RecordsWriteValidateIntegrityContextIdMismatch",t.RecordsWriteValidateIntegrityContextIdNotInSignerSignaturePayload="RecordsWriteValidateIntegrityContextIdNotInSignerSignaturePayload",t.RecordsWriteValidateIntegrityDateCreatedMismatch="RecordsWriteValidateIntegrityDateCreatedMismatch",t.RecordsWriteValidateIntegrityEncryptionCidMismatch="RecordsWriteValidateIntegrityEncryptionCidMismatch",t.RecordsWriteValidateIntegrityRecordIdUnauthorized="RecordsWriteValidateIntegrityRecordIdUnauthorized",t.SchemaValidatorAdditionalPropertyNotAllowed="SchemaValidatorAdditionalPropertyNotAllowed",t.SchemaValidatorFailure="SchemaValidatorFailure",t.SchemaValidatorSchemaNotFound="SchemaValidatorSchemaNotFound",t.SchemaValidatorUnevaluatedPropertyNotAllowed="SchemaValidatorUnevaluatedPropertyNotAllowed",t.Secp256k1KeyNotValid="Secp256k1KeyNotValid",t.Secp256r1KeyNotValid="Secp256r1KeyNotValid",t.TimestampInvalid="TimestampInvalid",t.UrlProtocolNotNormalized="UrlProtocolNotNormalized",t.UrlProtocolNotNormalizable="UrlProtocolNotNormalizable",t.UrlSchemaNotNormalized="UrlSchemaNotNormalized"})(se||(se={}));var h8=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};function AH(t){if(t.kty!=="OKP"||t.crv!=="Ed25519")throw new de(se.Ed25519InvalidJwk,"invalid jwk. kty MUST be OKP. crv MUST be Ed25519")}function kH(t){return{alg:"EdDSA",kty:"OKP",crv:"Ed25519",x:Ke.bytesToBase64Url(t)}}var S9={sign:(t,e)=>h8(void 0,void 0,void 0,function*(){AH(e);let r=Ke.base64UrlToBytes(e.d);return EH(t,r)}),verify:(t,e,r)=>h8(void 0,void 0,void 0,function*(){AH(r);let n=Ke.base64UrlToBytes(r.x);return SH(e,t,n)}),generateKeyPair:()=>h8(void 0,void 0,void 0,function*(){let t=TH.randomPrivateKey(),e=yield _H(t),r=Ke.bytesToBase64Url(t),n=kH(e),i=Object.assign(Object.assign({},n),{d:r});return{publicJwk:n,privateJwk:i}}),publicKeyToJwk:t=>h8(void 0,void 0,void 0,function*(){return kH(t)})};f();f();var k9=2n**256n,dy=k9-0x1000003d1n,no=k9-0x14551231950b75fc4402da1732fc9bebfn,MH=0x79be667ef9dcbbac55a06295ce870b07029bfcdb2dce28d959f2815b16f81798n,DH=0x483ada7726a3c4655da4fbfc0e1108a8fd17b448a68554199c47d08ffb10d4b8n,CH={p:dy,n:no,a:0n,b:7n,Gx:MH,Gy:DH},zs=32,PH=t=>He(He(t*t)*t+CH.b),mn=(t="")=>{throw new Error(t)},g8=t=>typeof t=="bigint",jH=t=>typeof t=="string",T9=t=>g8(t)&&0n<t&&t<dy,yx=t=>g8(t)&&0n<t&&t<no,$H=(t,e)=>!(t instanceof Uint8Array)||typeof e=="number"&&e>0&&t.length!==e?mn("Uint8Array expected"):t,Bc=t=>new Uint8Array(t),uh=(t,e)=>$H(jH(t)?gx(t):Bc(t),e),He=(t,e=dy)=>{let r=t%e;return r>=0n?r:e+r},IH=t=>t instanceof Ta?t:mn("Point expected"),RH,Ta=class t{constructor(e,r,n){this.px=e,this.py=r,this.pz=n}static fromAffine(e){return new t(e.x,e.y,1n)}static fromHex(e){e=uh(e);let r,n=e[0],i=e.subarray(1),o=y8(i,0,zs),s=e.length;if(s===33&&[2,3].includes(n)){T9(o)||mn("Point hex invalid: x not FE");let a=Z_e(PH(o)),d=(a&1n)===1n;(n&1)===1!==d&&(a=He(-a)),r=new t(o,a,1n)}return s===65&&n===4&&(r=new t(o,y8(i,zs,2*zs),1n)),r?r.ok():mn("Point is not on curve")}static fromPrivateKey(e){return dh.mul(m8(e))}get x(){return this.aff().x}get y(){return this.aff().y}equals(e){let{px:r,py:n,pz:i}=this,{px:o,py:s,pz:a}=IH(e),d=He(r*a),u=He(o*i),c=He(n*a),l=He(s*i);return d===u&&c===l}negate(){return new t(this.px,He(-this.py),this.pz)}double(){return this.add(this)}add(e){let{px:r,py:n,pz:i}=this,{px:o,py:s,pz:a}=IH(e),{a:d,b:u}=CH,c=0n,l=0n,h=0n,y=He(u*3n),g=He(r*o),v=He(n*s),x=He(i*a),S=He(r+n),A=He(o+s);S=He(S*A),A=He(g+v),S=He(S-A),A=He(r+i);let T=He(o+a);return A=He(A*T),T=He(g+x),A=He(A-T),T=He(n+i),c=He(s+a),T=He(T*c),c=He(v+x),T=He(T-c),h=He(d*A),c=He(y*x),h=He(c+h),c=He(v-h),h=He(v+h),l=He(c*h),v=He(g+g),v=He(v+g),x=He(d*x),A=He(y*A),v=He(v+x),x=He(g-x),x=He(d*x),A=He(A+x),g=He(v*A),l=He(l+g),g=He(T*A),c=He(S*c),c=He(c-g),g=He(S*v),h=He(T*h),h=He(h+g),new t(c,l,h)}mul(e,r=!0){if(!r&&e===0n)return p8;if(yx(e)||mn("invalid scalar"),this.equals(dh))return rxe(e).p;let n=p8,i=dh;for(let o=this;e>0n;o=o.double(),e>>=1n)e&1n?n=n.add(o):r&&(i=i.add(o));return n}mulAddQUns(e,r,n){return this.mul(r,!1).add(e.mul(n,!1)).ok()}toAffine(){let{px:e,py:r,pz:n}=this;if(this.equals(p8))return{x:0n,y:0n};if(n===1n)return{x:e,y:r};let i=bx(n);return He(n*i)!==1n&&mn("invalid inverse"),{x:He(e*i),y:He(r*i)}}assertValidity(){let{x:e,y:r}=this.aff();return(!T9(e)||!T9(r))&&mn("Point invalid: x or y"),He(r*r)===PH(e)?this:mn("Point invalid: not on curve")}multiply(e){return this.mul(e)}aff(){return this.toAffine()}ok(){return this.assertValidity()}toHex(e=!0){let{x:r,y:n}=this.aff();return(e?(n&1n)===0n?"02":"03":"04")+hx(r)+(e?"":hx(n))}toRawBytes(e=!0){return gx(this.toHex(e))}};Ta.BASE=new Ta(MH,DH,1n);Ta.ZERO=new Ta(0n,1n,0n);var{BASE:dh,ZERO:p8}=Ta,NH=(t,e)=>t.toString(16).padStart(e,"0"),P9=t=>Array.from(t).map(e=>NH(e,2)).join(""),gx=t=>{let e=t.length;(!jH(t)||e%2)&&mn("hex invalid 1");let r=Bc(e/2);for(let n=0;n<r.length;n++){let i=n*2,o=t.slice(i,i+2),s=Number.parseInt(o,16);(Number.isNaN(s)||s<0)&&mn("hex invalid 2"),r[n]=s}return r},vx=t=>BigInt("0x"+(P9(t)||"0")),y8=(t,e,r)=>vx(t.slice(e,r)),v8=t=>g8(t)&&t>=0n&&t<k9?gx(NH(t,2*zs)):mn("bigint expected"),hx=t=>P9(v8(t)),A9=(...t)=>{let e=Bc(t.reduce((n,i)=>n+$H(i).length,0)),r=0;return t.forEach(n=>{e.set(n,r),r+=n.length}),e},bx=(t,e=dy)=>{(t===0n||e<=0n)&&mn("no inverse n="+t+" mod="+e);let r=He(t,e),n=e,i=0n,o=1n,s=1n,a=0n;for(;r!==0n;){let d=n/r,u=n%r,c=i-s*d,l=o-a*d;n=r,r=u,i=s,o=a,s=c,a=l}return n===1n?He(i,e):mn("no inverse")},Z_e=t=>{let e=1n;for(let r=t,n=(dy+1n)/4n;n>0n;n>>=1n)n&1n&&(e=e*r%dy),r=r*r%dy;return He(e*e)===t?e:mn("sqrt invalid")},m8=t=>(g8(t)||(t=vx(uh(t,zs))),yx(t)?t:mn("private key out of range")),I9=t=>t>no>>1n;function b8(t,e=!0){return Ta.fromPrivateKey(t).toRawBytes(e)}var mx=class t{constructor(e,r,n){this.r=e,this.s=r,this.recovery=n,this.assertValidity()}static fromCompact(e){return e=uh(e,64),new t(y8(e,0,zs),y8(e,zs,2*zs))}assertValidity(){return yx(this.r)&&yx(this.s)?this:mn()}addRecoveryBit(e){return new t(this.r,this.s,e)}hasHighS(){return I9(this.s)}recoverPublicKey(e){let{r,s:n,recovery:i}=this;[0,1,2,3].includes(i)||mn("recovery id invalid");let o=R9(uh(e,32)),s=i===2||i===3?r+no:r;s>=dy&&mn("q.x invalid");let a=i&1?"03":"02",d=Ta.fromHex(a+hx(s)),u=bx(s,no),c=He(-o*u,no),l=He(n*u,no);return dh.mulAddQUns(d,c,l)}toCompactRawBytes(){return gx(this.toCompactHex())}toCompactHex(){return hx(this.r)+hx(this.s)}},UH=t=>{let e=t.length*8-256,r=vx(t);return e>0?r>>BigInt(e):r},R9=t=>He(UH(t),no),BH=t=>v8(t),OH=()=>typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0,px,KH={lowS:!0},X_e={lowS:!0};function Q_e(t,e,r=KH){["der","recovered","canonical"].some(l=>l in r)&&mn("sign() legacy options not supported");let{lowS:n}=r;n==null&&(n=!0);let i=R9(uh(t)),o=BH(i),s=m8(e),a=[BH(s),o],d=r.extraEntropy;if(d){d===!0&&(d=V0.randomBytes(zs));let l=uh(d);l.length!==zs&&mn(),a.push(l)}let u=i,c=l=>{let h=UH(l);if(!yx(h))return;let y=bx(h,no),g=dh.mul(h).aff(),v=He(g.x,no);if(v===0n)return;let x=He(y*He(u+He(s*v,no),no),no);if(x===0n)return;let S=x,A=(g.x===v?0:2)|Number(g.y&1n);return n&&I9(x)&&(S=He(-x,no),A^=1),new mx(v,S,A)};return{seed:A9(...a),k2sig:c}}function exe(t){let e=Bc(zs),r=Bc(zs),n=0,i=()=>{e.fill(1),r.fill(0),n=0},o="drbg: tried 1000 values";if(t){let s=(...u)=>V0.hmacSha256Async(r,e,...u),a=async(u=Bc())=>{r=await s(Bc([0]),u),e=await s(),u.length!==0&&(r=await s(Bc([1]),u),e=await s())},d=async()=>(n++>=1e3&&mn(o),e=await s(),e);return async(u,c)=>{i(),await a(u);let l;for(;!(l=c(await d()));)await a();return i(),l}}else{let s=(...u)=>{let c=px;return c||mn("etc.hmacSha256Sync not set"),c(r,e,...u)},a=(u=Bc())=>{r=s(Bc([0]),u),e=s(),u.length!==0&&(r=s(Bc([1]),u),e=s())},d=()=>(n++>=1e3&&mn(o),e=s(),e);return(u,c)=>{i(),a(u);let l;for(;!(l=c(d()));)a();return i(),l}}}async function qH(t,e,r=KH){let{seed:n,k2sig:i}=Q_e(t,e,r);return exe(!0)(n,i)}function LH(t,e,r,n=X_e){let{lowS:i}=n;i==null&&(i=!0),"strict"in n&&mn("verify() legacy options not supported");let o,s,a,d=t&&typeof t=="object"&&"r"in t;!d&&uh(t).length!==2*zs&&mn("signature must be 64 bytes");try{o=d?new mx(t.r,t.s).assertValidity():mx.fromCompact(t),s=R9(uh(e,zs)),a=r instanceof Ta?r.ok():Ta.fromHex(r)}catch{return!1}if(!o)return!1;let{r:u,s:c}=o;if(i&&I9(c))return!1;let l;try{let y=bx(c,no),g=He(s*y,no),v=He(u*y,no);l=dh.mulAddQUns(a,g,v).aff()}catch{return!1}return l?He(l.x,no)===u:!1}function FH(t){t=uh(t);let e=zs+8;(t.length<e||t.length>1024)&&mn("expected proper params");let r=He(vx(t),no-1n)+1n;return v8(r)}var V0={hexToBytes:gx,bytesToHex:P9,concatBytes:A9,bytesToNumberBE:vx,numberToBytesBE:v8,mod:He,invert:bx,hmacSha256Async:async(t,...e)=>{let r=OH();if(!r)return mn("etc.hmacSha256Async not set");let n=r.subtle,i=await n.importKey("raw",t,{name:"HMAC",hash:{name:"SHA-256"}},!1,["sign"]);return Bc(await n.sign("HMAC",i,A9(...e)))},hmacSha256Sync:px,hashToPrivateKey:FH,randomBytes:t=>{let e=OH();return e||mn("crypto.getRandomValues must be defined"),e.getRandomValues(Bc(t))}},B9={normPrivateKeyToScalar:m8,isValidPrivateKey:t=>{try{return!!m8(t)}catch{return!1}},randomPrivateKey:()=>FH(V0.randomBytes(zs+8)),precompute(t=8,e=dh){return e.multiply(3n),e}};Object.defineProperties(V0,{hmacSha256Sync:{configurable:!1,get(){return px},set(t){px||(px=t)}}});var z0=8,txe=()=>{let t=[],e=256/z0+1,r=dh,n=r;for(let i=0;i<e;i++){n=r,t.push(n);for(let o=1;o<2**(z0-1);o++)n=n.add(r),t.push(n);r=n.double()}return t},rxe=t=>{let e=RH||(RH=txe()),r=(c,l)=>{let h=l.negate();return c?h:l},n=p8,i=dh,o=1+256/z0,s=2**(z0-1),a=BigInt(2**z0-1),d=2**z0,u=BigInt(z0);for(let c=0;c<o;c++){let l=c*s,h=Number(t&a);t>>=u,h>s&&(h-=d,t+=1n);let y=l,g=l+Math.abs(h)-1,v=c%2!==0,x=h<0;h===0?i=i.add(r(v,e[y])):n=n.add(r(x,e[g]))}return{p:n,f:i}};f();f();f();var lh={};Or(lh,{decode:()=>dw,encodeTo:()=>H0,encodingLength:()=>W0});f();f();var ixe=HH,zH=128,oxe=127,sxe=~oxe,axe=Math.pow(2,31);function HH(t,e,r){e=e||[],r=r||0;for(var n=r;t>=axe;)e[r++]=t&255|zH,t/=128;for(;t&sxe;)e[r++]=t&255|zH,t>>>=7;return e[r]=t|0,HH.bytes=r-n+1,e}var cxe=O9,dxe=128,VH=127;function O9(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw O9.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&VH)<<i:(s&VH)*Math.pow(2,i),i+=7}while(s>=dxe);return O9.bytes=o-n,r}var uxe=Math.pow(2,7),lxe=Math.pow(2,14),fxe=Math.pow(2,21),hxe=Math.pow(2,28),pxe=Math.pow(2,35),yxe=Math.pow(2,42),mxe=Math.pow(2,49),gxe=Math.pow(2,56),vxe=Math.pow(2,63),bxe=function(t){return t<uxe?1:t<lxe?2:t<fxe?3:t<hxe?4:t<pxe?5:t<yxe?6:t<mxe?7:t<gxe?8:t<vxe?9:10},wxe={encode:ixe,decode:cxe,encodingLength:bxe},_xe=wxe,wx=_xe;var dw=(t,e=0)=>[wx.decode(t,e),wx.decode.bytes],H0=(t,e,r=0)=>(wx.encode(t,e,r),e),W0=t=>wx.encodingLength(t);var G0=(t,e)=>{let r=e.byteLength,n=W0(t),i=n+W0(r),o=new Uint8Array(i+r);return H0(t,o,0),H0(r,o,n),o.set(e,i),new uw(t,r,e,o)},w8=t=>{let e=Eu(t),[r,n]=dw(e),[i,o]=dw(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new uw(r,i,s,e)},WH=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&aH(t.bytes,r.bytes)}},uw=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var D9=({name:t,code:e,encode:r})=>new M9(t,e,r),M9=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?G0(this.code,r):r.then(n=>G0(this.code,n))}else throw Error("Unknown type, must be binary type")}};var GH=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),Vs=D9({name:"sha2-256",code:18,encode:GH("SHA-256")}),ast=D9({name:"sha2-512",code:19,encode:GH("SHA-512")});var uy=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Exe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Wi=class t{static validateKey(e){if(e.kty!=="EC"||e.crv!=="secp256k1")throw new de(se.Secp256k1KeyNotValid,"Invalid SECP256K1 JWK: `kty` MUST be `EC`. `crv` MUST be `secp256k1`")}static publicKeyToJwk(e){return uy(this,void 0,void 0,function*(){let r;e.byteLength===33?r=Ta.fromHex(e).toRawBytes(!1):r=e;let n=Ke.bytesToBase64Url(r.subarray(1,33)),i=Ke.bytesToBase64Url(r.subarray(33,65));return{alg:"ES256K",kty:"EC",crv:"secp256k1",x:n,y:i}})}static privateKeyToJwk(e){return uy(this,void 0,void 0,function*(){let r=yield t.getPublicKey(e),n=yield t.publicKeyToJwk(r);return n.d=Ke.bytesToBase64Url(e),n})}static publicJwkToBytes(e){let r=Ke.base64UrlToBytes(e.x),n=Ke.base64UrlToBytes(e.y);return Ta.fromAffine({x:V0.bytesToNumberBE(r),y:V0.bytesToNumberBE(n)}).toRawBytes(!0)}static privateJwkToBytes(e){return Ke.base64UrlToBytes(e.d)}static sign(e,r){return uy(this,void 0,void 0,function*(){t.validateKey(r);let n=yield Vs.encode(e),i=t.privateJwkToBytes(r);return(yield qH(n,i)).toCompactRawBytes()})}static verify(e,r,n){return uy(this,void 0,void 0,function*(){t.validateKey(n);let i=t.publicJwkToBytes(n),o=yield Vs.encode(e);return LH(r,o,i)})}static generateKeyPair(){return uy(this,void 0,void 0,function*(){let e=B9.randomPrivateKey(),r=b8(e,!1),n=Ke.bytesToBase64Url(e),i=yield t.publicKeyToJwk(r),o=Object.assign(Object.assign({},i),{d:n});return{publicJwk:i,privateJwk:o}})}static generateKeyPairRaw(){return uy(this,void 0,void 0,function*(){let e=B9.randomPrivateKey();return{publicKey:b8(e,!0),privateKey:e}})}static getPublicKey(e){return uy(this,void 0,void 0,function*(){return b8(e,!0)})}static getPublicJwk(e){return uy(this,void 0,void 0,function*(){let{d:r}=e;return Exe(e,["d"])})}};f();f();f();f();f();function JH(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`positive integer expected, not ${t}`)}function Sxe(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function lw(t,...e){if(!Sxe(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function YH(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");JH(t.outputLen),JH(t.blockLen)}function fw(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function ZH(t,e){lw(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}f();f();var ly=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;var _8=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),Su=(t,e)=>t<<32-e|t>>>e;var _st=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;function Txe(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function xx(t){return typeof t=="string"&&(t=Txe(t)),lw(t),t}function XH(...t){let e=0;for(let n=0;n<t.length;n++){let i=t[n];lw(i),e+=i.length}let r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}var hw=class{clone(){return this._cloneInto()}},xst={}.toString;function QH(t){let e=n=>t().update(xx(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function pw(t=32){if(ly&&typeof ly.getRandomValues=="function")return ly.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function Axe(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),d=n?4:0,u=n?0:4;t.setUint32(e+d,s,n),t.setUint32(e+u,a,n)}var eW=(t,e,r)=>t&e^~t&r,tW=(t,e,r)=>t&e^t&r^e&r,x8=class extends hw{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=_8(this.buffer)}update(e){fw(this);let{view:r,buffer:n,blockLen:i}=this;e=xx(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let d=_8(e);for(;i<=o-s;s+=i)this.process(d,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){fw(this),ZH(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let l=s;l<i;l++)r[l]=0;Axe(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=_8(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=d/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)a.setUint32(4*l,c[l],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};var kxe=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),fy=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),hy=new Uint32Array(64),C9=class extends x8{constructor(){super(64,32,8,!1),this.A=fy[0]|0,this.B=fy[1]|0,this.C=fy[2]|0,this.D=fy[3]|0,this.E=fy[4]|0,this.F=fy[5]|0,this.G=fy[6]|0,this.H=fy[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:d}=this;return[e,r,n,i,o,s,a,d]}set(e,r,n,i,o,s,a,d){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=d|0}process(e,r){for(let l=0;l<16;l++,r+=4)hy[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){let h=hy[l-15],y=hy[l-2],g=Su(h,7)^Su(h,18)^h>>>3,v=Su(y,17)^Su(y,19)^y>>>10;hy[l]=v+hy[l-7]+g+hy[l-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:d,G:u,H:c}=this;for(let l=0;l<64;l++){let h=Su(a,6)^Su(a,11)^Su(a,25),y=c+h+eW(a,d,u)+kxe[l]+hy[l]|0,v=(Su(n,2)^Su(n,13)^Su(n,22))+tW(n,i,o)|0;c=u,u=d,d=a,a=s+y|0,s=o,o=i,i=n,n=y+v|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,d=d+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(n,i,o,s,a,d,u,c)}roundClean(){hy.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var To=QH(()=>new C9);f();f();var E8=class extends hw{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,YH(e);let n=xx(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return fw(this),this.iHash.update(e),this}digestInto(e){fw(this),lw(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},j9=(t,e,r)=>new E8(t,e).update(r).digest();j9.create=(t,e)=>new E8(t,e);f();f();f();var K9={};Or(K9,{abytes:()=>yw,bitGet:()=>Dxe,bitLen:()=>Mxe,bitMask:()=>Ex,bitSet:()=>Cxe,bytesToHex:()=>J0,bytesToNumberBE:()=>hh,bytesToNumberLE:()=>T8,concatBytes:()=>mw,createHmacDrbg:()=>U9,ensureBytes:()=>Oc,equalBytes:()=>Bxe,hexToBytes:()=>Y0,hexToNumber:()=>N9,isBytes:()=>py,numberToBytesBE:()=>yy,numberToBytesLE:()=>A8,numberToHexUnpadded:()=>oW,numberToVarBytesBE:()=>Rxe,utf8ToBytes:()=>Oxe,validateObject:()=>my});f();var iW=BigInt(0),S8=BigInt(1),Pxe=BigInt(2);function py(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function yw(t){if(!py(t))throw new Error("Uint8Array expected")}var Ixe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function J0(t){yw(t);let e="";for(let r=0;r<t.length;r++)e+=Ixe[t[r]];return e}function oW(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function N9(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}var fh={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function rW(t){if(t>=fh._0&&t<=fh._9)return t-fh._0;if(t>=fh._A&&t<=fh._F)return t-(fh._A-10);if(t>=fh._a&&t<=fh._f)return t-(fh._a-10)}function Y0(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let i=0,o=0;i<r;i++,o+=2){let s=rW(t.charCodeAt(o)),a=rW(t.charCodeAt(o+1));if(s===void 0||a===void 0){let d=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+o)}n[i]=s*16+a}return n}function hh(t){return N9(J0(t))}function T8(t){return yw(t),N9(J0(Uint8Array.from(t).reverse()))}function yy(t,e){return Y0(t.toString(16).padStart(e*2,"0"))}function A8(t,e){return yy(t,e).reverse()}function Rxe(t){return Y0(oW(t))}function Oc(t,e,r){let n;if(typeof e=="string")try{n=Y0(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(py(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function mw(...t){let e=0;for(let n=0;n<t.length;n++){let i=t[n];yw(i),e+=i.length}let r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}function Bxe(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function Oxe(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Mxe(t){let e;for(e=0;t>iW;t>>=S8,e+=1);return e}function Dxe(t,e){return t>>BigInt(e)&S8}function Cxe(t,e,r){return t|(r?S8:iW)<<BigInt(e)}var Ex=t=>(Pxe<<BigInt(t-1))-S8,$9=t=>new Uint8Array(t),nW=t=>Uint8Array.from(t);function U9(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=$9(t),i=$9(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...l)=>r(i,n,...l),d=(l=$9())=>{i=a(nW([0]),l),n=a(),l.length!==0&&(i=a(nW([1]),l),n=a())},u=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,h=[];for(;l<e;){n=a();let y=n.slice();h.push(y),l+=n.length}return mw(...h)};return(l,h)=>{s(),d(l);let y;for(;!(y=h(u()));)d();return s(),y}}var jxe={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||py(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function my(t,e,r={}){let n=(i,o,s)=>{let a=jxe[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let d=t[i];if(!(s&&d===void 0)&&!a(d,t))throw new Error(`Invalid param ${String(i)}=${d} (${typeof d}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return t}var Ao=BigInt(0),vi=BigInt(1),Z0=BigInt(2),$xe=BigInt(3),q9=BigInt(4),sW=BigInt(5),aW=BigInt(8),Nxe=BigInt(9),Uxe=BigInt(16);function Mc(t,e){let r=t%e;return r>=Ao?r:e+r}function Kxe(t,e,r){if(r<=Ao||e<Ao)throw new Error("Expected power/modulo > 0");if(r===vi)return Ao;let n=vi;for(;e>Ao;)e&vi&&(n=n*t%r),t=t*t%r,e>>=vi;return n}function k8(t,e){if(t===Ao||e<=Ao)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=Mc(t,e),n=e,i=Ao,o=vi,s=vi,a=Ao;for(;r!==Ao;){let u=n/r,c=n%r,l=i-s*u,h=o-a*u;n=r,r=c,i=s,o=a,s=l,a=h}if(n!==vi)throw new Error("invert: does not exist");return Mc(i,e)}function qxe(t){let e=(t-vi)/Z0,r,n,i;for(r=t-vi,n=0;r%Z0===Ao;r/=Z0,n++);for(i=Z0;i<t&&Kxe(i,e,t)!==t-vi;i++);if(n===1){let s=(t+vi)/q9;return function(d,u){let c=d.pow(u,s);if(!d.eql(d.sqr(c),u))throw new Error("Cannot find square root");return c}}let o=(r+vi)/Z0;return function(a,d){if(a.pow(d,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,c=a.pow(a.mul(a.ONE,i),r),l=a.pow(d,o),h=a.pow(d,r);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let y=1;for(let v=a.sqr(h);y<u&&!a.eql(v,a.ONE);y++)v=a.sqr(v);let g=a.pow(c,vi<<BigInt(u-y-1));c=a.sqr(g),l=a.mul(l,g),h=a.mul(h,c),u=y}return l}}function Lxe(t){if(t%q9===$xe){let e=(t+vi)/q9;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(t%aW===sW){let e=(t-sW)/aW;return function(n,i){let o=n.mul(i,Z0),s=n.pow(o,e),a=n.mul(i,s),d=n.mul(n.mul(a,Z0),s),u=n.mul(a,n.sub(d,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return t%Uxe,qxe(t)}var Fxe=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function L9(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=Fxe.reduce((n,i)=>(n[i]="function",n),e);return my(t,r)}function zxe(t,e,r){if(r<Ao)throw new Error("Expected power > 0");if(r===Ao)return t.ONE;if(r===vi)return e;let n=t.ONE,i=e;for(;r>Ao;)r&vi&&(n=t.mul(n,i)),i=t.sqr(i),r>>=vi;return n}function Vxe(t,e){let r=new Array(e.length),n=e.reduce((o,s,a)=>t.is0(s)?o:(r[a]=o,t.mul(o,s)),t.ONE),i=t.inv(n);return e.reduceRight((o,s,a)=>t.is0(s)?o:(r[a]=t.mul(o,r[a]),t.mul(o,s)),i),r}function F9(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function cW(t,e,r=!1,n={}){if(t<=Ao)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=F9(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=Lxe(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:Ex(i),ZERO:Ao,ONE:vi,create:d=>Mc(d,t),isValid:d=>{if(typeof d!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof d}`);return Ao<=d&&d<t},is0:d=>d===Ao,isOdd:d=>(d&vi)===vi,neg:d=>Mc(-d,t),eql:(d,u)=>d===u,sqr:d=>Mc(d*d,t),add:(d,u)=>Mc(d+u,t),sub:(d,u)=>Mc(d-u,t),mul:(d,u)=>Mc(d*u,t),pow:(d,u)=>zxe(a,d,u),div:(d,u)=>Mc(d*k8(u,t),t),sqrN:d=>d*d,addN:(d,u)=>d+u,subN:(d,u)=>d-u,mulN:(d,u)=>d*u,inv:d=>k8(d,t),sqrt:n.sqrt||(d=>s(a,d)),invertBatch:d=>Vxe(a,d),cmov:(d,u,c)=>c?u:d,toBytes:d=>r?A8(d,o):yy(d,o),fromBytes:d=>{if(d.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${d.length}`);return r?T8(d):hh(d)}});return Object.freeze(a)}function dW(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function z9(t){let e=dW(t);return e+Math.ceil(e/2)}function uW(t,e,r=!1){let n=t.length,i=dW(e),o=z9(e);if(n<16||n<o||n>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${n}`);let s=r?hh(t):T8(t),a=Mc(s,e-vi)+vi;return r?A8(a,i):yy(a,i)}var Wxe=BigInt(0),V9=BigInt(1);function lW(t,e){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=t.ZERO,a=i;for(;o>Wxe;)o&V9&&(s=s.add(a)),a=a.double(),o>>=V9;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),d=[],u=i,c=u;for(let l=0;l<s;l++){c=u,d.push(c);for(let h=1;h<a;h++)c=c.add(u),d.push(c);u=c.double()}return d},wNAF(i,o,s){let{windows:a,windowSize:d}=n(i),u=t.ZERO,c=t.BASE,l=BigInt(2**i-1),h=2**i,y=BigInt(i);for(let g=0;g<a;g++){let v=g*d,x=Number(s&l);s>>=y,x>d&&(x-=h,s+=V9);let S=v,A=v+Math.abs(x)-1,T=g%2!==0,$=x<0;x===0?c=c.add(r(T,o[S])):u=u.add(r($,o[A]))}return{p:u,f:c}},wNAFCached(i,o,s,a){let d=i._WINDOW_SIZE||1,u=o.get(i);return u||(u=this.precomputeWindow(i,d),d!==1&&o.set(i,a(u))),this.wNAF(d,u,s)}}}function H9(t){return L9(t.Fp),my(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...F9(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function Gxe(t){let e=H9(t);my(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:Jxe,hexToBytes:Yxe}=K9,X0={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=X0;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:Jxe(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=X0,r=typeof t=="string"?Yxe(t):t;yw(r);let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=X0._parseInt(r.subarray(2)),{d:s,l:a}=X0._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let c=u.toString(16);return c.length&1?`0${c}`:c},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),d=r(s);return`30${r(s+o+4)}02${d}${i}02${a}${n}`}},ph=BigInt(0),Td=BigInt(1),Wst=BigInt(2),fW=BigInt(3),Gst=BigInt(4);function Zxe(t){let e=Gxe(t),{Fp:r}=e,n=e.toBytes||((g,v,x)=>{let S=v.toAffine();return mw(Uint8Array.from([4]),r.toBytes(S.x),r.toBytes(S.y))}),i=e.fromBytes||(g=>{let v=g.subarray(1),x=r.fromBytes(v.subarray(0,r.BYTES)),S=r.fromBytes(v.subarray(r.BYTES,2*r.BYTES));return{x,y:S}});function o(g){let{a:v,b:x}=e,S=r.sqr(g),A=r.mul(S,g);return r.add(r.add(A,r.mul(g,v)),x)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(g){return typeof g=="bigint"&&ph<g&&g<e.n}function a(g){if(!s(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function d(g){let{allowedPrivateKeyLengths:v,nByteLength:x,wrapPrivateKey:S,n:A}=e;if(v&&typeof g!="bigint"){if(py(g)&&(g=J0(g)),typeof g!="string"||!v.includes(g.length))throw new Error("Invalid key");g=g.padStart(x*2,"0")}let T;try{T=typeof g=="bigint"?g:hh(Oc("private key",g,x))}catch{throw new Error(`private key must be ${x} bytes, hex or bigint, not ${typeof g}`)}return S&&(T=Mc(T,A)),a(T),T}let u=new Map;function c(g){if(!(g instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(v,x,S){if(this.px=v,this.py=x,this.pz=S,v==null||!r.isValid(v))throw new Error("x required");if(x==null||!r.isValid(x))throw new Error("y required");if(S==null||!r.isValid(S))throw new Error("z required")}static fromAffine(v){let{x,y:S}=v||{};if(!v||!r.isValid(x)||!r.isValid(S))throw new Error("invalid affine point");if(v instanceof l)throw new Error("projective point not allowed");let A=T=>r.eql(T,r.ZERO);return A(x)&&A(S)?l.ZERO:new l(x,S,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){let x=r.invertBatch(v.map(S=>S.pz));return v.map((S,A)=>S.toAffine(x[A])).map(l.fromAffine)}static fromHex(v){let x=l.fromAffine(i(Oc("pointHex",v)));return x.assertValidity(),x}static fromPrivateKey(v){return l.BASE.multiply(d(v))}_setWindowSize(v){this._WINDOW_SIZE=v,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:v,y:x}=this.toAffine();if(!r.isValid(v)||!r.isValid(x))throw new Error("bad point: x or y not FE");let S=r.sqr(x),A=o(v);if(!r.eql(S,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:v}=this.toAffine();if(r.isOdd)return!r.isOdd(v);throw new Error("Field doesn't support isOdd")}equals(v){c(v);let{px:x,py:S,pz:A}=this,{px:T,py:$,pz:j}=v,K=r.eql(r.mul(x,j),r.mul(T,A)),F=r.eql(r.mul(S,j),r.mul($,A));return K&&F}negate(){return new l(this.px,r.neg(this.py),this.pz)}double(){let{a:v,b:x}=e,S=r.mul(x,fW),{px:A,py:T,pz:$}=this,j=r.ZERO,K=r.ZERO,F=r.ZERO,L=r.mul(A,A),V=r.mul(T,T),q=r.mul($,$),k=r.mul(A,T);return k=r.add(k,k),F=r.mul(A,$),F=r.add(F,F),j=r.mul(v,F),K=r.mul(S,q),K=r.add(j,K),j=r.sub(V,K),K=r.add(V,K),K=r.mul(j,K),j=r.mul(k,j),F=r.mul(S,F),q=r.mul(v,q),k=r.sub(L,q),k=r.mul(v,k),k=r.add(k,F),F=r.add(L,L),L=r.add(F,L),L=r.add(L,q),L=r.mul(L,k),K=r.add(K,L),q=r.mul(T,$),q=r.add(q,q),L=r.mul(q,k),j=r.sub(j,L),F=r.mul(q,V),F=r.add(F,F),F=r.add(F,F),new l(j,K,F)}add(v){c(v);let{px:x,py:S,pz:A}=this,{px:T,py:$,pz:j}=v,K=r.ZERO,F=r.ZERO,L=r.ZERO,V=e.a,q=r.mul(e.b,fW),k=r.mul(x,T),P=r.mul(S,$),B=r.mul(A,j),p=r.add(x,S),m=r.add(T,$);p=r.mul(p,m),m=r.add(k,P),p=r.sub(p,m),m=r.add(x,A);let w=r.add(T,j);return m=r.mul(m,w),w=r.add(k,B),m=r.sub(m,w),w=r.add(S,A),K=r.add($,j),w=r.mul(w,K),K=r.add(P,B),w=r.sub(w,K),L=r.mul(V,m),K=r.mul(q,B),L=r.add(K,L),K=r.sub(P,L),L=r.add(P,L),F=r.mul(K,L),P=r.add(k,k),P=r.add(P,k),B=r.mul(V,B),m=r.mul(q,m),P=r.add(P,B),B=r.sub(k,B),B=r.mul(V,B),m=r.add(m,B),k=r.mul(P,m),F=r.add(F,k),k=r.mul(w,m),K=r.mul(p,K),K=r.sub(K,k),k=r.mul(p,P),L=r.mul(w,L),L=r.add(L,k),new l(K,F,L)}subtract(v){return this.add(v.negate())}is0(){return this.equals(l.ZERO)}wNAF(v){return y.wNAFCached(this,u,v,x=>{let S=r.invertBatch(x.map(A=>A.pz));return x.map((A,T)=>A.toAffine(S[T])).map(l.fromAffine)})}multiplyUnsafe(v){let x=l.ZERO;if(v===ph)return x;if(a(v),v===Td)return this;let{endo:S}=e;if(!S)return y.unsafeLadder(this,v);let{k1neg:A,k1:T,k2neg:$,k2:j}=S.splitScalar(v),K=x,F=x,L=this;for(;T>ph||j>ph;)T&Td&&(K=K.add(L)),j&Td&&(F=F.add(L)),L=L.double(),T>>=Td,j>>=Td;return A&&(K=K.negate()),$&&(F=F.negate()),F=new l(r.mul(F.px,S.beta),F.py,F.pz),K.add(F)}multiply(v){a(v);let x=v,S,A,{endo:T}=e;if(T){let{k1neg:$,k1:j,k2neg:K,k2:F}=T.splitScalar(x),{p:L,f:V}=this.wNAF(j),{p:q,f:k}=this.wNAF(F);L=y.constTimeNegate($,L),q=y.constTimeNegate(K,q),q=new l(r.mul(q.px,T.beta),q.py,q.pz),S=L.add(q),A=V.add(k)}else{let{p:$,f:j}=this.wNAF(x);S=$,A=j}return l.normalizeZ([S,A])[0]}multiplyAndAddUnsafe(v,x,S){let A=l.BASE,T=(j,K)=>K===ph||K===Td||!j.equals(A)?j.multiplyUnsafe(K):j.multiply(K),$=T(this,x).add(T(v,S));return $.is0()?void 0:$}toAffine(v){let{px:x,py:S,pz:A}=this,T=this.is0();v==null&&(v=T?r.ONE:r.inv(A));let $=r.mul(x,v),j=r.mul(S,v),K=r.mul(A,v);if(T)return{x:r.ZERO,y:r.ZERO};if(!r.eql(K,r.ONE))throw new Error("invZ was invalid");return{x:$,y:j}}isTorsionFree(){let{h:v,isTorsionFree:x}=e;if(v===Td)return!0;if(x)return x(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:v,clearCofactor:x}=e;return v===Td?this:x?x(l,this):this.multiplyUnsafe(e.h)}toRawBytes(v=!0){return this.assertValidity(),n(l,this,v)}toHex(v=!0){return J0(this.toRawBytes(v))}}l.BASE=new l(e.Gx,e.Gy,r.ONE),l.ZERO=new l(r.ZERO,r.ONE,r.ZERO);let h=e.nBitLength,y=lW(l,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:l,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:s}}function Xxe(t){let e=H9(t);return my(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function hW(t){let e=Xxe(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(m){return ph<m&&m<r.ORDER}function a(m){return Mc(m,n)}function d(m){return k8(m,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:l,isWithinCurveOrder:h}=Zxe({...e,toBytes(m,w,E){let _=w.toAffine(),b=r.toBytes(_.x),C=mw;return E?C(Uint8Array.from([w.hasEvenY()?2:3]),b):C(Uint8Array.from([4]),b,r.toBytes(_.y))},fromBytes(m){let w=m.length,E=m[0],_=m.subarray(1);if(w===i&&(E===2||E===3)){let b=hh(_);if(!s(b))throw new Error("Point is not on curve");let C=l(b),N;try{N=r.sqrt(C)}catch(G){let Y=G instanceof Error?": "+G.message:"";throw new Error("Point is not on curve"+Y)}let D=(N&Td)===Td;return(E&1)===1!==D&&(N=r.neg(N)),{x:b,y:N}}else if(w===o&&E===4){let b=r.fromBytes(_.subarray(0,r.BYTES)),C=r.fromBytes(_.subarray(r.BYTES,2*r.BYTES));return{x:b,y:C}}else throw new Error(`Point of length ${w} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),y=m=>J0(yy(m,e.nByteLength));function g(m){let w=n>>Td;return m>w}function v(m){return g(m)?a(-m):m}let x=(m,w,E)=>hh(m.slice(w,E));class S{constructor(w,E,_){this.r=w,this.s=E,this.recovery=_,this.assertValidity()}static fromCompact(w){let E=e.nByteLength;return w=Oc("compactSignature",w,E*2),new S(x(w,0,E),x(w,E,2*E))}static fromDER(w){let{r:E,s:_}=X0.toSig(Oc("DER",w));return new S(E,_)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(w){return new S(this.r,this.s,w)}recoverPublicKey(w){let{r:E,s:_,recovery:b}=this,C=F(Oc("msgHash",w));if(b==null||![0,1,2,3].includes(b))throw new Error("recovery id invalid");let N=b===2||b===3?E+e.n:E;if(N>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let D=b&1?"03":"02",U=u.fromHex(D+y(N)),G=d(N),Y=a(-C*G),J=a(_*G),H=u.BASE.multiplyAndAddUnsafe(U,Y,J);if(!H)throw new Error("point at infinify");return H.assertValidity(),H}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new S(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return Y0(this.toDERHex())}toDERHex(){return X0.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return Y0(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}let A={isValidPrivateKey(m){try{return c(m),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{let m=z9(e.n);return uW(e.randomBytes(m),e.n)},precompute(m=8,w=u.BASE){return w._setWindowSize(m),w.multiply(BigInt(3)),w}};function T(m,w=!0){return u.fromPrivateKey(m).toRawBytes(w)}function $(m){let w=py(m),E=typeof m=="string",_=(w||E)&&m.length;return w?_===i||_===o:E?_===2*i||_===2*o:m instanceof u}function j(m,w,E=!0){if($(m))throw new Error("first arg must be private key");if(!$(w))throw new Error("second arg must be public key");return u.fromHex(w).multiply(c(m)).toRawBytes(E)}let K=e.bits2int||function(m){let w=hh(m),E=m.length*8-e.nBitLength;return E>0?w>>BigInt(E):w},F=e.bits2int_modN||function(m){return a(K(m))},L=Ex(e.nBitLength);function V(m){if(typeof m!="bigint")throw new Error("bigint expected");if(!(ph<=m&&m<L))throw new Error(`bigint expected < 2^${e.nBitLength}`);return yy(m,e.nByteLength)}function q(m,w,E=k){if(["recovered","canonical"].some(te=>te in E))throw new Error("sign() legacy options not supported");let{hash:_,randomBytes:b}=e,{lowS:C,prehash:N,extraEntropy:D}=E;C==null&&(C=!0),m=Oc("msgHash",m),N&&(m=Oc("prehashed msgHash",_(m)));let U=F(m),G=c(w),Y=[V(G),V(U)];if(D!=null&&D!==!1){let te=D===!0?b(r.BYTES):D;Y.push(Oc("extraEntropy",te))}let J=mw(...Y),H=U;function X(te){let ne=K(te);if(!h(ne))return;let Q=d(ne),re=u.BASE.multiply(ne).toAffine(),ae=a(re.x);if(ae===ph)return;let he=a(Q*a(H+ae*G));if(he===ph)return;let ge=(re.x===ae?0:2)|Number(re.y&Td),ie=he;return C&&g(he)&&(ie=v(he),ge^=1),new S(ae,ie,ge)}return{seed:J,k2sig:X}}let k={lowS:e.lowS,prehash:!1},P={lowS:e.lowS,prehash:!1};function B(m,w,E=k){let{seed:_,k2sig:b}=q(m,w,E),C=e;return U9(C.hash.outputLen,C.nByteLength,C.hmac)(_,b)}u.BASE._setWindowSize(8);function p(m,w,E,_=P){let b=m;if(w=Oc("msgHash",w),E=Oc("publicKey",E),"strict"in _)throw new Error("options.strict was renamed to lowS");let{lowS:C,prehash:N}=_,D,U;try{if(typeof b=="string"||py(b))try{D=S.fromDER(b)}catch(re){if(!(re instanceof X0.Err))throw re;D=S.fromCompact(b)}else if(typeof b=="object"&&typeof b.r=="bigint"&&typeof b.s=="bigint"){let{r:re,s:ae}=b;D=new S(re,ae)}else throw new Error("PARSE");U=u.fromHex(E)}catch(re){if(re.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(C&&D.hasHighS())return!1;N&&(w=e.hash(w));let{r:G,s:Y}=D,J=F(w),H=d(Y),X=a(J*H),te=a(G*H),ne=u.BASE.multiplyAndAddUnsafe(U,X,te)?.toAffine();return ne?a(ne.x)===G:!1}return{CURVE:e,getPublicKey:T,getSharedSecret:j,sign:B,verify:p,ProjectivePoint:u,Signature:S,utils:A}}function Qxe(t){return{hash:t,hmac:(e,...r)=>j9(t,e,XH(...r)),randomBytes:pw}}function pW(t,e){let r=n=>hW({...t,...Qxe(n)});return Object.freeze({...r(e),create:r})}var yW=cW(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),eEe=yW.create(BigInt("-3")),tEe=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),yh=pW({a:eEe,b:tEe,Fp:yW,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},To),mW=yh;f();f();function W9(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}f();f();function mh(t=0){return new Uint8Array(t)}function rc(t=0){return new Uint8Array(t)}f();f();f();function gw(t,e){e==null&&(e=t.reduce((i,o)=>i+o.length,0));let r=rc(e),n=0;for(let i of t)r.set(i,n),n+=i.length;return r}f();f();f();var tO={};Or(tO,{base10:()=>lEe});f();f();var vw={};Or(vw,{coerce:()=>Cl,empty:()=>gW,equals:()=>G9,fromHex:()=>iEe,fromString:()=>J9,isBinary:()=>oEe,toHex:()=>nEe,toString:()=>Y9});f();var gW=new Uint8Array(0);function nEe(t){return t.reduce((e,r)=>e+r.toString(16).padStart(2,"0"),"")}function iEe(t){let e=t.match(/../g);return e!=null?new Uint8Array(e.map(r=>parseInt(r,16))):gW}function G9(t,e){if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0}function Cl(t){if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")}function oEe(t){return t instanceof ArrayBuffer||ArrayBuffer.isView(t)}function J9(t){return new TextEncoder().encode(t)}function Y9(t){return new TextDecoder().decode(t)}f();function sEe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,d=t.charAt(0),u=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function l(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var v=0,x=0,S=0,A=g.length;S!==A&&g[S]===0;)S++,v++;for(var T=(A-S)*c+1>>>0,$=new Uint8Array(T);S!==A;){for(var j=g[S],K=0,F=T-1;(j!==0||K<x)&&F!==-1;F--,K++)j+=256*$[F]>>>0,$[F]=j%a>>>0,j=j/a>>>0;if(j!==0)throw new Error("Non-zero carry");x=K,S++}for(var L=T-x;L!==T&&$[L]===0;)L++;for(var V=d.repeat(v);L<T;++L)V+=t.charAt($[L]);return V}function h(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var v=0;if(g[v]!==" "){for(var x=0,S=0;g[v]===d;)x++,v++;for(var A=(g.length-v)*u+1>>>0,T=new Uint8Array(A);g[v];){var $=r[g.charCodeAt(v)];if($===255)return;for(var j=0,K=A-1;($!==0||j<S)&&K!==-1;K--,j++)$+=a*T[K]>>>0,T[K]=$%256>>>0,$=$/256>>>0;if($!==0)throw new Error("Non-zero carry");S=j,v++}if(g[v]!==" "){for(var F=A-S;F!==A&&T[F]===0;)F++;for(var L=new Uint8Array(x+(A-F)),V=x;F!==A;)L[V++]=T[F++];return L}}}function y(g){var v=h(g);if(v)return v;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:h,decode:y}}var aEe=sEe,cEe=aEe,vW=cEe;var Z9=class{name;prefix;baseEncode;constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},X9=class{name;prefix;baseDecode;prefixCodePoint;constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return bW(this,e)}},Q9=class{decoders;constructor(e){this.decoders=e}or(e){return bW(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n!=null)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}};function bW(t,e){return new Q9({...t.decoders??{[t.prefix]:t},...e.decoders??{[e.prefix]:e}})}var eO=class{name;prefix;baseEncode;baseDecode;encoder;decoder;constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new Z9(e,r,n),this.decoder=new X9(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}};function bw({name:t,prefix:e,encode:r,decode:n}){return new eO(t,e,r,n)}function gy({name:t,prefix:e,alphabet:r}){let{encode:n,decode:i}=vW(r,t);return bw({prefix:e,name:t,encode:n,decode:o=>Cl(i(o))})}function dEe(t,e,r,n){let i={};for(let c=0;c<e.length;++c)i[e[c]]=c;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,d=0,u=0;for(let c=0;c<o;++c){let l=i[t[c]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);d=d<<r|l,a+=r,a>=8&&(a-=8,s[u++]=255&d>>a)}if(a>=r||255&d<<8-a)throw new SyntaxError("Unexpected end of data");return s}function uEe(t,e,r){let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let d=0;d<t.length;++d)for(a=a<<8|t[d],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s!==0&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o}function bi({name:t,prefix:e,bitsPerChar:r,alphabet:n}){return bw({prefix:e,name:t,encode(i){return uEe(i,n,r)},decode(i){return dEe(i,n,r,t)}})}var lEe=gy({prefix:"9",name:"base10",alphabet:"0123456789"});var rO={};Or(rO,{base16:()=>fEe,base16upper:()=>hEe});f();var fEe=bi({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),hEe=bi({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var nO={};Or(nO,{base2:()=>pEe});f();var pEe=bi({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var iO={};Or(iO,{base256emoji:()=>bEe});f();var wW=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),yEe=wW.reduce((t,e,r)=>(t[r]=e,t),[]),mEe=wW.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function gEe(t){return t.reduce((e,r)=>(e+=yEe[r],e),"")}function vEe(t){let e=[];for(let r of t){let n=mEe[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var bEe=bw({prefix:"\u{1F680}",name:"base256emoji",encode:gEe,decode:vEe});var oO={};Or(oO,{base32:()=>ww,base32hex:()=>EEe,base32hexpad:()=>TEe,base32hexpadupper:()=>AEe,base32hexupper:()=>SEe,base32pad:()=>_Ee,base32padupper:()=>xEe,base32upper:()=>wEe,base32z:()=>P8});f();var ww=bi({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),wEe=bi({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),_Ee=bi({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),xEe=bi({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),EEe=bi({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),SEe=bi({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),TEe=bi({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),AEe=bi({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),P8=bi({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var sO={};Or(sO,{base36:()=>kEe,base36upper:()=>PEe});f();var kEe=gy({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),PEe=gy({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var aO={};Or(aO,{base58btc:()=>Aa,base58flickr:()=>IEe});f();var Aa=gy({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),IEe=gy({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});var cO={};Or(cO,{base64:()=>REe,base64pad:()=>BEe,base64url:()=>Tu,base64urlpad:()=>OEe});f();var REe=bi({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),BEe=bi({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Tu=bi({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),OEe=bi({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var dO={};Or(dO,{base8:()=>MEe});f();var MEe=bi({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var uO={};Or(uO,{identity:()=>DEe});f();var DEe=bw({prefix:"\0",name:"identity",encode:t=>Y9(t),decode:t=>J9(t)});f();var Zat=new TextEncoder,Xat=new TextDecoder;f();var fO={};Or(fO,{identity:()=>n6e});f();f();var jl={};Or(jl,{decode:()=>_w,encodeTo:()=>Q0,encodingLength:()=>eg});f();f();var $Ee=EW,_W=128,NEe=127,UEe=~NEe,KEe=Math.pow(2,31);function EW(t,e,r){e=e||[],r=r||0;for(var n=r;t>=KEe;)e[r++]=t&255|_W,t/=128;for(;t&UEe;)e[r++]=t&255|_W,t>>>=7;return e[r]=t|0,EW.bytes=r-n+1,e}var qEe=lO,LEe=128,xW=127;function lO(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw lO.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&xW)<<i:(s&xW)*Math.pow(2,i),i+=7}while(s>=LEe);return lO.bytes=o-n,r}var FEe=Math.pow(2,7),zEe=Math.pow(2,14),VEe=Math.pow(2,21),HEe=Math.pow(2,28),WEe=Math.pow(2,35),GEe=Math.pow(2,42),JEe=Math.pow(2,49),YEe=Math.pow(2,56),ZEe=Math.pow(2,63),XEe=function(t){return t<FEe?1:t<zEe?2:t<VEe?3:t<HEe?4:t<WEe?5:t<GEe?6:t<JEe?7:t<YEe?8:t<ZEe?9:10},QEe={encode:$Ee,decode:qEe,encodingLength:XEe},e6e=QEe,Sx=e6e;function _w(t,e=0){return[Sx.decode(t,e),Sx.decode.bytes]}function Q0(t,e,r=0){return Sx.encode(t,e,r),e}function eg(t){return Sx.encodingLength(t)}function tg(t,e){let r=e.byteLength,n=eg(t),i=n+eg(r),o=new Uint8Array(i+r);return Q0(t,o,0),Q0(r,o,n),o.set(e,i),new xw(t,r,e,o)}function SW(t){let e=Cl(t),[r,n]=_w(e),[i,o]=_w(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new xw(r,i,s,e)}function TW(t,e){if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&G9(t.bytes,r.bytes)}}var xw=class{code;size;digest;bytes;constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};var AW=0,t6e="identity",kW=Cl;function r6e(t){return tg(AW,kW(t))}var n6e={code:AW,name:t6e,encode:kW,digest:r6e};var pO={};Or(pO,{sha256:()=>i6e,sha512:()=>o6e});f();f();function rg({name:t,code:e,encode:r}){return new hO(t,e,r)}var hO=class{name;code;encode;constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?tg(this.code,r):r.then(n=>tg(this.code,n))}else throw Error("Unknown type, must be binary type")}};function IW(t){return async e=>new Uint8Array(await crypto.subtle.digest(t,e))}var i6e=rg({name:"sha2-256",code:18,encode:IW("SHA-256")}),o6e=rg({name:"sha2-512",code:19,encode:IW("SHA-512")});f();f();f();function RW(t,e){let{bytes:r,version:n}=t;switch(n){case 0:return a6e(r,yO(t),e??Aa.encoder);default:return c6e(r,yO(t),e??ww.encoder)}}var BW=new WeakMap;function yO(t){let e=BW.get(t);if(e==null){let r=new Map;return BW.set(t,r),r}return e}var Au=class t{code;version;multihash;bytes;"/";constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Ax)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==d6e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=tg(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n!=null&&e.code===n.code&&e.version===n.version&&TW(e.multihash,n.multihash)}toString(e){return RW(this,e)}toJSON(){return{"/":RW(this)}}link(){return this}[Symbol.toStringTag]="CID";[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s??OW(n,i,o.bytes))}else if(r[u6e]===!0){let{version:n,multihash:i,code:o}=r,s=SW(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Ax)throw new Error(`Version 0 CID must use dag-pb (code: ${Ax}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=OW(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Ax,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length!==0)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=Cl(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new xw(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[l,h]=_w(e.subarray(r));return r+=h,l},i=n(),o=Ax;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),d=n(),u=r+d,c=u-s;return{version:i,codec:o,multihashCode:a,digestSize:d,multihashSize:c,size:u}}static parse(e,r){let[n,i]=s6e(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return yO(o).set(n,e),o}};function s6e(t,e){switch(t[0]){case"Q":{let r=e??Aa;return[Aa.prefix,r.decode(`${Aa.prefix}${t}`)]}case Aa.prefix:{let r=e??Aa;return[Aa.prefix,r.decode(t)]}case ww.prefix:{let r=e??ww;return[ww.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}}function a6e(t,e,r){let{prefix:n}=r;if(n!==Aa.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i}function c6e(t,e,r){let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i}var Ax=112,d6e=18;function OW(t,e,r){let n=eg(t),i=n+eg(e),o=new Uint8Array(i+r.byteLength);return Q0(t,o,0),Q0(e,o,n),o.set(r,i),o}var u6e=Symbol.for("@ipld/js-cid/CID");f();f();f();f();f();var mO={...uO,...nO,...dO,...tO,...rO,...oO,...sO,...aO,...cO,...iO},Cct={...pO,...fO};function DW(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var MW=DW("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),gO=DW("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=rc(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),l6e={utf8:MW,"utf-8":MW,hex:mO.base16,latin1:gO,ascii:gO,binary:gO,...mO},I8=l6e;function ng(t,e="utf8"){let r=I8[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return r.decoder.decode(`${r.prefix}${t}`)}f();function vO(t,e="utf8"){let r=I8[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return r.encoder.encode(t).substring(1)}var R8=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},f6e={toString:vO,fromString:ng},vy=class t{static validateKey(e){if(e.kty!=="EC"||e.crv!=="P-256")throw new de(se.Secp256r1KeyNotValid,"Invalid SECP256R1 JWK: `kty` MUST be `EC`. `crv` MUST be `P-256`")}static publicKeyToJwk(e){return R8(this,void 0,void 0,function*(){let r;e.byteLength===33?r=yh.ProjectivePoint.fromHex(e).toRawBytes(!1):r=e;let n=Ke.bytesToBase64Url(r.subarray(1,33)),i=Ke.bytesToBase64Url(r.subarray(33,65));return{alg:"ES256",kty:"EC",crv:"P-256",x:n,y:i}})}static privateJwkToBytes(e){return Ke.base64UrlToBytes(e.d)}static sign(e,r){return R8(this,void 0,void 0,function*(){t.validateKey(r);let n=yield Vs.encode(e),i=t.privateJwkToBytes(r);return Promise.resolve(yh.sign(n,i).toCompactRawBytes())})}static verify(e,r,n){return R8(this,void 0,void 0,function*(){t.validateKey(n);let i;r.length===64?i=yh.Signature.fromCompact(r):i=yh.Signature.fromDER(r);let o=yield Vs.encode(e),s=yh.ProjectivePoint.fromAffine({x:t.bytesToBigInt(Ke.base64UrlToBytes(n.x)),y:t.bytesToBigInt(Ke.base64UrlToBytes(n.y))}).toRawBytes(!1);return yh.verify(i,o,s)})}static generateKeyPair(){return R8(this,void 0,void 0,function*(){let e=yh.utils.randomPrivateKey(),r=mW.getPublicKey(e,!1),n=Ke.bytesToBase64Url(e),i=yield t.publicKeyToJwk(r),o=Object.assign(Object.assign({},i),{d:n});return{publicJwk:i,privateJwk:o}})}static bytesToBigInt(e){return BigInt("0x"+f6e.toString(e,"base16"))}};var Ew={Ed25519:S9,secp256k1:{sign:Wi.sign,verify:Wi.verify,generateKeyPair:Wi.generateKeyPair,publicKeyToJwk:Wi.publicKeyToJwk},"P-256":{sign:vy.sign,verify:vy.verify,generateKeyPair:vy.generateKeyPair,publicKeyToJwk:vy.publicKeyToJwk}};var h6e=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Sw=class{constructor(e){var r,n;if(e.keyId===void 0&&e.privateJwk.kid===void 0)throw new de(se.PrivateKeySignerUnableToDeduceKeyId,"Unable to deduce the key ID");if(e.algorithm===void 0&&e.privateJwk.alg===void 0)throw new de(se.PrivateKeySignerUnableToDeduceAlgorithm,"Unable to deduce the signature algorithm");if(this.keyId=(r=e.keyId)!==null&&r!==void 0?r:e.privateJwk.kid,this.algorithm=(n=e.algorithm)!==null&&n!==void 0?n:e.privateJwk.alg,this.privateJwk=e.privateJwk,this.signatureAlgorithm=Ew[e.privateJwk.crv],!this.signatureAlgorithm)throw new de(se.PrivateKeySignerUnsupportedCurve,`Unsupported crv ${e.privateJwk.crv}, crv must be one of ${Object.keys(Ew)}`)}sign(e){return h6e(this,void 0,void 0,function*(){return yield this.signatureAlgorithm.sign(e,this.privateJwk)})}};var p6e=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},cn=class t{static getKid(e){let{kid:r}=Ke.base64UrlToObject(e.protected);return r}static getSignerDid(e){let r=t.getKid(e);return t.extractDid(r)}static verifySignature(e,r,n){return p6e(this,void 0,void 0,function*(){let i=Ew[n.crv];if(!i)throw new de(se.JwsVerifySignatureUnsupportedCrv,`unsupported crv. crv must be one of ${Object.keys(Ew)}`);let o=Ke.stringToBytes(`${r.protected}.${e}`),s=Ke.base64UrlToBytes(r.signature);return yield i.verify(o,s,n)})}static decodePlainObjectPayload(e){let r;try{r=Ke.base64UrlToObject(e.payload)}catch{throw new de(se.JwsDecodePlainObjectPayloadInvalid,"payload is not a JSON object")}if(!(0,CW.default)(r))throw new de(se.JwsDecodePlainObjectPayloadInvalid,"signed payload must be a plain object");return r}static extractDid(e){let[r]=e.split("#");return r}static createSigners(e){return e.map(n=>t.createSigner(n))}static createSigner(e){let r=e.keyPair.privateJwk,n=e.keyId;return new Sw({privateJwk:r,keyId:n})}};f();f();var kx=typeof performance=="object"&&performance&&typeof performance.now=="function"?performance:Date,$W=new Set,bO=typeof I.default=="object"&&I.default?I.default:{},NW=(t,e,r,n)=>{typeof bO.emitWarning=="function"?bO.emitWarning(t,e,r,n):console.error(`[${r}] ${e}: ${t}`)},B8=globalThis.AbortController,jW=globalThis.AbortSignal;if(typeof B8>"u"){jW=class{onabort;_onabort=[];reason;aborted=!1;addEventListener(n,i){this._onabort.push(i)}},B8=class{constructor(){e()}signal=new jW;abort(n){if(!this.signal.aborted){this.signal.reason=n,this.signal.aborted=!0;for(let i of this.signal._onabort)i(n);this.signal.onabort?.(n)}}};let t=bO.env?.LRU_CACHE_IGNORE_AC_WARNING!=="1",e=()=>{t&&(t=!1,NW("AbortController is not defined. If using lru-cache in node 14, load an AbortController polyfill from the `node-abort-controller` package. A minimal polyfill is provided for use by LRUCache.fetch(), but it should not be relied upon in other contexts (eg, passing it to other APIs that use AbortController/AbortSignal might have undesirable effects). You may disable this with LRU_CACHE_IGNORE_AC_WARNING=1 in the env.","NO_ABORT_CONTROLLER","ENOTSUP",e))}}var y6e=t=>!$W.has(t),Pdt=Symbol("type"),by=t=>t&&t===Math.floor(t)&&t>0&&isFinite(t),UW=t=>by(t)?t<=Math.pow(2,8)?Uint8Array:t<=Math.pow(2,16)?Uint16Array:t<=Math.pow(2,32)?Uint32Array:t<=Number.MAX_SAFE_INTEGER?Tw:null:null,Tw=class extends Array{constructor(e){super(e),this.fill(0)}},wO=class t{heap;length;static#c=!1;static create(e){let r=UW(e);if(!r)return[];t.#c=!0;let n=new t(e,r);return t.#c=!1,n}constructor(e,r){if(!t.#c)throw new TypeError("instantiate Stack using Stack.create(n)");this.heap=new r(e),this.length=0}push(e){this.heap[this.length++]=e}pop(){return this.heap[--this.length]}},O8=class t{#c;#l;#v;#p;#I;ttl;ttlResolution;ttlAutopurge;updateAgeOnGet;updateAgeOnHas;allowStale;noDisposeOnSet;noUpdateTTL;maxEntrySize;sizeCalculation;noDeleteOnFetchRejection;noDeleteOnStaleGet;allowStaleOnFetchAbort;allowStaleOnFetchRejection;ignoreFetchAbort;#n;#y;#i;#r;#e;#d;#f;#a;#o;#m;#s;#x;#E;#g;#b;#T;#u;static unsafeExposeInternals(e){return{starts:e.#E,ttls:e.#g,sizes:e.#x,keyMap:e.#i,keyList:e.#r,valList:e.#e,next:e.#d,prev:e.#f,get head(){return e.#a},get tail(){return e.#o},free:e.#m,isBackgroundFetch:r=>e.#t(r),backgroundFetch:(r,n,i,o)=>e.#O(r,n,i,o),moveToTail:r=>e.#P(r),indexes:r=>e.#w(r),rindexes:r=>e.#_(r),isStale:r=>e.#h(r)}}get max(){return this.#c}get maxSize(){return this.#l}get calculatedSize(){return this.#y}get size(){return this.#n}get fetchMethod(){return this.#I}get dispose(){return this.#v}get disposeAfter(){return this.#p}constructor(e){let{max:r=0,ttl:n,ttlResolution:i=1,ttlAutopurge:o,updateAgeOnGet:s,updateAgeOnHas:a,allowStale:d,dispose:u,disposeAfter:c,noDisposeOnSet:l,noUpdateTTL:h,maxSize:y=0,maxEntrySize:g=0,sizeCalculation:v,fetchMethod:x,noDeleteOnFetchRejection:S,noDeleteOnStaleGet:A,allowStaleOnFetchRejection:T,allowStaleOnFetchAbort:$,ignoreFetchAbort:j}=e;if(r!==0&&!by(r))throw new TypeError("max option must be a nonnegative integer");let K=r?UW(r):Array;if(!K)throw new Error("invalid max value: "+r);if(this.#c=r,this.#l=y,this.maxEntrySize=g||this.#l,this.sizeCalculation=v,this.sizeCalculation){if(!this.#l&&!this.maxEntrySize)throw new TypeError("cannot set sizeCalculation without setting maxSize or maxEntrySize");if(typeof this.sizeCalculation!="function")throw new TypeError("sizeCalculation set to non-function")}if(x!==void 0&&typeof x!="function")throw new TypeError("fetchMethod must be a function if specified");if(this.#I=x,this.#T=!!x,this.#i=new Map,this.#r=new Array(r).fill(void 0),this.#e=new Array(r).fill(void 0),this.#d=new K(r),this.#f=new K(r),this.#a=0,this.#o=0,this.#m=wO.create(r),this.#n=0,this.#y=0,typeof u=="function"&&(this.#v=u),typeof c=="function"?(this.#p=c,this.#s=[]):(this.#p=void 0,this.#s=void 0),this.#b=!!this.#v,this.#u=!!this.#p,this.noDisposeOnSet=!!l,this.noUpdateTTL=!!h,this.noDeleteOnFetchRejection=!!S,this.allowStaleOnFetchRejection=!!T,this.allowStaleOnFetchAbort=!!$,this.ignoreFetchAbort=!!j,this.maxEntrySize!==0){if(this.#l!==0&&!by(this.#l))throw new TypeError("maxSize must be a positive integer if specified");if(!by(this.maxEntrySize))throw new TypeError("maxEntrySize must be a positive integer if specified");this.#N()}if(this.allowStale=!!d,this.noDeleteOnStaleGet=!!A,this.updateAgeOnGet=!!s,this.updateAgeOnHas=!!a,this.ttlResolution=by(i)||i===0?i:1,this.ttlAutopurge=!!o,this.ttl=n||0,this.ttl){if(!by(this.ttl))throw new TypeError("ttl must be a positive integer if specified");this.#M()}if(this.#c===0&&this.ttl===0&&this.#l===0)throw new TypeError("At least one of max, maxSize, or ttl is required");if(!this.ttlAutopurge&&!this.#c&&!this.#l){let F="LRU_CACHE_UNBOUNDED";y6e(F)&&($W.add(F),NW("TTL caching without ttlAutopurge, max, or maxSize can result in unbounded memory consumption.","UnboundedCacheWarning",F,t))}}getRemainingTTL(e){return this.#i.has(e)?1/0:0}#M(){let e=new Tw(this.#c),r=new Tw(this.#c);this.#g=e,this.#E=r,this.#D=(o,s,a=kx.now())=>{if(r[o]=s!==0?a:0,e[o]=s,s!==0&&this.ttlAutopurge){let d=setTimeout(()=>{this.#h(o)&&this.delete(this.#r[o])},s+1);d.unref&&d.unref()}},this.#A=o=>{r[o]=e[o]!==0?kx.now():0},this.#S=(o,s)=>{if(e[s]){let a=e[s],d=r[s];o.ttl=a,o.start=d,o.now=n||i();let u=o.now-d;o.remainingTTL=a-u}};let n=0,i=()=>{let o=kx.now();if(this.ttlResolution>0){n=o;let s=setTimeout(()=>n=0,this.ttlResolution);s.unref&&s.unref()}return o};this.getRemainingTTL=o=>{let s=this.#i.get(o);if(s===void 0)return 0;let a=e[s],d=r[s];if(a===0||d===0)return 1/0;let u=(n||i())-d;return a-u},this.#h=o=>e[o]!==0&&r[o]!==0&&(n||i())-r[o]>e[o]}#A=()=>{};#S=()=>{};#D=()=>{};#h=()=>!1;#N(){let e=new Tw(this.#c);this.#y=0,this.#x=e,this.#k=r=>{this.#y-=e[r],e[r]=0},this.#C=(r,n,i,o)=>{if(this.#t(n))return 0;if(!by(i))if(o){if(typeof o!="function")throw new TypeError("sizeCalculation must be a function");if(i=o(n,r),!by(i))throw new TypeError("sizeCalculation return invalid (expect positive integer)")}else throw new TypeError("invalid size value (must be positive integer). When maxSize or maxEntrySize is used, sizeCalculation or size must be set.");return i},this.#R=(r,n,i)=>{if(e[r]=n,this.#l){let o=this.#l-e[r];for(;this.#y>o;)this.#B(!0)}this.#y+=e[r],i&&(i.entrySize=n,i.totalCalculatedSize=this.#y)}}#k=e=>{};#R=(e,r,n)=>{};#C=(e,r,n,i)=>{if(n||i)throw new TypeError("cannot set size without setting maxSize or maxEntrySize on cache");return 0};*#w({allowStale:e=this.allowStale}={}){if(this.#n)for(let r=this.#o;!(!this.#j(r)||((e||!this.#h(r))&&(yield r),r===this.#a));)r=this.#f[r]}*#_({allowStale:e=this.allowStale}={}){if(this.#n)for(let r=this.#a;!(!this.#j(r)||((e||!this.#h(r))&&(yield r),r===this.#o));)r=this.#d[r]}#j(e){return e!==void 0&&this.#i.get(this.#r[e])===e}*entries(){for(let e of this.#w())this.#e[e]!==void 0&&this.#r[e]!==void 0&&!this.#t(this.#e[e])&&(yield[this.#r[e],this.#e[e]])}*rentries(){for(let e of this.#_())this.#e[e]!==void 0&&this.#r[e]!==void 0&&!this.#t(this.#e[e])&&(yield[this.#r[e],this.#e[e]])}*keys(){for(let e of this.#w()){let r=this.#r[e];r!==void 0&&!this.#t(this.#e[e])&&(yield r)}}*rkeys(){for(let e of this.#_()){let r=this.#r[e];r!==void 0&&!this.#t(this.#e[e])&&(yield r)}}*values(){for(let e of this.#w())this.#e[e]!==void 0&&!this.#t(this.#e[e])&&(yield this.#e[e])}*rvalues(){for(let e of this.#_())this.#e[e]!==void 0&&!this.#t(this.#e[e])&&(yield this.#e[e])}[Symbol.iterator](){return this.entries()}find(e,r={}){for(let n of this.#w()){let i=this.#e[n],o=this.#t(i)?i.__staleWhileFetching:i;if(o!==void 0&&e(o,this.#r[n],this))return this.get(this.#r[n],r)}}forEach(e,r=this){for(let n of this.#w()){let i=this.#e[n],o=this.#t(i)?i.__staleWhileFetching:i;o!==void 0&&e.call(r,o,this.#r[n],this)}}rforEach(e,r=this){for(let n of this.#_()){let i=this.#e[n],o=this.#t(i)?i.__staleWhileFetching:i;o!==void 0&&e.call(r,o,this.#r[n],this)}}purgeStale(){let e=!1;for(let r of this.#_({allowStale:!0}))this.#h(r)&&(this.delete(this.#r[r]),e=!0);return e}dump(){let e=[];for(let r of this.#w({allowStale:!0})){let n=this.#r[r],i=this.#e[r],o=this.#t(i)?i.__staleWhileFetching:i;if(o===void 0||n===void 0)continue;let s={value:o};if(this.#g&&this.#E){s.ttl=this.#g[r];let a=kx.now()-this.#E[r];s.start=Math.floor(Date.now()-a)}this.#x&&(s.size=this.#x[r]),e.unshift([n,s])}return e}load(e){this.clear();for(let[r,n]of e){if(n.start){let i=Date.now()-n.start;n.start=kx.now()-i}this.set(r,n.value,n)}}set(e,r,n={}){if(r===void 0)return this.delete(e),this;let{ttl:i=this.ttl,start:o,noDisposeOnSet:s=this.noDisposeOnSet,sizeCalculation:a=this.sizeCalculation,status:d}=n,{noUpdateTTL:u=this.noUpdateTTL}=n,c=this.#C(e,r,n.size||0,a);if(this.maxEntrySize&&c>this.maxEntrySize)return d&&(d.set="miss",d.maxEntrySizeExceeded=!0),this.delete(e),this;let l=this.#n===0?void 0:this.#i.get(e);if(l===void 0)l=this.#n===0?this.#o:this.#m.length!==0?this.#m.pop():this.#n===this.#c?this.#B(!1):this.#n,this.#r[l]=e,this.#e[l]=r,this.#i.set(e,l),this.#d[this.#o]=l,this.#f[l]=this.#o,this.#o=l,this.#n++,this.#R(l,c,d),d&&(d.set="add"),u=!1;else{this.#P(l);let h=this.#e[l];if(r!==h){if(this.#T&&this.#t(h)?h.__abortController.abort(new Error("replaced")):s||(this.#b&&this.#v?.(h,e,"set"),this.#u&&this.#s?.push([h,e,"set"])),this.#k(l),this.#R(l,c,d),this.#e[l]=r,d){d.set="replace";let y=h&&this.#t(h)?h.__staleWhileFetching:h;y!==void 0&&(d.oldValue=y)}}else d&&(d.set="update")}if(i!==0&&!this.#g&&this.#M(),this.#g&&(u||this.#D(l,i,o),d&&this.#S(d,l)),!s&&this.#u&&this.#s){let h=this.#s,y;for(;y=h?.shift();)this.#p?.(...y)}return this}pop(){try{for(;this.#n;){let e=this.#e[this.#a];if(this.#B(!0),this.#t(e)){if(e.__staleWhileFetching)return e.__staleWhileFetching}else if(e!==void 0)return e}}finally{if(this.#u&&this.#s){let e=this.#s,r;for(;r=e?.shift();)this.#p?.(...r)}}}#B(e){let r=this.#a,n=this.#r[r],i=this.#e[r];return this.#T&&this.#t(i)?i.__abortController.abort(new Error("evicted")):(this.#b||this.#u)&&(this.#b&&this.#v?.(i,n,"evict"),this.#u&&this.#s?.push([i,n,"evict"])),this.#k(r),e&&(this.#r[r]=void 0,this.#e[r]=void 0,this.#m.push(r)),this.#n===1?(this.#a=this.#o=0,this.#m.length=0):this.#a=this.#d[r],this.#i.delete(n),this.#n--,r}has(e,r={}){let{updateAgeOnHas:n=this.updateAgeOnHas,status:i}=r,o=this.#i.get(e);if(o!==void 0){let s=this.#e[o];if(this.#t(s)&&s.__staleWhileFetching===void 0)return!1;if(this.#h(o))i&&(i.has="stale",this.#S(i,o));else return n&&this.#A(o),i&&(i.has="hit",this.#S(i,o)),!0}else i&&(i.has="miss");return!1}peek(e,r={}){let{allowStale:n=this.allowStale}=r,i=this.#i.get(e);if(i!==void 0&&(n||!this.#h(i))){let o=this.#e[i];return this.#t(o)?o.__staleWhileFetching:o}}#O(e,r,n,i){let o=r===void 0?void 0:this.#e[r];if(this.#t(o))return o;let s=new B8,{signal:a}=n;a?.addEventListener("abort",()=>s.abort(a.reason),{signal:s.signal});let d={signal:s.signal,options:n,context:i},u=(v,x=!1)=>{let{aborted:S}=s.signal,A=n.ignoreFetchAbort&&v!==void 0;if(n.status&&(S&&!x?(n.status.fetchAborted=!0,n.status.fetchError=s.signal.reason,A&&(n.status.fetchAbortIgnored=!0)):n.status.fetchResolved=!0),S&&!A&&!x)return l(s.signal.reason);let T=y;return this.#e[r]===y&&(v===void 0?T.__staleWhileFetching?this.#e[r]=T.__staleWhileFetching:this.delete(e):(n.status&&(n.status.fetchUpdated=!0),this.set(e,v,d.options))),v},c=v=>(n.status&&(n.status.fetchRejected=!0,n.status.fetchError=v),l(v)),l=v=>{let{aborted:x}=s.signal,S=x&&n.allowStaleOnFetchAbort,A=S||n.allowStaleOnFetchRejection,T=A||n.noDeleteOnFetchRejection,$=y;if(this.#e[r]===y&&(!T||$.__staleWhileFetching===void 0?this.delete(e):S||(this.#e[r]=$.__staleWhileFetching)),A)return n.status&&$.__staleWhileFetching!==void 0&&(n.status.returnedStale=!0),$.__staleWhileFetching;if($.__returned===$)throw v},h=(v,x)=>{let S=this.#I?.(e,o,d);S&&S instanceof Promise&&S.then(A=>v(A),x),s.signal.addEventListener("abort",()=>{(!n.ignoreFetchAbort||n.allowStaleOnFetchAbort)&&(v(),n.allowStaleOnFetchAbort&&(v=A=>u(A,!0)))})};n.status&&(n.status.fetchDispatched=!0);let y=new Promise(h).then(u,c),g=Object.assign(y,{__abortController:s,__staleWhileFetching:o,__returned:void 0});return r===void 0?(this.set(e,g,{...d.options,status:void 0}),r=this.#i.get(e)):this.#e[r]=g,g}#t(e){if(!this.#T)return!1;let r=e;return!!r&&r instanceof Promise&&r.hasOwnProperty("__staleWhileFetching")&&r.__abortController instanceof B8}async fetch(e,r={}){let{allowStale:n=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,ttl:s=this.ttl,noDisposeOnSet:a=this.noDisposeOnSet,size:d=0,sizeCalculation:u=this.sizeCalculation,noUpdateTTL:c=this.noUpdateTTL,noDeleteOnFetchRejection:l=this.noDeleteOnFetchRejection,allowStaleOnFetchRejection:h=this.allowStaleOnFetchRejection,ignoreFetchAbort:y=this.ignoreFetchAbort,allowStaleOnFetchAbort:g=this.allowStaleOnFetchAbort,context:v,forceRefresh:x=!1,status:S,signal:A}=r;if(!this.#T)return S&&(S.fetch="get"),this.get(e,{allowStale:n,updateAgeOnGet:i,noDeleteOnStaleGet:o,status:S});let T={allowStale:n,updateAgeOnGet:i,noDeleteOnStaleGet:o,ttl:s,noDisposeOnSet:a,size:d,sizeCalculation:u,noUpdateTTL:c,noDeleteOnFetchRejection:l,allowStaleOnFetchRejection:h,allowStaleOnFetchAbort:g,ignoreFetchAbort:y,status:S,signal:A},$=this.#i.get(e);if($===void 0){S&&(S.fetch="miss");let j=this.#O(e,$,T,v);return j.__returned=j}else{let j=this.#e[$];if(this.#t(j)){let q=n&&j.__staleWhileFetching!==void 0;return S&&(S.fetch="inflight",q&&(S.returnedStale=!0)),q?j.__staleWhileFetching:j.__returned=j}let K=this.#h($);if(!x&&!K)return S&&(S.fetch="hit"),this.#P($),i&&this.#A($),S&&this.#S(S,$),j;let F=this.#O(e,$,T,v),V=F.__staleWhileFetching!==void 0&&n;return S&&(S.fetch=K?"stale":"refresh",V&&K&&(S.returnedStale=!0)),V?F.__staleWhileFetching:F.__returned=F}}get(e,r={}){let{allowStale:n=this.allowStale,updateAgeOnGet:i=this.updateAgeOnGet,noDeleteOnStaleGet:o=this.noDeleteOnStaleGet,status:s}=r,a=this.#i.get(e);if(a!==void 0){let d=this.#e[a],u=this.#t(d);return s&&this.#S(s,a),this.#h(a)?(s&&(s.get="stale"),u?(s&&n&&d.__staleWhileFetching!==void 0&&(s.returnedStale=!0),n?d.__staleWhileFetching:void 0):(o||this.delete(e),s&&n&&(s.returnedStale=!0),n?d:void 0)):(s&&(s.get="hit"),u?d.__staleWhileFetching:(this.#P(a),i&&this.#A(a),d))}else s&&(s.get="miss")}#$(e,r){this.#f[r]=e,this.#d[e]=r}#P(e){e!==this.#o&&(e===this.#a?this.#a=this.#d[e]:this.#$(this.#f[e],this.#d[e]),this.#$(this.#o,e),this.#o=e)}delete(e){let r=!1;if(this.#n!==0){let n=this.#i.get(e);if(n!==void 0)if(r=!0,this.#n===1)this.clear();else{this.#k(n);let i=this.#e[n];this.#t(i)?i.__abortController.abort(new Error("deleted")):(this.#b||this.#u)&&(this.#b&&this.#v?.(i,e,"delete"),this.#u&&this.#s?.push([i,e,"delete"])),this.#i.delete(e),this.#r[n]=void 0,this.#e[n]=void 0,n===this.#o?this.#o=this.#f[n]:n===this.#a?this.#a=this.#d[n]:(this.#d[this.#f[n]]=this.#d[n],this.#f[this.#d[n]]=this.#f[n]),this.#n--,this.#m.push(n)}}if(this.#u&&this.#s?.length){let n=this.#s,i;for(;i=n?.shift();)this.#p?.(...i)}return r}clear(){for(let e of this.#_({allowStale:!0})){let r=this.#e[e];if(this.#t(r))r.__abortController.abort(new Error("deleted"));else{let n=this.#r[e];this.#b&&this.#v?.(r,n,"delete"),this.#u&&this.#s?.push([r,n,"delete"])}}if(this.#i.clear(),this.#e.fill(void 0),this.#r.fill(void 0),this.#g&&this.#E&&(this.#g.fill(0),this.#E.fill(0)),this.#x&&this.#x.fill(0),this.#a=0,this.#o=0,this.#m.length=0,this.#y=0,this.#n=0,this.#u&&this.#s){let e=this.#s,r;for(;r=e?.shift();)this.#p?.(...r)}}};var KW=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},M8=class{constructor(e){this.timeToLiveInSeconds=e,this.cache=new O8({max:1e5,ttl:e*1e3})}set(e,r){return KW(this,void 0,void 0,function*(){try{this.cache.set(e,r)}catch{}})}get(e){return KW(this,void 0,void 0,function*(){return this.cache.get(e)})}};f();var SO={};Or(SO,{Authorization:()=>m6e,AuthorizationDelegatedGrant:()=>g6e,AuthorizationOwner:()=>w6e,Definitions:()=>k6e,GeneralJwk:()=>P6e,GeneralJws:()=>I6e,GenericSignaturePayload:()=>X6e,JwkVerificationMethod:()=>R6e,MessagesFilter:()=>O6e,MessagesQuery:()=>M6e,MessagesRead:()=>D6e,MessagesSubscribe:()=>C6e,NumberRangeFilter:()=>j6e,PaginationCursor:()=>$6e,PermissionGrantData:()=>N6e,PermissionRequestData:()=>U6e,PermissionRevocationData:()=>K6e,PermissionsDefinitions:()=>q6e,PermissionsScopes:()=>L6e,ProtocolDefinition:()=>F6e,ProtocolRuleSet:()=>H6e,ProtocolsConfigure:()=>W6e,ProtocolsQuery:()=>G6e,PublicJwk:()=>Z6e,RecordsDelete:()=>_6e,RecordsFilter:()=>Y6e,RecordsQuery:()=>x6e,RecordsRead:()=>J6e,RecordsSubscribe:()=>E6e,RecordsWrite:()=>S6e,RecordsWriteDataEncoded:()=>T6e,RecordsWriteSignaturePayload:()=>Q6e,RecordsWriteUnidentified:()=>A6e,StringRangeFilter:()=>eSe});f();var m6e=Mi;var sg=new RegExp("^[A-Za-z0-9_-]+$","u");function un(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=un.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let h=a;for(let y in t)if(!(y==="payload"||y==="signatures")){return un.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:y},message:"must NOT have additional properties"}],!1;break}if(h===a){if(t.payload!==void 0){let y=t.payload,g=a;if(a===a)if(typeof y=="string"){if(!sg.test(y))return un.errors=[{instancePath:e+"/payload",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return un.errors=[{instancePath:e+"/payload",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=g===a}else var u=!0;if(u)if(t.signatures!==void 0){let y=t.signatures,g=a;if(a===g)if(Array.isArray(y)){if(y.length<1)return un.errors=[{instancePath:e+"/signatures",schemaPath:"#/properties/signatures/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var c=!0;let x=y.length;for(let S=0;S<x;S++){let A=y[S],T=a;if(a===T)if(A&&typeof A=="object"&&!Array.isArray(A)){if(A.protected!==void 0){let j=A.protected,K=a;if(a===a)if(typeof j=="string"){if(!sg.test(j))return un.errors=[{instancePath:e+"/signatures/"+S+"/protected",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return un.errors=[{instancePath:e+"/signatures/"+S+"/protected",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=K===a}else var l=!0;if(l)if(A.signature!==void 0){let j=A.signature,K=a;if(a===a)if(typeof j=="string"){if(!sg.test(j))return un.errors=[{instancePath:e+"/signatures/"+S+"/signature",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return un.errors=[{instancePath:e+"/signatures/"+S+"/signature",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=K===a}else var l=!0}else return un.errors=[{instancePath:e+"/signatures/"+S,schemaPath:"#/properties/signatures/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var c=T===a;if(!c)break}}}else return un.errors=[{instancePath:e+"/signatures",schemaPath:"#/properties/signatures/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var u=g===a}else var u=!0}}else return un.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return un.errors=s,a===0}un.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};function Mi(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Mi.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let u=a;for(let c in t)if(c!=="signature"){return Mi.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties"}],!1;break}u===a&&t.signature!==void 0&&(un(t.signature,{instancePath:e+"/signature",parentData:t,parentDataProperty:"signature",rootData:i,dynamicAnchors:o})||(s=s===null?un.errors:s.concat(un.errors),a=s.length))}else return Mi.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Mi.errors=s,a===0}Mi.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var g6e=Po;var wy={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-write-unidentified.json",type:"object",required:["descriptor"],properties:{recordId:{type:"string"},contextId:{type:"string",pattern:"^[a-zA-Z0-9]+(/[a-zA-Z0-9]+)*$"},attestation:{$ref:"https://identity.foundation/dwn/json-schemas/general-jws.json"},authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-owner.json"},encryption:{type:"object",properties:{algorithm:{type:"string",enum:["A256CTR"]},initializationVector:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url"},keyEncryption:{type:"array",minItems:1,items:{type:"object",properties:{rootKeyId:{type:"string"},derivationScheme:{type:"string",enum:["dataFormats","protocolContext","protocolPath","schemas"]},derivedPublicKey:{$ref:"https://identity.foundation/dwn/json-schemas/public-jwk.json"},algorithm:{type:"string",enum:["ECIES-ES256K"]},encryptedKey:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url"},initializationVector:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url"},ephemeralPublicKey:{$ref:"https://identity.foundation/dwn/json-schemas/public-jwk.json"},messageAuthenticationCode:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url"}},additionalProperties:!1,required:["rootKeyId","derivationScheme","algorithm","encryptedKey","initializationVector","ephemeralPublicKey","messageAuthenticationCode"]}}},additionalProperties:!1,required:["algorithm","initializationVector","keyEncryption"]},descriptor:{type:"object",properties:{interface:{enum:["Records"],type:"string"},method:{enum:["Write"],type:"string"},recipient:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"},protocol:{type:"string"},protocolPath:{type:"string",pattern:"^[a-zA-Z]+(/[a-zA-Z]+)*$"},schema:{type:"string"},tags:{type:"object",minProperties:1,maxProperties:10,additionalProperties:{oneOf:[{type:"string"},{type:"number"},{type:"boolean"},{type:"array",minItems:1,maxItems:10,items:{type:"string"}},{type:"array",minItems:1,maxItems:10,items:{type:"number"}}]}},parentId:{type:"string"},dataCid:{type:"string"},dataSize:{type:"number"},dateCreated:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},published:{type:"boolean"},datePublished:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},dataFormat:{type:"string"}},additionalProperties:!1,required:["interface","method","dataCid","dataSize","dateCreated","messageTimestamp","dataFormat"],dependencies:{parentId:["protocol"]},allOf:[{$comment:"rule defining `published` and `datePublished` relationship",anyOf:[{properties:{published:{type:"boolean",enum:[!0]}},required:["published","datePublished"]},{properties:{published:{type:"boolean",enum:[!1]}},not:{required:["datePublished"]}},{allOf:[{not:{required:["published"]}},{not:{required:["datePublished"]}}]}]}]}},$comment:"rule defining `protocol` and `contextId` relationship",anyOf:[{properties:{descriptor:{type:"object",required:["protocol","protocolPath"]}},required:["contextId"]},{allOf:[{not:{required:["contextId"]}},{properties:{descriptor:{type:"object",not:{required:["protocol"]}}}},{properties:{descriptor:{type:"object",not:{required:["protocolPath"]}}}}]}]};var v6e=new RegExp("^[a-zA-Z0-9]+(/[a-zA-Z0-9]+)*$","u"),_y=new RegExp("^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$","u"),b6e=new RegExp("^[a-zA-Z]+(/[a-zA-Z]+)*$","u"),Ji=new RegExp("^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$","u");var Aw={validate:Ad};function Nl(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Nl.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let c=a;for(let l in t)if(!(l==="signature"||l==="authorDelegatedGrant"||l==="ownerSignature"||l==="ownerDelegatedGrant")){return Nl.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties"}],!1;break}if(c===a){let l;if(t.ownerSignature!==void 0&&t.signature===void 0&&(l="signature"))return Nl.errors=[{instancePath:e,schemaPath:"#/dependencies",keyword:"dependencies",params:{property:"ownerSignature",missingProperty:l,depsCount:1,deps:"signature"},message:"must have property signature when property ownerSignature is present"}],!1;if(t.signature!==void 0){let h=a;un(t.signature,{instancePath:e+"/signature",parentData:t,parentDataProperty:"signature",rootData:i,dynamicAnchors:o})||(s=s===null?un.errors:s.concat(un.errors),a=s.length);var u=h===a}else var u=!0;if(u){if(t.authorDelegatedGrant!==void 0){let h=a;Aw.validate(t.authorDelegatedGrant,{instancePath:e+"/authorDelegatedGrant",parentData:t,parentDataProperty:"authorDelegatedGrant",rootData:i,dynamicAnchors:o})||(s=s===null?Aw.validate.errors:s.concat(Aw.validate.errors),a=s.length);var u=h===a}else var u=!0;if(u){if(t.ownerSignature!==void 0){let h=a;un(t.ownerSignature,{instancePath:e+"/ownerSignature",parentData:t,parentDataProperty:"ownerSignature",rootData:i,dynamicAnchors:o})||(s=s===null?un.errors:s.concat(un.errors),a=s.length);var u=h===a}else var u=!0;if(u)if(t.ownerDelegatedGrant!==void 0){let h=a;Aw.validate(t.ownerDelegatedGrant,{instancePath:e+"/ownerDelegatedGrant",parentData:t,parentDataProperty:"ownerDelegatedGrant",rootData:i,dynamicAnchors:o})||(s=s===null?Aw.validate.errors:s.concat(Aw.validate.errors),a=s.length);var u=h===a}else var u=!0}}}}else return Nl.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Nl.errors=s,a===0}Nl.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var eG={$id:"https://identity.foundation/dwn/json-schemas/general-jwk.json",$schema:"https://json-schema.org/draft/2020-12/schema",type:"object",required:["kty"],properties:{alg:{type:"string"},kid:{type:"string"},kty:{enum:["EC","RSA","oct","OKP"]},crv:{type:"string"},use:{type:"string"},key_ops:{type:"string"},x5u:{type:"string"},x5c:{type:"string"},x5t:{type:"string"},"x5t#S256":{type:"string"}},oneOf:[{properties:{kty:{const:"EC"},crv:{type:"string"},x:{type:"string"},y:{type:"string"},d:{type:"string"}},required:["crv","x"]},{properties:{kty:{const:"OKP"},crv:{type:"string"},x:{type:"string"},d:{type:"string"}},required:["crv","x"]},{properties:{kty:{const:"RSA"},n:{type:"string"},e:{type:"string"},d:{type:"string"},p:{type:"string"},q:{type:"string"},dp:{type:"string"},dq:{type:"string"},qi:{type:"string"},oth:{type:"object"}},required:["n","e"]},{properties:{kty:{const:"oct"},k:{type:"string"}},required:["k"]}]};function dn(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=dn.evaluated;d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0);let u=a,c=a,l=!1,h=null,y=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let p;if(t.crv===void 0&&(p="crv")||t.x===void 0&&(p="x")){let m={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"};s===null?s=[m]:s.push(m),a++}else{if(t.kty!==void 0){let m=a;if(t.kty!=="EC"){let w={instancePath:e+"/kty",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/properties/kty/const",keyword:"const",params:{allowedValue:"EC"},message:"must be equal to constant"};s===null?s=[w]:s.push(w),a++}var g=m===a}else var g=!0;if(g){if(t.crv!==void 0){let m=a;if(typeof t.crv!="string"){let E={instancePath:e+"/crv",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[E]:s.push(E),a++}var g=m===a}else var g=!0;if(g){if(t.x!==void 0){let m=a;if(typeof t.x!="string"){let E={instancePath:e+"/x",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/properties/x/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[E]:s.push(E),a++}var g=m===a}else var g=!0;if(g){if(t.y!==void 0){let m=a;if(typeof t.y!="string"){let E={instancePath:e+"/y",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/properties/y/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[E]:s.push(E),a++}var g=m===a}else var g=!0;if(g)if(t.d!==void 0){let m=a;if(typeof t.d!="string"){let E={instancePath:e+"/d",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/0/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[E]:s.push(E),a++}var g=m===a}else var g=!0}}}}}var A=y===a;if(A){l=!0,h=0;var v={};v.kty=!0,v.crv=!0,v.x=!0,v.y=!0,v.d=!0}let x=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let p;if(t.crv===void 0&&(p="crv")||t.x===void 0&&(p="x")){let m={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/1/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"};s===null?s=[m]:s.push(m),a++}else{if(t.kty!==void 0){let m=a;if(t.kty!=="OKP"){let w={instancePath:e+"/kty",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/1/properties/kty/const",keyword:"const",params:{allowedValue:"OKP"},message:"must be equal to constant"};s===null?s=[w]:s.push(w),a++}var S=m===a}else var S=!0;if(S){if(t.crv!==void 0){let m=a;if(typeof t.crv!="string"){let E={instancePath:e+"/crv",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/1/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[E]:s.push(E),a++}var S=m===a}else var S=!0;if(S){if(t.x!==void 0){let m=a;if(typeof t.x!="string"){let E={instancePath:e+"/x",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/1/properties/x/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[E]:s.push(E),a++}var S=m===a}else var S=!0;if(S)if(t.d!==void 0){let m=a;if(typeof t.d!="string"){let E={instancePath:e+"/d",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/1/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[E]:s.push(E),a++}var S=m===a}else var S=!0}}}}var A=x===a;if(A&&l)l=!1,h=[h,1];else{A&&(l=!0,h=1,v!==!0&&(v=v||{},v.kty=!0,v.crv=!0,v.x=!0,v.d=!0));let p=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let w;if(t.n===void 0&&(w="n")||t.e===void 0&&(w="e")){let E={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/required",keyword:"required",params:{missingProperty:w},message:"must have required property '"+w+"'"};s===null?s=[E]:s.push(E),a++}else{if(t.kty!==void 0){let E=a;if(t.kty!=="RSA"){let _={instancePath:e+"/kty",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/kty/const",keyword:"const",params:{allowedValue:"RSA"},message:"must be equal to constant"};s===null?s=[_]:s.push(_),a++}var T=E===a}else var T=!0;if(T){if(t.n!==void 0){let E=a;if(typeof t.n!="string"){let b={instancePath:e+"/n",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/n/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[b]:s.push(b),a++}var T=E===a}else var T=!0;if(T){if(t.e!==void 0){let E=a;if(typeof t.e!="string"){let b={instancePath:e+"/e",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/e/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[b]:s.push(b),a++}var T=E===a}else var T=!0;if(T){if(t.d!==void 0){let E=a;if(typeof t.d!="string"){let b={instancePath:e+"/d",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[b]:s.push(b),a++}var T=E===a}else var T=!0;if(T){if(t.p!==void 0){let E=a;if(typeof t.p!="string"){let b={instancePath:e+"/p",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/p/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[b]:s.push(b),a++}var T=E===a}else var T=!0;if(T){if(t.q!==void 0){let E=a;if(typeof t.q!="string"){let b={instancePath:e+"/q",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/q/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[b]:s.push(b),a++}var T=E===a}else var T=!0;if(T){if(t.dp!==void 0){let E=a;if(typeof t.dp!="string"){let b={instancePath:e+"/dp",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/dp/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[b]:s.push(b),a++}var T=E===a}else var T=!0;if(T){if(t.dq!==void 0){let E=a;if(typeof t.dq!="string"){let b={instancePath:e+"/dq",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/dq/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[b]:s.push(b),a++}var T=E===a}else var T=!0;if(T){if(t.qi!==void 0){let E=a;if(typeof t.qi!="string"){let b={instancePath:e+"/qi",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/qi/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[b]:s.push(b),a++}var T=E===a}else var T=!0;if(T)if(t.oth!==void 0){let E=t.oth,_=a;if(!(E&&typeof E=="object"&&!Array.isArray(E))){let C={instancePath:e+"/oth",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/2/properties/oth/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[C]:s.push(C),a++}var T=_===a}else var T=!0}}}}}}}}}}var A=p===a;if(A&&l)l=!1,h=[h,2];else{A&&(l=!0,h=2,v!==!0&&(v=v||{},v.kty=!0,v.n=!0,v.e=!0,v.d=!0,v.p=!0,v.q=!0,v.dp=!0,v.dq=!0,v.qi=!0,v.oth=!0));let w=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let _;if(t.k===void 0&&(_="k")){let b={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/3/required",keyword:"required",params:{missingProperty:_},message:"must have required property '"+_+"'"};s===null?s=[b]:s.push(b),a++}else{if(t.kty!==void 0){let b=a;if(t.kty!=="oct"){let C={instancePath:e+"/kty",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/3/properties/kty/const",keyword:"const",params:{allowedValue:"oct"},message:"must be equal to constant"};s===null?s=[C]:s.push(C),a++}var $=b===a}else var $=!0;if($)if(t.k!==void 0){let b=a;if(typeof t.k!="string"){let N={instancePath:e+"/k",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf/3/properties/k/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[N]:s.push(N),a++}var $=b===a}else var $=!0}}var A=w===a;A&&l?(l=!1,h=[h,3]):A&&(l=!0,h=3,v!==!0&&(v=v||{},v.kty=!0,v.k=!0))}}if(l)a=c,s!==null&&(c?s.length=c:s=null);else{let p={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/oneOf",keyword:"oneOf",params:{passingSchemas:h},message:"must match exactly one schema in oneOf"};return s===null?s=[p]:s.push(p),a++,dn.errors=s,!1}if(a===u)if(t&&typeof t=="object"&&!Array.isArray(t)){let p;if(t.kty===void 0&&(p="kty"))return dn.errors=[{instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"}],!1;if(v!==!0&&(v=v||{},v.alg=!0,v.kid=!0,v.kty=!0,v.crv=!0,v.use=!0,v.key_ops=!0,v.x5u=!0,v.x5c=!0,v.x5t=!0,v["x5t#S256"]=!0),t.alg!==void 0){let m=a;if(typeof t.alg!="string")return dn.errors=[{instancePath:e+"/alg",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/alg/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var j=m===a}else var j=!0;if(j){if(t.kid!==void 0){let m=a;if(typeof t.kid!="string")return dn.errors=[{instancePath:e+"/kid",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/kid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var j=m===a}else var j=!0;if(j){if(t.kty!==void 0){let m=t.kty,w=a;if(!(m==="EC"||m==="RSA"||m==="oct"||m==="OKP"))return dn.errors=[{instancePath:e+"/kty",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/kty/enum",keyword:"enum",params:{allowedValues:eG.properties.kty.enum},message:"must be equal to one of the allowed values"}],!1;var j=w===a}else var j=!0;if(j){if(t.crv!==void 0){let m=a;if(typeof t.crv!="string")return dn.errors=[{instancePath:e+"/crv",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var j=m===a}else var j=!0;if(j){if(t.use!==void 0){let m=a;if(typeof t.use!="string")return dn.errors=[{instancePath:e+"/use",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/use/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var j=m===a}else var j=!0;if(j){if(t.key_ops!==void 0){let m=a;if(typeof t.key_ops!="string")return dn.errors=[{instancePath:e+"/key_ops",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/key_ops/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var j=m===a}else var j=!0;if(j){if(t.x5u!==void 0){let m=a;if(typeof t.x5u!="string")return dn.errors=[{instancePath:e+"/x5u",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/x5u/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var j=m===a}else var j=!0;if(j){if(t.x5c!==void 0){let m=a;if(typeof t.x5c!="string")return dn.errors=[{instancePath:e+"/x5c",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/x5c/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var j=m===a}else var j=!0;if(j){if(t.x5t!==void 0){let m=a;if(typeof t.x5t!="string")return dn.errors=[{instancePath:e+"/x5t",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/x5t/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var j=m===a}else var j=!0;if(j)if(t["x5t#S256"]!==void 0){let m=a;if(typeof t["x5t#S256"]!="string")return dn.errors=[{instancePath:e+"/x5t#S256",schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/properties/x5t%23S256/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var j=m===a}else var j=!0}}}}}}}}}else return dn.errors=[{instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/general-jwk.json/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var K=u===a;if(K){let p=a,m=a,w=a,E=!1,_=a,b=a,C=!1,N=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ie;if(t.d===void 0&&(ie="d")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var F=N===a;if(C=C||F,C)a=b,s!==null&&(b?s.length=b:s=null);else{let ie={};s===null?s=[ie]:s.push(ie),a++}if(a===_)if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.kty!==void 0&&t.kty!=="EC"){let ie={};s===null?s=[ie]:s.push(ie),a++}}else{let ie={};s===null?s=[ie]:s.push(ie),a++}var P=_===a;if(E=E||P,P){var L={};L.kty=!0}let D=a,U=a,G=!1,Y=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ie;if(t.d===void 0&&(ie="d")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var V=Y===a;if(G=G||V,G)a=U,s!==null&&(U?s.length=U:s=null);else{let ie={};s===null?s=[ie]:s.push(ie),a++}if(a===D)if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.kty!==void 0&&t.kty!=="OKP"){let ie={};s===null?s=[ie]:s.push(ie),a++}}else{let ie={};s===null?s=[ie]:s.push(ie),a++}var P=D===a;E=E||P,P&&L!==!0&&(L=L||{},L.kty=!0);let J=a,H=a,X=!1,te=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ie;if(t.d===void 0&&(ie="d")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var q=te===a;X=X||q;let ne=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ie;if(t.p===void 0&&(ie="p")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var q=ne===a;X=X||q;let Q=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ie;if(t.q===void 0&&(ie="q")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var q=Q===a;X=X||q;let re=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ie;if(t.dp===void 0&&(ie="dp")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var q=re===a;X=X||q;let ae=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ie;if(t.dq===void 0&&(ie="dq")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var q=ae===a;X=X||q;let he=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ie;if(t.qi===void 0&&(ie="qi")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var q=he===a;X=X||q;let ge=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ie;if(t.oth===void 0&&(ie="oth")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var q=ge===a;if(X=X||q,X)a=H,s!==null&&(H?s.length=H:s=null);else{let ie={};s===null?s=[ie]:s.push(ie),a++}if(a===J)if(t&&typeof t=="object"&&!Array.isArray(t)){if(t.kty!==void 0){let ie=a;if(t.kty!=="RSA"){let pe={};s===null?s=[pe]:s.push(pe),a++}var k=ie===a}else var k=!0;if(k)if(t.oth!==void 0){let ie=t.oth,pe=a;if(!(ie&&typeof ie=="object"&&!Array.isArray(ie))){let Ue={};s===null?s=[Ue]:s.push(Ue),a++}var k=pe===a}else var k=!0}else{let ie={};s===null?s=[ie]:s.push(ie),a++}var P=J===a;if(E=E||P,P&&L!==!0&&(L=L||{},L.kty=!0,L.d=!0,L.p=!0,L.q=!0,L.dp=!0,L.dq=!0,L.qi=!0,L.oth=!0),E)a=w,s!==null&&(w?s.length=w:s=null);else{let ie={};s===null?s=[ie]:s.push(ie),a++}var B=m===a;if(B)return dn.errors=[{instancePath:e,schemaPath:"#/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=p,s!==null&&(p?s.length=p:s=null)}return dn.errors=s,d.props=v,a===0}dn.evaluated={dynamicProps:!0,dynamicItems:!1};var tG=Object.prototype.hasOwnProperty;function ze(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=ze.evaluated;d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0);let u=a,c=!1,l=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let D;if(t.contextId===void 0&&(D="contextId")){let U={instancePath:e,schemaPath:"#/anyOf/0/required",keyword:"required",params:{missingProperty:D},message:"must have required property '"+D+"'"};s===null?s=[U]:s.push(U),a++}else if(t.descriptor!==void 0){let U=t.descriptor;if(a===a)if(U&&typeof U=="object"&&!Array.isArray(U)){let Y;if(U.protocol===void 0&&(Y="protocol")||U.protocolPath===void 0&&(Y="protocolPath")){let J={instancePath:e+"/descriptor",schemaPath:"#/anyOf/0/properties/descriptor/required",keyword:"required",params:{missingProperty:Y},message:"must have required property '"+Y+"'"};s===null?s=[J]:s.push(J),a++}}else{let Y={instancePath:e+"/descriptor",schemaPath:"#/anyOf/0/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[Y]:s.push(Y),a++}}}var j=l===a;if(c=c||j,j){var h={};h.descriptor=!0}let y=a,g=a,v=a,x=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let D;if(t.contextId===void 0&&(D="contextId")){let U={};s===null?s=[U]:s.push(U),a++}}var S=x===a;if(S){let D={instancePath:e,schemaPath:"#/anyOf/1/allOf/0/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[D]:s.push(D),a++}else a=v,s!==null&&(v?s.length=v:s=null);var A=g===a;if(A){let D=a;if(t&&typeof t=="object"&&!Array.isArray(t)&&t.descriptor!==void 0){let G=t.descriptor;if(!(G&&typeof G=="object"&&!Array.isArray(G))){let H={instancePath:e+"/descriptor",schemaPath:"#/anyOf/1/allOf/1/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[H]:s.push(H),a++}let Y=a,J=a;if(G&&typeof G=="object"&&!Array.isArray(G)){let H;if(G.protocol===void 0&&(H="protocol")){let X={};s===null?s=[X]:s.push(X),a++}}var T=J===a;if(T){let H={instancePath:e+"/descriptor",schemaPath:"#/anyOf/1/allOf/1/properties/descriptor/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[H]:s.push(H),a++}else a=Y,s!==null&&(Y?s.length=Y:s=null)}var A=D===a;if(A){let G=a;if(t&&typeof t=="object"&&!Array.isArray(t)&&t.descriptor!==void 0){let J=t.descriptor;if(!(J&&typeof J=="object"&&!Array.isArray(J))){let te={instancePath:e+"/descriptor",schemaPath:"#/anyOf/1/allOf/2/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[te]:s.push(te),a++}let H=a,X=a;if(J&&typeof J=="object"&&!Array.isArray(J)){let te;if(J.protocolPath===void 0&&(te="protocolPath")){let ne={};s===null?s=[ne]:s.push(ne),a++}}var $=X===a;if($){let te={instancePath:e+"/descriptor",schemaPath:"#/anyOf/1/allOf/2/properties/descriptor/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[te]:s.push(te),a++}else a=H,s!==null&&(H?s.length=H:s=null)}var A=G===a}}var j=y===a;if(c=c||j,j&&h!==!0&&(h=h||{},h.descriptor=!0),c)a=u,s!==null&&(u?s.length=u:s=null);else{let D={instancePath:e,schemaPath:"#/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return s===null?s=[D]:s.push(D),a++,ze.errors=s,!1}if(a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let D;if(t.descriptor===void 0&&(D="descriptor"))return ze.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:D},message:"must have required property '"+D+"'"}],!1;if(h!==!0&&(h=h||{},h.recordId=!0,h.contextId=!0,h.attestation=!0,h.authorization=!0,h.encryption=!0,h.descriptor=!0),t.recordId!==void 0){let U=a;if(typeof t.recordId!="string")return ze.errors=[{instancePath:e+"/recordId",schemaPath:"#/properties/recordId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var K=U===a}else var K=!0;if(K){if(t.contextId!==void 0){let U=t.contextId,G=a;if(a===G)if(typeof U=="string"){if(!v6e.test(U))return ze.errors=[{instancePath:e+"/contextId",schemaPath:"#/properties/contextId/pattern",keyword:"pattern",params:{pattern:"^[a-zA-Z0-9]+(/[a-zA-Z0-9]+)*$"},message:'must match pattern "^[a-zA-Z0-9]+(/[a-zA-Z0-9]+)*$"'}],!1}else return ze.errors=[{instancePath:e+"/contextId",schemaPath:"#/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var K=G===a}else var K=!0;if(K){if(t.attestation!==void 0){let U=a;un(t.attestation,{instancePath:e+"/attestation",parentData:t,parentDataProperty:"attestation",rootData:i,dynamicAnchors:o})||(s=s===null?un.errors:s.concat(un.errors),a=s.length);var K=U===a}else var K=!0;if(K){if(t.authorization!==void 0){let U=a;Nl(t.authorization,{instancePath:e+"/authorization",parentData:t,parentDataProperty:"authorization",rootData:i,dynamicAnchors:o})||(s=s===null?Nl.errors:s.concat(Nl.errors),a=s.length);var K=U===a}else var K=!0;if(K){if(t.encryption!==void 0){let U=t.encryption,G=a;if(a===G)if(U&&typeof U=="object"&&!Array.isArray(U)){let J;if(U.algorithm===void 0&&(J="algorithm")||U.initializationVector===void 0&&(J="initializationVector")||U.keyEncryption===void 0&&(J="keyEncryption"))return ze.errors=[{instancePath:e+"/encryption",schemaPath:"#/properties/encryption/required",keyword:"required",params:{missingProperty:J},message:"must have required property '"+J+"'"}],!1;{let H=a;for(let X in U)if(!(X==="algorithm"||X==="initializationVector"||X==="keyEncryption")){return ze.errors=[{instancePath:e+"/encryption",schemaPath:"#/properties/encryption/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:X},message:"must NOT have additional properties"}],!1;break}if(H===a){if(U.algorithm!==void 0){let X=U.algorithm,te=a;if(typeof X!="string")return ze.errors=[{instancePath:e+"/encryption/algorithm",schemaPath:"#/properties/encryption/properties/algorithm/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(X!=="A256CTR")return ze.errors=[{instancePath:e+"/encryption/algorithm",schemaPath:"#/properties/encryption/properties/algorithm/enum",keyword:"enum",params:{allowedValues:wy.properties.encryption.properties.algorithm.enum},message:"must be equal to one of the allowed values"}],!1;var F=te===a}else var F=!0;if(F){if(U.initializationVector!==void 0){let X=U.initializationVector,te=a;if(a===a)if(typeof X=="string"){if(!sg.test(X))return ze.errors=[{instancePath:e+"/encryption/initializationVector",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return ze.errors=[{instancePath:e+"/encryption/initializationVector",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var F=te===a}else var F=!0;if(F)if(U.keyEncryption!==void 0){let X=U.keyEncryption,te=a;if(a===te)if(Array.isArray(X)){if(X.length<1)return ze.errors=[{instancePath:e+"/encryption/keyEncryption",schemaPath:"#/properties/encryption/properties/keyEncryption/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var L=!0;let Q=X.length;for(let re=0;re<Q;re++){let ae=X[re],he=a;if(a===he)if(ae&&typeof ae=="object"&&!Array.isArray(ae)){let ie;if(ae.rootKeyId===void 0&&(ie="rootKeyId")||ae.derivationScheme===void 0&&(ie="derivationScheme")||ae.algorithm===void 0&&(ie="algorithm")||ae.encryptedKey===void 0&&(ie="encryptedKey")||ae.initializationVector===void 0&&(ie="initializationVector")||ae.ephemeralPublicKey===void 0&&(ie="ephemeralPublicKey")||ae.messageAuthenticationCode===void 0&&(ie="messageAuthenticationCode"))return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re,schemaPath:"#/properties/encryption/properties/keyEncryption/items/required",keyword:"required",params:{missingProperty:ie},message:"must have required property '"+ie+"'"}],!1;{let pe=a;for(let be in ae)if(!(be==="rootKeyId"||be==="derivationScheme"||be==="derivedPublicKey"||be==="algorithm"||be==="encryptedKey"||be==="initializationVector"||be==="ephemeralPublicKey"||be==="messageAuthenticationCode")){return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re,schemaPath:"#/properties/encryption/properties/keyEncryption/items/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:be},message:"must NOT have additional properties"}],!1;break}if(pe===a){if(ae.rootKeyId!==void 0){let be=a;if(typeof ae.rootKeyId!="string")return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/rootKeyId",schemaPath:"#/properties/encryption/properties/keyEncryption/items/properties/rootKeyId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var V=be===a}else var V=!0;if(V){if(ae.derivationScheme!==void 0){let be=ae.derivationScheme,Ue=a;if(typeof be!="string")return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/derivationScheme",schemaPath:"#/properties/encryption/properties/keyEncryption/items/properties/derivationScheme/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(be==="dataFormats"||be==="protocolContext"||be==="protocolPath"||be==="schemas"))return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/derivationScheme",schemaPath:"#/properties/encryption/properties/keyEncryption/items/properties/derivationScheme/enum",keyword:"enum",params:{allowedValues:wy.properties.encryption.properties.keyEncryption.items.properties.derivationScheme.enum},message:"must be equal to one of the allowed values"}],!1;var V=Ue===a}else var V=!0;if(V){if(ae.derivedPublicKey!==void 0){let be=a;dn(ae.derivedPublicKey,{instancePath:e+"/encryption/keyEncryption/"+re+"/derivedPublicKey",parentData:ae,parentDataProperty:"derivedPublicKey",rootData:i,dynamicAnchors:o})||(s=s===null?dn.errors:s.concat(dn.errors),a=s.length);var V=be===a}else var V=!0;if(V){if(ae.algorithm!==void 0){let be=ae.algorithm,Ue=a;if(typeof be!="string")return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/algorithm",schemaPath:"#/properties/encryption/properties/keyEncryption/items/properties/algorithm/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(be!=="ECIES-ES256K")return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/algorithm",schemaPath:"#/properties/encryption/properties/keyEncryption/items/properties/algorithm/enum",keyword:"enum",params:{allowedValues:wy.properties.encryption.properties.keyEncryption.items.properties.algorithm.enum},message:"must be equal to one of the allowed values"}],!1;var V=Ue===a}else var V=!0;if(V){if(ae.encryptedKey!==void 0){let be=ae.encryptedKey,Ue=a;if(a===a)if(typeof be=="string"){if(!sg.test(be))return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/encryptedKey",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/encryptedKey",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var V=Ue===a}else var V=!0;if(V){if(ae.initializationVector!==void 0){let be=ae.initializationVector,Ue=a;if(a===a)if(typeof be=="string"){if(!sg.test(be))return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/initializationVector",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/initializationVector",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var V=Ue===a}else var V=!0;if(V){if(ae.ephemeralPublicKey!==void 0){let be=a;dn(ae.ephemeralPublicKey,{instancePath:e+"/encryption/keyEncryption/"+re+"/ephemeralPublicKey",parentData:ae,parentDataProperty:"ephemeralPublicKey",rootData:i,dynamicAnchors:o})||(s=s===null?dn.errors:s.concat(dn.errors),a=s.length);var V=be===a}else var V=!0;if(V)if(ae.messageAuthenticationCode!==void 0){let be=ae.messageAuthenticationCode,Ue=a;if(a===a)if(typeof be=="string"){if(!sg.test(be))return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/messageAuthenticationCode",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/pattern",keyword:"pattern",params:{pattern:"^[A-Za-z0-9_-]+$"},message:'must match pattern "^[A-Za-z0-9_-]+$"'}],!1}else return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re+"/messageAuthenticationCode",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/base64url/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var V=Ue===a}else var V=!0}}}}}}}}}else return ze.errors=[{instancePath:e+"/encryption/keyEncryption/"+re,schemaPath:"#/properties/encryption/properties/keyEncryption/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var L=he===a;if(!L)break}}}else return ze.errors=[{instancePath:e+"/encryption/keyEncryption",schemaPath:"#/properties/encryption/properties/keyEncryption/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var F=te===a}else var F=!0}}}}else return ze.errors=[{instancePath:e+"/encryption",schemaPath:"#/properties/encryption/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var K=G===a}else var K=!0;if(K)if(t.descriptor!==void 0){let U=t.descriptor,G=a,Y=a,J=!1,H=a;if(U&&typeof U=="object"&&!Array.isArray(U)){let ie;if(U.published===void 0&&(ie="published")||U.datePublished===void 0&&(ie="datePublished")){let pe={instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/allOf/0/anyOf/0/required",keyword:"required",params:{missingProperty:ie},message:"must have required property '"+ie+"'"};s===null?s=[pe]:s.push(pe),a++}else if(U.published!==void 0){let pe=U.published;if(typeof pe!="boolean"){let be={instancePath:e+"/descriptor/published",schemaPath:"#/properties/descriptor/allOf/0/anyOf/0/properties/published/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};s===null?s=[be]:s.push(be),a++}if(pe!==!0){let be={instancePath:e+"/descriptor/published",schemaPath:"#/properties/descriptor/allOf/0/anyOf/0/properties/published/enum",keyword:"enum",params:{allowedValues:wy.properties.descriptor.allOf[0].anyOf[0].properties.published.enum},message:"must be equal to one of the allowed values"};s===null?s=[be]:s.push(be),a++}}}var m=H===a;if(J=J||m,m){var q={};q.published=!0}let X=a,te=a,ne=a;if(U&&typeof U=="object"&&!Array.isArray(U)){let ie;if(U.datePublished===void 0&&(ie="datePublished")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var k=ne===a;if(k){let ie={instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/allOf/0/anyOf/1/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[ie]:s.push(ie),a++}else a=te,s!==null&&(te?s.length=te:s=null);if(a===X&&U&&typeof U=="object"&&!Array.isArray(U)&&U.published!==void 0){let ie=U.published;if(typeof ie!="boolean"){let pe={instancePath:e+"/descriptor/published",schemaPath:"#/properties/descriptor/allOf/0/anyOf/1/properties/published/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};s===null?s=[pe]:s.push(pe),a++}if(ie!==!1){let pe={instancePath:e+"/descriptor/published",schemaPath:"#/properties/descriptor/allOf/0/anyOf/1/properties/published/enum",keyword:"enum",params:{allowedValues:wy.properties.descriptor.allOf[0].anyOf[1].properties.published.enum},message:"must be equal to one of the allowed values"};s===null?s=[pe]:s.push(pe),a++}}var m=X===a;J=J||m,m&&q!==!0&&(q=q||{},q.published=!0);let Q=a,re=a,ae=a,he=a;if(U&&typeof U=="object"&&!Array.isArray(U)){let ie;if(U.published===void 0&&(ie="published")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var P=he===a;if(P){let ie={instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/allOf/0/anyOf/2/allOf/0/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[ie]:s.push(ie),a++}else a=ae,s!==null&&(ae?s.length=ae:s=null);var B=re===a;if(B){let ie=a,pe=a,be=a;if(U&&typeof U=="object"&&!Array.isArray(U)){let ke;if(U.datePublished===void 0&&(ke="datePublished")){let it={};s===null?s=[it]:s.push(it),a++}}var p=be===a;if(p){let ke={instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/allOf/0/anyOf/2/allOf/1/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[ke]:s.push(ke),a++}else a=pe,s!==null&&(pe?s.length=pe:s=null);var B=ie===a}var m=Q===a;if(J=J||m,J)a=Y,s!==null&&(Y?s.length=Y:s=null);else{let ie={instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/allOf/0/anyOf",keyword:"anyOf",params:{},message:"must match a schema in anyOf"};return s===null?s=[ie]:s.push(ie),a++,ze.errors=s,!1}if(a===G)if(U&&typeof U=="object"&&!Array.isArray(U)){let ie;if(U.interface===void 0&&(ie="interface")||U.method===void 0&&(ie="method")||U.dataCid===void 0&&(ie="dataCid")||U.dataSize===void 0&&(ie="dataSize")||U.dateCreated===void 0&&(ie="dateCreated")||U.messageTimestamp===void 0&&(ie="messageTimestamp")||U.dataFormat===void 0&&(ie="dataFormat"))return ze.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:ie},message:"must have required property '"+ie+"'"}],!1;{let pe=a;for(let be in U)if(!tG.call(wy.properties.descriptor.properties,be)){return ze.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:be},message:"must NOT have additional properties"}],!1;break}if(pe===a){let be;if(U.parentId!==void 0&&U.protocol===void 0&&(be="protocol"))return ze.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/dependencies",keyword:"dependencies",params:{property:"parentId",missingProperty:be,depsCount:1,deps:"protocol"},message:"must have property protocol when property parentId is present"}],!1;if(U.interface!==void 0){let Ue=U.interface,ke=a;if(typeof Ue!="string")return ze.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(Ue!=="Records")return ze.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:wy.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var w=ke===a}else var w=!0;if(w){if(U.method!==void 0){let Ue=U.method,ke=a;if(typeof Ue!="string")return ze.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(Ue!=="Write")return ze.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:wy.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var w=ke===a}else var w=!0;if(w){if(U.recipient!==void 0){let Ue=U.recipient,ke=a;if(a===a)if(typeof Ue=="string"){if(!_y.test(Ue))return ze.errors=[{instancePath:e+"/descriptor/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return ze.errors=[{instancePath:e+"/descriptor/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var w=ke===a}else var w=!0;if(w){if(U.protocol!==void 0){let Ue=a;if(typeof U.protocol!="string")return ze.errors=[{instancePath:e+"/descriptor/protocol",schemaPath:"#/properties/descriptor/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var w=Ue===a}else var w=!0;if(w){if(U.protocolPath!==void 0){let Ue=U.protocolPath,ke=a;if(a===ke)if(typeof Ue=="string"){if(!b6e.test(Ue))return ze.errors=[{instancePath:e+"/descriptor/protocolPath",schemaPath:"#/properties/descriptor/properties/protocolPath/pattern",keyword:"pattern",params:{pattern:"^[a-zA-Z]+(/[a-zA-Z]+)*$"},message:'must match pattern "^[a-zA-Z]+(/[a-zA-Z]+)*$"'}],!1}else return ze.errors=[{instancePath:e+"/descriptor/protocolPath",schemaPath:"#/properties/descriptor/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var w=ke===a}else var w=!0;if(w){if(U.schema!==void 0){let Ue=a;if(typeof U.schema!="string")return ze.errors=[{instancePath:e+"/descriptor/schema",schemaPath:"#/properties/descriptor/properties/schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var w=Ue===a}else var w=!0;if(w){if(U.tags!==void 0){let Ue=U.tags,ke=a;if(a===ke)if(Ue&&typeof Ue=="object"&&!Array.isArray(Ue)){if(Object.keys(Ue).length>10)return ze.errors=[{instancePath:e+"/descriptor/tags",schemaPath:"#/properties/descriptor/properties/tags/maxProperties",keyword:"maxProperties",params:{limit:10},message:"must NOT have more than 10 properties"}],!1;if(Object.keys(Ue).length<1)return ze.errors=[{instancePath:e+"/descriptor/tags",schemaPath:"#/properties/descriptor/properties/tags/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;for(let St in Ue){let Fe=Ue[St],mt=a,In=a,Pe=!1,Te=null,Wt=a;if(typeof Fe!="string"){let xe={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[xe]:s.push(xe),a++}var E=Wt===a;E&&(Pe=!0,Te=0);let Re=a;if(!(typeof Fe=="number"&&isFinite(Fe))){let xe={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/1/type",keyword:"type",params:{type:"number"},message:"must be number"};s===null?s=[xe]:s.push(xe),a++}var E=Re===a;if(E&&Pe)Pe=!1,Te=[Te,1];else{E&&(Pe=!0,Te=1);let xe=a;if(typeof Fe!="boolean"){let We={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/2/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};s===null?s=[We]:s.push(We),a++}var E=xe===a;if(E&&Pe)Pe=!1,Te=[Te,2];else{E&&(Pe=!0,Te=2);let We=a;if(a===We)if(Array.isArray(Fe))if(Fe.length>10){let an={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/3/maxItems",keyword:"maxItems",params:{limit:10},message:"must NOT have more than 10 items"};s===null?s=[an]:s.push(an),a++}else if(Fe.length<1){let an={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/3/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};s===null?s=[an]:s.push(an),a++}else{var _=!0;let an=Fe.length;for(let Bt=0;Bt<an;Bt++){let Ze=a;if(typeof Fe[Bt]!="string"){let Ot={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+Bt,schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/3/items/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[Ot]:s.push(Ot),a++}var _=Ze===a;if(!_)break}}else{let an={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/3/type",keyword:"type",params:{type:"array"},message:"must be array"};s===null?s=[an]:s.push(an),a++}var E=We===a;if(E&&Pe)Pe=!1,Te=[Te,3];else{if(E){Pe=!0,Te=3;var b=!0}let an=a;if(a===an)if(Array.isArray(Fe))if(Fe.length>10){let Ze={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/4/maxItems",keyword:"maxItems",params:{limit:10},message:"must NOT have more than 10 items"};s===null?s=[Ze]:s.push(Ze),a++}else if(Fe.length<1){let Ze={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/4/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};s===null?s=[Ze]:s.push(Ze),a++}else{var C=!0;let Ze=Fe.length;for(let xd=0;xd<Ze;xd++){let Ot=Fe[xd],qt=a;if(!(typeof Ot=="number"&&isFinite(Ot))){let Nt={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1")+"/"+xd,schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/4/items/type",keyword:"type",params:{type:"number"},message:"must be number"};s===null?s=[Nt]:s.push(Nt),a++}var C=qt===a;if(!C)break}}else{let Ze={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf/4/type",keyword:"type",params:{type:"array"},message:"must be array"};s===null?s=[Ze]:s.push(Ze),a++}var E=an===a;E&&Pe?(Pe=!1,Te=[Te,4]):E&&(Pe=!0,Te=4,b!==!0&&(b=!0))}}}if(Pe)a=In,s!==null&&(In?s.length=In:s=null);else{let xe={instancePath:e+"/descriptor/tags/"+St.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/descriptor/properties/tags/additionalProperties/oneOf",keyword:"oneOf",params:{passingSchemas:Te},message:"must match exactly one schema in oneOf"};return s===null?s=[xe]:s.push(xe),a++,ze.errors=s,!1}var N=mt===a;if(!N)break}}else return ze.errors=[{instancePath:e+"/descriptor/tags",schemaPath:"#/properties/descriptor/properties/tags/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var w=ke===a}else var w=!0;if(w){if(U.parentId!==void 0){let Ue=a;if(typeof U.parentId!="string")return ze.errors=[{instancePath:e+"/descriptor/parentId",schemaPath:"#/properties/descriptor/properties/parentId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var w=Ue===a}else var w=!0;if(w){if(U.dataCid!==void 0){let Ue=a;if(typeof U.dataCid!="string")return ze.errors=[{instancePath:e+"/descriptor/dataCid",schemaPath:"#/properties/descriptor/properties/dataCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var w=Ue===a}else var w=!0;if(w){if(U.dataSize!==void 0){let Ue=U.dataSize,ke=a;if(!(typeof Ue=="number"&&isFinite(Ue)))return ze.errors=[{instancePath:e+"/descriptor/dataSize",schemaPath:"#/properties/descriptor/properties/dataSize/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var w=ke===a}else var w=!0;if(w){if(U.dateCreated!==void 0){let Ue=U.dateCreated,ke=a;if(a===a)if(typeof Ue=="string"){if(!Ji.test(Ue))return ze.errors=[{instancePath:e+"/descriptor/dateCreated",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return ze.errors=[{instancePath:e+"/descriptor/dateCreated",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var w=ke===a}else var w=!0;if(w){if(U.messageTimestamp!==void 0){let Ue=U.messageTimestamp,ke=a;if(a===a)if(typeof Ue=="string"){if(!Ji.test(Ue))return ze.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return ze.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var w=ke===a}else var w=!0;if(w){if(U.published!==void 0){let Ue=a;if(typeof U.published!="boolean")return ze.errors=[{instancePath:e+"/descriptor/published",schemaPath:"#/properties/descriptor/properties/published/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var w=Ue===a}else var w=!0;if(w){if(U.datePublished!==void 0){let Ue=U.datePublished,ke=a;if(a===a)if(typeof Ue=="string"){if(!Ji.test(Ue))return ze.errors=[{instancePath:e+"/descriptor/datePublished",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return ze.errors=[{instancePath:e+"/descriptor/datePublished",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var w=ke===a}else var w=!0;if(w)if(U.dataFormat!==void 0){let Ue=a;if(typeof U.dataFormat!="string")return ze.errors=[{instancePath:e+"/descriptor/dataFormat",schemaPath:"#/properties/descriptor/properties/dataFormat/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var w=Ue===a}else var w=!0}}}}}}}}}}}}}}}}else return ze.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var K=G===a}else var K=!0}}}}}else return ze.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return ze.errors=s,d.props=h,a===0}ze.evaluated={dynamicProps:!0,dynamicItems:!1};function Ad(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Ad.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),!ze(t,{instancePath:e,parentData:r,parentDataProperty:n,rootData:i,dynamicAnchors:o}))s=s===null?ze.errors:s.concat(ze.errors),a=s.length;else var u=ze.evaluated.props;if(a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.recordId===void 0&&(l="recordId")||t.authorization===void 0&&(l="authorization")||t.encodedData===void 0&&(l="encodedData"))return Ad.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;if(u!==!0&&(u=u||{},u.encodedData=!0),t.encodedData!==void 0){let h=a;if(typeof t.encodedData!="string")return Ad.errors=[{instancePath:e+"/encodedData",schemaPath:"#/properties/encodedData/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=h===a}else var c=!0;if(c&&u!==!0){for(let h in t)if(!u||!u[h]){return Ad.errors=[{instancePath:e,schemaPath:"#/unevaluatedProperties",keyword:"unevaluatedProperties",params:{unevaluatedProperty:h},message:"must NOT have unevaluated properties"}],!1;break}}}else return Ad.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Ad.errors=s,a===0}Ad.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};function Po(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Po.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let c=a;for(let l in t)if(!(l==="signature"||l==="authorDelegatedGrant")){return Po.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:l},message:"must NOT have additional properties"}],!1;break}if(c===a){if(t.signature!==void 0){let l=a;un(t.signature,{instancePath:e+"/signature",parentData:t,parentDataProperty:"signature",rootData:i,dynamicAnchors:o})||(s=s===null?un.errors:s.concat(un.errors),a=s.length);var u=l===a}else var u=!0;if(u)if(t.authorDelegatedGrant!==void 0){let l=a;Ad(t.authorDelegatedGrant,{instancePath:e+"/authorDelegatedGrant",parentData:t,parentDataProperty:"authorDelegatedGrant",rootData:i,dynamicAnchors:o})||(s=s===null?Ad.errors:s.concat(Ad.errors),a=s.length);var u=l===a}else var u=!0}}else return Po.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Po.errors=s,a===0}Po.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var w6e=Nl,_6e=ko,qW={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-delete.json",type:"object",additionalProperties:!1,required:["authorization","descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-delegated-grant.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","recordId","prune"],properties:{interface:{enum:["Records"],type:"string"},method:{enum:["Delete"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},recordId:{type:"string"},prune:{type:"boolean"}}}}};function ko(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=ko.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.authorization===void 0&&(l="authorization")||t.descriptor===void 0&&(l="descriptor"))return ko.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;{let h=a;for(let y in t)if(!(y==="authorization"||y==="descriptor")){return ko.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:y},message:"must NOT have additional properties"}],!1;break}if(h===a){if(t.authorization!==void 0){let y=a;Po(t.authorization,{instancePath:e+"/authorization",parentData:t,parentDataProperty:"authorization",rootData:i,dynamicAnchors:o})||(s=s===null?Po.errors:s.concat(Po.errors),a=s.length);var u=y===a}else var u=!0;if(u)if(t.descriptor!==void 0){let y=t.descriptor,g=a;if(a===g)if(y&&typeof y=="object"&&!Array.isArray(y)){let x;if(y.interface===void 0&&(x="interface")||y.method===void 0&&(x="method")||y.messageTimestamp===void 0&&(x="messageTimestamp")||y.recordId===void 0&&(x="recordId")||y.prune===void 0&&(x="prune"))return ko.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:x},message:"must have required property '"+x+"'"}],!1;{let S=a;for(let A in y)if(!(A==="interface"||A==="method"||A==="messageTimestamp"||A==="recordId"||A==="prune")){return ko.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:A},message:"must NOT have additional properties"}],!1;break}if(S===a){if(y.interface!==void 0){let A=y.interface,T=a;if(typeof A!="string")return ko.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(A!=="Records")return ko.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:qW.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var c=T===a}else var c=!0;if(c){if(y.method!==void 0){let A=y.method,T=a;if(typeof A!="string")return ko.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(A!=="Delete")return ko.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:qW.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var c=T===a}else var c=!0;if(c){if(y.messageTimestamp!==void 0){let A=y.messageTimestamp,T=a;if(a===a)if(typeof A=="string"){if(!Ji.test(A))return ko.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return ko.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=T===a}else var c=!0;if(c){if(y.recordId!==void 0){let A=a;if(typeof y.recordId!="string")return ko.errors=[{instancePath:e+"/descriptor/recordId",schemaPath:"#/properties/descriptor/properties/recordId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=A===a}else var c=!0;if(c)if(y.prune!==void 0){let A=a;if(typeof y.prune!="boolean")return ko.errors=[{instancePath:e+"/descriptor/prune",schemaPath:"#/properties/descriptor/properties/prune/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var c=A===a}else var c=!0}}}}}}else return ko.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=g===a}else var u=!0}}}else return ko.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return ko.errors=s,a===0}ko.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var x6e=gn,_O={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-query.json",type:"object",additionalProperties:!1,required:["descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-delegated-grant.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","filter"],properties:{interface:{enum:["Records"],type:"string"},method:{enum:["Query"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},filter:{$ref:"https://identity.foundation/dwn/json-schemas/records-filter.json"},pagination:{type:"object",additionalProperties:!1,properties:{limit:{type:"number",minimum:1},cursor:{$ref:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json"}}},dateSort:{enum:["createdAscending","createdDescending","publishedAscending","publishedDescending"],type:"string"}}}}},EO={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json",type:"object",minProperties:1,additionalProperties:!1,required:["messageCid","value"],properties:{messageCid:{type:"string"},value:{type:["string","number"]}}},LW={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-filter.json",type:"object",minProperties:1,additionalProperties:!1,properties:{protocol:{type:"string"},protocolPath:{type:"string"},author:{oneOf:[{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"},{type:"array",items:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"}}]},attester:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"},recipient:{oneOf:[{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"},{type:"array",items:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"}}]},contextId:{type:"string"},schema:{type:"string"},tags:{type:"object",minProperties:1,additionalProperties:{oneOf:[{type:"string"},{type:"number"},{type:"boolean"},{type:"object",minProperties:1,additionalProperties:!1,properties:{startsWith:{type:"string"}}},{$ref:"https://identity.foundation/dwn/json-schemas/string-range-filter.json"},{$ref:"https://identity.foundation/dwn/json-schemas/number-range-filter.json"}]}},recordId:{type:"string"},parentId:{type:"string"},published:{type:"boolean"},dataFormat:{type:"string"},dataSize:{$ref:"https://identity.foundation/dwn/json-schemas/number-range-filter.json"},dataCid:{type:"string"},dateCreated:{type:"object",minProperties:1,additionalProperties:!1,properties:{from:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},to:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"}}},datePublished:{type:"object",minProperties:1,additionalProperties:!1,properties:{from:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},to:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"}}},dateUpdated:{type:"object",minProperties:1,additionalProperties:!1,properties:{from:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},to:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"}}}},dependencies:{datePublished:{oneOf:[{properties:{published:{enum:[!0]}},required:["published"]},{not:{required:["published"]}}]}}};function Xe(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Xe.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){if(Object.keys(t).length<1)return Xe.errors=[{instancePath:e,schemaPath:"#/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let J=a;for(let H in t)if(!tG.call(LW.properties,H)){return Xe.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:H},message:"must NOT have additional properties"}],!1;break}if(J===a){if(t.datePublished!==void 0){let H=a,X=a,te=!1,ne=null,Q=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ge;if(t.published===void 0&&(ge="published")){let ie={instancePath:e,schemaPath:"#/dependencies/datePublished/oneOf/0/required",keyword:"required",params:{missingProperty:ge},message:"must have required property '"+ge+"'"};s===null?s=[ie]:s.push(ie),a++}else if(t.published!==void 0&&t.published!==!0){let ie={instancePath:e+"/published",schemaPath:"#/dependencies/datePublished/oneOf/0/properties/published/enum",keyword:"enum",params:{allowedValues:LW.dependencies.datePublished.oneOf[0].properties.published.enum},message:"must be equal to one of the allowed values"};s===null?s=[ie]:s.push(ie),a++}}var l=Q===a;if(l){te=!0,ne=0;var u={};u.published=!0}let re=a,ae=a,he=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let ge;if(t.published===void 0&&(ge="published")){let ie={};s===null?s=[ie]:s.push(ie),a++}}var c=he===a;if(c){let ge={instancePath:e,schemaPath:"#/dependencies/datePublished/oneOf/1/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[ge]:s.push(ge),a++}else a=ae,s!==null&&(ae?s.length=ae:s=null);var l=re===a;if(l&&te?(te=!1,ne=[ne,1]):l&&(te=!0,ne=1),te)a=X,s!==null&&(X?s.length=X:s=null);else{let ge={instancePath:e,schemaPath:"#/dependencies/datePublished/oneOf",keyword:"oneOf",params:{passingSchemas:ne},message:"must match exactly one schema in oneOf"};return s===null?s=[ge]:s.push(ge),a++,Xe.errors=s,!1}var h=H===a}else var h=!0;if(h){if(t.protocol!==void 0){let H=a;if(typeof t.protocol!="string")return Xe.errors=[{instancePath:e+"/protocol",schemaPath:"#/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var y=H===a}else var y=!0;if(y){if(t.protocolPath!==void 0){let H=a;if(typeof t.protocolPath!="string")return Xe.errors=[{instancePath:e+"/protocolPath",schemaPath:"#/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var y=H===a}else var y=!0;if(y){if(t.author!==void 0){let H=t.author,X=a,te=a,ne=!1,Q=null,re=a;if(a===a)if(typeof H=="string"){if(!_y.test(H)){let ie={instancePath:e+"/author",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'};s===null?s=[ie]:s.push(ie),a++}}else{let ie={instancePath:e+"/author",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ie]:s.push(ie),a++}var v=re===a;v&&(ne=!0,Q=0);let he=a;if(a===he)if(Array.isArray(H)){var g=!0;let ie=H.length;for(let pe=0;pe<ie;pe++){let be=H[pe],Ue=a;if(a===a)if(typeof be=="string"){if(!_y.test(be)){let St={instancePath:e+"/author/"+pe,schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'};s===null?s=[St]:s.push(St),a++}}else{let St={instancePath:e+"/author/"+pe,schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[St]:s.push(St),a++}var g=Ue===a;if(!g)break}}else{let ie={instancePath:e+"/author",schemaPath:"#/properties/author/oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};s===null?s=[ie]:s.push(ie),a++}var v=he===a;if(v&&ne?(ne=!1,Q=[Q,1]):v&&(ne=!0,Q=1),ne)a=te,s!==null&&(te?s.length=te:s=null);else{let ie={instancePath:e+"/author",schemaPath:"#/properties/author/oneOf",keyword:"oneOf",params:{passingSchemas:Q},message:"must match exactly one schema in oneOf"};return s===null?s=[ie]:s.push(ie),a++,Xe.errors=s,!1}var y=X===a}else var y=!0;if(y){if(t.attester!==void 0){let H=t.attester,X=a;if(a===a)if(typeof H=="string"){if(!_y.test(H))return Xe.errors=[{instancePath:e+"/attester",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return Xe.errors=[{instancePath:e+"/attester",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var y=X===a}else var y=!0;if(y){if(t.recipient!==void 0){let H=t.recipient,X=a,te=a,ne=!1,Q=null,re=a;if(a===a)if(typeof H=="string"){if(!_y.test(H)){let ie={instancePath:e+"/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'};s===null?s=[ie]:s.push(ie),a++}}else{let ie={instancePath:e+"/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ie]:s.push(ie),a++}var S=re===a;S&&(ne=!0,Q=0);let he=a;if(a===he)if(Array.isArray(H)){var x=!0;let ie=H.length;for(let pe=0;pe<ie;pe++){let be=H[pe],Ue=a;if(a===a)if(typeof be=="string"){if(!_y.test(be)){let St={instancePath:e+"/recipient/"+pe,schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'};s===null?s=[St]:s.push(St),a++}}else{let St={instancePath:e+"/recipient/"+pe,schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[St]:s.push(St),a++}var x=Ue===a;if(!x)break}}else{let ie={instancePath:e+"/recipient",schemaPath:"#/properties/recipient/oneOf/1/type",keyword:"type",params:{type:"array"},message:"must be array"};s===null?s=[ie]:s.push(ie),a++}var S=he===a;if(S&&ne?(ne=!1,Q=[Q,1]):S&&(ne=!0,Q=1),ne)a=te,s!==null&&(te?s.length=te:s=null);else{let ie={instancePath:e+"/recipient",schemaPath:"#/properties/recipient/oneOf",keyword:"oneOf",params:{passingSchemas:Q},message:"must match exactly one schema in oneOf"};return s===null?s=[ie]:s.push(ie),a++,Xe.errors=s,!1}var y=X===a}else var y=!0;if(y){if(t.contextId!==void 0){let H=a;if(typeof t.contextId!="string")return Xe.errors=[{instancePath:e+"/contextId",schemaPath:"#/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var y=H===a}else var y=!0;if(y){if(t.schema!==void 0){let H=a;if(typeof t.schema!="string")return Xe.errors=[{instancePath:e+"/schema",schemaPath:"#/properties/schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var y=H===a}else var y=!0;if(y){if(t.tags!==void 0){let H=t.tags,X=a;if(a===X)if(H&&typeof H=="object"&&!Array.isArray(H)){if(Object.keys(H).length<1)return Xe.errors=[{instancePath:e+"/tags",schemaPath:"#/properties/tags/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;for(let ne in H){let Q=H[ne],re=a,ae=a,he=!1,ge=null,ie=a;if(typeof Q!="string"){let be={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/0/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[be]:s.push(be),a++}var A=ie===a;A&&(he=!0,ge=0);let pe=a;if(!(typeof Q=="number"&&isFinite(Q))){let be={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/1/type",keyword:"type",params:{type:"number"},message:"must be number"};s===null?s=[be]:s.push(be),a++}var A=pe===a;if(A&&he)he=!1,ge=[ge,1];else{A&&(he=!0,ge=1);let be=a;if(typeof Q!="boolean"){let ke={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/2/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"};s===null?s=[ke]:s.push(ke),a++}var A=be===a;if(A&&he)he=!1,ge=[ge,2];else{A&&(he=!0,ge=2);let ke=a;if(a===ke)if(Q&&typeof Q=="object"&&!Array.isArray(Q))if(Object.keys(Q).length<1){let St={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/3/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"};s===null?s=[St]:s.push(St),a++}else{let St=a;for(let Fe in Q)if(Fe!=="startsWith"){let mt={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/3/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Fe},message:"must NOT have additional properties"};s===null?s=[mt]:s.push(mt),a++;break}if(St===a&&Q.startsWith!==void 0&&typeof Q.startsWith!="string"){let Fe={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1")+"/startsWith",schemaPath:"#/properties/tags/additionalProperties/oneOf/3/properties/startsWith/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[Fe]:s.push(Fe),a++}}else{let St={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf/3/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[St]:s.push(St),a++}var A=ke===a;if(A&&he)he=!1,ge=[ge,3];else{if(A){he=!0,ge=3;var T=!0}let St=a;if(a===a)if(Q&&typeof Q=="object"&&!Array.isArray(Q))if(Object.keys(Q).length<1){let In={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"};s===null?s=[In]:s.push(In),a++}else{let In=a;for(let Pe in Q)if(!(Pe==="gt"||Pe==="gte"||Pe==="lt"||Pe==="lte")){let Te={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Pe},message:"must NOT have additional properties"};s===null?s=[Te]:s.push(Te),a++;break}if(In===a){if(Q.gt!==void 0){let Pe=a,Te=a,Wt=a;if(Q&&typeof Q=="object"&&!Array.isArray(Q)){let Re;if(Q.gte===void 0&&(Re="gte")){let xe={};s===null?s=[xe]:s.push(xe),a++}}var $=Wt===a;if($){let Re={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/dependencies/gt/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[Re]:s.push(Re),a++}else a=Te,s!==null&&(Te?s.length=Te:s=null);var j=Pe===a}else var j=!0;if(j){if(Q.gte!==void 0){let Pe=a,Te=a,Wt=a;if(Q&&typeof Q=="object"&&!Array.isArray(Q)){let xe;if(Q.gt===void 0&&(xe="gt")){let qr={};s===null?s=[qr]:s.push(qr),a++}}var K=Wt===a;if(K){let xe={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/dependencies/gte/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[xe]:s.push(xe),a++}else a=Te,s!==null&&(Te?s.length=Te:s=null);var j=Pe===a}else var j=!0;if(j){if(Q.lt!==void 0){let Pe=a,Te=a,Wt=a;if(Q&&typeof Q=="object"&&!Array.isArray(Q)){let xe;if(Q.lte===void 0&&(xe="lte")){let qr={};s===null?s=[qr]:s.push(qr),a++}}var F=Wt===a;if(F){let xe={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/dependencies/lt/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[xe]:s.push(xe),a++}else a=Te,s!==null&&(Te?s.length=Te:s=null);var j=Pe===a}else var j=!0;if(j){if(Q.lte!==void 0){let Pe=a,Te=a,Wt=a;if(Q&&typeof Q=="object"&&!Array.isArray(Q)){let xe;if(Q.lt===void 0&&(xe="lt")){let qr={};s===null?s=[qr]:s.push(qr),a++}}var L=Wt===a;if(L){let xe={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/dependencies/lte/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[xe]:s.push(xe),a++}else a=Te,s!==null&&(Te?s.length=Te:s=null);var j=Pe===a}else var j=!0;if(j){if(Q.gt!==void 0){let Pe=a;if(typeof Q.gt!="string"){let Te={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1")+"/gt",schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/properties/gt/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[Te]:s.push(Te),a++}var V=Pe===a}else var V=!0;if(V){if(Q.gte!==void 0){let Pe=a;if(typeof Q.gte!="string"){let Wt={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1")+"/gte",schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/properties/gte/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[Wt]:s.push(Wt),a++}var V=Pe===a}else var V=!0;if(V){if(Q.lt!==void 0){let Pe=a;if(typeof Q.lt!="string"){let Wt={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1")+"/lt",schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/properties/lt/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[Wt]:s.push(Wt),a++}var V=Pe===a}else var V=!0;if(V)if(Q.lte!==void 0){let Pe=a;if(typeof Q.lte!="string"){let Wt={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1")+"/lte",schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/properties/lte/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[Wt]:s.push(Wt),a++}var V=Pe===a}else var V=!0}}}}}}}}else{let In={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/string-range-filter.json/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[In]:s.push(In),a++}var A=St===a;if(A&&he)he=!1,ge=[ge,4];else{A&&(he=!0,ge=4,T!==!0&&(T=!0));let In=a;if(a===a)if(Q&&typeof Q=="object"&&!Array.isArray(Q))if(Object.keys(Q).length<1){let Wt={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"};s===null?s=[Wt]:s.push(Wt),a++}else{let Wt=a;for(let Re in Q)if(!(Re==="gt"||Re==="gte"||Re==="lt"||Re==="lte")){let xe={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Re},message:"must NOT have additional properties"};s===null?s=[xe]:s.push(xe),a++;break}if(Wt===a){if(Q.gt!==void 0){let Re=a,xe=a,qr=a;if(Q&&typeof Q=="object"&&!Array.isArray(Q)){let We;if(Q.gte===void 0&&(We="gte")){let Ye={};s===null?s=[Ye]:s.push(Ye),a++}}var q=qr===a;if(q){let We={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/gt/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[We]:s.push(We),a++}else a=xe,s!==null&&(xe?s.length=xe:s=null);var k=Re===a}else var k=!0;if(k){if(Q.gte!==void 0){let Re=a,xe=a,qr=a;if(Q&&typeof Q=="object"&&!Array.isArray(Q)){let Ye;if(Q.gt===void 0&&(Ye="gt")){let an={};s===null?s=[an]:s.push(an),a++}}var P=qr===a;if(P){let Ye={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/gte/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[Ye]:s.push(Ye),a++}else a=xe,s!==null&&(xe?s.length=xe:s=null);var k=Re===a}else var k=!0;if(k){if(Q.lt!==void 0){let Re=a,xe=a,qr=a;if(Q&&typeof Q=="object"&&!Array.isArray(Q)){let Ye;if(Q.lte===void 0&&(Ye="lte")){let an={};s===null?s=[an]:s.push(an),a++}}var B=qr===a;if(B){let Ye={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/lt/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[Ye]:s.push(Ye),a++}else a=xe,s!==null&&(xe?s.length=xe:s=null);var k=Re===a}else var k=!0;if(k){if(Q.lte!==void 0){let Re=a,xe=a,qr=a;if(Q&&typeof Q=="object"&&!Array.isArray(Q)){let Ye;if(Q.lt===void 0&&(Ye="lt")){let an={};s===null?s=[an]:s.push(an),a++}}var p=qr===a;if(p){let Ye={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/lte/not",keyword:"not",params:{},message:"must NOT be valid"};s===null?s=[Ye]:s.push(Ye),a++}else a=xe,s!==null&&(xe?s.length=xe:s=null);var k=Re===a}else var k=!0;if(k){if(Q.gt!==void 0){let Re=Q.gt,xe=a;if(!(typeof Re=="number"&&isFinite(Re))){let qr={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1")+"/gt",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/gt/type",keyword:"type",params:{type:"number"},message:"must be number"};s===null?s=[qr]:s.push(qr),a++}var m=xe===a}else var m=!0;if(m){if(Q.gte!==void 0){let Re=Q.gte,xe=a;if(!(typeof Re=="number"&&isFinite(Re))){let We={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1")+"/gte",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/gte/type",keyword:"type",params:{type:"number"},message:"must be number"};s===null?s=[We]:s.push(We),a++}var m=xe===a}else var m=!0;if(m){if(Q.lt!==void 0){let Re=Q.lt,xe=a;if(!(typeof Re=="number"&&isFinite(Re))){let We={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1")+"/lt",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/lt/type",keyword:"type",params:{type:"number"},message:"must be number"};s===null?s=[We]:s.push(We),a++}var m=xe===a}else var m=!0;if(m)if(Q.lte!==void 0){let Re=Q.lte,xe=a;if(!(typeof Re=="number"&&isFinite(Re))){let We={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1")+"/lte",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/lte/type",keyword:"type",params:{type:"number"},message:"must be number"};s===null?s=[We]:s.push(We),a++}var m=xe===a}else var m=!0}}}}}}}}else{let Wt={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[Wt]:s.push(Wt),a++}var A=In===a;A&&he?(he=!1,ge=[ge,5]):A&&(he=!0,ge=5,T!==!0&&(T=!0))}}}}if(he)a=ae,s!==null&&(ae?s.length=ae:s=null);else{let be={instancePath:e+"/tags/"+ne.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/tags/additionalProperties/oneOf",keyword:"oneOf",params:{passingSchemas:ge},message:"must match exactly one schema in oneOf"};return s===null?s=[be]:s.push(be),a++,Xe.errors=s,!1}var w=re===a;if(!w)break}}else return Xe.errors=[{instancePath:e+"/tags",schemaPath:"#/properties/tags/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var y=X===a}else var y=!0;if(y){if(t.recordId!==void 0){let H=a;if(typeof t.recordId!="string")return Xe.errors=[{instancePath:e+"/recordId",schemaPath:"#/properties/recordId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var y=H===a}else var y=!0;if(y){if(t.parentId!==void 0){let H=a;if(typeof t.parentId!="string")return Xe.errors=[{instancePath:e+"/parentId",schemaPath:"#/properties/parentId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var y=H===a}else var y=!0;if(y){if(t.published!==void 0){let H=a;if(typeof t.published!="boolean")return Xe.errors=[{instancePath:e+"/published",schemaPath:"#/properties/published/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var y=H===a}else var y=!0;if(y){if(t.dataFormat!==void 0){let H=a;if(typeof t.dataFormat!="string")return Xe.errors=[{instancePath:e+"/dataFormat",schemaPath:"#/properties/dataFormat/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var y=H===a}else var y=!0;if(y){if(t.dataSize!==void 0){let H=t.dataSize,X=a;if(a===a)if(H&&typeof H=="object"&&!Array.isArray(H)){if(Object.keys(H).length<1)return Xe.errors=[{instancePath:e+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let Q=a;for(let re in H)if(!(re==="gt"||re==="gte"||re==="lt"||re==="lte")){return Xe.errors=[{instancePath:e+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:re},message:"must NOT have additional properties"}],!1;break}if(Q===a){if(H.gt!==void 0){let re=a,ae=a,he=a;if(H&&typeof H=="object"&&!Array.isArray(H)){let ge;if(H.gte===void 0&&(ge="gte")){let ie={};s===null?s=[ie]:s.push(ie),a++}}var E=he===a;if(E)return Xe.errors=[{instancePath:e+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/gt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=ae,s!==null&&(ae?s.length=ae:s=null);var _=re===a}else var _=!0;if(_){if(H.gte!==void 0){let re=a,ae=a,he=a;if(H&&typeof H=="object"&&!Array.isArray(H)){let ie;if(H.gt===void 0&&(ie="gt")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var b=he===a;if(b)return Xe.errors=[{instancePath:e+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/gte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=ae,s!==null&&(ae?s.length=ae:s=null);var _=re===a}else var _=!0;if(_){if(H.lt!==void 0){let re=a,ae=a,he=a;if(H&&typeof H=="object"&&!Array.isArray(H)){let ie;if(H.lte===void 0&&(ie="lte")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var C=he===a;if(C)return Xe.errors=[{instancePath:e+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/lt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=ae,s!==null&&(ae?s.length=ae:s=null);var _=re===a}else var _=!0;if(_){if(H.lte!==void 0){let re=a,ae=a,he=a;if(H&&typeof H=="object"&&!Array.isArray(H)){let ie;if(H.lt===void 0&&(ie="lt")){let pe={};s===null?s=[pe]:s.push(pe),a++}}var N=he===a;if(N)return Xe.errors=[{instancePath:e+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/dependencies/lte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=ae,s!==null&&(ae?s.length=ae:s=null);var _=re===a}else var _=!0;if(_){if(H.gt!==void 0){let re=H.gt,ae=a;if(!(typeof re=="number"&&isFinite(re)))return Xe.errors=[{instancePath:e+"/dataSize/gt",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/gt/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var D=ae===a}else var D=!0;if(D){if(H.gte!==void 0){let re=H.gte,ae=a;if(!(typeof re=="number"&&isFinite(re)))return Xe.errors=[{instancePath:e+"/dataSize/gte",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/gte/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var D=ae===a}else var D=!0;if(D){if(H.lt!==void 0){let re=H.lt,ae=a;if(!(typeof re=="number"&&isFinite(re)))return Xe.errors=[{instancePath:e+"/dataSize/lt",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/lt/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var D=ae===a}else var D=!0;if(D)if(H.lte!==void 0){let re=H.lte,ae=a;if(!(typeof re=="number"&&isFinite(re)))return Xe.errors=[{instancePath:e+"/dataSize/lte",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/properties/lte/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var D=ae===a}else var D=!0}}}}}}}}}else return Xe.errors=[{instancePath:e+"/dataSize",schemaPath:"https://identity.foundation/dwn/json-schemas/number-range-filter.json/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var y=X===a}else var y=!0;if(y){if(t.dataCid!==void 0){let H=a;if(typeof t.dataCid!="string")return Xe.errors=[{instancePath:e+"/dataCid",schemaPath:"#/properties/dataCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var y=H===a}else var y=!0;if(y){if(t.dateCreated!==void 0){let H=t.dateCreated,X=a;if(a===X)if(H&&typeof H=="object"&&!Array.isArray(H)){if(Object.keys(H).length<1)return Xe.errors=[{instancePath:e+"/dateCreated",schemaPath:"#/properties/dateCreated/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let ne=a;for(let Q in H)if(!(Q==="from"||Q==="to")){return Xe.errors=[{instancePath:e+"/dateCreated",schemaPath:"#/properties/dateCreated/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Q},message:"must NOT have additional properties"}],!1;break}if(ne===a){if(H.from!==void 0){let Q=H.from,re=a;if(a===a)if(typeof Q=="string"){if(!Ji.test(Q))return Xe.errors=[{instancePath:e+"/dateCreated/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Xe.errors=[{instancePath:e+"/dateCreated/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var U=re===a}else var U=!0;if(U)if(H.to!==void 0){let Q=H.to,re=a;if(a===a)if(typeof Q=="string"){if(!Ji.test(Q))return Xe.errors=[{instancePath:e+"/dateCreated/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Xe.errors=[{instancePath:e+"/dateCreated/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var U=re===a}else var U=!0}}}else return Xe.errors=[{instancePath:e+"/dateCreated",schemaPath:"#/properties/dateCreated/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var y=X===a}else var y=!0;if(y){if(t.datePublished!==void 0){let H=t.datePublished,X=a;if(a===X)if(H&&typeof H=="object"&&!Array.isArray(H)){if(Object.keys(H).length<1)return Xe.errors=[{instancePath:e+"/datePublished",schemaPath:"#/properties/datePublished/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let ne=a;for(let Q in H)if(!(Q==="from"||Q==="to")){return Xe.errors=[{instancePath:e+"/datePublished",schemaPath:"#/properties/datePublished/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Q},message:"must NOT have additional properties"}],!1;break}if(ne===a){if(H.from!==void 0){let Q=H.from,re=a;if(a===a)if(typeof Q=="string"){if(!Ji.test(Q))return Xe.errors=[{instancePath:e+"/datePublished/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Xe.errors=[{instancePath:e+"/datePublished/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var G=re===a}else var G=!0;if(G)if(H.to!==void 0){let Q=H.to,re=a;if(a===a)if(typeof Q=="string"){if(!Ji.test(Q))return Xe.errors=[{instancePath:e+"/datePublished/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Xe.errors=[{instancePath:e+"/datePublished/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var G=re===a}else var G=!0}}}else return Xe.errors=[{instancePath:e+"/datePublished",schemaPath:"#/properties/datePublished/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var y=X===a}else var y=!0;if(y)if(t.dateUpdated!==void 0){let H=t.dateUpdated,X=a;if(a===X)if(H&&typeof H=="object"&&!Array.isArray(H)){if(Object.keys(H).length<1)return Xe.errors=[{instancePath:e+"/dateUpdated",schemaPath:"#/properties/dateUpdated/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let ne=a;for(let Q in H)if(!(Q==="from"||Q==="to")){return Xe.errors=[{instancePath:e+"/dateUpdated",schemaPath:"#/properties/dateUpdated/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Q},message:"must NOT have additional properties"}],!1;break}if(ne===a){if(H.from!==void 0){let Q=H.from,re=a;if(a===a)if(typeof Q=="string"){if(!Ji.test(Q))return Xe.errors=[{instancePath:e+"/dateUpdated/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Xe.errors=[{instancePath:e+"/dateUpdated/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Y=re===a}else var Y=!0;if(Y)if(H.to!==void 0){let Q=H.to,re=a;if(a===a)if(typeof Q=="string"){if(!Ji.test(Q))return Xe.errors=[{instancePath:e+"/dateUpdated/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Xe.errors=[{instancePath:e+"/dateUpdated/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var Y=re===a}else var Y=!0}}}else return Xe.errors=[{instancePath:e+"/dateUpdated",schemaPath:"#/properties/dateUpdated/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var y=X===a}else var y=!0}}}}}}}}}}}}}}}}}}}else return Xe.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Xe.errors=s,a===0}Xe.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};function gn(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=gn.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let y;if(t.descriptor===void 0&&(y="descriptor"))return gn.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:y},message:"must have required property '"+y+"'"}],!1;{let g=a;for(let v in t)if(!(v==="authorization"||v==="descriptor")){return gn.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:v},message:"must NOT have additional properties"}],!1;break}if(g===a){if(t.authorization!==void 0){let v=a;Po(t.authorization,{instancePath:e+"/authorization",parentData:t,parentDataProperty:"authorization",rootData:i,dynamicAnchors:o})||(s=s===null?Po.errors:s.concat(Po.errors),a=s.length);var u=v===a}else var u=!0;if(u)if(t.descriptor!==void 0){let v=t.descriptor,x=a;if(a===x)if(v&&typeof v=="object"&&!Array.isArray(v)){let A;if(v.interface===void 0&&(A="interface")||v.method===void 0&&(A="method")||v.messageTimestamp===void 0&&(A="messageTimestamp")||v.filter===void 0&&(A="filter"))return gn.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:A},message:"must have required property '"+A+"'"}],!1;{let T=a;for(let $ in v)if(!($==="interface"||$==="method"||$==="messageTimestamp"||$==="filter"||$==="pagination"||$==="dateSort")){return gn.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:$},message:"must NOT have additional properties"}],!1;break}if(T===a){if(v.interface!==void 0){let $=v.interface,j=a;if(typeof $!="string")return gn.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if($!=="Records")return gn.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:_O.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var c=j===a}else var c=!0;if(c){if(v.method!==void 0){let $=v.method,j=a;if(typeof $!="string")return gn.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if($!=="Query")return gn.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:_O.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var c=j===a}else var c=!0;if(c){if(v.messageTimestamp!==void 0){let $=v.messageTimestamp,j=a;if(a===a)if(typeof $=="string"){if(!Ji.test($))return gn.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return gn.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=j===a}else var c=!0;if(c){if(v.filter!==void 0){let $=a;Xe(v.filter,{instancePath:e+"/descriptor/filter",parentData:v,parentDataProperty:"filter",rootData:i,dynamicAnchors:o})||(s=s===null?Xe.errors:s.concat(Xe.errors),a=s.length);var c=$===a}else var c=!0;if(c){if(v.pagination!==void 0){let $=v.pagination,j=a;if(a===j)if($&&typeof $=="object"&&!Array.isArray($)){let F=a;for(let L in $)if(!(L==="limit"||L==="cursor")){return gn.errors=[{instancePath:e+"/descriptor/pagination",schemaPath:"#/properties/descriptor/properties/pagination/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:L},message:"must NOT have additional properties"}],!1;break}if(F===a){if($.limit!==void 0){let L=$.limit,V=a;if(a===V)if(typeof L=="number"&&isFinite(L)){if(L<1||isNaN(L))return gn.errors=[{instancePath:e+"/descriptor/pagination/limit",schemaPath:"#/properties/descriptor/properties/pagination/properties/limit/minimum",keyword:"minimum",params:{comparison:">=",limit:1},message:"must be >= 1"}],!1}else return gn.errors=[{instancePath:e+"/descriptor/pagination/limit",schemaPath:"#/properties/descriptor/properties/pagination/properties/limit/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var l=V===a}else var l=!0;if(l)if($.cursor!==void 0){let L=$.cursor,V=a;if(a===a)if(L&&typeof L=="object"&&!Array.isArray(L)){if(Object.keys(L).length<1)return gn.errors=[{instancePath:e+"/descriptor/pagination/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let P;if(L.messageCid===void 0&&(P="messageCid")||L.value===void 0&&(P="value"))return gn.errors=[{instancePath:e+"/descriptor/pagination/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/required",keyword:"required",params:{missingProperty:P},message:"must have required property '"+P+"'"}],!1;{let B=a;for(let p in L)if(!(p==="messageCid"||p==="value")){return gn.errors=[{instancePath:e+"/descriptor/pagination/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:p},message:"must NOT have additional properties"}],!1;break}if(B===a){if(L.messageCid!==void 0){let p=a;if(typeof L.messageCid!="string")return gn.errors=[{instancePath:e+"/descriptor/pagination/cursor/messageCid",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/properties/messageCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var h=p===a}else var h=!0;if(h)if(L.value!==void 0){let p=L.value,m=a;if(typeof p!="string"&&!(typeof p=="number"&&isFinite(p)))return gn.errors=[{instancePath:e+"/descriptor/pagination/cursor/value",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/properties/value/type",keyword:"type",params:{type:EO.properties.value.type},message:"must be string,number"}],!1;var h=m===a}else var h=!0}}}}else return gn.errors=[{instancePath:e+"/descriptor/pagination/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var l=V===a}else var l=!0}}else return gn.errors=[{instancePath:e+"/descriptor/pagination",schemaPath:"#/properties/descriptor/properties/pagination/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var c=j===a}else var c=!0;if(c)if(v.dateSort!==void 0){let $=v.dateSort,j=a;if(typeof $!="string")return gn.errors=[{instancePath:e+"/descriptor/dateSort",schemaPath:"#/properties/descriptor/properties/dateSort/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!($==="createdAscending"||$==="createdDescending"||$==="publishedAscending"||$==="publishedDescending"))return gn.errors=[{instancePath:e+"/descriptor/dateSort",schemaPath:"#/properties/descriptor/properties/dateSort/enum",keyword:"enum",params:{allowedValues:_O.properties.descriptor.properties.dateSort.enum},message:"must be equal to one of the allowed values"}],!1;var c=j===a}else var c=!0}}}}}}}else return gn.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=x===a}else var u=!0}}}else return gn.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return gn.errors=s,a===0}gn.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var E6e=Hs,FW={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-subscribe.json",type:"object",additionalProperties:!1,required:["descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-delegated-grant.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","filter"],properties:{interface:{enum:["Records"],type:"string"},method:{enum:["Subscribe"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},filter:{$ref:"https://identity.foundation/dwn/json-schemas/records-filter.json"}}}}};function Hs(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Hs.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.descriptor===void 0&&(l="descriptor"))return Hs.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;{let h=a;for(let y in t)if(!(y==="authorization"||y==="descriptor")){return Hs.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:y},message:"must NOT have additional properties"}],!1;break}if(h===a){if(t.authorization!==void 0){let y=a;Po(t.authorization,{instancePath:e+"/authorization",parentData:t,parentDataProperty:"authorization",rootData:i,dynamicAnchors:o})||(s=s===null?Po.errors:s.concat(Po.errors),a=s.length);var u=y===a}else var u=!0;if(u)if(t.descriptor!==void 0){let y=t.descriptor,g=a;if(a===g)if(y&&typeof y=="object"&&!Array.isArray(y)){let x;if(y.interface===void 0&&(x="interface")||y.method===void 0&&(x="method")||y.messageTimestamp===void 0&&(x="messageTimestamp")||y.filter===void 0&&(x="filter"))return Hs.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:x},message:"must have required property '"+x+"'"}],!1;{let S=a;for(let A in y)if(!(A==="interface"||A==="method"||A==="messageTimestamp"||A==="filter")){return Hs.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:A},message:"must NOT have additional properties"}],!1;break}if(S===a){if(y.interface!==void 0){let A=y.interface,T=a;if(typeof A!="string")return Hs.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(A!=="Records")return Hs.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:FW.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var c=T===a}else var c=!0;if(c){if(y.method!==void 0){let A=y.method,T=a;if(typeof A!="string")return Hs.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(A!=="Subscribe")return Hs.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:FW.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var c=T===a}else var c=!0;if(c){if(y.messageTimestamp!==void 0){let A=y.messageTimestamp,T=a;if(a===a)if(typeof A=="string"){if(!Ji.test(A))return Hs.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Hs.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=T===a}else var c=!0;if(c)if(y.filter!==void 0){let A=a;Xe(y.filter,{instancePath:e+"/descriptor/filter",parentData:y,parentDataProperty:"filter",rootData:i,dynamicAnchors:o})||(s=s===null?Xe.errors:s.concat(Xe.errors),a=s.length);var c=A===a}else var c=!0}}}}}else return Hs.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=g===a}else var u=!0}}}else return Hs.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Hs.errors=s,a===0}Hs.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var S6e=ig;function ig(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=ig.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),!ze(t,{instancePath:e,parentData:r,parentDataProperty:n,rootData:i,dynamicAnchors:o}))s=s===null?ze.errors:s.concat(ze.errors),a=s.length;else var u=ze.evaluated.props;if(a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.recordId===void 0&&(c="recordId")||t.authorization===void 0&&(c="authorization"))return ig.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;if(u!==!0){for(let l in t)if(!u||!u[l]){return ig.errors=[{instancePath:e,schemaPath:"#/unevaluatedProperties",keyword:"unevaluatedProperties",params:{unevaluatedProperty:l},message:"must NOT have unevaluated properties"}],!1;break}}}else return ig.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return ig.errors=s,a===0}ig.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var T6e=Ad,A6e=ze,k6e=Px;function Px(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Px.evaluated;return d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),t&&typeof t=="object"&&!Array.isArray(t)?(Px.errors=s,a===0):(Px.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1)}Px.evaluated={dynamicProps:!1,dynamicItems:!1};var P6e=is;function is(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=is.evaluated;d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0);let u=a,c=!1,l=null,h=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let j;if(t.crv===void 0&&(j="crv")||t.x===void 0&&(j="x")){let K={instancePath:e,schemaPath:"#/oneOf/0/required",keyword:"required",params:{missingProperty:j},message:"must have required property '"+j+"'"};s===null?s=[K]:s.push(K),a++}else{if(t.kty!==void 0){let K=a;if(t.kty!=="EC"){let F={instancePath:e+"/kty",schemaPath:"#/oneOf/0/properties/kty/const",keyword:"const",params:{allowedValue:"EC"},message:"must be equal to constant"};s===null?s=[F]:s.push(F),a++}var y=K===a}else var y=!0;if(y){if(t.crv!==void 0){let K=a;if(typeof t.crv!="string"){let L={instancePath:e+"/crv",schemaPath:"#/oneOf/0/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[L]:s.push(L),a++}var y=K===a}else var y=!0;if(y){if(t.x!==void 0){let K=a;if(typeof t.x!="string"){let L={instancePath:e+"/x",schemaPath:"#/oneOf/0/properties/x/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[L]:s.push(L),a++}var y=K===a}else var y=!0;if(y){if(t.y!==void 0){let K=a;if(typeof t.y!="string"){let L={instancePath:e+"/y",schemaPath:"#/oneOf/0/properties/y/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[L]:s.push(L),a++}var y=K===a}else var y=!0;if(y)if(t.d!==void 0){let K=a;if(typeof t.d!="string"){let L={instancePath:e+"/d",schemaPath:"#/oneOf/0/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[L]:s.push(L),a++}var y=K===a}else var y=!0}}}}}var S=h===a;if(S){c=!0,l=0;var g={};g.kty=!0,g.crv=!0,g.x=!0,g.y=!0,g.d=!0}let v=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let j;if(t.crv===void 0&&(j="crv")||t.x===void 0&&(j="x")){let K={instancePath:e,schemaPath:"#/oneOf/1/required",keyword:"required",params:{missingProperty:j},message:"must have required property '"+j+"'"};s===null?s=[K]:s.push(K),a++}else{if(t.kty!==void 0){let K=a;if(t.kty!=="OKP"){let F={instancePath:e+"/kty",schemaPath:"#/oneOf/1/properties/kty/const",keyword:"const",params:{allowedValue:"OKP"},message:"must be equal to constant"};s===null?s=[F]:s.push(F),a++}var x=K===a}else var x=!0;if(x){if(t.crv!==void 0){let K=a;if(typeof t.crv!="string"){let L={instancePath:e+"/crv",schemaPath:"#/oneOf/1/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[L]:s.push(L),a++}var x=K===a}else var x=!0;if(x){if(t.x!==void 0){let K=a;if(typeof t.x!="string"){let L={instancePath:e+"/x",schemaPath:"#/oneOf/1/properties/x/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[L]:s.push(L),a++}var x=K===a}else var x=!0;if(x)if(t.d!==void 0){let K=a;if(typeof t.d!="string"){let L={instancePath:e+"/d",schemaPath:"#/oneOf/1/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[L]:s.push(L),a++}var x=K===a}else var x=!0}}}}var S=v===a;if(S&&c)c=!1,l=[l,1];else{S&&(c=!0,l=1,g!==!0&&(g=g||{},g.kty=!0,g.crv=!0,g.x=!0,g.d=!0));let j=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let F;if(t.n===void 0&&(F="n")||t.e===void 0&&(F="e")){let L={instancePath:e,schemaPath:"#/oneOf/2/required",keyword:"required",params:{missingProperty:F},message:"must have required property '"+F+"'"};s===null?s=[L]:s.push(L),a++}else{if(t.kty!==void 0){let L=a;if(t.kty!=="RSA"){let V={instancePath:e+"/kty",schemaPath:"#/oneOf/2/properties/kty/const",keyword:"const",params:{allowedValue:"RSA"},message:"must be equal to constant"};s===null?s=[V]:s.push(V),a++}var A=L===a}else var A=!0;if(A){if(t.n!==void 0){let L=a;if(typeof t.n!="string"){let q={instancePath:e+"/n",schemaPath:"#/oneOf/2/properties/n/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[q]:s.push(q),a++}var A=L===a}else var A=!0;if(A){if(t.e!==void 0){let L=a;if(typeof t.e!="string"){let q={instancePath:e+"/e",schemaPath:"#/oneOf/2/properties/e/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[q]:s.push(q),a++}var A=L===a}else var A=!0;if(A){if(t.d!==void 0){let L=a;if(typeof t.d!="string"){let q={instancePath:e+"/d",schemaPath:"#/oneOf/2/properties/d/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[q]:s.push(q),a++}var A=L===a}else var A=!0;if(A){if(t.p!==void 0){let L=a;if(typeof t.p!="string"){let q={instancePath:e+"/p",schemaPath:"#/oneOf/2/properties/p/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[q]:s.push(q),a++}var A=L===a}else var A=!0;if(A){if(t.q!==void 0){let L=a;if(typeof t.q!="string"){let q={instancePath:e+"/q",schemaPath:"#/oneOf/2/properties/q/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[q]:s.push(q),a++}var A=L===a}else var A=!0;if(A){if(t.dp!==void 0){let L=a;if(typeof t.dp!="string"){let q={instancePath:e+"/dp",schemaPath:"#/oneOf/2/properties/dp/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[q]:s.push(q),a++}var A=L===a}else var A=!0;if(A){if(t.dq!==void 0){let L=a;if(typeof t.dq!="string"){let q={instancePath:e+"/dq",schemaPath:"#/oneOf/2/properties/dq/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[q]:s.push(q),a++}var A=L===a}else var A=!0;if(A){if(t.qi!==void 0){let L=a;if(typeof t.qi!="string"){let q={instancePath:e+"/qi",schemaPath:"#/oneOf/2/properties/qi/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[q]:s.push(q),a++}var A=L===a}else var A=!0;if(A)if(t.oth!==void 0){let L=t.oth,V=a;if(!(L&&typeof L=="object"&&!Array.isArray(L))){let k={instancePath:e+"/oth",schemaPath:"#/oneOf/2/properties/oth/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[k]:s.push(k),a++}var A=V===a}else var A=!0}}}}}}}}}}var S=j===a;if(S&&c)c=!1,l=[l,2];else{S&&(c=!0,l=2,g!==!0&&(g=g||{},g.kty=!0,g.n=!0,g.e=!0,g.d=!0,g.p=!0,g.q=!0,g.dp=!0,g.dq=!0,g.qi=!0,g.oth=!0));let F=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let V;if(t.k===void 0&&(V="k")){let q={instancePath:e,schemaPath:"#/oneOf/3/required",keyword:"required",params:{missingProperty:V},message:"must have required property '"+V+"'"};s===null?s=[q]:s.push(q),a++}else{if(t.kty!==void 0){let q=a;if(t.kty!=="oct"){let k={instancePath:e+"/kty",schemaPath:"#/oneOf/3/properties/kty/const",keyword:"const",params:{allowedValue:"oct"},message:"must be equal to constant"};s===null?s=[k]:s.push(k),a++}var T=q===a}else var T=!0;if(T)if(t.k!==void 0){let q=a;if(typeof t.k!="string"){let P={instancePath:e+"/k",schemaPath:"#/oneOf/3/properties/k/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[P]:s.push(P),a++}var T=q===a}else var T=!0}}var S=F===a;S&&c?(c=!1,l=[l,3]):S&&(c=!0,l=3,g!==!0&&(g=g||{},g.kty=!0,g.k=!0))}}if(c)a=u,s!==null&&(u?s.length=u:s=null);else{let j={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf"};return s===null?s=[j]:s.push(j),a++,is.errors=s,!1}if(a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let j;if(t.kty===void 0&&(j="kty"))return is.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:j},message:"must have required property '"+j+"'"}],!1;if(g!==!0&&(g=g||{},g.alg=!0,g.kid=!0,g.kty=!0,g.crv=!0,g.use=!0,g.key_ops=!0,g.x5u=!0,g.x5c=!0,g.x5t=!0,g["x5t#S256"]=!0),t.alg!==void 0){let K=a;if(typeof t.alg!="string")return is.errors=[{instancePath:e+"/alg",schemaPath:"#/properties/alg/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $=K===a}else var $=!0;if($){if(t.kid!==void 0){let K=a;if(typeof t.kid!="string")return is.errors=[{instancePath:e+"/kid",schemaPath:"#/properties/kid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $=K===a}else var $=!0;if($){if(t.kty!==void 0){let K=t.kty,F=a;if(!(K==="EC"||K==="RSA"||K==="oct"||K==="OKP"))return is.errors=[{instancePath:e+"/kty",schemaPath:"#/properties/kty/enum",keyword:"enum",params:{allowedValues:eG.properties.kty.enum},message:"must be equal to one of the allowed values"}],!1;var $=F===a}else var $=!0;if($){if(t.crv!==void 0){let K=a;if(typeof t.crv!="string")return is.errors=[{instancePath:e+"/crv",schemaPath:"#/properties/crv/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $=K===a}else var $=!0;if($){if(t.use!==void 0){let K=a;if(typeof t.use!="string")return is.errors=[{instancePath:e+"/use",schemaPath:"#/properties/use/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $=K===a}else var $=!0;if($){if(t.key_ops!==void 0){let K=a;if(typeof t.key_ops!="string")return is.errors=[{instancePath:e+"/key_ops",schemaPath:"#/properties/key_ops/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $=K===a}else var $=!0;if($){if(t.x5u!==void 0){let K=a;if(typeof t.x5u!="string")return is.errors=[{instancePath:e+"/x5u",schemaPath:"#/properties/x5u/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $=K===a}else var $=!0;if($){if(t.x5c!==void 0){let K=a;if(typeof t.x5c!="string")return is.errors=[{instancePath:e+"/x5c",schemaPath:"#/properties/x5c/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $=K===a}else var $=!0;if($){if(t.x5t!==void 0){let K=a;if(typeof t.x5t!="string")return is.errors=[{instancePath:e+"/x5t",schemaPath:"#/properties/x5t/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $=K===a}else var $=!0;if($)if(t["x5t#S256"]!==void 0){let K=a;if(typeof t["x5t#S256"]!="string")return is.errors=[{instancePath:e+"/x5t#S256",schemaPath:"#/properties/x5t%23S256/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var $=K===a}else var $=!0}}}}}}}}}else return is.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return is.errors=s,d.props=g,a===0}is.evaluated={dynamicProps:!0,dynamicItems:!1};var I6e=un,R6e=ku,B6e={$id:"https://identity.foundation/dwn/json-schemas/jwk-verification-method.json",$schema:"https://json-schema.org/draft/2020-12/schema",type:"object",additionalProperties:!1,required:["id","type","controller","publicKeyJwk"],properties:{id:{type:"string"},type:{enum:["JsonWebKey","JsonWebKey2020"]},controller:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"},publicKeyJwk:{$ref:"https://identity.foundation/dwn/json-schemas/public-jwk.json"}}};function ku(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=ku.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.id===void 0&&(c="id")||t.type===void 0&&(c="type")||t.controller===void 0&&(c="controller")||t.publicKeyJwk===void 0&&(c="publicKeyJwk"))return ku.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;{let l=a;for(let h in t)if(!(h==="id"||h==="type"||h==="controller"||h==="publicKeyJwk")){return ku.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"}],!1;break}if(l===a){if(t.id!==void 0){let h=a;if(typeof t.id!="string")return ku.errors=[{instancePath:e+"/id",schemaPath:"#/properties/id/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.type!==void 0){let h=t.type,y=a;if(!(h==="JsonWebKey"||h==="JsonWebKey2020"))return ku.errors=[{instancePath:e+"/type",schemaPath:"#/properties/type/enum",keyword:"enum",params:{allowedValues:B6e.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var u=y===a}else var u=!0;if(u){if(t.controller!==void 0){let h=t.controller,y=a;if(a===a)if(typeof h=="string"){if(!_y.test(h))return ku.errors=[{instancePath:e+"/controller",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return ku.errors=[{instancePath:e+"/controller",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=y===a}else var u=!0;if(u)if(t.publicKeyJwk!==void 0){let h=a;dn(t.publicKeyJwk,{instancePath:e+"/publicKeyJwk",parentData:t,parentDataProperty:"publicKeyJwk",rootData:i,dynamicAnchors:o})||(s=s===null?dn.errors:s.concat(dn.errors),a=s.length);var u=h===a}else var u=!0}}}}}else return ku.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return ku.errors=s,a===0}ku.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var O6e=Vn,zW={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/messages-filter.json",type:"object",additionalProperties:!1,minProperties:1,properties:{interface:{enum:["Protocols","Records"],type:"string"},method:{enum:["Configure","Delete","Write"],type:"string"},protocol:{type:"string"},messageTimestamp:{type:"object",minProperties:1,additionalProperties:!1,properties:{from:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},to:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"}}}}};function Vn(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Vn.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){if(Object.keys(t).length<1)return Vn.errors=[{instancePath:e,schemaPath:"#/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let l=a;for(let h in t)if(!(h==="interface"||h==="method"||h==="protocol"||h==="messageTimestamp")){return Vn.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"}],!1;break}if(l===a){if(t.interface!==void 0){let h=t.interface,y=a;if(typeof h!="string")return Vn.errors=[{instancePath:e+"/interface",schemaPath:"#/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(h==="Protocols"||h==="Records"))return Vn.errors=[{instancePath:e+"/interface",schemaPath:"#/properties/interface/enum",keyword:"enum",params:{allowedValues:zW.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var u=y===a}else var u=!0;if(u){if(t.method!==void 0){let h=t.method,y=a;if(typeof h!="string")return Vn.errors=[{instancePath:e+"/method",schemaPath:"#/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(h==="Configure"||h==="Delete"||h==="Write"))return Vn.errors=[{instancePath:e+"/method",schemaPath:"#/properties/method/enum",keyword:"enum",params:{allowedValues:zW.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var u=y===a}else var u=!0;if(u){if(t.protocol!==void 0){let h=a;if(typeof t.protocol!="string")return Vn.errors=[{instancePath:e+"/protocol",schemaPath:"#/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u)if(t.messageTimestamp!==void 0){let h=t.messageTimestamp,y=a;if(a===y)if(h&&typeof h=="object"&&!Array.isArray(h)){if(Object.keys(h).length<1)return Vn.errors=[{instancePath:e+"/messageTimestamp",schemaPath:"#/properties/messageTimestamp/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let v=a;for(let x in h)if(!(x==="from"||x==="to")){return Vn.errors=[{instancePath:e+"/messageTimestamp",schemaPath:"#/properties/messageTimestamp/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:x},message:"must NOT have additional properties"}],!1;break}if(v===a){if(h.from!==void 0){let x=h.from,S=a;if(a===a)if(typeof x=="string"){if(!Ji.test(x))return Vn.errors=[{instancePath:e+"/messageTimestamp/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Vn.errors=[{instancePath:e+"/messageTimestamp/from",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=S===a}else var c=!0;if(c)if(h.to!==void 0){let x=h.to,S=a;if(a===a)if(typeof x=="string"){if(!Ji.test(x))return Vn.errors=[{instancePath:e+"/messageTimestamp/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Vn.errors=[{instancePath:e+"/messageTimestamp/to",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=S===a}else var c=!0}}}else return Vn.errors=[{instancePath:e+"/messageTimestamp",schemaPath:"#/properties/messageTimestamp/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=y===a}else var u=!0}}}}}else return Vn.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Vn.errors=s,a===0}Vn.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var M6e=si,VW={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/messages-query.json",type:"object",additionalProperties:!1,required:["authorization","descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","filters"],properties:{interface:{enum:["Messages"],type:"string"},method:{enum:["Query"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},filters:{type:"array",items:{$ref:"https://identity.foundation/dwn/json-schemas/messages-filter.json"}},cursor:{$ref:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json"}}}}};function si(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=si.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let y;if(t.authorization===void 0&&(y="authorization")||t.descriptor===void 0&&(y="descriptor"))return si.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:y},message:"must have required property '"+y+"'"}],!1;{let g=a;for(let v in t)if(!(v==="authorization"||v==="descriptor")){return si.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:v},message:"must NOT have additional properties"}],!1;break}if(g===a){if(t.authorization!==void 0){let v=a;Mi(t.authorization,{instancePath:e+"/authorization",parentData:t,parentDataProperty:"authorization",rootData:i,dynamicAnchors:o})||(s=s===null?Mi.errors:s.concat(Mi.errors),a=s.length);var u=v===a}else var u=!0;if(u)if(t.descriptor!==void 0){let v=t.descriptor,x=a;if(a===x)if(v&&typeof v=="object"&&!Array.isArray(v)){let A;if(v.interface===void 0&&(A="interface")||v.method===void 0&&(A="method")||v.messageTimestamp===void 0&&(A="messageTimestamp")||v.filters===void 0&&(A="filters"))return si.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:A},message:"must have required property '"+A+"'"}],!1;{let T=a;for(let $ in v)if(!($==="interface"||$==="method"||$==="messageTimestamp"||$==="filters"||$==="cursor")){return si.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:$},message:"must NOT have additional properties"}],!1;break}if(T===a){if(v.interface!==void 0){let $=v.interface,j=a;if(typeof $!="string")return si.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if($!=="Messages")return si.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:VW.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var c=j===a}else var c=!0;if(c){if(v.method!==void 0){let $=v.method,j=a;if(typeof $!="string")return si.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if($!=="Query")return si.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:VW.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var c=j===a}else var c=!0;if(c){if(v.messageTimestamp!==void 0){let $=v.messageTimestamp,j=a;if(a===a)if(typeof $=="string"){if(!Ji.test($))return si.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return si.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=j===a}else var c=!0;if(c){if(v.filters!==void 0){let $=v.filters,j=a;if(a===j)if(Array.isArray($)){var l=!0;let F=$.length;for(let L=0;L<F;L++){let V=a;Vn($[L],{instancePath:e+"/descriptor/filters/"+L,parentData:$,parentDataProperty:L,rootData:i,dynamicAnchors:o})||(s=s===null?Vn.errors:s.concat(Vn.errors),a=s.length);var l=V===a;if(!l)break}}else return si.errors=[{instancePath:e+"/descriptor/filters",schemaPath:"#/properties/descriptor/properties/filters/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var c=j===a}else var c=!0;if(c)if(v.cursor!==void 0){let $=v.cursor,j=a;if(a===a)if($&&typeof $=="object"&&!Array.isArray($)){if(Object.keys($).length<1)return si.errors=[{instancePath:e+"/descriptor/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let L;if($.messageCid===void 0&&(L="messageCid")||$.value===void 0&&(L="value"))return si.errors=[{instancePath:e+"/descriptor/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/required",keyword:"required",params:{missingProperty:L},message:"must have required property '"+L+"'"}],!1;{let V=a;for(let q in $)if(!(q==="messageCid"||q==="value")){return si.errors=[{instancePath:e+"/descriptor/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:q},message:"must NOT have additional properties"}],!1;break}if(V===a){if($.messageCid!==void 0){let q=a;if(typeof $.messageCid!="string")return si.errors=[{instancePath:e+"/descriptor/cursor/messageCid",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/properties/messageCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var h=q===a}else var h=!0;if(h)if($.value!==void 0){let q=$.value,k=a;if(typeof q!="string"&&!(typeof q=="number"&&isFinite(q)))return si.errors=[{instancePath:e+"/descriptor/cursor/value",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/properties/value/type",keyword:"type",params:{type:EO.properties.value.type},message:"must be string,number"}],!1;var h=k===a}else var h=!0}}}}else return si.errors=[{instancePath:e+"/descriptor/cursor",schemaPath:"https://identity.foundation/dwn/json-schemas/pagination-cursor.json/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var c=j===a}else var c=!0}}}}}}else return si.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=x===a}else var u=!0}}}else return si.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return si.errors=s,a===0}si.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var D6e=os,HW={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/messages-read.json",type:"object",additionalProperties:!1,required:["authorization","descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp"],properties:{interface:{enum:["Messages"],type:"string"},method:{enum:["Read"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},messageCid:{type:"string"}}}}};function os(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=os.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.authorization===void 0&&(l="authorization")||t.descriptor===void 0&&(l="descriptor"))return os.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;{let h=a;for(let y in t)if(!(y==="authorization"||y==="descriptor")){return os.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:y},message:"must NOT have additional properties"}],!1;break}if(h===a){if(t.authorization!==void 0){let y=a;Mi(t.authorization,{instancePath:e+"/authorization",parentData:t,parentDataProperty:"authorization",rootData:i,dynamicAnchors:o})||(s=s===null?Mi.errors:s.concat(Mi.errors),a=s.length);var u=y===a}else var u=!0;if(u)if(t.descriptor!==void 0){let y=t.descriptor,g=a;if(a===g)if(y&&typeof y=="object"&&!Array.isArray(y)){let x;if(y.interface===void 0&&(x="interface")||y.method===void 0&&(x="method")||y.messageTimestamp===void 0&&(x="messageTimestamp"))return os.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:x},message:"must have required property '"+x+"'"}],!1;{let S=a;for(let A in y)if(!(A==="interface"||A==="method"||A==="messageTimestamp"||A==="messageCid")){return os.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:A},message:"must NOT have additional properties"}],!1;break}if(S===a){if(y.interface!==void 0){let A=y.interface,T=a;if(typeof A!="string")return os.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(A!=="Messages")return os.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:HW.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var c=T===a}else var c=!0;if(c){if(y.method!==void 0){let A=y.method,T=a;if(typeof A!="string")return os.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(A!=="Read")return os.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:HW.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var c=T===a}else var c=!0;if(c){if(y.messageTimestamp!==void 0){let A=y.messageTimestamp,T=a;if(a===a)if(typeof A=="string"){if(!Ji.test(A))return os.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return os.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=T===a}else var c=!0;if(c)if(y.messageCid!==void 0){let A=a;if(typeof y.messageCid!="string")return os.errors=[{instancePath:e+"/descriptor/messageCid",schemaPath:"#/properties/descriptor/properties/messageCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=A===a}else var c=!0}}}}}else return os.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=g===a}else var u=!0}}}else return os.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return os.errors=s,a===0}os.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var C6e=Ws,WW={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/messages-subscribe.json",type:"object",additionalProperties:!1,required:["descriptor","authorization"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","filters"],properties:{interface:{enum:["Messages"],type:"string"},method:{enum:["Subscribe"],type:"string"},messageTimestamp:{type:"string"},filters:{type:"array",items:{$ref:"https://identity.foundation/dwn/json-schemas/messages-filter.json"}}}}}};function Ws(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Ws.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let h;if(t.descriptor===void 0&&(h="descriptor")||t.authorization===void 0&&(h="authorization"))return Ws.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:h},message:"must have required property '"+h+"'"}],!1;{let y=a;for(let g in t)if(!(g==="authorization"||g==="descriptor")){return Ws.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:g},message:"must NOT have additional properties"}],!1;break}if(y===a){if(t.authorization!==void 0){let g=a;Mi(t.authorization,{instancePath:e+"/authorization",parentData:t,parentDataProperty:"authorization",rootData:i,dynamicAnchors:o})||(s=s===null?Mi.errors:s.concat(Mi.errors),a=s.length);var u=g===a}else var u=!0;if(u)if(t.descriptor!==void 0){let g=t.descriptor,v=a;if(a===v)if(g&&typeof g=="object"&&!Array.isArray(g)){let S;if(g.interface===void 0&&(S="interface")||g.method===void 0&&(S="method")||g.messageTimestamp===void 0&&(S="messageTimestamp")||g.filters===void 0&&(S="filters"))return Ws.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:S},message:"must have required property '"+S+"'"}],!1;{let A=a;for(let T in g)if(!(T==="interface"||T==="method"||T==="messageTimestamp"||T==="filters")){return Ws.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:T},message:"must NOT have additional properties"}],!1;break}if(A===a){if(g.interface!==void 0){let T=g.interface,$=a;if(typeof T!="string")return Ws.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(T!=="Messages")return Ws.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:WW.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var c=$===a}else var c=!0;if(c){if(g.method!==void 0){let T=g.method,$=a;if(typeof T!="string")return Ws.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(T!=="Subscribe")return Ws.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:WW.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var c=$===a}else var c=!0;if(c){if(g.messageTimestamp!==void 0){let T=a;if(typeof g.messageTimestamp!="string")return Ws.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"#/properties/descriptor/properties/messageTimestamp/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=T===a}else var c=!0;if(c)if(g.filters!==void 0){let T=g.filters,$=a;if(a===$)if(Array.isArray(T)){var l=!0;let K=T.length;for(let F=0;F<K;F++){let L=a;Vn(T[F],{instancePath:e+"/descriptor/filters/"+F,parentData:T,parentDataProperty:F,rootData:i,dynamicAnchors:o})||(s=s===null?Vn.errors:s.concat(Vn.errors),a=s.length);var l=L===a;if(!l)break}}else return Ws.errors=[{instancePath:e+"/descriptor/filters",schemaPath:"#/properties/descriptor/properties/filters/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var c=$===a}else var c=!0}}}}}else return Ws.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=v===a}else var u=!0}}}else return Ws.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Ws.errors=s,a===0}Ws.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var j6e=ka;function ka(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=ka.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){if(Object.keys(t).length<1)return ka.errors=[{instancePath:e,schemaPath:"#/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let v=a;for(let x in t)if(!(x==="gt"||x==="gte"||x==="lt"||x==="lte")){return ka.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:x},message:"must NOT have additional properties"}],!1;break}if(v===a){if(t.gt!==void 0){let x=a,S=a,A=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let T;if(t.gte===void 0&&(T="gte")){let $={};s===null?s=[$]:s.push($),a++}}var u=A===a;if(u)return ka.errors=[{instancePath:e,schemaPath:"#/dependencies/gt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=S,s!==null&&(S?s.length=S:s=null);var c=x===a}else var c=!0;if(c){if(t.gte!==void 0){let x=a,S=a,A=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let $;if(t.gt===void 0&&($="gt")){let j={};s===null?s=[j]:s.push(j),a++}}var l=A===a;if(l)return ka.errors=[{instancePath:e,schemaPath:"#/dependencies/gte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=S,s!==null&&(S?s.length=S:s=null);var c=x===a}else var c=!0;if(c){if(t.lt!==void 0){let x=a,S=a,A=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let $;if(t.lte===void 0&&($="lte")){let j={};s===null?s=[j]:s.push(j),a++}}var h=A===a;if(h)return ka.errors=[{instancePath:e,schemaPath:"#/dependencies/lt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=S,s!==null&&(S?s.length=S:s=null);var c=x===a}else var c=!0;if(c){if(t.lte!==void 0){let x=a,S=a,A=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let $;if(t.lt===void 0&&($="lt")){let j={};s===null?s=[j]:s.push(j),a++}}var y=A===a;if(y)return ka.errors=[{instancePath:e,schemaPath:"#/dependencies/lte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=S,s!==null&&(S?s.length=S:s=null);var c=x===a}else var c=!0;if(c){if(t.gt!==void 0){let x=t.gt,S=a;if(!(typeof x=="number"&&isFinite(x)))return ka.errors=[{instancePath:e+"/gt",schemaPath:"#/properties/gt/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var g=S===a}else var g=!0;if(g){if(t.gte!==void 0){let x=t.gte,S=a;if(!(typeof x=="number"&&isFinite(x)))return ka.errors=[{instancePath:e+"/gte",schemaPath:"#/properties/gte/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var g=S===a}else var g=!0;if(g){if(t.lt!==void 0){let x=t.lt,S=a;if(!(typeof x=="number"&&isFinite(x)))return ka.errors=[{instancePath:e+"/lt",schemaPath:"#/properties/lt/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var g=S===a}else var g=!0;if(g)if(t.lte!==void 0){let x=t.lte,S=a;if(!(typeof x=="number"&&isFinite(x)))return ka.errors=[{instancePath:e+"/lte",schemaPath:"#/properties/lte/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var g=S===a}else var g=!0}}}}}}}}}else return ka.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return ka.errors=s,a===0}ka.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var $6e=$l;function $l(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=$l.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){if(Object.keys(t).length<1)return $l.errors=[{instancePath:e,schemaPath:"#/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let c;if(t.messageCid===void 0&&(c="messageCid")||t.value===void 0&&(c="value"))return $l.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;{let l=a;for(let h in t)if(!(h==="messageCid"||h==="value")){return $l.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"}],!1;break}if(l===a){if(t.messageCid!==void 0){let h=a;if(typeof t.messageCid!="string")return $l.errors=[{instancePath:e+"/messageCid",schemaPath:"#/properties/messageCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u)if(t.value!==void 0){let h=t.value,y=a;if(typeof h!="string"&&!(typeof h=="number"&&isFinite(h)))return $l.errors=[{instancePath:e+"/value",schemaPath:"#/properties/value/type",keyword:"type",params:{type:EO.properties.value.type},message:"must be string,number"}],!1;var u=y===a}else var u=!0}}}}else return $l.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return $l.errors=s,a===0}$l.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var N6e=Gs;var rG={type:"object",additionalProperties:!1,properties:{publication:{enum:["Required","Prohibited"],type:"string"}}};function ag(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=ag.evaluated;d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0);let u=a,c=!1,l=null,h=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let k;if(t.interface===void 0&&(k="interface")||t.method===void 0&&(k="method")){let P={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/required",keyword:"required",params:{missingProperty:k},message:"must have required property '"+k+"'"};s===null?s=[P]:s.push(P),a++}else{let P=a;for(let B in t)if(!(B==="interface"||B==="method"||B==="protocol")){let p={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:B},message:"must NOT have additional properties"};s===null?s=[p]:s.push(p),a++;break}if(P===a){if(t.interface!==void 0){let B=a;if(t.interface!=="Messages"){let p={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};s===null?s=[p]:s.push(p),a++}var g=B===a}else var g=!0;if(g){if(t.method!==void 0){let B=a;if(t.method!=="Query"){let m={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};s===null?s=[m]:s.push(m),a++}var g=B===a}else var g=!0;if(g)if(t.protocol!==void 0){let B=a;if(typeof t.protocol!="string"){let m={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[m]:s.push(m),a++}var g=B===a}else var g=!0}}}}else{let k={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[k]:s.push(k),a++}var T=h===a;if(T){c=!0,l=0;var v=!0}let x=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let k;if(t.interface===void 0&&(k="interface")||t.method===void 0&&(k="method")){let P={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/required",keyword:"required",params:{missingProperty:k},message:"must have required property '"+k+"'"};s===null?s=[P]:s.push(P),a++}else{let P=a;for(let B in t)if(!(B==="interface"||B==="method"||B==="protocol")){let p={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:B},message:"must NOT have additional properties"};s===null?s=[p]:s.push(p),a++;break}if(P===a){if(t.interface!==void 0){let B=a;if(t.interface!=="Messages"){let p={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};s===null?s=[p]:s.push(p),a++}var A=B===a}else var A=!0;if(A){if(t.method!==void 0){let B=a;if(t.method!=="Read"){let m={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/method/const",keyword:"const",params:{allowedValue:"Read"},message:"must be equal to constant"};s===null?s=[m]:s.push(m),a++}var A=B===a}else var A=!0;if(A)if(t.protocol!==void 0){let B=a;if(typeof t.protocol!="string"){let m={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[m]:s.push(m),a++}var A=B===a}else var A=!0}}}}else{let k={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[k]:s.push(k),a++}var T=x===a;if(T&&c)c=!1,l=[l,1];else{T&&(c=!0,l=1,v!==!0&&(v=!0));let k=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let p;if(t.interface===void 0&&(p="interface")||t.method===void 0&&(p="method")){let m={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"};s===null?s=[m]:s.push(m),a++}else{let m=a;for(let w in t)if(!(w==="interface"||w==="method"||w==="protocol")){let E={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:w},message:"must NOT have additional properties"};s===null?s=[E]:s.push(E),a++;break}if(m===a){if(t.interface!==void 0){let w=a;if(t.interface!=="Messages"){let E={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};s===null?s=[E]:s.push(E),a++}var $=w===a}else var $=!0;if($){if(t.method!==void 0){let w=a;if(t.method!=="Subscribe"){let _={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/method/const",keyword:"const",params:{allowedValue:"Subscribe"},message:"must be equal to constant"};s===null?s=[_]:s.push(_),a++}var $=w===a}else var $=!0;if($)if(t.protocol!==void 0){let w=a;if(typeof t.protocol!="string"){let _={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[_]:s.push(_),a++}var $=w===a}else var $=!0}}}}else{let p={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[p]:s.push(p),a++}var T=k===a;if(T&&c)c=!1,l=[l,2];else{T&&(c=!0,l=2,v!==!0&&(v=!0));let p=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let E;if(t.interface===void 0&&(E="interface")||t.method===void 0&&(E="method")){let _={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/required",keyword:"required",params:{missingProperty:E},message:"must have required property '"+E+"'"};s===null?s=[_]:s.push(_),a++}else{let _=a;for(let b in t)if(!(b==="interface"||b==="method")){let C={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:b},message:"must NOT have additional properties"};s===null?s=[C]:s.push(C),a++;break}if(_===a){if(t.interface!==void 0){let b=a;if(t.interface!=="Protocols"){let C={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Protocols"},message:"must be equal to constant"};s===null?s=[C]:s.push(C),a++}var j=b===a}else var j=!0;if(j)if(t.method!==void 0){let b=a;if(t.method!=="Query"){let N={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};s===null?s=[N]:s.push(N),a++}var j=b===a}else var j=!0}}}else{let E={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[E]:s.push(E),a++}var T=p===a;if(T&&c)c=!1,l=[l,3];else{T&&(c=!0,l=3,v!==!0&&(v=!0));let E=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let C;if(t.interface===void 0&&(C="interface")||t.method===void 0&&(C="method")){let N={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/required",keyword:"required",params:{missingProperty:C},message:"must have required property '"+C+"'"};s===null?s=[N]:s.push(N),a++}else{let N=a;for(let D in t)if(!(D==="interface"||D==="method"||D==="protocol"||D==="contextId"||D==="protocolPath")){let U={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:D},message:"must NOT have additional properties"};s===null?s=[U]:s.push(U),a++;break}if(N===a){if(t.interface!==void 0){let D=a;if(t.interface!=="Records"){let U={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};s===null?s=[U]:s.push(U),a++}var K=D===a}else var K=!0;if(K){if(t.method!==void 0){let D=a;if(t.method!=="Read"){let G={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/method/const",keyword:"const",params:{allowedValue:"Read"},message:"must be equal to constant"};s===null?s=[G]:s.push(G),a++}var K=D===a}else var K=!0;if(K){if(t.protocol!==void 0){let D=a;if(typeof t.protocol!="string"){let G={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[G]:s.push(G),a++}var K=D===a}else var K=!0;if(K){if(t.contextId!==void 0){let D=a;if(typeof t.contextId!="string"){let G={instancePath:e+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[G]:s.push(G),a++}var K=D===a}else var K=!0;if(K)if(t.protocolPath!==void 0){let D=a;if(typeof t.protocolPath!="string"){let G={instancePath:e+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[G]:s.push(G),a++}var K=D===a}else var K=!0}}}}}}else{let C={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[C]:s.push(C),a++}var T=E===a;if(T&&c)c=!1,l=[l,4];else{T&&(c=!0,l=4,v!==!0&&(v=!0));let C=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let U;if(t.interface===void 0&&(U="interface")||t.method===void 0&&(U="method")){let G={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/required",keyword:"required",params:{missingProperty:U},message:"must have required property '"+U+"'"};s===null?s=[G]:s.push(G),a++}else{let G=a;for(let Y in t)if(!(Y==="interface"||Y==="method"||Y==="protocol"||Y==="contextId"||Y==="protocolPath")){let J={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Y},message:"must NOT have additional properties"};s===null?s=[J]:s.push(J),a++;break}if(G===a){if(t.interface!==void 0){let Y=a;if(t.interface!=="Records"){let J={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};s===null?s=[J]:s.push(J),a++}var F=Y===a}else var F=!0;if(F){if(t.method!==void 0){let Y=a;if(t.method!=="Delete"){let H={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/method/const",keyword:"const",params:{allowedValue:"Delete"},message:"must be equal to constant"};s===null?s=[H]:s.push(H),a++}var F=Y===a}else var F=!0;if(F){if(t.protocol!==void 0){let Y=a;if(typeof t.protocol!="string"){let H={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[H]:s.push(H),a++}var F=Y===a}else var F=!0;if(F){if(t.contextId!==void 0){let Y=a;if(typeof t.contextId!="string"){let H={instancePath:e+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[H]:s.push(H),a++}var F=Y===a}else var F=!0;if(F)if(t.protocolPath!==void 0){let Y=a;if(typeof t.protocolPath!="string"){let H={instancePath:e+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[H]:s.push(H),a++}var F=Y===a}else var F=!0}}}}}}else{let U={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[U]:s.push(U),a++}var T=C===a;if(T&&c)c=!1,l=[l,5];else{T&&(c=!0,l=5,v!==!0&&(v=!0));let U=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let J;if(t.interface===void 0&&(J="interface")||t.method===void 0&&(J="method")){let H={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/required",keyword:"required",params:{missingProperty:J},message:"must have required property '"+J+"'"};s===null?s=[H]:s.push(H),a++}else{let H=a;for(let X in t)if(!(X==="interface"||X==="method"||X==="protocol"||X==="contextId"||X==="protocolPath")){let te={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:X},message:"must NOT have additional properties"};s===null?s=[te]:s.push(te),a++;break}if(H===a){if(t.interface!==void 0){let X=a;if(t.interface!=="Records"){let te={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};s===null?s=[te]:s.push(te),a++}var L=X===a}else var L=!0;if(L){if(t.method!==void 0){let X=a;if(t.method!=="Write"){let ne={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/method/const",keyword:"const",params:{allowedValue:"Write"},message:"must be equal to constant"};s===null?s=[ne]:s.push(ne),a++}var L=X===a}else var L=!0;if(L){if(t.protocol!==void 0){let X=a;if(typeof t.protocol!="string"){let ne={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ne]:s.push(ne),a++}var L=X===a}else var L=!0;if(L){if(t.contextId!==void 0){let X=a;if(typeof t.contextId!="string"){let ne={instancePath:e+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ne]:s.push(ne),a++}var L=X===a}else var L=!0;if(L)if(t.protocolPath!==void 0){let X=a;if(typeof t.protocolPath!="string"){let ne={instancePath:e+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ne]:s.push(ne),a++}var L=X===a}else var L=!0}}}}}}else{let J={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[J]:s.push(J),a++}var T=U===a;if(T&&c)c=!1,l=[l,6];else{T&&(c=!0,l=6,v!==!0&&(v=!0));let J=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let te;if(t.interface===void 0&&(te="interface")||t.method===void 0&&(te="method")){let ne={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/required",keyword:"required",params:{missingProperty:te},message:"must have required property '"+te+"'"};s===null?s=[ne]:s.push(ne),a++}else{let ne=a;for(let Q in t)if(!(Q==="interface"||Q==="method"||Q==="protocol"||Q==="contextId"||Q==="protocolPath")){let re={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Q},message:"must NOT have additional properties"};s===null?s=[re]:s.push(re),a++;break}if(ne===a){if(t.interface!==void 0){let Q=a;if(t.interface!=="Records"){let re={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};s===null?s=[re]:s.push(re),a++}var V=Q===a}else var V=!0;if(V){if(t.method!==void 0){let Q=a;if(t.method!=="Query"){let ae={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};s===null?s=[ae]:s.push(ae),a++}var V=Q===a}else var V=!0;if(V){if(t.protocol!==void 0){let Q=a;if(typeof t.protocol!="string"){let ae={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ae]:s.push(ae),a++}var V=Q===a}else var V=!0;if(V){if(t.contextId!==void 0){let Q=a;if(typeof t.contextId!="string"){let ae={instancePath:e+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ae]:s.push(ae),a++}var V=Q===a}else var V=!0;if(V)if(t.protocolPath!==void 0){let Q=a;if(typeof t.protocolPath!="string"){let ae={instancePath:e+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ae]:s.push(ae),a++}var V=Q===a}else var V=!0}}}}}}else{let te={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[te]:s.push(te),a++}var T=J===a;if(T&&c)c=!1,l=[l,7];else{T&&(c=!0,l=7,v!==!0&&(v=!0));let te=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let re;if(t.interface===void 0&&(re="interface")||t.method===void 0&&(re="method")){let ae={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/required",keyword:"required",params:{missingProperty:re},message:"must have required property '"+re+"'"};s===null?s=[ae]:s.push(ae),a++}else{let ae=a;for(let he in t)if(!(he==="interface"||he==="method"||he==="protocol"||he==="contextId"||he==="protocolPath")){let ge={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:he},message:"must NOT have additional properties"};s===null?s=[ge]:s.push(ge),a++;break}if(ae===a){if(t.interface!==void 0){let he=a;if(t.interface!=="Records"){let ge={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};s===null?s=[ge]:s.push(ge),a++}var q=he===a}else var q=!0;if(q){if(t.method!==void 0){let he=a;if(t.method!=="Subscribe"){let ie={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/method/const",keyword:"const",params:{allowedValue:"Subscribe"},message:"must be equal to constant"};s===null?s=[ie]:s.push(ie),a++}var q=he===a}else var q=!0;if(q){if(t.protocol!==void 0){let he=a;if(typeof t.protocol!="string"){let ie={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ie]:s.push(ie),a++}var q=he===a}else var q=!0;if(q){if(t.contextId!==void 0){let he=a;if(typeof t.contextId!="string"){let ie={instancePath:e+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ie]:s.push(ie),a++}var q=he===a}else var q=!0;if(q)if(t.protocolPath!==void 0){let he=a;if(typeof t.protocolPath!="string"){let ie={instancePath:e+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ie]:s.push(ie),a++}var q=he===a}else var q=!0}}}}}}else{let re={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[re]:s.push(re),a++}var T=te===a;T&&c?(c=!1,l=[l,8]):T&&(c=!0,l=8,v!==!0&&(v=!0))}}}}}}}if(c)a=u,s!==null&&(u?s.length=u:s=null);else{let k={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf"};return s===null?s=[k]:s.push(k),a++,ag.errors=s,!1}return ag.errors=s,d.props=v,a===0}ag.evaluated={dynamicProps:!0,dynamicItems:!1};function Gs(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Gs.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.dateExpires===void 0&&(c="dateExpires")||t.scope===void 0&&(c="scope"))return Gs.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;{let l=a;for(let h in t)if(!(h==="description"||h==="dateExpires"||h==="requestId"||h==="delegated"||h==="scope"||h==="conditions")){return Gs.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"}],!1;break}if(l===a){if(t.description!==void 0){let h=a;if(typeof t.description!="string")return Gs.errors=[{instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.dateExpires!==void 0){let h=t.dateExpires,y=a;if(a===a)if(typeof h=="string"){if(!Ji.test(h))return Gs.errors=[{instancePath:e+"/dateExpires",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Gs.errors=[{instancePath:e+"/dateExpires",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=y===a}else var u=!0;if(u){if(t.requestId!==void 0){let h=a;if(typeof t.requestId!="string")return Gs.errors=[{instancePath:e+"/requestId",schemaPath:"#/properties/requestId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.delegated!==void 0){let h=a;if(typeof t.delegated!="boolean")return Gs.errors=[{instancePath:e+"/delegated",schemaPath:"#/properties/delegated/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var u=h===a}else var u=!0;if(u){if(t.scope!==void 0){let h=a;ag(t.scope,{instancePath:e+"/scope",parentData:t,parentDataProperty:"scope",rootData:i,dynamicAnchors:o})||(s=s===null?ag.errors:s.concat(ag.errors),a=s.length);var u=h===a}else var u=!0;if(u)if(t.conditions!==void 0){let h=t.conditions,y=a;if(a===a)if(h&&typeof h=="object"&&!Array.isArray(h)){let x=a;for(let S in h)if(S!=="publication"){return Gs.errors=[{instancePath:e+"/conditions",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:S},message:"must NOT have additional properties"}],!1;break}if(x===a&&h.publication!==void 0){let S=h.publication;if(typeof S!="string")return Gs.errors=[{instancePath:e+"/conditions/publication",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/properties/publication/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(S==="Required"||S==="Prohibited"))return Gs.errors=[{instancePath:e+"/conditions/publication",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/properties/publication/enum",keyword:"enum",params:{allowedValues:rG.properties.publication.enum},message:"must be equal to one of the allowed values"}],!1}}else return Gs.errors=[{instancePath:e+"/conditions",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=y===a}else var u=!0}}}}}}}else return Gs.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Gs.errors=s,a===0}Gs.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var U6e=Dc;function cg(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=cg.evaluated;d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0);let u=a,c=!1,l=null,h=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let k;if(t.interface===void 0&&(k="interface")||t.method===void 0&&(k="method")){let P={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/required",keyword:"required",params:{missingProperty:k},message:"must have required property '"+k+"'"};s===null?s=[P]:s.push(P),a++}else{let P=a;for(let B in t)if(!(B==="interface"||B==="method"||B==="protocol")){let p={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:B},message:"must NOT have additional properties"};s===null?s=[p]:s.push(p),a++;break}if(P===a){if(t.interface!==void 0){let B=a;if(t.interface!=="Messages"){let p={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};s===null?s=[p]:s.push(p),a++}var g=B===a}else var g=!0;if(g){if(t.method!==void 0){let B=a;if(t.method!=="Query"){let m={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};s===null?s=[m]:s.push(m),a++}var g=B===a}else var g=!0;if(g)if(t.protocol!==void 0){let B=a;if(typeof t.protocol!="string"){let m={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[m]:s.push(m),a++}var g=B===a}else var g=!0}}}}else{let k={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[k]:s.push(k),a++}var T=h===a;if(T){c=!0,l=0;var v=!0}let x=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let k;if(t.interface===void 0&&(k="interface")||t.method===void 0&&(k="method")){let P={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/required",keyword:"required",params:{missingProperty:k},message:"must have required property '"+k+"'"};s===null?s=[P]:s.push(P),a++}else{let P=a;for(let B in t)if(!(B==="interface"||B==="method"||B==="protocol")){let p={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:B},message:"must NOT have additional properties"};s===null?s=[p]:s.push(p),a++;break}if(P===a){if(t.interface!==void 0){let B=a;if(t.interface!=="Messages"){let p={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};s===null?s=[p]:s.push(p),a++}var A=B===a}else var A=!0;if(A){if(t.method!==void 0){let B=a;if(t.method!=="Read"){let m={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/method/const",keyword:"const",params:{allowedValue:"Read"},message:"must be equal to constant"};s===null?s=[m]:s.push(m),a++}var A=B===a}else var A=!0;if(A)if(t.protocol!==void 0){let B=a;if(typeof t.protocol!="string"){let m={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[m]:s.push(m),a++}var A=B===a}else var A=!0}}}}else{let k={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-read-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[k]:s.push(k),a++}var T=x===a;if(T&&c)c=!1,l=[l,1];else{T&&(c=!0,l=1,v!==!0&&(v=!0));let k=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let p;if(t.interface===void 0&&(p="interface")||t.method===void 0&&(p="method")){let m={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/required",keyword:"required",params:{missingProperty:p},message:"must have required property '"+p+"'"};s===null?s=[m]:s.push(m),a++}else{let m=a;for(let w in t)if(!(w==="interface"||w==="method"||w==="protocol")){let E={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:w},message:"must NOT have additional properties"};s===null?s=[E]:s.push(E),a++;break}if(m===a){if(t.interface!==void 0){let w=a;if(t.interface!=="Messages"){let E={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Messages"},message:"must be equal to constant"};s===null?s=[E]:s.push(E),a++}var $=w===a}else var $=!0;if($){if(t.method!==void 0){let w=a;if(t.method!=="Subscribe"){let _={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/method/const",keyword:"const",params:{allowedValue:"Subscribe"},message:"must be equal to constant"};s===null?s=[_]:s.push(_),a++}var $=w===a}else var $=!0;if($)if(t.protocol!==void 0){let w=a;if(typeof t.protocol!="string"){let _={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[_]:s.push(_),a++}var $=w===a}else var $=!0}}}}else{let p={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/messages-subscribe-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[p]:s.push(p),a++}var T=k===a;if(T&&c)c=!1,l=[l,2];else{T&&(c=!0,l=2,v!==!0&&(v=!0));let p=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let E;if(t.interface===void 0&&(E="interface")||t.method===void 0&&(E="method")){let _={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/required",keyword:"required",params:{missingProperty:E},message:"must have required property '"+E+"'"};s===null?s=[_]:s.push(_),a++}else{let _=a;for(let b in t)if(!(b==="interface"||b==="method")){let C={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:b},message:"must NOT have additional properties"};s===null?s=[C]:s.push(C),a++;break}if(_===a){if(t.interface!==void 0){let b=a;if(t.interface!=="Protocols"){let C={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Protocols"},message:"must be equal to constant"};s===null?s=[C]:s.push(C),a++}var j=b===a}else var j=!0;if(j)if(t.method!==void 0){let b=a;if(t.method!=="Query"){let N={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};s===null?s=[N]:s.push(N),a++}var j=b===a}else var j=!0}}}else{let E={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/protocols-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[E]:s.push(E),a++}var T=p===a;if(T&&c)c=!1,l=[l,3];else{T&&(c=!0,l=3,v!==!0&&(v=!0));let E=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let C;if(t.interface===void 0&&(C="interface")||t.method===void 0&&(C="method")){let N={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/required",keyword:"required",params:{missingProperty:C},message:"must have required property '"+C+"'"};s===null?s=[N]:s.push(N),a++}else{let N=a;for(let D in t)if(!(D==="interface"||D==="method"||D==="protocol"||D==="contextId"||D==="protocolPath")){let U={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:D},message:"must NOT have additional properties"};s===null?s=[U]:s.push(U),a++;break}if(N===a){if(t.interface!==void 0){let D=a;if(t.interface!=="Records"){let U={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};s===null?s=[U]:s.push(U),a++}var K=D===a}else var K=!0;if(K){if(t.method!==void 0){let D=a;if(t.method!=="Read"){let G={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/method/const",keyword:"const",params:{allowedValue:"Read"},message:"must be equal to constant"};s===null?s=[G]:s.push(G),a++}var K=D===a}else var K=!0;if(K){if(t.protocol!==void 0){let D=a;if(typeof t.protocol!="string"){let G={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[G]:s.push(G),a++}var K=D===a}else var K=!0;if(K){if(t.contextId!==void 0){let D=a;if(typeof t.contextId!="string"){let G={instancePath:e+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[G]:s.push(G),a++}var K=D===a}else var K=!0;if(K)if(t.protocolPath!==void 0){let D=a;if(typeof t.protocolPath!="string"){let G={instancePath:e+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[G]:s.push(G),a++}var K=D===a}else var K=!0}}}}}}else{let C={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-read-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[C]:s.push(C),a++}var T=E===a;if(T&&c)c=!1,l=[l,4];else{T&&(c=!0,l=4,v!==!0&&(v=!0));let C=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let U;if(t.interface===void 0&&(U="interface")||t.method===void 0&&(U="method")){let G={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/required",keyword:"required",params:{missingProperty:U},message:"must have required property '"+U+"'"};s===null?s=[G]:s.push(G),a++}else{let G=a;for(let Y in t)if(!(Y==="interface"||Y==="method"||Y==="protocol"||Y==="contextId"||Y==="protocolPath")){let J={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Y},message:"must NOT have additional properties"};s===null?s=[J]:s.push(J),a++;break}if(G===a){if(t.interface!==void 0){let Y=a;if(t.interface!=="Records"){let J={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};s===null?s=[J]:s.push(J),a++}var F=Y===a}else var F=!0;if(F){if(t.method!==void 0){let Y=a;if(t.method!=="Delete"){let H={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/method/const",keyword:"const",params:{allowedValue:"Delete"},message:"must be equal to constant"};s===null?s=[H]:s.push(H),a++}var F=Y===a}else var F=!0;if(F){if(t.protocol!==void 0){let Y=a;if(typeof t.protocol!="string"){let H={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[H]:s.push(H),a++}var F=Y===a}else var F=!0;if(F){if(t.contextId!==void 0){let Y=a;if(typeof t.contextId!="string"){let H={instancePath:e+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[H]:s.push(H),a++}var F=Y===a}else var F=!0;if(F)if(t.protocolPath!==void 0){let Y=a;if(typeof t.protocolPath!="string"){let H={instancePath:e+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[H]:s.push(H),a++}var F=Y===a}else var F=!0}}}}}}else{let U={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-delete-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[U]:s.push(U),a++}var T=C===a;if(T&&c)c=!1,l=[l,5];else{T&&(c=!0,l=5,v!==!0&&(v=!0));let U=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let J;if(t.interface===void 0&&(J="interface")||t.method===void 0&&(J="method")){let H={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/required",keyword:"required",params:{missingProperty:J},message:"must have required property '"+J+"'"};s===null?s=[H]:s.push(H),a++}else{let H=a;for(let X in t)if(!(X==="interface"||X==="method"||X==="protocol"||X==="contextId"||X==="protocolPath")){let te={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:X},message:"must NOT have additional properties"};s===null?s=[te]:s.push(te),a++;break}if(H===a){if(t.interface!==void 0){let X=a;if(t.interface!=="Records"){let te={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};s===null?s=[te]:s.push(te),a++}var L=X===a}else var L=!0;if(L){if(t.method!==void 0){let X=a;if(t.method!=="Write"){let ne={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/method/const",keyword:"const",params:{allowedValue:"Write"},message:"must be equal to constant"};s===null?s=[ne]:s.push(ne),a++}var L=X===a}else var L=!0;if(L){if(t.protocol!==void 0){let X=a;if(typeof t.protocol!="string"){let ne={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ne]:s.push(ne),a++}var L=X===a}else var L=!0;if(L){if(t.contextId!==void 0){let X=a;if(typeof t.contextId!="string"){let ne={instancePath:e+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ne]:s.push(ne),a++}var L=X===a}else var L=!0;if(L)if(t.protocolPath!==void 0){let X=a;if(typeof t.protocolPath!="string"){let ne={instancePath:e+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ne]:s.push(ne),a++}var L=X===a}else var L=!0}}}}}}else{let J={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-write-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[J]:s.push(J),a++}var T=U===a;if(T&&c)c=!1,l=[l,6];else{T&&(c=!0,l=6,v!==!0&&(v=!0));let J=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let te;if(t.interface===void 0&&(te="interface")||t.method===void 0&&(te="method")){let ne={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/required",keyword:"required",params:{missingProperty:te},message:"must have required property '"+te+"'"};s===null?s=[ne]:s.push(ne),a++}else{let ne=a;for(let Q in t)if(!(Q==="interface"||Q==="method"||Q==="protocol"||Q==="contextId"||Q==="protocolPath")){let re={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:Q},message:"must NOT have additional properties"};s===null?s=[re]:s.push(re),a++;break}if(ne===a){if(t.interface!==void 0){let Q=a;if(t.interface!=="Records"){let re={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};s===null?s=[re]:s.push(re),a++}var V=Q===a}else var V=!0;if(V){if(t.method!==void 0){let Q=a;if(t.method!=="Query"){let ae={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/method/const",keyword:"const",params:{allowedValue:"Query"},message:"must be equal to constant"};s===null?s=[ae]:s.push(ae),a++}var V=Q===a}else var V=!0;if(V){if(t.protocol!==void 0){let Q=a;if(typeof t.protocol!="string"){let ae={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ae]:s.push(ae),a++}var V=Q===a}else var V=!0;if(V){if(t.contextId!==void 0){let Q=a;if(typeof t.contextId!="string"){let ae={instancePath:e+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ae]:s.push(ae),a++}var V=Q===a}else var V=!0;if(V)if(t.protocolPath!==void 0){let Q=a;if(typeof t.protocolPath!="string"){let ae={instancePath:e+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ae]:s.push(ae),a++}var V=Q===a}else var V=!0}}}}}}else{let te={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-query-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[te]:s.push(te),a++}var T=J===a;if(T&&c)c=!1,l=[l,7];else{T&&(c=!0,l=7,v!==!0&&(v=!0));let te=a;if(a===a)if(t&&typeof t=="object"&&!Array.isArray(t)){let re;if(t.interface===void 0&&(re="interface")||t.method===void 0&&(re="method")){let ae={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/required",keyword:"required",params:{missingProperty:re},message:"must have required property '"+re+"'"};s===null?s=[ae]:s.push(ae),a++}else{let ae=a;for(let he in t)if(!(he==="interface"||he==="method"||he==="protocol"||he==="contextId"||he==="protocolPath")){let ge={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:he},message:"must NOT have additional properties"};s===null?s=[ge]:s.push(ge),a++;break}if(ae===a){if(t.interface!==void 0){let he=a;if(t.interface!=="Records"){let ge={instancePath:e+"/interface",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/interface/const",keyword:"const",params:{allowedValue:"Records"},message:"must be equal to constant"};s===null?s=[ge]:s.push(ge),a++}var q=he===a}else var q=!0;if(q){if(t.method!==void 0){let he=a;if(t.method!=="Subscribe"){let ie={instancePath:e+"/method",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/method/const",keyword:"const",params:{allowedValue:"Subscribe"},message:"must be equal to constant"};s===null?s=[ie]:s.push(ie),a++}var q=he===a}else var q=!0;if(q){if(t.protocol!==void 0){let he=a;if(typeof t.protocol!="string"){let ie={instancePath:e+"/protocol",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ie]:s.push(ie),a++}var q=he===a}else var q=!0;if(q){if(t.contextId!==void 0){let he=a;if(typeof t.contextId!="string"){let ie={instancePath:e+"/contextId",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ie]:s.push(ie),a++}var q=he===a}else var q=!0;if(q)if(t.protocolPath!==void 0){let he=a;if(typeof t.protocolPath!="string"){let ie={instancePath:e+"/protocolPath",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/properties/protocolPath/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ie]:s.push(ie),a++}var q=he===a}else var q=!0}}}}}}else{let re={instancePath:e,schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/scopes.json#/$defs/records-subscribe-scope/type",keyword:"type",params:{type:"object"},message:"must be object"};s===null?s=[re]:s.push(re),a++}var T=te===a;T&&c?(c=!1,l=[l,8]):T&&(c=!0,l=8,v!==!0&&(v=!0))}}}}}}}if(c)a=u,s!==null&&(u?s.length=u:s=null);else{let k={instancePath:e,schemaPath:"#/oneOf",keyword:"oneOf",params:{passingSchemas:l},message:"must match exactly one schema in oneOf"};return s===null?s=[k]:s.push(k),a++,cg.errors=s,!1}return cg.errors=s,d.props=v,a===0}cg.evaluated={dynamicProps:!0,dynamicItems:!1};function Dc(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Dc.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.delegated===void 0&&(c="delegated")||t.scope===void 0&&(c="scope"))return Dc.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;{let l=a;for(let h in t)if(!(h==="description"||h==="delegated"||h==="scope"||h==="conditions")){return Dc.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"}],!1;break}if(l===a){if(t.description!==void 0){let h=a;if(typeof t.description!="string")return Dc.errors=[{instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.delegated!==void 0){let h=a;if(typeof t.delegated!="boolean")return Dc.errors=[{instancePath:e+"/delegated",schemaPath:"#/properties/delegated/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var u=h===a}else var u=!0;if(u){if(t.scope!==void 0){let h=a;cg(t.scope,{instancePath:e+"/scope",parentData:t,parentDataProperty:"scope",rootData:i,dynamicAnchors:o})||(s=s===null?cg.errors:s.concat(cg.errors),a=s.length);var u=h===a}else var u=!0;if(u)if(t.conditions!==void 0){let h=t.conditions,y=a;if(a===a)if(h&&typeof h=="object"&&!Array.isArray(h)){let x=a;for(let S in h)if(S!=="publication"){return Dc.errors=[{instancePath:e+"/conditions",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:S},message:"must NOT have additional properties"}],!1;break}if(x===a&&h.publication!==void 0){let S=h.publication;if(typeof S!="string")return Dc.errors=[{instancePath:e+"/conditions/publication",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/properties/publication/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(!(S==="Required"||S==="Prohibited"))return Dc.errors=[{instancePath:e+"/conditions/publication",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/properties/publication/enum",keyword:"enum",params:{allowedValues:rG.properties.publication.enum},message:"must be equal to one of the allowed values"}],!1}}else return Dc.errors=[{instancePath:e+"/conditions",schemaPath:"https://identity.foundation/dwn/json-schemas/permissions/defs.json#/$defs/conditions/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=y===a}else var u=!0}}}}}else return Dc.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Dc.errors=s,a===0}Dc.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var K6e=og;function og(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=og.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let u=a;for(let c in t)if(c!=="description"){return og.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:c},message:"must NOT have additional properties"}],!1;break}if(u===a&&t.description!==void 0&&typeof t.description!="string")return og.errors=[{instancePath:e+"/description",schemaPath:"#/properties/description/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1}else return og.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return og.errors=s,a===0}og.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var q6e=Ix;function Ix(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Ix.evaluated;return d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),t&&typeof t=="object"&&!Array.isArray(t)?(Ix.errors=s,a===0):(Ix.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1)}Ix.evaluated={dynamicProps:!1,dynamicItems:!1};var L6e=Rx;function Rx(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Rx.evaluated;return d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),t&&typeof t=="object"&&!Array.isArray(t)?(Rx.errors=s,a===0):(Rx.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1)}Rx.evaluated={dynamicProps:!1,dynamicItems:!1};var F6e=Gi;var GW=new RegExp(".*","u"),kw={$id:"https://identity.foundation/dwn/json-schemas/protocol-rule-set.json",$schema:"https://json-schema.org/draft/2020-12/schema",type:"object",additionalProperties:!1,properties:{$encryption:{type:"object",additionalProperties:!1,properties:{rootKeyId:{type:"string"},publicKeyJwk:{$ref:"https://identity.foundation/dwn/json-schemas/public-jwk.json"}},required:["rootKeyId","publicKeyJwk"]},$actions:{type:"array",minItems:1,items:{type:"object",oneOf:[{required:["who","can"],additionalProperties:!1,properties:{who:{type:"string",enum:["anyone","author","recipient"]},of:{type:"string"},can:{type:"array",minItems:1,items:{type:"string",enum:["co-delete","co-prune","co-update","create","delete","prune","read","update"]}}}},{required:["role","can"],properties:{role:{$comment:"Must be the protocol path of a role record type",type:"string"},can:{type:"array",minItems:1,items:{type:"string",enum:["co-delete","co-update","create","delete","query","subscribe","read","update"]}}}}]}},$role:{$comment:"When `true`, this turns a record into `role` that may be used within a context/sub-context",type:"boolean"},$size:{type:"object",additionalProperties:!1,properties:{min:{type:"number",minimum:0},max:{type:"number",minimum:0}}},$tags:{type:"object",minProperties:1,properties:{$requiredTags:{type:"array",items:{type:"string"}},$allowUndefinedTags:{type:"boolean"}},patternProperties:{"^(?!\\$requiredTags$|\\$allowUndefinedTags$).*$":{type:"object",additionalProperties:!1,properties:{type:{enum:["string","number","integer","boolean","array"]},items:{type:"object",properties:{type:{enum:["string","number","integer"]}},patternProperties:{"^(enum|minimum|maximum|exclusiveMinimum|exclusiveMaximum|minLength|maxLength)$":{}}},contains:{type:"object",properties:{type:{enum:["string","number","integer"]}},patternProperties:{"^(enum|minimum|maximum|exclusiveMinimum|exclusiveMaximum|minLength|maxLength)$":{}}}},patternProperties:{"^(enum|minimum|maximum|exclusiveMinimum|exclusiveMaximum|minLength|maxLength|minItems|maxItems|uniqueItems|minContains|maxContains)$":{}}}}}},patternProperties:{"^[^$].*$":{$ref:"https://identity.foundation/dwn/json-schemas/protocol-rule-set.json"}}},JW=new RegExp("^[^$].*$","u"),z6e=new RegExp("^(?!\\$requiredTags$|\\$allowUndefinedTags$).*$","u"),V6e=new RegExp("^(enum|minimum|maximum|exclusiveMinimum|exclusiveMaximum|minLength|maxLength|minItems|maxItems|uniqueItems|minContains|maxContains)$","u"),YW=new RegExp("^(enum|minimum|maximum|exclusiveMinimum|exclusiveMaximum|minLength|maxLength)$","u"),xO={validate:Mr};function Mr(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Mr.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let P=a;for(let B in t)if(!(B==="$encryption"||B==="$actions"||B==="$role"||B==="$size"||B==="$tags"||JW.test(B))){return Mr.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:B},message:"must NOT have additional properties"}],!1;break}if(P===a){if(t.$encryption!==void 0){let B=t.$encryption,p=a;if(a===p)if(B&&typeof B=="object"&&!Array.isArray(B)){let m;if(B.rootKeyId===void 0&&(m="rootKeyId")||B.publicKeyJwk===void 0&&(m="publicKeyJwk"))return Mr.errors=[{instancePath:e+"/$encryption",schemaPath:"#/properties/%24encryption/required",keyword:"required",params:{missingProperty:m},message:"must have required property '"+m+"'"}],!1;{let w=a;for(let E in B)if(!(E==="rootKeyId"||E==="publicKeyJwk")){return Mr.errors=[{instancePath:e+"/$encryption",schemaPath:"#/properties/%24encryption/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:E},message:"must NOT have additional properties"}],!1;break}if(w===a){if(B.rootKeyId!==void 0){let E=a;if(typeof B.rootKeyId!="string")return Mr.errors=[{instancePath:e+"/$encryption/rootKeyId",schemaPath:"#/properties/%24encryption/properties/rootKeyId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=E===a}else var u=!0;if(u)if(B.publicKeyJwk!==void 0){let E=a;dn(B.publicKeyJwk,{instancePath:e+"/$encryption/publicKeyJwk",parentData:B,parentDataProperty:"publicKeyJwk",rootData:i,dynamicAnchors:o})||(s=s===null?dn.errors:s.concat(dn.errors),a=s.length);var u=E===a}else var u=!0}}}else return Mr.errors=[{instancePath:e+"/$encryption",schemaPath:"#/properties/%24encryption/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var c=p===a}else var c=!0;if(c){if(t.$actions!==void 0){let B=t.$actions,p=a;if(a===p)if(Array.isArray(B)){if(B.length<1)return Mr.errors=[{instancePath:e+"/$actions",schemaPath:"#/properties/%24actions/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var l=!0;let w=B.length;for(let E=0;E<w;E++){let _=B[E],b=a;if(!(_&&typeof _=="object"&&!Array.isArray(_)))return Mr.errors=[{instancePath:e+"/$actions/"+E,schemaPath:"#/properties/%24actions/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;let C=a,N=!1,D=null,U=a;if(_&&typeof _=="object"&&!Array.isArray(_)){let J;if(_.who===void 0&&(J="who")||_.can===void 0&&(J="can")){let H={instancePath:e+"/$actions/"+E,schemaPath:"#/properties/%24actions/items/oneOf/0/required",keyword:"required",params:{missingProperty:J},message:"must have required property '"+J+"'"};s===null?s=[H]:s.push(H),a++}else{let H=a;for(let X in _)if(!(X==="who"||X==="of"||X==="can")){let te={instancePath:e+"/$actions/"+E,schemaPath:"#/properties/%24actions/items/oneOf/0/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:X},message:"must NOT have additional properties"};s===null?s=[te]:s.push(te),a++;break}if(H===a){if(_.who!==void 0){let X=_.who,te=a;if(typeof X!="string"){let ne={instancePath:e+"/$actions/"+E+"/who",schemaPath:"#/properties/%24actions/items/oneOf/0/properties/who/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ne]:s.push(ne),a++}if(!(X==="anyone"||X==="author"||X==="recipient")){let ne={instancePath:e+"/$actions/"+E+"/who",schemaPath:"#/properties/%24actions/items/oneOf/0/properties/who/enum",keyword:"enum",params:{allowedValues:kw.properties.$actions.items.oneOf[0].properties.who.enum},message:"must be equal to one of the allowed values"};s===null?s=[ne]:s.push(ne),a++}var h=te===a}else var h=!0;if(h){if(_.of!==void 0){let X=a;if(typeof _.of!="string"){let ne={instancePath:e+"/$actions/"+E+"/of",schemaPath:"#/properties/%24actions/items/oneOf/0/properties/of/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ne]:s.push(ne),a++}var h=X===a}else var h=!0;if(h)if(_.can!==void 0){let X=_.can,te=a;if(a===te)if(Array.isArray(X))if(X.length<1){let Q={instancePath:e+"/$actions/"+E+"/can",schemaPath:"#/properties/%24actions/items/oneOf/0/properties/can/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};s===null?s=[Q]:s.push(Q),a++}else{var y=!0;let Q=X.length;for(let re=0;re<Q;re++){let ae=X[re],he=a;if(typeof ae!="string"){let ie={instancePath:e+"/$actions/"+E+"/can/"+re,schemaPath:"#/properties/%24actions/items/oneOf/0/properties/can/items/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ie]:s.push(ie),a++}if(!(ae==="co-delete"||ae==="co-prune"||ae==="co-update"||ae==="create"||ae==="delete"||ae==="prune"||ae==="read"||ae==="update")){let ie={instancePath:e+"/$actions/"+E+"/can/"+re,schemaPath:"#/properties/%24actions/items/oneOf/0/properties/can/items/enum",keyword:"enum",params:{allowedValues:kw.properties.$actions.items.oneOf[0].properties.can.items.enum},message:"must be equal to one of the allowed values"};s===null?s=[ie]:s.push(ie),a++}var y=he===a;if(!y)break}}else{let Q={instancePath:e+"/$actions/"+E+"/can",schemaPath:"#/properties/%24actions/items/oneOf/0/properties/can/type",keyword:"type",params:{type:"array"},message:"must be array"};s===null?s=[Q]:s.push(Q),a++}var h=te===a}else var h=!0}}}}var S=U===a;if(S){N=!0,D=0;var g=!0}let G=a;if(_&&typeof _=="object"&&!Array.isArray(_)){let J;if(_.role===void 0&&(J="role")||_.can===void 0&&(J="can")){let H={instancePath:e+"/$actions/"+E,schemaPath:"#/properties/%24actions/items/oneOf/1/required",keyword:"required",params:{missingProperty:J},message:"must have required property '"+J+"'"};s===null?s=[H]:s.push(H),a++}else{if(_.role!==void 0){let H=a;if(typeof _.role!="string"){let X={instancePath:e+"/$actions/"+E+"/role",schemaPath:"#/properties/%24actions/items/oneOf/1/properties/role/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[X]:s.push(X),a++}var v=H===a}else var v=!0;if(v)if(_.can!==void 0){let H=_.can,X=a;if(a===X)if(Array.isArray(H))if(H.length<1){let ne={instancePath:e+"/$actions/"+E+"/can",schemaPath:"#/properties/%24actions/items/oneOf/1/properties/can/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"};s===null?s=[ne]:s.push(ne),a++}else{var x=!0;let ne=H.length;for(let Q=0;Q<ne;Q++){let re=H[Q],ae=a;if(typeof re!="string"){let ge={instancePath:e+"/$actions/"+E+"/can/"+Q,schemaPath:"#/properties/%24actions/items/oneOf/1/properties/can/items/type",keyword:"type",params:{type:"string"},message:"must be string"};s===null?s=[ge]:s.push(ge),a++}if(!(re==="co-delete"||re==="co-update"||re==="create"||re==="delete"||re==="query"||re==="subscribe"||re==="read"||re==="update")){let ge={instancePath:e+"/$actions/"+E+"/can/"+Q,schemaPath:"#/properties/%24actions/items/oneOf/1/properties/can/items/enum",keyword:"enum",params:{allowedValues:kw.properties.$actions.items.oneOf[1].properties.can.items.enum},message:"must be equal to one of the allowed values"};s===null?s=[ge]:s.push(ge),a++}var x=ae===a;if(!x)break}}else{let ne={instancePath:e+"/$actions/"+E+"/can",schemaPath:"#/properties/%24actions/items/oneOf/1/properties/can/type",keyword:"type",params:{type:"array"},message:"must be array"};s===null?s=[ne]:s.push(ne),a++}var v=X===a}else var v=!0}}var S=G===a;if(S&&N?(N=!1,D=[D,1]):S&&(N=!0,D=1,g!==!0&&(g=g||{},g.role=!0,g.can=!0)),N)a=C,s!==null&&(C?s.length=C:s=null);else{let J={instancePath:e+"/$actions/"+E,schemaPath:"#/properties/%24actions/items/oneOf",keyword:"oneOf",params:{passingSchemas:D},message:"must match exactly one schema in oneOf"};return s===null?s=[J]:s.push(J),a++,Mr.errors=s,!1}var l=b===a;if(!l)break}}}else return Mr.errors=[{instancePath:e+"/$actions",schemaPath:"#/properties/%24actions/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var c=p===a}else var c=!0;if(c){if(t.$role!==void 0){let B=a;if(typeof t.$role!="boolean")return Mr.errors=[{instancePath:e+"/$role",schemaPath:"#/properties/%24role/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var c=B===a}else var c=!0;if(c){if(t.$size!==void 0){let B=t.$size,p=a;if(a===p)if(B&&typeof B=="object"&&!Array.isArray(B)){let w=a;for(let E in B)if(!(E==="min"||E==="max")){return Mr.errors=[{instancePath:e+"/$size",schemaPath:"#/properties/%24size/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:E},message:"must NOT have additional properties"}],!1;break}if(w===a){if(B.min!==void 0){let E=B.min,_=a;if(a===_)if(typeof E=="number"&&isFinite(E)){if(E<0||isNaN(E))return Mr.errors=[{instancePath:e+"/$size/min",schemaPath:"#/properties/%24size/properties/min/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1}else return Mr.errors=[{instancePath:e+"/$size/min",schemaPath:"#/properties/%24size/properties/min/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var A=_===a}else var A=!0;if(A)if(B.max!==void 0){let E=B.max,_=a;if(a===_)if(typeof E=="number"&&isFinite(E)){if(E<0||isNaN(E))return Mr.errors=[{instancePath:e+"/$size/max",schemaPath:"#/properties/%24size/properties/max/minimum",keyword:"minimum",params:{comparison:">=",limit:0},message:"must be >= 0"}],!1}else return Mr.errors=[{instancePath:e+"/$size/max",schemaPath:"#/properties/%24size/properties/max/type",keyword:"type",params:{type:"number"},message:"must be number"}],!1;var A=_===a}else var A=!0}}else return Mr.errors=[{instancePath:e+"/$size",schemaPath:"#/properties/%24size/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var c=p===a}else var c=!0;if(c){if(t.$tags!==void 0){let B=t.$tags,p=a;if(a===p)if(B&&typeof B=="object"&&!Array.isArray(B)){if(Object.keys(B).length<1)return Mr.errors=[{instancePath:e+"/$tags",schemaPath:"#/properties/%24tags/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;if(B.$requiredTags!==void 0){let w=B.$requiredTags,E=a;if(a===E)if(Array.isArray(w)){var T=!0;let _=w.length;for(let b=0;b<_;b++){let C=a;if(typeof w[b]!="string")return Mr.errors=[{instancePath:e+"/$tags/$requiredTags/"+b,schemaPath:"#/properties/%24tags/properties/%24requiredTags/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var T=C===a;if(!T)break}}else return Mr.errors=[{instancePath:e+"/$tags/$requiredTags",schemaPath:"#/properties/%24tags/properties/%24requiredTags/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var $=E===a}else var $=!0;if($){if(B.$allowUndefinedTags!==void 0){let w=a;if(typeof B.$allowUndefinedTags!="boolean")return Mr.errors=[{instancePath:e+"/$tags/$allowUndefinedTags",schemaPath:"#/properties/%24tags/properties/%24allowUndefinedTags/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var $=w===a}else var $=!0;if($){var j={};j.$requiredTags=!0,j.$allowUndefinedTags=!0;for(let w in B)if(z6e.test(w)){let E=B[w];if(a===a)if(E&&typeof E=="object"&&!Array.isArray(E)){let b=a;for(let C in E)if(!(C==="type"||C==="items"||C==="contains"||V6e.test(C))){return Mr.errors=[{instancePath:e+"/$tags/"+w.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:C},message:"must NOT have additional properties"}],!1;break}if(b===a){if(E.type!==void 0){let C=E.type,N=a;if(!(C==="string"||C==="number"||C==="integer"||C==="boolean"||C==="array"))return Mr.errors=[{instancePath:e+"/$tags/"+w.replace(/~/g,"~0").replace(/\//g,"~1")+"/type",schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/properties/type/enum",keyword:"enum",params:{allowedValues:kw.properties.$tags.patternProperties["^(?!\\$requiredTags$|\\$allowUndefinedTags$).*$"].properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var K=N===a}else var K=!0;if(K){if(E.items!==void 0){let C=E.items,N=a;if(a===N)if(C&&typeof C=="object"&&!Array.isArray(C)){if(C.type!==void 0){let U=C.type,G=a;if(!(U==="string"||U==="number"||U==="integer"))return Mr.errors=[{instancePath:e+"/$tags/"+w.replace(/~/g,"~0").replace(/\//g,"~1")+"/items/type",schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/properties/items/properties/type/enum",keyword:"enum",params:{allowedValues:kw.properties.$tags.patternProperties["^(?!\\$requiredTags$|\\$allowUndefinedTags$).*$"].properties.items.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var F=G===a}else var F=!0;if(F){var L={};L.type=!0;for(let U in C)YW.test(U)&&(L[U]=!0)}}else return Mr.errors=[{instancePath:e+"/$tags/"+w.replace(/~/g,"~0").replace(/\//g,"~1")+"/items",schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/properties/items/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var K=N===a}else var K=!0;if(K)if(E.contains!==void 0){let C=E.contains,N=a;if(a===N)if(C&&typeof C=="object"&&!Array.isArray(C)){if(C.type!==void 0){let U=C.type,G=a;if(!(U==="string"||U==="number"||U==="integer"))return Mr.errors=[{instancePath:e+"/$tags/"+w.replace(/~/g,"~0").replace(/\//g,"~1")+"/contains/type",schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/properties/contains/properties/type/enum",keyword:"enum",params:{allowedValues:kw.properties.$tags.patternProperties["^(?!\\$requiredTags$|\\$allowUndefinedTags$).*$"].properties.contains.properties.type.enum},message:"must be equal to one of the allowed values"}],!1;var V=G===a}else var V=!0;if(V){var q={};q.type=!0;for(let U in C)YW.test(U)&&(q[U]=!0)}}else return Mr.errors=[{instancePath:e+"/$tags/"+w.replace(/~/g,"~0").replace(/\//g,"~1")+"/contains",schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/properties/contains/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var K=N===a}else var K=!0}}}else return Mr.errors=[{instancePath:e+"/$tags/"+w.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/%24tags/patternProperties/%5E(%3F!%5C%24requiredTags%24%7C%5C%24allowUndefinedTags%24).*%24/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;j[w]=!0}}}}else return Mr.errors=[{instancePath:e+"/$tags",schemaPath:"#/properties/%24tags/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var c=p===a}else var c=!0;if(c){var k=!0;for(let B in t)if(JW.test(B)){let p=a;xO.validate(t[B],{instancePath:e+"/"+B.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:t,parentDataProperty:B,rootData:i,dynamicAnchors:o})||(s=s===null?xO.validate.errors:s.concat(xO.validate.errors),a=s.length);var k=p===a;if(!k)break}}}}}}}}else return Mr.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Mr.errors=s,a===0}Mr.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};function Gi(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Gi.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let g;if(t.protocol===void 0&&(g="protocol")||t.published===void 0&&(g="published")||t.types===void 0&&(g="types")||t.structure===void 0&&(g="structure"))return Gi.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:g},message:"must have required property '"+g+"'"}],!1;{let v=a;for(let x in t)if(!(x==="protocol"||x==="published"||x==="types"||x==="structure")){return Gi.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:x},message:"must NOT have additional properties"}],!1;break}if(v===a){if(t.protocol!==void 0){let x=a;if(typeof t.protocol!="string")return Gi.errors=[{instancePath:e+"/protocol",schemaPath:"#/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=x===a}else var u=!0;if(u){if(t.published!==void 0){let x=a;if(typeof t.published!="boolean")return Gi.errors=[{instancePath:e+"/published",schemaPath:"#/properties/published/type",keyword:"type",params:{type:"boolean"},message:"must be boolean"}],!1;var u=x===a}else var u=!0;if(u){if(t.types!==void 0){let x=t.types,S=a;if(a===S)if(x&&typeof x=="object"&&!Array.isArray(x)){var c={};for(let T in x)if(GW.test(T)){let $=x[T];if(a===a)if($&&typeof $=="object"&&!Array.isArray($)){let K=a;for(let F in $)if(!(F==="schema"||F==="dataFormats")){return Gi.errors=[{instancePath:e+"/types/"+T.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/types/patternProperties/.*/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:F},message:"must NOT have additional properties"}],!1;break}if(K===a){if($.schema!==void 0){let F=a;if(typeof $.schema!="string")return Gi.errors=[{instancePath:e+"/types/"+T.replace(/~/g,"~0").replace(/\//g,"~1")+"/schema",schemaPath:"#/properties/types/patternProperties/.*/properties/schema/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=F===a}else var l=!0;if(l)if($.dataFormats!==void 0){let F=$.dataFormats,L=a;if(a===L)if(Array.isArray(F)){if(F.length<1)return Gi.errors=[{instancePath:e+"/types/"+T.replace(/~/g,"~0").replace(/\//g,"~1")+"/dataFormats",schemaPath:"#/properties/types/patternProperties/.*/properties/dataFormats/minItems",keyword:"minItems",params:{limit:1},message:"must NOT have fewer than 1 items"}],!1;{var h=!0;let q=F.length;for(let k=0;k<q;k++){let P=a;if(typeof F[k]!="string")return Gi.errors=[{instancePath:e+"/types/"+T.replace(/~/g,"~0").replace(/\//g,"~1")+"/dataFormats/"+k,schemaPath:"#/properties/types/patternProperties/.*/properties/dataFormats/items/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var h=P===a;if(!h)break}}}else return Gi.errors=[{instancePath:e+"/types/"+T.replace(/~/g,"~0").replace(/\//g,"~1")+"/dataFormats",schemaPath:"#/properties/types/patternProperties/.*/properties/dataFormats/type",keyword:"type",params:{type:"array"},message:"must be array"}],!1;var l=L===a}else var l=!0}}else return Gi.errors=[{instancePath:e+"/types/"+T.replace(/~/g,"~0").replace(/\//g,"~1"),schemaPath:"#/properties/types/patternProperties/.*/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;c[T]=!0}}else return Gi.errors=[{instancePath:e+"/types",schemaPath:"#/properties/types/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=S===a}else var u=!0;if(u)if(t.structure!==void 0){let x=t.structure,S=a;if(a===S)if(x&&typeof x=="object"&&!Array.isArray(x)){var y={};for(let T in x)GW.test(T)&&(Mr(x[T],{instancePath:e+"/structure/"+T.replace(/~/g,"~0").replace(/\//g,"~1"),parentData:x,parentDataProperty:T,rootData:i,dynamicAnchors:o})||(s=s===null?Mr.errors:s.concat(Mr.errors),a=s.length),y[T]=!0)}else return Gi.errors=[{instancePath:e+"/structure",schemaPath:"#/properties/structure/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=S===a}else var u=!0}}}}}else return Gi.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Gi.errors=s,a===0}Gi.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var H6e=Mr,W6e=Js,ZW={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/protocols-configure.json",type:"object",additionalProperties:!1,required:["authorization","descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","definition"],properties:{interface:{enum:["Protocols"],type:"string"},method:{enum:["Configure"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},definition:{$ref:"https://identity.foundation/dwn/json-schemas/protocol-definition.json"}}}}};function Js(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Js.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.authorization===void 0&&(l="authorization")||t.descriptor===void 0&&(l="descriptor"))return Js.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;{let h=a;for(let y in t)if(!(y==="authorization"||y==="descriptor")){return Js.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:y},message:"must NOT have additional properties"}],!1;break}if(h===a){if(t.authorization!==void 0){let y=a;Mi(t.authorization,{instancePath:e+"/authorization",parentData:t,parentDataProperty:"authorization",rootData:i,dynamicAnchors:o})||(s=s===null?Mi.errors:s.concat(Mi.errors),a=s.length);var u=y===a}else var u=!0;if(u)if(t.descriptor!==void 0){let y=t.descriptor,g=a;if(a===g)if(y&&typeof y=="object"&&!Array.isArray(y)){let x;if(y.interface===void 0&&(x="interface")||y.method===void 0&&(x="method")||y.messageTimestamp===void 0&&(x="messageTimestamp")||y.definition===void 0&&(x="definition"))return Js.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:x},message:"must have required property '"+x+"'"}],!1;{let S=a;for(let A in y)if(!(A==="interface"||A==="method"||A==="messageTimestamp"||A==="definition")){return Js.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:A},message:"must NOT have additional properties"}],!1;break}if(S===a){if(y.interface!==void 0){let A=y.interface,T=a;if(typeof A!="string")return Js.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(A!=="Protocols")return Js.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:ZW.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var c=T===a}else var c=!0;if(c){if(y.method!==void 0){let A=y.method,T=a;if(typeof A!="string")return Js.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(A!=="Configure")return Js.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:ZW.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var c=T===a}else var c=!0;if(c){if(y.messageTimestamp!==void 0){let A=y.messageTimestamp,T=a;if(a===a)if(typeof A=="string"){if(!Ji.test(A))return Js.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Js.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=T===a}else var c=!0;if(c)if(y.definition!==void 0){let A=a;Gi(y.definition,{instancePath:e+"/descriptor/definition",parentData:y,parentDataProperty:"definition",rootData:i,dynamicAnchors:o})||(s=s===null?Gi.errors:s.concat(Gi.errors),a=s.length);var c=A===a}else var c=!0}}}}}else return Js.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=g===a}else var u=!0}}}else return Js.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Js.errors=s,a===0}Js.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var G6e=wi,XW={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/protocols-query.json",type:"object",additionalProperties:!1,required:["descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp"],properties:{interface:{enum:["Protocols"],type:"string"},method:{enum:["Query"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},filter:{type:"object",minProperties:1,additionalProperties:!1,properties:{protocol:{type:"string"},recipient:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did"}}}}}}};function wi(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=wi.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let h;if(t.descriptor===void 0&&(h="descriptor"))return wi.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:h},message:"must have required property '"+h+"'"}],!1;{let y=a;for(let g in t)if(!(g==="authorization"||g==="descriptor")){return wi.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:g},message:"must NOT have additional properties"}],!1;break}if(y===a){if(t.authorization!==void 0){let g=a;Mi(t.authorization,{instancePath:e+"/authorization",parentData:t,parentDataProperty:"authorization",rootData:i,dynamicAnchors:o})||(s=s===null?Mi.errors:s.concat(Mi.errors),a=s.length);var u=g===a}else var u=!0;if(u)if(t.descriptor!==void 0){let g=t.descriptor,v=a;if(a===v)if(g&&typeof g=="object"&&!Array.isArray(g)){let S;if(g.interface===void 0&&(S="interface")||g.method===void 0&&(S="method")||g.messageTimestamp===void 0&&(S="messageTimestamp"))return wi.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:S},message:"must have required property '"+S+"'"}],!1;{let A=a;for(let T in g)if(!(T==="interface"||T==="method"||T==="messageTimestamp"||T==="filter")){return wi.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:T},message:"must NOT have additional properties"}],!1;break}if(A===a){if(g.interface!==void 0){let T=g.interface,$=a;if(typeof T!="string")return wi.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(T!=="Protocols")return wi.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:XW.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var c=$===a}else var c=!0;if(c){if(g.method!==void 0){let T=g.method,$=a;if(typeof T!="string")return wi.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(T!=="Query")return wi.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:XW.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var c=$===a}else var c=!0;if(c){if(g.messageTimestamp!==void 0){let T=g.messageTimestamp,$=a;if(a===a)if(typeof T=="string"){if(!Ji.test(T))return wi.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return wi.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=$===a}else var c=!0;if(c)if(g.filter!==void 0){let T=g.filter,$=a;if(a===$)if(T&&typeof T=="object"&&!Array.isArray(T)){if(Object.keys(T).length<1)return wi.errors=[{instancePath:e+"/descriptor/filter",schemaPath:"#/properties/descriptor/properties/filter/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let K=a;for(let F in T)if(!(F==="protocol"||F==="recipient")){return wi.errors=[{instancePath:e+"/descriptor/filter",schemaPath:"#/properties/descriptor/properties/filter/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:F},message:"must NOT have additional properties"}],!1;break}if(K===a){if(T.protocol!==void 0){let F=a;if(typeof T.protocol!="string")return wi.errors=[{instancePath:e+"/descriptor/filter/protocol",schemaPath:"#/properties/descriptor/properties/filter/properties/protocol/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=F===a}else var l=!0;if(l)if(T.recipient!==void 0){let F=T.recipient,L=a;if(a===a)if(typeof F=="string"){if(!_y.test(F))return wi.errors=[{instancePath:e+"/descriptor/filter/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/pattern",keyword:"pattern",params:{pattern:"^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"},message:'must match pattern "^did:([a-z0-9]+):((?:(?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))*:)*((?:[a-zA-Z0-9._-]|(?:%[0-9a-fA-F]{2}))+))((;[a-zA-Z0-9_.:%-]+=[a-zA-Z0-9_.:%-]*)*)(/[^#?]*)?([?][^#]*)?(#.*)?$"'}],!1}else return wi.errors=[{instancePath:e+"/descriptor/filter/recipient",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/did/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var l=L===a}else var l=!0}}}else return wi.errors=[{instancePath:e+"/descriptor/filter",schemaPath:"#/properties/descriptor/properties/filter/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var c=$===a}else var c=!0}}}}}else return wi.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=v===a}else var u=!0}}}else return wi.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return wi.errors=s,a===0}wi.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var J6e=Ys,QW={$schema:"https://json-schema.org/draft/2020-12/schema",$id:"https://identity.foundation/dwn/json-schemas/records-read.json",type:"object",additionalProperties:!1,required:["descriptor"],properties:{authorization:{$ref:"https://identity.foundation/dwn/json-schemas/authorization-delegated-grant.json"},descriptor:{type:"object",additionalProperties:!1,required:["interface","method","messageTimestamp","filter"],properties:{interface:{enum:["Records"],type:"string"},method:{enum:["Read"],type:"string"},messageTimestamp:{$ref:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time"},filter:{$ref:"https://identity.foundation/dwn/json-schemas/records-filter.json"}}}}};function Ys(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Ys.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let l;if(t.descriptor===void 0&&(l="descriptor"))return Ys.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:l},message:"must have required property '"+l+"'"}],!1;{let h=a;for(let y in t)if(!(y==="authorization"||y==="descriptor")){return Ys.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:y},message:"must NOT have additional properties"}],!1;break}if(h===a){if(t.authorization!==void 0){let y=a;Po(t.authorization,{instancePath:e+"/authorization",parentData:t,parentDataProperty:"authorization",rootData:i,dynamicAnchors:o})||(s=s===null?Po.errors:s.concat(Po.errors),a=s.length);var u=y===a}else var u=!0;if(u)if(t.descriptor!==void 0){let y=t.descriptor,g=a;if(a===g)if(y&&typeof y=="object"&&!Array.isArray(y)){let x;if(y.interface===void 0&&(x="interface")||y.method===void 0&&(x="method")||y.messageTimestamp===void 0&&(x="messageTimestamp")||y.filter===void 0&&(x="filter"))return Ys.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/required",keyword:"required",params:{missingProperty:x},message:"must have required property '"+x+"'"}],!1;{let S=a;for(let A in y)if(!(A==="interface"||A==="method"||A==="messageTimestamp"||A==="filter")){return Ys.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:A},message:"must NOT have additional properties"}],!1;break}if(S===a){if(y.interface!==void 0){let A=y.interface,T=a;if(typeof A!="string")return Ys.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(A!=="Records")return Ys.errors=[{instancePath:e+"/descriptor/interface",schemaPath:"#/properties/descriptor/properties/interface/enum",keyword:"enum",params:{allowedValues:QW.properties.descriptor.properties.interface.enum},message:"must be equal to one of the allowed values"}],!1;var c=T===a}else var c=!0;if(c){if(y.method!==void 0){let A=y.method,T=a;if(typeof A!="string")return Ys.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;if(A!=="Read")return Ys.errors=[{instancePath:e+"/descriptor/method",schemaPath:"#/properties/descriptor/properties/method/enum",keyword:"enum",params:{allowedValues:QW.properties.descriptor.properties.method.enum},message:"must be equal to one of the allowed values"}],!1;var c=T===a}else var c=!0;if(c){if(y.messageTimestamp!==void 0){let A=y.messageTimestamp,T=a;if(a===a)if(typeof A=="string"){if(!Ji.test(A))return Ys.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/pattern",keyword:"pattern",params:{pattern:"^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"},message:'must match pattern "^\\d{4}-[0-1]\\d-[0-3]\\dT(?:[0-2]\\d:[0-5]\\d:[0-5]\\d|23:59:60)\\.\\d{6}Z$"'}],!1}else return Ys.errors=[{instancePath:e+"/descriptor/messageTimestamp",schemaPath:"https://identity.foundation/dwn/json-schemas/defs.json#/$defs/date-time/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var c=T===a}else var c=!0;if(c)if(y.filter!==void 0){let A=a;Xe(y.filter,{instancePath:e+"/descriptor/filter",parentData:y,parentDataProperty:"filter",rootData:i,dynamicAnchors:o})||(s=s===null?Xe.errors:s.concat(Xe.errors),a=s.length);var c=A===a}else var c=!0}}}}}else return Ys.errors=[{instancePath:e+"/descriptor",schemaPath:"#/properties/descriptor/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;var u=g===a}else var u=!0}}}else return Ys.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Ys.errors=s,a===0}Ys.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var Y6e=Xe,Z6e=dn,X6e=Pu;function Pu(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Pu.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.descriptorCid===void 0&&(c="descriptorCid"))return Pu.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;{let l=a;for(let h in t)if(!(h==="descriptorCid"||h==="delegatedGrantId"||h==="permissionGrantId"||h==="protocolRole")){return Pu.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"}],!1;break}if(l===a){if(t.descriptorCid!==void 0){let h=a;if(typeof t.descriptorCid!="string")return Pu.errors=[{instancePath:e+"/descriptorCid",schemaPath:"#/properties/descriptorCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.delegatedGrantId!==void 0){let h=a;if(typeof t.delegatedGrantId!="string")return Pu.errors=[{instancePath:e+"/delegatedGrantId",schemaPath:"#/properties/delegatedGrantId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.permissionGrantId!==void 0){let h=a;if(typeof t.permissionGrantId!="string")return Pu.errors=[{instancePath:e+"/permissionGrantId",schemaPath:"#/properties/permissionGrantId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u)if(t.protocolRole!==void 0){let h=a;if(typeof t.protocolRole!="string")return Pu.errors=[{instancePath:e+"/protocolRole",schemaPath:"#/properties/protocolRole/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0}}}}}else return Pu.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Pu.errors=s,a===0}Pu.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var Q6e=Pa;function Pa(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Pa.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){let c;if(t.descriptorCid===void 0&&(c="descriptorCid")||t.recordId===void 0&&(c="recordId"))return Pa.errors=[{instancePath:e,schemaPath:"#/required",keyword:"required",params:{missingProperty:c},message:"must have required property '"+c+"'"}],!1;{let l=a;for(let h in t)if(!(h==="descriptorCid"||h==="recordId"||h==="contextId"||h==="attestationCid"||h==="encryptionCid"||h==="delegatedGrantId"||h==="permissionGrantId"||h==="protocolRole")){return Pa.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:h},message:"must NOT have additional properties"}],!1;break}if(l===a){if(t.descriptorCid!==void 0){let h=a;if(typeof t.descriptorCid!="string")return Pa.errors=[{instancePath:e+"/descriptorCid",schemaPath:"#/properties/descriptorCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.recordId!==void 0){let h=a;if(typeof t.recordId!="string")return Pa.errors=[{instancePath:e+"/recordId",schemaPath:"#/properties/recordId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.contextId!==void 0){let h=a;if(typeof t.contextId!="string")return Pa.errors=[{instancePath:e+"/contextId",schemaPath:"#/properties/contextId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.attestationCid!==void 0){let h=a;if(typeof t.attestationCid!="string")return Pa.errors=[{instancePath:e+"/attestationCid",schemaPath:"#/properties/attestationCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.encryptionCid!==void 0){let h=a;if(typeof t.encryptionCid!="string")return Pa.errors=[{instancePath:e+"/encryptionCid",schemaPath:"#/properties/encryptionCid/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.delegatedGrantId!==void 0){let h=a;if(typeof t.delegatedGrantId!="string")return Pa.errors=[{instancePath:e+"/delegatedGrantId",schemaPath:"#/properties/delegatedGrantId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u){if(t.permissionGrantId!==void 0){let h=a;if(typeof t.permissionGrantId!="string")return Pa.errors=[{instancePath:e+"/permissionGrantId",schemaPath:"#/properties/permissionGrantId/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0;if(u)if(t.protocolRole!==void 0){let h=a;if(typeof t.protocolRole!="string")return Pa.errors=[{instancePath:e+"/protocolRole",schemaPath:"#/properties/protocolRole/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var u=h===a}else var u=!0}}}}}}}}}else return Pa.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Pa.errors=s,a===0}Pa.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};var eSe=Ia;function Ia(t,{instancePath:e="",parentData:r,parentDataProperty:n,rootData:i=t,dynamicAnchors:o={}}={}){let s=null,a=0,d=Ia.evaluated;if(d.dynamicProps&&(d.props=void 0),d.dynamicItems&&(d.items=void 0),a===0)if(t&&typeof t=="object"&&!Array.isArray(t)){if(Object.keys(t).length<1)return Ia.errors=[{instancePath:e,schemaPath:"#/minProperties",keyword:"minProperties",params:{limit:1},message:"must NOT have fewer than 1 properties"}],!1;{let v=a;for(let x in t)if(!(x==="gt"||x==="gte"||x==="lt"||x==="lte")){return Ia.errors=[{instancePath:e,schemaPath:"#/additionalProperties",keyword:"additionalProperties",params:{additionalProperty:x},message:"must NOT have additional properties"}],!1;break}if(v===a){if(t.gt!==void 0){let x=a,S=a,A=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let T;if(t.gte===void 0&&(T="gte")){let $={};s===null?s=[$]:s.push($),a++}}var u=A===a;if(u)return Ia.errors=[{instancePath:e,schemaPath:"#/dependencies/gt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=S,s!==null&&(S?s.length=S:s=null);var c=x===a}else var c=!0;if(c){if(t.gte!==void 0){let x=a,S=a,A=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let $;if(t.gt===void 0&&($="gt")){let j={};s===null?s=[j]:s.push(j),a++}}var l=A===a;if(l)return Ia.errors=[{instancePath:e,schemaPath:"#/dependencies/gte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=S,s!==null&&(S?s.length=S:s=null);var c=x===a}else var c=!0;if(c){if(t.lt!==void 0){let x=a,S=a,A=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let $;if(t.lte===void 0&&($="lte")){let j={};s===null?s=[j]:s.push(j),a++}}var h=A===a;if(h)return Ia.errors=[{instancePath:e,schemaPath:"#/dependencies/lt/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=S,s!==null&&(S?s.length=S:s=null);var c=x===a}else var c=!0;if(c){if(t.lte!==void 0){let x=a,S=a,A=a;if(t&&typeof t=="object"&&!Array.isArray(t)){let $;if(t.lt===void 0&&($="lt")){let j={};s===null?s=[j]:s.push(j),a++}}var y=A===a;if(y)return Ia.errors=[{instancePath:e,schemaPath:"#/dependencies/lte/not",keyword:"not",params:{},message:"must NOT be valid"}],!1;a=S,s!==null&&(S?s.length=S:s=null);var c=x===a}else var c=!0;if(c){if(t.gt!==void 0){let x=a;if(typeof t.gt!="string")return Ia.errors=[{instancePath:e+"/gt",schemaPath:"#/properties/gt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var g=x===a}else var g=!0;if(g){if(t.gte!==void 0){let x=a;if(typeof t.gte!="string")return Ia.errors=[{instancePath:e+"/gte",schemaPath:"#/properties/gte/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var g=x===a}else var g=!0;if(g){if(t.lt!==void 0){let x=a;if(typeof t.lt!="string")return Ia.errors=[{instancePath:e+"/lt",schemaPath:"#/properties/lt/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var g=x===a}else var g=!0;if(g)if(t.lte!==void 0){let x=a;if(typeof t.lte!="string")return Ia.errors=[{instancePath:e+"/lte",schemaPath:"#/properties/lte/type",keyword:"type",params:{type:"string"},message:"must be string"}],!1;var g=x===a}else var g=!0}}}}}}}}}else return Ia.errors=[{instancePath:e,schemaPath:"#/type",keyword:"type",params:{type:"object"},message:"must be object"}],!1;return Ia.errors=s,a===0}Ia.evaluated={props:!0,dynamicProps:!1,dynamicItems:!1};function gh(t,e){let r=SO[t];if(!r)throw new de(se.SchemaValidatorSchemaNotFound,`schema for ${t} not found.`);if(r(e),!r.errors)return;let[n]=r.errors,{instancePath:i,message:o,keyword:s}=n;if(i||(i=t),s==="additionalProperties"){let a=n.params.additionalProperty;throw new de(se.SchemaValidatorAdditionalPropertyNotAllowed,`${o}: ${i}: ${a}`)}if(s==="unevaluatedProperties"){let a=n.params.unevaluatedProperty;throw new de(se.SchemaValidatorUnevaluatedPropertyNotAllowed,`${o}: ${i}: ${a}`)}throw new de(se.SchemaValidatorFailure,`${i}: ${o}`)}var TO=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},dg=class t{constructor(e){this.cache=e||new M8(600)}static get singleton(){return t._singleton===void 0&&(t._singleton=new t),t._singleton}static verifySignatures(e,r){return TO(this,void 0,void 0,function*(){return yield t.singleton.verifySignatures(e,r)})}verifySignatures(e,r){return TO(this,void 0,void 0,function*(){let n=[];for(let i of e.signatures){let o,s=cn.getKid(i),a=`${i.protected}.${e.payload}.${i.signature}`,d=yield this.cache.get(a);if(d===void 0){let c=yield t.getPublicKey(s,r);o=yield cn.verifySignature(e.payload,i,c),yield this.cache.set(a,o)}else o=d;let u=cn.extractDid(s);if(o)n.push(u);else throw new de(se.GeneralJwsVerifierInvalidSignature,`Signature verification failed for ${u}`)}return{signers:n}})}static getPublicKey(e,r){return TO(this,void 0,void 0,function*(){let n=cn.extractDid(e),{didDocument:i}=yield r.resolve(n),{verificationMethod:o=[]}=i||{},s;for(let d of o)if(e.endsWith(d.id)){s=d;break}if(!s)throw new de(se.GeneralJwsVerifierGetPublicKeyNotFound,"public key needed to verify signature not found in DID Document");gh("JwkVerificationMethod",s);let{publicKeyJwk:a}=s;return a})}};f();f();var fg={};Or(fg,{code:()=>qx,decode:()=>_5e,encode:()=>w5e,name:()=>b5e});f();f();f();f();var tSe=["string","number","bigint","symbol"],rSe=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function nG(t){if(t===null)return"null";if(t===void 0)return"undefined";if(t===!0||t===!1)return"boolean";let e=typeof t;if(tSe.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(t))return"Array";if(nSe(t))return"Buffer";let r=iSe(t);return r||"Object"}function nSe(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}function iSe(t){let e=Object.prototype.toString.call(t).slice(8,-1);if(rSe.includes(e))return e}f();var me=class{constructor(e,r,n){this.major=e,this.majorEncoded=e<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};me.uint=new me(0,"uint",!0);me.negint=new me(1,"negint",!0);me.bytes=new me(2,"bytes",!0);me.string=new me(3,"string",!0);me.array=new me(4,"array",!1);me.map=new me(5,"map",!1);me.tag=new me(6,"tag",!1);me.float=new me(7,"float",!0);me.false=new me(7,"false",!0);me.true=new me(7,"true",!0);me.null=new me(7,"null",!0);me.undefined=new me(7,"undefined",!0);me.break=new me(7,"break",!0);var Ve=class{constructor(e,r,n){this.type=e,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};f();f();var Pw=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",oSe=new TextDecoder,sSe=new TextEncoder;function D8(t){return Pw&&globalThis.Buffer.isBuffer(t)}function AO(t){return t instanceof Uint8Array?D8(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}var aG=Pw?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):oG(t,e,r):(t,e,r)=>r-e>64?oSe.decode(t.subarray(e,r)):oG(t,e,r),cG=Pw?t=>t.length>64?globalThis.Buffer.from(t):iG(t):t=>t.length>64?sSe.encode(t):iG(t),Ul=t=>Uint8Array.from(t),Iw=Pw?(t,e,r)=>D8(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),dG=Pw?(t,e)=>(t=t.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),AO(globalThis.Buffer.concat(t,e))):(t,e)=>{let r=new Uint8Array(e),n=0;for(let i of t)n+i.length>r.length&&(i=i.subarray(0,r.length-n)),r.set(i,n),n+=i.length;return r},uG=Pw?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);function lG(t,e){if(D8(t)&&D8(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}function iG(t,e=1/0){let r,n=t.length,i=null,o=[];for(let s=0;s<n;++s){if(r=t.charCodeAt(s),r>55295&&r<57344){if(!i){if(r>56319){(e-=3)>-1&&o.push(239,191,189);continue}else if(s+1===n){(e-=3)>-1&&o.push(239,191,189);continue}i=r;continue}if(r<56320){(e-=3)>-1&&o.push(239,191,189),i=r;continue}r=(i-55296<<10|r-56320)+65536}else i&&(e-=3)>-1&&o.push(239,191,189);if(i=null,r<128){if((e-=1)<0)break;o.push(r)}else if(r<2048){if((e-=2)<0)break;o.push(r>>6|192,r&63|128)}else if(r<65536){if((e-=3)<0)break;o.push(r>>12|224,r>>6&63|128,r&63|128)}else if(r<1114112){if((e-=4)<0)break;o.push(r>>18|240,r>>12&63|128,r>>6&63|128,r&63|128)}else throw new Error("Invalid code point")}return o}function oG(t,e,r){let n=[];for(;e<r;){let i=t[e],o=null,s=i>239?4:i>223?3:i>191?2:1;if(e+s<=r){let a,d,u,c;switch(s){case 1:i<128&&(o=i);break;case 2:a=t[e+1],(a&192)===128&&(c=(i&31)<<6|a&63,c>127&&(o=c));break;case 3:a=t[e+1],d=t[e+2],(a&192)===128&&(d&192)===128&&(c=(i&15)<<12|(a&63)<<6|d&63,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:a=t[e+1],d=t[e+2],u=t[e+3],(a&192)===128&&(d&192)===128&&(u&192)===128&&(c=(i&15)<<18|(a&63)<<12|(d&63)<<6|u&63,c>65535&&c<1114112&&(o=c))}}o===null?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),e+=s}return aSe(n)}var sG=4096;function aSe(t){let e=t.length;if(e<=sG)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=sG));return r}var cSe=256,Bx=class{constructor(e=cSe){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let r=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let i=r.length-(this.maxCursor-this.cursor)-1;r.set(e,i)}else{if(r){let i=r.length-(this.maxCursor-this.cursor)-1;i<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,i),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(r=uG(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let r;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=Iw(n,0,this.cursor)}else r=dG(this.chunks,this.cursor);return e&&this.reset(),r}};f();var zt="CBOR decode error:",kO="CBOR encode error:",Ox=[];Ox[23]=1;Ox[24]=2;Ox[25]=3;Ox[26]=5;Ox[27]=9;function vh(t,e,r){if(t.length-e<r)throw new Error(`${zt} not enough data for type`)}f();f();var Io=[24,256,65536,4294967296,BigInt("18446744073709551616")];function Cc(t,e,r){vh(t,e,1);let n=t[e];if(r.strict===!0&&n<Io[0])throw new Error(`${zt} integer encoded in more bytes than necessary (strict decode)`);return n}function jc(t,e,r){vh(t,e,2);let n=t[e]<<8|t[e+1];if(r.strict===!0&&n<Io[1])throw new Error(`${zt} integer encoded in more bytes than necessary (strict decode)`);return n}function $c(t,e,r){vh(t,e,4);let n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(r.strict===!0&&n<Io[2])throw new Error(`${zt} integer encoded in more bytes than necessary (strict decode)`);return n}function Nc(t,e,r){vh(t,e,8);let n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],i=t[e+4]*16777216+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(r.strict===!0&&o<Io[3])throw new Error(`${zt} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(r.allowBigInt===!0)return o;throw new Error(`${zt} integers outside of the safe integer range are not supported`)}function fG(t,e,r,n){return new Ve(me.uint,Cc(t,e+1,n),2)}function hG(t,e,r,n){return new Ve(me.uint,jc(t,e+1,n),3)}function pG(t,e,r,n){return new Ve(me.uint,$c(t,e+1,n),5)}function yG(t,e,r,n){return new Ve(me.uint,Nc(t,e+1,n),9)}function kd(t,e){return ss(t,0,e.value)}function ss(t,e,r){if(r<Io[0]){let n=Number(r);t.push([e|n])}else if(r<Io[1]){let n=Number(r);t.push([e|24,n])}else if(r<Io[2]){let n=Number(r);t.push([e|25,n>>>8,n&255])}else if(r<Io[3]){let n=Number(r);t.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<Io[4]){let i=[e|27,0,0,0,0,0,0,0],o=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=o&255,o=o>>8,i[7]=o&255,o=o>>8,i[6]=o&255,o=o>>8,i[5]=o&255,i[4]=s&255,s=s>>8,i[3]=s&255,s=s>>8,i[2]=s&255,s=s>>8,i[1]=s&255,t.push(i)}else throw new Error(`${zt} encountered BigInt larger than allowable range`)}}kd.encodedSize=function(e){return ss.encodedSize(e.value)};ss.encodedSize=function(e){return e<Io[0]?1:e<Io[1]?2:e<Io[2]?3:e<Io[3]?5:9};kd.compareTokens=function(e,r){return e.value<r.value?-1:e.value>r.value?1:0};f();function mG(t,e,r,n){return new Ve(me.negint,-1-Cc(t,e+1,n),2)}function gG(t,e,r,n){return new Ve(me.negint,-1-jc(t,e+1,n),3)}function vG(t,e,r,n){return new Ve(me.negint,-1-$c(t,e+1,n),5)}var PO=BigInt(-1),bG=BigInt(1);function wG(t,e,r,n){let i=Nc(t,e+1,n);if(typeof i!="bigint"){let o=-1-i;if(o>=Number.MIN_SAFE_INTEGER)return new Ve(me.negint,o,9)}if(n.allowBigInt!==!0)throw new Error(`${zt} integers outside of the safe integer range are not supported`);return new Ve(me.negint,PO-BigInt(i),9)}function C8(t,e){let r=e.value,n=typeof r=="bigint"?r*PO-bG:r*-1-1;ss(t,e.type.majorEncoded,n)}C8.encodedSize=function(e){let r=e.value,n=typeof r=="bigint"?r*PO-bG:r*-1-1;return n<Io[0]?1:n<Io[1]?2:n<Io[2]?3:n<Io[3]?5:9};C8.compareTokens=function(e,r){return e.value<r.value?1:e.value>r.value?-1:0};f();function Mx(t,e,r,n){vh(t,e,r+n);let i=Iw(t,e+r,e+r+n);return new Ve(me.bytes,i,r+n)}function _G(t,e,r,n){return Mx(t,e,1,r)}function xG(t,e,r,n){return Mx(t,e,2,Cc(t,e+1,n))}function EG(t,e,r,n){return Mx(t,e,3,jc(t,e+1,n))}function SG(t,e,r,n){return Mx(t,e,5,$c(t,e+1,n))}function TG(t,e,r,n){let i=Nc(t,e+1,n);if(typeof i=="bigint")throw new Error(`${zt} 64-bit integer bytes lengths not supported`);return Mx(t,e,9,i)}function j8(t){return t.encodedBytes===void 0&&(t.encodedBytes=t.type===me.string?cG(t.value):t.value),t.encodedBytes}function Rw(t,e){let r=j8(e);ss(t,e.type.majorEncoded,r.length),t.push(r)}Rw.encodedSize=function(e){let r=j8(e);return ss.encodedSize(r.length)+r.length};Rw.compareTokens=function(e,r){return uSe(j8(e),j8(r))};function uSe(t,e){return t.length<e.length?-1:t.length>e.length?1:lG(t,e)}f();function Dx(t,e,r,n,i){let o=r+n;vh(t,e,o);let s=new Ve(me.string,aG(t,e+r,e+o),o);return i.retainStringBytes===!0&&(s.byteValue=Iw(t,e+r,e+o)),s}function AG(t,e,r,n){return Dx(t,e,1,r,n)}function kG(t,e,r,n){return Dx(t,e,2,Cc(t,e+1,n),n)}function PG(t,e,r,n){return Dx(t,e,3,jc(t,e+1,n),n)}function IG(t,e,r,n){return Dx(t,e,5,$c(t,e+1,n),n)}function RG(t,e,r,n){let i=Nc(t,e+1,n);if(typeof i=="bigint")throw new Error(`${zt} 64-bit integer string lengths not supported`);return Dx(t,e,9,i,n)}var BG=Rw;f();function Bw(t,e,r,n){return new Ve(me.array,n,r)}function OG(t,e,r,n){return Bw(t,e,1,r)}function MG(t,e,r,n){return Bw(t,e,2,Cc(t,e+1,n))}function DG(t,e,r,n){return Bw(t,e,3,jc(t,e+1,n))}function CG(t,e,r,n){return Bw(t,e,5,$c(t,e+1,n))}function jG(t,e,r,n){let i=Nc(t,e+1,n);if(typeof i=="bigint")throw new Error(`${zt} 64-bit integer array lengths not supported`);return Bw(t,e,9,i)}function $G(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${zt} indefinite length items not allowed`);return Bw(t,e,1,1/0)}function $8(t,e){ss(t,me.array.majorEncoded,e.value)}$8.compareTokens=kd.compareTokens;$8.encodedSize=function(e){return ss.encodedSize(e.value)};f();function Ow(t,e,r,n){return new Ve(me.map,n,r)}function NG(t,e,r,n){return Ow(t,e,1,r)}function UG(t,e,r,n){return Ow(t,e,2,Cc(t,e+1,n))}function KG(t,e,r,n){return Ow(t,e,3,jc(t,e+1,n))}function qG(t,e,r,n){return Ow(t,e,5,$c(t,e+1,n))}function LG(t,e,r,n){let i=Nc(t,e+1,n);if(typeof i=="bigint")throw new Error(`${zt} 64-bit integer map lengths not supported`);return Ow(t,e,9,i)}function FG(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${zt} indefinite length items not allowed`);return Ow(t,e,1,1/0)}function N8(t,e){ss(t,me.map.majorEncoded,e.value)}N8.compareTokens=kd.compareTokens;N8.encodedSize=function(e){return ss.encodedSize(e.value)};f();function zG(t,e,r,n){return new Ve(me.tag,r,1)}function VG(t,e,r,n){return new Ve(me.tag,Cc(t,e+1,n),2)}function HG(t,e,r,n){return new Ve(me.tag,jc(t,e+1,n),3)}function WG(t,e,r,n){return new Ve(me.tag,$c(t,e+1,n),5)}function GG(t,e,r,n){return new Ve(me.tag,Nc(t,e+1,n),9)}function U8(t,e){ss(t,me.tag.majorEncoded,e.value)}U8.compareTokens=kd.compareTokens;U8.encodedSize=function(e){return ss.encodedSize(e.value)};f();var mSe=20,gSe=21,vSe=22,bSe=23;function JG(t,e,r,n){if(n.allowUndefined===!1)throw new Error(`${zt} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new Ve(me.null,null,1):new Ve(me.undefined,void 0,1)}function YG(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${zt} indefinite length items not allowed`);return new Ve(me.break,void 0,1)}function IO(t,e,r){if(r){if(r.allowNaN===!1&&Number.isNaN(t))throw new Error(`${zt} NaN values are not supported`);if(r.allowInfinity===!1&&(t===1/0||t===-1/0))throw new Error(`${zt} Infinity values are not supported`)}return new Ve(me.float,t,e)}function ZG(t,e,r,n){return IO(RO(t,e+1),3,n)}function XG(t,e,r,n){return IO(BO(t,e+1),5,n)}function QG(t,e,r,n){return IO(nJ(t,e+1),9,n)}function K8(t,e,r){let n=e.value;if(n===!1)t.push([me.float.majorEncoded|mSe]);else if(n===!0)t.push([me.float.majorEncoded|gSe]);else if(n===null)t.push([me.float.majorEncoded|vSe]);else if(n===void 0)t.push([me.float.majorEncoded|bSe]);else{let i,o=!1;(!r||r.float64!==!0)&&(tJ(n),i=RO(Iu,1),n===i||Number.isNaN(n)?(Iu[0]=249,t.push(Iu.slice(0,3)),o=!0):(rJ(n),i=BO(Iu,1),n===i&&(Iu[0]=250,t.push(Iu.slice(0,5)),o=!0))),o||(wSe(n),i=nJ(Iu,1),Iu[0]=251,t.push(Iu.slice(0,9)))}}K8.encodedSize=function(e,r){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){tJ(n);let i=RO(Iu,1);if(n===i||Number.isNaN(n))return 3;if(rJ(n),i=BO(Iu,1),n===i)return 5}return 9};var eJ=new ArrayBuffer(9),Pd=new DataView(eJ,1),Iu=new Uint8Array(eJ,0);function tJ(t){if(t===1/0)Pd.setUint16(0,31744,!1);else if(t===-1/0)Pd.setUint16(0,64512,!1);else if(Number.isNaN(t))Pd.setUint16(0,32256,!1);else{Pd.setFloat32(0,t);let e=Pd.getUint32(0),r=(e&2139095040)>>23,n=e&8388607;if(r===255)Pd.setUint16(0,31744,!1);else if(r===0)Pd.setUint16(0,(t&2147483648)>>16|n>>13,!1);else{let i=r-127;i<-24?Pd.setUint16(0,0):i<-14?Pd.setUint16(0,(e&2147483648)>>16|1<<24+i,!1):Pd.setUint16(0,(e&2147483648)>>16|i+15<<10|n>>13,!1)}}}function RO(t,e){if(t.length-e<2)throw new Error(`${zt} not enough data for float16`);let r=(t[e]<<8)+t[e+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,i=r&1023,o;return n===0?o=i*2**-24:n!==31?o=(i+1024)*2**(n-25):o=i===0?1/0:NaN,r&32768?-o:o}function rJ(t){Pd.setFloat32(0,t,!1)}function BO(t,e){if(t.length-e<4)throw new Error(`${zt} not enough data for float32`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function wSe(t){Pd.setFloat64(0,t,!1)}function nJ(t,e){if(t.length-e<8)throw new Error(`${zt} not enough data for float64`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}K8.compareTokens=kd.compareTokens;function Xr(t,e,r){throw new Error(`${zt} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function q8(t){return()=>{throw new Error(`${zt} ${t}`)}}var De=[];for(let t=0;t<=23;t++)De[t]=Xr;De[24]=fG;De[25]=hG;De[26]=pG;De[27]=yG;De[28]=Xr;De[29]=Xr;De[30]=Xr;De[31]=Xr;for(let t=32;t<=55;t++)De[t]=Xr;De[56]=mG;De[57]=gG;De[58]=vG;De[59]=wG;De[60]=Xr;De[61]=Xr;De[62]=Xr;De[63]=Xr;for(let t=64;t<=87;t++)De[t]=_G;De[88]=xG;De[89]=EG;De[90]=SG;De[91]=TG;De[92]=Xr;De[93]=Xr;De[94]=Xr;De[95]=q8("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)De[t]=AG;De[120]=kG;De[121]=PG;De[122]=IG;De[123]=RG;De[124]=Xr;De[125]=Xr;De[126]=Xr;De[127]=q8("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)De[t]=OG;De[152]=MG;De[153]=DG;De[154]=CG;De[155]=jG;De[156]=Xr;De[157]=Xr;De[158]=Xr;De[159]=$G;for(let t=160;t<=183;t++)De[t]=NG;De[184]=UG;De[185]=KG;De[186]=qG;De[187]=LG;De[188]=Xr;De[189]=Xr;De[190]=Xr;De[191]=FG;for(let t=192;t<=215;t++)De[t]=zG;De[216]=VG;De[217]=HG;De[218]=WG;De[219]=GG;De[220]=Xr;De[221]=Xr;De[222]=Xr;De[223]=Xr;for(let t=224;t<=243;t++)De[t]=q8("simple values are not supported");De[244]=Xr;De[245]=Xr;De[246]=Xr;De[247]=JG;De[248]=q8("simple values are not supported");De[249]=ZG;De[250]=XG;De[251]=QG;De[252]=Xr;De[253]=Xr;De[254]=Xr;De[255]=YG;var Ru=[];for(let t=0;t<24;t++)Ru[t]=new Ve(me.uint,t,1);for(let t=-1;t>=-24;t--)Ru[31-t]=new Ve(me.negint,t,1);Ru[64]=new Ve(me.bytes,new Uint8Array(0),1);Ru[96]=new Ve(me.string,"",1);Ru[128]=new Ve(me.array,0,1);Ru[160]=new Ve(me.map,0,1);Ru[244]=new Ve(me.false,!1,1);Ru[245]=new Ve(me.true,!0,1);Ru[246]=new Ve(me.null,null,1);function iJ(t){switch(t.type){case me.false:return Ul([244]);case me.true:return Ul([245]);case me.null:return Ul([246]);case me.bytes:return t.value.length?void 0:Ul([64]);case me.string:return t.value===""?Ul([96]):void 0;case me.array:return t.value===0?Ul([128]):void 0;case me.map:return t.value===0?Ul([160]):void 0;case me.uint:return t.value<24?Ul([Number(t.value)]):void 0;case me.negint:if(t.value>=-24)return Ul([31-Number(t.value)])}}var xSe={float64:!1,mapSorter:TSe,quickEncodeToken:iJ};function ESe(){let t=[];return t[me.uint.major]=kd,t[me.negint.major]=C8,t[me.bytes.major]=Rw,t[me.string.major]=BG,t[me.array.major]=$8,t[me.map.major]=N8,t[me.tag.major]=U8,t[me.float.major]=K8,t}var oJ=ESe(),OO=new Bx,F8=class t{constructor(e,r){this.obj=e,this.parent=r}includes(e){let r=this;do if(r.obj===e)return!0;while(r=r.parent);return!1}static createCheck(e,r){if(e&&e.includes(r))throw new Error(`${kO} object contains circular references`);return new t(r,e)}},xy={null:new Ve(me.null,null),undefined:new Ve(me.undefined,void 0),true:new Ve(me.true,!0),false:new Ve(me.false,!1),emptyArray:new Ve(me.array,0),emptyMap:new Ve(me.map,0)},Ey={number(t,e,r,n){return!Number.isInteger(t)||!Number.isSafeInteger(t)?new Ve(me.float,t):t>=0?new Ve(me.uint,t):new Ve(me.negint,t)},bigint(t,e,r,n){return t>=BigInt(0)?new Ve(me.uint,t):new Ve(me.negint,t)},Uint8Array(t,e,r,n){return new Ve(me.bytes,t)},string(t,e,r,n){return new Ve(me.string,t)},boolean(t,e,r,n){return t?xy.true:xy.false},null(t,e,r,n){return xy.null},undefined(t,e,r,n){return xy.undefined},ArrayBuffer(t,e,r,n){return new Ve(me.bytes,new Uint8Array(t))},DataView(t,e,r,n){return new Ve(me.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength))},Array(t,e,r,n){if(!t.length)return r.addBreakTokens===!0?[xy.emptyArray,new Ve(me.break)]:xy.emptyArray;n=F8.createCheck(n,t);let i=[],o=0;for(let s of t)i[o++]=L8(s,r,n);return r.addBreakTokens?[new Ve(me.array,t.length),i,new Ve(me.break)]:[new Ve(me.array,t.length),i]},Object(t,e,r,n){let i=e!=="Object",o=i?t.keys():Object.keys(t),s=i?t.size:o.length;if(!s)return r.addBreakTokens===!0?[xy.emptyMap,new Ve(me.break)]:xy.emptyMap;n=F8.createCheck(n,t);let a=[],d=0;for(let u of o)a[d++]=[L8(u,r,n),L8(i?t.get(u):t[u],r,n)];return SSe(a,r),r.addBreakTokens?[new Ve(me.map,s),a,new Ve(me.break)]:[new Ve(me.map,s),a]}};Ey.Map=Ey.Object;Ey.Buffer=Ey.Uint8Array;for(let t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))Ey[`${t}Array`]=Ey.DataView;function L8(t,e={},r){let n=nG(t),i=e&&e.typeEncoders&&e.typeEncoders[n]||Ey[n];if(typeof i=="function"){let s=i(t,n,e,r);if(s!=null)return s}let o=Ey[n];if(!o)throw new Error(`${kO} unsupported type: ${n}`);return o(t,n,e,r)}function SSe(t,e){e.mapSorter&&t.sort(e.mapSorter)}function TSe(t,e){let r=Array.isArray(t[0])?t[0][0]:t[0],n=Array.isArray(e[0])?e[0][0]:e[0];if(r.type!==n.type)return r.type.compare(n.type);let i=r.type.major,o=oJ[i].compareTokens(r,n);return o===0&&console.warn("WARNING: complex key types used, CBOR key sorting guarantees are gone"),o}function sJ(t,e,r,n){if(Array.isArray(e))for(let i of e)sJ(t,i,r,n);else r[e.type.major](t,e,n)}function ASe(t,e,r){let n=L8(t,r);if(!Array.isArray(n)&&r.quickEncodeToken){let i=r.quickEncodeToken(n);if(i)return i;let o=e[n.type.major];if(o.encodedSize){let s=o.encodedSize(n,r),a=new Bx(s);if(o(a,n,r),a.chunks.length!==1)throw new Error(`Unexpected error: pre-calculated length for ${n} was wrong`);return AO(a.chunks[0])}}return OO.reset(),sJ(OO,n,e,r),OO.toBytes(!0)}function MO(t,e){return e=Object.assign({},xSe,e),ASe(t,oJ,e)}f();var kSe={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},DO=class{constructor(e,r={}){this.pos=0,this.data=e,this.options=r}done(){return this.pos>=this.data.length}next(){let e=this.data[this.pos],r=Ru[e];if(r===void 0){let n=De[e];if(!n)throw new Error(`${zt} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let i=e&31;r=n(this.data,this.pos,i,this.options)}return this.pos+=r.encodedLength,r}},Cx=Symbol.for("DONE"),z8=Symbol.for("BREAK");function PSe(t,e,r){let n=[];for(let i=0;i<t.value;i++){let o=jx(e,r);if(o===z8){if(t.value===1/0)break;throw new Error(`${zt} got unexpected break to lengthed array`)}if(o===Cx)throw new Error(`${zt} found array but not enough entries (got ${i}, expected ${t.value})`);n[i]=o}return n}function ISe(t,e,r){let n=r.useMaps===!0,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<t.value;s++){let a=jx(e,r);if(a===z8){if(t.value===1/0)break;throw new Error(`${zt} got unexpected break to lengthed map`)}if(a===Cx)throw new Error(`${zt} found map but not enough entries (got ${s} [no key], expected ${t.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${zt} non-string keys not supported (got ${typeof a})`);if(r.rejectDuplicateMapKeys===!0&&(n&&o.has(a)||!n&&a in i))throw new Error(`${zt} found repeat map key "${a}"`);let d=jx(e,r);if(d===Cx)throw new Error(`${zt} found map but not enough entries (got ${s} [no value], expected ${t.value})`);n?o.set(a,d):i[a]=d}return n?o:i}function jx(t,e){if(t.done())return Cx;let r=t.next();if(r.type===me.break)return z8;if(r.type.terminal)return r.value;if(r.type===me.array)return PSe(r,t,e);if(r.type===me.map)return ISe(r,t,e);if(r.type===me.tag){if(e.tags&&typeof e.tags[r.value]=="function"){let n=jx(t,e);return e.tags[r.value](n)}throw new Error(`${zt} tag not supported (${r.value})`)}throw new Error("unsupported")}function CO(t,e){if(!(t instanceof Uint8Array))throw new Error(`${zt} data to decode must be a Uint8Array`);e=Object.assign({},kSe,e);let r=e.tokenizer||new DO(t,e),n=jx(r,e);if(n===Cx)throw new Error(`${zt} did not find any content to decode`);if(n===z8)throw new Error(`${zt} got unexpected break`);if(!r.done())throw new Error(`${zt} too many terminals, data makes no sense`);return n}f();var KO={};Or(KO,{base32:()=>Dw,base32hex:()=>USe,base32hexpad:()=>qSe,base32hexpadupper:()=>LSe,base32hexupper:()=>KSe,base32pad:()=>$Se,base32padupper:()=>NSe,base32upper:()=>jSe,base32z:()=>FSe});f();f();f();function BSe(t,e){if(t.length>=255)throw new TypeError("Alphabet too long");for(var r=new Uint8Array(256),n=0;n<r.length;n++)r[n]=255;for(var i=0;i<t.length;i++){var o=t.charAt(i),s=o.charCodeAt(0);if(r[s]!==255)throw new TypeError(o+" is ambiguous");r[s]=i}var a=t.length,d=t.charAt(0),u=Math.log(a)/Math.log(256),c=Math.log(256)/Math.log(a);function l(g){if(g instanceof Uint8Array||(ArrayBuffer.isView(g)?g=new Uint8Array(g.buffer,g.byteOffset,g.byteLength):Array.isArray(g)&&(g=Uint8Array.from(g))),!(g instanceof Uint8Array))throw new TypeError("Expected Uint8Array");if(g.length===0)return"";for(var v=0,x=0,S=0,A=g.length;S!==A&&g[S]===0;)S++,v++;for(var T=(A-S)*c+1>>>0,$=new Uint8Array(T);S!==A;){for(var j=g[S],K=0,F=T-1;(j!==0||K<x)&&F!==-1;F--,K++)j+=256*$[F]>>>0,$[F]=j%a>>>0,j=j/a>>>0;if(j!==0)throw new Error("Non-zero carry");x=K,S++}for(var L=T-x;L!==T&&$[L]===0;)L++;for(var V=d.repeat(v);L<T;++L)V+=t.charAt($[L]);return V}function h(g){if(typeof g!="string")throw new TypeError("Expected String");if(g.length===0)return new Uint8Array;var v=0;if(g[v]!==" "){for(var x=0,S=0;g[v]===d;)x++,v++;for(var A=(g.length-v)*u+1>>>0,T=new Uint8Array(A);g[v];){var $=r[g.charCodeAt(v)];if($===255)return;for(var j=0,K=A-1;($!==0||j<S)&&K!==-1;K--,j++)$+=a*T[K]>>>0,T[K]=$%256>>>0,$=$/256>>>0;if($!==0)throw new Error("Non-zero carry");S=j,v++}if(g[v]!==" "){for(var F=A-S;F!==A&&T[F]===0;)F++;for(var L=new Uint8Array(x+(A-F)),V=x;F!==A;)L[V++]=T[F++];return L}}}function y(g){var v=h(g);if(v)return v;throw new Error(`Non-${e} character`)}return{encode:l,decodeUnsafe:h,decode:y}}var OSe=BSe,MSe=OSe,aJ=MSe;f();var slt=new Uint8Array(0);var cJ=(t,e)=>{if(t===e)return!0;if(t.byteLength!==e.byteLength)return!1;for(let r=0;r<t.byteLength;r++)if(t[r]!==e[r])return!1;return!0},bh=t=>{if(t instanceof Uint8Array&&t.constructor.name==="Uint8Array")return t;if(t instanceof ArrayBuffer)return new Uint8Array(t);if(ArrayBuffer.isView(t))return new Uint8Array(t.buffer,t.byteOffset,t.byteLength);throw new Error("Unknown type, must be binary type")};var dJ=t=>new TextEncoder().encode(t),uJ=t=>new TextDecoder().decode(t);f();var jO=class{constructor(e,r,n){this.name=e,this.prefix=r,this.baseEncode=n}encode(e){if(e instanceof Uint8Array)return`${this.prefix}${this.baseEncode(e)}`;throw Error("Unknown type, must be binary type")}},$O=class{constructor(e,r,n){if(this.name=e,this.prefix=r,r.codePointAt(0)===void 0)throw new Error("Invalid prefix character");this.prefixCodePoint=r.codePointAt(0),this.baseDecode=n}decode(e){if(typeof e=="string"){if(e.codePointAt(0)!==this.prefixCodePoint)throw Error(`Unable to decode multibase string ${JSON.stringify(e)}, ${this.name} decoder only supports inputs prefixed with ${this.prefix}`);return this.baseDecode(e.slice(this.prefix.length))}else throw Error("Can only multibase decode strings")}or(e){return fJ(this,e)}},NO=class{constructor(e){this.decoders=e}or(e){return fJ(this,e)}decode(e){let r=e[0],n=this.decoders[r];if(n)return n.decode(e);throw RangeError(`Unable to decode multibase string ${JSON.stringify(e)}, only inputs prefixed with ${Object.keys(this.decoders)} are supported`)}},fJ=(t,e)=>new NO({...t.decoders||{[t.prefix]:t},...e.decoders||{[e.prefix]:e}}),UO=class{constructor(e,r,n,i){this.name=e,this.prefix=r,this.baseEncode=n,this.baseDecode=i,this.encoder=new jO(e,r,n),this.decoder=new $O(e,r,i)}encode(e){return this.encoder.encode(e)}decode(e){return this.decoder.decode(e)}},Mw=({name:t,prefix:e,encode:r,decode:n})=>new UO(t,e,r,n),Sy=({prefix:t,name:e,alphabet:r})=>{let{encode:n,decode:i}=aJ(r,e);return Mw({prefix:t,name:e,encode:n,decode:o=>bh(i(o))})},DSe=(t,e,r,n)=>{let i={};for(let c=0;c<e.length;++c)i[e[c]]=c;let o=t.length;for(;t[o-1]==="=";)--o;let s=new Uint8Array(o*r/8|0),a=0,d=0,u=0;for(let c=0;c<o;++c){let l=i[t[c]];if(l===void 0)throw new SyntaxError(`Non-${n} character`);d=d<<r|l,a+=r,a>=8&&(a-=8,s[u++]=255&d>>a)}if(a>=r||255&d<<8-a)throw new SyntaxError("Unexpected end of data");return s},CSe=(t,e,r)=>{let n=e[e.length-1]==="=",i=(1<<r)-1,o="",s=0,a=0;for(let d=0;d<t.length;++d)for(a=a<<8|t[d],s+=8;s>r;)s-=r,o+=e[i&a>>s];if(s&&(o+=e[i&a<<r-s]),n)for(;o.length*r&7;)o+="=";return o},_i=({name:t,prefix:e,bitsPerChar:r,alphabet:n})=>Mw({prefix:e,name:t,encode(i){return CSe(i,n,r)},decode(i){return DSe(i,n,r,t)}});var Dw=_i({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),jSe=_i({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),$Se=_i({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),NSe=_i({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),USe=_i({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),KSe=_i({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),qSe=_i({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),LSe=_i({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),FSe=_i({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});var qO={};Or(qO,{base58btc:()=>Kl,base58flickr:()=>zSe});f();var Kl=Sy({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),zSe=Sy({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});f();f();f();var VSe=yJ,hJ=128,HSe=127,WSe=~HSe,GSe=Math.pow(2,31);function yJ(t,e,r){e=e||[],r=r||0;for(var n=r;t>=GSe;)e[r++]=t&255|hJ,t/=128;for(;t&WSe;)e[r++]=t&255|hJ,t>>>=7;return e[r]=t|0,yJ.bytes=r-n+1,e}var JSe=LO,YSe=128,pJ=127;function LO(t,n){var r=0,n=n||0,i=0,o=n,s,a=t.length;do{if(o>=a)throw LO.bytes=0,new RangeError("Could not decode varint");s=t[o++],r+=i<28?(s&pJ)<<i:(s&pJ)*Math.pow(2,i),i+=7}while(s>=YSe);return LO.bytes=o-n,r}var ZSe=Math.pow(2,7),XSe=Math.pow(2,14),QSe=Math.pow(2,21),e5e=Math.pow(2,28),t5e=Math.pow(2,35),r5e=Math.pow(2,42),n5e=Math.pow(2,49),i5e=Math.pow(2,56),o5e=Math.pow(2,63),s5e=function(t){return t<ZSe?1:t<XSe?2:t<QSe?3:t<e5e?4:t<t5e?5:t<r5e?6:t<n5e?7:t<i5e?8:t<o5e?9:10},a5e={encode:VSe,decode:JSe,encodingLength:s5e},c5e=a5e,$x=c5e;var Nx=(t,e=0)=>[$x.decode(t,e),$x.decode.bytes],Cw=(t,e,r=0)=>($x.encode(t,e,r),e),jw=t=>$x.encodingLength(t);var lg=(t,e)=>{let r=e.byteLength,n=jw(t),i=n+jw(r),o=new Uint8Array(i+r);return Cw(t,o,0),Cw(r,o,n),o.set(e,i),new $w(t,r,e,o)},H8=t=>{let e=bh(t),[r,n]=Nx(e),[i,o]=Nx(e.subarray(n)),s=e.subarray(n+o);if(s.byteLength!==i)throw new Error("Incorrect length");return new $w(r,i,s,e)},mJ=(t,e)=>{if(t===e)return!0;{let r=e;return t.code===r.code&&t.size===r.size&&r.bytes instanceof Uint8Array&&cJ(t.bytes,r.bytes)}},$w=class{constructor(e,r,n,i){this.code=e,this.size=r,this.digest=n,this.bytes=i}};f();var gJ=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return u5e(r,FO(t),e||Kl.encoder);default:return l5e(r,FO(t),e||Dw.encoder)}};var vJ=new WeakMap,FO=t=>{let e=vJ.get(t);if(e==null){let r=new Map;return vJ.set(t,r),r}return e},wh=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Kx)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==f5e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=lg(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&mJ(e.multihash,n.multihash)}toString(e){return gJ(this,e)}toJSON(){return{"/":gJ(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s||bJ(n,i,o.bytes))}else if(r[h5e]===!0){let{version:n,multihash:i,code:o}=r,s=H8(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Kx)throw new Error(`Version 0 CID must use dag-pb (code: ${Kx}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=bJ(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Kx,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=bh(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new $w(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[l,h]=Nx(e.subarray(r));return r+=h,l},i=n(),o=Kx;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),d=n(),u=r+d,c=u-s;return{version:i,codec:o,multihashCode:a,digestSize:d,multihashSize:c,size:u}}static parse(e,r){let[n,i]=d5e(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return FO(o).set(n,e),o}},d5e=(t,e)=>{switch(t[0]){case"Q":{let r=e||Kl;return[Kl.prefix,r.decode(`${Kl.prefix}${t}`)]}case Kl.prefix:{let r=e||Kl;return[Kl.prefix,r.decode(t)]}case Dw.prefix:{let r=e||Dw;return[Dw.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},u5e=(t,e,r)=>{let{prefix:n}=r;if(n!==Kl.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i},l5e=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i},Kx=112,f5e=18,bJ=(t,e,r)=>{let n=jw(t),i=n+jw(e),o=new Uint8Array(i+r.byteLength);return Cw(t,o,0),Cw(e,o,n),o.set(r,i),o},h5e=Symbol.for("@ipld/js-cid/CID");var wJ=42;function p5e(t){if(t.asCID!==t&&t["/"]!==t.bytes)return null;let e=wh.asCID(t);if(!e)return null;let r=new Uint8Array(e.bytes.byteLength+1);return r.set(e.bytes,1),[new Ve(me.tag,wJ),new Ve(me.bytes,r)]}function y5e(){throw new Error("`undefined` is not supported by the IPLD Data Model and cannot be encoded")}function m5e(t){if(Number.isNaN(t))throw new Error("`NaN` is not supported by the IPLD Data Model and cannot be encoded");if(t===1/0||t===-1/0)throw new Error("`Infinity` and `-Infinity` is not supported by the IPLD Data Model and cannot be encoded");return null}var g5e={float64:!0,typeEncoders:{Object:p5e,undefined:y5e,number:m5e}};function v5e(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return wh.decode(t.subarray(1))}var _J={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};_J.tags[wJ]=v5e;var b5e="dag-cbor",qx=113,w5e=t=>MO(t,g5e),_5e=t=>CO(t,_J);f();f();f();f();var nc=p9({name:"base58btc",prefix:"z",alphabet:"123456789ABCDEFGHJKLMNPQRSTUVWXYZabcdefghijkmnopqrstuvwxyz"}),Clt=p9({name:"base58flickr",prefix:"Z",alphabet:"123456789abcdefghijkmnopqrstuvwxyzABCDEFGHJKLMNPQRSTUVWXYZ"});f();var Lx=xa({prefix:"b",name:"base32",alphabet:"abcdefghijklmnopqrstuvwxyz234567",bitsPerChar:5}),Ult=xa({prefix:"B",name:"base32upper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567",bitsPerChar:5}),Klt=xa({prefix:"c",name:"base32pad",alphabet:"abcdefghijklmnopqrstuvwxyz234567=",bitsPerChar:5}),qlt=xa({prefix:"C",name:"base32padupper",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZ234567=",bitsPerChar:5}),Llt=xa({prefix:"v",name:"base32hex",alphabet:"0123456789abcdefghijklmnopqrstuv",bitsPerChar:5}),Flt=xa({prefix:"V",name:"base32hexupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV",bitsPerChar:5}),zlt=xa({prefix:"t",name:"base32hexpad",alphabet:"0123456789abcdefghijklmnopqrstuv=",bitsPerChar:5}),Vlt=xa({prefix:"T",name:"base32hexpadupper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUV=",bitsPerChar:5}),zO=xa({prefix:"h",name:"base32z",alphabet:"ybndrfg8ejkmcpqxot1uwisza345h769",bitsPerChar:5});f();var xJ=(t,e)=>{let{bytes:r,version:n}=t;switch(n){case 0:return E5e(r,VO(t),e||nc.encoder);default:return S5e(r,VO(t),e||Lx.encoder)}};var EJ=new WeakMap,VO=t=>{let e=EJ.get(t);if(e==null){let r=new Map;return EJ.set(t,r),r}return e},Fr=class t{constructor(e,r,n,i){this.code=r,this.version=e,this.multihash=n,this.bytes=i,this["/"]=i}get asCID(){return this}get byteOffset(){return this.bytes.byteOffset}get byteLength(){return this.bytes.byteLength}toV0(){switch(this.version){case 0:return this;case 1:{let{code:e,multihash:r}=this;if(e!==Fx)throw new Error("Cannot convert a non dag-pb CID to CIDv0");if(r.code!==T5e)throw new Error("Cannot convert non sha2-256 multihash CID to CIDv0");return t.createV0(r)}default:throw Error(`Can not convert CID version ${this.version} to version 0. This is a bug please report`)}}toV1(){switch(this.version){case 0:{let{code:e,digest:r}=this.multihash,n=G0(e,r);return t.createV1(this.code,n)}case 1:return this;default:throw Error(`Can not convert CID version ${this.version} to version 1. This is a bug please report`)}}equals(e){return t.equals(this,e)}static equals(e,r){let n=r;return n&&e.code===n.code&&e.version===n.version&&WH(e.multihash,n.multihash)}toString(e){return xJ(this,e)}toJSON(){return{"/":xJ(this)}}link(){return this}get[Symbol.toStringTag](){return"CID"}[Symbol.for("nodejs.util.inspect.custom")](){return`CID(${this.toString()})`}static asCID(e){if(e==null)return null;let r=e;if(r instanceof t)return r;if(r["/"]!=null&&r["/"]===r.bytes||r.asCID===r){let{version:n,code:i,multihash:o,bytes:s}=r;return new t(n,i,o,s||SJ(n,i,o.bytes))}else if(r[A5e]===!0){let{version:n,multihash:i,code:o}=r,s=w8(i);return t.create(n,o,s)}else return null}static create(e,r,n){if(typeof r!="number")throw new Error("String codecs are no longer supported");if(!(n.bytes instanceof Uint8Array))throw new Error("Invalid digest");switch(e){case 0:{if(r!==Fx)throw new Error(`Version 0 CID must use dag-pb (code: ${Fx}) block encoding`);return new t(e,r,n,n.bytes)}case 1:{let i=SJ(e,r,n.bytes);return new t(e,r,n,i)}default:throw new Error("Invalid version")}}static createV0(e){return t.create(0,Fx,e)}static createV1(e,r){return t.create(1,e,r)}static decode(e){let[r,n]=t.decodeFirst(e);if(n.length)throw new Error("Incorrect length");return r}static decodeFirst(e){let r=t.inspectBytes(e),n=r.size-r.multihashSize,i=Eu(e.subarray(n,n+r.multihashSize));if(i.byteLength!==r.multihashSize)throw new Error("Incorrect length");let o=i.subarray(r.multihashSize-r.digestSize),s=new uw(r.multihashCode,r.digestSize,o,i);return[r.version===0?t.createV0(s):t.createV1(r.codec,s),e.subarray(r.size)]}static inspectBytes(e){let r=0,n=()=>{let[l,h]=dw(e.subarray(r));return r+=h,l},i=n(),o=Fx;if(i===18?(i=0,r=0):o=n(),i!==0&&i!==1)throw new RangeError(`Invalid CID version ${i}`);let s=r,a=n(),d=n(),u=r+d,c=u-s;return{version:i,codec:o,multihashCode:a,digestSize:d,multihashSize:c,size:u}}static parse(e,r){let[n,i]=x5e(e,r),o=t.decode(i);if(o.version===0&&e[0]!=="Q")throw Error("Version 0 CID string must not include multibase prefix");return VO(o).set(n,e),o}},x5e=(t,e)=>{switch(t[0]){case"Q":{let r=e||nc;return[nc.prefix,r.decode(`${nc.prefix}${t}`)]}case nc.prefix:{let r=e||nc;return[nc.prefix,r.decode(t)]}case Lx.prefix:{let r=e||Lx;return[Lx.prefix,r.decode(t)]}default:{if(e==null)throw Error("To parse non base32 or base58btc encoded CID multibase decoder must be provided");return[t[0],e.decode(t)]}}},E5e=(t,e,r)=>{let{prefix:n}=r;if(n!==nc.prefix)throw Error(`Cannot string encode V0 in ${r.name} encoding`);let i=e.get(n);if(i==null){let o=r.encode(t).slice(1);return e.set(n,o),o}else return i},S5e=(t,e,r)=>{let{prefix:n}=r,i=e.get(n);if(i==null){let o=r.encode(t);return e.set(n,o),o}else return i},Fx=112,T5e=18,SJ=(t,e,r)=>{let n=W0(t),i=n+W0(e),o=new Uint8Array(i+r.byteLength);return H0(t,o,0),H0(e,o,n),o.set(r,i),o},A5e=Symbol.for("@ipld/js-cid/CID");f();var Ty=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},W8=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,d){s=t[o](s),i(a,d,s.done,s.value)})}}function i(o,s,a,d){Promise.resolve(d).then(function(u){o({value:u,done:a})},s)}},Ro=function(t){return this instanceof Ro?(this.v=t,this):new Ro(t)},G8=function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(h){n[h]&&(i[h]=function(y){return new Promise(function(g,v){o.push([h,y,g,v])>1||a(h,y)})})}function a(h,y){try{d(n[h](y))}catch(g){l(o[0][3],g)}}function d(h){h.value instanceof Ro?Promise.resolve(h.value.v).then(u,c):l(o[0][2],h)}function u(h){a("next",h)}function c(h){a("throw",h)}function l(h,y){h(y),o.shift(),o.length&&a(o[0][0],o[0][1])}},zx=class{open(){return Ty(this,void 0,void 0,function*(){})}close(){return Ty(this,void 0,void 0,function*(){})}put(e,r,n){return Ty(this,void 0,void 0,function*(){return e})}get(e,r){return Ty(this,void 0,void 0,function*(){return new Uint8Array})}has(e,r){return Ty(this,void 0,void 0,function*(){return!1})}delete(e,r){return Ty(this,void 0,void 0,function*(){})}isEmpty(e){return Ty(this,void 0,void 0,function*(){return!0})}putMany(e,r){return G8(this,arguments,function*(){var i,o,s,a;try{for(var d=!0,u=W8(e),c;c=yield Ro(u.next()),i=c.done,!i;d=!0){a=c.value,d=!1;let l=a;yield Ro(this.put(l.cid,l.block,r)),yield yield Ro(l.cid)}}catch(l){o={error:l}}finally{try{!d&&!i&&(s=u.return)&&(yield Ro(s.call(u)))}finally{if(o)throw o.error}}})}getMany(e,r){return G8(this,arguments,function*(){var i,o,s,a;try{for(var d=!0,u=W8(e),c;c=yield Ro(u.next()),i=c.done,!i;d=!0){a=c.value,d=!1;let l=a;yield yield Ro({cid:l,block:yield Ro(this.get(l,r))})}}catch(l){o={error:l}}finally{try{!d&&!i&&(s=u.return)&&(yield Ro(s.call(u)))}finally{if(o)throw o.error}}})}getAll(e){return G8(this,arguments,function*(){var n,i,o,s;let a=this.db.iterator({keys:!0,keyEncoding:"buffer"},e);try{for(var d=!0,u=W8(a),c;c=yield Ro(u.next()),n=c.done,!n;d=!0){s=c.value,d=!1;let[l,h]=s;yield yield Ro({cid:Fr.decode(l),block:h})}}catch(l){i={error:l}}finally{try{!d&&!n&&(o=u.return)&&(yield Ro(o.call(u)))}finally{if(i)throw i.error}}})}deleteMany(e,r){return G8(this,arguments,function*(){var i,o,s,a;try{for(var d=!0,u=W8(e),c;c=yield Ro(u.next()),i=c.done,!i;d=!0){a=c.value,d=!1;let l=a;yield Ro(this.delete(l,r)),yield yield Ro(l)}}catch(l){o={error:l}}finally{try{!d&&!i&&(s=u.return)&&(yield Ro(s.call(u)))}finally{if(o)throw o.error}}})}clear(){return Ty(this,void 0,void 0,function*(){})}};f();var G3e=xt(Uc(),1);f();f();f();function P5e(t){return t[Symbol.asyncIterator]!=null}function I5e(t,e=1){return e=Number(e),P5e(t)?async function*(){let r=[];if(e<1&&(e=1),e!==Math.round(e))throw new Error("Batch size must be an integer");for await(let n of t)for(r.push(n);r.length>=e;)yield r.slice(0,e),r=r.slice(e);for(;r.length>0;)yield r.slice(0,e),r=r.slice(e)}():function*(){let r=[];if(e<1&&(e=1),e!==Math.round(e))throw new Error("Batch size must be an integer");for(let n of t)for(r.push(n);r.length>=e;)yield r.slice(0,e),r=r.slice(e);for(;r.length>0;)yield r.slice(0,e),r=r.slice(e)}()}var Vx=I5e;async function*Hx(t,e=1){for await(let r of Vx(t,e)){let n=r.map(async i=>i().then(o=>({ok:!0,value:o}),o=>({ok:!1,err:o})));for(let i=0;i<n.length;i++){let o=await n[i];if(o.ok)yield o.value;else throw o.err}}}f();f();var PJ=Symbol.for("@achingbrain/uint8arraylist");function kJ(t,e){if(e==null||e<0)throw new RangeError("index is out of bounds");let r=0;for(let n of t){let i=r+n.byteLength;if(e<i)return{buf:n,index:e-r};r=i}throw new RangeError("index is out of bounds")}function J8(t){return!!t?.[PJ]}var Nw=class t{bufs;length;[PJ]=!0;constructor(...e){this.bufs=[],this.length=0,e.length>0&&this.appendAll(e)}*[Symbol.iterator](){yield*this.bufs}get byteLength(){return this.length}append(...e){this.appendAll(e)}appendAll(e){let r=0;for(let n of e)if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.push(n);else if(J8(n))r+=n.byteLength,this.bufs.push(...n.bufs);else throw new Error("Could not append value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}prepend(...e){this.prependAll(e)}prependAll(e){let r=0;for(let n of e.reverse())if(n instanceof Uint8Array)r+=n.byteLength,this.bufs.unshift(n);else if(J8(n))r+=n.byteLength,this.bufs.unshift(...n.bufs);else throw new Error("Could not prepend value, must be an Uint8Array or a Uint8ArrayList");this.length+=r}get(e){let r=kJ(this.bufs,e);return r.buf[r.index]}set(e,r){let n=kJ(this.bufs,e);n.buf[n.index]=r}write(e,r=0){if(e instanceof Uint8Array)for(let n=0;n<e.length;n++)this.set(r+n,e[n]);else if(J8(e))for(let n=0;n<e.length;n++)this.set(r+n,e.get(n));else throw new Error("Could not write value, must be an Uint8Array or a Uint8ArrayList")}consume(e){if(e=Math.trunc(e),!(Number.isNaN(e)||e<=0)){if(e===this.byteLength){this.bufs=[],this.length=0;return}for(;this.bufs.length>0;)if(e>=this.bufs[0].byteLength)e-=this.bufs[0].byteLength,this.length-=this.bufs[0].byteLength,this.bufs.shift();else{this.bufs[0]=this.bufs[0].subarray(e),this.length-=e;break}}}slice(e,r){let{bufs:n,length:i}=this._subList(e,r);return gw(n,i)}subarray(e,r){let{bufs:n,length:i}=this._subList(e,r);return n.length===1?n[0]:gw(n,i)}sublist(e,r){let{bufs:n,length:i}=this._subList(e,r),o=new t;return o.length=i,o.bufs=[...n],o}_subList(e,r){if(e=e??0,r=r??this.length,e<0&&(e=this.length+e),r<0&&(r=this.length+r),e<0||r>this.length)throw new RangeError("index is out of bounds");if(e===r)return{bufs:[],length:0};if(e===0&&r===this.length)return{bufs:this.bufs,length:this.length};let n=[],i=0;for(let o=0;o<this.bufs.length;o++){let s=this.bufs[o],a=i,d=a+s.byteLength;if(i=d,e>=d)continue;let u=e>=a&&e<d,c=r>a&&r<=d;if(u&&c){if(e===a&&r===d){n.push(s);break}let l=e-a;n.push(s.subarray(l,l+(r-e)));break}if(u){if(e===0){n.push(s);continue}n.push(s.subarray(e-a));continue}if(c){if(r===d){n.push(s);break}n.push(s.subarray(0,r-a));break}n.push(s)}return{bufs:n,length:r-e}}indexOf(e,r=0){if(!J8(e)&&!(e instanceof Uint8Array))throw new TypeError('The "value" argument must be a Uint8ArrayList or Uint8Array');let n=e instanceof Uint8Array?e:e.subarray();if(r=Number(r??0),isNaN(r)&&(r=0),r<0&&(r=this.length+r),r<0&&(r=0),e.length===0)return r>this.length?this.length:r;let i=n.byteLength;if(i===0)throw new TypeError("search must be at least 1 byte long");let o=256,s=new Int32Array(o);for(let l=0;l<o;l++)s[l]=-1;for(let l=0;l<i;l++)s[n[l]]=l;let a=s,d=this.byteLength-n.byteLength,u=n.byteLength-1,c;for(let l=r;l<=d;l+=c){c=0;for(let h=u;h>=0;h--){let y=this.get(l+h);if(n[h]!==y){c=Math.max(1,h-a[y]);break}}if(c===0)return l}return-1}getInt8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getInt8(0)}setInt8(e,r){let n=rc(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setInt8(0,r),this.write(n,e)}getInt16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt16(0,r)}setInt16(e,r,n){let i=mh(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt16(0,r,n),this.write(i,e)}getInt32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getInt32(0,r)}setInt32(e,r,n){let i=mh(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setInt32(0,r,n),this.write(i,e)}getBigInt64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigInt64(0,r)}setBigInt64(e,r,n){let i=mh(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigInt64(0,r,n),this.write(i,e)}getUint8(e){let r=this.subarray(e,e+1);return new DataView(r.buffer,r.byteOffset,r.byteLength).getUint8(0)}setUint8(e,r){let n=rc(1);new DataView(n.buffer,n.byteOffset,n.byteLength).setUint8(0,r),this.write(n,e)}getUint16(e,r){let n=this.subarray(e,e+2);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint16(0,r)}setUint16(e,r,n){let i=mh(2);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint16(0,r,n),this.write(i,e)}getUint32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getUint32(0,r)}setUint32(e,r,n){let i=mh(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setUint32(0,r,n),this.write(i,e)}getBigUint64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getBigUint64(0,r)}setBigUint64(e,r,n){let i=mh(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setBigUint64(0,r,n),this.write(i,e)}getFloat32(e,r){let n=this.subarray(e,e+4);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat32(0,r)}setFloat32(e,r,n){let i=mh(4);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat32(0,r,n),this.write(i,e)}getFloat64(e,r){let n=this.subarray(e,e+8);return new DataView(n.buffer,n.byteOffset,n.byteLength).getFloat64(0,r)}setFloat64(e,r,n){let i=mh(8);new DataView(i.buffer,i.byteOffset,i.byteLength).setFloat64(0,r,n),this.write(i,e)}equals(e){if(e==null||!(e instanceof t)||e.bufs.length!==this.bufs.length)return!1;for(let r=0;r<this.bufs.length;r++)if(!W9(this.bufs[r],e.bufs[r]))return!1;return!0}static fromUint8Arrays(e,r){let n=new t;return n.bufs=e,r==null&&(r=e.reduce((i,o)=>i+o.byteLength,0)),n.length=r,n}};var R5e=262144,IJ=(t={})=>{let e=t.chunkSize??R5e;return async function*(n){let i=new Nw,o=0,s=!1;for await(let a of n)for(i.append(a),o+=a.length;o>=e;)if(yield i.slice(0,e),s=!0,e===i.length)i=new Nw,o=0;else{let d=new Nw;d.append(i.sublist(e)),i=d,o-=e}(!s||o>0)&&(yield i.subarray(0,o))}};f();var hg={};Or(hg,{code:()=>Gx,createLink:()=>UJ,createNode:()=>NJ,decode:()=>_h,encode:()=>qc,name:()=>q5e,prepare:()=>Kc,validate:()=>GO});f();f();var B5e=new TextDecoder;function HO(t,e){let r=0;for(let n=0;;n+=7){if(n>=64)throw new Error("protobuf: varint overflow");if(e>=t.length)throw new Error("protobuf: unexpected end of data");let i=t[e++];if(r+=n<28?(i&127)<<n:(i&127)*2**n,i<128)break}return[r,e]}function Y8(t,e){let r;[r,e]=HO(t,e);let n=e+r;if(r<0||n<0)throw new Error("protobuf: invalid length");if(n>t.length)throw new Error("protobuf: unexpected end of data");return[t.subarray(e,n),n]}function RJ(t,e){let r;return[r,e]=HO(t,e),[r&7,r>>3,e]}function O5e(t){let e={},r=t.length,n=0;for(;n<r;){let i,o;if([i,o,n]=RJ(t,n),o===1){if(e.Hash)throw new Error("protobuf: (PBLink) duplicate Hash section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Hash`);if(e.Name!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Name before Hash");if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Hash");[e.Hash,n]=Y8(t,n)}else if(o===2){if(e.Name!==void 0)throw new Error("protobuf: (PBLink) duplicate Name section");if(i!==2)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Name`);if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) invalid order, found Tsize before Name");let s;[s,n]=Y8(t,n),e.Name=B5e.decode(s)}else if(o===3){if(e.Tsize!==void 0)throw new Error("protobuf: (PBLink) duplicate Tsize section");if(i!==0)throw new Error(`protobuf: (PBLink) wrong wireType (${i}) for Tsize`);[e.Tsize,n]=HO(t,n)}else throw new Error(`protobuf: (PBLink) invalid fieldNumber, expected 1, 2 or 3, got ${o}`)}if(n>r)throw new Error("protobuf: (PBLink) unexpected end of data");return e}function BJ(t){let e=t.length,r=0,n,i=!1,o;for(;r<e;){let a,d;if([a,d,r]=RJ(t,r),a!==2)throw new Error(`protobuf: (PBNode) invalid wireType, expected 2, got ${a}`);if(d===1){if(o)throw new Error("protobuf: (PBNode) duplicate Data section");[o,r]=Y8(t,r),n&&(i=!0)}else if(d===2){if(i)throw new Error("protobuf: (PBNode) duplicate Links section");n||(n=[]);let u;[u,r]=Y8(t,r),n.push(O5e(u))}else throw new Error(`protobuf: (PBNode) invalid fieldNumber, expected 1 or 2, got ${d}`)}if(r>e)throw new Error("protobuf: (PBNode) unexpected end of data");let s={};return o&&(s.Data=o),s.Links=n||[],s}f();var MJ=new TextEncoder,OJ=2**32,M5e=2**31;function D5e(t,e){let r=e.length;if(typeof t.Tsize=="number"){if(t.Tsize<0)throw new Error("Tsize cannot be negative");if(!Number.isSafeInteger(t.Tsize))throw new Error("Tsize too large for encoding");r=Wx(e,r,t.Tsize)-1,e[r]=24}if(typeof t.Name=="string"){let n=MJ.encode(t.Name);r-=n.length,e.set(n,r),r=Wx(e,r,n.length)-1,e[r]=18}return t.Hash&&(r-=t.Hash.length,e.set(t.Hash,r),r=Wx(e,r,t.Hash.length)-1,e[r]=10),e.length-r}function DJ(t){let e=j5e(t),r=new Uint8Array(e),n=e;if(t.Data&&(n-=t.Data.length,r.set(t.Data,n),n=Wx(r,n,t.Data.length)-1,r[n]=10),t.Links)for(let i=t.Links.length-1;i>=0;i--){let o=D5e(t.Links[i],r.subarray(0,n));n-=o,n=Wx(r,n,o)-1,r[n]=18}return r}function C5e(t){let e=0;if(t.Hash){let r=t.Hash.length;e+=1+r+Uw(r)}if(typeof t.Name=="string"){let r=MJ.encode(t.Name).length;e+=1+r+Uw(r)}return typeof t.Tsize=="number"&&(e+=1+Uw(t.Tsize)),e}function j5e(t){let e=0;if(t.Data){let r=t.Data.length;e+=1+r+Uw(r)}if(t.Links)for(let r of t.Links){let n=C5e(r);e+=1+n+Uw(n)}return e}function Wx(t,e,r){e-=Uw(r);let n=e;for(;r>=M5e;)t[e++]=r&127|128,r/=128;for(;r>=128;)t[e++]=r&127|128,r>>>=7;return t[e]=r,n}function Uw(t){return t%2===0&&t++,Math.floor(($5e(t)+6)/7)}function $5e(t){let e=0;return t>=OJ&&(t=Math.floor(t/OJ),e=32),t>=65536&&(t>>>=16,e+=16),t>=256&&(t>>>=8,e+=8),e+N5e[t]}var N5e=[0,1,2,2,3,3,3,3,4,4,4,4,4,4,4,4,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,6,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,7,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8,8];f();var U5e=["Data","Links"],K5e=["Hash","Name","Tsize"],WO=new TextEncoder;function jJ(t,e){if(t===e)return 0;let r=t.Name?WO.encode(t.Name):[],n=e.Name?WO.encode(e.Name):[],i=r.length,o=n.length;for(let s=0,a=Math.min(i,o);s<a;++s)if(r[s]!==n[s]){i=r[s],o=n[s];break}return i<o?-1:o<i?1:0}function CJ(t,e){return!Object.keys(t).some(r=>!e.includes(r))}function $J(t){if(typeof t.asCID=="object"){let r=Au.asCID(t);if(!r)throw new TypeError("Invalid DAG-PB form");return{Hash:r}}if(typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Hash){let r=Au.asCID(t.Hash);try{r||(typeof t.Hash=="string"?r=Au.parse(t.Hash):t.Hash instanceof Uint8Array&&(r=Au.decode(t.Hash)))}catch(n){throw new TypeError(`Invalid DAG-PB form: ${n.message}`)}r&&(e.Hash=r)}if(!e.Hash)throw new TypeError("Invalid DAG-PB form");return typeof t.Name=="string"&&(e.Name=t.Name),typeof t.Tsize=="number"&&(e.Tsize=t.Tsize),e}function Kc(t){if((t instanceof Uint8Array||typeof t=="string")&&(t={Data:t}),typeof t!="object"||Array.isArray(t))throw new TypeError("Invalid DAG-PB form");let e={};if(t.Data!==void 0)if(typeof t.Data=="string")e.Data=WO.encode(t.Data);else if(t.Data instanceof Uint8Array)e.Data=t.Data;else throw new TypeError("Invalid DAG-PB form");if(t.Links!==void 0)if(Array.isArray(t.Links))e.Links=t.Links.map($J),e.Links.sort(jJ);else throw new TypeError("Invalid DAG-PB form");else e.Links=[];return e}function GO(t){if(!t||typeof t!="object"||Array.isArray(t)||t instanceof Uint8Array||t["/"]&&t["/"]===t.bytes)throw new TypeError("Invalid DAG-PB form");if(!CJ(t,U5e))throw new TypeError("Invalid DAG-PB form (extraneous properties)");if(t.Data!==void 0&&!(t.Data instanceof Uint8Array))throw new TypeError("Invalid DAG-PB form (Data must be bytes)");if(!Array.isArray(t.Links))throw new TypeError("Invalid DAG-PB form (Links must be a list)");for(let e=0;e<t.Links.length;e++){let r=t.Links[e];if(!r||typeof r!="object"||Array.isArray(r)||r instanceof Uint8Array||r["/"]&&r["/"]===r.bytes)throw new TypeError("Invalid DAG-PB form (bad link)");if(!CJ(r,K5e))throw new TypeError("Invalid DAG-PB form (extraneous properties on link)");if(r.Hash===void 0)throw new TypeError("Invalid DAG-PB form (link must have a Hash)");if(r.Hash==null||!r.Hash["/"]||r.Hash["/"]!==r.Hash.bytes)throw new TypeError("Invalid DAG-PB form (link Hash must be a CID)");if(r.Name!==void 0&&typeof r.Name!="string")throw new TypeError("Invalid DAG-PB form (link Name must be a string)");if(r.Tsize!==void 0){if(typeof r.Tsize!="number"||r.Tsize%1!==0)throw new TypeError("Invalid DAG-PB form (link Tsize must be an integer)");if(r.Tsize<0)throw new TypeError("Invalid DAG-PB form (link Tsize cannot be negative)")}if(e>0&&jJ(r,t.Links[e-1])===-1)throw new TypeError("Invalid DAG-PB form (links must be sorted by Name bytes)")}}function NJ(t,e=[]){return Kc({Data:t,Links:e})}function UJ(t,e,r){return $J({Hash:r,Name:t,Tsize:e})}function KJ(t){return t instanceof ArrayBuffer?new Uint8Array(t,0,t.byteLength):t}var q5e="dag-pb",Gx=112;function qc(t){GO(t);let e={};return t.Links&&(e.Links=t.Links.map(r=>{let n={};return r.Hash&&(n.Hash=r.Hash.bytes),r.Name!==void 0&&(n.Name=r.Name),r.Tsize!==void 0&&(n.Tsize=r.Tsize),n})),t.Data&&(e.Data=t.Data),DJ(e)}function _h(t){let e=KJ(t),r=BJ(e),n={};return r.Data&&(n.Data=r.Data),r.Links&&(n.Links=r.Links.map(i=>{let o={};try{o.Hash=Au.decode(i.Hash)}catch{}if(!o.Hash)throw new Error("Invalid Hash field found in link, expected CID");return i.Name!==void 0&&(o.Name=i.Name),i.Tsize!==void 0&&(o.Tsize=i.Tsize),o})),n}f();var aM=xt(Uc(),1);f();f();f();f();f();var L5e=Math.pow(2,7),F5e=Math.pow(2,14),z5e=Math.pow(2,21),qJ=Math.pow(2,28),LJ=Math.pow(2,35),FJ=Math.pow(2,42),zJ=Math.pow(2,49),Ra=128,Ay=127;function Jx(t){if(t<L5e)return 1;if(t<F5e)return 2;if(t<z5e)return 3;if(t<qJ)return 4;if(t<LJ)return 5;if(t<FJ)return 6;if(t<zJ)return 7;if(Number.MAX_SAFE_INTEGER!=null&&t>Number.MAX_SAFE_INTEGER)throw new RangeError("Could not encode varint");return 8}function VJ(t,e,r=0){switch(Jx(t)){case 8:e[r++]=t&255|Ra,t/=128;case 7:e[r++]=t&255|Ra,t/=128;case 6:e[r++]=t&255|Ra,t/=128;case 5:e[r++]=t&255|Ra,t/=128;case 4:e[r++]=t&255|Ra,t>>>=7;case 3:e[r++]=t&255|Ra,t>>>=7;case 2:e[r++]=t&255|Ra,t>>>=7;case 1:{e[r++]=t&255,t>>>=7;break}default:throw new Error("unreachable")}return e}function HJ(t,e){let r=t[e],n=0;if(n+=r&Ay,r<Ra||(r=t[e+1],n+=(r&Ay)<<7,r<Ra)||(r=t[e+2],n+=(r&Ay)<<14,r<Ra)||(r=t[e+3],n+=(r&Ay)<<21,r<Ra)||(r=t[e+4],n+=(r&Ay)*qJ,r<Ra)||(r=t[e+5],n+=(r&Ay)*LJ,r<Ra)||(r=t[e+6],n+=(r&Ay)*FJ,r<Ra)||(r=t[e+7],n+=(r&Ay)*zJ,r<Ra))return n;throw new RangeError("Could not decode varint")}f();var JO=new Float32Array([-0]),ky=new Uint8Array(JO.buffer);function WJ(t,e,r){JO[0]=t,e[r]=ky[0],e[r+1]=ky[1],e[r+2]=ky[2],e[r+3]=ky[3]}function GJ(t,e){return ky[0]=t[e],ky[1]=t[e+1],ky[2]=t[e+2],ky[3]=t[e+3],JO[0]}var YO=new Float64Array([-0]),Zs=new Uint8Array(YO.buffer);function JJ(t,e,r){YO[0]=t,e[r]=Zs[0],e[r+1]=Zs[1],e[r+2]=Zs[2],e[r+3]=Zs[3],e[r+4]=Zs[4],e[r+5]=Zs[5],e[r+6]=Zs[6],e[r+7]=Zs[7]}function YJ(t,e){return Zs[0]=t[e],Zs[1]=t[e+1],Zs[2]=t[e+2],Zs[3]=t[e+3],Zs[4]=t[e+4],Zs[5]=t[e+5],Zs[6]=t[e+6],Zs[7]=t[e+7],YO[0]}f();var V5e=BigInt(Number.MAX_SAFE_INTEGER),H5e=BigInt(Number.MIN_SAFE_INTEGER),Lc=class t{lo;hi;constructor(e,r){this.lo=e|0,this.hi=r|0}toNumber(e=!1){if(!e&&this.hi>>>31>0){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(r+n*4294967296)}return this.lo+this.hi*4294967296}toBigInt(e=!1){if(e)return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n);if(this.hi>>>31){let r=~this.lo+1>>>0,n=~this.hi>>>0;return r===0&&(n=n+1>>>0),-(BigInt(r)+(BigInt(n)<<32n))}return BigInt(this.lo>>>0)+(BigInt(this.hi>>>0)<<32n)}toString(e=!1){return this.toBigInt(e).toString()}zzEncode(){let e=this.hi>>31;return this.hi=((this.hi<<1|this.lo>>>31)^e)>>>0,this.lo=(this.lo<<1^e)>>>0,this}zzDecode(){let e=-(this.lo&1);return this.lo=((this.lo>>>1|this.hi<<31)^e)>>>0,this.hi=(this.hi>>>1^e)>>>0,this}length(){let e=this.lo,r=(this.lo>>>28|this.hi<<4)>>>0,n=this.hi>>>24;return n===0?r===0?e<16384?e<128?1:2:e<2097152?3:4:r<16384?r<128?5:6:r<2097152?7:8:n<128?9:10}static fromBigInt(e){if(e===0n)return pg;if(e<V5e&&e>H5e)return this.fromNumber(Number(e));let r=e<0n;r&&(e=-e);let n=e>>32n,i=e-(n<<32n);return r&&(n=~n|0n,i=~i|0n,++i>ZJ&&(i=0n,++n>ZJ&&(n=0n))),new t(Number(i),Number(n))}static fromNumber(e){if(e===0)return pg;let r=e<0;r&&(e=-e);let n=e>>>0,i=(e-n)/4294967296>>>0;return r&&(i=~i>>>0,n=~n>>>0,++n>4294967295&&(n=0,++i>4294967295&&(i=0))),new t(n,i)}static from(e){return typeof e=="number"?t.fromNumber(e):typeof e=="bigint"?t.fromBigInt(e):typeof e=="string"?t.fromBigInt(BigInt(e)):e.low!=null||e.high!=null?new t(e.low>>>0,e.high>>>0):pg}},pg=new Lc(0,0);pg.toBigInt=function(){return 0n};pg.zzEncode=pg.zzDecode=function(){return this};pg.length=function(){return 1};var ZJ=4294967296n;f();function XJ(t){let e=0,r=0;for(let n=0;n<t.length;++n)r=t.charCodeAt(n),r<128?e+=1:r<2048?e+=2:(r&64512)===55296&&(t.charCodeAt(n+1)&64512)===56320?(++n,e+=4):e+=3;return e}function QJ(t,e,r){if(r-e<1)return"";let i,o=[],s=0,a;for(;e<r;)a=t[e++],a<128?o[s++]=a:a>191&&a<224?o[s++]=(a&31)<<6|t[e++]&63:a>239&&a<365?(a=((a&7)<<18|(t[e++]&63)<<12|(t[e++]&63)<<6|t[e++]&63)-65536,o[s++]=55296+(a>>10),o[s++]=56320+(a&1023)):o[s++]=(a&15)<<12|(t[e++]&63)<<6|t[e++]&63,s>8191&&((i??(i=[])).push(String.fromCharCode.apply(String,o)),s=0);return i!=null?(s>0&&i.push(String.fromCharCode.apply(String,o.slice(0,s))),i.join("")):String.fromCharCode.apply(String,o.slice(0,s))}function ZO(t,e,r){let n=r,i,o;for(let s=0;s<t.length;++s)i=t.charCodeAt(s),i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&((o=t.charCodeAt(s+1))&64512)===56320?(i=65536+((i&1023)<<10)+(o&1023),++s,e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128);return r-n}function Bu(t,e){return RangeError(`index out of range: ${t.pos} + ${e??1} > ${t.len}`)}function Z8(t,e){return(t[e-4]|t[e-3]<<8|t[e-2]<<16|t[e-1]<<24)>>>0}var XO=class{buf;pos;len;_slice=Uint8Array.prototype.subarray;constructor(e){this.buf=e,this.pos=0,this.len=e.length}uint32(){let e=4294967295;if(e=(this.buf[this.pos]&127)>>>0,this.buf[this.pos++]<128||(e=(e|(this.buf[this.pos]&127)<<7)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<14)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&127)<<21)>>>0,this.buf[this.pos++]<128)||(e=(e|(this.buf[this.pos]&15)<<28)>>>0,this.buf[this.pos++]<128))return e;if((this.pos+=5)>this.len)throw this.pos=this.len,Bu(this,10);return e}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)|0}bool(){return this.uint32()!==0}fixed32(){if(this.pos+4>this.len)throw Bu(this,4);return Z8(this.buf,this.pos+=4)}sfixed32(){if(this.pos+4>this.len)throw Bu(this,4);return Z8(this.buf,this.pos+=4)|0}float(){if(this.pos+4>this.len)throw Bu(this,4);let e=GJ(this.buf,this.pos);return this.pos+=4,e}double(){if(this.pos+8>this.len)throw Bu(this,4);let e=YJ(this.buf,this.pos);return this.pos+=8,e}bytes(){let e=this.uint32(),r=this.pos,n=this.pos+e;if(n>this.len)throw Bu(this,e);return this.pos+=e,r===n?new Uint8Array(0):this.buf.subarray(r,n)}string(){let e=this.bytes();return QJ(e,0,e.length)}skip(e){if(typeof e=="number"){if(this.pos+e>this.len)throw Bu(this,e);this.pos+=e}else do if(this.pos>=this.len)throw Bu(this);while(this.buf[this.pos++]&128);return this}skipType(e){switch(e){case 0:this.skip();break;case 1:this.skip(8);break;case 2:this.skip(this.uint32());break;case 3:for(;(e=this.uint32()&7)!==4;)this.skipType(e);break;case 5:this.skip(4);break;default:throw Error(`invalid wire type ${e} at offset ${this.pos}`)}return this}readLongVarint(){let e=new Lc(0,0),r=0;if(this.len-this.pos>4){for(;r<4;++r)if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e;if(e.lo=(e.lo|(this.buf[this.pos]&127)<<28)>>>0,e.hi=(e.hi|(this.buf[this.pos]&127)>>4)>>>0,this.buf[this.pos++]<128)return e;r=0}else{for(;r<3;++r){if(this.pos>=this.len)throw Bu(this);if(e.lo=(e.lo|(this.buf[this.pos]&127)<<r*7)>>>0,this.buf[this.pos++]<128)return e}return e.lo=(e.lo|(this.buf[this.pos++]&127)<<r*7)>>>0,e}if(this.len-this.pos>4){for(;r<5;++r)if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}else for(;r<5;++r){if(this.pos>=this.len)throw Bu(this);if(e.hi=(e.hi|(this.buf[this.pos]&127)<<r*7+3)>>>0,this.buf[this.pos++]<128)return e}throw Error("invalid varint encoding")}readFixed64(){if(this.pos+8>this.len)throw Bu(this,8);let e=Z8(this.buf,this.pos+=4),r=Z8(this.buf,this.pos+=4);return new Lc(e,r)}int64(){return this.readLongVarint().toBigInt()}int64Number(){return this.readLongVarint().toNumber()}int64String(){return this.readLongVarint().toString()}uint64(){return this.readLongVarint().toBigInt(!0)}uint64Number(){let e=HJ(this.buf,this.pos);return this.pos+=Jx(e),e}uint64String(){return this.readLongVarint().toString(!0)}sint64(){return this.readLongVarint().zzDecode().toBigInt()}sint64Number(){return this.readLongVarint().zzDecode().toNumber()}sint64String(){return this.readLongVarint().zzDecode().toString()}fixed64(){return this.readFixed64().toBigInt()}fixed64Number(){return this.readFixed64().toNumber()}fixed64String(){return this.readFixed64().toString()}sfixed64(){return this.readFixed64().toBigInt()}sfixed64Number(){return this.readFixed64().toNumber()}sfixed64String(){return this.readFixed64().toString()}};function QO(t){return new XO(t instanceof Uint8Array?t:t.subarray())}function Yx(t,e,r){let n=QO(t);return e.decode(n,void 0,r)}f();f();f();function eM(t){let e=t??8192,r=e>>>1,n,i=e;return function(s){if(s<1||s>r)return rc(s);i+s>e&&(n=rc(e),i=0);let a=n.subarray(i,i+=s);return i&7&&(i=(i|7)+1),a}}var yg=class{fn;len;next;val;constructor(e,r,n){this.fn=e,this.len=r,this.next=void 0,this.val=n}};function tM(){}var nM=class{head;tail;len;next;constructor(e){this.head=e.head,this.tail=e.tail,this.len=e.len,this.next=e.states}},W5e=eM();function G5e(t){return globalThis.Buffer!=null?rc(t):W5e(t)}var Xx=class{len;head;tail;states;constructor(){this.len=0,this.head=new yg(tM,0,0),this.tail=this.head,this.states=null}_push(e,r,n){return this.tail=this.tail.next=new yg(e,r,n),this.len+=r,this}uint32(e){return this.len+=(this.tail=this.tail.next=new iM((e=e>>>0)<128?1:e<16384?2:e<2097152?3:e<268435456?4:5,e)).len,this}int32(e){return e<0?this._push(X8,10,Lc.fromNumber(e)):this.uint32(e)}sint32(e){return this.uint32((e<<1^e>>31)>>>0)}uint64(e){let r=Lc.fromBigInt(e);return this._push(X8,r.length(),r)}uint64Number(e){return this._push(VJ,Jx(e),e)}uint64String(e){return this.uint64(BigInt(e))}int64(e){return this.uint64(e)}int64Number(e){return this.uint64Number(e)}int64String(e){return this.uint64String(e)}sint64(e){let r=Lc.fromBigInt(e).zzEncode();return this._push(X8,r.length(),r)}sint64Number(e){let r=Lc.fromNumber(e).zzEncode();return this._push(X8,r.length(),r)}sint64String(e){return this.sint64(BigInt(e))}bool(e){return this._push(rM,1,e?1:0)}fixed32(e){return this._push(Zx,4,e>>>0)}sfixed32(e){return this.fixed32(e)}fixed64(e){let r=Lc.fromBigInt(e);return this._push(Zx,4,r.lo)._push(Zx,4,r.hi)}fixed64Number(e){let r=Lc.fromNumber(e);return this._push(Zx,4,r.lo)._push(Zx,4,r.hi)}fixed64String(e){return this.fixed64(BigInt(e))}sfixed64(e){return this.fixed64(e)}sfixed64Number(e){return this.fixed64Number(e)}sfixed64String(e){return this.fixed64String(e)}float(e){return this._push(WJ,4,e)}double(e){return this._push(JJ,8,e)}bytes(e){let r=e.length>>>0;return r===0?this._push(rM,1,0):this.uint32(r)._push(Y5e,r,e)}string(e){let r=XJ(e);return r!==0?this.uint32(r)._push(ZO,r,e):this._push(rM,1,0)}fork(){return this.states=new nM(this),this.head=this.tail=new yg(tM,0,0),this.len=0,this}reset(){return this.states!=null?(this.head=this.states.head,this.tail=this.states.tail,this.len=this.states.len,this.states=this.states.next):(this.head=this.tail=new yg(tM,0,0),this.len=0),this}ldelim(){let e=this.head,r=this.tail,n=this.len;return this.reset().uint32(n),n!==0&&(this.tail.next=e.next,this.tail=r,this.len+=n),this}finish(){let e=this.head.next,r=G5e(this.len),n=0;for(;e!=null;)e.fn(e.val,r,n),n+=e.len,e=e.next;return r}};function rM(t,e,r){e[r]=t&255}function J5e(t,e,r){for(;t>127;)e[r++]=t&127|128,t>>>=7;e[r]=t}var iM=class extends yg{next;constructor(e,r){super(J5e,e,r),this.next=void 0}};function X8(t,e,r){for(;t.hi!==0;)e[r++]=t.lo&127|128,t.lo=(t.lo>>>7|t.hi<<25)>>>0,t.hi>>>=7;for(;t.lo>127;)e[r++]=t.lo&127|128,t.lo=t.lo>>>7;e[r++]=t.lo}function Zx(t,e,r){e[r]=t&255,e[r+1]=t>>>8&255,e[r+2]=t>>>16&255,e[r+3]=t>>>24}function Y5e(t,e,r){e.set(t,r)}globalThis.Buffer!=null&&(Xx.prototype.bytes=function(t){let e=t.length>>>0;return this.uint32(e),e>0&&this._push(Z5e,e,t),this},Xx.prototype.string=function(t){let e=globalThis.Buffer.byteLength(t);return this.uint32(e),e>0&&this._push(X5e,e,t),this});function Z5e(t,e,r){e.set(t,r)}function X5e(t,e,r){t.length<40?ZO(t,e,r):e.utf8Write!=null?e.utf8Write(t,r):e.set(ng(t),r)}function oM(){return new Xx}function Qx(t,e){let r=oM();return e.encode(t,r,{lengthDelimited:!1}),r.finish()}f();f();var Kw;(function(t){t[t.VARINT=0]="VARINT",t[t.BIT64=1]="BIT64",t[t.LENGTH_DELIMITED=2]="LENGTH_DELIMITED",t[t.START_GROUP=3]="START_GROUP",t[t.END_GROUP=4]="END_GROUP",t[t.BIT32=5]="BIT32"})(Kw||(Kw={}));function Q8(t,e,r,n){return{name:t,type:e,encode:r,decode:n}}function sM(t){function e(i){if(t[i.toString()]==null)throw new Error("Invalid enum value");return t[i]}let r=function(o,s){let a=e(o);s.int32(a)},n=function(o){let s=o.int32();return e(s)};return Q8("enum",Kw.VARINT,r,n)}f();function eE(t,e){return Q8("message",Kw.LENGTH_DELIMITED,t,e)}var Ou;(function(t){let e;(function(i){i.Raw="Raw",i.Directory="Directory",i.File="File",i.Metadata="Metadata",i.Symlink="Symlink",i.HAMTShard="HAMTShard"})(e=t.DataType||(t.DataType={}));let r;(function(i){i[i.Raw=0]="Raw",i[i.Directory=1]="Directory",i[i.File=2]="File",i[i.Metadata=3]="Metadata",i[i.Symlink=4]="Symlink",i[i.HAMTShard=5]="HAMTShard"})(r||(r={})),function(i){i.codec=()=>sM(r)}(e=t.DataType||(t.DataType={}));let n;t.codec=()=>(n==null&&(n=eE((i,o,s={})=>{if(s.lengthDelimited!==!1&&o.fork(),i.Type!=null&&(o.uint32(8),t.DataType.codec().encode(i.Type,o)),i.Data!=null&&(o.uint32(18),o.bytes(i.Data)),i.filesize!=null&&(o.uint32(24),o.uint64(i.filesize)),i.blocksizes!=null)for(let a of i.blocksizes)o.uint32(32),o.uint64(a);i.hashType!=null&&(o.uint32(40),o.uint64(i.hashType)),i.fanout!=null&&(o.uint32(48),o.uint64(i.fanout)),i.mode!=null&&(o.uint32(56),o.uint32(i.mode)),i.mtime!=null&&(o.uint32(66),eT.codec().encode(i.mtime,o)),s.lengthDelimited!==!1&&o.ldelim()},(i,o)=>{let s={blocksizes:[]},a=o==null?i.len:i.pos+o;for(;i.pos<a;){let d=i.uint32();switch(d>>>3){case 1:s.Type=t.DataType.codec().decode(i);break;case 2:s.Data=i.bytes();break;case 3:s.filesize=i.uint64();break;case 4:s.blocksizes.push(i.uint64());break;case 5:s.hashType=i.uint64();break;case 6:s.fanout=i.uint64();break;case 7:s.mode=i.uint32();break;case 8:s.mtime=eT.codec().decode(i,i.uint32());break;default:i.skipType(d&7);break}}return s})),n),t.encode=i=>Qx(i,t.codec()),t.decode=i=>Yx(i,t.codec())})(Ou||(Ou={}));var eT;(function(t){let e;t.codec=()=>(e==null&&(e=eE((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.Seconds!=null&&(n.uint32(8),n.int64(r.Seconds)),r.FractionalNanoseconds!=null&&(n.uint32(21),n.fixed32(r.FractionalNanoseconds)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.Seconds=r.int64();break;case 2:i.FractionalNanoseconds=r.fixed32();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Qx(r,t.codec()),t.decode=r=>Yx(r,t.codec())})(eT||(eT={}));var tY;(function(t){let e;t.codec=()=>(e==null&&(e=eE((r,n,i={})=>{i.lengthDelimited!==!1&&n.fork(),r.MimeType!=null&&(n.uint32(10),n.string(r.MimeType)),i.lengthDelimited!==!1&&n.ldelim()},(r,n)=>{let i={},o=n==null?r.len:r.pos+n;for(;r.pos<o;){let s=r.uint32();switch(s>>>3){case 1:i.MimeType=r.string();break;default:r.skipType(s&7);break}}return i})),e),t.encode=r=>Qx(r,t.codec()),t.decode=r=>Yx(r,t.codec())})(tY||(tY={}));var rY={Raw:"raw",Directory:"directory",File:"file",Metadata:"metadata",Symlink:"symlink",HAMTShard:"hamt-sharded-directory"},Q5e=["directory","hamt-sharded-directory"],nY=parseInt("0644",8),iY=parseInt("0755",8),Bo=class t{static unmarshal(e){let r=Ou.decode(e),n=new t({type:rY[r.Type!=null?r.Type.toString():"File"],data:r.Data,blockSizes:r.blocksizes,mode:r.mode,mtime:r.mtime!=null?{secs:r.mtime.Seconds??0n,nsecs:r.mtime.FractionalNanoseconds}:void 0,fanout:r.fanout});return n._originalMode=r.mode??0,n}type;data;blockSizes;hashType;fanout;mtime;_mode;_originalMode;constructor(e={type:"file"}){let{type:r,data:n,blockSizes:i,hashType:o,fanout:s,mtime:a,mode:d}=e;if(r!=null&&!Object.values(rY).includes(r))throw(0,aM.default)(new Error("Type: "+r+" is not valid"),"ERR_INVALID_TYPE");this.type=r??"file",this.data=n,this.hashType=o,this.fanout=s,this.blockSizes=i??[],this._originalMode=0,this.mode=d,this.mtime=a}set mode(e){e==null?this._mode=this.isDirectory()?iY:nY:this._mode=e&4095}get mode(){return this._mode}isDirectory(){return Q5e.includes(this.type)}addBlockSize(e){this.blockSizes.push(e)}removeBlockSize(e){this.blockSizes.splice(e,1)}fileSize(){if(this.isDirectory())return 0n;let e=0n;return this.blockSizes.forEach(r=>{e+=r}),this.data!=null&&(e+=BigInt(this.data.length)),e}marshal(){let e;switch(this.type){case"raw":e=Ou.DataType.Raw;break;case"directory":e=Ou.DataType.Directory;break;case"file":e=Ou.DataType.File;break;case"metadata":e=Ou.DataType.Metadata;break;case"symlink":e=Ou.DataType.Symlink;break;case"hamt-sharded-directory":e=Ou.DataType.HAMTShard;break;default:throw(0,aM.default)(new Error(`Type: ${e} is not valid`),"ERR_INVALID_TYPE")}let r=this.data;(this.data==null||this.data.length===0)&&(r=void 0);let n;this.mode!=null&&(n=this._originalMode&4294963200|(this.mode??0),n===nY&&!this.isDirectory()&&(n=void 0),n===iY&&this.isDirectory()&&(n=void 0));let i;return this.mtime!=null&&(i={Seconds:this.mtime.secs,FractionalNanoseconds:this.mtime.nsecs}),Ou.encode({Type:e,Data:r,filesize:this.isDirectory()?void 0:this.fileSize(),blocksizes:this.blockSizes,hashType:this.hashType,fanout:this.fanout,mode:n,mtime:i})}};var qw={};Or(qw,{code:()=>Py,decode:()=>r3e,encode:()=>t3e,name:()=>e3e});f();var e3e="raw",Py=85,t3e=t=>Eu(t),r3e=t=>Eu(t);f();var xi=class extends Event{type;detail;constructor(e,r){super(e),this.type=e,this.detail=r}};f();var Mu=async(t,e,r)=>{r.codec==null&&(r.codec=hg);let n=await Vs.digest(t),i=Fr.create(r.cidVersion,r.codec.code,n);return await e.put(i,t,r),i};function oY(t){return async function*(r,n){let i=0n;for await(let o of r.content)yield async()=>{let s,a={codec:hg,cidVersion:t.cidVersion,onProgress:t.onProgress};t.rawLeaves?(a.codec=qw,a.cidVersion=1):(s=new Bo({type:t.leafType,data:o}),o=qc({Data:s.marshal(),Links:[]}));let d=await Mu(o,n,a);return i+=BigInt(o.byteLength),t.onProgress?.(new xi("unixfs:importer:progress:file:write",{bytesWritten:i,cid:d,path:r.path})),{cid:d,unixfs:s,size:BigInt(o.length),block:o}}}}f();var cM=xt(Uc(),1);f();var sY=async(t,e,r)=>{let n=new Bo({type:"directory",mtime:t.mtime,mode:t.mode}),i=qc(Kc({Data:n.marshal()})),o=await Mu(i,e,r),s=t.path;return{cid:o,path:s,unixfs:n,size:BigInt(i.length),originalPath:t.originalPath,block:i}};f();async function*n3e(t,e,r){let n=-1,i;for await(let o of Hx(r.bufferImporter(t,e),r.blockWriteConcurrency)){if(n++,n===0){i={...o,single:!0};continue}else n===1&&i!=null&&(yield{...i,block:void 0,single:void 0},i=void 0);yield{...o,block:void 0}}i!=null&&(yield i)}function aY(t){return t.single===!0}var i3e=(t,e,r)=>async function(i){if(i.length===1&&aY(i[0])&&r.reduceSingleLeafToSelf){let c=i[0],l=c.block;return aY(c)&&(t.mtime!==void 0||t.mode!==void 0)&&(c.unixfs=new Bo({type:"file",mtime:t.mtime,mode:t.mode,data:c.block}),l={Data:c.unixfs.marshal(),Links:[]},c.block=qc(Kc(l)),c.cid=await Mu(c.block,e,{...r,cidVersion:r.cidVersion}),c.size=BigInt(c.block.length)),r.onProgress?.(new xi("unixfs:importer:progress:file:layout",{cid:c.cid,path:c.originalPath})),{cid:c.cid,path:t.path,unixfs:c.unixfs,size:c.size,originalPath:c.originalPath}}let o=new Bo({type:"file",mtime:t.mtime,mode:t.mode}),s=i.filter(c=>c.cid.code===Py&&c.size>0||c.unixfs!=null&&c.unixfs.data==null&&c.unixfs.fileSize()>0n?!0:!!c.unixfs?.data?.length).map(c=>c.cid.code===Py?(o.addBlockSize(c.size),{Name:"",Tsize:Number(c.size),Hash:c.cid}):(c.unixfs==null||c.unixfs.data==null?o.addBlockSize(c.unixfs?.fileSize()??0n):o.addBlockSize(BigInt(c.unixfs.data.length)),{Name:"",Tsize:Number(c.size),Hash:c.cid})),a={Data:o.marshal(),Links:s},d=qc(Kc(a)),u=await Mu(d,e,r);return r.onProgress?.(new xi("unixfs:importer:progress:file:layout",{cid:u,path:t.originalPath})),{cid:u,path:t.path,unixfs:o,size:BigInt(d.length+a.Links.reduce((c,l)=>c+(l.Tsize??0),0)),originalPath:t.originalPath,block:d}},cY=async(t,e,r)=>r.layout(n3e(t,e,r),i3e(t,e,r));function o3e(t){return Symbol.iterator in t}function s3e(t){return Symbol.asyncIterator in t}function a3e(t){try{if(t instanceof Uint8Array)return async function*(){yield t}();if(o3e(t))return async function*(){yield*t}();if(s3e(t))return t}catch{throw(0,cM.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}throw(0,cM.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}function dY(t){return async function*(r,n){for await(let i of r){let o;if(i.path!=null&&(o=i.path,i.path=i.path.split("/").filter(s=>s!=null&&s!==".").join("/")),c3e(i)){let s={path:i.path,mtime:i.mtime,mode:i.mode,content:async function*(){let a=0n;for await(let d of t.chunker(t.chunkValidator(a3e(i.content)))){let u=BigInt(d.byteLength);a+=u,t.onProgress?.(new xi("unixfs:importer:progress:file:read",{bytesRead:a,chunkSize:u,path:i.path})),yield d}}(),originalPath:o};yield async()=>cY(s,n,t)}else if(i.path!=null){let s={path:i.path,mtime:i.mtime,mode:i.mode,originalPath:o};yield async()=>sY(s,n,t)}else throw new Error("Import candidate must have content or path or both")}}}function c3e(t){return t.content!=null}f();var EM=xt(Uc(),1);f();f();function tT(t){return globalThis.Buffer!=null?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t}f();f();var dM={};Or(dM,{base10:()=>d3e});f();var d3e=Sy({prefix:"9",name:"base10",alphabet:"0123456789"});var uM={};Or(uM,{base16:()=>u3e,base16upper:()=>l3e});f();var u3e=_i({prefix:"f",name:"base16",alphabet:"0123456789abcdef",bitsPerChar:4}),l3e=_i({prefix:"F",name:"base16upper",alphabet:"0123456789ABCDEF",bitsPerChar:4});var lM={};Or(lM,{base2:()=>f3e});f();var f3e=_i({prefix:"0",name:"base2",alphabet:"01",bitsPerChar:1});var fM={};Or(fM,{base256emoji:()=>g3e});f();var uY=Array.from("\u{1F680}\u{1FA90}\u2604\u{1F6F0}\u{1F30C}\u{1F311}\u{1F312}\u{1F313}\u{1F314}\u{1F315}\u{1F316}\u{1F317}\u{1F318}\u{1F30D}\u{1F30F}\u{1F30E}\u{1F409}\u2600\u{1F4BB}\u{1F5A5}\u{1F4BE}\u{1F4BF}\u{1F602}\u2764\u{1F60D}\u{1F923}\u{1F60A}\u{1F64F}\u{1F495}\u{1F62D}\u{1F618}\u{1F44D}\u{1F605}\u{1F44F}\u{1F601}\u{1F525}\u{1F970}\u{1F494}\u{1F496}\u{1F499}\u{1F622}\u{1F914}\u{1F606}\u{1F644}\u{1F4AA}\u{1F609}\u263A\u{1F44C}\u{1F917}\u{1F49C}\u{1F614}\u{1F60E}\u{1F607}\u{1F339}\u{1F926}\u{1F389}\u{1F49E}\u270C\u2728\u{1F937}\u{1F631}\u{1F60C}\u{1F338}\u{1F64C}\u{1F60B}\u{1F497}\u{1F49A}\u{1F60F}\u{1F49B}\u{1F642}\u{1F493}\u{1F929}\u{1F604}\u{1F600}\u{1F5A4}\u{1F603}\u{1F4AF}\u{1F648}\u{1F447}\u{1F3B6}\u{1F612}\u{1F92D}\u2763\u{1F61C}\u{1F48B}\u{1F440}\u{1F62A}\u{1F611}\u{1F4A5}\u{1F64B}\u{1F61E}\u{1F629}\u{1F621}\u{1F92A}\u{1F44A}\u{1F973}\u{1F625}\u{1F924}\u{1F449}\u{1F483}\u{1F633}\u270B\u{1F61A}\u{1F61D}\u{1F634}\u{1F31F}\u{1F62C}\u{1F643}\u{1F340}\u{1F337}\u{1F63B}\u{1F613}\u2B50\u2705\u{1F97A}\u{1F308}\u{1F608}\u{1F918}\u{1F4A6}\u2714\u{1F623}\u{1F3C3}\u{1F490}\u2639\u{1F38A}\u{1F498}\u{1F620}\u261D\u{1F615}\u{1F33A}\u{1F382}\u{1F33B}\u{1F610}\u{1F595}\u{1F49D}\u{1F64A}\u{1F639}\u{1F5E3}\u{1F4AB}\u{1F480}\u{1F451}\u{1F3B5}\u{1F91E}\u{1F61B}\u{1F534}\u{1F624}\u{1F33C}\u{1F62B}\u26BD\u{1F919}\u2615\u{1F3C6}\u{1F92B}\u{1F448}\u{1F62E}\u{1F646}\u{1F37B}\u{1F343}\u{1F436}\u{1F481}\u{1F632}\u{1F33F}\u{1F9E1}\u{1F381}\u26A1\u{1F31E}\u{1F388}\u274C\u270A\u{1F44B}\u{1F630}\u{1F928}\u{1F636}\u{1F91D}\u{1F6B6}\u{1F4B0}\u{1F353}\u{1F4A2}\u{1F91F}\u{1F641}\u{1F6A8}\u{1F4A8}\u{1F92C}\u2708\u{1F380}\u{1F37A}\u{1F913}\u{1F619}\u{1F49F}\u{1F331}\u{1F616}\u{1F476}\u{1F974}\u25B6\u27A1\u2753\u{1F48E}\u{1F4B8}\u2B07\u{1F628}\u{1F31A}\u{1F98B}\u{1F637}\u{1F57A}\u26A0\u{1F645}\u{1F61F}\u{1F635}\u{1F44E}\u{1F932}\u{1F920}\u{1F927}\u{1F4CC}\u{1F535}\u{1F485}\u{1F9D0}\u{1F43E}\u{1F352}\u{1F617}\u{1F911}\u{1F30A}\u{1F92F}\u{1F437}\u260E\u{1F4A7}\u{1F62F}\u{1F486}\u{1F446}\u{1F3A4}\u{1F647}\u{1F351}\u2744\u{1F334}\u{1F4A3}\u{1F438}\u{1F48C}\u{1F4CD}\u{1F940}\u{1F922}\u{1F445}\u{1F4A1}\u{1F4A9}\u{1F450}\u{1F4F8}\u{1F47B}\u{1F910}\u{1F92E}\u{1F3BC}\u{1F975}\u{1F6A9}\u{1F34E}\u{1F34A}\u{1F47C}\u{1F48D}\u{1F4E3}\u{1F942}"),h3e=uY.reduce((t,e,r)=>(t[r]=e,t),[]),p3e=uY.reduce((t,e,r)=>(t[e.codePointAt(0)]=r,t),[]);function y3e(t){return t.reduce((e,r)=>(e+=h3e[r],e),"")}function m3e(t){let e=[];for(let r of t){let n=p3e[r.codePointAt(0)];if(n===void 0)throw new Error(`Non-base256emoji character: ${r}`);e.push(n)}return new Uint8Array(e)}var g3e=Mw({prefix:"\u{1F680}",name:"base256emoji",encode:y3e,decode:m3e});var hM={};Or(hM,{base36:()=>v3e,base36upper:()=>b3e});f();var v3e=Sy({prefix:"k",name:"base36",alphabet:"0123456789abcdefghijklmnopqrstuvwxyz"}),b3e=Sy({prefix:"K",name:"base36upper",alphabet:"0123456789ABCDEFGHIJKLMNOPQRSTUVWXYZ"});var pM={};Or(pM,{base64:()=>w3e,base64pad:()=>_3e,base64url:()=>Lw,base64urlpad:()=>x3e});f();var w3e=_i({prefix:"m",name:"base64",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",bitsPerChar:6}),_3e=_i({prefix:"M",name:"base64pad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",bitsPerChar:6}),Lw=_i({prefix:"u",name:"base64url",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_",bitsPerChar:6}),x3e=_i({prefix:"U",name:"base64urlpad",alphabet:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-_=",bitsPerChar:6});var yM={};Or(yM,{base8:()=>E3e});f();var E3e=_i({prefix:"7",name:"base8",alphabet:"01234567",bitsPerChar:3});var mM={};Or(mM,{identity:()=>S3e});f();var S3e=Mw({prefix:"\0",name:"identity",encode:t=>uJ(t),decode:t=>dJ(t)});f();var Opt=new TextEncoder,Mpt=new TextDecoder;f();var gM={};Or(gM,{identity:()=>I3e});f();var lY=0,k3e="identity",fY=bh,P3e=t=>lg(lY,fY(t)),I3e={code:lY,name:k3e,encode:fY,digest:P3e};var wM={};Or(wM,{sha256:()=>tE,sha512:()=>R3e});f();f();var bM=({name:t,code:e,encode:r})=>new vM(t,e,r),vM=class{constructor(e,r,n){this.name=e,this.code=r,this.encode=n}digest(e){if(e instanceof Uint8Array){let r=this.encode(e);return r instanceof Uint8Array?lg(this.code,r):r.then(n=>lg(this.code,n))}else throw Error("Unknown type, must be binary type")}};var pY=t=>async e=>new Uint8Array(await crypto.subtle.digest(t,e)),tE=bM({name:"sha2-256",code:18,encode:pY("SHA-256")}),R3e=bM({name:"sha2-512",code:19,encode:pY("SHA-512")});f();f();var _M={...mM,...lM,...yM,...dM,...uM,...KO,...hM,...qO,...pM,...fM},Gpt={...wM,...gM};f();function yY(t=0){return globalThis.Buffer?.allocUnsafe!=null?tT(globalThis.Buffer.allocUnsafe(t)):new Uint8Array(t)}function gY(t,e,r,n){return{name:t,prefix:e,encoder:{name:t,prefix:e,encode:r},decoder:{decode:n}}}var mY=gY("utf8","u",t=>"u"+new TextDecoder("utf8").decode(t),t=>new TextEncoder().encode(t.substring(1))),xM=gY("ascii","a",t=>{let e="a";for(let r=0;r<t.length;r++)e+=String.fromCharCode(t[r]);return e},t=>{t=t.substring(1);let e=yY(t.length);for(let r=0;r<t.length;r++)e[r]=t.charCodeAt(r);return e}),B3e={utf8:mY,"utf-8":mY,hex:_M.base16,latin1:xM,ascii:xM,binary:xM,..._M},vY=B3e;function bY(t,e="utf8"){let r=vY[e];if(r==null)throw new Error(`Unsupported encoding "${e}"`);return(e==="utf8"||e==="utf-8")&&globalThis.Buffer!=null&&globalThis.Buffer.from!=null?tT(globalThis.Buffer.from(t,"utf-8")):r.decoder.decode(`${r.prefix}${t}`)}var wY=()=>async function*(e){for await(let r of e){if(r.length===void 0)throw(0,EM.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT");if(typeof r=="string"||r instanceof String)yield bY(r.toString());else if(Array.isArray(r))yield Uint8Array.from(r);else if(r instanceof Uint8Array)yield r;else throw(0,EM.default)(new Error("Content was invalid"),"ERR_INVALID_CONTENT")}};f();f();var O3e=174;function SM(t){let e=t?.maxChildrenPerNode??O3e;return async function r(n,i){let o=[];for await(let s of Vx(n,e))o.push(await i(s));return o.length>1?r(o,i):o[0]}}f();f();f();f();f();f();var ql=class{options;root;dir;path;dirty;flat;parent;parentKey;unixfs;mode;mtime;cid;size;nodeSize;constructor(e,r){this.options=r??{},this.root=e.root,this.dir=e.dir,this.path=e.path,this.dirty=e.dirty,this.flat=e.flat,this.parent=e.parent,this.parentKey=e.parentKey,this.unixfs=e.unixfs,this.mode=e.mode,this.mtime=e.mtime}},rE=Fr.parse("QmUNLLsPACCz1vLxQVkXqqLX5R1X345qqfHbsf67hvA3Nn"),nE=Fr.parse("zdj7WbTaiJT1fgatdet9Ei9iDB5hdCxkbVyhyh8YTUnXMiwYi");var mg=class extends ql{_children;constructor(e,r){super(e,r),this._children=new Map}async put(e,r){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,this._children.set(e,r)}async get(e){return Promise.resolve(this._children.get(e))}childCount(){return this._children.size}directChildrenCount(){return this.childCount()}onlyChild(){return this._children.values().next().value}async*eachChildSeries(){for(let[e,r]of this._children.entries())yield{key:e,child:r}}estimateNodeSize(){if(this.nodeSize!==void 0)return this.nodeSize;this.nodeSize=0;for(let[e,r]of this._children.entries())r.size!=null&&r.cid!=null&&(this.nodeSize+=e.length+(this.options.cidVersion===1?nE.bytes.byteLength:rE.bytes.byteLength));return this.nodeSize}async*flush(e){let r=[];for(let[d,u]of this._children.entries()){let c=u;if(u instanceof ql)for await(let l of u.flush(e))c=l,yield l;c.size!=null&&c.cid!=null&&r.push({Name:d,Tsize:Number(c.size),Hash:c.cid})}let n=new Bo({type:"directory",mtime:this.mtime,mode:this.mode}),i={Data:n.marshal(),Links:r},o=qc(Kc(i)),s=await Mu(o,e,this.options),a=o.length+i.Links.reduce((d,u)=>d+(u.Tsize==null?0:u.Tsize),0);this.cid=s,this.size=a,yield{cid:s,unixfs:n,path:this.path,size:BigInt(a)}}};f();f();f();var nT=xt(EY(),1);function M3e(t){let e=new Array(4);for(let r=0;r<4;r++)e[r]=t&255,t=t>>8;return new Uint8Array(e)}var zyt=rg({name:"murmur3-32",code:35,encode:t=>M3e(nT.default.x86.hash32(t))}),iT=rg({name:"murmur3-128",code:34,encode:t=>vw.fromHex(nT.default.x64.hash128(t))}),Vyt=rg({name:"murmur3-x64-64",code:34,encode:t=>vw.fromHex(nT.default.x64.hash128(t)).subarray(0,8)});f();f();var kY=xt(AY(),1);var Ll=class t{_options;_popCount;_parent;_posAtParent;_children;key;constructor(e,r,n=0){this._options=e,this._popCount=0,this._parent=r,this._posAtParent=n,this._children=new kY.default,this.key=null}async put(e,r){let n=await this._findNewBucketAndPos(e);n.bucket._putAt(n,e,r)}async get(e){let r=await this._findChild(e);if(r!=null)return r.value}async del(e){let r=await this._findPlace(e),n=r.bucket._at(r.pos);n!=null&&n.key===e&&r.bucket._delAt(r.pos)}leafCount(){return this._children.compactArray().reduce((r,n)=>n instanceof t?r+n.leafCount():r+1,0)}childrenCount(){return this._children.length}onlyChild(){return this._children.get(0)}*eachLeafSeries(){let e=this._children.compactArray();for(let r of e)r instanceof t?yield*r.eachLeafSeries():yield r}serialize(e,r){let n=[];return r(this._children.reduce((i,o,s)=>(o!=null&&(o instanceof t?i.push(o.serialize(e,r)):i.push(e(o,s))),i),n))}async asyncTransform(e,r){return PY(this,e,r)}toJSON(){return this.serialize(N3e,U3e)}prettyPrint(){return JSON.stringify(this.toJSON(),null,"  ")}tableSize(){return Math.pow(2,this._options.bits)}async _findChild(e){let r=await this._findPlace(e),n=r.bucket._at(r.pos);if(!(n instanceof t)&&n!=null&&n.key===e)return n}async _findPlace(e){let r=this._options.hash(typeof e=="string"?ng(e):e),n=await r.take(this._options.bits),i=this._children.get(n);return i instanceof t?i._findPlace(r):{bucket:this,pos:n,hash:r,existingChild:i}}async _findNewBucketAndPos(e){let r=await this._findPlace(e);if(r.existingChild!=null&&r.existingChild.key!==e){let n=new t(this._options,r.bucket,r.pos);r.bucket._putObjectAt(r.pos,n);let i=await n._findPlace(r.existingChild.hash);return i.bucket._putAt(i,r.existingChild.key,r.existingChild.value),n._findNewBucketAndPos(r.hash)}return r}_putAt(e,r,n){this._putObjectAt(e.pos,{key:r,value:n,hash:e.hash})}_putObjectAt(e,r){this._children.get(e)==null&&this._popCount++,this._children.set(e,r)}_delAt(e){if(e===-1)throw new Error("Invalid position");this._children.get(e)!=null&&this._popCount--,this._children.unset(e),this._level()}_level(){if(this._parent!=null&&this._popCount<=1)if(this._popCount===1){let e=this._children.find($3e);if(e!=null&&!(e instanceof t)){let r=e.hash;r.untake(this._options.bits);let n={pos:this._posAtParent,hash:r,bucket:this._parent};this._parent._putAt(n,e.key,e.value)}}else this._parent._delAt(this._posAtParent)}_at(e){return this._children.get(e)}};function $3e(t){return!!t}function N3e(t,e){return t.key}function U3e(t){return t}async function PY(t,e,r){let n=[];for(let i of t._children.compactArray())if(i instanceof Ll)await PY(i,e,r);else{let o=await e(i);n.push({bitField:t._children.bitField(),children:o})}return r(n)}f();f();var K3e=[255,254,252,248,240,224,192,128],q3e=[1,3,7,15,31,63,127,255],oT=class{_value;_currentBytePos;_currentBitPos;constructor(e){this._value=e,this._currentBytePos=e.length-1,this._currentBitPos=7}availableBits(){return this._currentBitPos+1+this._currentBytePos*8}totalBits(){return this._value.length*8}take(e){let r=e,n=0;for(;r>0&&this._haveBits();){let i=this._value[this._currentBytePos],o=this._currentBitPos+1,s=Math.min(o,r),a=L3e(i,o-s,s);n=(n<<s)+a,r-=s,this._currentBitPos-=s,this._currentBitPos<0&&(this._currentBitPos=7,this._currentBytePos--)}return n}untake(e){for(this._currentBitPos+=e;this._currentBitPos>7;)this._currentBitPos-=8,this._currentBytePos+=1}_haveBits(){return this._currentBytePos>=0}};function L3e(t,e,r){let n=F3e(e,r);return(t&n)>>>e}function F3e(t,e){return K3e[t]&q3e[Math.min(e+t-1,7)]}function IY(t){function e(r){return r instanceof sT?r:new sT(r,t)}return e}var sT=class{_value;_hashFn;_depth;_availableBits;_currentBufferIndex;_buffers;constructor(e,r){if(!(e instanceof Uint8Array))throw new Error("can only hash Uint8Arrays");this._value=e,this._hashFn=r,this._depth=-1,this._availableBits=0,this._currentBufferIndex=0,this._buffers=[]}async take(e){let r=e;for(;this._availableBits<r;)await this._produceMoreBits();let n=0;for(;r>0;){let i=this._buffers[this._currentBufferIndex],o=Math.min(i.availableBits(),r),s=i.take(o);n=(n<<o)+s,r-=o,this._availableBits-=o,i.availableBits()===0&&this._currentBufferIndex++}return n}untake(e){let r=e;for(;r>0;){let n=this._buffers[this._currentBufferIndex],i=Math.min(n.totalBits()-n.availableBits(),r);n.untake(i),r-=i,this._availableBits+=i,this._currentBufferIndex>0&&n.totalBits()===n.availableBits()&&(this._depth--,this._currentBufferIndex--)}}async _produceMoreBits(){this._depth++;let e=this._depth>0?gw([this._value,Uint8Array.from([this._depth])]):this._value,r=await this._hashFn(e),n=new oT(r);this._buffers.push(n),this._availableBits+=n.availableBits()}};function aT(t){if(t==null||t.hashFn==null)throw new Error("please define an options.hashFn");let e={bits:t.bits??8,hash:IY(t.hashFn)};return new Ll(e)}async function z3e(t){return(await iT.encode(t)).slice(0,8).reverse()}var RY=BigInt(34),TM=class extends ql{_bucket;constructor(e,r){super(e,r),this._bucket=aT({hashFn:z3e,bits:8})}async put(e,r){this.cid=void 0,this.size=void 0,this.nodeSize=void 0,await this._bucket.put(e,r)}async get(e){return this._bucket.get(e)}childCount(){return this._bucket.leafCount()}directChildrenCount(){return this._bucket.childrenCount()}onlyChild(){return this._bucket.onlyChild()}async*eachChildSeries(){for await(let{key:e,value:r}of this._bucket.eachLeafSeries())yield{key:e,child:r}}estimateNodeSize(){return this.nodeSize!==void 0?this.nodeSize:(this.nodeSize=MY(this._bucket,this,this.options),this.nodeSize)}async*flush(e){for await(let r of OY(this._bucket,e,this,this.options))yield{...r,path:this.path}}},BY=TM;async function*OY(t,e,r,n){let i=t._children,o=[],s=0n;for(let y=0;y<i.length;y++){let g=i.get(y);if(g==null)continue;let v=y.toString(16).toUpperCase().padStart(2,"0");if(g instanceof Ll){let x;for await(let S of OY(g,e,null,n))x=S;if(x==null)throw new Error("Could not flush sharded directory, no subshard found");o.push({Name:v,Tsize:Number(x.size),Hash:x.cid}),s+=x.size}else if(V3e(g.value)){let x=g.value,S;for await(let T of x.flush(e))S=T,yield S;if(S==null)throw new Error("Did not flush dir");let A=v+g.key;o.push({Name:A,Tsize:Number(S.size),Hash:S.cid}),s+=S.size}else{let x=g.value;if(x.cid==null)continue;let S=v+g.key,A=x.size;o.push({Name:S,Tsize:Number(A),Hash:x.cid}),s+=BigInt(A??0)}}let a=Uint8Array.from(i.bitField().reverse()),d=new Bo({type:"hamt-sharded-directory",data:a,fanout:BigInt(t.tableSize()),hashType:RY,mtime:r?.mtime,mode:r?.mode}),u={Data:d.marshal(),Links:o},c=qc(Kc(u)),l=await Mu(c,e,n),h=BigInt(c.byteLength)+s;yield{cid:l,unixfs:d,size:h}}function V3e(t){return typeof t.flush=="function"}function MY(t,e,r){let n=t._children,i=[];for(let d=0;d<n.length;d++){let u=n.get(d);if(u==null)continue;let c=d.toString(16).toUpperCase().padStart(2,"0");if(u instanceof Ll){let l=MY(u,null,r);i.push({Name:c,Tsize:Number(l),Hash:r.cidVersion===0?rE:nE})}else if(typeof u.value.flush=="function"){let h=u.value.nodeSize();i.push({Name:c+u.key,Tsize:Number(h),Hash:r.cidVersion===0?rE:nE})}else{let l=u.value;if(l.cid==null)continue;let h=c+u.key,y=l.size;i.push({Name:h,Tsize:Number(y),Hash:l.cid})}}let o=Uint8Array.from(n.bitField().reverse()),s=new Bo({type:"hamt-sharded-directory",data:o,fanout:BigInt(t.tableSize()),hashType:RY,mtime:e?.mtime,mode:e?.mode});return qc(Kc({Data:s.marshal(),Links:i})).length}async function AM(t,e,r,n){let i=e;e instanceof mg&&e.estimateNodeSize()>r&&(i=await H3e(e,n));let o=i.parent;if(o!=null){if(i!==e){if(t!=null&&(t.parent=i),i.parentKey==null)throw new Error("No parent key found");await o.put(i.parentKey,i)}return AM(i,o,r,n)}return i}async function H3e(t,e){let r=new BY({root:t.root,dir:!0,parent:t.parent,parentKey:t.parentKey,path:t.path,dirty:t.dirty,flat:!1,mtime:t.mtime,mode:t.mode},e);for await(let{key:n,child:i}of t.eachChildSeries())await r.put(n,i);return r}f();var DY=(t="")=>(t.trim().match(/([^\\/]|\\\/)+/g)??[]).filter(Boolean);async function W3e(t,e,r){let n=DY(t.path??""),i=n.length-1,o=e,s="";for(let a=0;a<n.length;a++){let d=n[a];s+=`${s!==""?"/":""}${d}`;let u=a===i;if(o.dirty=!0,o.cid=void 0,o.size=void 0,u)await o.put(d,t),e=await AM(null,o,r.shardSplitThresholdBytes,r);else{let c=await o.get(d);(c==null||!(c instanceof ql))&&(c=new mg({root:!1,dir:!0,parent:o,parentKey:d,path:s,dirty:!0,flat:!0,mtime:c?.unixfs?.mtime,mode:c?.unixfs?.mode},r)),await o.put(d,c),o=c}}return e}async function*CY(t,e){if(!(t instanceof ql)){t.unixfs?.isDirectory()===!0&&(yield t);return}yield*t.flush(e)}function jY(t){return async function*(r,n){let i=new mg({root:!0,dir:!0,path:"",dirty:!0,flat:!0},t),o,s=!1;for await(let a of r){if(a==null)continue;let d=`${a.originalPath??""}`.split("/")[0];d!=null&&d!==""&&(o==null?(o=d,s=!0):o!==d&&(s=!1)),i=await W3e(a,i,t),(a.unixfs==null||!a.unixfs.isDirectory())&&(yield a)}if(t.wrapWithDirectory||s&&i.childCount()>1)yield*CY(i,n);else for await(let a of i.eachChildSeries())a!=null&&(yield*CY(a.child,n))}}async function*oE(t,e,r={}){let n;Symbol.asyncIterator in t||Symbol.iterator in t?n=t:n=[t];let i=r.wrapWithDirectory??!1,o=r.shardSplitThresholdBytes??262144,s=r.cidVersion??1,a=r.rawLeaves??!0,d=r.leafType??"file",u=r.fileImportConcurrency??50,c=r.blockWriteConcurrency??10,l=r.reduceSingleLeafToSelf??!0,h=r.chunker??IJ(),y=r.chunkValidator??wY(),g=r.dagBuilder??dY({chunker:h,chunkValidator:y,wrapWithDirectory:i,layout:r.layout??SM(),bufferImporter:r.bufferImporter??oY({cidVersion:s,rawLeaves:a,leafType:d,onProgress:r.onProgress}),blockWriteConcurrency:c,reduceSingleLeafToSelf:l,cidVersion:s,onProgress:r.onProgress}),v=r.treeBuilder??jY({wrapWithDirectory:i,shardSplitThresholdBytes:o,cidVersion:s,onProgress:r.onProgress});for await(let x of v(Hx(g(n,e),u),e))yield{cid:x.cid,path:x.path,unixfs:x.unixfs,size:x.size}}var kM=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},$Y=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,d){s=t[o](s),i(a,d,s.done,s.value)})}}function i(o,s,a,d){Promise.resolve(d).then(function(u){o({value:u,done:a})},s)}},NY={[Vs.code]:Vs},UY={[qx]:fg},vn=class{static computeCid(e,r=qx,n=Vs.code){return kM(this,void 0,void 0,function*(){let i=UY[r];if(!i)throw new de(se.ComputeCidCodecNotSupported,`codec [${r}] not supported`);let o=NY[n];if(!o)throw new de(se.ComputeCidMultihashNotSupported,`multihash code [${n}] not supported`);let s=i.encode(e),a=yield o.digest(s);return(yield Fr.createV1(i.code,a)).toString()})}static parseCid(e){let r=Fr.parse(e).toV1();if(!UY[r.code])throw new de(se.ParseCidCodecNotSupported,`codec [${r.code}] not supported`);if(!NY[r.multihash.code])throw new de(se.ParseCidMultihashNotSupported,`multihash code [${r.multihash.code}] not supported`);return r}static computeDagPbCidFromBytes(e){var r,n,i,o;return kM(this,void 0,void 0,function*(){let s=oE([{content:e}],new zx,{cidVersion:1}),a;try{for(var d=!0,u=$Y(s),c;c=yield u.next(),r=c.done,!r;d=!0)o=c.value,d=!1,a=o}catch(l){n={error:l}}finally{try{!d&&!r&&(i=u.return)&&(yield i.call(u))}finally{if(n)throw n.error}}return a?a.cid.toString():""})}static computeDagPbCidFromStream(e){var r,n,i,o;return kM(this,void 0,void 0,function*(){let s=oE([{content:e}],new zx,{cidVersion:1}),a;try{for(var d=!0,u=$Y(s),c;c=yield u.next(),r=c.done,!r;d=!0)o=c.value,d=!1,a=o}catch(l){n={error:l}}finally{try{!d&&!r&&(i=u.return)&&(yield i.call(u))}finally{if(n)throw n.error}}return a?a.cid.toString():""})}};f();var lk=xt(iA(),1),dm=xt(eae(),1),K$=xt(dk(),1),uk=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};dm.ECIES_CONFIG.isEphemeralKeyCompressed=!0;var Jh=class t{static aes256CtrEncrypt(e,r,n){return uk(this,void 0,void 0,function*(){let i=lk.createCipheriv("aes-256-ctr",e,r),o=new K$.Readable({read(){}});return n.on("data",s=>{let a=i.update(s);o.push(a)}),n.on("end",()=>{let s=i.final();o.push(s),o.push(null)}),n.on("error",s=>{o.emit("error",s)}),o})}static aes256CtrDecrypt(e,r,n){return uk(this,void 0,void 0,function*(){let i=lk.createDecipheriv("aes-256-ctr",e,r),o=new K$.Readable({read(){}});return n.on("data",s=>{let a=i.update(s);o.push(a)}),n.on("end",()=>{let s=i.final();o.push(s),o.push(null)}),n.on("error",s=>{o.emit("error",s)}),o})}static eciesSecp256k1Encrypt(e,r){return uk(this,void 0,void 0,function*(){let n=M.Buffer.from(e),i=M.Buffer.from(r),o=dm.encrypt(n,i),s=0,a=t.isEphemeralKeyCompressed?33:65,d=o.subarray(s,a);s=a,a+=dm.ECIES_CONFIG.symmetricNonceLength;let u=o.subarray(s,a);s=a,a+=16;let c=o.subarray(s,a);return{ciphertext:o.subarray(a),ephemeralPublicKey:d,initializationVector:u,messageAuthenticationCode:c}})}static eciesSecp256k1Decrypt(e){return uk(this,void 0,void 0,function*(){let r=M.Buffer.from(e.privateKey),n=M.Buffer.concat([e.ephemeralPublicKey,e.initializationVector,e.messageAuthenticationCode,e.ciphertext]);return dm.decrypt(r,n)})}static get isEphemeralKeyCompressed(){return dm.ECIES_CONFIG.isEphemeralKeyCompressed}},lv;(function(t){t.Aes256Ctr="A256CTR",t.EciesSecp256k1="ECIES-ES256K"})(lv||(lv={}));f();var Fde=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},fv=class t{constructor(e){this.jws=e}static create(e,r=[]){return Fde(this,void 0,void 0,function*(){let n={payload:Ke.bytesToBase64Url(e),signatures:[]},i=new t(n);for(let o of r)yield i.addSignature(o);return i})}addSignature(e){return Fde(this,void 0,void 0,function*(){let r={kid:e.keyId,alg:e.algorithm},n=JSON.stringify(r),i=Ke.stringToBase64Url(n),o=`${i}.${this.jws.payload}`,s=Ke.stringToBytes(o),a=yield e.sign(s),d=Ke.bytesToBase64Url(a);this.jws.signatures.push({protected:i,signature:d})})}getJws(){return this.jws}};f();f();f();var fk=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function hs(){if(fk&&typeof fk.subtle=="object"&&fk.subtle!=null)return fk.subtle;throw new Error("crypto.subtle must be defined")}f();function bKe(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function B6(t,...e){if(!bKe(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}var zde={async encrypt(t,e,r,n){let i=hs(),o=await i.importKey("raw",t,e,!0,["encrypt"]),s=await i.encrypt(r,o,n);return new Uint8Array(s)},async decrypt(t,e,r,n){let i=hs(),o=await i.importKey("raw",t,e,!0,["decrypt"]),s=await i.decrypt(r,o,n);return new Uint8Array(s)}},hf={CBC:"AES-CBC",CTR:"AES-CTR",GCM:"AES-GCM"};function wKe(t,e,r){if(t===hf.CBC)return{name:hf.CBC,iv:e};if(t===hf.CTR)return{name:hf.CTR,counter:e,length:64};if(t===hf.GCM)return r?{name:hf.GCM,iv:e,additionalData:r}:{name:hf.GCM,iv:e};throw new Error("unknown aes block mode")}function q$(t){return(e,r,n)=>{B6(e),B6(r);let i={name:t,length:e.length*8},o=wKe(t,r,n);return{encrypt(s){return B6(s),zde.encrypt(e,i,o,s)},decrypt(s){return B6(s),zde.decrypt(e,i,o,s)}}}}var Cxt=q$(hf.CBC),jxt=q$(hf.CTR),$xt=q$(hf.GCM);var hk=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},uo;(function(t){t.DataFormats="dataFormats",t.ProtocolContext="protocolContext",t.ProtocolPath="protocolPath",t.Schemas="schemas"})(uo||(uo={}));var hv=class t{static derivePrivateKey(e,r){var n;return hk(this,void 0,void 0,function*(){let i=Wi.privateJwkToBytes(e.derivedPrivateKey),o=(n=e.derivationPath)!==null&&n!==void 0?n:[],s=yield t.derivePrivateKeyBytes(i,r),a=yield Wi.privateKeyToJwk(s);return{rootKeyId:e.rootKeyId,derivationScheme:e.derivationScheme,derivationPath:[...o,...r],derivedPrivateKey:a}})}static derivePublicKey(e,r){return hk(this,void 0,void 0,function*(){let n=yield t.derivePrivateKey(e,r);return yield Wi.getPublicJwk(n.derivedPrivateKey)})}static derivePrivateKeyBytes(e,r){return hk(this,void 0,void 0,function*(){t.validateKeyDerivationPath(r);let n=e;for(let i of r){let o=Ke.stringToBytes(i);n=yield t.deriveKeyUsingHkdf({hashAlgorithm:"SHA-256",initialKeyMaterial:n,info:o,keyLengthInBytes:32})}return n})}static deriveKeyUsingHkdf(e){return hk(this,void 0,void 0,function*(){let{hashAlgorithm:r,initialKeyMaterial:n,info:i,keyLengthInBytes:o}=e,a=yield hs().importKey("raw",n,{name:"HKDF"},!1,["deriveBits"]),d=yield crypto.subtle.deriveBits({name:"HKDF",hash:r,salt:new Uint8Array(0),info:i},a,o*8);return new Uint8Array(d)})}static validateKeyDerivationPath(e){if(e.includes(""))throw new de(se.HdKeyDerivationPathInvalid,`Invalid key derivation path: ${e}`)}};f();f();function O6(t,e){return t>e?1:t<e?-1:0}f();function M6(t){if(typeof t!="object")return!1;for(let e in t)return!1;return!0}function On(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&On(t[e])})}var pf=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},_e=class t{static validateJsonSchema(e){let r=e.descriptor.interface,n=e.descriptor.method,i=r+n;gh(i,e)}static getSigner(e){return e.authorization===void 0?void 0:cn.getSignerDid(e.authorization.signature.signatures[0])}static getCid(e){return pf(this,void 0,void 0,function*(){let r=Object.assign({},e);return r.encodedData&&delete r.encodedData,yield vn.computeCid(r)})}static compareCid(e,r){return pf(this,void 0,void 0,function*(){let n=yield t.getCid(e),i=yield t.getCid(r);return O6(n,i)})}static createAuthorization(e){return pf(this,void 0,void 0,function*(){let{descriptor:r,signer:n,delegatedGrant:i,permissionGrantId:o,protocolRole:s}=e,a;i!==void 0&&(a=yield t.getCid(i));let u={signature:yield t.createSignature(r,n,{delegatedGrantId:a,permissionGrantId:o,protocolRole:s})};return i!==void 0&&(u.authorDelegatedGrant=i),u})}static createSignature(e,r,n){return pf(this,void 0,void 0,function*(){let i=yield vn.computeCid(e),o=Object.assign({descriptorCid:i},n);On(o);let s=Ke.objectToBytes(o);return(yield fv.create(s,[r])).getJws()})}static getNewestMessage(e){return pf(this,void 0,void 0,function*(){let r;for(let n of e)(r===void 0||(yield t.isNewer(n,r)))&&(r=n);return r})}static getOldestMessage(e){return pf(this,void 0,void 0,function*(){let r;for(let n of e)(r===void 0||(yield t.isOlder(n,r)))&&(r=n);return r})}static isNewer(e,r){return pf(this,void 0,void 0,function*(){return(yield t.compareMessageTimestamp(e,r))>0})}static isOlder(e,r){return pf(this,void 0,void 0,function*(){return(yield t.compareMessageTimestamp(e,r))<0})}static isSignedByAuthorDelegate(e){var r;return((r=e.authorization)===null||r===void 0?void 0:r.authorDelegatedGrant)!==void 0}static isSignedByOwnerDelegate(e){var r;return((r=e.authorization)===null||r===void 0?void 0:r.ownerDelegatedGrant)!==void 0}static compareMessageTimestamp(e,r){return pf(this,void 0,void 0,function*(){return e.descriptor.messageTimestamp>r.descriptor.messageTimestamp?1:e.descriptor.messageTimestamp<r.descriptor.messageTimestamp?-1:t.compareCid(e,r)})}static validateSignatureStructure(e,r,n="GenericSignaturePayload"){return pf(this,void 0,void 0,function*(){if(e.signatures.length!==1)throw new de(se.AuthenticationMoreThanOneSignatureNotSupported,"expected no more than 1 signature for authorization purpose");let i=cn.decodePlainObjectPayload(e);gh(n,i);let{descriptorCid:o}=i,s=yield vn.computeCid(r);if(o!==s)throw new de(se.AuthenticateDescriptorCidMismatch,`provided descriptorCid ${o} does not match expected CID ${s}`);return i})}};f();var _Ke=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},ei=class t{static parse(e){return _Ke(this,void 0,void 0,function*(){return new t(e)})}constructor(e){this.id=e.recordId,this.grantor=_e.getSigner(e),this.grantee=e.descriptor.recipient,this.dateGranted=e.descriptor.dateCreated;let r=e.encodedData,n=Ke.base64UrlToObject(r);this.dateExpires=n.dateExpires,this.delegated=n.delegated,this.description=n.description,this.requestId=n.requestId,this.scope=n.scope,this.conditions=n.conditions}};f();f();var Uo;(function(t){t.CreatedAscending="createdAscending",t.CreatedDescending="createdDescending",t.PublishedAscending="publishedAscending",t.PublishedDescending="publishedDescending"})(Uo||(Uo={}));f();var xKe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},ti=class{static matchAnyFilter(e,r){if(r.length===0)return!0;for(let n of r)if(this.matchFilter(e,n))return!0;return!1}static matchFilter(e,r){for(let n in r){let i=r[n],o=e[n];if(o===void 0||!(Array.isArray(o)?this.matchAnyIndexValue(i,o):this.matchIndexValue(i,o)))return!1}return!0}static matchAnyIndexValue(e,r){for(let n of r)if(this.matchIndexValue(e,n))return!0;return!1}static matchIndexValue(e,r){if(typeof e=="object"){if(Array.isArray(e)){if(this.matchOneOf(e,r))return!0}else if(this.matchRange(e,r))return!0}else if(r===e)return!0;return!1}static matchOneOf(e,r){for(let n of e)if(r===n)return!0;return!1}static matchRange(e,r){return!(e.lt!==void 0&&r>=e.lt||e.lte!==void 0&&r>e.lte||e.gt!==void 0&&r<=e.gt||e.gte!==void 0&&r<e.gte)}static isEqualFilter(e){return typeof e!="object"}static isRangeFilter(e){return typeof e=="object"&&!Array.isArray(e)?"gt"in e||"lt"in e||"lte"in e||"gte"in e:!1}static isOneOfFilter(e){return!!(typeof e=="object"&&Array.isArray(e))}static convertRangeCriterion(e){let r;return e.to!==void 0&&e.from!==void 0?r={gte:e.from,lt:e.to}:e.to!==void 0?r={lt:e.to}:e.from!==void 0&&(r={gte:e.from}),r}static constructPrefixFilterAsRangeFilter(e){return{gte:e,lt:e+"\uFFFF"}}},pk=class{static reduceFilter(e){if(Object.keys(e).length<=1)return e;let{recordId:n,attester:i,parentId:o,recipient:s,contextId:a,author:d,protocolPath:u,schema:c,protocol:l}=e,h=xKe(e,["recordId","attester","parentId","recipient","contextId","author","protocolPath","schema","protocol"]);if(n!==void 0)return{recordId:n};if(i!==void 0)return{attester:i};if(o!==void 0)return{parentId:o};if(s!==void 0)return{recipient:s};if(a!==void 0)return{contextId:a};if(u!==void 0)return{protocolPath:u};if(c!==void 0)return{schema:c};if(l!==void 0)return{protocol:l};let g=Object.keys(h)[0],v={};return v[g]=e[g],v}};f();var Oe;(function(t){t.Messages="Messages",t.Protocols="Protocols",t.Records="Records"})(Oe||(Oe={}));var Ae;(function(t){t.Configure="Configure",t.Query="Query",t.Read="Read",t.Write="Write",t.Delete="Delete",t.Subscribe="Subscribe"})(Ae||(Ae={}));f();function ua(t){let e;try{e=lc(t)}catch{e=void 0}if(t!==e)throw new de(se.UrlProtocolNotNormalized,`Protocol URI ${t} must be normalized.`)}function lc(t){return Vde(t)}function um(t){let e;try{e=pv(t)}catch{e=void 0}if(t!==e)throw new de(se.UrlSchemaNotNormalized,`Schema URI ${t} must be normalized.`)}function pv(t){return Vde(t)}function Vde(t){let e;/^[^:]+:(\/{2})?[^\/].*/.test(t)?e=t:e=`http://${t}`;try{let r=new URL(e);return r.search="",r.hash="",EKe(r.href)}catch{throw new de(se.UrlProtocolNotNormalizable,"Could not normalize protocol URI")}}function EKe(t){return t.endsWith("/")?t.slice(0,-1):t}var L$=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},SKe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},ot=class t{static isRecordsWrite(e){return e.descriptor.interface===Oe.Records&&e.descriptor.method===Ae.Write}static getAuthor(e){let r;return e.authorization.authorDelegatedGrant!==void 0?r=_e.getSigner(e.authorization.authorDelegatedGrant):r=_e.getSigner(e),r}static decrypt(e,r,n){return L$(this,void 0,void 0,function*(){let{encryption:i}=e,o=i.keyEncryption.find(v=>v.rootKeyId===r.rootKeyId&&v.derivationScheme===r.derivationScheme);if(o===void 0)throw new de(se.RecordsDecryptNoMatchingKeyEncryptedFound,`Unable to find a symmetric key encrypted using key         with ID '${r.rootKeyId}' and '${r.derivationScheme}' derivation scheme.`);let s=t.constructKeyDerivationPath(o.derivationScheme,e),a=yield t.derivePrivateKey(r,s),d=Ke.base64UrlToBytes(o.encryptedKey),u=Wi.publicJwkToBytes(o.ephemeralPublicKey),c=Ke.base64UrlToBytes(o.initializationVector),l=Ke.base64UrlToBytes(o.messageAuthenticationCode),h=yield Jh.eciesSecp256k1Decrypt({ciphertext:d,ephemeralPublicKey:u,initializationVector:c,messageAuthenticationCode:l,privateKey:a}),y=Ke.base64UrlToBytes(i.initializationVector);return yield Jh.aes256CtrDecrypt(h,y,n)})}static constructKeyDerivationPath(e,r){let n=r.descriptor,i=r.contextId,o;return e===uo.DataFormats?o=t.constructKeyDerivationPathUsingDataFormatsScheme(n.schema,n.dataFormat):e===uo.ProtocolPath?o=t.constructKeyDerivationPathUsingProtocolPathScheme(n):e===uo.ProtocolContext?o=t.constructKeyDerivationPathUsingProtocolContextScheme(i):o=t.constructKeyDerivationPathUsingSchemasScheme(n.schema),o}static constructKeyDerivationPathUsingDataFormatsScheme(e,r){return e!==void 0?[uo.DataFormats,e,r]:[uo.DataFormats,r]}static constructKeyDerivationPathUsingProtocolPathScheme(e){if(e.protocol===void 0)throw new de(se.RecordsProtocolPathDerivationSchemeMissingProtocol,"Unable to construct key derivation path using `protocols` scheme because `protocol` is missing.");let r=e.protocolPath.split("/");return[uo.ProtocolPath,e.protocol,...r]}static constructKeyDerivationPathUsingProtocolContextScheme(e){if(e===void 0)throw new de(se.RecordsProtocolContextDerivationSchemeMissingContextId,"Unable to construct key derivation path using `protocolContext` scheme because `contextId` is missing.");let r=e.split("/")[0];return[uo.ProtocolContext,r]}static constructKeyDerivationPathUsingSchemasScheme(e){if(e===void 0)throw new de(se.RecordsSchemasDerivationSchemeMissingSchema,"Unable to construct key derivation path using `schemas` scheme because `schema` is missing.");return[uo.Schemas,e]}static derivePrivateKey(e,r){var n;return L$(this,void 0,void 0,function*(){if(e.derivedPrivateKey.crv!=="secp256k1")throw new de(se.RecordsDerivePrivateKeyUnSupportedCurve,`Curve ${e.derivedPrivateKey.crv} is not supported.`);let i=(n=e.derivationPath)!==null&&n!==void 0?n:[];t.validateAncestorKeyAndDescentKeyDerivationPathsMatch(i,r);let o=r.slice(i.length),s=Wi.privateJwkToBytes(e.derivedPrivateKey);return yield hv.derivePrivateKeyBytes(s,o)})}static validateAncestorKeyAndDescentKeyDerivationPathsMatch(e,r){for(let n=0;n<e.length;n++){let i=e[n],o=r[n];if(i!==o)throw new de(se.RecordsInvalidAncestorKeyDerivationSegment,`Ancestor key derivation segment '${i}' mismatches against the descendant key derivation segment '${o}'.`)}}static getParentContextFromOfContextId(e){if(e===void 0)return;let r=e.lastIndexOf("/");return r===-1?"":e.substring(0,r)}static normalizeFilter(e){let r;e.protocol===void 0?r=void 0:r=lc(e.protocol);let n;e.schema===void 0?n=void 0:n=pv(e.schema);let i=Object.assign(Object.assign({},e),{protocol:r,schema:n});return On(i),i}static isStartsWithFilter(e){return typeof e=="object"&&"startsWith"in e&&typeof e.startsWith=="string"}static buildTagIndexes(e){let r={};for(let n in e){let i=e[n];r[`tag.${n}`]=i}return r}static convertTagsFilter(e){let r={};for(let n in e){let i=e[n];r[`tag.${n}`]=this.isStartsWithFilter(i)?ti.constructPrefixFilterAsRangeFilter(i.startsWith):i}return r}static convertFilter(e,r){let{tags:n}=e,i=SKe(e,["tags"]),o={};n!==void 0&&(o=Object.assign({},this.convertTagsFilter(n)));let s=Object.assign(Object.assign({},i),o),{dateCreated:a,datePublished:d,dateUpdated:u,contextId:c}=e,l=a?ti.convertRangeCriterion(a):void 0;l&&(s.dateCreated=l);let h=d?ti.convertRangeCriterion(d):void 0;h&&(s.published=!0,s.datePublished=h),s.published!==!0&&(r===Uo.PublishedAscending||r===Uo.PublishedDescending)&&(s.published=!0);let y=u?ti.convertRangeCriterion(u):void 0;y&&(s.messageTimestamp=y,delete s.dateUpdated);let g=c?ti.constructPrefixFilterAsRangeFilter(c):void 0;return g&&(s.contextId=g),Array.isArray(s.author)&&s.author.length===0&&delete s.author,Array.isArray(s.recipient)&&s.recipient.length===0&&delete s.recipient,s}static validateDelegatedGrantReferentialIntegrity(e,r,n){var i,o;return L$(this,void 0,void 0,function*(){let s=r?.delegatedGrantId!==void 0,a=((i=e.authorization)===null||i===void 0?void 0:i.authorDelegatedGrant)!==void 0;if(s!==a)throw new de(se.RecordsAuthorDelegatedGrantAndIdExistenceMismatch,`delegatedGrantId in message (author) signature and authorDelegatedGrant must both exist or be undefined.          delegatedGrantId in message (author) signature defined: ${s},          authorDelegatedGrant defined: ${a}`);if(a){let c=e.authorization.authorDelegatedGrant;if((yield ei.parse(c)).delegated!==!0)throw new de(se.RecordsAuthorDelegatedGrantNotADelegatedGrant,"The owner delegated grant given is not a delegated grant.");let h=c.descriptor.recipient,y=_e.getSigner(e);if(h!==y)throw new de(se.RecordsAuthorDelegatedGrantGrantedToAndOwnerSignatureMismatch,`grantedTo ${h} in author delegated grant must be the same as the signer ${y} of the message signature.`);let g=yield _e.getCid(c);if(g!==r.delegatedGrantId)throw new de(se.RecordsAuthorDelegatedGrantCidMismatch,`CID of the author delegated grant ${g} must be the same as           the delegatedGrantId ${r.delegatedGrantId} in the message signature.`)}let d=n?.delegatedGrantId!==void 0,u=((o=e.authorization)===null||o===void 0?void 0:o.ownerDelegatedGrant)!==void 0;if(d!==u)throw new de(se.RecordsOwnerDelegatedGrantAndIdExistenceMismatch,`delegatedGrantId in owner signature and ownerDelegatedGrant must both exist or be undefined.          delegatedGrantId in owner signature defined: ${d},          ownerDelegatedGrant defined: ${u}`);if(u){let c=e.authorization.ownerDelegatedGrant;if((yield ei.parse(c)).delegated!==!0)throw new de(se.RecordsOwnerDelegatedGrantNotADelegatedGrant,"The owner delegated grant given is not a delegated grant.");let h=c.descriptor.recipient,y=cn.getSignerDid(e.authorization.ownerSignature.signatures[0]);if(h!==y)throw new de(se.RecordsOwnerDelegatedGrantGrantedToAndOwnerSignatureMismatch,`grantedTo ${h} in owner delegated grant must be the same as the signer ${y} of the owner signature.`);let g=yield _e.getCid(c);if(g!==n.delegatedGrantId)throw new de(se.RecordsOwnerDelegatedGrantCidMismatch,`CID of the owner delegated grant ${g} must be the same as           the delegatedGrantId ${n.delegatedGrantId} in the owner signature.`)}})}static shouldProtocolAuthorize(e){return e.protocolRole!==void 0}static filterIncludesPublishedRecords(e){return e.datePublished!==void 0||e.published!==!1}static filterIncludesUnpublishedRecords(e){return e.datePublished===void 0&&e.published===void 0?!0:e.published===!1}static canPerformDeleteAgainstRecord(e,r){if(r===void 0)return!1;if(r.descriptor.method===Ae.Delete){if(e.descriptor.prune!==!0)return!1;if(r.descriptor.prune===!0)return!1}return!0}static shouldBuildUnpublishedRecipientFilter(e,r){let{recipient:n}=e;return Array.isArray(n)?n.length===0||n.includes(r):n===void 0||n===r}static shouldBuildUnpublishedAuthorFilter(e,r){let{author:n}=e;return Array.isArray(n)?n.length===0||n.includes(r):n===void 0||n===r}};f();f();var F$=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Wd=class t{static performBaseValidation(e){return F$(this,void 0,void 0,function*(){let{incomingMessage:r,expectedGrantor:n,expectedGrantee:i,permissionGrant:o,messageStore:s}=e,a=r.descriptor;t.verifyExpectedGrantorAndGrantee(n,i,o);let d=n;yield t.verifyGrantActive(d,a.messageTimestamp,o,s),yield t.verifyGrantScopeInterfaceAndMethod(a.interface,a.method,o)})}static verifyExpectedGrantorAndGrantee(e,r,n){let i=n.grantee;if(r!==i)throw new de(se.GrantAuthorizationNotGrantedToAuthor,`Permission grant is granted to ${i}, but need to be granted to ${r}`);let o=n.grantor;if(e!==o)throw new de(se.GrantAuthorizationNotGrantedForTenant,`Permission grant is granted by ${o}, but need to be granted by ${e}`)}static verifyGrantActive(e,r,n,i){return F$(this,void 0,void 0,function*(){if(r<n.dateGranted)throw new de(se.GrantAuthorizationGrantNotYetActive,"The message has a timestamp before the associated permission grant becomes active");if(r>=n.dateExpires)throw new de(se.GrantAuthorizationGrantExpired,"The message has timestamp after the expiry of the associated permission grant");let o={parentId:n.id,protocolPath:"grant/revocation",isLatestBaseState:!0},{messages:s}=yield i.query(e,[o]),a=yield _e.getOldestMessage(s);if(a!==void 0&&a.descriptor.messageTimestamp<=r)throw new de(se.GrantAuthorizationGrantRevoked,`Permission grant with CID ${n.id} has been revoked`)})}static verifyGrantScopeInterfaceAndMethod(e,r,n){return F$(this,void 0,void 0,function*(){if(e!==n.scope.interface)throw new de(se.GrantAuthorizationInterfaceMismatch,`DWN Interface of incoming message is outside the scope of permission grant with ID ${n.id}`);if(r!==n.scope.method)throw new de(se.GrantAuthorizationMethodMismatch,`DWN Method of incoming message is outside the scope of permission grant with ID ${n.id}`)})}};f();var D6;(function(t){t.Required="Required",t.Prohibited="Prohibited"})(D6||(D6={}));var yk=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},ps=class t{static authorizeWrite(e){return yk(this,void 0,void 0,function*(){let{recordsWriteMessage:r,expectedGrantor:n,expectedGrantee:i,permissionGrant:o,messageStore:s}=e;yield Wd.performBaseValidation({incomingMessage:r,expectedGrantor:n,expectedGrantee:i,permissionGrant:o,messageStore:s}),t.verifyScope(r,o.scope),t.verifyConditions(r,o.conditions)})}static authorizeRead(e){return yk(this,void 0,void 0,function*(){let{recordsReadMessage:r,recordsWriteMessageToBeRead:n,expectedGrantor:i,expectedGrantee:o,permissionGrant:s,messageStore:a}=e;yield Wd.performBaseValidation({incomingMessage:r,expectedGrantor:i,expectedGrantee:o,permissionGrant:s,messageStore:a}),t.verifyScope(n,s.scope)})}static authorizeQueryOrSubscribe(e){return yk(this,void 0,void 0,function*(){let{incomingMessage:r,expectedGrantor:n,expectedGrantee:i,permissionGrant:o,messageStore:s}=e;yield Wd.performBaseValidation({incomingMessage:r,expectedGrantor:n,expectedGrantee:i,permissionGrant:o,messageStore:s});let d=o.scope.protocol,u=r.descriptor.filter.protocol;if(d!==void 0&&u!==d)throw new de(se.RecordsGrantAuthorizationQueryOrSubscribeProtocolScopeMismatch,`Grant protocol scope ${d} does not match protocol in message ${u}`)})}static authorizeDelete(e){return yk(this,void 0,void 0,function*(){let{recordsDeleteMessage:r,recordsWriteToDelete:n,expectedGrantor:i,expectedGrantee:o,permissionGrant:s,messageStore:a}=e;yield Wd.performBaseValidation({incomingMessage:r,expectedGrantor:i,expectedGrantee:o,permissionGrant:s,messageStore:a});let u=s.scope.protocol,c=n.descriptor.protocol;if(u!==void 0&&c!==u)throw new de(se.RecordsGrantAuthorizationDeleteProtocolScopeMismatch,`Grant protocol scope ${u} does not match protocol in record to delete ${c}`)})}static verifyScope(e,r){if(r.protocol!==e.descriptor.protocol)throw new de(se.RecordsGrantAuthorizationScopeProtocolMismatch,"Grant scope specifies different protocol than what appears in the record");if(r.contextId!==void 0&&(e.contextId===void 0||!e.contextId.startsWith(r.contextId)))throw new de(se.RecordsGrantAuthorizationScopeContextIdMismatch,"Grant scope specifies different contextId than what appears in the record");if(r.protocolPath!==void 0&&r.protocolPath!==e.descriptor.protocolPath)throw new de(se.RecordsGrantAuthorizationScopeProtocolPathMismatch,"Grant scope specifies different protocolPath than what appears in the record")}static verifyConditions(e,r){if(r?.publication===D6.Required&&!e.descriptor.published)throw new de(se.RecordsGrantAuthorizationConditionPublicationRequired,"Permission grant requires message to be published");if(r?.publication===D6.Prohibited&&e.descriptor.published)throw new de(se.RecordsGrantAuthorizationConditionPublicationProhibited,"Permission grant prohibits message from being published")}};f();f();var z=xt(Hde(),1),X$={};function Ef(t,e){Object.defineProperty(t.prototype,Symbol.toStringTag,{value:e,writable:!1,enumerable:!1,configurable:!0});for(let r of Object.getOwnPropertyNames(t)){let n=Object.getOwnPropertyDescriptor(t,r);n.configurable&&n.enumerable&&(n.enumerable=!1,Object.defineProperty(t,r,n))}for(let r of Object.getOwnPropertyNames(t.prototype)){let n=Object.getOwnPropertyDescriptor(t.prototype,r);n.configurable&&n.enumerable&&(n.enumerable=!1,Object.defineProperty(t.prototype,r,n))}Dn(e,t),Dn(`${e}.prototype`,t.prototype)}function Dn(t,e){let r=`%${t}%`;if(X$[r]!==void 0)throw new Error(`intrinsic ${t} already exists`);X$[r]=e}function Ee(t){return X$[t]}var Wde,Gde,ft="slot-epochNanoSeconds",mf="slot-timezone-identifier",Ie="slot-year",Me="slot-month",je="slot-day",Tt="slot-hour",At="slot-minute",kt="slot-second",Pt="slot-millisecond",It="slot-microsecond",Rt="slot-nanosecond",fe="slot-calendar",Iue="slot-date-brand",Rue="slot-year-month-brand",Bue="slot-month-day-brand",Lo="slot-cached-instant",zr="slot-time-zone",ys="slot-years",Xi="slot-months",la="slot-weeks",ms="slot-days",gs="slot-hours",vs="slot-minutes",bs="slot-seconds",ws="slot-milliseconds",_s="slot-microseconds",xs="slot-nanoseconds",Mn="slot-calendar-identifier",Oue=new WeakMap,Q$=Symbol.for("@@Temporal__GetSlots");(Wde=globalThis)[Q$]||(Wde[Q$]=function(e){return Oue.get(e)});var PN=globalThis[Q$],eN=Symbol.for("@@Temporal__CreateSlots");(Gde=globalThis)[eN]||(Gde[eN]=function(e){Oue.set(e,Object.create(null))});var Sf=globalThis[eN];function $i(t,...e){if(!t||typeof t!="object")return!1;let r=PN(t);return!!r&&e.every(n=>n in r)}function O(t,e){let r=PN(t)?.[e];if(r===void 0)throw new TypeError(`Missing internal slot ${e}`);return r}function Dt(t,e,r){let n=PN(t);if(n===void 0)throw new TypeError("Missing slots for the given container");if(n[e])throw new TypeError(`${e} already has set`);n[e]=r}var Jde=/\.[-A-Za-z_]|\.\.[-A-Za-z._]{1,12}|\.[-A-Za-z_][-A-Za-z._]{0,12}|[A-Za-z_][-A-Za-z._]{0,13}/,X6=new RegExp("(?:"+[`(?:${Jde.source})(?:\\/(?:${Jde.source}))*`,"Etc/GMT(?:0|[-+]\\d{1,2})","GMT[-+]?0","EST5EDT","CST6CDT","MST7MDT","PST8PDT",/(?:[+\u2212-][0-2][0-9](?::?[0-5][0-9](?::?[0-5][0-9](?:[.,]\d{1,9})?)?)?)/.source].join("|")+")"),Mue=/(?:[+\u2212-]\d{6}|\d{4})/,_k=/(?:0[1-9]|1[0-2])/,tN=/(?:0[1-9]|[12]\d|3[01])/,TKe=new RegExp(`(${Mue.source})(?:-(${_k.source})-(${tN.source})|(${_k.source})(${tN.source}))`),Due=/(\d{2})(?::(\d{2})(?::(\d{2})(?:[.,](\d{1,9}))?)?|(\d{2})(?:(\d{2})(?:[.,](\d{1,9}))?)?)?/,Cue=/([+\u2212-])([01][0-9]|2[0-3])(?::?([0-5][0-9])(?::?([0-5][0-9])(?:[.,](\d{1,9}))?)?)?/,jue=new RegExp(`([zZ])|${Cue.source}?`),wm=/\[(!)?([a-z_][a-z0-9_-]*)=([A-Za-z0-9]+(?:-[A-Za-z0-9]+)*)\]/g,AKe=new RegExp([`^${TKe.source}`,`(?:(?:T|\\s+)${Due.source}(?:${jue.source})?)?`,`(?:\\[!?(${X6.source})\\])?`,`((?:${wm.source})*)$`].join(""),"i"),kKe=new RegExp([`^T?${Due.source}`,`(?:${jue.source})?`,`(?:\\[!?${X6.source}\\])?`,`((?:${wm.source})*)$`].join(""),"i"),PKe=new RegExp(`^(${Mue.source})-?(${_k.source})(?:\\[!?${X6.source}\\])?((?:${wm.source})*)$`),IKe=new RegExp(`^(?:--)?(${_k.source})-?(${tN.source})(?:\\[!?${X6.source}\\])?((?:${wm.source})*)$`),H$=/(\d+)(?:[.,](\d{1,9}))?/,RKe=new RegExp(`(?:${H$.source}H)?(?:${H$.source}M)?(?:${H$.source}S)?`),BKe=new RegExp(`^([+\u2212-])?P${/(?:(\d+)Y)?(?:(\d+)M)?(?:(\d+)W)?(?:(\d+)D)?/.source}(?:T(?!$)${RKe.source})?$`,"i"),OKe=Array.prototype.includes,$ue=Array.prototype.push,Nue=globalThis.Intl.DateTimeFormat,MKe=Math.min,DKe=Math.max,hn=Math.abs,Na=Math.floor,d2=Math.sign,gv=Math.trunc,$k=Number.isNaN,Es=Number.isFinite,CKe=Number,Q6=String,jKe=Number.MAX_SAFE_INTEGER,zo=Object.create,$Ke=Object.getOwnPropertyDescriptor,Nk=Reflect.apply,NKe=Reflect.ownKeys,Ln=z.default.BigInt(0),v2=z.default.BigInt(1),gf=z.default.BigInt(60),Uue=z.default.BigInt(24),Rr=z.default.BigInt(1e3),Qc=z.default.BigInt(1e6),vf=z.default.BigInt(1e9),UKe=z.default.BigInt(-1),Kue=z.default.multiply(z.default.BigInt(3600),vf),que=z.default.multiply(gf,vf),wf=z.default.multiply(Kue,Uue),U6=z.default.multiply(z.default.BigInt(-86400),z.default.BigInt(1e17)),u2=z.default.multiply(z.default.BigInt(86400),z.default.BigInt(1e17)),xk=-271821,Ek=275760,r2=z.default.multiply(z.default.BigInt(-388152),z.default.BigInt(1e13)),KKe=z.default.multiply(wf,z.default.BigInt(3660)),Lue=z.default.multiply(wf,z.default.BigInt(366)),Fue=z.default.multiply(wf,z.default.BigInt(14)),qKe=["iso8601","hebrew","islamic","islamic-umalqura","islamic-tbla","islamic-civil","islamic-rgsa","islamicc","persian","ethiopic","ethioaa","coptic","chinese","dangi","roc","indian","buddhist","japanese","gregory"];function Xc(t){return z.default.equal(t,Ln)}function Dr(t,e){let r=t[e];if(r!==void 0)return r}function Ge(t,e,r){let n=arguments.length>2?r:[];return Nk(t,e,n)}function pn(t){return typeof t=="object"&&t!==null||typeof t=="function"}function l2(t){if(typeof t=="bigint")throw new TypeError("Cannot convert BigInt to number");return CKe(t)}function ui(t){let e=l2(t);if($k(e)||e===0)return 0;if(!Es(e))return e;let r=Na(hn(e));return r===0?0:d2(e)*r}function pc(t){if(typeof t!="number"||$k(t)||!Es(t))return!1;let e=hn(t);return Na(e)===e}function Ts(t){if(typeof t=="symbol")throw new TypeError("Cannot convert a Symbol value to a String");return Q6(t)}function xr(t){let e=l2(t);if(e===0)return 0;if($k(e)||!Es(e))throw new RangeError("invalid number value");let r=gv(e);return r===0?0:r}function Yde(t,e){let r=xr(t);if(r<=0)throw e!==void 0?new RangeError(`property '${e}' cannot be a a number less than one`):new RangeError("Cannot convert a number less than one to a positive integer");return r}function ji(t){let e=l2(t);if(!Es(e))throw new RangeError("infinity is out of range");if(!pc(e))throw new RangeError(`unsupported fractional value ${t}`);return e===0?0:e}function ri(t,e){return{quotient:z.default.divide(t,e),remainder:z.default.remainder(t,e)}}function Sk(t){return z.default.lessThan(t,Ln)}function Zde(t){return Xc(t)?0:Sk(t)?-1:1}function el(t){return z.default.lessThan(t,Ln)?z.default.multiply(t,UKe):t}var Xde=new Map([["year",xr],["month",Yde],["monthCode",Ts],["day",Yde],["hour",xr],["minute",xr],["second",xr],["millisecond",xr],["microsecond",xr],["nanosecond",xr],["years",ji],["months",ji],["weeks",ji],["days",ji],["hours",ji],["minutes",ji],["seconds",ji],["milliseconds",ji],["microseconds",ji],["nanoseconds",ji],["era",Ts],["eraYear",ui],["offset",Ts]]),LKe=new Map([["hour",0],["minute",0],["second",0],["millisecond",0],["microsecond",0],["nanosecond",0]]),eS=[["years","year","date"],["months","month","date"],["weeks","week","date"],["days","day","date"],["hours","hour","time"],["minutes","minute","time"],["seconds","second","time"],["milliseconds","millisecond","time"],["microseconds","microsecond","time"],["nanoseconds","nanosecond","time"]],Tk=new Map(eS.map(t=>[t[0],t[1]])),FKe=new Map(eS.map(([t,e])=>[e,t])),Qde=eS.map(([,t])=>t),eue=Array.from(Tk.keys()).sort(),tue=new Map;function zue(t){let e=tue.get(t);return e===void 0&&(e=new Nue("en-us",{timeZone:Q6(t),hour12:!1,era:"short",year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"}),tue.set(t,e)),e}function rue(t){if(t==null)throw new TypeError(`Expected object not ${t}`);return Object(t)}function n2(t,e,r,n){if(e==null)return;let i=NKe(e);for(let o of i)if(!r.some(s=>Object.is(s,o))&&Object.prototype.propertyIsEnumerable.call(e,o)){let s=e[o];if(n&&n.some(a=>Object.is(a,s)))continue;t[o]=s}}function ki(t){return $i(t,ft)&&!$i(t,zr,fe)}function Zc(t){return $i(t,mf)}function Un(t){return $i(t,Mn)}function Kn(t){return $i(t,ys,Xi,ms,gs,vs,bs,ws,_s,xs)}function Zt(t){return $i(t,Iue)}function qn(t){return $i(t,Tt,At,kt,Pt,It,Rt)&&!$i(t,Ie,Me,je)}function Et(t){return $i(t,Ie,Me,je,Tt,At,kt,Pt,It,Rt)}function Ir(t){return $i(t,Rue)}function Ci(t){return $i(t,Bue)}function Le(t){return $i(t,ft,zr,fe)}function b2(t){if($i(t,fe)||$i(t,zr))throw new TypeError("with() does not support a calendar or timeZone property");if(qn(t))throw new TypeError("with() does not accept Temporal.PlainTime, use withPlainTime() instead");if(t.calendar!==void 0)throw new TypeError("with() does not support a calendar property");if(t.timeZone!==void 0)throw new TypeError("with() does not support a timeZone property")}function zKe(t){let{ianaName:e,offset:r,z:n}=function(o){if(new RegExp(`^${X6.source}$`,"i").test(o))return{ianaName:o};try{let s=Tf(o);if(s.z||s.offset||s.ianaName)return s}catch{}throw new RangeError(`Invalid time zone: ${o}`)}(t);return e?UN(e):n?"UTC":Yk(pm(r))}function IN(t,e){return e==="never"?"":RN(po(t),e)}function RN(t,e){return e==="never"||e==="auto"&&t==="iso8601"?"":`[${e==="critical"?"!":""}u-ca=${t}]`}function Tf(t){let e=AKe.exec(t);if(!e)throw new RangeError(`invalid ISO 8601 string: ${t}`);let r=e[1];if(r[0]==="\u2212"&&(r=`-${r.slice(1)}`),r==="-000000")throw new RangeError(`invalid ISO 8601 string: ${t}`);let n=ui(r),i=ui(e[2]||e[4]),o=ui(e[3]||e[5]),s=ui(e[6]),a=e[6]!==void 0,d=ui(e[7]||e[10]),u=ui(e[8]||e[11]);u===60&&(u=59);let c=(e[9]||e[12])+"000000000",l=ui(c.slice(0,3)),h=ui(c.slice(3,6)),y=ui(c.slice(6,9)),g,v=!1;if(e[13])g=void 0,v=!0;else if(e[14]&&e[15]){let T=e[14]==="-"||e[14]==="\u2212"?"-":"+",$=e[15]||"00",j=e[16]||"00",K=e[17]||"00",F=e[18]||"0";if(g=`${T}${$}:${j}`,+F){for(;F.endsWith("0");)F=F.slice(0,-1);g+=`:${K}.${F}`}else+K&&(g+=`:${K}`);g==="-00:00"&&(g="+00:00")}let x=e[19],S=e[20],A;for(let[,T,$,j]of S.matchAll(wm))if($==="u-ca")A===void 0&&(A=j);else if(T==="!")throw new RangeError(`Unrecognized annotation: !${$}=${j}`);return LN(n,i,o,s,d,u,l,h,y),{year:n,month:i,day:o,hasTime:a,hour:s,minute:d,second:u,millisecond:l,microsecond:h,nanosecond:y,ianaName:x,offset:g,z:v,calendar:A}}function BN(t){let e=PKe.exec(t),r,n,i,o;if(e){let s=e[1];if(s[0]==="\u2212"&&(s=`-${s.slice(1)}`),s==="-000000")throw new RangeError(`invalid ISO 8601 string: ${t}`);r=ui(s),n=ui(e[2]);let a=e[3];for(let[,d,u,c]of a.matchAll(wm))if(u==="u-ca")i===void 0&&(i=c);else if(d==="!")throw new RangeError(`Unrecognized annotation: !${u}=${c}`);if(i!==void 0&&i!=="iso8601")throw new RangeError("YYYY-MM format is only valid with iso8601 calendar")}else{let s;if({year:r,month:n,calendar:i,day:o,z:s}=Tf(t),s)throw new RangeError("Z designator not supported for PlainYearMonth")}return{year:r,month:n,calendar:i,referenceISODay:o}}function ON(t){let e=IKe.exec(t),r,n,i,o;if(e){r=ui(e[1]),n=ui(e[2]);let s=e[3];for(let[,a,d,u]of s.matchAll(wm))if(d==="u-ca")i===void 0&&(i=u);else if(a==="!")throw new RangeError(`Unrecognized annotation: !${d}=${u}`);if(i!==void 0&&i!=="iso8601")throw new RangeError("MM-DD format is only valid with iso8601 calendar")}else{let s;if({month:r,day:n,calendar:i,year:o,z:s}=Tf(t),s)throw new RangeError("Z designator not supported for PlainMonthDay")}return{month:r,day:n,calendar:i,referenceISOYear:o}}function VKe(t){let{year:e,month:r,day:n,hour:i,minute:o,second:s,millisecond:a,microsecond:d,nanosecond:u,offset:c,z:l}=function(v){let x=Tf(v);if(!x.z&&!x.offset)throw new RangeError("Temporal.Instant requires a time zone offset");return x}(t);if(!l&&!c)throw new RangeError("Temporal.Instant requires a time zone offset");let h=l?0:pm(c);({year:e,month:r,day:n,hour:i,minute:o,second:s,millisecond:a,microsecond:d,nanosecond:u}=KN(e,r,n,i,o,s,a,d,u-h));let y=ym(e,r,n,i,o,s,a,d,u);if(y===null)throw new RangeError("DateTime outside of supported range");return y}function Ak(t,e,r,n){let i=t,o=e,s=r;switch(n){case"reject":_f(i,o,s);break;case"constrain":({year:i,month:o,day:s}=ale(i,o,s))}return{year:i,month:o,day:s}}function Uk(t,e,r,n,i,o,s){let a=t,d=e,u=r,c=n,l=i,h=o;switch(s){case"reject":Xk(a,d,u,c,l,h);break;case"constrain":({hour:a,minute:d,second:u,millisecond:c,microsecond:l,nanosecond:h}=function(g,v,x,S,A,T){let $=$a(g,0,23),j=$a(v,0,59),K=$a(x,0,59),F=$a(S,0,999),L=$a(A,0,999),V=$a(T,0,999);return{hour:$,minute:j,second:K,millisecond:F,microsecond:L,nanosecond:V}}(a,d,u,c,l,h))}return{hour:a,minute:d,second:u,millisecond:c,microsecond:l,nanosecond:h}}function Pv(t){if(!pn(t))return function(g){let v=BKe.exec(g);if(!v)throw new RangeError(`invalid duration: ${g}`);if(v.slice(2).every(E=>E===void 0))throw new RangeError(`invalid duration: ${g}`);let x=v[1]==="-"||v[1]==="\u2212"?-1:1,S=v[2]===void 0?0:xr(v[2])*x,A=v[3]===void 0?0:xr(v[3])*x,T=v[4]===void 0?0:xr(v[4])*x,$=v[5]===void 0?0:xr(v[5])*x,j=v[6]===void 0?0:xr(v[6])*x,K=v[7],F=v[8],L=v[9],V=v[10],q=v[11],k=0,P=0,B=0;if(K!==void 0){if(F??L??V??q)throw new RangeError("only the smallest unit can be fractional");B=3600*ui((K+"000000000").slice(0,9))*x}else if(k=F===void 0?0:xr(F)*x,L!==void 0){if(V??q)throw new RangeError("only the smallest unit can be fractional");B=60*ui((L+"000000000").slice(0,9))*x}else P=V===void 0?0:xr(V)*x,q!==void 0&&(B=ui((q+"000000000").slice(0,9))*x);let p=B%1e3,m=gv(B/1e3)%1e3,w=gv(B/1e6)%1e3;return P+=gv(B/1e9)%60,k+=gv(B/6e10),Ok(S,A,T,$,j,k,P,w,m,p),{years:S,months:A,weeks:T,days:$,hours:j,minutes:k,seconds:P,milliseconds:w,microseconds:m,nanoseconds:p}}(Ts(t));if(Kn(t))return{years:O(t,ys),months:O(t,Xi),weeks:O(t,la),days:O(t,ms),hours:O(t,gs),minutes:O(t,vs),seconds:O(t,bs),milliseconds:O(t,ws),microseconds:O(t,_s),nanoseconds:O(t,xs)};let e={years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0},r=function(g){if(!pn(g))throw new TypeError("invalid duration-like");let v={years:void 0,months:void 0,weeks:void 0,days:void 0,hours:void 0,minutes:void 0,seconds:void 0,milliseconds:void 0,microseconds:void 0,nanoseconds:void 0},x=!1;for(let S of eue){let A=g[S];A!==void 0&&(x=!0,v[S]=ji(A))}if(!x)throw new TypeError("invalid duration-like");return v}(t);for(let y of eue){let g=r[y];g!==void 0&&(e[y]=g)}let{years:n,months:i,weeks:o,days:s,hours:a,minutes:d,seconds:u,milliseconds:c,microseconds:l,nanoseconds:h}=e;return Ok(n,i,o,s,a,d,u,c,l,h),{years:n,months:i,weeks:o,days:s,hours:a,minutes:d,seconds:u,milliseconds:c,microseconds:l,nanoseconds:h}}function ni(t){return t===void 0?"constrain":gm(t,"overflow",["constrain","reject"],"constrain")}function f2(t){return t===void 0?"compatible":gm(t,"disambiguation",["compatible","earlier","later","reject"],"compatible")}function rl(t,e){return gm(t,"roundingMode",["ceil","floor","expand","trunc","halfCeil","halfFloor","halfExpand","halfTrunc","halfEven"],e)}function kk(t,e){return t===void 0?e:gm(t,"offset",["prefer","use","ignore","reject"],e)}function tS(t){return gm(t,"calendarName",["auto","always","never","critical"],"auto")}function w2(t){let e=t.roundingIncrement;if(e===void 0)return 1;if(e=l2(e),!Es(e))throw new RangeError("roundingIncrement must be finite");let r=gv(e);if(r<1||r>1e9)throw new RangeError(`roundingIncrement must be at least 1 and at most 1e9, not ${e}`);return r}function _2(t,e,r){let n=r?e:e-1;if(t>n)throw new RangeError(`roundingIncrement must be at least 1 and less than ${n}, not ${t}`);if(e%t!=0)throw new RangeError(`Rounding increment must divide evenly into ${e}`)}function rS(t){let e=t.fractionalSecondDigits;if(e===void 0)return"auto";if(typeof e!="number"){if(Ts(e)!=="auto")throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${e}`);return"auto"}let r=Na(e);if(!Es(r)||r<0||r>9)throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${e}`);return r}function nS(t,e){switch(t){case"minute":return{precision:"minute",unit:"minute",increment:1};case"second":return{precision:0,unit:"second",increment:1};case"millisecond":return{precision:3,unit:"millisecond",increment:1};case"microsecond":return{precision:6,unit:"microsecond",increment:1};case"nanosecond":return{precision:9,unit:"nanosecond",increment:1}}switch(e){case"auto":return{precision:e,unit:"nanosecond",increment:1};case 0:return{precision:e,unit:"second",increment:1};case 1:case 2:case 3:return{precision:e,unit:"millisecond",increment:10**(3-e)};case 4:case 5:case 6:return{precision:e,unit:"microsecond",increment:10**(6-e)};case 7:case 8:case 9:return{precision:e,unit:"nanosecond",increment:10**(9-e)};default:throw new RangeError(`fractionalSecondDigits must be 'auto' or 0 through 9, not ${e}`)}}var xv=Symbol("~required~");function Ua(t,e,r,n,i=[]){let o=[];for(let[,u,c]of eS)r!=="datetime"&&r!==c||o.push(u);o.push(...i);let s=n;s===xv?s=void 0:s!==void 0&&o.push(s);let a=[...o];for(let u of o){let c=FKe.get(u);c!==void 0&&a.push(c)}let d=gm(t,e,a,s);if(d===void 0&&n===xv)throw new RangeError(`${e} is required`);return Tk.has(d)?Tk.get(d):d}function gk(t){let e=t.relativeTo;if(e===void 0)return e;let r,n,i,o,s,a,d,u,c,l,h,y,g="option",v=!1;if(pn(e)){if(Le(e)||Zt(e))return e;if(Et(e))return p2(e);l=aS(e);let x=li(l,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);x.push("timeZone","offset");let S=$t(e,x,[]),A=zo(null);A.overflow="constrain",{year:r,month:n,day:i,hour:o,minute:s,second:a,millisecond:d,microsecond:u,nanosecond:c}=iS(l,S,A),y=S.offset,y===void 0&&(g="wall"),h=S.timeZone,h!==void 0&&(h=Fo(h))}else{let x,S;if({year:r,month:n,day:i,hour:o,minute:s,second:a,millisecond:d,microsecond:u,nanosecond:c,calendar:l,ianaName:x,offset:y,z:S}=Tf(Ts(e)),x)h=Fo(x),S?g="exact":y||(g="wall"),v=!0;else if(S)throw new RangeError("Z designator not supported for PlainDate relativeTo; either remove the Z or add a bracketed time zone");if(l||(l="iso8601"),!np(l))throw new RangeError(`invalid calendar identifier ${l}`);l=xf(l)}return h===void 0?td(r,n,i,l):lo(Ik(r,n,i,o,s,a,d,u,c,g,g==="option"?pm(y):0,h,"compatible","reject",v),h,l)}function rN(t,e,r,n,i,o,s,a,d,u){for(let[c,l]of[["years",t],["months",e],["weeks",r],["days",n],["hours",i],["minutes",o],["seconds",s],["milliseconds",a],["microseconds",d],["nanoseconds",u]])if(l!==0)return Tk.get(c);return"nanosecond"}function Ev(t,e){return Qde.indexOf(t)>Qde.indexOf(e)?e:t}function $t(t,e,r,{emptySourceErrorMessage:n}={emptySourceErrorMessage:"no supported properties found"}){let i=zo(null),o=!1;e.sort();for(let s of e){let a=t[s];if(a!==void 0)o=!0,Xde.has(s)&&(a=Xde.get(s)(a)),i[s]=a;else if(r!=="partial"){if(OKe.call(r,s))throw new TypeError(`required property '${s}' missing or undefined`);a=LKe.get(s),i[s]=a}}if(r==="partial"&&!o)throw new TypeError(n);return i}function Pk(t,e="complete"){let r=["hour","microsecond","millisecond","minute","nanosecond","second"],n=$t(t,r,"partial",{emptySourceErrorMessage:"invalid time-like"}),i={};for(let o of r){let s=$Ke(n,o);s!==void 0?i[o]=s.value:e==="complete"&&(i[o]=0)}return i}function Wr(t,e){let r=t;if(pn(r)){if(Zt(r))return r;if(Le(r)&&(ni(e),r=hc(O(r,zr),O(r,Lo),O(r,fe))),Et(r))return ni(e),td(O(r,Ie),O(r,Me),O(r,je),O(r,fe));let d=aS(r);return tp(d,$t(r,li(d,["day","month","monthCode","year"]),[]),e)}ni(e);let{year:n,month:i,day:o,calendar:s,z:a}=function(u){return Tf(u)}(Ts(r));if(a)throw new RangeError("Z designator not supported for PlainDate");if(s||(s="iso8601"),!np(s))throw new RangeError(`invalid calendar identifier ${s}`);return s=xf(s),td(n,i,o,s)}function iS(t,e,r){let{hour:n,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:d}=Pk(e),u=ni(r),c=tp(t,e,r),l=O(c,Ie),h=O(c,Me),y=O(c,je);return{hour:n,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:d}=Uk(n,i,o,s,a,d,u),{year:l,month:h,day:y,hour:n,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:d}}function vv(t,e){let r,n,i,o,s,a,d,u,c,l;if(pn(t)){if(Et(t))return t;if(Le(t))return ni(e),hc(O(t,zr),O(t,Lo),O(t,fe));if(Zt(t))return ni(e),ja(O(t,Ie),O(t,Me),O(t,je),0,0,0,0,0,0,O(t,fe));l=aS(t);let h=$t(t,li(l,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),[]);({year:r,month:n,day:i,hour:o,minute:s,second:a,millisecond:d,microsecond:u,nanosecond:c}=iS(l,h,e))}else{let h;if(ni(e),{year:r,month:n,day:i,hour:o,minute:s,second:a,millisecond:d,microsecond:u,nanosecond:c,calendar:l,z:h}=function(g){return Tf(g)}(Ts(t)),h)throw new RangeError("Z designator not supported for PlainDateTime");if(LN(r,n,i,o,s,a,d,u,c),l||(l="iso8601"),!np(l))throw new RangeError(`invalid calendar identifier ${l}`);l=xf(l)}return ja(r,n,i,o,s,a,d,u,c,l)}function i2(t){if(Kn(t))return t;let{years:e,months:r,weeks:n,days:i,hours:o,minutes:s,seconds:a,milliseconds:d,microseconds:u,nanoseconds:c}=Pv(t);return new(Ee("%Temporal.Duration%"))(e,r,n,i,o,s,a,d,u,c)}function tl(t){if(ki(t))return t;if(Le(t))return new(Ee("%Temporal.Instant%"))(O(t,ft));let e=VKe(Ts(t));return new(Ee("%Temporal.Instant%"))(e)}function nue(t,e){let r=t;if(pn(r)){if(Ci(r))return r;let a,d;if($i(r,fe))a=O(r,fe),d=!1;else{let c=r.calendar;d=c===void 0,c===void 0&&(c="iso8601"),a=Ka(c)}let u=$t(r,li(a,["day","month","monthCode","year"]),[]);return d&&u.month!==void 0&&u.monthCode===void 0&&u.year===void 0&&(u.year=1972),h2(a,u,e)}ni(e);let{month:n,day:i,referenceISOYear:o,calendar:s}=ON(Ts(r));if(s===void 0&&(s="iso8601"),!np(s))throw new RangeError(`invalid calendar identifier ${s}`);return s=xf(s),o===void 0?(_f(1972,n,i),K6(n,i,s)):h2(s,K6(n,i,s,o))}function Zh(t,e="constrain"){let r,n,i,o,s,a,d=t;if(pn(d)){if(qn(d))return d;if(Le(d)&&(d=hc(O(d,zr),O(d,Lo),O(d,fe))),Et(d))return new(Ee("%Temporal.PlainTime%"))(O(d,Tt),O(d,At),O(d,kt),O(d,Pt),O(d,It),O(d,Rt));({hour:r,minute:n,second:i,millisecond:o,microsecond:s,nanosecond:a}=Pk(d)),{hour:r,minute:n,second:i,millisecond:o,microsecond:s,nanosecond:a}=Uk(r,n,i,o,s,a,e)}else({hour:r,minute:n,second:i,millisecond:o,microsecond:s,nanosecond:a}=function(c){let l=kKe.exec(c),h,y,g,v,x,S,A;if(l){h=ui(l[1]),y=ui(l[2]||l[5]),g=ui(l[3]||l[6]),g===60&&(g=59);let T=(l[4]||l[7])+"000000000";v=ui(T.slice(0,3)),x=ui(T.slice(3,6)),S=ui(T.slice(6,9)),A=l[14];for(let[,$,j,K]of A.matchAll(wm))if(j!=="u-ca"&&$==="!")throw new RangeError(`Unrecognized annotation: !${j}=${K}`);if(l[8])throw new RangeError("Z designator not supported for PlainTime")}else{let T,$;if({hasTime:$,hour:h,minute:y,second:g,millisecond:v,microsecond:x,nanosecond:S,z:T}=Tf(c),!$)throw new RangeError(`time is missing in string: ${c}`);if(T)throw new RangeError("Z designator not supported for PlainTime")}if(/[tT ][0-9][0-9]/.test(c))return{hour:h,minute:y,second:g,millisecond:v,microsecond:x,nanosecond:S};try{let{month:T,day:$}=ON(c);_f(1972,T,$)}catch{try{let{year:T,month:$}=BN(c);_f(T,$,1)}catch{return{hour:h,minute:y,second:g,millisecond:v,microsecond:x,nanosecond:S}}}throw new RangeError(`invalid ISO 8601 time-only string ${c}; may need a T prefix`)}(Ts(d))),Xk(r,n,i,o,s,a);return new(Ee("%Temporal.PlainTime%"))(r,n,i,o,s,a)}function C6(t,e){if(pn(t)){if(Ir(t))return t;let s=aS(t);return Tv(s,$t(t,li(s,["month","monthCode","year"]),[]),e)}ni(e);let{year:r,month:n,referenceISODay:i,calendar:o}=BN(Ts(t));if(o===void 0&&(o="iso8601"),!np(o))throw new RangeError(`invalid calendar identifier ${o}`);return o=xf(o),i===void 0?(_f(r,n,1),q6(r,n,o)):Tv(o,q6(r,n,o,i))}function Ik(t,e,r,n,i,o,s,a,d,u,c,l,h,y,g){let v=new(Ee("%Temporal.PlainDateTime%"))(t,e,r,n,i,o,s,a,d);if(u==="wall"||y==="ignore")return O(Ss(l,v,h),ft);if(u==="exact"||y==="use"){let S=ym(t,e,r,n,i,o,s,a,d);if(S===null)throw new RangeError("ZonedDateTime outside of supported range");return z.default.subtract(S,z.default.BigInt(c))}let x=Rk(l,v);for(let S of x){let A=nl(l,S),T=z.default.toNumber(fc(z.default.BigInt(A),que,"halfExpand"));if(A===c||g&&T===c)return O(S,ft)}if(y==="reject"){let S=Yk(c),A=Zc(l)?O(l,mf):"time zone";throw new RangeError(`Offset ${S} is invalid for ${v.toString()} in ${A}`)}return O(Que(x,l,v,h),ft)}function j6(t,e){let r,n,i,o,s,a,d,u,c,l,h,y,g,v,x=!1,S="option";if(pn(t)){if(Le(t))return t;y=aS(t);let T=li(y,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);T.push("timeZone","offset");let $=$t(t,T,["timeZone"]);l=Fo($.timeZone),h=$.offset,h===void 0&&(S="wall"),g=f2(e),v=kk(e,"reject"),{year:r,month:n,day:i,hour:o,minute:s,second:a,millisecond:d,microsecond:u,nanosecond:c}=iS(y,$,e)}else{let T,$;if({year:r,month:n,day:i,hour:o,minute:s,second:a,millisecond:d,microsecond:u,nanosecond:c,ianaName:T,offset:h,z:$,calendar:y}=function(K){let F=Tf(K);if(!F.ianaName)throw new RangeError("Temporal.ZonedDateTime requires a time zone ID in brackets");return F}(Ts(t)),l=Fo(T),$?S="exact":h||(S="wall"),y||(y="iso8601"),!np(y))throw new RangeError(`invalid calendar identifier ${y}`);y=xf(y),x=!0,g=f2(e),v=kk(e,"reject"),ni(e)}let A=0;return S==="option"&&(A=pm(h)),lo(Ik(r,n,i,o,s,a,d,u,c,S,A,l,g,v,x),l,y)}function Vue(t,e,r,n,i){_f(e,r,n),cle(e,r,n),Sf(t),Dt(t,Ie,e),Dt(t,Me,r),Dt(t,je,n),Dt(t,fe,i),Dt(t,Iue,!0)}function td(t,e,r,n="iso8601"){let i=Ee("%Temporal.PlainDate%"),o=zo(i.prototype);return Vue(o,t,e,r,n),o}function Hue(t,e,r,n,i,o,s,a,d,u,c){LN(e,r,n,i,o,s,a,d,u),dle(e,r,n,i,o,s,a,d,u),Sf(t),Dt(t,Ie,e),Dt(t,Me,r),Dt(t,je,n),Dt(t,Tt,i),Dt(t,At,o),Dt(t,kt,s),Dt(t,Pt,a),Dt(t,It,d),Dt(t,Rt,u),Dt(t,fe,c)}function ja(t,e,r,n,i,o,s,a,d,u="iso8601"){let c=Ee("%Temporal.PlainDateTime%"),l=zo(c.prototype);return Hue(l,t,e,r,n,i,o,s,a,d,u),l}function Wue(t,e,r,n,i){_f(i,e,r),cle(i,e,r),Sf(t),Dt(t,Me,e),Dt(t,je,r),Dt(t,Ie,i),Dt(t,fe,n),Dt(t,Bue,!0)}function K6(t,e,r="iso8601",n=1972){let i=Ee("%Temporal.PlainMonthDay%"),o=zo(i.prototype);return Wue(o,t,e,r,n),o}function Gue(t,e,r,n,i){_f(e,r,i),function(s,a){ho(s,xk,Ek),s===xk?ho(a,4,12):s===Ek&&ho(a,1,9)}(e,r),Sf(t),Dt(t,Ie,e),Dt(t,Me,r),Dt(t,je,i),Dt(t,fe,n),Dt(t,Rue,!0)}function q6(t,e,r="iso8601",n=1){let i=Ee("%Temporal.PlainYearMonth%"),o=zo(i.prototype);return Gue(o,t,e,r,n),o}function Jue(t,e,r,n){mv(e),Sf(t),Dt(t,ft,e),Dt(t,zr,r),Dt(t,fe,n);let i=new(Ee("%Temporal.Instant%"))(O(t,ft));Dt(t,Lo,i)}function lo(t,e,r="iso8601"){let n=Ee("%Temporal.ZonedDateTime%"),i=zo(n.prototype);return Jue(i,t,e,r),i}function li(t,e){if(typeof t=="string"){let i=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.fields%"),i,[e])}let r=Ge(Dr(t,"fields"),t,[e]),n=[];for(let i of r){if(typeof i!="string")throw new TypeError("bad return from calendar.fields()");$ue.call(n,i)}return n}function Sv(t,e,r){if(typeof t=="string"){let i=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.mergeFields%"),i,[e,r])}let n=Ge(Dr(t,"mergeFields"),t,[e,r]);if(!pn(n))throw new TypeError("bad return from calendar.mergeFields()");return n}function fo(t,e,r,n,i){let o=i;if(typeof t=="string"){let a=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.dateAdd%"),a,[e,r,n])}o===void 0&&(o=Dr(t,"dateAdd"));let s=Nk(o,t,[e,r,n]);if(!Zt(s))throw new TypeError("invalid result");return s}function hm(t,e,r,n,i){let o=i;if(typeof t=="string"){let a=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.dateUntil%"),a,[e,r,n])}o===void 0&&(o=Dr(t,"dateUntil"));let s=Nk(o,t,[e,r,n]);if(!Kn(s))throw new TypeError("invalid result");return s}function Kk(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.year%"),n,[e])}let r=Ge(Dr(t,"year"),t,[e]);if(typeof r!="number")throw new TypeError("calendar year result must be an integer");if(!pc(r))throw new RangeError("calendar year result must be an integer");return r}function qk(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.month%"),n,[e])}let r=Ge(Dr(t,"month"),t,[e]);if(typeof r!="number")throw new TypeError("calendar month result must be a positive integer");if(!pc(r)||r<1)throw new RangeError("calendar month result must be a positive integer");return r}function oS(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.monthCode%"),n,[e])}let r=Ge(Dr(t,"monthCode"),t,[e]);if(typeof r!="string")throw new TypeError("calendar monthCode result must be a string");return r}function sS(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.day%"),n,[e])}let r=Ge(Dr(t,"day"),t,[e]);if(typeof r!="number")throw new TypeError("calendar day result must be a positive integer");if(!pc(r)||r<1)throw new RangeError("calendar day result must be a positive integer");return r}function Lk(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.era%"),n,[e])}let r=Ge(Dr(t,"era"),t,[e]);if(r===void 0)return r;if(typeof r!="string")throw new TypeError("calendar era result must be a string or undefined");return r}function Fk(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.eraYear%"),n,[e])}let r=Ge(Dr(t,"eraYear"),t,[e]);if(r===void 0)return r;if(typeof r!="number")throw new TypeError("calendar eraYear result must be an integer or undefined");if(!pc(r))throw new RangeError("calendar eraYear result must be an integer or undefined");return r}function MN(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.dayOfWeek%"),n,[e])}let r=Ge(Dr(t,"dayOfWeek"),t,[e]);if(typeof r!="number")throw new TypeError("calendar dayOfWeek result must be a positive integer");if(!pc(r)||r<1)throw new RangeError("calendar dayOfWeek result must be a positive integer");return r}function DN(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.dayOfYear%"),n,[e])}let r=Ge(Dr(t,"dayOfYear"),t,[e]);if(typeof r!="number")throw new TypeError("calendar dayOfYear result must be a positive integer");if(!pc(r)||r<1)throw new RangeError("calendar dayOfYear result must be a positive integer");return r}function CN(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.weekOfYear%"),n,[e])}let r=Ge(Dr(t,"weekOfYear"),t,[e]);if(typeof r!="number")throw new TypeError("calendar weekOfYear result must be a positive integer");if(!pc(r)||r<1)throw new RangeError("calendar weekOfYear result must be a positive integer");return r}function jN(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.yearOfWeek%"),n,[e])}let r=Ge(Dr(t,"yearOfWeek"),t,[e]);if(typeof r!="number")throw new TypeError("calendar yearOfWeek result must be an integer");if(!pc(r))throw new RangeError("calendar yearOfWeek result must be an integer");return r}function $N(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.daysInWeek%"),n,[e])}let r=Ge(Dr(t,"daysInWeek"),t,[e]);if(typeof r!="number")throw new TypeError("calendar daysInWeek result must be a positive integer");if(!pc(r)||r<1)throw new RangeError("calendar daysInWeek result must be a positive integer");return r}function zk(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.daysInMonth%"),n,[e])}let r=Ge(Dr(t,"daysInMonth"),t,[e]);if(typeof r!="number")throw new TypeError("calendar daysInMonth result must be a positive integer");if(!pc(r)||r<1)throw new RangeError("calendar daysInMonth result must be a positive integer");return r}function Vk(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.daysInYear%"),n,[e])}let r=Ge(Dr(t,"daysInYear"),t,[e]);if(typeof r!="number")throw new TypeError("calendar daysInYear result must be a positive integer");if(!pc(r)||r<1)throw new RangeError("calendar daysInYear result must be a positive integer");return r}function Hk(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.monthsInYear%"),n,[e])}let r=Ge(Dr(t,"monthsInYear"),t,[e]);if(typeof r!="number")throw new TypeError("calendar monthsInYear result must be a positive integer");if(!pc(r)||r<1)throw new RangeError("calendar monthsInYear result must be a positive integer");return r}function Wk(t,e){if(typeof t=="string"){let n=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.inLeapYear%"),n,[e])}let r=Ge(Dr(t,"inLeapYear"),t,[e]);if(typeof r!="boolean")throw new TypeError("calendar inLeapYear result must be a boolean");return r}function Ka(t){if(pn(t)){if($i(t,fe))return O(t,fe);if(!function(i){return!!Un(i)||"dateAdd"in i&&"dateFromFields"in i&&"dateUntil"in i&&"day"in i&&"dayOfWeek"in i&&"dayOfYear"in i&&"daysInMonth"in i&&"daysInWeek"in i&&"daysInYear"in i&&"fields"in i&&"id"in i&&"inLeapYear"in i&&"mergeFields"in i&&"month"in i&&"monthCode"in i&&"monthDayFromFields"in i&&"monthsInYear"in i&&"weekOfYear"in i&&"year"in i&&"yearMonthFromFields"in i&&"yearOfWeek"in i}(t))throw new TypeError("expected a Temporal.Calendar or object implementing the Temporal.Calendar protocol");return t}let e=Ts(t);if(np(e))return xf(e);let r;try{({calendar:r}=Tf(e))}catch{try{({calendar:r}=BN(e))}catch{({calendar:r}=ON(e))}}if(r||(r="iso8601"),!np(r))throw new RangeError(`invalid calendar identifier ${r}`);return xf(r)}function aS(t){if($i(t,fe))return O(t,fe);let{calendar:e}=t;return e===void 0?"iso8601":Ka(e)}function po(t){if(typeof t=="string")return t;let e=t.id;if(typeof e!="string")throw new TypeError("calendar.id should be a string");return e}function x2(t){return pn(t)?t:new(Ee("%Temporal.Calendar%"))(t)}function cS(t,e){return t===e?!0:po(t)===po(e)}function Gk(t,e,r){if(t===e)return;let n=po(t),i=po(e);if(n!==i)throw new RangeError(`cannot ${r} of ${n} and ${i} calendars`)}function Yue(t,e){if(t===e)return e;let r=po(t),n=po(e);if(r===n||r==="iso8601")return e;if(n==="iso8601")return t;throw new RangeError("irreconcilable calendars")}function tp(t,e,r,n){if(typeof t=="string"){let o=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.dateFromFields%"),o,[e,r])}let i=Ge(n??Dr(t,"dateFromFields"),t,[e,r]);if(!Zt(i))throw new TypeError("invalid result");return i}function Tv(t,e,r){if(typeof t=="string"){let i=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.yearMonthFromFields%"),i,[e,r])}let n=Ge(Dr(t,"yearMonthFromFields"),t,[e,r]);if(!Ir(n))throw new TypeError("invalid result");return n}function h2(t,e,r){if(typeof t=="string"){let i=new(Ee("%Temporal.Calendar%"))(t);return Ge(Ee("%Temporal.Calendar.prototype.monthDayFromFields%"),i,[e,r])}let n=Ge(Dr(t,"monthDayFromFields"),t,[e,r]);if(!Ci(n))throw new TypeError("invalid result");return n}function Fo(t){if(pn(t)){if(Le(t))return O(t,zr);if(!function(r){return!!Zc(r)||"getOffsetNanosecondsFor"in r&&"getPossibleInstantsFor"in r&&"id"in r}(t))throw new TypeError("expected a Temporal.TimeZone or object implementing the Temporal.TimeZone protocol");return t}return zKe(Ts(t))}function L6(t){if(typeof t=="string")return t;let e=t.id;if(typeof e!="string")throw new TypeError("timeZone.id should be a string");return e}function Zue(t){return pn(t)?t:new(Ee("%Temporal.TimeZone%"))(t)}function Xue(t,e){return t===e?!0:L6(t)===L6(e)}function p2(t){return td(O(t,Ie),O(t,Me),O(t,je),O(t,fe))}function NN(t){return new(Ee("%Temporal.PlainTime%"))(O(t,Tt),O(t,At),O(t,kt),O(t,Pt),O(t,It),O(t,Rt))}function nl(t,e,r){if(typeof t=="string"){let i=new(Ee("%Temporal.TimeZone%"))(t);return Ge(Ee("%Temporal.TimeZone.prototype.getOffsetNanosecondsFor%"),i,[e])}let n=Ge(r??Dr(t,"getOffsetNanosecondsFor"),t,[e]);if(typeof n!="number")throw new TypeError("bad return from getOffsetNanosecondsFor");if(!pc(n)||hn(n)>=864e11)throw new RangeError("out-of-range return from getOffsetNanosecondsFor");return n}function nN(t,e){return Yk(nl(t,e))}function hc(t,e,r){let n=O(e,ft),i=nl(t,e),{year:o,month:s,day:a,hour:d,minute:u,second:c,millisecond:l,microsecond:h,nanosecond:y}=tle(n);return{year:o,month:s,day:a,hour:d,minute:u,second:c,millisecond:l,microsecond:h,nanosecond:y}=KN(o,s,a,d,u,c,l,h,y+i),ja(o,s,a,d,u,c,l,h,y,r)}function Ss(t,e,r){return Que(Rk(t,e),t,e,r)}function Que(t,e,r,n){let i=Ee("%Temporal.Instant%"),o=t.length;if(o===1)return t[0];if(o)switch(n){case"compatible":case"earlier":return t[0];case"later":return t[o-1];case"reject":throw new RangeError("multiple instants found")}let s=O(r,Ie),a=O(r,Me),d=O(r,je),u=O(r,Tt),c=O(r,At),l=O(r,kt),h=O(r,Pt),y=O(r,It),g=O(r,Rt),v=ym(s,a,d,u,c,l,h,y,g);if(v===null)throw new RangeError("DateTime outside of supported range");let x=new i(z.default.subtract(v,wf)),S=new i(z.default.add(v,wf)),A=nl(e,x),T=nl(e,S)-A;switch(n){case"earlier":{let $=O(r,fe),j=Ee("%Temporal.PlainDateTime%"),K=aN(s,a,d,u,c,l,h,y,g,$,0,0,0,0,0,0,0,0,0,-T,void 0);return Rk(e,new j(K.year,K.month,K.day,K.hour,K.minute,K.second,K.millisecond,K.microsecond,K.nanosecond,$))[0]}case"compatible":case"later":{let $=O(r,fe),j=Ee("%Temporal.PlainDateTime%"),K=aN(s,a,d,u,c,l,h,y,g,$,0,0,0,0,0,0,0,0,0,T,void 0),F=Rk(e,new j(K.year,K.month,K.day,K.hour,K.minute,K.second,K.millisecond,K.microsecond,K.nanosecond,$));return F[F.length-1]}case"reject":throw new RangeError("no such instant found")}}function Rk(t,e,r){if(typeof t=="string"){let o=new(Ee("%Temporal.TimeZone%"))(t);return Ge(Ee("%Temporal.TimeZone.prototype.getPossibleInstantsFor%"),o,[e])}let n=Ge(r??Dr(t,"getPossibleInstantsFor"),t,[e]),i=[];for(let o of n){if(!ki(o))throw new TypeError("bad return from getPossibleInstantsFor");$ue.call(i,o)}return i}function Iv(t){let e;return t<0||t>9999?e=(t<0?"-":"+")+`000000${hn(t)}`.slice(-6):e=`0000${t}`.slice(-4),e}function Sn(t){return`00${t}`.slice(-2)}function Jk(t,e,r,n,i){if(i==="minute")return"";let o=`:${Sn(t)}`,s,a=1e6*e+1e3*r+n;if(i==="auto"){if(a===0)return o;for(s=`${a}`.padStart(9,"0");s[s.length-1]==="0";)s=s.slice(0,-1)}else{if(i===0)return o;s=`${a}`.padStart(9,"0").slice(0,i)}return`${o}.${s}`}function iue(t,e,r){let n=e;n===void 0&&(n="UTC");let i=hc(n,t,"iso8601"),o=Iv(O(i,Ie)),s=Sn(O(i,Me)),a=Sn(O(i,je)),d=Sn(O(i,Tt)),u=Sn(O(i,At)),c=Jk(O(i,kt),O(i,Pt),O(i,It),O(i,Rt),r),l="Z";return e!==void 0&&(l=ele(nl(n,t))),`${o}-${s}-${a}T${d}:${u}${c}${l}`}function W$(t,e="auto",r){function n(V){return V<=jKe?V.toString(10):z.default.BigInt(V).toString(10)}let i=O(t,ys),o=O(t,Xi),s=O(t,la),a=O(t,ms),d=O(t,gs),u=O(t,vs),c=O(t,bs),l=O(t,ws),h=O(t,_s),y=O(t,xs),g=bf(i,o,s,a,d,u,c,l,h,y);if(r){let{unit:V,increment:q,roundingMode:k}=r;({seconds:c,milliseconds:l,microseconds:h,nanoseconds:y}=rp(0,0,0,0,0,0,c,l,h,y,q,V,k))}let v=[];i&&v.push(`${n(hn(i))}Y`),o&&v.push(`${n(hn(o))}M`),s&&v.push(`${n(hn(s))}W`),a&&v.push(`${n(hn(a))}D`);let x=[];d&&x.push(`${n(hn(d))}H`),u&&x.push(`${n(hn(u))}M`);let S=[],A,T,$,j,K=y2(0,0,0,c,l,h,y,0);({quotient:K,remainder:A}=ri(K,Rr)),{quotient:K,remainder:T}=ri(K,Rr),{quotient:j,remainder:$}=ri(K,Rr);let F=1e6*hn(z.default.toNumber($))+1e3*hn(z.default.toNumber(T))+hn(z.default.toNumber(A)),L;if(e==="auto"){if(F!==0)for(L=`${F}`.padStart(9,"0");L[L.length-1]==="0";)L=L.slice(0,-1)}else e!==0&&(L=`${F}`.padStart(9,"0").slice(0,e));return L&&S.unshift(".",L),z.default.equal(j,Ln)&&!S.length&&e==="auto"||S.unshift(el(j).toString()),S.length&&x.push(`${S.join("")}S`),x.length&&x.unshift("T"),v.length||x.length?`${g<0?"-":""}P${v.join("")}${x.join("")}`:"PT0S"}function oue(t,e="auto"){return`${Iv(O(t,Ie))}-${Sn(O(t,Me))}-${Sn(O(t,je))}${IN(O(t,fe),e)}`}function sue(t,e,r="auto",n){let i=O(t,Ie),o=O(t,Me),s=O(t,je),a=O(t,Tt),d=O(t,At),u=O(t,kt),c=O(t,Pt),l=O(t,It),h=O(t,Rt);if(n){let{unit:y,increment:g,roundingMode:v}=n;({year:i,month:o,day:s,hour:a,minute:d,second:u,millisecond:c,microsecond:l,nanosecond:h}=HN(i,o,s,a,d,u,c,l,h,g,y,v))}return`${Iv(i)}-${Sn(o)}-${Sn(s)}T${Sn(a)}:${Sn(d)}${Jk(u,c,l,h,e)}${IN(O(t,fe),r)}`}function aue(t,e="auto"){let r=`${Sn(O(t,Me))}-${Sn(O(t,je))}`,n=po(O(t,fe));(e==="always"||e==="critical"||n!=="iso8601")&&(r=`${Iv(O(t,Ie))}-${r}`);let i=RN(n,e);return i&&(r+=i),r}function cue(t,e="auto"){let r=`${Iv(O(t,Ie))}-${Sn(O(t,Me))}`,n=po(O(t,fe));(e==="always"||e==="critical"||n!=="iso8601")&&(r+=`-${Sn(O(t,je))}`);let i=RN(n,e);return i&&(r+=i),r}function due(t,e,r="auto",n="auto",i="auto",o){let s=O(t,Lo);if(o){let{unit:c,increment:l,roundingMode:h}=o,y=Mk(O(t,ft),l,c,h);s=new(Ee("%Temporal.Instant%"))(y)}let a=O(t,zr),d=hc(a,s,"iso8601"),u=`${Iv(O(d,Ie))}-${Sn(O(d,Me))}-${Sn(O(d,je))}T${Sn(O(d,Tt))}:${Sn(O(d,At))}${Jk(O(d,kt),O(d,Pt),O(d,It),O(d,Rt),e)}`;return i!=="never"&&(u+=ele(nl(a,s))),n!=="never"&&(u+=`[${n==="critical"?"!":""}${L6(a)}]`),u+=IN(O(t,fe),r),u}function t2(t){return mle.test(Q6(t))}function pm(t){let e=mle.exec(Q6(t));if(!e)throw new RangeError(`invalid time zone offset: ${t}`);return(e[1]==="-"||e[1]==="\u2212"?-1:1)*(1e9*(60*(60*+e[2]+ +(e[3]||0))+ +(e[4]||0))+ +((e[5]||0)+"000000000").slice(0,9))}function UN(t){return t2(t)?Yk(pm(t)):zue(Q6(t)).resolvedOptions().timeZone}function Xh(t,e){let{year:r,month:n,day:i,hour:o,minute:s,second:a,millisecond:d,microsecond:u,nanosecond:c}=rle(t,e),l=r%400,h=(r-l)/400,y=z.default.multiply(z.default.BigInt(146097),wf),g=ym(l,n,i,o,s,a,d,u,c),v=z.default.add(g,z.default.multiply(y,z.default.BigInt(h)));return z.default.toNumber(z.default.subtract(v,e))}function Yk(t){let e=t<0?"-":"+",r=hn(t),n=r%1e9,i=Na(r/1e9)%60,o=Na(r/6e10)%60,s=Sn(Na(r/36e11)),a=Sn(o),d=Sn(i),u="";if(n){let c=`${n}`.padStart(9,"0");for(;c[c.length-1]==="0";)c=c.slice(0,-1);u=`:${d}.${c}`}else i&&(u=`:${d}`);return`${e}${s}:${a}${u}`}function ele(t){let e=z.default.toNumber(fc(z.default.BigInt(t),que,"halfExpand")),r=e<0?"-":"+";e=hn(e);let n=e/6e10%60;return`${r}${Sn(Na(e/36e11))}:${Sn(n)}`}function ym(t,e,r,n,i,o,s,a,d){let u=new Date;u.setUTCHours(n,i,o,s),u.setUTCFullYear(t,e-1,r);let c=u.getTime();if($k(c))return null;let l=z.default.multiply(z.default.BigInt(c),Qc);return l=z.default.add(l,z.default.multiply(z.default.BigInt(a),Rr)),l=z.default.add(l,z.default.BigInt(d)),z.default.lessThan(l,U6)||z.default.greaterThan(l,u2)?null:l}function tle(t){let{quotient:e,remainder:r}=ri(t,Qc),n=z.default.toNumber(e),i=z.default.toNumber(r);i<0&&(i+=1e6,n-=1);let o=Na(i/1e3)%1e3,s=i%1e3,a=new Date(n);return{epochMilliseconds:n,year:a.getUTCFullYear(),month:a.getUTCMonth()+1,day:a.getUTCDate(),hour:a.getUTCHours(),minute:a.getUTCMinutes(),second:a.getUTCSeconds(),millisecond:a.getUTCMilliseconds(),microsecond:o,nanosecond:s}}function rle(t,e){let{epochMilliseconds:r,millisecond:n,microsecond:i,nanosecond:o}=tle(e),{year:s,month:a,day:d,hour:u,minute:c,second:l}=function(y,g){let v=zue(y).format(new Date(g));return function(S){let A=S.split(/[^\w]+/);if(A.length!==7)throw new RangeError(`expected 7 parts in "${S}`);let T=+A[0],$=+A[1],j=+A[2],K=A[3].toUpperCase();if(K==="B"||K==="BC")j=1-j;else if(K!=="A"&&K!=="AD")throw new RangeError(`Unknown era ${K} in "${S}`);let F=+A[4];F===24&&(F=0);let L=+A[5],V=+A[6];if(!(Es(j)&&Es(T)&&Es($)&&Es(F)&&Es(L)&&Es(V)))throw new RangeError(`Invalid number in "${S}`);return{year:j,month:T,day:$,hour:F,minute:L,second:V}}(v)}(t,r);return KN(s,a,d,u,c,l,n,i,o)}function uue(t,e){return z.default.lessThan(t,e)?e:t}function nle(){return z.default.add(GN(),KKe)}function ile(t,e){if(z.default.lessThan(e,r2))return ile(t,r2);let r=z.default.add(e,Lue),n=uue(nle(),r),i=uue(r2,e),o=Xh(t,i),s=i,a=o;for(;o===a&&z.default.lessThan(z.default.BigInt(i),n);){if(s=z.default.add(i,Fue),z.default.greaterThan(s,u2))return null;a=Xh(t,s),o===a&&(i=s)}return o===a?null:gle(d=>Xh(t,d),i,s,o,a)}function iN(t,e){let r=nle(),n=z.default.greaterThan(e,r),i=n?z.default.subtract(e,Lue):r2;if(t==="Africa/Casablanca"||t==="Africa/El_Aaiun"){let u=O(tl("2088-01-01T00Z"),ft);if(z.default.lessThan(u,e))return iN(t,u)}let o=z.default.subtract(e,v2);if(z.default.lessThan(o,r2))return null;let s=Xh(t,o),a=o,d=s;for(;s===d&&z.default.greaterThan(o,i);){if(a=z.default.subtract(o,Fue),z.default.lessThan(a,r2))return null;d=Xh(t,a),s===d&&(o=a)}if(s===d){if(n){let u=z.default.subtract(r,wf);return iN(t,u)}return null}return gle(u=>Xh(t,u),a,o,d,s)}function mm(t){return t===void 0?!1:t%4==0&&(t%100!=0||t%400==0)}function Qh(t,e){return{standard:[31,28,31,30,31,30,31,31,30,31,30,31],leapyear:[31,29,31,30,31,30,31,31,30,31,30,31]}[mm(t)?"leapyear":"standard"][e-1]}function oN(t,e,r){let n=e+(e<3?10:-2),i=t-(e<3?1:0),o=Na(i/100),s=i-100*o,a=(r+Na(2.6*n-.2)+(s+Na(s/4))+(Na(o/4)-2*o))%7;return a+(a<=0?7:0)}function Bk(t,e,r){let n=r;for(let i=e-1;i>0;i--)n+=Qh(t,i);return n}function lue(t,e,r){let n=Bk(t,e,r),i=oN(t,e,r)||7,o=oN(t,1,1),s=Na((n-i+10)/7);return s<1?o===5||o===6&&mm(t-1)?{week:53,year:t-1}:{week:52,year:t-1}:s===53&&(mm(t)?366:365)-n<4-i?{week:1,year:t+1}:{week:s,year:t}}function bf(t,e,r,n,i,o,s,a,d,u){for(let c of[t,e,r,n,i,o,s,a,d,u])if(c!==0)return c<0?-1:1;return 0}function vk(t,e){let r=t,n=e;if(!Es(r)||!Es(n))throw new RangeError("infinity is out of range");return n-=1,r+=Na(n/12),n%=12,n<0&&(n+=12),n+=1,{year:r,month:n}}function Zk(t,e,r){let n=t,i=e,o=r;if(!Es(o))throw new RangeError("infinity is out of range");({year:n,month:i}=vk(n,i));let s=146097;if(hn(o)>s){let u=gv(o/s);n+=400*u,o-=u*s}let a=0,d=i>2?n:n-1;for(;a=mm(d)?366:365,o<-a;)n-=1,d-=1,o+=a;for(d+=1;a=mm(d)?366:365,o>a;)n+=1,d+=1,o-=a;for(;o<1;)({year:n,month:i}=vk(n,i-1)),o+=Qh(n,i);for(;o>Qh(n,i);)o-=Qh(n,i),{year:n,month:i}=vk(n,i+1);return{year:n,month:i,day:o}}function KN(t,e,r,n,i,o,s,a,d){let{deltaDays:u,hour:c,minute:l,second:h,millisecond:y,microsecond:g,nanosecond:v}=Yh(n,i,o,s,a,d),{year:x,month:S,day:A}=Zk(t,e,r+u);return{year:x,month:S,day:A,hour:c,minute:l,second:h,millisecond:y,microsecond:g,nanosecond:v}}function Yh(t,e,r,n,i,o){let s,a=z.default.BigInt(t),d=z.default.BigInt(e),u=z.default.BigInt(r),c=z.default.BigInt(n),l=z.default.BigInt(i),h=z.default.BigInt(o);return{quotient:s,remainder:h}=yv(h,Rr),l=z.default.add(l,s),{quotient:s,remainder:l}=yv(l,Rr),c=z.default.add(c,s),{quotient:s,remainder:c}=yv(c,Rr),u=z.default.add(u,s),{quotient:s,remainder:u}=yv(u,gf),d=z.default.add(d,s),{quotient:s,remainder:d}=yv(d,gf),a=z.default.add(a,s),{quotient:s,remainder:a}=yv(a,Uue),{deltaDays:z.default.toNumber(s),hour:z.default.toNumber(a),minute:z.default.toNumber(d),second:z.default.toNumber(u),millisecond:z.default.toNumber(c),microsecond:z.default.toNumber(l),nanosecond:z.default.toNumber(h)}}function y2(t,e,r,n,i,o,s,a){let d=z.default.BigInt(t),u=z.default.BigInt(s);t!==0&&(u=z.default.subtract(z.default.BigInt(s),z.default.BigInt(a)));let c=z.default.add(z.default.BigInt(e),z.default.multiply(d,z.default.BigInt(24))),l=z.default.add(z.default.BigInt(r),z.default.multiply(c,gf)),h=z.default.add(z.default.BigInt(n),z.default.multiply(l,gf)),y=z.default.add(z.default.BigInt(i),z.default.multiply(h,Rr)),g=z.default.add(z.default.BigInt(o),z.default.multiply(y,Rr));return z.default.add(z.default.BigInt(u),z.default.multiply(g,Rr))}function qN(t,e){let r=Ee("%Temporal.Instant%"),n=d2(z.default.toNumber(t)),i=z.default.BigInt(t),o=864e11;if(n===0)return{days:0,nanoseconds:Ln,dayLengthNs:o};if(!Le(e)){let T;return{quotient:T,remainder:i}=ri(i,z.default.BigInt(o)),{days:z.default.toNumber(T),nanoseconds:i,dayLengthNs:o}}let s=O(e,ft),a=O(e,Lo),d=z.default.add(s,i),u=new r(d),c=O(e,zr),l=O(e,fe),h=hc(c,a,l),y=hc(c,u,l),{days:g}=VN(O(h,Ie),O(h,Me),O(h,je),O(h,Tt),O(h,At),O(h,kt),O(h,Pt),O(h,It),O(h,Rt),O(y,Ie),O(y,Me),O(y,je),O(y,Tt),O(y,At),O(y,kt),O(y,Pt),O(y,It),O(y,Rt),l,"day",zo(null)),v=ed(a,c,l,0,0,0,g,0,0,0,0,0,0),x=z.default.BigInt(g);if(n===1)for(;z.default.greaterThan(x,Ln)&&z.default.greaterThan(v,d);)x=z.default.subtract(x,v2),v=ed(a,c,l,0,0,0,z.default.toNumber(x),0,0,0,0,0,0);i=z.default.subtract(d,v);let S=!1,A=new r(v);do{let T=ed(A,c,l,0,0,0,n,0,0,0,0,0,0),$=O(A,ft);o=z.default.toNumber(z.default.subtract(T,$)),S=z.default.greaterThanOrEqual(z.default.multiply(z.default.subtract(i,z.default.BigInt(o)),z.default.BigInt(n)),Ln),S&&(i=z.default.subtract(i,z.default.BigInt(o)),A=new r(T),x=z.default.add(x,z.default.BigInt(n)))}while(S);if(!Xc(x)&&Zde(x)!==n)throw new RangeError("Time zone or calendar converted nanoseconds into a number of days with the opposite sign");if(!Xc(i)&&Zde(i)!==n)throw Sk(i)&&n===1?new Error("assert not reached"):new RangeError("Time zone or calendar ended up with a remainder of nanoseconds with the opposite sign");if(z.default.greaterThanOrEqual(el(i),el(z.default.BigInt(o))))throw new Error("assert not reached");return{days:z.default.toNumber(x),nanoseconds:i,dayLengthNs:hn(o)}}function Jd(t,e,r,n,i,o,s,a,d){let u=ole(t,e,r,n,i,o,s,a,d);if(u==="positive overflow"||u==="negative overflow")throw new RangeError("Duration out of range");return u}function ole(t,e,r,n,i,o,s,a,d){let u,c,l,h,y,g,v=t;if(Le(d)){let F=ed(O(d,Lo),O(d,zr),O(d,fe),0,0,0,v,e,r,n,i,o,s),L=O(d,ft);u=z.default.subtract(F,L)}else u=y2(v,e,r,n,i,o,s,0);a==="year"||a==="month"||a==="week"||a==="day"?{days:v,nanoseconds:u}=qN(u,d):v=0;let x=z.default.lessThan(u,Ln)?-1:1;switch(u=el(u),c=l=h=y=g=Ln,a){case"year":case"month":case"week":case"day":case"hour":({quotient:c,remainder:u}=ri(u,Rr)),{quotient:l,remainder:c}=ri(c,Rr),{quotient:h,remainder:l}=ri(l,Rr),{quotient:y,remainder:h}=ri(h,gf),{quotient:g,remainder:y}=ri(y,gf);break;case"minute":({quotient:c,remainder:u}=ri(u,Rr)),{quotient:l,remainder:c}=ri(c,Rr),{quotient:h,remainder:l}=ri(l,Rr),{quotient:y,remainder:h}=ri(h,gf);break;case"second":({quotient:c,remainder:u}=ri(u,Rr)),{quotient:l,remainder:c}=ri(c,Rr),{quotient:h,remainder:l}=ri(l,Rr);break;case"millisecond":({quotient:c,remainder:u}=ri(u,Rr)),{quotient:l,remainder:c}=ri(c,Rr);break;case"microsecond":({quotient:c,remainder:u}=ri(u,Rr));break;case"nanosecond":break;default:throw new Error("assert not reached")}let S=z.default.toNumber(g)*x,A=z.default.toNumber(y)*x,T=z.default.toNumber(h)*x,$=z.default.toNumber(l)*x,j=z.default.toNumber(c)*x,K=z.default.toNumber(u)*x;for(let F of[v,S,A,T,$,j,K])if(!Es(F))return x===1?"positive overflow":"negative overflow";return{days:v,hours:S,minutes:A,seconds:T,milliseconds:$,microseconds:j,nanoseconds:K}}function mk(t,e,r,n,i,o){let s=Ee("%Temporal.Duration%"),a=bf(t,e,r,n,0,0,0,0,0,0);if(a===0)return{years:t,months:e,weeks:r,days:n};let d=z.default.BigInt(a),u,c,l=z.default.BigInt(t),h=z.default.BigInt(e),y=z.default.BigInt(r),g=z.default.BigInt(n);o&&(c=Wr(o),u=O(c,fe));let v=new s(a),x=new s(0,a),S=new s(0,0,a);switch(i){case"year":break;case"month":{if(!u)throw new RangeError("a starting point is required for months balancing");let A,T;for(typeof u!="string"&&(A=Dr(u,"dateAdd"),T=Dr(u,"dateUntil"));!Xc(l);){let $=fo(u,c,v,void 0,A),j=zo(null);j.largestUnit="month";let K=hm(u,c,$,j,T),F=z.default.BigInt(O(K,Xi));c=$,h=z.default.add(h,F),l=z.default.subtract(l,d)}}break;case"week":{if(!u)throw new RangeError("a starting point is required for weeks balancing");let A=typeof u!="string"?Dr(u,"dateAdd"):void 0;for(;!Xc(l);){let T;({relativeTo:c,days:T}=qo(u,c,v,A)),g=z.default.add(g,z.default.BigInt(T)),l=z.default.subtract(l,d)}for(;!Xc(h);){let T;({relativeTo:c,days:T}=qo(u,c,x,A)),g=z.default.add(g,z.default.BigInt(T)),h=z.default.subtract(h,d)}break}default:{if(Xc(l)&&Xc(h)&&Xc(y))break;if(!u)throw new RangeError("a starting point is required for balancing calendar units");let A=typeof u!="string"?Dr(u,"dateAdd"):void 0;for(;!Xc(l);){let T;({relativeTo:c,days:T}=qo(u,c,v,A)),g=z.default.add(g,z.default.BigInt(T)),l=z.default.subtract(l,d)}for(;!Xc(h);){let T;({relativeTo:c,days:T}=qo(u,c,x,A)),g=z.default.add(g,z.default.BigInt(T)),h=z.default.subtract(h,d)}for(;!Xc(y);){let T;({relativeTo:c,days:T}=qo(u,c,S,A)),g=z.default.add(g,z.default.BigInt(T)),y=z.default.subtract(y,d)}break}}return{years:z.default.toNumber(l),months:z.default.toNumber(h),weeks:z.default.toNumber(y),days:z.default.toNumber(g)}}function fue(t,e,r,n,i){if(Le(t)){let o=O(t,Lo),s=O(t,zr),a=O(t,fe),d=nl(s,o),u=ed(o,s,a,e,r,n,i,0,0,0,0,0,0);return nl(s,new(Ee("%Temporal.Instant%"))(u))-d}return 0}function sle(t){return new(Ee("%Temporal.Duration%"))(-O(t,ys),-O(t,Xi),-O(t,la),-O(t,ms),-O(t,gs),-O(t,vs),-O(t,bs),-O(t,ws),-O(t,_s),-O(t,xs))}function $a(t,e,r){return MKe(r,DKe(e,t))}function ale(t,e,r){let n=$a(e,1,12);return{year:t,month:n,day:$a(r,1,Qh(t,n))}}function ho(t,e,r){if(t<e||t>r)throw new RangeError(`value out of range: ${e} <= ${t} <= ${r}`)}function _f(t,e,r){ho(e,1,12),ho(r,1,Qh(t,e))}function cle(t,e,r){dle(t,e,r,12,0,0,0,0,0)}function Xk(t,e,r,n,i,o){ho(t,0,23),ho(e,0,59),ho(r,0,59),ho(n,0,999),ho(i,0,999),ho(o,0,999)}function LN(t,e,r,n,i,o,s,a,d){_f(t,e,r),Xk(n,i,o,s,a,d)}function dle(t,e,r,n,i,o,s,a,d){if(ho(t,xk,Ek),t===xk&&ym(t,e,r+1,n,i,o,s,a,d-1)==null||t===Ek&&ym(t,e,r-1,n,i,o,s,a,d+1)==null)throw new RangeError("DateTime outside of supported range")}function mv(t){if(z.default.lessThan(t,U6)||z.default.greaterThan(t,u2))throw new RangeError("Instant outside of supported range")}function Ok(t,e,r,n,i,o,s,a,d,u){let c=bf(t,e,r,n,i,o,s,a,d,u);for(let l of[t,e,r,n,i,o,s,a,d,u]){if(!Es(l))throw new RangeError("infinite values not allowed as duration fields");let h=d2(l);if(h!==0&&h!==c)throw new RangeError("mixed-sign values not allowed as duration fields")}}function FN(t,e,r,n,i,o,s){switch(s){case"year":case"month":{let a=-fm(t,e,r,n,i,o);if(a===0)return{years:0,months:0,weeks:0,days:0};let d={year:t,month:e,day:r},u={year:n,month:i,day:o},c=u.year-d.year,l=bv(t,e,r,c,0,0,0,"constrain"),h=-fm(l.year,l.month,l.day,n,i,o);if(h===0)return s==="year"?{years:c,months:0,weeks:0,days:0}:{years:0,months:12*c,weeks:0,days:0};let y=u.month-d.month;if(h!==a&&(c-=a,y+=12*a),l=bv(t,e,r,c,y,0,0,"constrain"),h=-fm(l.year,l.month,l.day,n,i,o),h===0)return s==="year"?{years:c,months:y,weeks:0,days:0}:{years:0,months:y+12*c,weeks:0,days:0};h!==a&&(y-=a,y===-a&&(c-=a,y=11*a),l=bv(t,e,r,c,y,0,0,"constrain"));let g=0;return g=l.month===u.month?u.day-l.day:a<0?-l.day-(Qh(u.year,u.month)-u.day):u.day+(Qh(l.year,l.month)-l.day),s==="month"&&(y+=12*c,c=0),{years:c,months:y,weeks:0,days:g}}case"week":case"day":{let a,d,u;fm(t,e,r,n,i,o)<0?(d={year:t,month:e,day:r},a={year:n,month:i,day:o},u=1):(d={year:n,month:i,day:o},a={year:t,month:e,day:r},u=-1);let c=Bk(a.year,a.month,a.day)-Bk(d.year,d.month,d.day);for(let h=d.year;h<a.year;++h)c+=mm(h)?366:365;let l=0;return s==="week"&&(l=Na(c/7),c%=7),l*=u,c*=u,{years:0,months:0,weeks:l,days:c}}default:throw new Error("assert not reached")}}function ule(t,e,r,n,i,o,s,a,d,u,c,l){let h=s-t,y=a-e,g=d-r,v=u-n,x=c-i,S=l-o,A=bf(0,0,0,0,h,y,g,v,x,S);h*=A,y*=A,g*=A,v*=A,x*=A,S*=A;let T=0;if({deltaDays:T,hour:h,minute:y,second:g,millisecond:v,microsecond:x,nanosecond:S}=Yh(h,y,g,v,x,S),T!=0)throw new Error("assertion failure in DifferenceTime: _bt_.[[Days]] should be 0");return h*=A,y*=A,g*=A,v*=A,x*=A,S*=A,{hours:h,minutes:y,seconds:g,milliseconds:v,microseconds:x,nanoseconds:S}}function zN(t,e,r,n,i,o){let s=z.default.subtract(e,t),a=0,d=0,u=z.default.toNumber(z.default.remainder(s,Rr)),c=z.default.toNumber(z.default.remainder(z.default.divide(s,Rr),Rr)),l=z.default.toNumber(z.default.remainder(z.default.divide(s,Qc),Rr)),h=z.default.toNumber(z.default.divide(s,vf));return{hours:a,minutes:d,seconds:h,milliseconds:l,microseconds:c,nanoseconds:u}=rp(0,0,0,0,0,0,h,l,c,u,r,n,o),Jd(0,a,d,h,l,c,u,i)}function VN(t,e,r,n,i,o,s,a,d,u,c,l,h,y,g,v,x,S,A,T,$){let j=t,K=e,F=r,{hours:L,minutes:V,seconds:q,milliseconds:k,microseconds:P,nanoseconds:B}=ule(n,i,o,s,a,d,h,y,g,v,x,S),p=bf(0,0,0,0,L,V,q,k,P,B);fm(u,c,l,j,K,F)===-p&&({year:j,month:K,day:F}=Zk(j,K,F-p),{hours:L,minutes:V,seconds:q,milliseconds:k,microseconds:P,nanoseconds:B}=Jd(-p,L,V,q,k,P,B,T));let m=td(j,K,F,A),w=td(u,c,l,A),E=Ev("day",T),_=_m($);_.largestUnit=E;let{years:b,months:C,weeks:N,days:D}=hm(A,m,w,_);return{days:D,hours:L,minutes:V,seconds:q,milliseconds:k,microseconds:P,nanoseconds:B}=Jd(D,L,V,q,k,P,B,T),{years:b,months:C,weeks:N,days:D,hours:L,minutes:V,seconds:q,milliseconds:k,microseconds:P,nanoseconds:B}}function lle(t,e,r,n,i,o){let s=z.default.subtract(e,t);if(z.default.equal(s,Ln))return{years:0,months:0,weeks:0,days:0,hours:0,minutes:0,seconds:0,milliseconds:0,microseconds:0,nanoseconds:0};let a=Ee("%Temporal.Instant%"),d=new a(t),u=new a(e),c=hc(r,d,n),l=hc(r,u,n),{years:h,months:y,weeks:g,days:v}=VN(O(c,Ie),O(c,Me),O(c,je),O(c,Tt),O(c,At),O(c,kt),O(c,Pt),O(c,It),O(c,Rt),O(l,Ie),O(l,Me),O(l,je),O(l,Tt),O(l,At),O(l,kt),O(l,Pt),O(l,It),O(l,Rt),n,i,o),x=ed(d,r,n,h,y,g,0,0,0,0,0,0,0),S=z.default.subtract(e,x),A=lo(x,r,n);({nanoseconds:S,days:v}=qN(S,A));let{hours:T,minutes:$,seconds:j,milliseconds:K,microseconds:F,nanoseconds:L}=Jd(0,0,0,0,0,0,z.default.toNumber(S),"hour");return{years:h,months:y,weeks:g,days:v,hours:T,minutes:$,seconds:j,milliseconds:K,microseconds:F,nanoseconds:L}}function E2(t,e,r,n,i,o){let s=eS.reduce((y,g)=>{let v=g[0],x=g[1],S=g[2];return r!=="datetime"&&S!==r||n.includes(x)||y.push(x,v),y},[]),a=Ua(e,"largestUnit",r,"auto");if(n.includes(a))throw new RangeError(`largestUnit must be one of ${s.join(", ")}, not ${a}`);let d=w2(e),u=rl(e,"trunc");t==="since"&&(u=function(g){switch(g){case"ceil":return"floor";case"floor":return"ceil";case"halfCeil":return"halfFloor";case"halfFloor":return"halfCeil";default:return g}}(u));let c=Ua(e,"smallestUnit",r,i);if(n.includes(c))throw new RangeError(`smallestUnit must be one of ${s.join(", ")}, not ${c}`);let l=Ev(o,c);if(a==="auto"&&(a=l),Ev(a,c)!==a)throw new RangeError(`largestUnit ${a} cannot be smaller than smallestUnit ${c}`);let h={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[c];return h!==void 0&&_2(d,h,!1),{largestUnit:a,roundingIncrement:d,roundingMode:u,smallestUnit:c}}function hue(t,e,r,n){let i=t==="since"?-1:1,o=tl(r),s=E2(t,_m(n),"time",[],"nanosecond","second"),a=O(e,ft),d=O(o,ft),{hours:u,minutes:c,seconds:l,milliseconds:h,microseconds:y,nanoseconds:g}=zN(a,d,s.roundingIncrement,s.smallestUnit,s.largestUnit,s.roundingMode);return new(Ee("%Temporal.Duration%"))(0,0,0,0,i*u,i*c,i*l,i*h,i*y,i*g)}function pue(t,e,r,n){let i=t==="since"?-1:1,o=Wr(r),s=O(e,fe);Gk(s,O(o,fe),"compute difference between dates");let a=_m(n),d=E2(t,a,"date",[],"day","day");a.largestUnit=d.largestUnit;let{years:u,months:c,weeks:l,days:h}=hm(s,e,o,a);return d.smallestUnit==="day"&&d.roundingIncrement===1||({years:u,months:c,weeks:l,days:h}=rp(u,c,l,h,0,0,0,0,0,0,d.roundingIncrement,d.smallestUnit,d.roundingMode,e)),new(Ee("%Temporal.Duration%"))(i*u,i*c,i*l,i*h,0,0,0,0,0,0)}function yue(t,e,r,n){let i=t==="since"?-1:1,o=vv(r),s=O(e,fe);Gk(s,O(o,fe),"compute difference between dates");let a=_m(n),d=E2(t,a,"datetime",[],"nanosecond","day"),{years:u,months:c,weeks:l,days:h,hours:y,minutes:g,seconds:v,milliseconds:x,microseconds:S,nanoseconds:A}=VN(O(e,Ie),O(e,Me),O(e,je),O(e,Tt),O(e,At),O(e,kt),O(e,Pt),O(e,It),O(e,Rt),O(o,Ie),O(o,Me),O(o,je),O(o,Tt),O(o,At),O(o,kt),O(o,Pt),O(o,It),O(o,Rt),s,d.largestUnit,a),T=p2(e);return{years:u,months:c,weeks:l,days:h,hours:y,minutes:g,seconds:v,milliseconds:x,microseconds:S,nanoseconds:A}=rp(u,c,l,h,y,g,v,x,S,A,d.roundingIncrement,d.smallestUnit,d.roundingMode,T),{days:h,hours:y,minutes:g,seconds:v,milliseconds:x,microseconds:S,nanoseconds:A}=Jd(h,y,g,v,x,S,A,d.largestUnit),new(Ee("%Temporal.Duration%"))(i*u,i*c,i*l,i*h,i*y,i*g,i*v,i*x,i*S,i*A)}function mue(t,e,r,n){let i=t==="since"?-1:1,o=Zh(r),s=E2(t,_m(n),"time",[],"nanosecond","hour"),{hours:a,minutes:d,seconds:u,milliseconds:c,microseconds:l,nanoseconds:h}=ule(O(e,Tt),O(e,At),O(e,kt),O(e,Pt),O(e,It),O(e,Rt),O(o,Tt),O(o,At),O(o,kt),O(o,Pt),O(o,It),O(o,Rt));return{hours:a,minutes:d,seconds:u,milliseconds:c,microseconds:l,nanoseconds:h}=rp(0,0,0,0,a,d,u,c,l,h,s.roundingIncrement,s.smallestUnit,s.roundingMode),{hours:a,minutes:d,seconds:u,milliseconds:c,microseconds:l,nanoseconds:h}=Jd(0,a,d,u,c,l,h,s.largestUnit),new(Ee("%Temporal.Duration%"))(0,0,0,0,i*a,i*d,i*u,i*c,i*l,i*h)}function gue(t,e,r,n){let i=t==="since"?-1:1,o=C6(r),s=O(e,fe);Gk(s,O(o,fe),"compute difference between months");let a=_m(n),d=E2(t,a,"date",["week","day"],"month","year");a.largestUnit=d.largestUnit;let u=li(s,["monthCode","year"]),c=$t(e,u,[]);c.day=1;let l=tp(s,c),h=$t(o,u,[]);h.day=1;let y=tp(s,h),{years:g,months:v}=hm(s,l,y,a);return d.smallestUnit==="month"&&d.roundingIncrement===1||({years:g,months:v}=rp(g,v,0,0,0,0,0,0,0,0,d.roundingIncrement,d.smallestUnit,d.roundingMode,l)),new(Ee("%Temporal.Duration%"))(i*g,i*v,0,0,0,0,0,0,0,0)}function vue(t,e,r,n){let i=t==="since"?-1:1,o=j6(r),s=O(e,fe);Gk(s,O(o,fe),"compute difference between dates");let a=_m(n),d=E2(t,a,"datetime",[],"nanosecond","hour");a.largestUnit=d.largestUnit;let u=O(e,ft),c=O(o,ft),l,h,y,g,v,x,S,A,T,$;if(d.largestUnit!=="year"&&d.largestUnit!=="month"&&d.largestUnit!=="week"&&d.largestUnit!=="day")l=0,h=0,y=0,g=0,{hours:v,minutes:x,seconds:S,milliseconds:A,microseconds:T,nanoseconds:$}=zN(u,c,d.roundingIncrement,d.smallestUnit,d.largestUnit,d.roundingMode);else{let j=O(e,zr);if(!Xue(j,O(o,zr)))throw new RangeError("When calculating difference between time zones, largestUnit must be 'hours' or smaller because day lengths can vary between time zones due to DST or time zone offset changes.");({years:l,months:h,weeks:y,days:g,hours:v,minutes:x,seconds:S,milliseconds:A,microseconds:T,nanoseconds:$}=lle(u,c,j,s,d.largestUnit,a)),{years:l,months:h,weeks:y,days:g,hours:v,minutes:x,seconds:S,milliseconds:A,microseconds:T,nanoseconds:$}=rp(l,h,y,g,v,x,S,A,T,$,d.roundingIncrement,d.smallestUnit,d.roundingMode,e),{years:l,months:h,weeks:y,days:g,hours:v,minutes:x,seconds:S,milliseconds:A,microseconds:T,nanoseconds:$}=yle(l,h,y,g,v,x,S,A,T,$,d.roundingIncrement,d.smallestUnit,d.roundingMode,e)}return new(Ee("%Temporal.Duration%"))(i*l,i*h,i*y,i*g,i*v,i*x,i*S,i*A,i*T,i*$)}function bv(t,e,r,n,i,o,s,a){let d=t,u=e,c=r,l=o,h=s;return d+=n,u+=i,{year:d,month:u}=vk(d,u),{year:d,month:u,day:c}=Ak(d,u,c,a),h+=7*l,c+=h,{year:d,month:u,day:c}=Zk(d,u,c),{year:d,month:u,day:c}}function fle(t,e,r,n,i,o,s,a,d,u,c,l){let h=t,y=e,g=r,v=n,x=i,S=o;h+=s,y+=a,g+=d,v+=u,x+=c,S+=l;let A=0;return{deltaDays:A,hour:h,minute:y,second:g,millisecond:v,microsecond:x,nanosecond:S}=Yh(h,y,g,v,x,S),{deltaDays:A,hour:h,minute:y,second:g,millisecond:v,microsecond:x,nanosecond:S}}function hle(t,e,r,n,i,o,s,a,d,u,c,l,h,y,g,v,x,S,A,T,$){let j=Ev(rN(t,e,r,n,i,o,s,a,d,u),rN(c,l,h,y,g,v,x,S,A,T)),K,F,L,V,q,k,P,B,p,m;if($)if(Zt($)){let w=Ee("%Temporal.Duration%"),E=O($,fe),_=new w(t,e,r,n,0,0,0,0,0,0),b=new w(c,l,h,y,0,0,0,0,0,0),C=typeof E!="string"?Dr(E,"dateAdd"):void 0,N=fo(E,$,_,void 0,C),D=fo(E,N,b,void 0,C),U=Ev("day",j),G=zo(null);G.largestUnit=U,{years:K,months:F,weeks:L,days:V}=hm(E,$,D,G),{days:V,hours:q,minutes:k,seconds:P,milliseconds:B,microseconds:p,nanoseconds:m}=Jd(V,z.default.add(z.default.BigInt(i),z.default.BigInt(g)),z.default.add(z.default.BigInt(o),z.default.BigInt(v)),z.default.add(z.default.BigInt(s),z.default.BigInt(x)),z.default.add(z.default.BigInt(a),z.default.BigInt(S)),z.default.add(z.default.BigInt(d),z.default.BigInt(A)),z.default.add(z.default.BigInt(u),z.default.BigInt(T)),j)}else{let w=Ee("%Temporal.Instant%"),E=O($,zr),_=O($,fe),b=ed(O($,Lo),E,_,t,e,r,n,i,o,s,a,d,u),C=ed(new w(b),E,_,c,l,h,y,g,v,x,S,A,T);j!=="year"&&j!=="month"&&j!=="week"&&j!=="day"?(K=0,F=0,L=0,V=0,{hours:q,minutes:k,seconds:P,milliseconds:B,microseconds:p,nanoseconds:m}=zN(O($,ft),C,1,"nanosecond",j,"halfExpand")):{years:K,months:F,weeks:L,days:V,hours:q,minutes:k,seconds:P,milliseconds:B,microseconds:p,nanoseconds:m}=lle(O($,ft),C,E,_,j,zo(null))}else{if(j==="year"||j==="month"||j==="week")throw new RangeError("relativeTo is required for years, months, or weeks arithmetic");K=F=L=0,{days:V,hours:q,minutes:k,seconds:P,milliseconds:B,microseconds:p,nanoseconds:m}=Jd(n+y,z.default.add(z.default.BigInt(i),z.default.BigInt(g)),z.default.add(z.default.BigInt(o),z.default.BigInt(v)),z.default.add(z.default.BigInt(s),z.default.BigInt(x)),z.default.add(z.default.BigInt(a),z.default.BigInt(S)),z.default.add(z.default.BigInt(d),z.default.BigInt(A)),z.default.add(z.default.BigInt(u),z.default.BigInt(T)),j)}return Ok(K,F,L,V,q,k,P,B,p,m),{years:K,months:F,weeks:L,days:V,hours:q,minutes:k,seconds:P,milliseconds:B,microseconds:p,nanoseconds:m}}function sN(t,e,r,n,i,o,s){let a=Ln;a=z.default.add(a,z.default.BigInt(s)),a=z.default.add(a,z.default.multiply(z.default.BigInt(o),Rr)),a=z.default.add(a,z.default.multiply(z.default.BigInt(i),Qc)),a=z.default.add(a,z.default.multiply(z.default.BigInt(n),vf)),a=z.default.add(a,z.default.multiply(z.default.BigInt(r),z.default.BigInt(6e10))),a=z.default.add(a,z.default.multiply(z.default.BigInt(e),z.default.BigInt(36e11)));let d=z.default.add(t,a);return mv(d),d}function aN(t,e,r,n,i,o,s,a,d,u,c,l,h,y,g,v,x,S,A,T,$){let j=y,{deltaDays:K,hour:F,minute:L,second:V,millisecond:q,microsecond:k,nanosecond:P}=fle(n,i,o,s,a,d,g,v,x,S,A,T);j+=K;let B=Ee("%Temporal.Duration%"),p=fo(u,td(t,e,r,u),new B(c,l,h,j,0,0,0,0,0,0),$);return{year:O(p,Ie),month:O(p,Me),day:O(p,je),hour:F,minute:L,second:V,millisecond:q,microsecond:k,nanosecond:P}}function ed(t,e,r,n,i,o,s,a,d,u,c,l,h,y){let g=Ee("%Temporal.Duration%");if(bf(n,i,o,s,0,0,0,0,0,0)===0)return sN(O(t,ft),a,d,u,c,l,h);let v=hc(e,t,r),x=fo(r,td(O(v,Ie),O(v,Me),O(v,je),r),new g(n,i,o,s,0,0,0,0,0,0),y),S=ja(O(x,Ie),O(x,Me),O(x,je),O(v,Tt),O(v,At),O(v,kt),O(v,Pt),O(v,It),O(v,Rt),r);return sN(O(Ss(e,S,"compatible"),ft),a,d,u,c,l,h)}function bue(t,e,r,n){let i=t==="subtract"?-1:1,{years:o,months:s,weeks:a,days:d,hours:u,minutes:c,seconds:l,milliseconds:h,microseconds:y,nanoseconds:g}=Pv(r),v=gk(nr(n));return{years:o,months:s,weeks:a,days:d,hours:u,minutes:c,seconds:l,milliseconds:h,microseconds:y,nanoseconds:g}=hle(O(e,ys),O(e,Xi),O(e,la),O(e,ms),O(e,gs),O(e,vs),O(e,bs),O(e,ws),O(e,_s),O(e,xs),i*o,i*s,i*a,i*d,i*u,i*c,i*l,i*h,i*y,i*g,v),new(Ee("%Temporal.Duration%"))(o,s,a,d,u,c,l,h,y,g)}function wue(t,e,r){let n=t==="subtract"?-1:1,{hours:i,minutes:o,seconds:s,milliseconds:a,microseconds:d,nanoseconds:u}=function(h,y){let g=Pv(h);for(let v of y)if(g[v]!==0)throw new RangeError(`Duration field ${v} not supported by Temporal.Instant. Try Temporal.ZonedDateTime instead.`);return g}(r,["years","months","weeks","days"]),c=sN(O(e,ft),n*i,n*o,n*s,n*a,n*d,n*u);return new(Ee("%Temporal.Instant%"))(c)}function _ue(t,e,r,n){let i=t==="subtract"?-1:1,{years:o,months:s,weeks:a,days:d,hours:u,minutes:c,seconds:l,milliseconds:h,microseconds:y,nanoseconds:g}=Pv(r),v=nr(n),x=O(e,fe),{year:S,month:A,day:T,hour:$,minute:j,second:K,millisecond:F,microsecond:L,nanosecond:V}=aN(O(e,Ie),O(e,Me),O(e,je),O(e,Tt),O(e,At),O(e,kt),O(e,Pt),O(e,It),O(e,Rt),x,i*o,i*s,i*a,i*d,i*u,i*c,i*l,i*h,i*y,i*g,v);return ja(S,A,T,$,j,K,F,L,V,x)}function xue(t,e,r){let n=t==="subtract"?-1:1,{hours:i,minutes:o,seconds:s,milliseconds:a,microseconds:d,nanoseconds:u}=Pv(r),{hour:c,minute:l,second:h,millisecond:y,microsecond:g,nanosecond:v}=fle(O(e,Tt),O(e,At),O(e,kt),O(e,Pt),O(e,It),O(e,Rt),n*i,n*o,n*s,n*a,n*d,n*u);return{hour:c,minute:l,second:h,millisecond:y,microsecond:g,nanosecond:v}=Uk(c,l,h,y,g,v,"reject"),new(Ee("%Temporal.PlainTime%"))(c,l,h,y,g,v)}function Eue(t,e,r,n){let i=Pv(r);t==="subtract"&&(i={years:-i.years,months:-i.months,weeks:-i.weeks,days:-i.days,hours:-i.hours,minutes:-i.minutes,seconds:-i.seconds,milliseconds:-i.milliseconds,microseconds:-i.microseconds,nanoseconds:-i.nanoseconds});let{years:o,months:s,weeks:a,days:d,hours:u,minutes:c,seconds:l,milliseconds:h,microseconds:y,nanoseconds:g}=i;({days:d}=Jd(d,u,c,l,h,y,g,"day"));let v=nr(n),x=O(e,fe),S=li(x,["monthCode","year"]),A=$t(e,S,[]),T=zo(null);n2(T,A,[]),A.day=1;let $=tp(x,A),j=bf(o,s,a,d,0,0,0,0,0,0),K=Dr(x,"dateAdd"),F=Ee("%Temporal.Duration%");if(j<0){let q=fo(x,$,new F(0,1,0,0,0,0,0,0,0,0),void 0,K),k=fo(x,q,new F(0,0,0,-1,0,0,0,0,0,0),void 0,K);T.day=sS(x,k),$=tp(x,T)}let L=new F(o,s,a,d,0,0,0,0,0,0),V=_m(v);return Tv(x,$t(fo(x,$,L,v,K),S,[]),V)}function Sue(t,e,r,n){let i=t==="subtract"?-1:1,{years:o,months:s,weeks:a,days:d,hours:u,minutes:c,seconds:l,milliseconds:h,microseconds:y,nanoseconds:g}=Pv(r),v=nr(n),x=O(e,zr),S=O(e,fe);return lo(ed(O(e,Lo),x,S,i*o,i*s,i*a,i*d,i*u,i*c,i*l,i*h,i*y,i*g,v),x,S)}function fc(t,e,r){if(z.default.equal(e,v2))return t;let{quotient:n,remainder:i}=ri(t,e);if(z.default.equal(i,Ln))return t;let o=z.default.lessThan(i,Ln)?-1:1,s=el(z.default.multiply(i,z.default.BigInt(2))),a=z.default.equal(s,e),d=z.default.greaterThan(s,e);switch(r){case"ceil":o>0&&(n=z.default.add(n,z.default.BigInt(o)));break;case"floor":o<0&&(n=z.default.add(n,z.default.BigInt(o)));break;case"expand":n=z.default.add(n,z.default.BigInt(o));break;case"trunc":break;case"halfCeil":(d||a&&o>0)&&(n=z.default.add(n,z.default.BigInt(o)));break;case"halfFloor":(d||a&&o<0)&&(n=z.default.add(n,z.default.BigInt(o)));break;case"halfExpand":(d||a)&&(n=z.default.add(n,z.default.BigInt(o)));break;case"halfTrunc":d&&(n=z.default.add(n,z.default.BigInt(o)));break;case"halfEven":(d||a&&z.default.toNumber(z.default.remainder(el(n),z.default.BigInt(2)))===1)&&(n=z.default.add(n,z.default.BigInt(o)))}return z.default.multiply(n,e)}function Mk(t,e,r,n){let{remainder:i}=yv(t,wf),o=z.default.subtract(t,i),s=fc(i,z.default.BigInt(vle[r]*e),n);return z.default.add(o,s)}function HN(t,e,r,n,i,o,s,a,d,u,c,l,h=864e11){let{deltaDays:y,hour:g,minute:v,second:x,millisecond:S,microsecond:A,nanosecond:T}=WN(n,i,o,s,a,d,u,c,l,h),{year:$,month:j,day:K}=Zk(t,e,r+y);return{year:$,month:j,day:K,hour:g,minute:v,second:x,millisecond:S,microsecond:A,nanosecond:T}}function WN(t,e,r,n,i,o,s,a,d,u=864e11){let c=Ln;switch(a){case"day":case"hour":c=z.default.BigInt(t);case"minute":c=z.default.add(z.default.multiply(c,gf),z.default.BigInt(e));case"second":c=z.default.add(z.default.multiply(c,gf),z.default.BigInt(r));case"millisecond":c=z.default.add(z.default.multiply(c,Rr),z.default.BigInt(n));case"microsecond":c=z.default.add(z.default.multiply(c,Rr),z.default.BigInt(i));case"nanosecond":c=z.default.add(z.default.multiply(c,Rr),z.default.BigInt(o))}let l=a==="day"?u:vle[a],h=fc(c,z.default.BigInt(l*s),d),y=z.default.toNumber(z.default.divide(h,z.default.BigInt(l)));switch(a){case"day":return{deltaDays:y,hour:0,minute:0,second:0,millisecond:0,microsecond:0,nanosecond:0};case"hour":return Yh(y,0,0,0,0,0);case"minute":return Yh(t,y,0,0,0,0);case"second":return Yh(t,e,y,0,0,0);case"millisecond":return Yh(t,e,r,y,0,0);case"microsecond":return Yh(t,e,r,n,y,0);case"nanosecond":return Yh(t,e,r,n,i,y);default:throw new Error(`Invalid unit ${a}`)}}function bk(t,e){return FN(O(t,Ie),O(t,Me),O(t,je),O(e,Ie),O(e,Me),O(e,je),"day").days}function qo(t,e,r,n){let i=fo(t,e,r,void 0,n);return{relativeTo:i,days:bk(e,i)}}function ple(t,e,r,n,i){let o=O(t,zr),s=O(t,fe);return lo(ed(O(t,Lo),o,s,e,r,n,i,0,0,0,0,0,0),o,s)}function yle(t,e,r,n,i,o,s,a,d,u,c,l,h,y){let g=t,v=e,x=r,S=n,A=i,T=o,$=s,j=a,K=d,F=u;if(!Le(y)||l==="year"||l==="month"||l==="week"||l==="day"||l==="nanosecond"&&c===1)return{years:g,months:v,weeks:x,days:S,hours:A,minutes:T,seconds:$,milliseconds:j,microseconds:K,nanoseconds:F};let L=y2(0,A,T,$,j,K,F,0),V=d2(z.default.toNumber(L)),q=O(y,zr),k=O(y,fe),P=ed(O(y,Lo),q,k,g,v,x,S,0,0,0,0,0,0),B=ed(new(Ee("%Temporal.Instant%"))(P),q,k,0,0,0,V,0,0,0,0,0,0),p=z.default.subtract(B,P);return z.default.greaterThanOrEqual(z.default.multiply(z.default.subtract(L,p),z.default.BigInt(V)),Ln)&&({years:g,months:v,weeks:x,days:S}=hle(g,v,x,S,0,0,0,0,0,0,0,0,0,V,0,0,0,0,0,0,y),L=Mk(z.default.subtract(L,p),c,l,h),{hours:A,minutes:T,seconds:$,milliseconds:j,microseconds:K,nanoseconds:F}=Jd(0,0,0,0,0,0,z.default.toNumber(L),"hour")),{years:g,months:v,weeks:x,days:S,hours:A,minutes:T,seconds:$,milliseconds:j,microseconds:K,nanoseconds:F}}function rp(t,e,r,n,i,o,s,a,d,u,c,l,h,y){let g=t,v=e,x=r,S=n,A=i,T=o,$=s,j=a,K=d,F=z.default.BigInt(u),L=Ee("%Temporal.Duration%"),V,q,k,P,B=y;if(B){if(Le(B))q=B,B=Wr(B);else if(!Zt(B))throw new TypeError("starting point must be PlainDate or ZonedDateTime");V=O(B,fe)}if(l==="year"||l==="month"||l==="week"||l==="day"){let p,m,w;F=y2(0,A,T,$,j,K,u,0),q&&(p=ple(q,g,v,x,S)),{days:m,nanoseconds:F,dayLengthNs:w}=qN(F,p),k=z.default.BigInt(w),S+=m,A=T=$=j=K=0}switch(l){case"year":{if(!V)throw new RangeError("A starting point is required for years rounding");let p=new L(g),m=typeof V!="string"?Dr(V,"dateAdd"):void 0,w=fo(V,B,p,void 0,m),E=fo(V,B,new L(g,v,x),void 0,m);B=w,S+=bk(w,E);let _=fo(V,B,new L(0,0,0,S),void 0,m),b=zo(null);b.largestUnit="year";let C=hm(V,B,_,b).years;g+=C;let N=B;B=fo(V,B,new L(C),void 0,m),S-=bk(N,B);let D=new L(S<0?-1:1),{days:U}=qo(V,B,D,m);U=hn(U);let G=z.default.multiply(z.default.BigInt(U),k);F=z.default.add(z.default.add(z.default.multiply(G,z.default.BigInt(g)),z.default.multiply(z.default.BigInt(S),k)),F);let Y=fc(F,z.default.multiply(G,z.default.BigInt(c)),h);P=yf(F,G),g=z.default.toNumber(z.default.divide(Y,G)),F=Ln,v=x=S=0;break}case"month":{if(!V)throw new RangeError("A starting point is required for months rounding");let p=new L(g,v),m=typeof V!="string"?Dr(V,"dateAdd"):void 0,w=fo(V,B,p,void 0,m),E=fo(V,B,new L(g,v,x),void 0,m);B=w,S+=bk(w,E);let _=d2(S),b=new L(0,S<0?-1:1),C;for({relativeTo:B,days:C}=qo(V,B,b,m);hn(S)>=hn(C);)v+=_,S-=C,{relativeTo:B,days:C}=qo(V,B,b,m);C=hn(C);let N=z.default.multiply(z.default.BigInt(C),k);F=z.default.add(z.default.add(z.default.multiply(N,z.default.BigInt(v)),z.default.multiply(z.default.BigInt(S),k)),F);let D=fc(F,z.default.multiply(N,z.default.BigInt(c)),h);P=yf(F,N),v=z.default.toNumber(z.default.divide(D,N)),F=Ln,x=S=0;break}case"week":{if(!V)throw new RangeError("A starting point is required for weeks rounding");let p=d2(S),m=new L(0,0,S<0?-1:1),w=typeof V!="string"?Dr(V,"dateAdd"):void 0,E;for({relativeTo:B,days:E}=qo(V,B,m,w);hn(S)>=hn(E);)x+=p,S-=E,{relativeTo:B,days:E}=qo(V,B,m,w);E=hn(E);let _=z.default.multiply(z.default.BigInt(E),k);F=z.default.add(z.default.add(z.default.multiply(_,z.default.BigInt(x)),z.default.multiply(z.default.BigInt(S),k)),F);let b=fc(F,z.default.multiply(_,z.default.BigInt(c)),h);P=yf(F,_),x=z.default.toNumber(z.default.divide(b,_)),F=Ln,S=0;break}case"day":{let p=k;F=z.default.add(z.default.multiply(p,z.default.BigInt(S)),F);let m=fc(F,z.default.multiply(p,z.default.BigInt(c)),h);P=yf(F,p),S=z.default.toNumber(z.default.divide(m,p)),F=Ln;break}case"hour":{let m=z.default.multiply(z.default.BigInt(A),z.default.BigInt(36e11));m=z.default.add(m,z.default.multiply(z.default.BigInt(T),z.default.BigInt(6e10))),m=z.default.add(m,z.default.multiply(z.default.BigInt($),vf)),m=z.default.add(m,z.default.multiply(z.default.BigInt(j),Qc)),m=z.default.add(m,z.default.multiply(z.default.BigInt(K),Rr)),m=z.default.add(m,F),P=yf(m,z.default.BigInt(36e11));let w=fc(m,z.default.BigInt(36e11*c),h);A=z.default.toNumber(z.default.divide(w,z.default.BigInt(36e11))),F=Ln,T=$=j=K=0;break}case"minute":{let m=z.default.multiply(z.default.BigInt(T),z.default.BigInt(6e10));m=z.default.add(m,z.default.multiply(z.default.BigInt($),vf)),m=z.default.add(m,z.default.multiply(z.default.BigInt(j),Qc)),m=z.default.add(m,z.default.multiply(z.default.BigInt(K),Rr)),m=z.default.add(m,F),P=yf(m,z.default.BigInt(6e10));let w=fc(m,z.default.BigInt(6e10*c),h);T=z.default.toNumber(z.default.divide(w,z.default.BigInt(6e10))),F=Ln,$=j=K=0;break}case"second":{let m=z.default.multiply(z.default.BigInt($),vf);m=z.default.add(m,z.default.multiply(z.default.BigInt(j),Qc)),m=z.default.add(m,z.default.multiply(z.default.BigInt(K),Rr)),m=z.default.add(m,F),P=yf(m,z.default.BigInt(1e9));let w=fc(m,z.default.BigInt(1e9*c),h);$=z.default.toNumber(z.default.divide(w,z.default.BigInt(1e9))),F=Ln,j=K=0;break}case"millisecond":{let m=z.default.multiply(z.default.BigInt(j),Qc);m=z.default.add(m,z.default.multiply(z.default.BigInt(K),Rr)),m=z.default.add(m,F),P=yf(m,z.default.BigInt(1e6));let w=fc(m,z.default.BigInt(1e6*c),h);j=z.default.toNumber(z.default.divide(w,z.default.BigInt(1e6))),F=Ln,K=0;break}case"microsecond":{let m=z.default.multiply(z.default.BigInt(K),Rr);m=z.default.add(m,F),P=yf(m,z.default.BigInt(1e3));let w=fc(m,z.default.BigInt(1e3*c),h);K=z.default.toNumber(z.default.divide(w,z.default.BigInt(1e3))),F=Ln;break}case"nanosecond":P=z.default.toNumber(F),F=fc(z.default.BigInt(F),z.default.BigInt(c),h)}return{years:g,months:v,weeks:x,days:S,hours:A,minutes:T,seconds:$,milliseconds:j,microseconds:K,nanoseconds:z.default.toNumber(F),total:P}}function fm(t,e,r,n,i,o){for(let[s,a]of[[t,n],[e,i],[r,o]])if(s!==a)return wv(s-a);return 0}function yv(t,e){let{quotient:r,remainder:n}=ri(t,e);return z.default.lessThan(n,Ln)&&(r=z.default.subtract(r,v2),n=z.default.add(n,e)),{quotient:r,remainder:n}}function o2(t,e){let{quotient:r,remainder:n}=ri(t,e);return Xc(n)||!Sk(t)==!Sk(e)?r:z.default.subtract(r,v2)}function yf(t,e){let{quotient:r,remainder:n}=ri(t,e);return z.default.toNumber(r)+z.default.toNumber(n)/z.default.toNumber(e)}function Dk(t){let e=$6(t);return globalThis.BigInt!==void 0?globalThis.BigInt(e.toString(10)):e}function $6(t){let e=t;if(typeof t=="object"){let r=t[Symbol.toPrimitive];r&&typeof r=="function"&&(e=Nk(r,t,["number"]))}if(typeof e=="number")throw new TypeError("cannot convert number to bigint");return typeof e=="bigint"?z.default.BigInt(e.toString(10)):z.default.BigInt(e)}var GN=(()=>{let t=z.default.BigInt(Date.now()%1e6);return()=>{let e=z.default.BigInt(Date.now()),r=z.default.add(z.default.multiply(e,Qc),t);return t=z.default.remainder(e,Qc),z.default.greaterThan(r,u2)?u2:z.default.lessThan(r,U6)?U6:r}})();function lm(){return new Nue().resolvedOptions().timeZone}function wv(t){return t<0?-1:t>0?1:t}function nr(t){if(t===void 0)return zo(null);if(pn(t)&&t!==null)return t;throw new TypeError("Options parameter must be an object, not "+(t===null?"null":typeof t))}function m2(t,e){let r=zo(null);return r[t]=e,r}function _m(t){let e=zo(null);return n2(e,nr(t),[]),e}function gm(t,e,r,n){let i=t[e];if(i!==void 0){if(i=Ts(i),!r.includes(i))throw new RangeError(`${e} must be one of ${r.join(", ")}, not ${i}`);return i}return n}function np(t){return qKe.includes(xf(t))}function xf(t){return t.replace(/[A-Z]/g,e=>{let r=e.charCodeAt(0);return String.fromCharCode(r+32)})}var mle=new RegExp(`^${Cue.source}$`);function gle(t,e,r,n=t(e),i=t(r)){let o=z.default.BigInt(e),s=z.default.BigInt(r),a=n,d=i;for(;z.default.greaterThan(z.default.subtract(s,o),v2);){let u=z.default.divide(z.default.add(o,s),z.default.BigInt(2)),c=t(u);if(c===a)o=u,a=c;else{if(c!==d)throw new Error(`invalid state in bisection ${a} - ${c} - ${d}`);s=u,d=c}}return s}var vle={hour:36e11,minute:6e10,second:1e9,millisecond:1e6,microsecond:1e3,nanosecond:1},ble=Symbol("date"),wle=Symbol("ym"),_le=Symbol("md"),xle=Symbol("time"),Ele=Symbol("datetime"),Sle=Symbol("instant"),s2=Symbol("original"),e2=Symbol("timezone"),Gd=Symbol("calendar-id"),Tle=Symbol("locale"),cN=Symbol("options"),N6=t=>({value:t,enumerable:!0,writable:!1,configurable:!0}),a2=globalThis.Intl.DateTimeFormat,ip=Object.assign,HKe=Object.prototype.hasOwnProperty,WKe=Reflect.apply;function Q1(t,e){let r=t[e];return typeof r=="function"&&(r=new a2(t[Tle],r(t[cN])),t[e]=r),r}function Av(t,e={}){if(!(this instanceof Av))return new Av(t,e);let r=e!==void 0,n=r?ip({},e):{},i=new a2(t,n),o=i.resolvedOptions();if(r){let s=ip({},o);for(let a in s)WKe(HKe,n,[a])||delete s[a];this[cN]=s}else this[cN]=n;this[Tle]=o.locale,this[s2]=i,this[e2]=o.timeZone,this[Gd]=o.calendar,this[ble]=ZKe,this[wle]=JKe,this[_le]=YKe,this[xle]=GKe,this[Ele]=XKe,this[Sle]=QKe}Object.defineProperty(Av,"name",{writable:!0,value:"DateTimeFormat"}),Av.supportedLocalesOf=function(t,e){return a2.supportedLocalesOf(t,e)};var G$={resolvedOptions:N6(function(){return this[s2].resolvedOptions()}),format:N6(function(e,...r){let{instant:n,formatter:i}=c2(e,this);return n&&i?i.format(n.epochMilliseconds):this[s2].format(e,...r)}),formatRange:N6(function(e,r){if(g2(e)||g2(r)){if(!Ale(e,r))throw new TypeError("Intl.DateTimeFormat.formatRange accepts two values of the same type");let{instant:n,formatter:i}=c2(e,this),{instant:o,formatter:s}=c2(r,this);if(n&&o&&i&&s&&i===s)return i.formatRange(n.epochMilliseconds,o.epochMilliseconds)}return this[s2].formatRange(e,r)})};"formatToParts"in a2.prototype&&(G$.formatToParts=N6(function(e,...r){let{instant:n,formatter:i}=c2(e,this);return n&&i?i.formatToParts(n.epochMilliseconds):this[s2].formatToParts(e,...r)})),"formatRangeToParts"in a2.prototype&&(G$.formatRangeToParts=N6(function(e,r){if(g2(e)||g2(r)){if(!Ale(e,r))throw new TypeError("Intl.DateTimeFormat.formatRangeToParts accepts two values of the same type");let{instant:n,formatter:i}=c2(e,this),{instant:o,formatter:s}=c2(r,this);if(n&&o&&i&&s&&i===s)return i.formatRangeToParts(n.epochMilliseconds,o.epochMilliseconds)}return this[s2].formatRangeToParts(e,r)})),Av.prototype=Object.create(a2.prototype,G$),Object.defineProperty(Av,"prototype",{writable:!1,enumerable:!1,configurable:!1});var op=Av;function dS(t={},e={}){let r=ip({},t);for(let n of["year","month","day","hour","minute","second","weekday","dayPeriod","timeZoneName","dateStyle","timeStyle"])r[n]=n in e?e[n]:r[n],r[n]!==!1&&r[n]!==void 0||delete r[n];return r}function GKe(t){let e=dS(t,{year:!1,month:!1,day:!1,weekday:!1,timeZoneName:!1,dateStyle:!1});return YN(e)||(e=ip({},e,{hour:"numeric",minute:"numeric",second:"numeric"})),e}function JKe(t){let e=dS(t,{day:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"year"in e||"month"in e||(e=ip(e,{year:"numeric",month:"numeric"})),e}function YKe(t){let e=dS(t,{year:!1,hour:!1,minute:!1,second:!1,weekday:!1,dayPeriod:!1,timeZoneName:!1,dateStyle:!1,timeStyle:!1});return"month"in e||"day"in e||(e=ip({},e,{month:"numeric",day:"numeric"})),e}function ZKe(t){let e=dS(t,{hour:!1,minute:!1,second:!1,dayPeriod:!1,timeZoneName:!1,timeStyle:!1});return JN(e)||(e=ip({},e,{year:"numeric",month:"numeric",day:"numeric"})),e}function XKe(t){let e=dS(t,{timeZoneName:!1});return YN(e)||JN(e)||(e=ip({},e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),e}function QKe(t){let e=t;return YN(e)||JN(e)||(e=ip({},e,{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",second:"numeric"})),e}function JN(t){return"year"in t||"month"in t||"day"in t||"weekday"in t||"dateStyle"in t}function YN(t){return"hour"in t||"minute"in t||"second"in t||"timeStyle"in t||"dayPeriod"in t}function g2(t){return Zt(t)||qn(t)||Et(t)||Le(t)||Ir(t)||Ci(t)||ki(t)}function Ale(t,e){return!(!g2(t)||!g2(e))&&!(qn(t)&&!qn(e))&&!(Zt(t)&&!Zt(e))&&!(Et(t)&&!Et(e))&&!(Le(t)&&!Le(e))&&!(Ir(t)&&!Ir(e))&&!(Ci(t)&&!Ci(e))&&!(ki(t)&&!ki(e))}function c2(t,e){let r=Ee("%Temporal.PlainDateTime%");if(qn(t)){let n=new r(1970,1,1,O(t,Tt),O(t,At),O(t,kt),O(t,Pt),O(t,It),O(t,Rt),e[Gd]);return{instant:Ss(e[e2],n,"compatible"),formatter:Q1(e,xle)}}if(Ir(t)){let n=O(t,Ie),i=O(t,Me),o=O(t,je),s=po(O(t,fe));if(s!==e[Gd])throw new RangeError(`cannot format PlainYearMonth with calendar ${s} in locale with calendar ${e[Gd]}`);let a=new r(n,i,o,12,0,0,0,0,0,s);return{instant:Ss(e[e2],a,"compatible"),formatter:Q1(e,wle)}}if(Ci(t)){let n=O(t,Ie),i=O(t,Me),o=O(t,je),s=po(O(t,fe));if(s!==e[Gd])throw new RangeError(`cannot format PlainMonthDay with calendar ${s} in locale with calendar ${e[Gd]}`);let a=new r(n,i,o,12,0,0,0,0,0,s);return{instant:Ss(e[e2],a,"compatible"),formatter:Q1(e,_le)}}if(Zt(t)){let n=O(t,Ie),i=O(t,Me),o=O(t,je),s=po(O(t,fe));if(s!=="iso8601"&&s!==e[Gd])throw new RangeError(`cannot format PlainDate with calendar ${s} in locale with calendar ${e[Gd]}`);let a=new r(n,i,o,12,0,0,0,0,0,e[Gd]);return{instant:Ss(e[e2],a,"compatible"),formatter:Q1(e,ble)}}if(Et(t)){let n=O(t,Ie),i=O(t,Me),o=O(t,je),s=O(t,Tt),a=O(t,At),d=O(t,kt),u=O(t,Pt),c=O(t,It),l=O(t,Rt),h=po(O(t,fe));if(h!=="iso8601"&&h!==e[Gd])throw new RangeError(`cannot format PlainDateTime with calendar ${h} in locale with calendar ${e[Gd]}`);let y=t;return h==="iso8601"&&(y=new r(n,i,o,s,a,d,u,c,l,e[Gd])),{instant:Ss(e[e2],y,"compatible"),formatter:Q1(e,Ele)}}if(Le(t))throw new TypeError("Temporal.ZonedDateTime not supported in DateTimeFormat methods. Use toLocaleString() instead.");return ki(t)?{instant:t,formatter:Q1(e,Sle)}:{}}var HEt=Object.freeze({__proto__:null,DateTimeFormat:op}),F6=class t{constructor(e){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");let r=$6(e);mv(r),Sf(this),Dt(this,ft,r)}get epochSeconds(){if(!ki(this))throw new TypeError("invalid receiver");let e=O(this,ft);return z.default.toNumber(o2(e,vf))}get epochMilliseconds(){if(!ki(this))throw new TypeError("invalid receiver");let e=z.default.BigInt(O(this,ft));return z.default.toNumber(o2(e,Qc))}get epochMicroseconds(){if(!ki(this))throw new TypeError("invalid receiver");return Dk(o2(z.default.BigInt(O(this,ft)),Rr))}get epochNanoseconds(){if(!ki(this))throw new TypeError("invalid receiver");return Dk(z.default.BigInt(O(this,ft)))}add(e){if(!ki(this))throw new TypeError("invalid receiver");return wue("add",this,e)}subtract(e){if(!ki(this))throw new TypeError("invalid receiver");return wue("subtract",this,e)}until(e,r){if(!ki(this))throw new TypeError("invalid receiver");return hue("until",this,e,r)}since(e,r){if(!ki(this))throw new TypeError("invalid receiver");return hue("since",this,e,r)}round(e){if(!ki(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");let r=typeof e=="string"?m2("smallestUnit",e):nr(e),n=w2(r),i=rl(r,"halfExpand"),o=Ua(r,"smallestUnit","time",xv);_2(n,{hour:24,minute:1440,second:86400,millisecond:864e5,microsecond:864e8,nanosecond:864e11}[o],!0);let s=Mk(O(this,ft),n,o,i);return new t(s)}equals(e){if(!ki(this))throw new TypeError("invalid receiver");let r=tl(e),n=O(this,ft),i=O(r,ft);return z.default.equal(z.default.BigInt(n),z.default.BigInt(i))}toString(e){if(!ki(this))throw new TypeError("invalid receiver");let r=nr(e),n=rS(r),i=rl(r,"trunc"),o=Ua(r,"smallestUnit","time",void 0);if(o==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let s=r.timeZone;s!==void 0&&(s=Fo(s));let{precision:a,unit:d,increment:u}=nS(o,n),c=Mk(O(this,ft),u,d,i);return iue(new t(c),s,a)}toJSON(){if(!ki(this))throw new TypeError("invalid receiver");return iue(this,void 0,"auto")}toLocaleString(e,r){if(!ki(this))throw new TypeError("invalid receiver");return new op(e,r).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.Instant")}toZonedDateTime(e){if(!ki(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid argument in toZonedDateTime");let r=e.calendar;if(r===void 0)throw new TypeError("missing calendar property in toZonedDateTime");let n=Ka(r),i=e.timeZone;if(i===void 0)throw new TypeError("missing timeZone property in toZonedDateTime");let o=Fo(i);return lo(O(this,ft),o,n)}toZonedDateTimeISO(e){if(!ki(this))throw new TypeError("invalid receiver");let r=Fo(e);return lo(O(this,ft),r,"iso8601")}static fromEpochSeconds(e){let r=l2(e),n=z.default.multiply(z.default.BigInt(r),vf);return mv(n),new t(n)}static fromEpochMilliseconds(e){let r=l2(e),n=z.default.multiply(z.default.BigInt(r),Qc);return mv(n),new t(n)}static fromEpochMicroseconds(e){let r=$6(e),n=z.default.multiply(r,Rr);return mv(n),new t(n)}static fromEpochNanoseconds(e){let r=$6(e);return mv(r),new t(r)}static from(e){return ki(e)?new t(O(e,ft)):tl(e)}static compare(e,r){let n=tl(e),i=tl(r),o=O(n,ft),s=O(i,ft);return z.default.lessThan(o,s)?-1:z.default.greaterThan(o,s)?1:0}};Ef(F6,"Temporal.Instant");var kle=Array.prototype.includes,eqe=Array.prototype.push,tqe=globalThis.Intl.DateTimeFormat,rqe=Array.prototype.sort,nqe=Math.abs,iqe=Math.floor,J$=Object.create,dN=Object.entries,Ple=Set,Tue=Reflect.ownKeys,Ko=Set.prototype.add,Ile=Set.prototype.values,En={},xn=class{constructor(e){if(arguments.length<1)throw new RangeError("missing argument: id is required");let r=Ts(e);if(!np(r))throw new RangeError(`invalid calendar identifier ${r}`);Sf(this),Dt(this,Mn,xf(r))}get id(){if(!Un(this))throw new TypeError("invalid receiver");return O(this,Mn)}dateFromFields(e,r){if(!Un(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid fields");let n=nr(r),i=O(this,Mn);return En[i].dateFromFields(e,n,i)}yearMonthFromFields(e,r){if(!Un(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid fields");let n=nr(r),i=O(this,Mn);return En[i].yearMonthFromFields(e,n,i)}monthDayFromFields(e,r){if(!Un(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid fields");let n=nr(r),i=O(this,Mn);return En[i].monthDayFromFields(e,n,i)}fields(e){if(!Un(this))throw new TypeError("invalid receiver");let r=[],n=new Set(["year","month","monthCode","day","hour","minute","second","millisecond","microsecond","nanosecond"]);for(let i of e){if(typeof i!="string")throw new TypeError("invalid fields");if(!n.has(i))throw new RangeError(`invalid field name ${i}`);n.delete(i),eqe.call(r,i)}return En[O(this,Mn)].fields(r)}mergeFields(e,r){if(!Un(this))throw new TypeError("invalid receiver");let n=rue(e),i=J$(null);n2(i,n,[],[void 0]);let o=rue(r),s=J$(null);n2(s,o,[],[void 0]);let a=Tue(s),d=En[O(this,Mn)].fieldKeysToIgnore(a),u=J$(null),c=Tue(i);for(let l of c){let h;h=Ge(kle,d,[l])?s[l]:i[l],h!==void 0&&(u[l]=h)}return n2(u,s,[]),u}dateAdd(e,r,n){if(!Un(this))throw new TypeError("invalid receiver");let i=Wr(e),o=i2(r),s=ni(nr(n)),{days:a}=Jd(O(o,ms),O(o,gs),O(o,vs),O(o,bs),O(o,ws),O(o,_s),O(o,xs),"day"),d=O(this,Mn);return En[d].dateAdd(i,O(o,ys),O(o,Xi),O(o,la),a,s,d)}dateUntil(e,r,n){if(!Un(this))throw new TypeError("invalid receiver");let i=Wr(e),o=Wr(r),s=Ua(nr(n),"largestUnit","date","auto");s==="auto"&&(s="day");let{years:a,months:d,weeks:u,days:c}=En[O(this,Mn)].dateUntil(i,o,s);return new(Ee("%Temporal.Duration%"))(a,d,u,c,0,0,0,0,0,0)}year(e){let r=e;if(!Un(this))throw new TypeError("invalid receiver");return Ir(r)||(r=Wr(r)),En[O(this,Mn)].year(r)}month(e){let r=e;if(!Un(this))throw new TypeError("invalid receiver");if(Ci(r))throw new TypeError("use monthCode on PlainMonthDay instead");return Ir(r)||(r=Wr(r)),En[O(this,Mn)].month(r)}monthCode(e){let r=e;if(!Un(this))throw new TypeError("invalid receiver");return Ir(r)||Ci(r)||(r=Wr(r)),En[O(this,Mn)].monthCode(r)}day(e){let r=e;if(!Un(this))throw new TypeError("invalid receiver");return Ci(r)||(r=Wr(r)),En[O(this,Mn)].day(r)}era(e){let r=e;if(!Un(this))throw new TypeError("invalid receiver");return Ir(r)||(r=Wr(r)),En[O(this,Mn)].era(r)}eraYear(e){let r=e;if(!Un(this))throw new TypeError("invalid receiver");return Ir(r)||(r=Wr(r)),En[O(this,Mn)].eraYear(r)}dayOfWeek(e){if(!Un(this))throw new TypeError("invalid receiver");let r=Wr(e);return En[O(this,Mn)].dayOfWeek(r)}dayOfYear(e){if(!Un(this))throw new TypeError("invalid receiver");let r=Wr(e);return En[O(this,Mn)].dayOfYear(r)}weekOfYear(e){if(!Un(this))throw new TypeError("invalid receiver");let r=Wr(e);return En[O(this,Mn)].weekOfYear(r)}yearOfWeek(e){if(!Un(this))throw new TypeError("invalid receiver");let r=Wr(e);return En[O(this,Mn)].yearOfWeek(r)}daysInWeek(e){if(!Un(this))throw new TypeError("invalid receiver");let r=Wr(e);return En[O(this,Mn)].daysInWeek(r)}daysInMonth(e){let r=e;if(!Un(this))throw new TypeError("invalid receiver");return Ir(r)||(r=Wr(r)),En[O(this,Mn)].daysInMonth(r)}daysInYear(e){let r=e;if(!Un(this))throw new TypeError("invalid receiver");return Ir(r)||(r=Wr(r)),En[O(this,Mn)].daysInYear(r)}monthsInYear(e){let r=e;if(!Un(this))throw new TypeError("invalid receiver");return Ir(r)||(r=Wr(r)),En[O(this,Mn)].monthsInYear(r)}inLeapYear(e){let r=e;if(!Un(this))throw new TypeError("invalid receiver");return Ir(r)||(r=Wr(r)),En[O(this,Mn)].inLeapYear(r)}toString(){if(!Un(this))throw new TypeError("invalid receiver");return O(this,Mn)}toJSON(){if(!Un(this))throw new TypeError("invalid receiver");return O(this,Mn)}static from(e){return x2(Ka(e))}};function ZN(t){if(!t.startsWith("M"))throw new RangeError(`Invalid month code: ${t}.  Month codes must start with M.`);let e=+t.slice(1);if(isNaN(e))throw new RangeError(`Invalid month code: ${t}`);return e}function ep(t,e=!1){return`M${t.toString().padStart(2,"0")}${e?"L":""}`}function wk(t,e,r=12){let{month:n,monthCode:i}=t;if(i===void 0){if(n===void 0)throw new TypeError("Either month or monthCode are required");e==="reject"&&ho(n,1,r),e==="constrain"&&(n=$a(n,1,r)),i=ep(n)}else{let o=ZN(i);if(n!==void 0&&n!==o)throw new RangeError(`monthCode ${i} and month ${n} must match if both are present`);if(i!==ep(o))throw new RangeError(`Invalid month code: ${i}`);if(n=o,n<1||n>r)throw new RangeError(`Invalid monthCode: ${i}`)}return{...t,month:n,monthCode:i}}Ef(xn,"Temporal.Calendar"),Dn("Temporal.Calendar.from",xn.from),Dn("Temporal.Calendar.prototype.dateAdd",xn.prototype.dateAdd),Dn("Temporal.Calendar.prototype.dateFromFields",xn.prototype.dateFromFields),Dn("Temporal.Calendar.prototype.dateUntil",xn.prototype.dateUntil),Dn("Temporal.Calendar.prototype.day",xn.prototype.day),Dn("Temporal.Calendar.prototype.dayOfWeek",xn.prototype.dayOfWeek),Dn("Temporal.Calendar.prototype.dayOfYear",xn.prototype.dayOfYear),Dn("Temporal.Calendar.prototype.daysInMonth",xn.prototype.daysInMonth),Dn("Temporal.Calendar.prototype.daysInWeek",xn.prototype.daysInWeek),Dn("Temporal.Calendar.prototype.daysInYear",xn.prototype.daysInYear),Dn("Temporal.Calendar.prototype.era",xn.prototype.era),Dn("Temporal.Calendar.prototype.eraYear",xn.prototype.eraYear),Dn("Temporal.Calendar.prototype.fields",xn.prototype.fields),Dn("Temporal.Calendar.prototype.inLeapYear",xn.prototype.inLeapYear),Dn("Temporal.Calendar.prototype.mergeFields",xn.prototype.mergeFields),Dn("Temporal.Calendar.prototype.month",xn.prototype.month),Dn("Temporal.Calendar.prototype.monthCode",xn.prototype.monthCode),Dn("Temporal.Calendar.prototype.monthDayFromFields",xn.prototype.monthDayFromFields),Dn("Temporal.Calendar.prototype.monthsInYear",xn.prototype.monthsInYear),Dn("Temporal.Calendar.prototype.weekOfYear",xn.prototype.weekOfYear),Dn("Temporal.Calendar.prototype.year",xn.prototype.year),Dn("Temporal.Calendar.prototype.yearMonthFromFields",xn.prototype.yearMonthFromFields),Dn("Temporal.Calendar.prototype.yearOfWeek",xn.prototype.yearOfWeek),En.iso8601={dateFromFields(t,e,r){let n=$t(t,["day","month","monthCode","year"],["year","day"]),i=ni(e);n=wk(n);let{year:o,month:s,day:a}=n;return{year:o,month:s,day:a}=Ak(o,s,a,i),td(o,s,a,r)},yearMonthFromFields(t,e,r){let n=$t(t,["month","monthCode","year"],["year"]),i=ni(e);n=wk(n);let{year:o,month:s}=n;return{year:o,month:s}=function(d,u,c){let l=d,h=u;switch(c){case"reject":_f(l,h,1);break;case"constrain":({year:l,month:h}=ale(l,h))}return{year:l,month:h}}(o,s,i),q6(o,s,r,1)},monthDayFromFields(t,e,r){let n=$t(t,["day","month","monthCode","year"],["day"]),i=ni(e);if(n.month!==void 0&&n.year===void 0&&n.monthCode===void 0)throw new TypeError("either year or monthCode required with month");let o=n.monthCode===void 0;n=wk(n);let{month:s,day:a,year:d}=n;return{month:s,day:a}=Ak(o?d:1972,s,a,i),K6(s,a,r,1972)},fields:t=>t,fieldKeysToIgnore(t){let e=new Ple;for(let r=0;r<t.length;r++){let n=t[r];Ge(Ko,e,[n]),n==="month"?Ge(Ko,e,["monthCode"]):n==="monthCode"&&Ge(Ko,e,["month"])}return[...Ge(Ile,e,[])]},dateAdd(t,e,r,n,i,o,s){let a=O(t,Ie),d=O(t,Me),u=O(t,je);return{year:a,month:d,day:u}=bv(a,d,u,e,r,n,i,o),td(a,d,u,s)},dateUntil:(t,e,r)=>FN(O(t,Ie),O(t,Me),O(t,je),O(e,Ie),O(e,Me),O(e,je),r),year:t=>O(t,Ie),era(){},eraYear(){},month:t=>O(t,Me),monthCode:t=>ep(O(t,Me)),day:t=>O(t,je),dayOfWeek:t=>oN(O(t,Ie),O(t,Me),O(t,je)),dayOfYear:t=>Bk(O(t,Ie),O(t,Me),O(t,je)),weekOfYear:t=>lue(O(t,Ie),O(t,Me),O(t,je)).week,yearOfWeek:t=>lue(O(t,Ie),O(t,Me),O(t,je)).year,daysInWeek:()=>7,daysInMonth:t=>Qh(O(t,Ie),O(t,Me)),daysInYear(t){let e=t;return $i(e,Ie)||(e=Wr(e)),mm(O(e,Ie))?366:365},monthsInYear:()=>12,inLeapYear(t){let e=t;return $i(e,Ie)||(e=Wr(e)),mm(O(e,Ie))}};var Ai=class t{constructor(e){if(this.map=new Map,this.calls=0,this.hits=0,this.misses=0,this.now=globalThis.performance?globalThis.performance.now():Date.now(),e!==void 0){let r=0;for(let n of e.map.entries()){if(++r>t.MAX_CACHE_ENTRIES)break;this.map.set(...n)}}}get(e){let r=this.map.get(e);return r&&(this.hits++,this.report()),this.calls++,r}set(e,r){this.map.set(e,r),this.misses++,this.report()}report(){}setObject(e){if(t.objectMap.get(e))throw new RangeError("object already cached");t.objectMap.set(e,this),this.report()}static getCacheForObject(e){let r=t.objectMap.get(e);return r||(r=new t,t.objectMap.set(e,r)),r}};function Rle({isoYear:t,isoMonth:e,isoDay:r}){return`${Iv(t)}-${Sn(e)}-${Sn(r)}T00:00Z`}function Y$(t,e){return{years:t.year-e.year,months:t.month-e.month,days:t.day-e.day}}Ai.objectMap=new WeakMap,Ai.MAX_CACHE_ENTRIES=1e3;var vm=class{constructor(){this.eraLength="short",this.hasEra=!0,this.erasBeginMidYear=!1}getFormatter(){return this.formatter===void 0&&(this.formatter=new tqe(`en-US-u-ca-${this.id}`,{day:"numeric",month:"numeric",year:"numeric",era:this.eraLength,timeZone:"UTC"})),this.formatter}isoToCalendarDate(e,r){let{year:n,month:i,day:o}=e,s=JSON.stringify({func:"isoToCalendarDate",isoYear:n,isoMonth:i,isoDay:o,id:this.id}),a=r.get(s);if(a)return a;let d=this.getFormatter(),u,c;try{c=Rle({isoYear:n,isoMonth:i,isoDay:o}),u=d.formatToParts(new Date(c))}catch{throw new RangeError(`Invalid ISO date: ${JSON.stringify({isoYear:n,isoMonth:i,isoDay:o})}`)}let l={};for(let{type:y,value:g}of u){if(y==="year"&&(l.eraYear=+g),y==="relatedYear"&&(l.eraYear=+g),y==="month"){let v=/^([0-9]*)(.*?)$/.exec(g);if(!v||v.length!=3||!v[1]&&!v[2])throw new RangeError(`Unexpected month: ${g}`);if(l.month=v[1]?+v[1]:1,l.month<1)throw new RangeError(`Invalid month ${g} from ${c}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10527)`);if(l.month>13)throw new RangeError(`Invalid month ${g} from ${c}[u-ca-${this.id}] (probably due to https://bugs.chromium.org/p/v8/issues/detail?id=10529)`);v[2]&&(l.monthExtra=v[2])}y==="day"&&(l.day=+g),this.hasEra&&y==="era"&&g!=null&&g!==""&&(g=g.split(" (")[0],l.era=g.normalize("NFD").replace(/[^-0-9 \p{L}]/gu,"").replace(" ","-").toLowerCase())}if(l.eraYear===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);if(this.reviseIntlEra){let{era:y,eraYear:g}=this.reviseIntlEra(l,e);l.era=y,l.eraYear=g}this.checkIcuBugs&&this.checkIcuBugs(e);let h=this.adjustCalendarDate(l,r,"constrain",!0);if(h.year===void 0)throw new RangeError(`Missing year converting ${JSON.stringify(e)}`);if(h.month===void 0)throw new RangeError(`Missing month converting ${JSON.stringify(e)}`);if(h.day===void 0)throw new RangeError(`Missing day converting ${JSON.stringify(e)}`);return r.set(s,h),["constrain","reject"].forEach(y=>{let g=JSON.stringify({func:"calendarToIsoDate",year:h.year,month:h.month,day:h.day,overflow:y,id:this.id});r.set(g,e)}),h}validateCalendarDate(e){let{era:r,month:n,year:i,day:o,eraYear:s,monthCode:a,monthExtra:d}=e;if(d!==void 0)throw new RangeError("Unexpected `monthExtra` value");if(i===void 0&&s===void 0)throw new TypeError("year or eraYear is required");if(n===void 0&&a===void 0)throw new TypeError("month or monthCode is required");if(o===void 0)throw new RangeError("Missing day");if(a!==void 0){if(typeof a!="string")throw new RangeError("monthCode must be a string, not "+typeof a);if(!/^M([01]?\d)(L?)$/.test(a))throw new RangeError(`Invalid monthCode: ${a}`)}if(this.constantEra){if(r!==void 0&&r!==this.constantEra)throw new RangeError(`era must be ${this.constantEra}, not ${r}`);if(s!==void 0&&i!==void 0&&s!==i)throw new RangeError(`eraYear ${s} does not match year ${i}`)}if(this.hasEra&&e.era===void 0!=(e.eraYear===void 0))throw new RangeError("properties 'era' and 'eraYear' must be provided together")}adjustCalendarDate(e,r,n="constrain",i=!1){if(this.calendarType==="lunisolar")throw new RangeError("Override required for lunisolar calendars");let o=e;if(this.validateCalendarDate(o),this.constantEra){let{year:u,eraYear:c}=o;o={...o,era:this.constantEra,year:u!==void 0?u:c,eraYear:c!==void 0?c:u}}let s=this.monthsInYear(o,r),{month:a,monthCode:d}=o;return{month:a,monthCode:d}=wk(o,n,s),{...o,month:a,monthCode:d}}regulateMonthDayNaive(e,r,n){let i=this.monthsInYear(e,n),{month:o,day:s}=e;return r==="reject"?(ho(o,1,i),ho(s,1,this.maximumMonthLength(e))):(o=$a(o,1,i),s=$a(s,1,this.maximumMonthLength({...e,month:o}))),{...e,month:o,day:s}}calendarToIsoDate(e,r="constrain",n){let i=e,o=this.adjustCalendarDate(e,n,r,!1);o=this.regulateMonthDayNaive(o,r,n);let{year:s,month:a,day:d}=o,u=JSON.stringify({func:"calendarToIsoDate",year:s,month:a,day:d,overflow:r,id:this.id}),c,l=n.get(u);if(l||i.year!==void 0&&i.month!==void 0&&i.day!==void 0&&(i.year!==o.year||i.month!==o.month||i.day!==o.day)&&(c=JSON.stringify({func:"calendarToIsoDate",year:i.year,month:i.month,day:i.day,overflow:r,id:this.id}),l=n.get(c),l))return l;let h=this.estimateIsoDate({year:s,month:a,day:d}),y=A=>{let T=this.addDaysIso(h,A);if(o.day>this.minimumMonthLength(o)){let $=this.isoToCalendarDate(T,n);for(;$.month!==a||$.year!==s;){if(r==="reject")throw new RangeError(`day ${d} does not exist in month ${a} of year ${s}`);T=this.addDaysIso(T,-1),$=this.isoToCalendarDate(T,n)}}return T},g=0,v=this.isoToCalendarDate(h,n),x=Y$(o,v);if(x.years!==0||x.months!==0||x.days!==0){let A=365*x.years+30*x.months+x.days;h=this.addDaysIso(h,A),v=this.isoToCalendarDate(h,n),x=Y$(o,v),x.years===0&&x.months===0?h=y(x.days):g=this.compareCalendarDates(o,v)}let S=8;for(;g;){h=this.addDaysIso(h,g*S);let A=v;v=this.isoToCalendarDate(h,n);let T=g;if(g=this.compareCalendarDates(o,v),g){if(x=Y$(o,v),x.years===0&&x.months===0)h=y(x.days),g=0;else if(T&&g!==T)if(S>1)S/=2;else{if(r==="reject")throw new RangeError(`Can't find ISO date from calendar date: ${JSON.stringify({...i})}`);this.compareCalendarDates(v,A)>0&&(h=this.addDaysIso(h,-1)),g=0}}}if(n.set(u,h),c&&n.set(c,h),o.year===void 0||o.month===void 0||o.day===void 0||o.monthCode===void 0||this.hasEra&&(o.era===void 0||o.eraYear===void 0))throw new RangeError("Unexpected missing property");return h}temporalToCalendarDate(e,r){let n={year:O(e,Ie),month:O(e,Me),day:O(e,je)};return this.isoToCalendarDate(n,r)}compareCalendarDates(e,r){let n=$t(e,["day","month","year"],["day","month","year"]),i=$t(r,["day","month","year"],["day","month","year"]);return n.year!==i.year?wv(n.year-i.year):n.month!==i.month?wv(n.month-i.month):n.day!==i.day?wv(n.day-i.day):0}regulateDate(e,r="constrain",n){let i=this.calendarToIsoDate(e,r,n);return this.isoToCalendarDate(i,n)}addDaysIso(e,r){return bv(e.year,e.month,e.day,0,0,0,r,"constrain")}addDaysCalendar(e,r,n){let i=this.calendarToIsoDate(e,"constrain",n),o=this.addDaysIso(i,r);return this.isoToCalendarDate(o,n)}addMonthsCalendar(e,r,n,i){let o=e,{day:s}=o;for(let a=0,d=nqe(r);a<d;a++){let{month:u}=o,c=o,l=r<0?-Math.max(s,this.daysInPreviousMonth(o,i)):this.daysInMonth(o,i),h=this.calendarToIsoDate(o,"constrain",i),y=this.addDaysIso(h,l);if(o=this.isoToCalendarDate(y,i),r>0){let g=this.monthsInYear(c,i);for(;o.month-1!=u%g;)y=this.addDaysIso(y,-1),o=this.isoToCalendarDate(y,i)}o.day!==s&&(o=this.regulateDate({...o,day:s},"constrain",i))}if(n==="reject"&&o.day!==s)throw new RangeError(`Day ${s} does not exist in resulting calendar month`);return o}addCalendar(e,{years:r=0,months:n=0,weeks:i=0,days:o=0},s,a){let{year:d,day:u,monthCode:c}=e,l=this.adjustCalendarDate({year:d+r,monthCode:c,day:u},a),h=this.addMonthsCalendar(l,n,s,a),y=o+7*i;return this.addDaysCalendar(h,y,a)}untilCalendar(e,r,n,i){let o=0,s=0,a=0,d=0;switch(n){case"day":o=this.calendarDaysUntil(e,r,i);break;case"week":{let u=this.calendarDaysUntil(e,r,i);o=u%7,s=(u-o)/7;break}case"month":case"year":{let u=this.compareCalendarDates(r,e);if(!u)return{years:0,months:0,weeks:0,days:0};let c=r.year-e.year,l=r.day-e.day;if(n==="year"&&c){let g=0;r.monthCode>e.monthCode&&(g=1),r.monthCode<e.monthCode&&(g=-1),g||(g=Math.sign(l)),d=g*u<0?c-u:c}let h,y=d?this.addCalendar(e,{years:d},"constrain",i):e;do a+=u,h=y,y=this.addMonthsCalendar(h,u,"constrain",i),y.day!==e.day&&(y=this.regulateDate({...y,day:e.day},"constrain",i));while(this.compareCalendarDates(r,y)*u>=0);a-=u,o=this.calendarDaysUntil(h,r,i);break}}return{years:d,months:a,weeks:s,days:o}}daysInMonth(e,r){let{day:n}=e,i=this.maximumMonthLength(e),o=this.minimumMonthLength(e);if(o===i)return o;let s=n<=i-o?i:o,a=this.calendarToIsoDate(e,"constrain",r),d=this.addDaysIso(a,s),u=this.isoToCalendarDate(d,r),c=this.addDaysIso(d,-u.day);return this.isoToCalendarDate(c,r).day}daysInPreviousMonth(e,r){let{day:n,month:i,year:o}=e,s={year:i>1?o:o-1,month:i,day:1},a=i>1?i-1:this.monthsInYear(s,r);s={...s,month:a};let d=this.minimumMonthLength(s),u=this.maximumMonthLength(s);if(d===u)return u;let c=this.calendarToIsoDate(e,"constrain",r),l=this.addDaysIso(c,-n);return this.isoToCalendarDate(l,r).day}startOfCalendarYear(e){return{year:e.year,month:1,monthCode:"M01",day:1}}startOfCalendarMonth(e){return{year:e.year,month:e.month,day:1}}calendarDaysUntil(e,r,n){let i=this.calendarToIsoDate(e,"constrain",n),o=this.calendarToIsoDate(r,"constrain",n);return this.isoDaysUntil(i,o)}isoDaysUntil(e,r){return FN(e.year,e.month,e.day,r.year,r.month,r.day,"day").days}monthDayFromFields(e,r,n){let i,o,s,a,d,{monthCode:u,day:c}=e;if(u===void 0){let{year:y,era:g,eraYear:v}=e;if(y===void 0&&(g===void 0||v===void 0))throw new TypeError("when `monthCode` is omitted, `year` (or `era` and `eraYear`) and `month` are required");({monthCode:u,day:c}=this.isoToCalendarDate(this.calendarToIsoDate(e,r,n),n))}let l=this.isoToCalendarDate({year:1972,month:12,day:31},n),h=l.monthCode>u||l.monthCode===u&&l.day>=c?l.year:l.year-1;for(let y=0;y<100;y++){let g=this.adjustCalendarDate({day:c,monthCode:u,year:h-y},n),v=this.calendarToIsoDate(g,"constrain",n),x=this.isoToCalendarDate(v,n);if({year:i,month:o,day:s}=v,x.monthCode===u&&x.day===c)return{month:o,day:s,year:i};r==="constrain"&&(a===void 0||x.monthCode===a.monthCode&&x.day>a.day)&&(a=x,d=v)}if(r==="constrain"&&d!==void 0)return d;throw new RangeError(`No recent ${this.id} year with monthCode ${u} and day ${c}`)}},uN=class extends vm{constructor(){super(...arguments),this.id="hebrew",this.calendarType="lunisolar",this.months={Tishri:{leap:1,regular:1,monthCode:"M01",days:30},Heshvan:{leap:2,regular:2,monthCode:"M02",days:{min:29,max:30}},Kislev:{leap:3,regular:3,monthCode:"M03",days:{min:29,max:30}},Tevet:{leap:4,regular:4,monthCode:"M04",days:29},Shevat:{leap:5,regular:5,monthCode:"M05",days:30},Adar:{leap:void 0,regular:6,monthCode:"M06",days:29},"Adar I":{leap:6,regular:void 0,monthCode:"M05L",days:30},"Adar II":{leap:7,regular:void 0,monthCode:"M06",days:29},Nisan:{leap:8,regular:7,monthCode:"M07",days:30},Iyar:{leap:9,regular:8,monthCode:"M08",days:29},Sivan:{leap:10,regular:9,monthCode:"M09",days:30},Tamuz:{leap:11,regular:10,monthCode:"M10",days:29},Av:{leap:12,regular:11,monthCode:"M11",days:30},Elul:{leap:13,regular:12,monthCode:"M12",days:29}},this.hasEra=!1}inLeapYear(e){let{year:r}=e;return(7*r+1)%19<7}monthsInYear(e){return this.inLeapYear(e)?13:12}minimumMonthLength(e){return this.minMaxMonthLength(e,"min")}maximumMonthLength(e){return this.minMaxMonthLength(e,"max")}minMaxMonthLength(e,r){let{month:n,year:i}=e,o=this.getMonthCode(i,n),s=dN(this.months).find(d=>d[1].monthCode===o);if(s===void 0)throw new RangeError(`unmatched Hebrew month: ${n}`);let a=s[1].days;return typeof a=="number"?a:a[r]}estimateIsoDate(e){let{year:r}=e;return{year:r-3760,month:1,day:1}}getMonthCode(e,r){return this.inLeapYear({year:e})?r===6?ep(5,!0):ep(r<6?r:r-1):ep(r)}adjustCalendarDate(e,r,n="constrain",i=!1){let{year:o,eraYear:s,month:a,monthCode:d,day:u,monthExtra:c}=e;if(o===void 0&&s!==void 0&&(o=s),s===void 0&&o!==void 0&&(s=o),i){if(c){let l=this.months[c];if(!l)throw new RangeError(`Unrecognized month from formatToParts: ${c}`);a=this.inLeapYear({year:o})?l.leap:l.regular}return d=this.getMonthCode(o,a),{year:o,month:a,day:u,era:void 0,eraYear:s,monthCode:d}}if(this.validateCalendarDate(e),a===void 0)if(d.endsWith("L")){if(d!=="M05L")throw new RangeError(`Hebrew leap month must have monthCode M05L, not ${d}`);if(a=6,!this.inLeapYear({year:o})){if(n==="reject")throw new RangeError(`Hebrew monthCode M05L is invalid in year ${o} which is not a leap year`);a=6,d="M06"}}else{a=ZN(d),this.inLeapYear({year:o})&&a>=6&&a++;let l=this.monthsInYear({year:o});if(a<1||a>l)throw new RangeError(`Invalid monthCode: ${d}`)}else if(n==="reject"?(ho(a,1,this.monthsInYear({year:o})),ho(u,1,this.maximumMonthLength({year:o,month:a}))):(a=$a(a,1,this.monthsInYear({year:o})),u=$a(u,1,this.maximumMonthLength({year:o,month:a}))),d===void 0)d=this.getMonthCode(o,a);else if(this.getMonthCode(o,a)!==d)throw new RangeError(`monthCode ${d} doesn't correspond to month ${a} in Hebrew year ${o}`);return{...e,day:u,month:a,monthCode:d,year:o,eraYear:s}}},bm=class extends vm{constructor(){super(...arguments),this.calendarType="lunar",this.DAYS_PER_ISLAMIC_YEAR=354+11/30,this.DAYS_PER_ISO_YEAR=365.2425,this.constantEra="ah"}inLeapYear(e,r){return this.daysInMonth({year:e.year,month:12,day:1},r)===30}monthsInYear(){return 12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}estimateIsoDate(e){let{year:r}=this.adjustCalendarDate(e);return{year:iqe(r*this.DAYS_PER_ISLAMIC_YEAR/this.DAYS_PER_ISO_YEAR)+622,month:1,day:1}}},Ck=class extends bm{constructor(){super(...arguments),this.id="islamic"}},lN=class extends bm{constructor(){super(...arguments),this.id="islamic-umalqura"}},fN=class extends bm{constructor(){super(...arguments),this.id="islamic-tbla"}},hN=class extends bm{constructor(){super(...arguments),this.id="islamic-civil"}},pN=class extends bm{constructor(){super(...arguments),this.id="islamic-rgsa"}},yN=class extends bm{constructor(){super(...arguments),this.id="islamicc"}},mN=class extends vm{constructor(){super(...arguments),this.id="persian",this.calendarType="solar",this.constantEra="ap"}inLeapYear(e,r){return Ck.prototype.inLeapYear.call(this,e,r)}monthsInYear(){return 12}minimumMonthLength(e){let{month:r}=e;return r===12?29:r<=6?31:30}maximumMonthLength(e){let{month:r}=e;return r===12?30:r<=6?31:30}estimateIsoDate(e){let{year:r}=this.adjustCalendarDate(e);return{year:r+621,month:1,day:1}}},gN=class extends vm{constructor(){super(...arguments),this.id="indian",this.calendarType="solar",this.constantEra="saka",this.months={1:{length:30,month:3,day:22,leap:{length:31,month:3,day:21}},2:{length:31,month:4,day:21},3:{length:31,month:5,day:22},4:{length:31,month:6,day:22},5:{length:31,month:7,day:23},6:{length:31,month:8,day:23},7:{length:30,month:9,day:23},8:{length:30,month:10,day:23},9:{length:30,month:11,day:22},10:{length:30,month:12,day:22},11:{length:30,month:1,nextYear:!0,day:21},12:{length:30,month:2,nextYear:!0,day:20}},this.vulnerableToBceBug=new Date("0000-01-01T00:00Z").toLocaleDateString("en-US-u-ca-indian",{timeZone:"UTC"})!=="10/11/-79 Saka"}inLeapYear(e){return Ble(e.year+78)}monthsInYear(){return 12}minimumMonthLength(e){return this.getMonthInfo(e).length}maximumMonthLength(e){return this.getMonthInfo(e).length}getMonthInfo(e){let{month:r}=e,n=this.months[r];if(n===void 0)throw new RangeError(`Invalid month: ${r}`);return this.inLeapYear(e)&&n.leap&&(n=n.leap),n}estimateIsoDate(e){let r=this.adjustCalendarDate(e),n=this.getMonthInfo(r);return bv(r.year+78+(n.nextYear?1:0),n.month,n.day,0,0,0,r.day-1,"constrain")}checkIcuBugs(e){if(this.vulnerableToBceBug&&e.year<1)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 0001-01-01 (see https://bugs.chromium.org/p/v8/issues/detail?id=10529)`)}};function Ble(t){return t%4==0&&(t%100!=0||t%400==0)}var kv=class extends vm{constructor(e,r){super(),this.calendarType="solar",this.v8IsVulnerableToJulianBug=new Date("+001001-01-01T00:00Z").toLocaleDateString("en-US-u-ca-japanese",{timeZone:"UTC"}).startsWith("12"),this.calendarIsVulnerableToJulianBug=!1,this.id=e;let{eras:n,anchorEra:i}=function(s){let a,d=s;if(d.length===0)throw new RangeError("Invalid era data: eras are required");if(d.length===1&&d[0].reverseOf)throw new RangeError("Invalid era data: anchor era cannot count years backwards");if(d.length===1&&!d[0].name)throw new RangeError("Invalid era data: at least one named era is required");if(d.filter(c=>c.reverseOf!=null).length>1)throw new RangeError("Invalid era data: only one era can count years backwards");d.forEach(c=>{if(c.isAnchor||!c.anchorEpoch&&!c.reverseOf){if(a)throw new RangeError("Invalid era data: cannot have multiple anchor eras");a=c,c.anchorEpoch={year:c.hasYearZero?0:1}}else if(!c.name)throw new RangeError("If era name is blank, it must be the anchor era")}),d=d.filter(c=>c.name),d.forEach(c=>{let{reverseOf:l}=c;if(l){let h=d.find(y=>y.name===l);if(h===void 0)throw new RangeError(`Invalid era data: unmatched reverseOf era: ${l}`);c.reverseOf=h,c.anchorEpoch=h.anchorEpoch,c.isoEpoch=h.isoEpoch}c.anchorEpoch.month===void 0&&(c.anchorEpoch.month=1),c.anchorEpoch.day===void 0&&(c.anchorEpoch.day=1)}),rqe.call(d,(c,l)=>{if(c.reverseOf)return 1;if(l.reverseOf)return-1;if(!c.isoEpoch||!l.isoEpoch)throw new RangeError("Invalid era data: missing ISO epoch");return l.isoEpoch.year-c.isoEpoch.year});let u=d[d.length-1].reverseOf;if(u&&u!==d[d.length-2])throw new RangeError("Invalid era data: invalid reverse-sign era");return d.forEach((c,l)=>{c.genericName="era"+(d.length-1-l)}),{eras:d,anchorEra:a||d[0]}}(r);this.anchorEra=i,this.eras=n}inLeapYear(e){let{year:r}=this.estimateIsoDate({month:1,day:1,year:e.year});return Ble(r)}monthsInYear(){return 12}minimumMonthLength(e){let{month:r}=e;return r===2?this.inLeapYear(e)?29:28:[4,6,9,11].indexOf(r)>=0?30:31}maximumMonthLength(e){return this.minimumMonthLength(e)}completeEraYear(e){let r=(a,d)=>{let u=e[a];if(u!=null&&u!=d)throw new RangeError(`Input ${a} ${u} doesn't match calculated value ${d}`)},n=a=>{let d,u={...e,year:a},c=this.eras.find((l,h)=>{if(h===this.eras.length-1){if(l.reverseOf){if(a>0)throw new RangeError(`Signed year ${a} is invalid for era ${l.name}`);return d=l.anchorEpoch.year-a,!0}return d=a-l.anchorEpoch.year+(l.hasYearZero?0:1),!0}return this.compareCalendarDates(u,l.anchorEpoch)>=0&&(d=a-l.anchorEpoch.year+(l.hasYearZero?0:1),!0)});if(!c)throw new RangeError(`Year ${a} was not matched by any era`);return{eraYear:d,era:c.name}},{year:i,eraYear:o,era:s}=e;if(i!=null)({eraYear:o,era:s}=n(i)),r("era",s),r("eraYear",o);else{if(o==null)throw new RangeError("Either `year` or `eraYear` and `era` are required");{let a=s===void 0?void 0:this.eras.find(d=>d.name===s||d.genericName===s);if(!a)throw new RangeError(`Era ${s} (ISO year ${o}) was not matched by any era`);if(o<1&&a.reverseOf)throw new RangeError(`Years in ${s} era must be positive, not ${i}`);i=a.reverseOf?a.anchorEpoch.year-o:o+a.anchorEpoch.year-(a.hasYearZero?0:1),r("year",i),{eraYear:o,era:s}=n(i)}}return{...e,year:i,eraYear:o,era:s}}adjustCalendarDate(e,r,n="constrain"){let i=e,{month:o,monthCode:s}=i;return o===void 0&&(i={...i,month:ZN(s)}),this.validateCalendarDate(i),i=this.completeEraYear(i),super.adjustCalendarDate(i,r,n)}estimateIsoDate(e){let r=this.adjustCalendarDate(e),{year:n,month:i,day:o}=r,{anchorEra:s}=this;return Ak(n+s.isoEpoch.year-(s.hasYearZero?0:1),i,o,"constrain")}checkIcuBugs(e){if(this.calendarIsVulnerableToJulianBug&&this.v8IsVulnerableToJulianBug&&fm(e.year,e.month,e.day,1582,10,15)<0)throw new RangeError(`calendar '${this.id}' is broken for ISO dates before 1582-10-15 (see https://bugs.chromium.org/p/chromium/issues/detail?id=1173158)`)}},z6=class extends kv{constructor(e,r){super(e,r)}inLeapYear(e){let{year:r}=e;return(r+1)%4==0}monthsInYear(){return 13}minimumMonthLength(e){let{month:r}=e;return r===13?this.inLeapYear(e)?6:5:30}maximumMonthLength(e){return this.minimumMonthLength(e)}},vN=class extends z6{constructor(){super("ethioaa",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}}])}},bN=class extends z6{constructor(){super("coptic",[{name:"era1",isoEpoch:{year:284,month:8,day:29}},{name:"era0",reverseOf:"era1"}])}},wN=class extends z6{constructor(){super("ethiopic",[{name:"era0",isoEpoch:{year:-5492,month:7,day:17}},{name:"era1",isoEpoch:{year:8,month:8,day:27},anchorEpoch:{year:5501}}])}},_N=class extends kv{constructor(){super("roc",[{name:"minguo",isoEpoch:{year:1912,month:1,day:1}},{name:"before-roc",reverseOf:"minguo"}]),this.calendarIsVulnerableToJulianBug=!0}},xN=class extends kv{constructor(){super("buddhist",[{name:"be",hasYearZero:!0,isoEpoch:{year:-543,month:1,day:1}}]),this.calendarIsVulnerableToJulianBug=!0}},EN=class extends kv{constructor(){super("gregory",[{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}])}reviseIntlEra(e){let{era:r,eraYear:n}=e;return r!=="bc"&&r!=="b"||(r="bce"),r!=="ad"&&r!=="a"||(r="ce"),{era:r,eraYear:n}}},SN=class extends kv{constructor(){super("japanese",[{name:"reiwa",isoEpoch:{year:2019,month:5,day:1},anchorEpoch:{year:2019,month:5,day:1}},{name:"heisei",isoEpoch:{year:1989,month:1,day:8},anchorEpoch:{year:1989,month:1,day:8}},{name:"showa",isoEpoch:{year:1926,month:12,day:25},anchorEpoch:{year:1926,month:12,day:25}},{name:"taisho",isoEpoch:{year:1912,month:7,day:30},anchorEpoch:{year:1912,month:7,day:30}},{name:"meiji",isoEpoch:{year:1868,month:9,day:8},anchorEpoch:{year:1868,month:9,day:8}},{name:"ce",isoEpoch:{year:1,month:1,day:1}},{name:"bce",reverseOf:"ce"}]),this.calendarIsVulnerableToJulianBug=!0,this.eraLength="long",this.erasBeginMidYear=!0}reviseIntlEra(e,r){let{era:n,eraYear:i}=e,{year:o}=r;return this.eras.find(s=>s.name===n)?{era:n,eraYear:i}:o<1?{era:"bce",eraYear:1-o}:{era:"ce",eraYear:o}}},jk=class extends vm{constructor(){super(...arguments),this.calendarType="lunisolar",this.hasEra=!1}inLeapYear(e,r){let n=this.getMonthList(e.year,r);return dN(n).length===13}monthsInYear(e,r){return this.inLeapYear(e,r)?13:12}minimumMonthLength(){return 29}maximumMonthLength(){return 30}getMonthList(e,r){if(e===void 0)throw new TypeError("Missing year");let n=JSON.stringify({func:"getMonthList",calendarYear:e,id:this.id}),i=r.get(n);if(i)return i;let o=this.getFormatter(),s=(x,S)=>{let A=Rle({isoYear:x,isoMonth:2,isoDay:1}),T=new Date(A);T.setUTCDate(S+1);let $=o.formatToParts(T),j=$.find(L=>L.type==="month").value,K=+$.find(L=>L.type==="day").value,F=$.find(L=>L.type==="relatedYear");if(F===void 0)throw new RangeError(`Intl.DateTimeFormat.formatToParts lacks relatedYear in ${this.id} calendar. Try Node 14+ or modern browsers.`);return F=+F.value,{calendarMonthString:j,calendarDay:K,calendarYearToVerify:F}},a=17,{calendarMonthString:d,calendarDay:u,calendarYearToVerify:c}=s(e,a);d!=="1"&&(a+=29,{calendarMonthString:d,calendarDay:u}=s(e,a)),a-=u-5;let l={},h,y,g=1,v=!1;do({calendarMonthString:d,calendarDay:u,calendarYearToVerify:c}=s(e,a)),h&&(l[y].daysInMonth=h+30-u),c!==e?v=!0:(l[d]={monthIndex:g++},a+=30),h=u,y=d;while(!v);return l[y].daysInMonth=h+30-u,r.set(n,l),l}estimateIsoDate(e){let{year:r,month:n}=e;return{year:r,month:n>=12?12:n+1,day:1}}adjustCalendarDate(e,r,n="constrain",i=!1){let{year:o,month:s,monthExtra:a,day:d,monthCode:u,eraYear:c}=e;if(i){if(o=c,a&&a!=="bis")throw new RangeError(`Unexpected leap month suffix: ${a}`);let l=ep(s,a!==void 0),h=`${s}${a||""}`,y=this.getMonthList(o,r)[h];if(y===void 0)throw new RangeError(`Unmatched month ${h} in Chinese year ${o}`);return s=y.monthIndex,{year:o,month:s,day:d,era:void 0,eraYear:c,monthCode:l}}if(this.validateCalendarDate(e),o===void 0&&(o=c),c===void 0&&(c=o),s===void 0){let l=this.getMonthList(o,r),h=u.replace("L","bis").slice(1);h[0]==="0"&&(h=h.slice(1));let y=l[h];if(s=y&&y.monthIndex,s===void 0&&u.endsWith("L")&&u!="M13L"&&n==="constrain"){let g=u.slice(1,-1);g[0]==="0"&&(g=g.slice(1)),y=l[g],y&&(s=y.monthIndex,u=ep(g))}if(s===void 0)throw new RangeError(`Unmatched month ${u} in Chinese year ${o}`)}else if(u===void 0){let l=this.getMonthList(o,r),h=dN(l),y=h.length;n==="reject"?(ho(s,1,y),ho(d,1,this.maximumMonthLength())):(s=$a(s,1,y),d=$a(d,1,this.maximumMonthLength()));let g=h.find(([,v])=>v.monthIndex===s);if(g===void 0)throw new RangeError(`Invalid month ${s} in Chinese year ${o}`);u=ep(g[0].replace("bis",""),g[0].indexOf("bis")!==-1)}else{let l=this.getMonthList(o,r),h=u.replace("L","bis").slice(1);h[0]==="0"&&(h=h.slice(1));let y=l[h];if(!y)throw new RangeError(`Unmatched monthCode ${u} in Chinese year ${o}`);if(s!==y.monthIndex)throw new RangeError(`monthCode ${u} doesn't correspond to month ${s} in Chinese year ${o}`)}return{...e,year:o,eraYear:c,month:s,monthCode:u,day:d}}},TN=class extends jk{constructor(){super(...arguments),this.id="chinese"}},AN=class extends jk{constructor(){super(...arguments),this.id="dangi"}},kN=class{constructor(e){this.helper=e}dateFromFields(e,r,n){let i=new Ai,o=$t(e,this.fields(["day","month","monthCode","year"]),[]),s=ni(r),{year:a,month:d,day:u}=this.helper.calendarToIsoDate(o,s,i),c=td(a,d,u,n);return i.setObject(c),c}yearMonthFromFields(e,r,n){let i=new Ai,o=$t(e,this.fields(["month","monthCode","year"]),[]),s=ni(r),{year:a,month:d,day:u}=this.helper.calendarToIsoDate({...o,day:1},s,i),c=q6(a,d,n,u);return i.setObject(c),c}monthDayFromFields(e,r,n){let i=new Ai,o=$t(e,this.fields(["day","month","monthCode","year"]),[]),s=ni(r),{year:a,month:d,day:u}=this.helper.monthDayFromFields(o,s,i),c=K6(d,u,n,a);return i.setObject(c),c}fields(e){let r=e;return kle.call(r,"year")&&(r=[...r,"era","eraYear"]),r}fieldKeysToIgnore(e){let r=new Ple;for(let n=0;n<e.length;n++){let i=e[n];switch(Ge(Ko,r,[i]),i){case"era":Ge(Ko,r,["eraYear"]),Ge(Ko,r,["year"]);break;case"eraYear":Ge(Ko,r,["era"]),Ge(Ko,r,["year"]);break;case"year":Ge(Ko,r,["era"]),Ge(Ko,r,["eraYear"]);break;case"month":Ge(Ko,r,["monthCode"]),this.helper.erasBeginMidYear&&(Ge(Ko,r,["era"]),Ge(Ko,r,["eraYear"]));break;case"monthCode":Ge(Ko,r,["month"]),this.helper.erasBeginMidYear&&(Ge(Ko,r,["era"]),Ge(Ko,r,["eraYear"]));break;case"day":this.helper.erasBeginMidYear&&(Ge(Ko,r,["era"]),Ge(Ko,r,["eraYear"]))}}return[...Ge(Ile,r,[])]}dateAdd(e,r,n,i,o,s,a){let d=Ai.getCacheForObject(e),u=this.helper.temporalToCalendarDate(e,d),c=this.helper.addCalendar(u,{years:r,months:n,weeks:i,days:o},s,d),l=this.helper.calendarToIsoDate(c,"constrain",d),{year:h,month:y,day:g}=l,v=td(h,y,g,a);return new Ai(d).setObject(v),v}dateUntil(e,r,n){let i=Ai.getCacheForObject(e),o=Ai.getCacheForObject(r),s=this.helper.temporalToCalendarDate(e,i),a=this.helper.temporalToCalendarDate(r,o);return this.helper.untilCalendar(s,a,n,i)}year(e){let r=Ai.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,r).year}month(e){let r=Ai.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,r).month}day(e){let r=Ai.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,r).day}era(e){if(!this.helper.hasEra)return;let r=Ai.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,r).era}eraYear(e){if(!this.helper.hasEra)return;let r=Ai.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,r).eraYear}monthCode(e){let r=Ai.getCacheForObject(e);return this.helper.temporalToCalendarDate(e,r).monthCode}dayOfWeek(e){return En.iso8601.dayOfWeek(e)}dayOfYear(e){let r=Ai.getCacheForObject(e),n=this.helper.isoToCalendarDate(e,r),i=this.helper.startOfCalendarYear(n);return this.helper.calendarDaysUntil(i,n,r)+1}weekOfYear(e){return En.iso8601.weekOfYear(e)}yearOfWeek(e){return En.iso8601.yearOfWeek(e)}daysInWeek(e){return En.iso8601.daysInWeek(e)}daysInMonth(e){let r=Ai.getCacheForObject(e),n=this.helper.temporalToCalendarDate(e,r),i=this.helper.maximumMonthLength(n);if(i===this.helper.minimumMonthLength(n))return i;let o=this.helper.startOfCalendarMonth(n),s=this.helper.addMonthsCalendar(o,1,"constrain",r);return this.helper.calendarDaysUntil(o,s,r)}daysInYear(e){let r=e;$i(r,Ie)||(r=Wr(r));let n=Ai.getCacheForObject(r),i=this.helper.temporalToCalendarDate(r,n),o=this.helper.startOfCalendarYear(i),s=this.helper.addCalendar(o,{years:1},"constrain",n);return this.helper.calendarDaysUntil(o,s,n)}monthsInYear(e){let r=Ai.getCacheForObject(e),n=this.helper.temporalToCalendarDate(e,r);return this.helper.monthsInYear(n,r)}inLeapYear(e){let r=e;$i(r,Ie)||(r=Wr(r));let n=Ai.getCacheForObject(r),i=this.helper.temporalToCalendarDate(r,n);return this.helper.inLeapYear(i,n)}};for(let t of[uN,mN,wN,vN,bN,TN,AN,_N,gN,xN,EN,SN,Ck,lN,fN,hN,pN,yN]){let e=new t;En[e.id]=new kN(e)}var V6=class t{constructor(e,r,n,i="iso8601"){Vue(this,xr(e),xr(r),xr(n),Ka(i))}get calendarId(){if(!Zt(this))throw new TypeError("invalid receiver");return po(O(this,fe))}get era(){if(!Zt(this))throw new TypeError("invalid receiver");return Lk(O(this,fe),this)}get eraYear(){if(!Zt(this))throw new TypeError("invalid receiver");return Fk(O(this,fe),this)}get year(){if(!Zt(this))throw new TypeError("invalid receiver");return Kk(O(this,fe),this)}get month(){if(!Zt(this))throw new TypeError("invalid receiver");return qk(O(this,fe),this)}get monthCode(){if(!Zt(this))throw new TypeError("invalid receiver");return oS(O(this,fe),this)}get day(){if(!Zt(this))throw new TypeError("invalid receiver");return sS(O(this,fe),this)}get dayOfWeek(){if(!Zt(this))throw new TypeError("invalid receiver");return MN(O(this,fe),this)}get dayOfYear(){if(!Zt(this))throw new TypeError("invalid receiver");return DN(O(this,fe),this)}get weekOfYear(){if(!Zt(this))throw new TypeError("invalid receiver");return CN(O(this,fe),this)}get yearOfWeek(){if(!Zt(this))throw new TypeError("invalid receiver");return jN(O(this,fe),this)}get daysInWeek(){if(!Zt(this))throw new TypeError("invalid receiver");return $N(O(this,fe),this)}get daysInMonth(){if(!Zt(this))throw new TypeError("invalid receiver");return zk(O(this,fe),this)}get daysInYear(){if(!Zt(this))throw new TypeError("invalid receiver");return Vk(O(this,fe),this)}get monthsInYear(){if(!Zt(this))throw new TypeError("invalid receiver");return Hk(O(this,fe),this)}get inLeapYear(){if(!Zt(this))throw new TypeError("invalid receiver");return Wk(O(this,fe),this)}with(e,r){if(!Zt(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid argument");b2(e);let n=nr(r),i=O(this,fe),o=li(i,["day","month","monthCode","year"]),s=$t(this,o,[]);return s=Sv(i,s,$t(e,o,"partial")),s=$t(s,o,[]),tp(i,s,n)}withCalendar(e){if(!Zt(this))throw new TypeError("invalid receiver");let r=Ka(e);return new t(O(this,Ie),O(this,Me),O(this,je),r)}add(e,r){if(!Zt(this))throw new TypeError("invalid receiver");let n=i2(e),i=nr(r);return fo(O(this,fe),this,n,i)}subtract(e,r){if(!Zt(this))throw new TypeError("invalid receiver");let n=sle(i2(e)),i=nr(r);return fo(O(this,fe),this,n,i)}until(e,r){if(!Zt(this))throw new TypeError("invalid receiver");return pue("until",this,e,r)}since(e,r){if(!Zt(this))throw new TypeError("invalid receiver");return pue("since",this,e,r)}equals(e){if(!Zt(this))throw new TypeError("invalid receiver");let r=Wr(e);for(let n of[Ie,Me,je])if(O(this,n)!==O(r,n))return!1;return cS(O(this,fe),O(r,fe))}toString(e){if(!Zt(this))throw new TypeError("invalid receiver");return oue(this,tS(nr(e)))}toJSON(){if(!Zt(this))throw new TypeError("invalid receiver");return oue(this)}toLocaleString(e,r){if(!Zt(this))throw new TypeError("invalid receiver");return new op(e,r).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDate")}toPlainDateTime(e){if(!Zt(this))throw new TypeError("invalid receiver");let r=O(this,Ie),n=O(this,Me),i=O(this,je),o=O(this,fe);if(e===void 0)return ja(r,n,i,0,0,0,0,0,0,o);let s=Zh(e);return ja(r,n,i,O(s,Tt),O(s,At),O(s,kt),O(s,Pt),O(s,It),O(s,Rt),o)}toZonedDateTime(e){if(!Zt(this))throw new TypeError("invalid receiver");let r,n;if(pn(e))if(Zc(e))r=e;else{let g=e.timeZone;g===void 0?r=Fo(e):(r=Fo(g),n=e.plainTime)}else r=Fo(e);let i=O(this,Ie),o=O(this,Me),s=O(this,je),a=O(this,fe),d=0,u=0,c=0,l=0,h=0,y=0;return n!==void 0&&(n=Zh(n),d=O(n,Tt),u=O(n,At),c=O(n,kt),l=O(n,Pt),h=O(n,It),y=O(n,Rt)),lo(O(Ss(r,ja(i,o,s,d,u,c,l,h,y,a),"compatible"),ft),r,a)}toPlainYearMonth(){if(!Zt(this))throw new TypeError("invalid receiver");let e=O(this,fe);return Tv(e,$t(this,li(e,["monthCode","year"]),[]))}toPlainMonthDay(){if(!Zt(this))throw new TypeError("invalid receiver");let e=O(this,fe);return h2(e,$t(this,li(e,["day","monthCode"]),[]))}getISOFields(){if(!Zt(this))throw new TypeError("invalid receiver");return{calendar:O(this,fe),isoDay:O(this,je),isoMonth:O(this,Me),isoYear:O(this,Ie)}}getCalendar(){if(!Zt(this))throw new TypeError("invalid receiver");return x2(O(this,fe))}static from(e,r){let n=nr(r);return Zt(e)?(ni(n),td(O(e,Ie),O(e,Me),O(e,je),O(e,fe))):Wr(e,n)}static compare(e,r){let n=Wr(e),i=Wr(r);return fm(O(n,Ie),O(n,Me),O(n,je),O(i,Ie),O(i,Me),O(i,je))}};Ef(V6,"Temporal.PlainDate");var H6=class t{constructor(e,r,n,i=0,o=0,s=0,a=0,d=0,u=0,c="iso8601"){Hue(this,xr(e),xr(r),xr(n),i===void 0?0:xr(i),o===void 0?0:xr(o),s===void 0?0:xr(s),a===void 0?0:xr(a),d===void 0?0:xr(d),u===void 0?0:xr(u),Ka(c))}get calendarId(){if(!Et(this))throw new TypeError("invalid receiver");return po(O(this,fe))}get year(){if(!Et(this))throw new TypeError("invalid receiver");return Kk(O(this,fe),this)}get month(){if(!Et(this))throw new TypeError("invalid receiver");return qk(O(this,fe),this)}get monthCode(){if(!Et(this))throw new TypeError("invalid receiver");return oS(O(this,fe),this)}get day(){if(!Et(this))throw new TypeError("invalid receiver");return sS(O(this,fe),this)}get hour(){if(!Et(this))throw new TypeError("invalid receiver");return O(this,Tt)}get minute(){if(!Et(this))throw new TypeError("invalid receiver");return O(this,At)}get second(){if(!Et(this))throw new TypeError("invalid receiver");return O(this,kt)}get millisecond(){if(!Et(this))throw new TypeError("invalid receiver");return O(this,Pt)}get microsecond(){if(!Et(this))throw new TypeError("invalid receiver");return O(this,It)}get nanosecond(){if(!Et(this))throw new TypeError("invalid receiver");return O(this,Rt)}get era(){if(!Et(this))throw new TypeError("invalid receiver");return Lk(O(this,fe),this)}get eraYear(){if(!Et(this))throw new TypeError("invalid receiver");return Fk(O(this,fe),this)}get dayOfWeek(){if(!Et(this))throw new TypeError("invalid receiver");return MN(O(this,fe),this)}get dayOfYear(){if(!Et(this))throw new TypeError("invalid receiver");return DN(O(this,fe),this)}get weekOfYear(){if(!Et(this))throw new TypeError("invalid receiver");return CN(O(this,fe),this)}get yearOfWeek(){if(!Et(this))throw new TypeError("invalid receiver");return jN(O(this,fe),this)}get daysInWeek(){if(!Et(this))throw new TypeError("invalid receiver");return $N(O(this,fe),this)}get daysInYear(){if(!Et(this))throw new TypeError("invalid receiver");return Vk(O(this,fe),this)}get daysInMonth(){if(!Et(this))throw new TypeError("invalid receiver");return zk(O(this,fe),this)}get monthsInYear(){if(!Et(this))throw new TypeError("invalid receiver");return Hk(O(this,fe),this)}get inLeapYear(){if(!Et(this))throw new TypeError("invalid receiver");return Wk(O(this,fe),this)}with(e,r){if(!Et(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid argument");b2(e);let n=nr(r),i=O(this,fe),o=li(i,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]),s=$t(this,o,[]);s=Sv(i,s,$t(e,o,"partial")),s=$t(s,o,[]);let{year:a,month:d,day:u,hour:c,minute:l,second:h,millisecond:y,microsecond:g,nanosecond:v}=iS(i,s,n);return ja(a,d,u,c,l,h,y,g,v,i)}withPlainTime(e){if(!Et(this))throw new TypeError("invalid receiver");let r=O(this,Ie),n=O(this,Me),i=O(this,je),o=O(this,fe);if(e===void 0)return ja(r,n,i,0,0,0,0,0,0,o);let s=Zh(e);return ja(r,n,i,O(s,Tt),O(s,At),O(s,kt),O(s,Pt),O(s,It),O(s,Rt),o)}withPlainDate(e){if(!Et(this))throw new TypeError("invalid receiver");let r=Wr(e),n=O(r,Ie),i=O(r,Me),o=O(r,je),s=O(r,fe),a=O(this,Tt),d=O(this,At),u=O(this,kt),c=O(this,Pt),l=O(this,It),h=O(this,Rt);return s=Yue(O(this,fe),s),ja(n,i,o,a,d,u,c,l,h,s)}withCalendar(e){if(!Et(this))throw new TypeError("invalid receiver");let r=Ka(e);return new t(O(this,Ie),O(this,Me),O(this,je),O(this,Tt),O(this,At),O(this,kt),O(this,Pt),O(this,It),O(this,Rt),r)}add(e,r){if(!Et(this))throw new TypeError("invalid receiver");return _ue("add",this,e,r)}subtract(e,r){if(!Et(this))throw new TypeError("invalid receiver");return _ue("subtract",this,e,r)}until(e,r){if(!Et(this))throw new TypeError("invalid receiver");return yue("until",this,e,r)}since(e,r){if(!Et(this))throw new TypeError("invalid receiver");return yue("since",this,e,r)}round(e){if(!Et(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");let r=typeof e=="string"?m2("smallestUnit",e):nr(e),n=w2(r),i=rl(r,"halfExpand"),o=Ua(r,"smallestUnit","time",xv,["day"]),s={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[o];_2(n,s,s===1);let a=O(this,Ie),d=O(this,Me),u=O(this,je),c=O(this,Tt),l=O(this,At),h=O(this,kt),y=O(this,Pt),g=O(this,It),v=O(this,Rt);return{year:a,month:d,day:u,hour:c,minute:l,second:h,millisecond:y,microsecond:g,nanosecond:v}=HN(a,d,u,c,l,h,y,g,v,n,o,i),ja(a,d,u,c,l,h,y,g,v,O(this,fe))}equals(e){if(!Et(this))throw new TypeError("invalid receiver");let r=vv(e);for(let n of[Ie,Me,je,Tt,At,kt,Pt,It,Rt])if(O(this,n)!==O(r,n))return!1;return cS(O(this,fe),O(r,fe))}toString(e){if(!Et(this))throw new TypeError("invalid receiver");let r=nr(e),n=tS(r),i=rS(r),o=rl(r,"trunc"),s=Ua(r,"smallestUnit","time",void 0);if(s==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let{precision:a,unit:d,increment:u}=nS(s,i);return sue(this,a,n,{unit:d,increment:u,roundingMode:o})}toJSON(){if(!Et(this))throw new TypeError("invalid receiver");return sue(this,"auto")}toLocaleString(e,r){if(!Et(this))throw new TypeError("invalid receiver");return new op(e,r).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainDateTime")}toZonedDateTime(e,r){if(!Et(this))throw new TypeError("invalid receiver");let n=Fo(e);return lo(O(Ss(n,this,f2(nr(r))),ft),n,O(this,fe))}toPlainDate(){if(!Et(this))throw new TypeError("invalid receiver");return p2(this)}toPlainYearMonth(){if(!Et(this))throw new TypeError("invalid receiver");let e=O(this,fe);return Tv(e,$t(this,li(e,["monthCode","year"]),[]))}toPlainMonthDay(){if(!Et(this))throw new TypeError("invalid receiver");let e=O(this,fe);return h2(e,$t(this,li(e,["day","monthCode"]),[]))}toPlainTime(){if(!Et(this))throw new TypeError("invalid receiver");return NN(this)}getISOFields(){if(!Et(this))throw new TypeError("invalid receiver");return{calendar:O(this,fe),isoDay:O(this,je),isoHour:O(this,Tt),isoMicrosecond:O(this,It),isoMillisecond:O(this,Pt),isoMinute:O(this,At),isoMonth:O(this,Me),isoNanosecond:O(this,Rt),isoSecond:O(this,kt),isoYear:O(this,Ie)}}getCalendar(){if(!Et(this))throw new TypeError("invalid receiver");return x2(O(this,fe))}static from(e,r){let n=nr(r);return Et(e)?(ni(n),ja(O(e,Ie),O(e,Me),O(e,je),O(e,Tt),O(e,At),O(e,kt),O(e,Pt),O(e,It),O(e,Rt),O(e,fe))):vv(e,n)}static compare(e,r){let n=vv(e),i=vv(r);for(let o of[Ie,Me,je,Tt,At,kt,Pt,It,Rt]){let s=O(n,o),a=O(i,o);if(s!==a)return wv(s-a)}return 0}};Ef(H6,"Temporal.PlainDateTime");var W6=class t{constructor(e=0,r=0,n=0,i=0,o=0,s=0,a=0,d=0,u=0,c=0){let l=e===void 0?0:ji(e),h=r===void 0?0:ji(r),y=n===void 0?0:ji(n),g=i===void 0?0:ji(i),v=o===void 0?0:ji(o),x=s===void 0?0:ji(s),S=a===void 0?0:ji(a),A=d===void 0?0:ji(d),T=u===void 0?0:ji(u),$=c===void 0?0:ji(c);Ok(l,h,y,g,v,x,S,A,T,$),Sf(this),Dt(this,ys,l),Dt(this,Xi,h),Dt(this,la,y),Dt(this,ms,g),Dt(this,gs,v),Dt(this,vs,x),Dt(this,bs,S),Dt(this,ws,A),Dt(this,_s,T),Dt(this,xs,$)}get years(){if(!Kn(this))throw new TypeError("invalid receiver");return O(this,ys)}get months(){if(!Kn(this))throw new TypeError("invalid receiver");return O(this,Xi)}get weeks(){if(!Kn(this))throw new TypeError("invalid receiver");return O(this,la)}get days(){if(!Kn(this))throw new TypeError("invalid receiver");return O(this,ms)}get hours(){if(!Kn(this))throw new TypeError("invalid receiver");return O(this,gs)}get minutes(){if(!Kn(this))throw new TypeError("invalid receiver");return O(this,vs)}get seconds(){if(!Kn(this))throw new TypeError("invalid receiver");return O(this,bs)}get milliseconds(){if(!Kn(this))throw new TypeError("invalid receiver");return O(this,ws)}get microseconds(){if(!Kn(this))throw new TypeError("invalid receiver");return O(this,_s)}get nanoseconds(){if(!Kn(this))throw new TypeError("invalid receiver");return O(this,xs)}get sign(){if(!Kn(this))throw new TypeError("invalid receiver");return bf(O(this,ys),O(this,Xi),O(this,la),O(this,ms),O(this,gs),O(this,vs),O(this,bs),O(this,ws),O(this,_s),O(this,xs))}get blank(){if(!Kn(this))throw new TypeError("invalid receiver");return bf(O(this,ys),O(this,Xi),O(this,la),O(this,ms),O(this,gs),O(this,vs),O(this,bs),O(this,ws),O(this,_s),O(this,xs))===0}with(e){if(!Kn(this))throw new TypeError("invalid receiver");let r=$t(e,["days","hours","microseconds","milliseconds","minutes","months","nanoseconds","seconds","weeks","years"],"partial"),{years:n=O(this,ys),months:i=O(this,Xi),weeks:o=O(this,la),days:s=O(this,ms),hours:a=O(this,gs),minutes:d=O(this,vs),seconds:u=O(this,bs),milliseconds:c=O(this,ws),microseconds:l=O(this,_s),nanoseconds:h=O(this,xs)}=r;return new t(n,i,o,s,a,d,u,c,l,h)}negated(){if(!Kn(this))throw new TypeError("invalid receiver");return sle(this)}abs(){if(!Kn(this))throw new TypeError("invalid receiver");return new t(Math.abs(O(this,ys)),Math.abs(O(this,Xi)),Math.abs(O(this,la)),Math.abs(O(this,ms)),Math.abs(O(this,gs)),Math.abs(O(this,vs)),Math.abs(O(this,bs)),Math.abs(O(this,ws)),Math.abs(O(this,_s)),Math.abs(O(this,xs)))}add(e,r){if(!Kn(this))throw new TypeError("invalid receiver");return bue("add",this,e,r)}subtract(e,r){if(!Kn(this))throw new TypeError("invalid receiver");return bue("subtract",this,e,r)}round(e){if(!Kn(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");let r=O(this,ys),n=O(this,Xi),i=O(this,la),o=O(this,ms),s=O(this,gs),a=O(this,vs),d=O(this,bs),u=O(this,ws),c=O(this,_s),l=O(this,xs),h=rN(r,n,i,o,s,a,d,u,c,l),y=typeof e=="string"?m2("smallestUnit",e):nr(e),g=Ua(y,"largestUnit","datetime",void 0,["auto"]),v=gk(y),x=w2(y),S=rl(y,"halfExpand"),A=Ua(y,"smallestUnit","datetime",void 0),T=!0;A||(T=!1,A="nanosecond"),h=Ev(h,A);let $=!0;if(g||($=!1,g=h),g==="auto"&&(g=h),!T&&!$)throw new RangeError("at least one of smallestUnit or largestUnit is required");if(Ev(g,A)!==g)throw new RangeError(`largestUnit ${g} cannot be smaller than smallestUnit ${A}`);let j={hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[A];return j!==void 0&&_2(x,j,!1),{years:r,months:n,weeks:i,days:o}=mk(r,n,i,o,g,v),{years:r,months:n,weeks:i,days:o,hours:s,minutes:a,seconds:d,milliseconds:u,microseconds:c,nanoseconds:l}=rp(r,n,i,o,s,a,d,u,c,l,x,A,S,v),{years:r,months:n,weeks:i,days:o,hours:s,minutes:a,seconds:d,milliseconds:u,microseconds:c,nanoseconds:l}=yle(r,n,i,o,s,a,d,u,c,l,x,A,S,v),{days:o,hours:s,minutes:a,seconds:d,milliseconds:u,microseconds:c,nanoseconds:l}=Jd(o,s,a,d,u,c,l,g,v),{years:r,months:n,weeks:i,days:o}=function(F,L,V,q,k,P){let B=Ee("%Temporal.Duration%"),p=bf(F,L,V,q,0,0,0,0,0,0);if(p===0)return{years:F,months:L,weeks:V,days:q};let m=z.default.BigInt(p),w,E,_=z.default.BigInt(F),b=z.default.BigInt(L),C=z.default.BigInt(V),N=z.default.BigInt(q);P&&(E=Wr(P),w=O(E,fe));let D=new B(p),U=new B(0,p),G=new B(0,0,p);switch(k){case"year":{if(!w)throw new RangeError("a starting point is required for years balancing");let Y=typeof w!="string"?Dr(w,"dateAdd"):void 0,J,H,X;for({relativeTo:J,days:H}=qo(w,E,D,Y);z.default.greaterThanOrEqual(el(N),z.default.BigInt(hn(H)));)N=z.default.subtract(N,z.default.BigInt(H)),_=z.default.add(_,m),E=J,{relativeTo:J,days:H}=qo(w,E,D,Y);for({relativeTo:J,days:X}=qo(w,E,U,Y);z.default.greaterThanOrEqual(el(N),z.default.BigInt(hn(X)));)N=z.default.subtract(N,z.default.BigInt(X)),b=z.default.add(b,m),E=J,{relativeTo:J,days:X}=qo(w,E,U,Y);J=fo(w,E,D,void 0,Y);let te=typeof w!="string"?Dr(w,"dateUntil"):void 0,ne=zo(null);ne.largestUnit="month";let Q=hm(w,E,J,ne,te),re=O(Q,Xi);for(;z.default.greaterThanOrEqual(el(b),z.default.BigInt(hn(re)));){b=z.default.subtract(b,z.default.BigInt(re)),_=z.default.add(_,m),E=J,J=fo(w,E,D,void 0,Y);let ae=zo(null);ae.largestUnit="month",Q=hm(w,E,J,ae,te),re=O(Q,Xi)}break}case"month":{if(!w)throw new RangeError("a starting point is required for months balancing");let Y=typeof w!="string"?Dr(w,"dateAdd"):void 0,J,H;for({relativeTo:J,days:H}=qo(w,E,U,Y);z.default.greaterThanOrEqual(el(N),z.default.BigInt(hn(H)));)N=z.default.subtract(N,z.default.BigInt(H)),b=z.default.add(b,m),E=J,{relativeTo:J,days:H}=qo(w,E,U,Y);break}case"week":{if(!w)throw new RangeError("a starting point is required for weeks balancing");let Y=typeof w!="string"?Dr(w,"dateAdd"):void 0,J,H;for({relativeTo:J,days:H}=qo(w,E,G,Y);z.default.greaterThanOrEqual(el(N),z.default.BigInt(hn(H)));)N=z.default.subtract(N,z.default.BigInt(H)),C=z.default.add(C,m),E=J,{relativeTo:J,days:H}=qo(w,E,G,Y);break}}return{years:z.default.toNumber(_),months:z.default.toNumber(b),weeks:z.default.toNumber(C),days:z.default.toNumber(N)}}(r,n,i,o,g,v),new t(r,n,i,o,s,a,d,u,c,l)}total(e){if(!Kn(this))throw new TypeError("invalid receiver");let r=O(this,ys),n=O(this,Xi),i=O(this,la),o=O(this,ms),s=O(this,gs),a=O(this,vs),d=O(this,bs),u=O(this,ws),c=O(this,_s),l=O(this,xs);if(e===void 0)throw new TypeError("options argument is required");let h=typeof e=="string"?m2("unit",e):nr(e),y=gk(h),g=Ua(h,"unit","datetime",xv),v;({years:r,months:n,weeks:i,days:o}=mk(r,n,i,o,g,y)),Le(y)&&(v=ple(y,r,n,i,0));let x=ole(o,s,a,d,u,c,l,g,v);if(x==="positive overflow")return 1/0;if(x==="negative overflow")return-1/0;({days:o,hours:s,minutes:a,seconds:d,milliseconds:u,microseconds:c,nanoseconds:l}=x);let{total:S}=rp(r,n,i,o,s,a,d,u,c,l,1,g,"trunc",y);return S}toString(e){if(!Kn(this))throw new TypeError("invalid receiver");let r=nr(e),n=rS(r),i=rl(r,"trunc"),o=Ua(r,"smallestUnit","time",void 0);if(o==="hour"||o==="minute")throw new RangeError('smallestUnit must be a time unit other than "hours" or "minutes"');let{precision:s,unit:a,increment:d}=nS(o,n);return W$(this,s,{unit:a,increment:d,roundingMode:i})}toJSON(){if(!Kn(this))throw new TypeError("invalid receiver");return W$(this)}toLocaleString(e,r){if(!Kn(this))throw new TypeError("invalid receiver");return typeof Intl<"u"&&Intl.DurationFormat!==void 0?new Intl.DurationFormat(e,r).format(this):(console.warn("Temporal.Duration.prototype.toLocaleString() requires Intl.DurationFormat."),W$(this))}valueOf(){throw new TypeError("use compare() to compare Temporal.Duration")}static from(e){return Kn(e)?new t(O(e,ys),O(e,Xi),O(e,la),O(e,ms),O(e,gs),O(e,vs),O(e,bs),O(e,ws),O(e,_s),O(e,xs)):i2(e)}static compare(e,r,n){let i=i2(e),o=i2(r),s=gk(nr(n)),a=O(i,ys),d=O(i,Xi),u=O(i,la),c=O(i,ms),l=O(i,gs),h=O(i,vs),y=O(i,bs),g=O(i,ws),v=O(i,_s),x=O(i,xs),S=O(o,ys),A=O(o,Xi),T=O(o,la),$=O(o,ms),j=O(o,gs),K=O(o,vs),F=O(o,bs),L=O(o,ws),V=O(o,_s),q=O(o,xs),k=fue(s,a,d,u,c),P=fue(s,S,A,T,$);a===0&&S===0&&d===0&&A===0&&u===0&&T===0||({days:c}=mk(a,d,u,c,"day",s),{days:$}=mk(S,A,T,$,"day",s));let B=y2(c,l,h,y,g,v,x,k),p=y2($,j,K,F,L,V,q,P);return wv(z.default.toNumber(z.default.subtract(B,p)))}};Ef(W6,"Temporal.Duration");var oqe=Object.create,G6=class{constructor(e,r,n="iso8601",i=1972){Wue(this,xr(e),xr(r),Ka(n),xr(i))}get monthCode(){if(!Ci(this))throw new TypeError("invalid receiver");return oS(O(this,fe),this)}get day(){if(!Ci(this))throw new TypeError("invalid receiver");return sS(O(this,fe),this)}get calendarId(){if(!Ci(this))throw new TypeError("invalid receiver");return po(O(this,fe))}with(e,r){if(!Ci(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid argument");b2(e);let n=nr(r),i=O(this,fe),o=li(i,["day","month","monthCode","year"]),s=$t(this,o,[]);return s=Sv(i,s,$t(e,o,"partial")),s=$t(s,o,[]),h2(i,s,n)}equals(e){if(!Ci(this))throw new TypeError("invalid receiver");let r=nue(e);for(let n of[Me,je,Ie])if(O(this,n)!==O(r,n))return!1;return cS(O(this,fe),O(r,fe))}toString(e){if(!Ci(this))throw new TypeError("invalid receiver");return aue(this,tS(nr(e)))}toJSON(){if(!Ci(this))throw new TypeError("invalid receiver");return aue(this)}toLocaleString(e,r){if(!Ci(this))throw new TypeError("invalid receiver");return new op(e,r).format(this)}valueOf(){throw new TypeError("use equals() to compare Temporal.PlainMonthDay")}toPlainDate(e){if(!Ci(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("argument should be an object");let r=O(this,fe),n=li(r,["day","monthCode"]),i=$t(this,n,[]),o=li(r,["year"]),s=Sv(r,i,$t(e,o,[]));s=$t(s,[...new Set([...n,...o])],[]);let a=oqe(null);return a.overflow="reject",tp(r,s,a)}getISOFields(){if(!Ci(this))throw new TypeError("invalid receiver");return{calendar:O(this,fe),isoDay:O(this,je),isoMonth:O(this,Me),isoYear:O(this,Ie)}}getCalendar(){if(!Ci(this))throw new TypeError("invalid receiver");return x2(O(this,fe))}static from(e,r){let n=nr(r);return Ci(e)?(ni(n),K6(O(e,Me),O(e,je),O(e,fe),O(e,Ie))):nue(e,n)}};Ef(G6,"Temporal.PlainMonthDay");var XN=()=>new(Ee("%Temporal.Instant%"))(GN()),Aue=(t,e=lm())=>{let r=Fo(e),n=Ka(t);return hc(r,XN(),n)},Z$=(t=lm())=>hc(Fo(t),XN(),"iso8601"),kue=(t,e=lm())=>{let r=Fo(e),n=Ka(t);return lo(GN(),r,n)},Ole={instant:XN,plainDateTime:Aue,plainDateTimeISO:Z$,plainDate:(t,e=lm())=>p2(Aue(t,e)),plainDateISO:(t=lm())=>p2(Z$(t)),plainTimeISO:(t=lm())=>NN(Z$(t)),timeZoneId:()=>lm(),zonedDateTime:kue,zonedDateTimeISO:(t=lm())=>kue("iso8601",t),[Symbol.toStringTag]:"Temporal.Now"};Object.defineProperty(Ole,Symbol.toStringTag,{value:"Temporal.Now",writable:!1,enumerable:!1,configurable:!0});var sqe=Object.assign;function Pue(t,e,r){let n=O(t,Tt),i=O(t,At),o=O(t,kt),s=O(t,Pt),a=O(t,It),d=O(t,Rt);if(r){let{unit:u,increment:c,roundingMode:l}=r;({hour:n,minute:i,second:o,millisecond:s,microsecond:a,nanosecond:d}=WN(n,i,o,s,a,d,c,u,l))}return`${Sn(n)}:${Sn(i)}${Jk(o,s,a,d,e)}`}var J6=class t{constructor(e=0,r=0,n=0,i=0,o=0,s=0){let a=e===void 0?0:xr(e),d=r===void 0?0:xr(r),u=n===void 0?0:xr(n),c=i===void 0?0:xr(i),l=o===void 0?0:xr(o),h=s===void 0?0:xr(s);Xk(a,d,u,c,l,h),Sf(this),Dt(this,Tt,a),Dt(this,At,d),Dt(this,kt,u),Dt(this,Pt,c),Dt(this,It,l),Dt(this,Rt,h)}get hour(){if(!qn(this))throw new TypeError("invalid receiver");return O(this,Tt)}get minute(){if(!qn(this))throw new TypeError("invalid receiver");return O(this,At)}get second(){if(!qn(this))throw new TypeError("invalid receiver");return O(this,kt)}get millisecond(){if(!qn(this))throw new TypeError("invalid receiver");return O(this,Pt)}get microsecond(){if(!qn(this))throw new TypeError("invalid receiver");return O(this,It)}get nanosecond(){if(!qn(this))throw new TypeError("invalid receiver");return O(this,Rt)}with(e,r){if(!qn(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid argument");b2(e);let n=ni(nr(r)),i=Pk(e,"partial"),o=Pk(this),{hour:s,minute:a,second:d,millisecond:u,microsecond:c,nanosecond:l}=sqe(o,i);return{hour:s,minute:a,second:d,millisecond:u,microsecond:c,nanosecond:l}=Uk(s,a,d,u,c,l,n),new t(s,a,d,u,c,l)}add(e){if(!qn(this))throw new TypeError("invalid receiver");return xue("add",this,e)}subtract(e){if(!qn(this))throw new TypeError("invalid receiver");return xue("subtract",this,e)}until(e,r){if(!qn(this))throw new TypeError("invalid receiver");return mue("until",this,e,r)}since(e,r){if(!qn(this))throw new TypeError("invalid receiver");return mue("since",this,e,r)}round(e){if(!qn(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");let r=typeof e=="string"?m2("smallestUnit",e):nr(e),n=w2(r),i=rl(r,"halfExpand"),o=Ua(r,"smallestUnit","time",xv);_2(n,{hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[o],!1);let s=O(this,Tt),a=O(this,At),d=O(this,kt),u=O(this,Pt),c=O(this,It),l=O(this,Rt);return{hour:s,minute:a,second:d,millisecond:u,microsecond:c,nanosecond:l}=WN(s,a,d,u,c,l,n,o,i),new t(s,a,d,u,c,l)}equals(e){if(!qn(this))throw new TypeError("invalid receiver");let r=Zh(e);for(let n of[Tt,At,kt,Pt,It,Rt])if(O(this,n)!==O(r,n))return!1;return!0}toString(e){if(!qn(this))throw new TypeError("invalid receiver");let r=nr(e),n=rS(r),i=rl(r,"trunc"),o=Ua(r,"smallestUnit","time",void 0);if(o==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let{precision:s,unit:a,increment:d}=nS(o,n);return Pue(this,s,{unit:a,increment:d,roundingMode:i})}toJSON(){if(!qn(this))throw new TypeError("invalid receiver");return Pue(this,"auto")}toLocaleString(e,r){if(!qn(this))throw new TypeError("invalid receiver");return new op(e,r).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainTime")}toPlainDateTime(e){if(!qn(this))throw new TypeError("invalid receiver");let r=Wr(e),n=O(r,Ie),i=O(r,Me),o=O(r,je),s=O(r,fe);return ja(n,i,o,O(this,Tt),O(this,At),O(this,kt),O(this,Pt),O(this,It),O(this,Rt),s)}toZonedDateTime(e){if(!qn(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid argument");let r=e.plainDate;if(r===void 0)throw new TypeError("missing date property");let n=Wr(r),i=e.timeZone;if(i===void 0)throw new TypeError("missing timeZone property");let o=Fo(i),s=O(n,Ie),a=O(n,Me),d=O(n,je),u=O(n,fe),c=O(this,Tt),l=O(this,At),h=O(this,kt),y=O(this,Pt),g=O(this,It),v=O(this,Rt);return lo(O(Ss(o,new(Ee("%Temporal.PlainDateTime%"))(s,a,d,c,l,h,y,g,v,u),"compatible"),ft),o,u)}getISOFields(){if(!qn(this))throw new TypeError("invalid receiver");return{isoHour:O(this,Tt),isoMicrosecond:O(this,It),isoMillisecond:O(this,Pt),isoMinute:O(this,At),isoNanosecond:O(this,Rt),isoSecond:O(this,kt)}}static from(e,r){let n=ni(nr(r));return qn(e)?new t(O(e,Tt),O(e,At),O(e,kt),O(e,Pt),O(e,It),O(e,Rt)):Zh(e,n)}static compare(e,r){let n=Zh(e),i=Zh(r);for(let o of[Tt,At,kt,Pt,It,Rt]){let s=O(n,o),a=O(i,o);if(s!==a)return wv(s-a)}return 0}};Ef(J6,"Temporal.PlainTime");var _v=class{constructor(e){if(arguments.length<1)throw new RangeError("missing argument: identifier is required");let r=UN(e);Sf(this),Dt(this,mf,r)}get id(){if(!Zc(this))throw new TypeError("invalid receiver");return O(this,mf)}getOffsetNanosecondsFor(e){if(!Zc(this))throw new TypeError("invalid receiver");let r=tl(e),n=O(this,mf);return t2(n)?pm(n):Xh(n,O(r,ft))}getOffsetStringFor(e){if(!Zc(this))throw new TypeError("invalid receiver");return nN(this,tl(e))}getPlainDateTimeFor(e,r="iso8601"){if(!Zc(this))throw new TypeError("invalid receiver");return hc(this,tl(e),Ka(r))}getInstantFor(e,r){if(!Zc(this))throw new TypeError("invalid receiver");return Ss(this,vv(e),f2(nr(r)))}getPossibleInstantsFor(e){if(!Zc(this))throw new TypeError("invalid receiver");let r=vv(e),n=Ee("%Temporal.Instant%"),i=O(this,mf);if(t2(i)){let s=ym(O(r,Ie),O(r,Me),O(r,je),O(r,Tt),O(r,At),O(r,kt),O(r,Pt),O(r,It),O(r,Rt));if(s===null)throw new RangeError("DateTime outside of supported range");let a=pm(i);return[new n(z.default.subtract(s,z.default.BigInt(a)))]}return function(a,d,u,c,l,h,y,g,v,x){let S=ym(d,u,c,l,h,y,g,v,x);if(S===null)throw new RangeError("DateTime outside of supported range");let A=z.default.subtract(S,wf);z.default.lessThan(A,U6)&&(A=S);let T=z.default.add(S,wf);z.default.greaterThan(T,u2)&&(T=S);let $=Xh(a,A),j=Xh(a,T);return($===j?[$]:[$,j]).map(K=>{let F=z.default.subtract(S,z.default.BigInt(K)),L=rle(a,F);if(d===L.year&&u===L.month&&c===L.day&&l===L.hour&&h===L.minute&&y===L.second&&g===L.millisecond&&v===L.microsecond&&x===L.nanosecond)return F}).filter(K=>K!==void 0)}(i,O(r,Ie),O(r,Me),O(r,je),O(r,Tt),O(r,At),O(r,kt),O(r,Pt),O(r,It),O(r,Rt)).map(s=>new n(s))}getNextTransition(e){if(!Zc(this))throw new TypeError("invalid receiver");let r=tl(e),n=O(this,mf);if(t2(n)||n==="UTC")return null;let i=O(r,ft),o=Ee("%Temporal.Instant%");return i=ile(n,i),i===null?null:new o(i)}getPreviousTransition(e){if(!Zc(this))throw new TypeError("invalid receiver");let r=tl(e),n=O(this,mf);if(t2(n)||n==="UTC")return null;let i=O(r,ft),o=Ee("%Temporal.Instant%");return i=iN(n,i),i===null?null:new o(i)}toString(){if(!Zc(this))throw new TypeError("invalid receiver");return O(this,mf)}toJSON(){if(!Zc(this))throw new TypeError("invalid receiver");return O(this,mf)}static from(e){return Zue(Fo(e))}};Ef(_v,"Temporal.TimeZone"),Dn("Temporal.TimeZone.prototype.getOffsetNanosecondsFor",_v.prototype.getOffsetNanosecondsFor),Dn("Temporal.TimeZone.prototype.getPossibleInstantsFor",_v.prototype.getPossibleInstantsFor);var aqe=Object.create,Y6=class{constructor(e,r,n="iso8601",i=1){Gue(this,xr(e),xr(r),Ka(n),xr(i))}get year(){if(!Ir(this))throw new TypeError("invalid receiver");return Kk(O(this,fe),this)}get month(){if(!Ir(this))throw new TypeError("invalid receiver");return qk(O(this,fe),this)}get monthCode(){if(!Ir(this))throw new TypeError("invalid receiver");return oS(O(this,fe),this)}get calendarId(){if(!Ir(this))throw new TypeError("invalid receiver");return po(O(this,fe))}get era(){if(!Ir(this))throw new TypeError("invalid receiver");return Lk(O(this,fe),this)}get eraYear(){if(!Ir(this))throw new TypeError("invalid receiver");return Fk(O(this,fe),this)}get daysInMonth(){if(!Ir(this))throw new TypeError("invalid receiver");return zk(O(this,fe),this)}get daysInYear(){if(!Ir(this))throw new TypeError("invalid receiver");return Vk(O(this,fe),this)}get monthsInYear(){if(!Ir(this))throw new TypeError("invalid receiver");return Hk(O(this,fe),this)}get inLeapYear(){if(!Ir(this))throw new TypeError("invalid receiver");return Wk(O(this,fe),this)}with(e,r){if(!Ir(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid argument");b2(e);let n=nr(r),i=O(this,fe),o=li(i,["month","monthCode","year"]),s=$t(this,o,[]);return s=Sv(i,s,$t(e,o,"partial")),s=$t(s,o,[]),Tv(i,s,n)}add(e,r){if(!Ir(this))throw new TypeError("invalid receiver");return Eue("add",this,e,r)}subtract(e,r){if(!Ir(this))throw new TypeError("invalid receiver");return Eue("subtract",this,e,r)}until(e,r){if(!Ir(this))throw new TypeError("invalid receiver");return gue("until",this,e,r)}since(e,r){if(!Ir(this))throw new TypeError("invalid receiver");return gue("since",this,e,r)}equals(e){if(!Ir(this))throw new TypeError("invalid receiver");let r=C6(e);for(let n of[Ie,Me,je])if(O(this,n)!==O(r,n))return!1;return cS(O(this,fe),O(r,fe))}toString(e){if(!Ir(this))throw new TypeError("invalid receiver");return cue(this,tS(nr(e)))}toJSON(){if(!Ir(this))throw new TypeError("invalid receiver");return cue(this)}toLocaleString(e,r){if(!Ir(this))throw new TypeError("invalid receiver");return new op(e,r).format(this)}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.PlainYearMonth")}toPlainDate(e){if(!Ir(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("argument should be an object");let r=O(this,fe),n=li(r,["monthCode","year"]),i=$t(this,n,[]),o=li(r,["day"]),s=Sv(r,i,$t(e,o,[]));s=$t(s,[...new Set([...n,...o])],[]);let a=aqe(null);return a.overflow="reject",tp(r,s,a)}getISOFields(){if(!Ir(this))throw new TypeError("invalid receiver");return{calendar:O(this,fe),isoDay:O(this,je),isoMonth:O(this,Me),isoYear:O(this,Ie)}}getCalendar(){if(!Ir(this))throw new TypeError("invalid receiver");return x2(O(this,fe))}static from(e,r){let n=nr(r);return Ir(e)?(ni(n),q6(O(e,Ie),O(e,Me),O(e,fe),O(e,je))):C6(e,n)}static compare(e,r){let n=C6(e),i=C6(r);return fm(O(n,Ie),O(n,Me),O(n,je),O(i,Ie),O(i,Me),O(i,je))}};Ef(Y6,"Temporal.PlainYearMonth");var cqe=op.prototype.resolvedOptions,dqe=Object.create,Z6=class{constructor(e,r,n="iso8601"){if(arguments.length<1)throw new TypeError("missing argument: epochNanoseconds is required");Jue(this,$6(e),Fo(r),Ka(n))}get calendarId(){if(!Le(this))throw new TypeError("invalid receiver");return po(O(this,fe))}get timeZoneId(){if(!Le(this))throw new TypeError("invalid receiver");return L6(O(this,zr))}get year(){if(!Le(this))throw new TypeError("invalid receiver");return Kk(O(this,fe),fn(this))}get month(){if(!Le(this))throw new TypeError("invalid receiver");return qk(O(this,fe),fn(this))}get monthCode(){if(!Le(this))throw new TypeError("invalid receiver");return oS(O(this,fe),fn(this))}get day(){if(!Le(this))throw new TypeError("invalid receiver");return sS(O(this,fe),fn(this))}get hour(){if(!Le(this))throw new TypeError("invalid receiver");return O(fn(this),Tt)}get minute(){if(!Le(this))throw new TypeError("invalid receiver");return O(fn(this),At)}get second(){if(!Le(this))throw new TypeError("invalid receiver");return O(fn(this),kt)}get millisecond(){if(!Le(this))throw new TypeError("invalid receiver");return O(fn(this),Pt)}get microsecond(){if(!Le(this))throw new TypeError("invalid receiver");return O(fn(this),It)}get nanosecond(){if(!Le(this))throw new TypeError("invalid receiver");return O(fn(this),Rt)}get era(){if(!Le(this))throw new TypeError("invalid receiver");return Lk(O(this,fe),fn(this))}get eraYear(){if(!Le(this))throw new TypeError("invalid receiver");return Fk(O(this,fe),fn(this))}get epochSeconds(){if(!Le(this))throw new TypeError("invalid receiver");let e=O(this,ft);return z.default.toNumber(o2(e,vf))}get epochMilliseconds(){if(!Le(this))throw new TypeError("invalid receiver");let e=O(this,ft);return z.default.toNumber(o2(e,Qc))}get epochMicroseconds(){if(!Le(this))throw new TypeError("invalid receiver");return Dk(o2(O(this,ft),Rr))}get epochNanoseconds(){if(!Le(this))throw new TypeError("invalid receiver");return Dk(O(this,ft))}get dayOfWeek(){if(!Le(this))throw new TypeError("invalid receiver");return MN(O(this,fe),fn(this))}get dayOfYear(){if(!Le(this))throw new TypeError("invalid receiver");return DN(O(this,fe),fn(this))}get weekOfYear(){if(!Le(this))throw new TypeError("invalid receiver");return CN(O(this,fe),fn(this))}get yearOfWeek(){if(!Le(this))throw new TypeError("invalid receiver");return jN(O(this,fe),fn(this))}get hoursInDay(){if(!Le(this))throw new TypeError("invalid receiver");let e=fn(this),r=Ee("%Temporal.PlainDateTime%"),n=O(e,Ie),i=O(e,Me),o=O(e,je),s=new r(n,i,o,0,0,0,0,0,0),a=bv(n,i,o,0,0,0,1,"reject"),d=new r(a.year,a.month,a.day,0,0,0,0,0,0),u=O(this,zr),c=O(Ss(u,s,"compatible"),ft),l=O(Ss(u,d,"compatible"),ft);return yf(z.default.subtract(l,c),Kue)}get daysInWeek(){if(!Le(this))throw new TypeError("invalid receiver");return $N(O(this,fe),fn(this))}get daysInMonth(){if(!Le(this))throw new TypeError("invalid receiver");return zk(O(this,fe),fn(this))}get daysInYear(){if(!Le(this))throw new TypeError("invalid receiver");return Vk(O(this,fe),fn(this))}get monthsInYear(){if(!Le(this))throw new TypeError("invalid receiver");return Hk(O(this,fe),fn(this))}get inLeapYear(){if(!Le(this))throw new TypeError("invalid receiver");return Wk(O(this,fe),fn(this))}get offset(){if(!Le(this))throw new TypeError("invalid receiver");return nN(O(this,zr),O(this,Lo))}get offsetNanoseconds(){if(!Le(this))throw new TypeError("invalid receiver");return nl(O(this,zr),O(this,Lo))}with(e,r){if(!Le(this))throw new TypeError("invalid receiver");if(!pn(e))throw new TypeError("invalid zoned-date-time-like");b2(e);let n=nr(r),i=O(this,fe),o=li(i,["day","hour","microsecond","millisecond","minute","month","monthCode","nanosecond","second","year"]);o.push("offset");let s=$t(this,o,["offset"]);s=Sv(i,s,$t(e,o,"partial")),s=$t(s,o,["offset"]);let a=f2(n),d=kk(n,"prefer"),{year:u,month:c,day:l,hour:h,minute:y,second:g,millisecond:v,microsecond:x,nanosecond:S}=iS(i,s,n),A=pm(s.offset),T=O(this,zr);return lo(Ik(u,c,l,h,y,g,v,x,S,"option",A,T,a,d,!1),T,i)}withPlainDate(e){if(!Le(this))throw new TypeError("invalid receiver");let r=Wr(e),n=O(r,Ie),i=O(r,Me),o=O(r,je),s=O(r,fe),a=fn(this),d=O(a,Tt),u=O(a,At),c=O(a,kt),l=O(a,Pt),h=O(a,It),y=O(a,Rt);s=Yue(O(this,fe),s);let g=O(this,zr);return lo(O(Ss(g,new(Ee("%Temporal.PlainDateTime%"))(n,i,o,d,u,c,l,h,y,s),"compatible"),ft),g,s)}withPlainTime(e){if(!Le(this))throw new TypeError("invalid receiver");let r=Ee("%Temporal.PlainTime%"),n=e===void 0?new r:Zh(e),i=fn(this),o=O(i,Ie),s=O(i,Me),a=O(i,je),d=O(this,fe),u=O(n,Tt),c=O(n,At),l=O(n,kt),h=O(n,Pt),y=O(n,It),g=O(n,Rt),v=O(this,zr);return lo(O(Ss(v,new(Ee("%Temporal.PlainDateTime%"))(o,s,a,u,c,l,h,y,g,d),"compatible"),ft),v,d)}withTimeZone(e){if(!Le(this))throw new TypeError("invalid receiver");let r=Fo(e);return lo(O(this,ft),r,O(this,fe))}withCalendar(e){if(!Le(this))throw new TypeError("invalid receiver");let r=Ka(e);return lo(O(this,ft),O(this,zr),r)}add(e,r){if(!Le(this))throw new TypeError("invalid receiver");return Sue("add",this,e,r)}subtract(e,r){if(!Le(this))throw new TypeError("invalid receiver");return Sue("subtract",this,e,r)}until(e,r){if(!Le(this))throw new TypeError("invalid receiver");return vue("until",this,e,r)}since(e,r){if(!Le(this))throw new TypeError("invalid receiver");return vue("since",this,e,r)}round(e){if(!Le(this))throw new TypeError("invalid receiver");if(e===void 0)throw new TypeError("options parameter is required");let r=typeof e=="string"?m2("smallestUnit",e):nr(e),n=w2(r),i=rl(r,"halfExpand"),o=Ua(r,"smallestUnit","time",xv,["day"]),s={day:1,hour:24,minute:60,second:60,millisecond:1e3,microsecond:1e3,nanosecond:1e3}[o];_2(n,s,s===1);let a=fn(this),d=O(a,Ie),u=O(a,Me),c=O(a,je),l=O(a,Tt),h=O(a,At),y=O(a,kt),g=O(a,Pt),v=O(a,It),x=O(a,Rt),S=Ee("%Temporal.PlainDateTime%"),A=O(this,zr),T=O(this,fe),$=Ss(A,new S(O(a,Ie),O(a,Me),O(a,je),0,0,0,0,0,0),"compatible"),j=ed($,A,T,0,0,0,1,0,0,0,0,0,0),K=z.default.subtract(j,z.default.BigInt(O($,ft)));if(z.default.lessThanOrEqual(K,Ln))throw new RangeError("cannot round a ZonedDateTime in a calendar with zero or negative length days");return{year:d,month:u,day:c,hour:l,minute:h,second:y,millisecond:g,microsecond:v,nanosecond:x}=HN(d,u,c,l,h,y,g,v,x,n,o,i,z.default.toNumber(K)),lo(Ik(d,u,c,l,h,y,g,v,x,"option",nl(A,O(this,Lo)),A,"compatible","prefer",!1),A,O(this,fe))}equals(e){if(!Le(this))throw new TypeError("invalid receiver");let r=j6(e),n=O(this,ft),i=O(r,ft);return!!z.default.equal(z.default.BigInt(n),z.default.BigInt(i))&&!!Xue(O(this,zr),O(r,zr))&&cS(O(this,fe),O(r,fe))}toString(e){if(!Le(this))throw new TypeError("invalid receiver");let r=nr(e),n=tS(r),i=rS(r),o=function(y){return gm(y,"offset",["auto","never"],"auto")}(r),s=rl(r,"trunc"),a=Ua(r,"smallestUnit","time",void 0);if(a==="hour")throw new RangeError('smallestUnit must be a time unit other than "hour"');let d=function(y){return gm(y,"timeZoneName",["auto","never","critical"],"auto")}(r),{precision:u,unit:c,increment:l}=nS(a,i);return due(this,u,n,d,o,{unit:c,increment:l,roundingMode:s})}toLocaleString(e,r){if(!Le(this))throw new TypeError("invalid receiver");let n=nr(r),i=dqe(null);if(n2(i,n,["timeZone"]),n.timeZone!==void 0)throw new TypeError("ZonedDateTime toLocaleString does not accept a timeZone option");i.year===void 0&&i.month===void 0&&i.day===void 0&&i.weekday===void 0&&i.dateStyle===void 0&&i.hour===void 0&&i.minute===void 0&&i.second===void 0&&i.timeStyle===void 0&&i.dayPeriod===void 0&&i.timeZoneName===void 0&&(i.timeZoneName="short");let o=L6(O(this,zr));if(t2(o))throw new RangeError("toLocaleString does not support offset string time zones");o=UN(o),i.timeZone=o;let s=new op(e,i),a=Ge(cqe,s,[]).calendar,d=po(O(this,fe));if(d!=="iso8601"&&a!=="iso8601"&&a!==d)throw new RangeError(`cannot format ZonedDateTime with calendar ${d} in locale with calendar ${a}`);return s.format(O(this,Lo))}toJSON(){if(!Le(this))throw new TypeError("invalid receiver");return due(this,"auto")}valueOf(){throw new TypeError("use compare() or equals() to compare Temporal.ZonedDateTime")}startOfDay(){if(!Le(this))throw new TypeError("invalid receiver");let e=fn(this),r=Ee("%Temporal.PlainDateTime%"),n=O(this,fe),i=new r(O(e,Ie),O(e,Me),O(e,je),0,0,0,0,0,0,n),o=O(this,zr);return lo(O(Ss(o,i,"compatible"),ft),o,n)}toInstant(){if(!Le(this))throw new TypeError("invalid receiver");return new(Ee("%Temporal.Instant%"))(O(this,ft))}toPlainDate(){if(!Le(this))throw new TypeError("invalid receiver");return p2(fn(this))}toPlainTime(){if(!Le(this))throw new TypeError("invalid receiver");return NN(fn(this))}toPlainDateTime(){if(!Le(this))throw new TypeError("invalid receiver");return fn(this)}toPlainYearMonth(){if(!Le(this))throw new TypeError("invalid receiver");let e=O(this,fe);return Tv(e,$t(this,li(e,["monthCode","year"]),[]))}toPlainMonthDay(){if(!Le(this))throw new TypeError("invalid receiver");let e=O(this,fe);return h2(e,$t(this,li(e,["day","monthCode"]),[]))}getISOFields(){if(!Le(this))throw new TypeError("invalid receiver");let e=fn(this),r=O(this,zr);return{calendar:O(this,fe),isoDay:O(e,je),isoHour:O(e,Tt),isoMicrosecond:O(e,It),isoMillisecond:O(e,Pt),isoMinute:O(e,At),isoMonth:O(e,Me),isoNanosecond:O(e,Rt),isoSecond:O(e,kt),isoYear:O(e,Ie),offset:nN(r,O(this,Lo)),timeZone:r}}getCalendar(){if(!Le(this))throw new TypeError("invalid receiver");return x2(O(this,fe))}getTimeZone(){if(!Le(this))throw new TypeError("invalid receiver");return Zue(O(this,zr))}static from(e,r){let n=nr(r);return Le(e)?(f2(n),kk(n,"reject"),ni(n),lo(O(e,ft),O(e,zr),O(e,fe))):j6(e,n)}static compare(e,r){let n=j6(e),i=j6(r),o=O(n,ft),s=O(i,ft);return z.default.lessThan(z.default.BigInt(o),z.default.BigInt(s))?-1:z.default.greaterThan(z.default.BigInt(o),z.default.BigInt(s))?1:0}};function fn(t){return hc(O(t,zr),O(t,Lo),O(t,fe))}Ef(Z6,"Temporal.ZonedDateTime");var Rv=Object.freeze({__proto__:null,Calendar:xn,Duration:W6,Instant:F6,Now:Ole,PlainDate:V6,PlainDateTime:H6,PlainMonthDay:G6,PlainTime:J6,PlainYearMonth:Y6,TimeZone:_v,ZonedDateTime:Z6});var uqe=[F6,xn,V6,H6,W6,G6,J6,_v,Y6,Z6];for(let t of uqe){let e=Object.getOwnPropertyDescriptor(t,"prototype");(e.configurable||e.enumerable||e.writable)&&(e.configurable=!1,e.enumerable=!1,e.writable=!1,Object.defineProperty(t,"prototype",e))}var Mle=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},mr=class t{static sleep(e){return Mle(this,void 0,void 0,function*(){return new Promise(r=>setTimeout(r,e))})}static minimalSleep(){return Mle(this,void 0,void 0,function*(){yield t.sleep(2)})}static getCurrentTimestamp(){return Rv.Now.instant().toString({smallestUnit:"microseconds"})}static createTimestamp(e){let{year:r,month:n,day:i,hour:o,minute:s,second:a,millisecond:d,microsecond:u}=e;return Rv.ZonedDateTime.from({timeZone:"UTC",year:r,month:n,day:i,hour:o,minute:s,second:a,millisecond:d,microsecond:u}).toInstant().toString({smallestUnit:"microseconds"})}static createOffsetTimestamp(e,r){let n=r?Rv.Instant.from(r):Rv.Now.instant(),i=Rv.Duration.from(e);return n.add(i).toString({smallestUnit:"microseconds"})}static validateTimestamp(e){try{Rv.Instant.from(e)}catch{throw new de(se.TimestampInvalid,`Invalid timestamp: ${e}`)}}};var Pi=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},lqe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Vr=class t{get message(){if(this._message.authorization===void 0)throw new de(se.RecordsWriteMissingSigner,"This RecordsWrite is not yet signed, JSON message cannot be generated from an incomplete state.");return this._message}get author(){return this._author}get signaturePayload(){return this._signaturePayload}get owner(){return this._owner}get ownerSignaturePayload(){return this._ownerSignaturePayload}get isSignedByAuthorDelegate(){return _e.isSignedByAuthorDelegate(this._message)}get isSignedByOwnerDelegate(){return _e.isSignedByOwnerDelegate(this._message)}get signer(){return _e.getSigner(this._message)}get ownerSignatureSigner(){var e;return((e=this._message.authorization)===null||e===void 0?void 0:e.ownerSignature)===void 0?void 0:cn.getSignerDid(this._message.authorization.ownerSignature.signatures[0])}constructor(e,r){this.parentContextId=r,this._message=e,e.authorization!==void 0&&(this._author=ot.getAuthor(e),this._signaturePayload=cn.decodePlainObjectPayload(e.authorization.signature),e.authorization.ownerSignature!==void 0&&(e.authorization.ownerDelegatedGrant!==void 0?this._owner=_e.getSigner(e.authorization.ownerDelegatedGrant):this._owner=cn.getSignerDid(e.authorization.ownerSignature.signatures[0]),this._ownerSignaturePayload=cn.decodePlainObjectPayload(e.authorization.ownerSignature))),this.attesters=t.getAttesters(e)}static parse(e){return Pi(this,void 0,void 0,function*(){let r=JSON.parse(JSON.stringify(e));yield _e.validateSignatureStructure(r.authorization.signature,r.descriptor,"RecordsWriteSignaturePayload"),r.authorization.ownerSignature!==void 0&&(yield _e.validateSignatureStructure(r.authorization.ownerSignature,r.descriptor)),yield t.validateAttestationIntegrity(r);let n=new t(r);return yield n.validateIntegrity(),n})}static create(e){var r,n,i,o;return Pi(this,void 0,void 0,function*(){if(e.protocol===void 0&&e.protocolPath!==void 0||e.protocol!==void 0&&e.protocolPath===void 0)throw new de(se.RecordsWriteCreateProtocolAndProtocolPathMutuallyInclusive,"`protocol` and `protocolPath` must both be defined or undefined at the same time");if(e.data===void 0&&e.dataCid===void 0||e.data!==void 0&&e.dataCid!==void 0)throw new de(se.RecordsWriteCreateDataAndDataCidMutuallyExclusive,"one and only one parameter between `data` and `dataCid` is required");if(e.dataCid===void 0&&e.dataSize!==void 0||e.dataCid!==void 0&&e.dataSize===void 0)throw new de(se.RecordsWriteCreateDataCidAndDataSizeMutuallyInclusive,"`dataCid` and `dataSize` must both be defined or undefined at the same time");if(e.signer===void 0&&e.delegatedGrant!==void 0)throw new de(se.RecordsWriteCreateMissingSigner,"`signer` must be given when `delegatedGrant` is given");let s=(r=e.dataCid)!==null&&r!==void 0?r:yield vn.computeDagPbCidFromBytes(e.data),a=(n=e.dataSize)!==null&&n!==void 0?n:e.data.length,d=mr.getCurrentTimestamp(),u={interface:Oe.Records,method:Ae.Write,protocol:e.protocol!==void 0?lc(e.protocol):void 0,protocolPath:e.protocolPath,recipient:e.recipient,schema:e.schema!==void 0?pv(e.schema):void 0,tags:e.tags,parentId:t.getRecordIdFromContextId(e.parentContextId),dataCid:s,dataSize:a,dateCreated:(i=e.dateCreated)!==null&&i!==void 0?i:d,messageTimestamp:(o=e.messageTimestamp)!==null&&o!==void 0?o:d,published:e.published,datePublished:e.datePublished,dataFormat:e.dataFormat};e.published===!0&&e.datePublished===void 0&&(u.datePublished=d),On(u);let c=e.recordId,l=yield vn.computeCid(u),h=yield t.createAttestation(l,e.attestationSigners),y=yield t.createEncryptionProperty(u,e.encryptionInput),g={recordId:c,descriptor:u};h!==void 0&&(g.attestation=h),y!==void 0&&(g.encryption=y);let v=new t(g,e.parentContextId);return e.signer!==void 0&&(yield v.sign({signer:e.signer,delegatedGrant:e.delegatedGrant,permissionGrantId:e.permissionGrantId,protocolRole:e.protocolRole})),v})}static getRecordIdFromContextId(e){return e?.split("/").filter(r=>r!=="").pop()}static createFrom(e){var r,n,i,o;return Pi(this,void 0,void 0,function*(){let s=e.recordsWriteMessage,a=yield t.parse(s),d=mr.getCurrentTimestamp(),u=(r=e.published)!==null&&r!==void 0?r:e.datePublished?!0:s.descriptor.published,c;e.datePublished?c=e.datePublished:u&&(s.descriptor.published?c=s.descriptor.datePublished:c=d);let l={recipient:s.descriptor.recipient,recordId:s.recordId,dateCreated:s.descriptor.dateCreated,protocol:s.descriptor.protocol,protocolPath:s.descriptor.protocolPath,schema:s.descriptor.schema,parentContextId:ot.getParentContextFromOfContextId(s.contextId),messageTimestamp:(n=e.messageTimestamp)!==null&&n!==void 0?n:d,published:u,datePublished:c,tags:e.tags,data:e.data,dataCid:e.data?void 0:s.descriptor.dataCid,dataSize:e.data?void 0:s.descriptor.dataSize,dataFormat:(i=e.dataFormat)!==null&&i!==void 0?i:s.descriptor.dataFormat,protocolRole:(o=e.protocolRole)!==null&&o!==void 0?o:a.signaturePayload.protocolRole,delegatedGrant:e.delegatedGrant,signer:e.signer,attestationSigners:e.attestationSigners};return yield t.create(l)})}toJSON(){return this.message}encryptSymmetricEncryptionKey(e){return Pi(this,void 0,void 0,function*(){this._message.encryption=yield t.createEncryptionProperty(this._message.descriptor,e),delete this._message.authorization,this._signaturePayload=void 0,this._author=void 0})}sign(e){var r;return Pi(this,void 0,void 0,function*(){let{signer:n,delegatedGrant:i,permissionGrantId:o,protocolRole:s}=e,a,d;i!==void 0?(a=yield _e.getCid(i),d=cn.getSignerDid(i.authorization.signature.signatures[0])):d=cn.extractDid(n.keyId);let u=this._message.descriptor,c=yield vn.computeCid(u);this._message.recordId=(r=this._message.recordId)!==null&&r!==void 0?r:yield t.getEntryId(d,u),this._message.descriptor.protocol!==void 0&&(this.parentContextId===void 0||this.parentContextId===""?this._message.contextId=this._message.recordId:this._message.contextId=this.parentContextId+"/"+this._message.recordId);let l=yield t.createSignerSignature({recordId:this._message.recordId,contextId:this._message.contextId,descriptorCid:c,attestation:this._message.attestation,encryption:this._message.encryption,signer:n,delegatedGrantId:a,permissionGrantId:o,protocolRole:s});this._message.authorization={signature:l},i!==void 0&&(this._message.authorization.authorDelegatedGrant=i),this._signaturePayload=cn.decodePlainObjectPayload(l),this._author=d})}signAsOwner(e){return Pi(this,void 0,void 0,function*(){if(this._author===void 0)throw new de(se.RecordsWriteSignAsOwnerUnknownAuthor,"Unable to sign as owner without message signature because owner needs to sign over `recordId` which depends on author DID.");let r=this._message.descriptor,n=yield _e.createSignature(r,e);this._message.authorization.ownerSignature=n,this._ownerSignaturePayload=cn.decodePlainObjectPayload(n),this._owner=cn.extractDid(e.keyId)})}signAsOwnerDelegate(e,r){return Pi(this,void 0,void 0,function*(){if(this._author===void 0)throw new de(se.RecordsWriteSignAsOwnerDelegateUnknownAuthor,"Unable to sign as owner delegate without message signature because owner delegate needs to sign over `recordId` which depends on author DID.");let n=yield _e.getCid(r),i=this._message.descriptor,o=yield _e.createSignature(i,e,{delegatedGrantId:n});this._message.authorization.ownerSignature=o,this._message.authorization.ownerDelegatedGrant=r,this._ownerSignaturePayload=cn.decodePlainObjectPayload(o),this._owner=cn.getSignerDid(r.authorization.signature.signatures[0])})}validateIntegrity(){return Pi(this,void 0,void 0,function*(){if(yield this.isInitialWrite()){let n=this.message.descriptor.dateCreated,i=this.message.descriptor.messageTimestamp;if(i!==n)throw new de(se.RecordsWriteValidateIntegrityDateCreatedMismatch,`messageTimestamp ${i} must match dateCreated ${n} for the initial write`);if(this.message.descriptor.protocol!==void 0&&this.message.descriptor.parentId===void 0){let o=yield this.getEntryId();if(this.message.contextId!==o)throw new de(se.RecordsWriteValidateIntegrityContextIdMismatch,`contextId in message: ${this.message.contextId} does not match deterministic contextId: ${o}`)}}let r=this.signaturePayload;if(this.message.recordId!==r.recordId)throw new de(se.RecordsWriteValidateIntegrityRecordIdUnauthorized,`recordId in message ${this.message.recordId} does not match recordId in authorization: ${r.recordId}`);if(this.message.contextId!==r.contextId)throw new de(se.RecordsWriteValidateIntegrityContextIdNotInSignerSignaturePayload,`contextId in message ${this.message.contextId} does not match contextId in authorization: ${r.contextId}`);if(yield ot.validateDelegatedGrantReferentialIntegrity(this.message,r,this.ownerSignaturePayload),r.attestationCid!==void 0){let n=yield vn.computeCid(this.message.attestation),i=r.attestationCid;if(i!==n)throw new de(se.RecordsWriteValidateIntegrityAttestationMismatch,`CID ${n} of attestation property in message does not match attestationCid in authorization: ${i}`)}if(r.encryptionCid!==void 0){let n=yield vn.computeCid(this.message.encryption),i=r.encryptionCid;if(i!==n)throw new de(se.RecordsWriteValidateIntegrityEncryptionCidMismatch,`CID ${n} of encryption property in message does not match encryptionCid in authorization: ${i}`)}this.message.descriptor.protocol!==void 0&&ua(this.message.descriptor.protocol),this.message.descriptor.schema!==void 0&&um(this.message.descriptor.schema),mr.validateTimestamp(this.message.descriptor.messageTimestamp),mr.validateTimestamp(this.message.descriptor.dateCreated),this.message.descriptor.datePublished&&mr.validateTimestamp(this.message.descriptor.datePublished)})}static validateAttestationIntegrity(e){return Pi(this,void 0,void 0,function*(){if(e.attestation===void 0)return;if(e.attestation.signatures.length!==1)throw new de(se.RecordsWriteAttestationIntegrityMoreThanOneSignature,`Currently implementation only supports 1 attester, but got ${e.attestation.signatures.length}`);let r=cn.decodePlainObjectPayload(e.attestation),{descriptorCid:n}=r,i=yield vn.computeCid(e.descriptor);if(n!==i)throw new de(se.RecordsWriteAttestationIntegrityDescriptorCidMismatch,`descriptorCid ${n} does not match expected descriptorCid ${i}`);let o=Object.keys(r).length;if(o>1)throw new de(se.RecordsWriteAttestationIntegrityInvalidPayloadProperty,`Only 'descriptorCid' is allowed in attestation payload, but got ${o} properties.`)})}getEntryId(){return Pi(this,void 0,void 0,function*(){return yield t.getEntryId(this.author,this.message.descriptor)})}static getEntryId(e,r){return Pi(this,void 0,void 0,function*(){if(e===void 0)throw new de(se.RecordsWriteGetEntryIdUndefinedAuthor,"Property `author` is needed to compute entry ID.");let n=Object.assign({},r);return n.author=e,yield vn.computeCid(n)})}isInitialWrite(){return Pi(this,void 0,void 0,function*(){return(yield this.getEntryId())===this.message.recordId})}constructIndexes(e){return Pi(this,void 0,void 0,function*(){let r=this.message,n=r.descriptor,{tags:i}=n,o=lqe(n,["tags"]);delete o.published;let s=Object.assign(Object.assign({},o),{isLatestBaseState:e,published:!!r.descriptor.published,author:this.author,recordId:r.recordId,entryId:yield t.getEntryId(this.author,this.message.descriptor)});if(i!==void 0&&e===!0){let a=ot.buildTagIndexes(Object.assign({},i));s=Object.assign(Object.assign({},s),a)}return this.attesters.length>0&&(s.attester=this.attesters[0]),r.contextId!==void 0&&(s.contextId=r.contextId),s})}authorizeAuthorDelegate(e){return Pi(this,void 0,void 0,function*(){let r=yield ei.parse(this.message.authorization.authorDelegatedGrant);yield ps.authorizeWrite({recordsWriteMessage:this.message,expectedGrantor:this.author,expectedGrantee:this.signer,permissionGrant:r,messageStore:e})})}authorizeOwnerDelegate(e){return Pi(this,void 0,void 0,function*(){let r=yield ei.parse(this.message.authorization.ownerDelegatedGrant);yield ps.authorizeWrite({recordsWriteMessage:this.message,expectedGrantor:this.owner,expectedGrantee:this.ownerSignatureSigner,permissionGrant:r,messageStore:e})})}static isInitialWrite(e){return Pi(this,void 0,void 0,function*(){if(e.descriptor.interface!==Oe.Records||e.descriptor.method!==Ae.Write)return!1;let r=e,n=ot.getAuthor(r);return(yield t.getEntryId(n,r.descriptor))===r.recordId})}static createEncryptionProperty(e,r){var n,i;return Pi(this,void 0,void 0,function*(){if(r===void 0)return;let o=[];for(let a of r.keyEncryptionInputs){if(a.derivationScheme===uo.ProtocolPath&&e.protocol===void 0)throw new de(se.RecordsWriteMissingProtocol,"`protocols` encryption scheme cannot be applied to record without the `protocol` property.");if(a.derivationScheme===uo.Schemas&&e.schema===void 0)throw new de(se.RecordsWriteMissingSchema,"`schemas` encryption scheme cannot be applied to record without the `schema` property.");let d=Wi.publicJwkToBytes(a.publicKey),u=yield Jh.eciesSecp256k1Encrypt(d,r.key),c=Ke.bytesToBase64Url(u.ciphertext),l=yield Wi.publicKeyToJwk(u.ephemeralPublicKey),h=Ke.bytesToBase64Url(u.initializationVector),y=Ke.bytesToBase64Url(u.messageAuthenticationCode),g={rootKeyId:a.publicKeyId,algorithm:(n=a.algorithm)!==null&&n!==void 0?n:lv.EciesSecp256k1,derivationScheme:a.derivationScheme,ephemeralPublicKey:l,initializationVector:h,messageAuthenticationCode:y,encryptedKey:c};a.derivationScheme===uo.ProtocolContext&&(g.derivedPublicKey=a.publicKey),o.push(g)}return{algorithm:(i=r.algorithm)!==null&&i!==void 0?i:lv.Aes256Ctr,initializationVector:Ke.bytesToBase64Url(r.initializationVector),keyEncryption:o}})}static createAttestation(e,r){return Pi(this,void 0,void 0,function*(){if(r===void 0||r.length===0)return;let n={descriptorCid:e},i=Ke.objectToBytes(n);return(yield fv.create(i,r)).getJws()})}static createSignerSignature(e){return Pi(this,void 0,void 0,function*(){let{recordId:r,contextId:n,descriptorCid:i,attestation:o,encryption:s,signer:a,delegatedGrantId:d,permissionGrantId:u,protocolRole:c}=e,l=o?yield vn.computeCid(o):void 0,h=s?yield vn.computeCid(s):void 0,y={recordId:r,descriptorCid:i,contextId:n,attestationCid:l,encryptionCid:h,delegatedGrantId:d,permissionGrantId:u,protocolRole:c};On(y);let g=Ke.objectToBytes(y);return(yield fv.create(g,[a])).getJws()})}static getInitialWrite(e){return Pi(this,void 0,void 0,function*(){for(let r of e)if(yield t.isInitialWrite(r))return r;throw new de(se.RecordsWriteGetInitialWriteNotFound,"Initial write is not found.")})}static verifyEqualityOfImmutableProperties(e,r){let n=["dataCid","dataSize","dataFormat","datePublished","published","messageTimestamp","tags"],i=[];i.push(...Object.keys(e.descriptor)),i.push(...Object.keys(r.descriptor)),i=[...new Set(i)];for(let o of i)if(n.indexOf(o)===-1){let s=e.descriptor[o],a=r.descriptor[o];if(a!==s)throw new de(se.RecordsWriteImmutablePropertyChanged,`${o} is an immutable property: cannot change '${s}' to '${a}'`)}return!0}static getAttesters(e){var r,n;return((n=(r=e.attestation)===null||r===void 0?void 0:r.signatures)!==null&&n!==void 0?n:[]).map(s=>cn.getSignerDid(s))}static fetchNewestRecordsWrite(e,r,n){return Pi(this,void 0,void 0,function*(){let i={interface:Oe.Records,method:Ae.Write,recordId:n},{messages:o}=yield e.query(r,[i]),s=yield _e.getNewestMessage(o);if(s!==void 0)return s;throw new de(se.RecordsWriteGetNewestWriteRecordNotFound,"record not found")})}static fetchInitialRecordsWrite(e,r,n){return Pi(this,void 0,void 0,function*(){let i={entryId:n},{messages:o}=yield e.query(r,[i]);return o.length===0?void 0:yield t.parse(o[0])})}};var Dle=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};function Ni(t,e){return Dle(this,void 0,void 0,function*(){if(t===void 0)throw new de(se.AuthenticateJwsMissing,"Missing JWS.");if(yield dg.verifySignatures(t.signature,e),t.ownerSignature!==void 0&&(yield dg.verifySignatures(t.ownerSignature,e)),t.authorDelegatedGrant!==void 0){let r=yield Vr.parse(t.authorDelegatedGrant);yield dg.verifySignatures(r.message.authorization.signature,e)}if(t.ownerDelegatedGrant!==void 0){let r=yield Vr.parse(t.ownerDelegatedGrant);yield dg.verifySignatures(r.message.authorization.signature,e)}})}function Cle(t,e){return Dle(this,void 0,void 0,function*(){if(e.author!==t)throw new de(se.AuthorizationAuthorNotOwner,`Message authored by ${e.author}, not authored by expected owner ${t}.`)})}f();var fqe=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},uS=class{isActiveTenant(e){return fqe(this,void 0,void 0,function*(){return{isActiveTenant:!0}})}};f();f();var Qi=class{get message(){return this._message}get signer(){return this._signer}get author(){return this._author}get signaturePayload(){return this._signaturePayload}constructor(e){this._message=e,e.authorization!==void 0&&(this._signer=_e.getSigner(e),e.authorization.authorDelegatedGrant!==void 0?this._author=_e.getSigner(e.authorization.authorDelegatedGrant):this._author=this._signer,this._signaturePayload=cn.decodePlainObjectPayload(e.authorization.signature))}toJSON(){return this.message}};var QN=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},xm=class t extends Qi{static parse(e){return QN(this,void 0,void 0,function*(){if(e.descriptor.filter.published===!1&&(e.descriptor.dateSort===Uo.PublishedAscending||e.descriptor.dateSort===Uo.PublishedDescending))throw new de(se.RecordsQueryParseFilterPublishedSortInvalid,`queries must not filter for \`published:false\` and sort by ${e.descriptor.dateSort}`);let r;if(e.authorization!==void 0&&(r=yield _e.validateSignatureStructure(e.authorization.signature,e.descriptor)),yield ot.validateDelegatedGrantReferentialIntegrity(e,r),r?.protocolRole!==void 0&&e.descriptor.filter.protocolPath===void 0)throw new de(se.RecordsQueryFilterMissingRequiredProperties,"Role-authorized queries must include `protocolPath` in the filter");return e.descriptor.filter.protocol!==void 0&&ua(e.descriptor.filter.protocol),e.descriptor.filter.schema!==void 0&&um(e.descriptor.filter.schema),mr.validateTimestamp(e.descriptor.messageTimestamp),new t(e)})}static create(e){var r;return QN(this,void 0,void 0,function*(){let n={interface:Oe.Records,method:Ae.Query,messageTimestamp:(r=e.messageTimestamp)!==null&&r!==void 0?r:mr.getCurrentTimestamp(),filter:ot.normalizeFilter(e.filter),dateSort:e.dateSort,pagination:e.pagination};if(e.filter.published===!1&&(e.dateSort===Uo.PublishedAscending||e.dateSort===Uo.PublishedDescending))throw new de(se.RecordsQueryCreateFilterPublishedSortInvalid,`queries must not filter for \`published:false\` and sort by ${e.dateSort}`);On(n);let i=e.signer,o;i&&(o=yield _e.createAuthorization({descriptor:n,signer:i,protocolRole:e.protocolRole,delegatedGrant:e.delegatedGrant}));let s={descriptor:n,authorization:o};return _e.validateJsonSchema(s),new t(s)})}authorizeDelegate(e){return QN(this,void 0,void 0,function*(){let r=yield ei.parse(this.message.authorization.authorDelegatedGrant);yield ps.authorizeQueryOrSubscribe({incomingMessage:this.message,expectedGrantee:this.signer,expectedGrantor:this.author,permissionGrant:r,messageStore:e})})}};f();var Qk=xt(dk(),1),jle=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},il=class t{static toBytes(e){return jle(this,void 0,void 0,function*(){return new Promise((r,n)=>{let i=[];e.on("data",o=>{i.push(o)}),e.on("end",()=>{let o=t.concatenateArrayOfBytes(i);r(o)}),e.on("error",n)})})}static toObject(e){return jle(this,void 0,void 0,function*(){let r=yield t.toBytes(e);return Ke.bytesToObject(r)})}static concatenateArrayOfBytes(e){let r=e.reduce((o,s)=>o+s.length,0),n=new Uint8Array(r),i=0;for(let o of e)n.set(o,i),i+=o.length;return n}static fromBytes(e){let n=0;return new Qk.Readable({read(o){n+1e5>e.length?(this.push(e.subarray(n)),this.push(null)):(this.push(e.subarray(n,n+1e5)),n=n+1e5)}})}static fromObject(e){let r=Ke.objectToBytes(e);return t.fromBytes(r)}static duplicateDataStream(e,r){let n=[];for(let i=0;i<r;i++){let o=new Qk.PassThrough;e.pipe(o),n.push(o)}return n}};f();f();function gr(t,e){let r=t instanceof Error?t.message:"Error";return{status:{code:e,detail:r}}}f();f();f();f();var hqe=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},sp=class t{static parse(e){return hqe(this,void 0,void 0,function*(){return new t(e)})}constructor(e){this.id=e.recordId,this.requester=_e.getSigner(e);let r=e.encodedData,n=Ke.base64UrlToObject(r);this.delegated=n.delegated,this.description=n.description,this.scope=n.scope,this.conditions=n.conditions}};var lS=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},gt=class t{static parseRequest(e){return Ke.base64UrlToObject(e)}static createRequest(e){return lS(this,void 0,void 0,function*(){if(this.isRecordPermissionScope(e.scope)&&e.scope.protocol===void 0)throw new de(se.PermissionsProtocolCreateRequestRecordsScopeMissingProtocol,"Permission request for Records must have a scope with a `protocol` property");let r=t.normalizePermissionScope(e.scope),n={description:e.description,delegated:e.delegated,scope:r,conditions:e.conditions},i;this.hasProtocolScope(r)&&(i={protocol:r.protocol});let o=Ke.objectToBytes(n),s=yield Vr.create({signer:e.signer,messageTimestamp:e.dateRequested,protocol:t.uri,protocolPath:t.requestPath,dataFormat:"application/json",data:o,tags:i}),a=Object.assign(Object.assign({},s.message),{encodedData:Ke.bytesToBase64Url(o)});return{recordsWrite:s,permissionRequestData:n,permissionRequestBytes:o,dataEncodedMessage:a}})}static createGrant(e){return lS(this,void 0,void 0,function*(){if(this.isRecordPermissionScope(e.scope)&&e.scope.protocol===void 0)throw new de(se.PermissionsProtocolCreateGrantRecordsScopeMissingProtocol,"Permission grants for Records must have a scope with a `protocol` property");let r=t.normalizePermissionScope(e.scope),n={dateExpires:e.dateExpires,requestId:e.requestId,description:e.description,delegated:e.delegated,scope:r,conditions:e.conditions},i;this.hasProtocolScope(r)&&(i={protocol:r.protocol});let o=Ke.objectToBytes(n),s=yield Vr.create({signer:e.signer,messageTimestamp:e.dateGranted,dateCreated:e.dateGranted,recipient:e.grantedTo,protocol:t.uri,protocolPath:t.grantPath,dataFormat:"application/json",data:o,tags:i}),a=Object.assign(Object.assign({},s.message),{encodedData:Ke.bytesToBase64Url(o)});return{recordsWrite:s,permissionGrantData:n,permissionGrantBytes:o,dataEncodedMessage:a}})}static createRevocation(e){return lS(this,void 0,void 0,function*(){let r={description:e.description},n=e.grant.id,i;this.hasProtocolScope(e.grant.scope)&&(i={protocol:lc(e.grant.scope.protocol)});let o=Ke.objectToBytes(r),s=yield Vr.create({signer:e.signer,parentContextId:n,protocol:t.uri,protocolPath:t.revocationPath,dataFormat:"application/json",data:o,tags:i}),a=Object.assign(Object.assign({},s.message),{encodedData:Ke.bytesToBase64Url(o)});return{recordsWrite:s,permissionRevocationData:r,permissionRevocationBytes:o,dataEncodedMessage:a}})}static validateSchema(e,r){let n=Ke.bytesToString(r),i=JSON.parse(n);if(e.descriptor.protocolPath===t.requestPath){let o=i;gh("PermissionRequestData",o),t.validateScopeAndTags(o.scope,e)}else if(e.descriptor.protocolPath===t.grantPath){gh("PermissionGrantData",i);let o=i;t.validateScopeAndTags(o.scope,e),mr.validateTimestamp(o.dateExpires)}else if(e.descriptor.protocolPath===t.revocationPath)gh("PermissionRevocationData",i);else throw new de(se.PermissionsProtocolValidateSchemaUnexpectedRecord,`Unexpected permission record: ${e.descriptor.protocolPath}`)}static fetchGrant(e,r,n){return lS(this,void 0,void 0,function*(){let i={recordId:n,isLatestBaseState:!0},{messages:o}=yield r.query(e,[i]),s=o[0],a=s?.descriptor.interface,d=s?.descriptor.method;if(a!==Oe.Records||d!==Ae.Write||s.descriptor.protocolPath!==t.grantPath)throw new de(se.GrantAuthorizationGrantMissing,`Could not find permission grant with record ID ${n}.`);let u=s;return yield ei.parse(u)})}static getScopeFromPermissionRecord(e,r,n){return lS(this,void 0,void 0,function*(){if(n.descriptor.protocol!==t.uri)throw new de(se.PermissionsProtocolGetScopeInvalidProtocol,`Unexpected protocol for permission record: ${n.descriptor.protocol}`);return n.descriptor.protocolPath===t.revocationPath?(yield t.fetchGrant(e,r,n.descriptor.parentId)).scope:n.descriptor.protocolPath===t.grantPath?(yield ei.parse(n)).scope:(yield sp.parse(n)).scope})}static normalizePermissionScope(e){let r=Object.assign({},e);return t.hasProtocolScope(r)&&(r.protocol=lc(r.protocol)),r}static isRecordPermissionScope(e){return e.interface==="Records"}static hasProtocolScope(e){return"protocol"in e&&e.protocol!==void 0}static validateTags(e,r){if(e.descriptor.tags===void 0||e.descriptor.tags.protocol===void 0)throw new de(se.PermissionsProtocolValidateScopeMissingProtocolTag,"Permission grants must have a `tags` property that contains a protocol tag");let n=e.descriptor.tags.protocol;if(n!==r)throw new de(se.PermissionsProtocolValidateScopeProtocolMismatch,`Permission grants must have a scope with a protocol that matches the tagged protocol: ${n}`)}static validateScopeAndTags(e,r){if(this.hasProtocolScope(e)&&(ua(e.protocol),this.validateTags(r,e.protocol)),!!this.isRecordPermissionScope(e)&&e.contextId!==void 0&&e.protocolPath!==void 0)throw new de(se.PermissionsProtocolValidateScopeContextIdProhibitedProperties,"Permission grants cannot have both `contextId` and `protocolPath` present")}};gt.uri="https://tbd.website/dwn/permissions";gt.requestPath="request";gt.grantPath="grant";gt.revocationPath="grant/revocation";gt.definition={published:!0,protocol:gt.uri,types:{request:{dataFormats:["application/json"]},grant:{dataFormats:["application/json"]},revocation:{dataFormats:["application/json"]}},structure:{request:{$size:{max:1e4},$actions:[{who:"anyone",can:["create"]}]},grant:{$size:{max:1e4},$actions:[{who:"recipient",of:"grant",can:["read","query"]}],revocation:{$size:{max:1e4},$actions:[{who:"anyone",can:["read"]}]}}}};var Em=class{static normalizeFilters(e){let r=[];for(let n of e){let i=n.protocol!==void 0?lc(n.protocol):void 0,o=Object.assign(Object.assign({},n),{protocol:i});On(o),M6(o)||r.push(o)}return r}static convertFilters(e){let r=[];for(let n of e){let i=this.constructPermissionRecordsFilter(n);i&&r.push(i),r.push(this.convertFilter(n))}return r}static constructPermissionRecordsFilter(e){let{protocol:r,messageTimestamp:n}=e;if(r!==void 0){let i=Object.assign({protocol:gt.uri},ot.convertTagsFilter({protocol:r}));if(n!=null){let o=ti.convertRangeCriterion(n);o&&(i.messageTimestamp=o)}return i}}static convertFilter(e){let r=Object.assign({},e),{messageTimestamp:n}=e,i=n?ti.convertRangeCriterion(n):void 0;return i&&(r.messageTimestamp=i,delete r.dateUpdated),r}};f();var eU=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Sm=class t{static authorizeMessagesRead(e){return eU(this,void 0,void 0,function*(){let{messagesReadMessage:r,messageToRead:n,expectedGrantor:i,expectedGrantee:o,permissionGrant:s,messageStore:a}=e;yield Wd.performBaseValidation({incomingMessage:r,expectedGrantor:i,expectedGrantee:o,permissionGrant:s,messageStore:a});let d=s.scope;yield t.verifyScope(i,n,d,a)})}static authorizeQueryOrSubscribe(e){return eU(this,void 0,void 0,function*(){let{incomingMessage:r,expectedGrantor:n,expectedGrantee:i,permissionGrant:o,messageStore:s}=e;if(yield Wd.performBaseValidation({incomingMessage:r,expectedGrantor:n,expectedGrantee:i,permissionGrant:o,messageStore:s}),gt.hasProtocolScope(o.scope)){let a=o.scope.protocol;for(let d of r.descriptor.filters)if(d.protocol!==a)throw new de(se.MessagesGrantAuthorizationMismatchedProtocol,`The protocol ${d.protocol} does not match the scoped protocol ${a}`)}})}static verifyScope(e,r,n,i){return eU(this,void 0,void 0,function*(){if(n.protocol!==void 0){if(r.descriptor.interface===Oe.Records){let o=r,s=ot.isRecordsWrite(o)?o:yield Vr.fetchNewestRecordsWrite(i,e,o.descriptor.recordId);if(s.descriptor.protocol===n.protocol)return;if(s.descriptor.protocol===gt.uri){let a=yield gt.getScopeFromPermissionRecord(e,i,s);if(gt.hasProtocolScope(a)&&a.protocol===n.protocol)return}}else if(r.descriptor.interface===Oe.Protocols&&r.descriptor.definition.protocol===n.protocol)return;throw new de(se.MessagesReadVerifyScopeFailed,"record message failed scope authorization")}})}};f();var $le=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Tm=class t extends Qi{static parse(e){return $le(this,void 0,void 0,function*(){_e.validateJsonSchema(e),yield _e.validateSignatureStructure(e.authorization.signature,e.descriptor);for(let r of e.descriptor.filters)"protocol"in r&&r.protocol!==void 0&&ua(r.protocol);return new t(e)})}static create(e){var r;return $le(this,void 0,void 0,function*(){let n={interface:Oe.Messages,method:Ae.Query,filters:e.filters?Em.normalizeFilters(e.filters):[],messageTimestamp:(r=e.messageTimestamp)!==null&&r!==void 0?r:mr.getCurrentTimestamp(),cursor:e.cursor};On(n);let{permissionGrantId:i,signer:o}=e,s=yield _e.createAuthorization({descriptor:n,signer:o,permissionGrantId:i}),a={descriptor:n,authorization:s};return _e.validateJsonSchema(a),new t(a)})}};var Nle=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},eP=class t{constructor(e,r,n){this.didResolver=e,this.messageStore=r,this.eventLog=n}handle({tenant:e,message:r}){return Nle(this,void 0,void 0,function*(){let n;try{n=yield Tm.parse(r)}catch(a){return gr(a,400)}try{yield Ni(r.authorization,this.didResolver),yield t.authorizeMessagesQuery(e,n,this.messageStore)}catch(a){return gr(a,401)}let i=Em.convertFilters(r.descriptor.filters),{events:o,cursor:s}=yield this.eventLog.queryEvents(e,i,r.descriptor.cursor);return{status:{code:200,detail:"OK"},entries:o,cursor:s}})}static authorizeMessagesQuery(e,r,n){return Nle(this,void 0,void 0,function*(){if(r.author!==e)if(r.author!==void 0&&r.signaturePayload.permissionGrantId!==void 0){let i=yield gt.fetchGrant(e,n,r.signaturePayload.permissionGrantId);yield Sm.authorizeQueryOrSubscribe({incomingMessage:r.message,expectedGrantor:e,expectedGrantee:r.author,permissionGrant:i,messageStore:n})}else throw new de(se.MessagesQueryAuthorizationFailed,"message failed authorization")})}};f();f();var Ule=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Am=class t extends Qi{static parse(e){return Ule(this,void 0,void 0,function*(){return _e.validateJsonSchema(e),this.validateMessageCid(e.descriptor.messageCid),yield _e.validateSignatureStructure(e.authorization.signature,e.descriptor),mr.validateTimestamp(e.descriptor.messageTimestamp),new t(e)})}static create(e){var r;return Ule(this,void 0,void 0,function*(){let n={interface:Oe.Messages,method:Ae.Read,messageCid:e.messageCid,messageTimestamp:(r=e.messageTimestamp)!==null&&r!==void 0?r:mr.getCurrentTimestamp()},{signer:i,permissionGrantId:o}=e,s=yield _e.createAuthorization({descriptor:n,signer:i,permissionGrantId:o}),a={descriptor:n,authorization:s};return _e.validateJsonSchema(a),t.validateMessageCid(e.messageCid),new t(a)})}static validateMessageCid(e){try{vn.parseCid(e)}catch{throw new de(se.MessagesReadInvalidCid,`${e} is not a valid CID`)}}};var Kle=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},tP=class t{constructor(e,r,n){this.didResolver=e,this.messageStore=r,this.dataStore=n}handle({tenant:e,message:r}){return Kle(this,void 0,void 0,function*(){let n;try{n=yield Am.parse(r)}catch(s){return gr(s,400)}try{yield Ni(r.authorization,this.didResolver)}catch(s){return gr(s,401)}let i=yield this.messageStore.get(e,r.descriptor.messageCid);if(i===void 0)return{status:{code:404,detail:"Not Found"}};try{yield t.authorizeMessagesRead(e,n,i,this.messageStore)}catch(s){return gr(s,401)}let o={message:i,messageCid:r.descriptor.messageCid};if(ot.isRecordsWrite(i)){let s=o.message;if(s.encodedData!==void 0){let a=Ke.base64UrlToBytes(s.encodedData);o.data=il.fromBytes(a),delete s.encodedData}else{let a=yield this.dataStore.get(e,s.recordId,s.descriptor.dataCid);a?.dataStream!==void 0&&(o.data=a.dataStream)}}return{status:{code:200,detail:"OK"},entry:o}})}static authorizeMessagesRead(e,r,n,i){return Kle(this,void 0,void 0,function*(){if(r.author!==e)if(r.author!==void 0&&r.signaturePayload.permissionGrantId!==void 0){let o=yield gt.fetchGrant(e,i,r.signaturePayload.permissionGrantId);yield Sm.authorizeMessagesRead({messagesReadMessage:r.message,messageToRead:n,expectedGrantor:e,expectedGrantee:r.author,permissionGrant:o,messageStore:i})}else throw new de(se.MessagesReadAuthorizationFailed,"protocol message failed authorization")})}};f();f();var qle=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},km=class t extends Qi{static parse(e){return qle(this,void 0,void 0,function*(){_e.validateJsonSchema(e),yield _e.validateSignatureStructure(e.authorization.signature,e.descriptor);for(let r of e.descriptor.filters)"protocol"in r&&r.protocol!==void 0&&ua(r.protocol);return mr.validateTimestamp(e.descriptor.messageTimestamp),new t(e)})}static create(e){var r,n;return qle(this,void 0,void 0,function*(){let i=mr.getCurrentTimestamp(),o={interface:Oe.Messages,method:Ae.Subscribe,filters:(r=e.filters)!==null&&r!==void 0?r:[],messageTimestamp:(n=e.messageTimestamp)!==null&&n!==void 0?n:i};On(o);let{permissionGrantId:s,signer:a}=e,d=yield _e.createAuthorization({descriptor:o,signer:a,permissionGrantId:s}),u={descriptor:o,authorization:d};return _e.validateJsonSchema(u),new t(u)})}};var Lle=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},rP=class t{constructor(e,r,n){this.didResolver=e,this.messageStore=r,this.eventStream=n}handle({tenant:e,message:r,subscriptionHandler:n}){return Lle(this,void 0,void 0,function*(){if(this.eventStream===void 0)return gr(new de(se.MessagesSubscribeEventStreamUnimplemented,"Subscriptions are not supported"),501);let i;try{i=yield km.parse(r)}catch(c){return gr(c,400)}try{yield Ni(r.authorization,this.didResolver),yield t.authorizeMessagesSubscribe(e,i,this.messageStore)}catch(c){return gr(c,401)}let{filters:o}=r.descriptor,s=Em.convertFilters(o),a=yield _e.getCid(r),d=(c,l,h)=>{e===c&&ti.matchAnyFilter(h,s)&&n(l)},u=yield this.eventStream.subscribe(e,a,d);return{status:{code:200,detail:"OK"},subscription:u}})}static authorizeMessagesSubscribe(e,r,n){return Lle(this,void 0,void 0,function*(){if(r.author!==e)if(r.author!==void 0&&r.signaturePayload.permissionGrantId!==void 0){let i=yield gt.fetchGrant(e,n,r.signaturePayload.permissionGrantId);yield Sm.authorizeQueryOrSubscribe({incomingMessage:r.message,expectedGrantor:e,expectedGrantee:r.author,permissionGrant:i,messageStore:n})}else throw new de(se.MessagesSubscribeAuthorizationFailed,"message failed authorization")})}};f();f();var Ipe=xt(JK(),1);f();var up;(function(t){t.Anyone="anyone",t.Author="author",t.Recipient="recipient"})(up||(up={}));var Ii;(function(t){t.CoDelete="co-delete",t.CoPrune="co-prune",t.CoUpdate="co-update",t.Create="create",t.Delete="delete",t.Prune="prune",t.Query="query",t.Read="read",t.Subscribe="subscribe",t.Update="update"})(Ii||(Ii={}));var Ppe=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},aWe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},jm=class t extends Qi{static parse(e){return Ppe(this,void 0,void 0,function*(){return _e.validateJsonSchema(e),t.validateProtocolDefinition(e.descriptor.definition),yield _e.validateSignatureStructure(e.authorization.signature,e.descriptor),mr.validateTimestamp(e.descriptor.messageTimestamp),new t(e)})}static create(e){var r;return Ppe(this,void 0,void 0,function*(){let n={interface:Oe.Protocols,method:Ae.Configure,messageTimestamp:(r=e.messageTimestamp)!==null&&r!==void 0?r:mr.getCurrentTimestamp(),definition:t.normalizeDefinition(e.definition)},i=yield _e.createAuthorization({descriptor:n,signer:e.signer,permissionGrantId:e.permissionGrantId}),o={descriptor:n,authorization:i};return _e.validateJsonSchema(o),t.validateProtocolDefinition(o.descriptor.definition),new t(o)})}static validateProtocolDefinition(e){let{protocol:r,types:n}=e;ua(r);for(let i in n){let o=n[i].schema;o!==void 0&&um(o)}t.validateStructure(e)}static validateStructure(e){let r=Object.keys(e.types),n=t.fetchAllRolePathsRecursively("",e.structure,[]);t.validateRuleSetRecursively({ruleSet:e.structure,ruleSetProtocolPath:"",recordTypes:r,roles:n})}static fetchAllRolePathsRecursively(e,r,n){if(e.split("/").length>10)throw new de(se.ProtocolsConfigureRecordNestingDepthExceeded,"Record nesting depth exceeded 10 levels.");for(let i in r){if(i.startsWith("$"))continue;let o=r[i],s;e===""?s=i:s=`${e}/${i}`,o.$role?n.push(s):t.fetchAllRolePathsRecursively(s,o,n)}return n}static validateRuleSetRecursively(e){var r;let{ruleSet:n,ruleSetProtocolPath:i,recordTypes:o,roles:s}=e;if(n.$size!==void 0){let{min:d=0,max:u}=n.$size;if(u!==void 0&&u<d)throw new de(se.ProtocolsConfigureInvalidSize,`Invalid size range found: max limit ${u} less than min limit ${d} at protocol path '${i}'`)}if(n.$tags){let d=new Ipe.default.default,u=n.$tags,{$allowUndefinedTags:c,$requiredTags:l}=u,h=aWe(u,["$allowUndefinedTags","$requiredTags"]);for(let y in h){let g=h[y];if(!d.validateSchema(g)){let v=d.errorsText(d.errors,{dataVar:`${i}/$tags/${y}`});throw new de(se.ProtocolsConfigureInvalidTagSchema,`tags schema validation error: ${v}`)}}}let a=(r=n.$actions)!==null&&r!==void 0?r:[];for(let d=0;d<a.length;d++){let u=a[d];if(u.role!==void 0&&!s.includes(u.role))throw new de(se.ProtocolsConfigureRoleDoesNotExistAtGivenPath,`Role in action ${JSON.stringify(u)} for rule set ${i} does not exist.`);if(u.who==="anyone"&&u.of)throw new de(se.ProtocolsConfigureInvalidActionOfNotAllowed,`'of' is not allowed at rule set protocol path (${i})`);if(u.who===up.Recipient&&u.of===void 0&&u.can.some(l=>![Ii.CoUpdate,Ii.CoDelete,Ii.CoPrune].includes(l)))throw new de(se.ProtocolsConfigureInvalidRecipientOfAction,"Rules for `recipient` without `of` property must have `can` containing only `co-update`, `co-delete`, and `co-prune`.");if(u.who===up.Author&&!u.of)throw new de(se.ProtocolsConfigureInvalidActionMissingOf,"'of' is required when 'author' is specified as 'who'");if(u.can!==void 0){if(u.can.includes(Ii.Update)&&!u.can.includes(Ii.Create))throw new de(se.ProtocolsConfigureInvalidActionUpdateWithoutCreate,`Action rule ${JSON.stringify(u)} contains 'update' action but missing the required 'create' action.`);if(u.can.includes(Ii.Delete)&&!u.can.includes(Ii.Create))throw new de(se.ProtocolsConfigureInvalidActionDeleteWithoutCreate,`Action rule ${JSON.stringify(u)} contains 'delete' action but missing the required 'create' action.`)}for(let c=d+1;c<a.length;c++){let l=a[c];if(u.who!==void 0){if(u.who===l.who&&u.of===l.of)throw new de(se.ProtocolsConfigureDuplicateActorInRuleSet,`More than one action rule per actor ${u.who} of ${u.of} not allowed within a rule set: ${JSON.stringify(u)}`)}else if(u.role===l.role)throw new de(se.ProtocolsConfigureDuplicateRoleInRuleSet,`More than one action rule per role ${u.role} not allowed within a rule set: ${JSON.stringify(u)}`)}}for(let d in n){if(d.startsWith("$"))continue;if(!o.includes(d))throw new de(se.ProtocolsConfigureInvalidRuleSetRecordType,`Rule set ${d} is not declared as an allowed type in the protocol definition.`);let u=n[d],c;i===""?c=d:c=`${i}/${d}`,t.validateRuleSetRecursively({ruleSet:u,ruleSetProtocolPath:c,recordTypes:o,roles:s})}}static normalizeDefinition(e){let r=Object.assign({},e.types);for(let n in r){let i=r[n].schema;i!==void 0&&(r[n].schema=pv(i))}return Object.assign(Object.assign({},e),{protocol:lc(e.protocol),types:r})}};var cWe=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},dWe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},CP=class t{constructor(e,r,n,i){this.didResolver=e,this.messageStore=r,this.eventLog=n,this.eventStream=i}handle({tenant:e,message:r}){return cWe(this,void 0,void 0,function*(){let n;try{n=yield jm.parse(r)}catch(c){return gr(c,400)}try{yield Ni(r.authorization,this.didResolver),yield Cle(e,n)}catch(c){return gr(c,401)}let i={interface:Oe.Protocols,method:Ae.Configure,protocol:r.descriptor.definition.protocol},{messages:o}=yield this.messageStore.query(e,[i]),s=yield _e.getNewestMessage(o),a=!1;(s===void 0||(yield _e.isNewer(r,s)))&&(a=!0,s=r);let d;if(a){let c=t.constructIndexes(n);yield this.messageStore.put(e,r,c);let l=yield _e.getCid(r);yield this.eventLog.append(e,l,c),this.eventStream!==void 0&&this.eventStream.emit(e,{message:r},c),d={status:{code:202,detail:"Accepted"}}}else d={status:{code:409,detail:"Conflict"}};let u=[];for(let c of o)if(yield _e.isNewer(s,c)){let l=yield _e.getCid(c);u.push(l),yield this.messageStore.delete(e,l)}return yield this.eventLog.deleteEventsByCid(e,u),d})}static constructIndexes(e){let r=e.message.descriptor,{definition:n}=r,i=dWe(r,["definition"]),{author:o}=e;return Object.assign(Object.assign({},i),{author:o,protocol:n.protocol,published:n.published})}};f();f();var YK=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},$m=class t extends Qi{static parse(e){return YK(this,void 0,void 0,function*(){return e.authorization!==void 0&&(yield _e.validateSignatureStructure(e.authorization.signature,e.descriptor)),e.descriptor.filter!==void 0&&ua(e.descriptor.filter.protocol),mr.validateTimestamp(e.descriptor.messageTimestamp),new t(e)})}static create(e){var r;return YK(this,void 0,void 0,function*(){let n={interface:Oe.Protocols,method:Ae.Query,messageTimestamp:(r=e.messageTimestamp)!==null&&r!==void 0?r:mr.getCurrentTimestamp(),filter:e.filter?t.normalizeFilter(e.filter):void 0};On(n);let i;e.signer!==void 0&&(i=yield _e.createAuthorization({descriptor:n,signer:e.signer,permissionGrantId:e.permissionGrantId}));let o={descriptor:n,authorization:i};return _e.validateJsonSchema(o),new t(o)})}static normalizeFilter(e){return Object.assign(Object.assign({},e),{protocol:lc(e.protocol)})}authorize(e,r){return YK(this,void 0,void 0,function*(){if(this.author!==e)if(this.author!==void 0&&this.signaturePayload.permissionGrantId){let n=yield gt.fetchGrant(e,r,this.signaturePayload.permissionGrantId);yield Wd.performBaseValidation({incomingMessage:this.message,expectedGrantor:e,expectedGrantee:this.author,permissionGrant:n,messageStore:r})}else throw new de(se.ProtocolsQueryUnauthorized,"The ProtocolsQuery failed authorization")})}};var Rpe=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},jP=class{constructor(e,r,n){this.didResolver=e,this.messageStore=r,this.dataStore=n}handle({tenant:e,message:r}){return Rpe(this,void 0,void 0,function*(){let n;try{n=yield $m.parse(r)}catch(s){return gr(s,400)}try{yield Ni(r.authorization,this.didResolver),yield n.authorize(e,this.messageStore)}catch(s){if(s.code===se.AuthenticateJwsMissing||s.code===se.ProtocolsQueryUnauthorized){let a=yield this.fetchPublishedProtocolsConfigure(e,n);return{status:{code:200,detail:"OK"},entries:a}}else return gr(s,401)}let i=Object.assign(Object.assign({},r.descriptor.filter),{interface:Oe.Protocols,method:Ae.Configure});On(i);let{messages:o}=yield this.messageStore.query(e,[i]);return{status:{code:200,detail:"OK"},entries:o}})}fetchPublishedProtocolsConfigure(e,r){return Rpe(this,void 0,void 0,function*(){let n=Object.assign(Object.assign({},r.message.descriptor.filter),{interface:Oe.Protocols,method:Ae.Configure,published:!0}),{messages:i}=yield this.messageStore.query(e,[n]);return i})}};f();f();var Bpe=xt(JK(),1);var vc=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},uWe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},rd=class t{static validateReferentialIntegrity(e,r,n){return vc(this,void 0,void 0,function*(){let i=yield t.fetchProtocolDefinition(e,r.message.descriptor.protocol,n);t.verifyType(r.message,i.types),yield t.verifyProtocolPathAndContextId(e,r,n);let o=t.getRuleSet(r.message.descriptor.protocolPath,i);yield t.verifyAsRoleRecordIfNeeded(e,r,o,n),t.verifySizeLimit(r,o),t.verifyTagsIfNeeded(r,o)})}static authorizeWrite(e,r,n){return vc(this,void 0,void 0,function*(){let i=yield t.fetchInitialWrite(e,r.message.recordId,n),o;i===void 0?o=yield t.constructRecordChain(e,r.message.descriptor.parentId,n):o=yield t.constructRecordChain(e,r.message.recordId,n);let s=yield t.fetchProtocolDefinition(e,r.message.descriptor.protocol,n),a=t.getRuleSet(r.message.descriptor.protocolPath,s);yield t.verifyInvokedRole(e,r,r.message.descriptor.protocol,r.message.contextId,s,n),yield t.authorizeAgainstAllowedActions(e,r,a,o,n)})}static authorizeRead(e,r,n,i){return vc(this,void 0,void 0,function*(){let o=yield t.constructRecordChain(e,n.message.recordId,i),s=yield t.fetchProtocolDefinition(e,n.message.descriptor.protocol,i),a=t.getRuleSet(n.message.descriptor.protocolPath,s);yield t.verifyInvokedRole(e,r,n.message.descriptor.protocol,n.message.contextId,s,i),yield t.authorizeAgainstAllowedActions(e,r,a,o,i)})}static authorizeQueryOrSubscribe(e,r,n){return vc(this,void 0,void 0,function*(){let{protocol:i,protocolPath:o,contextId:s}=r.message.descriptor.filter,a=yield t.fetchProtocolDefinition(e,i,n),d=t.getRuleSet(o,a);yield t.verifyInvokedRole(e,r,i,s,a,n),yield t.authorizeAgainstAllowedActions(e,r,d,[],n)})}static authorizeDelete(e,r,n,i){return vc(this,void 0,void 0,function*(){let o=yield t.constructRecordChain(e,r.message.descriptor.recordId,i),s=yield t.fetchProtocolDefinition(e,n.message.descriptor.protocol,i),a=t.getRuleSet(n.message.descriptor.protocolPath,s);yield t.verifyInvokedRole(e,r,n.message.descriptor.protocol,n.message.contextId,s,i),yield t.authorizeAgainstAllowedActions(e,r,a,o,i)})}static fetchProtocolDefinition(e,r,n){return vc(this,void 0,void 0,function*(){if(r===gt.uri)return gt.definition;let i={interface:Oe.Protocols,method:Ae.Configure,protocol:r},{messages:o}=yield n.query(e,[i]);if(o.length===0)throw new de(se.ProtocolAuthorizationProtocolNotFound,`unable to find protocol definition for ${r}`);return o[0].descriptor.definition})}static constructRecordChain(e,r,n){return vc(this,void 0,void 0,function*(){if(r===void 0)return[];let i=[],o=r;for(;o!==void 0;){let s=yield t.fetchInitialWrite(e,o,n);if(s===void 0)throw new de(se.ProtocolAuthorizationParentNotFoundConstructingRecordChain,`Unexpected error that should never trigger: no parent found with ID ${o} when constructing record chain.`);i.push(s),o=s.descriptor.parentId}return i.reverse()})}static fetchInitialWrite(e,r,n){return vc(this,void 0,void 0,function*(){let i={interface:Oe.Records,method:Ae.Write,recordId:r},{messages:o}=yield n.query(e,[i]);return o.length===0?void 0:yield Vr.getInitialWrite(o)})}static getRuleSet(e,r){let n=t.getRuleSetAtProtocolPath(e,r);if(n===void 0)throw new de(se.ProtocolAuthorizationMissingRuleSet,`No rule set defined for protocolPath ${e}`);return n}static verifyProtocolPathAndContextId(e,r,n){var i;return vc(this,void 0,void 0,function*(){let o=r.message.descriptor.protocolPath,s=t.getTypeName(o),a=r.message.descriptor.parentId;if(a===void 0){if(o!==s)throw new de(se.ProtocolAuthorizationParentlessIncorrectProtocolPath,`Declared protocol path '${o}' is not valid for records with no parent'.`);return}let d=r.message.descriptor.protocol,u={isLatestBaseState:!0,interface:Oe.Records,method:Ae.Write,protocol:d,recordId:a},{messages:c}=yield n.query(e,[u]),l=c[0];if(`${(i=l?.descriptor)===null||i===void 0?void 0:i.protocolPath}/${s}`!==o)throw new de(se.ProtocolAuthorizationIncorrectProtocolPath,`Could not find matching parent record to verify declared protocol path '${o}'.`);let g=`${l.contextId}/${r.message.recordId}`,v=r.message.contextId;if(v!==g)throw new de(se.ProtocolAuthorizationIncorrectContextId,`Declared contextId '${v}' is not the same as expected: '${g}'.`)})}static verifyType(e,r){let n=Object.keys(r),i=e.descriptor.protocolPath,o=t.getTypeName(i);if(!n.includes(o))throw new de(se.ProtocolAuthorizationInvalidType,`record with type ${o} not allowed in protocol`);let s=e.descriptor.protocolPath,a=t.getTypeName(s),d=r[a],{schema:u}=e.descriptor;if(d.schema!==void 0&&d.schema!==u)throw new de(se.ProtocolAuthorizationInvalidSchema,`type '${a}' must have schema '${d.schema}',         instead has '${u}'`);let{dataFormat:c}=e.descriptor;if(d.dataFormats!==void 0&&!d.dataFormats.includes(c))throw new de(se.ProtocolAuthorizationIncorrectDataFormat,`type '${a}' must have data format in (${d.dataFormats}),         instead has '${c}'`)}static verifyInvokedRole(e,r,n,i,o,s){var a;return vc(this,void 0,void 0,function*(){let d=(a=r.signaturePayload)===null||a===void 0?void 0:a.protocolRole;if(d===void 0)return;let u=t.getRuleSetAtProtocolPath(d,o);if(u===void 0||!u.$role)throw new de(se.ProtocolAuthorizationNotARole,`Protocol path ${d} does not match role record type.`);let c={interface:Oe.Records,method:Ae.Write,protocol:n,protocolPath:d,recipient:r.author,isLatestBaseState:!0},l=d.split("/").length-1;if(i===void 0&&l>0)throw new de(se.ProtocolAuthorizationMissingContextId,"Could not verify role because contextId is missing.");if(l>0){let g=i.split("/").slice(0,l).join("/"),v=ti.constructPrefixFilterAsRangeFilter(g);c.contextId=v}let{messages:h}=yield s.query(e,[c]);if(h.length===0)throw new de(se.ProtocolAuthorizationMatchingRoleRecordNotFound,`No matching role record found for protocol path ${d}`)})}static getActionsSeekingARuleMatch(e,r,n){return vc(this,void 0,void 0,function*(){switch(r.message.descriptor.method){case Ae.Delete:let i=r,o=i.message.descriptor.recordId,s=yield Vr.fetchInitialRecordsWrite(n,e,o);if(s===void 0)return[];let a=[];return i.message.descriptor.prune?(a.push(Ii.CoPrune),r.author===s.author&&a.push(Ii.Prune)):(a.push(Ii.CoDelete),r.author===s.author&&a.push(Ii.Delete)),a;case Ae.Query:return[Ii.Query];case Ae.Read:return[Ii.Read];case Ae.Subscribe:return[Ii.Subscribe];case Ae.Write:if(yield r.isInitialWrite())return[Ii.Create];{let c=r.message.recordId,l=yield Vr.fetchInitialRecordsWrite(n,e,c);return l===void 0?[]:r.author===l.author?[Ii.CoUpdate,Ii.Update]:[Ii.CoUpdate]}}return[]})}static authorizeAgainstAllowedActions(e,r,n,i,o){var s;return vc(this,void 0,void 0,function*(){let a=r.message.descriptor.method,d=yield t.getActionsSeekingARuleMatch(e,r,o),u=r.author,c=n.$actions;if(c===void 0)throw new de(se.ProtocolAuthorizationActionRulesNotFound,`no action rule defined for Records${a}, ${u} is unauthorized`);let l=(s=r.signaturePayload)===null||s===void 0?void 0:s.protocolRole;for(let h of c){if(!h.can.some(v=>d.includes(v)))continue;if(h.who===up.Anyone)return;if(u===void 0)continue;if(l!==void 0){if(h.role===l)return;continue}if(h.who===up.Recipient&&h.of===void 0){let v;if(r.message.descriptor.method===Ae.Write?v=r.message:v=i[i.length-1],v.descriptor.recipient===u)return;continue}if(yield t.checkActor(u,h,i))return}throw new de(se.ProtocolAuthorizationActionNotAllowed,`Inbound message action Records${a} by author ${r.author} not allowed.`)})}static verifySizeLimit(e,r){let{min:n=0,max:i}=r.$size||{},o=e.message.descriptor.dataSize;if(o<n)throw new de(se.ProtocolAuthorizationMinSizeInvalid,`data size ${o} is less than allowed ${n}`);if(i!==void 0&&o>i)throw new de(se.ProtocolAuthorizationMaxSizeInvalid,`data size ${o} is more than allowed ${i}`)}static verifyTagsIfNeeded(e,r){if(r.$tags!==void 0){let{tags:n={},protocol:i,protocolPath:o}=e.message.descriptor,s=r.$tags,{$allowUndefinedTags:a,$requiredTags:d}=s,u=uWe(s,["$allowUndefinedTags","$requiredTags"]),c=a||!1,l=d||[],h=new Bpe.default.default,y=h.compile({type:"object",properties:u,required:l,additionalProperties:c});if(!y(n)){let v=h.errorsText(y.errors,{dataVar:`${i}/${o}/$tags`});throw new de(se.ProtocolAuthorizationTagsInvalidSchema,`tags schema validation error: ${v}`)}}}static verifyAsRoleRecordIfNeeded(e,r,n,i){return vc(this,void 0,void 0,function*(){if(!n.$role)return;let o=r,s=o.message.descriptor.recipient;if(s===void 0)throw new de(se.ProtocolAuthorizationRoleMissingRecipient,"Role records must have a recipient");let a=o.message.descriptor.protocolPath,d={interface:Oe.Records,method:Ae.Write,isLatestBaseState:!0,protocol:o.message.descriptor.protocol,protocolPath:a,recipient:s},u=ot.getParentContextFromOfContextId(o.message.contextId);if(u!==""){let y=ti.constructPrefixFilterAsRangeFilter(u);d.contextId=y}let{messages:c}=yield i.query(e,[d]);if(c.filter(y=>y.recordId!==o.message.recordId).length>0)throw new de(se.ProtocolAuthorizationDuplicateRoleRecipient,`DID '${s}' is already recipient of a role record at protocol path '${a} under the parent context ${u}.`)})}static getRuleSetAtProtocolPath(e,r){let n=e.split("/"),i=r.structure,o=0;for(;o<n.length;){let s=n[o],a=i[s];if(a===void 0)return;i=a,o++}return i}static checkActor(e,r,n){return vc(this,void 0,void 0,function*(){let i=n.find(o=>o.descriptor.protocolPath===r.of);if(i===void 0)return!1;if(r.who===up.Recipient)return e===i.descriptor.recipient;{let o=(yield Vr.parse(i)).author;return e===o}})}static getTypeName(e){return e.split("/").slice(-1)[0]}};f();var ZK=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},If=class t extends Qi{static parse(e){return ZK(this,void 0,void 0,function*(){let r;return e.authorization!==void 0&&(r=yield _e.validateSignatureStructure(e.authorization.signature,e.descriptor)),yield ot.validateDelegatedGrantReferentialIntegrity(e,r),mr.validateTimestamp(e.descriptor.messageTimestamp),new t(e)})}static create(e){var r,n;return ZK(this,void 0,void 0,function*(){let i=e.recordId,o=mr.getCurrentTimestamp(),s={interface:Oe.Records,method:Ae.Delete,messageTimestamp:(r=e.messageTimestamp)!==null&&r!==void 0?r:o,recordId:i,prune:(n=e.prune)!==null&&n!==void 0?n:!1},a=yield _e.createAuthorization({descriptor:s,signer:e.signer,protocolRole:e.protocolRole,delegatedGrant:e.delegatedGrant}),d={descriptor:s,authorization:a};return _e.validateJsonSchema(d),new t(d)})}constructIndexes(e){let r=this.message,n=Object.assign({},r.descriptor),{protocol:i,protocolPath:o,recipient:s,schema:a,parentId:d,dateCreated:u}=e.descriptor,c=Object.assign({protocol:i,protocolPath:o,recipient:s,schema:a,parentId:d,dateCreated:u,contextId:e.contextId,author:this.author},n);return On(c),c}authorizeDelegate(e,r){return ZK(this,void 0,void 0,function*(){let n=yield ei.parse(this.message.authorization.authorDelegatedGrant);yield ps.authorizeDelete({recordsDeleteMessage:this.message,recordsWriteToDelete:e,expectedGrantor:this.author,expectedGrantee:this.signer,permissionGrant:n,messageStore:r})})}};f();var j2=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},FS;(function(t){t.RecordsDelete="RecordsDelete"})(FS||(FS={}));var zS=class t{constructor(e,r){this.resumableTaskStore=e,this.resumableTaskBatchSize=100,this.resumableTaskHandlers={[FS.RecordsDelete]:n=>j2(this,void 0,void 0,function*(){return yield r.performRecordsDelete(n)})}}run(e){return j2(this,void 0,void 0,function*(){let r=t.timeoutExtensionFrequencyInSeconds*2,n=yield this.resumableTaskStore.register(e,r);yield this.runWithAutomaticTimeoutExtension(n)})}runWithAutomaticTimeoutExtension(e){return j2(this,void 0,void 0,function*(){let r=t.timeoutExtensionFrequencyInSeconds*2,n;try{n=setInterval(()=>{this.resumableTaskStore.extend(e.id,r)},t.timeoutExtensionFrequencyInSeconds*1e3);let i=this.resumableTaskHandlers[e.task.name];yield i(e.task.data),yield this.resumableTaskStore.delete(e.id)}finally{t.clearTimeoutExtensionTimer(n)}})}static clearTimeoutExtensionTimer(e){clearInterval(e)}resumeTasksAndWaitForCompletion(){return j2(this,void 0,void 0,function*(){for(;;){let e=yield this.resumableTaskStore.grab(this.resumableTaskBatchSize);if(e===void 0||e.length===0)break;yield this.retryTasksUntilCompletion(e)}})}retryTasksUntilCompletion(e){return j2(this,void 0,void 0,function*(){let r=e;for(;r.length>0;){let n=r;r=[];let i=n.map(o=>j2(this,void 0,void 0,function*(){try{yield this.runWithAutomaticTimeoutExtension(o)}catch(s){console.error("Error while running resumable task:",s),console.error("Resumable task:",e),r.push(o)}}));yield Promise.all(i)}})}};zS.timeoutExtensionFrequencyInSeconds=30;var Ope=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},$P=class t{constructor(e,r,n){this.didResolver=e,this.messageStore=r,this.resumableTaskManager=n}handle({tenant:e,message:r}){return Ope(this,void 0,void 0,function*(){let n;try{n=yield If.parse(r)}catch(u){return gr(u,400)}try{yield Ni(r.authorization,this.didResolver)}catch(u){return gr(u,401)}let i={interface:Oe.Records,recordId:r.descriptor.recordId},{messages:o}=yield this.messageStore.query(e,[i]),s=yield _e.getNewestMessage(o);if(!ot.canPerformDeleteAgainstRecord(r,s))return{status:{code:404,detail:"Not Found"}};if(!(yield _e.isNewer(r,s)))return{status:{code:409,detail:"Conflict"}};try{let u=yield Vr.fetchInitialRecordsWrite(this.messageStore,e,r.descriptor.recordId);yield t.authorizeRecordsDelete(e,n,u,this.messageStore)}catch(u){return gr(u,401)}return yield this.resumableTaskManager.run({name:FS.RecordsDelete,data:{tenant:e,message:r}}),{status:{code:202,detail:"Accepted"}}})}static authorizeRecordsDelete(e,r,n,i){return Ope(this,void 0,void 0,function*(){if(_e.isSignedByAuthorDelegate(r.message)&&(yield r.authorizeDelegate(n.message,i)),r.author!==e)if(n.message.descriptor.protocol!==void 0)yield rd.authorizeDelete(e,r,n,i);else throw new de(se.RecordsDeleteAuthorizationFailed,"RecordsDelete message failed authorization")})}};f();f();var Is;(function(t){t[t.Descending=-1]="Descending",t[t.Ascending=1]="Ascending"})(Is||(Is={}));var VS=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},NP=class t{constructor(e,r,n){this.didResolver=e,this.messageStore=r,this.dataStore=n}handle({tenant:e,message:r}){return VS(this,void 0,void 0,function*(){let n;try{n=yield xm.parse(r)}catch(s){return gr(s,400)}let i,o;if(ot.filterIncludesPublishedRecords(n.message.descriptor.filter)&&n.author===void 0){let s=yield this.fetchPublishedRecords(e,n);i=s.messages,o=s.cursor}else{try{yield Ni(r.authorization,this.didResolver),yield t.authorizeRecordsQuery(e,n,this.messageStore)}catch(s){return gr(s,401)}if(n.author===e){let s=yield this.fetchRecordsAsOwner(e,n);i=s.messages,o=s.cursor}else{let s=yield this.fetchRecordsAsNonOwner(e,n);i=s.messages,o=s.cursor}}for(let s of i)if(!(yield Vr.isInitialWrite(s))){let d=(yield this.messageStore.query(e,[{recordId:s.recordId,isLatestBaseState:!1,method:Ae.Write}])).messages[0];delete d.encodedData,s.initialWrite=d}return{status:{code:200,detail:"OK"},entries:i,cursor:o}})}convertDateSort(e){switch(e){case Uo.CreatedAscending:return{dateCreated:Is.Ascending};case Uo.CreatedDescending:return{dateCreated:Is.Descending};case Uo.PublishedAscending:return{datePublished:Is.Ascending};case Uo.PublishedDescending:return{datePublished:Is.Descending};default:return{dateCreated:Is.Ascending}}}fetchRecordsAsOwner(e,r){return VS(this,void 0,void 0,function*(){let{dateSort:n,filter:i,pagination:o}=r.message.descriptor,s=Object.assign(Object.assign({},ot.convertFilter(i,n)),{interface:Oe.Records,method:Ae.Write,isLatestBaseState:!0}),a=this.convertDateSort(n);return this.messageStore.query(e,[s],a,o)})}fetchRecordsAsNonOwner(e,r){return VS(this,void 0,void 0,function*(){let{dateSort:n,pagination:i,filter:o}=r.message.descriptor,s=[];ot.filterIncludesPublishedRecords(o)&&s.push(t.buildPublishedRecordsFilter(r)),ot.filterIncludesUnpublishedRecords(o)&&(ot.shouldBuildUnpublishedAuthorFilter(o,r.author)&&s.push(t.buildUnpublishedRecordsByQueryAuthorFilter(r)),ot.shouldProtocolAuthorize(r.signaturePayload)&&s.push(t.buildUnpublishedProtocolAuthorizedRecordsFilter(r)),ot.shouldBuildUnpublishedRecipientFilter(o,r.author)&&s.push(t.buildUnpublishedRecordsForQueryAuthorFilter(r)));let a=this.convertDateSort(n);return this.messageStore.query(e,s,a,i)})}fetchPublishedRecords(e,r){return VS(this,void 0,void 0,function*(){let{dateSort:n,pagination:i}=r.message.descriptor,o=t.buildPublishedRecordsFilter(r),s=this.convertDateSort(n);return this.messageStore.query(e,[o],s,i)})}static buildPublishedRecordsFilter(e){let{dateSort:r,filter:n}=e.message.descriptor;return Object.assign(Object.assign({},ot.convertFilter(n,r)),{interface:Oe.Records,method:Ae.Write,published:!0,isLatestBaseState:!0})}static buildUnpublishedRecordsForQueryAuthorFilter(e){let{dateSort:r,filter:n}=e.message.descriptor;return Object.assign(Object.assign({},ot.convertFilter(n,r)),{interface:Oe.Records,method:Ae.Write,recipient:e.author,isLatestBaseState:!0,published:!1})}static buildUnpublishedProtocolAuthorizedRecordsFilter(e){let{dateSort:r,filter:n}=e.message.descriptor;return Object.assign(Object.assign({},ot.convertFilter(n,r)),{interface:Oe.Records,method:Ae.Write,isLatestBaseState:!0,published:!1})}static buildUnpublishedRecordsByQueryAuthorFilter(e){let{dateSort:r,filter:n}=e.message.descriptor;return Object.assign(Object.assign({},ot.convertFilter(n,r)),{author:e.author,interface:Oe.Records,method:Ae.Write,isLatestBaseState:!0,published:!1})}static authorizeRecordsQuery(e,r,n){return VS(this,void 0,void 0,function*(){_e.isSignedByAuthorDelegate(r.message)&&(yield r.authorizeDelegate(n)),ot.shouldProtocolAuthorize(r.signaturePayload)&&(yield rd.authorizeQueryOrSubscribe(e,r,n))})}};f();f();var XK=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Lv=class t extends Qi{static parse(e){return XK(this,void 0,void 0,function*(){let r;return e.authorization!==void 0&&(r=yield _e.validateSignatureStructure(e.authorization.signature,e.descriptor)),yield ot.validateDelegatedGrantReferentialIntegrity(e,r),mr.validateTimestamp(e.descriptor.messageTimestamp),new t(e)})}static create(e){var r;return XK(this,void 0,void 0,function*(){let{filter:n,signer:i,permissionGrantId:o,protocolRole:s}=e,a=mr.getCurrentTimestamp(),d={interface:Oe.Records,method:Ae.Read,filter:ot.normalizeFilter(n),messageTimestamp:(r=e.messageTimestamp)!==null&&r!==void 0?r:a};On(d);let u;i!==void 0&&(u=yield _e.createAuthorization({descriptor:d,signer:i,permissionGrantId:o,protocolRole:s,delegatedGrant:e.delegatedGrant}));let c={descriptor:d,authorization:u};return _e.validateJsonSchema(c),new t(c)})}authorizeDelegate(e,r){return XK(this,void 0,void 0,function*(){let n=yield ei.parse(this.message.authorization.authorDelegatedGrant);yield ps.authorizeRead({recordsReadMessage:this.message,recordsWriteMessageToBeRead:e,expectedGrantor:this.author,expectedGrantee:this.signer,permissionGrant:n,messageStore:r})})}};var Mpe=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},UP=class t{constructor(e,r,n){this.didResolver=e,this.messageStore=r,this.dataStore=n}handle({tenant:e,message:r}){return Mpe(this,void 0,void 0,function*(){let n;try{n=yield Lv.parse(r)}catch(c){return gr(c,400)}try{n.author!==void 0&&(yield Ni(r.authorization,this.didResolver))}catch(c){return gr(c,401)}let i=Object.assign({interface:Oe.Records,isLatestBaseState:!0},ot.convertFilter(r.descriptor.filter)),{messages:o}=yield this.messageStore.query(e,[i]);if(o.length===0)return{status:{code:404,detail:"Not Found"}};if(o.length>1)return gr(new de(se.RecordsReadReturnedMultiple,"Multiple records exist for the RecordsRead filter"),400);let s=o[0];try{yield t.authorizeRecordsRead(e,n,yield Vr.parse(s),this.messageStore)}catch(c){return gr(c,401)}let a;if(s.encodedData!==void 0){let c=Ke.base64UrlToBytes(s.encodedData);a=il.fromBytes(c),delete s.encodedData}else{let c=yield this.dataStore.get(e,s.recordId,s.descriptor.dataCid);if(c?.dataStream===void 0)return{status:{code:404,detail:"Not Found"}};a=c.dataStream}let d=Object.assign(Object.assign({},s),{data:a});if(!(yield Vr.isInitialWrite(d))){let l=(yield this.messageStore.query(e,[{recordId:d.recordId,isLatestBaseState:!1,method:Ae.Write}])).messages[0];delete l.encodedData,d.initialWrite=l}return{status:{code:200,detail:"OK"},record:d}})}static authorizeRecordsRead(e,r,n,i){return Mpe(this,void 0,void 0,function*(){_e.isSignedByAuthorDelegate(r.message)&&(yield r.authorizeDelegate(n.message,i));let{descriptor:o}=n.message;if(r.author!==e){if(o.published===!0)return;if(r.author!==void 0&&r.author===o.recipient)return;if(r.author!==void 0&&r.signaturePayload.permissionGrantId!==void 0){let s=yield gt.fetchGrant(e,i,r.signaturePayload.permissionGrantId);yield ps.authorizeRead({recordsReadMessage:r.message,recordsWriteMessageToBeRead:n.message,expectedGrantor:e,expectedGrantee:r.author,permissionGrant:s,messageStore:i})}else if(o.protocol!==void 0)yield rd.authorizeRead(e,r,n,i);else throw new de(se.RecordsReadAuthorizationFailed,"message failed authorization")}})}};f();f();var QK=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Nm=class t extends Qi{static parse(e){return QK(this,void 0,void 0,function*(){let r;if(e.authorization!==void 0&&(r=yield _e.validateSignatureStructure(e.authorization.signature,e.descriptor)),yield ot.validateDelegatedGrantReferentialIntegrity(e,r),r?.protocolRole!==void 0&&e.descriptor.filter.protocolPath===void 0)throw new de(se.RecordsSubscribeFilterMissingRequiredProperties,"Role-authorized subscriptions must include `protocolPath` in the filter");return e.descriptor.filter.protocol!==void 0&&ua(e.descriptor.filter.protocol),e.descriptor.filter.schema!==void 0&&um(e.descriptor.filter.schema),mr.validateTimestamp(e.descriptor.messageTimestamp),new t(e)})}static create(e){var r;return QK(this,void 0,void 0,function*(){let n={interface:Oe.Records,method:Ae.Subscribe,messageTimestamp:(r=e.messageTimestamp)!==null&&r!==void 0?r:mr.getCurrentTimestamp(),filter:ot.normalizeFilter(e.filter)};On(n);let i=e.signer,o;i&&(o=yield _e.createAuthorization({descriptor:n,signer:i,protocolRole:e.protocolRole,delegatedGrant:e.delegatedGrant}));let s={descriptor:n,authorization:o};return _e.validateJsonSchema(s),new t(s)})}authorizeDelegate(e){return QK(this,void 0,void 0,function*(){let r=yield ei.parse(this.message.authorization.authorDelegatedGrant);yield ps.authorizeQueryOrSubscribe({incomingMessage:this.message,expectedGrantor:this.author,expectedGrantee:this.signer,permissionGrant:r,messageStore:e})})}};var KP=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},qP=class t{constructor(e,r,n){this.didResolver=e,this.messageStore=r,this.eventStream=n}handle({tenant:e,message:r,subscriptionHandler:n}){return KP(this,void 0,void 0,function*(){if(this.eventStream===void 0)return gr(new de(se.RecordsSubscribeEventStreamUnimplemented,"Subscriptions are not supported"),501);let i;try{i=yield Nm.parse(r)}catch(u){return gr(u,400)}let o=[];if(ot.filterIncludesPublishedRecords(i.message.descriptor.filter)&&i.author===void 0)o=[t.buildPublishedRecordsFilter(i)],delete r.authorization;else{try{yield Ni(r.authorization,this.didResolver),yield t.authorizeRecordsSubscribe(e,i,this.messageStore)}catch(u){return gr(u,401)}i.author===e?o=yield t.filterAsOwner(i):o=yield t.filterAsNonOwner(i)}let s=(u,c,l)=>{e===u&&ti.matchAnyFilter(l,o)&&n(c)},a=yield _e.getCid(r),d=yield this.eventStream.subscribe(e,a,s);return{status:{code:200,detail:"OK"},subscription:d}})}static filterAsOwner(e){return KP(this,void 0,void 0,function*(){let{filter:r}=e.message.descriptor;return[Object.assign(Object.assign({},ot.convertFilter(r)),{interface:Oe.Records,method:[Ae.Write,Ae.Delete]})]})}static filterAsNonOwner(e){return KP(this,void 0,void 0,function*(){let r=[],{filter:n}=e.message.descriptor;return ot.filterIncludesPublishedRecords(n)&&r.push(t.buildPublishedRecordsFilter(e)),ot.filterIncludesUnpublishedRecords(n)&&(ot.shouldBuildUnpublishedAuthorFilter(n,e.author)&&r.push(t.buildUnpublishedRecordsBySubscribeAuthorFilter(e)),ot.shouldProtocolAuthorize(e.signaturePayload)&&r.push(t.buildUnpublishedProtocolAuthorizedRecordsFilter(e)),ot.shouldBuildUnpublishedRecipientFilter(n,e.author)&&r.push(t.buildUnpublishedRecordsForSubscribeAuthorFilter(e))),r})}static buildPublishedRecordsFilter(e){return Object.assign(Object.assign({},ot.convertFilter(e.message.descriptor.filter)),{interface:Oe.Records,method:[Ae.Write,Ae.Delete],published:!0})}static buildUnpublishedRecordsForSubscribeAuthorFilter(e){return Object.assign(Object.assign({},ot.convertFilter(e.message.descriptor.filter)),{interface:Oe.Records,method:[Ae.Write,Ae.Delete],recipient:e.author,published:!1})}static buildUnpublishedProtocolAuthorizedRecordsFilter(e){return Object.assign(Object.assign({},ot.convertFilter(e.message.descriptor.filter)),{interface:Oe.Records,method:[Ae.Write,Ae.Delete],published:!1})}static buildUnpublishedRecordsBySubscribeAuthorFilter(e){return Object.assign(Object.assign({},ot.convertFilter(e.message.descriptor.filter)),{author:e.author,interface:Oe.Records,method:[Ae.Write,Ae.Delete],published:!1})}static authorizeRecordsSubscribe(e,r,n){return KP(this,void 0,void 0,function*(){_e.isSignedByAuthorDelegate(r.message)&&(yield r.authorizeDelegate(n)),ot.shouldProtocolAuthorize(r.signaturePayload)&&(yield rd.authorizeQueryOrSubscribe(e,r,n))})}};f();f();var Rf=class{};Rf.maxDataSizeAllowedToBeEncoded=3e4;f();var HS=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},$2=class t{constructor({messageStore:e,dataStore:r,eventLog:n,eventStream:i}){this.messageStore=e,this.dataStore=r,this.eventLog=n,this.eventStream=i}performRecordsDelete({tenant:e,message:r}){return HS(this,void 0,void 0,function*(){let n={interface:Oe.Records,recordId:r.descriptor.recordId},{messages:i}=yield this.messageStore.query(e,[n]),o=yield _e.getNewestMessage(i);if(!ot.canPerformDeleteAgainstRecord(r,o))return;let s=yield If.parse(r),a=yield Vr.getInitialWrite(i),d=s.constructIndexes(a),u=yield _e.getCid(r);yield this.messageStore.put(e,r,d),yield this.eventLog.append(e,u,d),this.eventStream!==void 0&&this.eventStream.emit(e,{message:r,initialWrite:a},d),r.descriptor.prune&&(yield t.purgeRecordDescendants(e,r.descriptor.recordId,this.messageStore,this.dataStore,this.eventLog)),yield t.deleteAllOlderMessagesButKeepInitialWrite(e,i,r,this.messageStore,this.dataStore,this.eventLog)})}static deleteFromDataStoreIfNeeded(e,r,n,i){return HS(this,void 0,void 0,function*(){if(n.descriptor.method!==Ae.Write)return;let o=n;o.descriptor.dataSize<=Rf.maxDataSizeAllowedToBeEncoded||o.descriptor.dataCid!==i.descriptor.dataCid&&(yield e.delete(r,o.recordId,o.descriptor.dataCid))})}static purgeRecordDescendants(e,r,n,i,o){return HS(this,void 0,void 0,function*(){let s={interface:Oe.Records,parentId:r},{messages:a}=yield n.query(e,[s]),d=new Map;for(let u of a){let c;ot.isRecordsWrite(u)?c=u.recordId:c=u.descriptor.recordId,d.has(c)||d.set(c,[]),d.get(c).push(u)}for(let u of d.keys())yield t.purgeRecordDescendants(e,u,n,i,o);for(let u of d.keys())yield t.purgeRecordMessages(e,d.get(u),n,i,o)})}static purgeRecordMessages(e,r,n,i,o){return HS(this,void 0,void 0,function*(){let s=r.filter(u=>u.descriptor.method===Ae.Write),a=yield _e.getNewestMessage(s);yield i.delete(e,a.recordId,a.descriptor.dataCid);let d=yield Promise.all(r.map(u=>_e.getCid(u)));yield o.deleteEventsByCid(e,d),yield Promise.all(d.map(u=>n.delete(e,u)))})}static deleteAllOlderMessagesButKeepInitialWrite(e,r,n,i,o,s){return HS(this,void 0,void 0,function*(){let a=[];for(let d of r){if(yield _e.isOlder(d,n)){yield t.deleteFromDataStoreIfNeeded(o,e,d,n);let c=yield _e.getCid(d);if(yield i.delete(e,c),yield Vr.isInitialWrite(d)){let h=yield Vr.parse(d),y=!1,g=yield h.constructIndexes(y),v=d;delete v.encodedData,yield i.put(e,v,g)}else{let h=yield _e.getCid(d);a.push(h)}}yield s.deleteEventsByCid(e,a)}})}};var Fv=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},LP=class t{constructor(e,r,n,i,o){this.didResolver=e,this.messageStore=r,this.dataStore=n,this.eventLog=i,this.eventStream=o}handle({tenant:e,message:r,dataStream:n}){return Fv(this,void 0,void 0,function*(){let i;try{i=yield Vr.parse(r),r.descriptor.protocol!==void 0&&(yield rd.validateReferentialIntegrity(e,i,this.messageStore))}catch(y){return gr(y,400)}try{yield Ni(r.authorization,this.didResolver),yield t.authorizeRecordsWrite(e,i,this.messageStore)}catch(y){return gr(y,401)}let o={interface:Oe.Records,recordId:r.recordId},{messages:s}=yield this.messageStore.query(e,[o]),a=yield i.isInitialWrite(),d;if(!a)try{d=yield Vr.getInitialWrite(s),Vr.verifyEqualityOfImmutableProperties(d,r)}catch(y){return gr(y,400)}let u=yield _e.getNewestMessage(s),c=!1,l;if(u===void 0||(yield _e.isNewer(r,u))?(c=!0,l=r):l=u,!c)return{status:{code:409,detail:"Conflict"}};try{if(u?.descriptor.method===Ae.Delete)throw new de(se.RecordsWriteNotAllowedAfterDelete,"RecordsWrite is not allowed after a RecordsDelete.");yield this.preProcessingForCoreRecordsWrite(e,r);let y=!1,g=r;if(n!==void 0)g=yield this.processMessageWithDataStream(e,r,n),y=!0;else if(!a){let x=u;g=yield this.processMessageWithoutDataStream(e,r,x),y=!0}let v=yield i.constructIndexes(y);yield this.messageStore.put(e,g,v),yield this.eventLog.append(e,yield _e.getCid(r),v),this.eventStream!==void 0&&y&&this.eventStream.emit(e,{message:r,initialWrite:d},v)}catch(y){let g=y;if(g.code!==void 0&&(g.code===se.RecordsWriteMissingEncodedDataInPrevious||g.code===se.RecordsWriteMissingDataInPrevious||g.code===se.RecordsWriteNotAllowedAfterDelete||g.code===se.RecordsWriteDataCidMismatch||g.code===se.RecordsWriteDataSizeMismatch||g.code.startsWith("PermissionsProtocolValidate")||g.code.startsWith("SchemaValidator")))return gr(y,400);throw y}let h={status:a&&n===void 0?{code:204,detail:"No Content"}:{code:202,detail:"Accepted"}};return yield $2.deleteAllOlderMessagesButKeepInitialWrite(e,s,l,this.messageStore,this.dataStore,this.eventLog),yield this.postProcessingForCoreRecordsWrite(e,i),h})}preProcessingForCoreRecordsWrite(e,r){var n;return Fv(this,void 0,void 0,function*(){if(r.descriptor.protocol===gt.uri&&r.descriptor.protocolPath===gt.revocationPath){let i=r.descriptor.parentId,o=yield gt.fetchGrant(e,this.messageStore,i),s=(n=r.descriptor.tags)===null||n===void 0?void 0:n.protocol,a="protocol"in o.scope?o.scope.protocol:void 0;if(a!==s)throw new de(se.PermissionsProtocolValidateRevocationProtocolTagMismatch,`Revocation protocol ${s} does not match grant protocol ${a}`)}})}static validateSchemaForCoreRecordsWrite(e,r){e.descriptor.protocol===gt.uri&&gt.validateSchema(e,r)}postProcessingForCoreRecordsWrite(e,r){return Fv(this,void 0,void 0,function*(){if(r.message.descriptor.protocol===gt.uri&&r.message.descriptor.protocolPath===gt.revocationPath){let i={permissionGrantId:r.message.descriptor.parentId,dateCreated:{gte:r.message.descriptor.messageTimestamp}},{messages:o}=yield this.messageStore.query(e,[i]),s=[];for(let a of o){let d=yield _e.getCid(a);yield this.messageStore.delete(e,d)}this.eventLog.deleteEventsByCid(e,s)}})}cloneAndAddEncodedData(e,r){return Fv(this,void 0,void 0,function*(){let n=Object.assign({},e);return n.encodedData=Ke.bytesToBase64Url(r),n})}processMessageWithDataStream(e,r,n){return Fv(this,void 0,void 0,function*(){let i=r;if(r.descriptor.dataSize<=Rf.maxDataSizeAllowedToBeEncoded){let o=yield il.toBytes(n),s=yield vn.computeDagPbCidFromBytes(o);t.validateDataIntegrity(r.descriptor.dataCid,r.descriptor.dataSize,s,o.length),t.validateSchemaForCoreRecordsWrite(r,o),i=yield this.cloneAndAddEncodedData(r,o)}else{let[o,s]=il.duplicateDataStream(n,2);try{let[a,d]=yield Promise.all([vn.computeDagPbCidFromStream(o),this.dataStore.put(e,r.recordId,r.descriptor.dataCid,s)]);t.validateDataIntegrity(r.descriptor.dataCid,r.descriptor.dataSize,a,d.dataSize)}catch(a){throw yield this.dataStore.delete(e,r.recordId,r.descriptor.dataCid),a}}return i})}processMessageWithoutDataStream(e,r,n){return Fv(this,void 0,void 0,function*(){let i=Object.assign({},r),{dataCid:o,dataSize:s}=r.descriptor;if(t.validateDataIntegrity(o,s,n.descriptor.dataCid,n.descriptor.dataSize),s<=Rf.maxDataSizeAllowedToBeEncoded)if(n.encodedData!==void 0)i.encodedData=n.encodedData;else throw new de(se.RecordsWriteMissingEncodedDataInPrevious,"No dataStream was provided and unable to get data from previous message");else if((yield this.dataStore.get(e,n.recordId,r.descriptor.dataCid))===void 0)throw new de(se.RecordsWriteMissingDataInPrevious,"No dataStream was provided and unable to get data from previous message");return i})}static validateDataIntegrity(e,r,n,i){if(e!==n)throw new de(se.RecordsWriteDataCidMismatch,`actual data CID ${n} does not match dataCid in descriptor: ${e}`);if(r!==i)throw new de(se.RecordsWriteDataSizeMismatch,`actual data size ${i} bytes does not match dataSize in descriptor: ${r}`)}static authorizeRecordsWrite(e,r,n){return Fv(this,void 0,void 0,function*(){if(r.owner!==void 0&&r.owner!==e)throw new de(se.RecordsWriteOwnerAndTenantMismatch,`Owner ${r.owner} must be the same as tenant ${e} when specified.`);if(r.isSignedByAuthorDelegate&&(yield r.authorizeAuthorDelegate(n)),r.isSignedByOwnerDelegate&&(yield r.authorizeOwnerDelegate(n)),r.owner===void 0){if(r.author===e)return;if(r.author!==void 0&&r.signaturePayload.permissionGrantId!==void 0){let i=yield gt.fetchGrant(e,n,r.signaturePayload.permissionGrantId);yield ps.authorizeWrite({recordsWriteMessage:r.message,expectedGrantor:e,expectedGrantee:r.author,permissionGrant:i,messageStore:n})}else if(r.message.descriptor.protocol!==void 0)yield rd.authorizeWrite(e,r,n);else throw new de(se.RecordsWriteAuthorizationFailed,"message failed authorization")}})}};f();f();var zv;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})(zv||(zv={}));f();var hi={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};f();var Tr=class t{constructor({method:e,id:r,path:n,query:i,fragment:o,params:s}){this.uri=`did:${e}:${r}`,this.method=e,this.id=r,this.path=n,this.query=i,this.fragment=o,this.params=s}static parse(e){if(!e)return null;let r=t.DID_URI_PATTERN.exec(e);if(!r||!r.groups)return null;let{method:n,id:i,path:o,query:s,fragment:a}=r.groups,d={uri:`did:${n}:${i}`,method:n,id:i};if(o&&(d.path=o),s&&(d.query=s.slice(1)),a&&(d.fragment=a.slice(1)),s){let u={},c=s.slice(1).split("&");for(let l of c){let[h,y]=l.split("=");u[h]=y}d.params=u}return d}};Tr.METHOD_PATTERN="([a-z0-9]+)";Tr.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";Tr.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${Tr.PCT_ENCODED_PATTERN})`;Tr.METHOD_ID_PATTERN=`((?:${Tr.ID_CHAR_PATTERN}*:)*(${Tr.ID_CHAR_PATTERN}+))`;Tr.PATH_PATTERN="(/[^#?]*)?";Tr.QUERY_PATTERN="([?][^#]*)?";Tr.FRAGMENT_PATTERN="(#.*)?";Tr.DID_URI_PATTERN=new RegExp(`^did:(?<method>${Tr.METHOD_PATTERN}):(?<id>${Tr.METHOD_ID_PATTERN})(?<path>${Tr.PATH_PATTERN})(?<query>${Tr.QUERY_PATTERN})(?<fragment>${Tr.FRAGMENT_PATTERN})$`);f();var ct=class t extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t)}},tt;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(tt||(tt={}));f();f();f();f();f();var hWe=xt(rq(),1);f();f();function Cpe(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function jpe(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function WS(t){let r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,i]=r;return i}var GS=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},$pe=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,d){s=t[o](s),i(a,d,s.done,s.value)})}}function i(o,s,a,d){Promise.resolve(d).then(function(u){o({value:u,done:a})},s)}},zP=new TextEncoder,Vv=new TextDecoder,Se=class t{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new t(e,"ArrayBuffer")}static asyncIterable(e){if(!jpe(e))throw new TypeError("Input must be of type AsyncIterable.");return new t(e,"AsyncIterable")}static base32Z(e){return new t(e,"Base32Z")}static base58Btc(e){return new t(e,"Base58Btc")}static base64Url(e){return new t(e,"Base64Url")}static bufferSource(e){return new t(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new t(e,"Hex")}static multibase(e){return new t(e,"Multibase")}static object(e){return new t(e,"Object")}static string(e){return new t(e,"String")}static uint8Array(e){return new t(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return Aa.baseDecode(this.data).buffer;case"Base64Url":return Tu.baseDecode(this.data).buffer;case"BufferSource":{if(WS(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return Cpe(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return GS(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return P8.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{let e=new Uint8Array(this.data);return Aa.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return Aa.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{let e=new Uint8Array(this.data);return Tu.baseEncode(e)}case"BufferSource":{let e=this.toUint8Array();return Tu.baseEncode(e)}case"Object":{let e=JSON.stringify(this.data),r=zP.encode(e);return Tu.baseEncode(r)}case"String":{let e=zP.encode(this.data);return Tu.baseEncode(e)}case"Uint8Array":return Tu.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){return GS(this,void 0,void 0,function*(){var e,r,n,i;switch(this.format){case"AsyncIterable":{let d=[];try{for(var o=!0,s=$pe(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;let c=i;d.push(c)}}catch(c){r={error:c}}finally{try{!o&&!e&&(n=s.return)&&(yield n.call(s))}finally{if(r)throw r.error}}return new Blob(d)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){let e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{let r=this.toUint8Array();return t.uint8Array(r).toHex()}case"Base64Url":{let r=this.toUint8Array();return t.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{let e=Tu.baseDecode(this.data),r=Vv.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{let e=Vv.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return GS(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return Vv.decode(this.data);case"Base64Url":{let e=Tu.baseDecode(this.data);return Vv.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return Vv.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){return GS(this,void 0,void 0,function*(){var e,r,n,i;switch(this.format){case"AsyncIterable":{let d="";try{for(var o=!0,s=$pe(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;let u=i;typeof u=="string"?d+=u:d+=Vv.decode(u,{stream:!0})}}catch(u){r={error:u}}finally{try{!o&&!e&&(n=s.return)&&(yield n.call(s))}finally{if(r)throw r.error}}return d+=Vv.decode(void 0,{stream:!1}),d}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return P8.baseDecode(this.data);case"Base58Btc":return Aa.baseDecode(this.data);case"Base64Url":return Tu.baseDecode(this.data);case"BufferSource":{let e=WS(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{let e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){let n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{let e=JSON.stringify(this.data);return zP.encode(e)}case"String":return zP.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return GS(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};f();var Bf=class t{static addPrefix(e){var r;let{code:n,data:i,name:o}=e;if(!(o?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=t.codeToName.has(n)?n:t.nameToCode.get(o),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);let s=jl.encodingLength(n),a=new Uint8Array(s+i.byteLength);return a.set(i,s),jl.encodeTo(n,a),a}static getCodeFromData(e){let{prefixedData:r}=e,[n,i]=jl.decode(r);return n}static getCodeFromName(e){let{name:r}=e,n=t.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){let{code:r}=e,n=t.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){t.codeToName.set(e.code,e.name),t.nameToCode.set(e.name,e.code)}static removePrefix(e){let{prefixedData:r}=e,[n,i]=jl.decode(r),o=t.codeToName.get(n);if(o===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(i),name:o}}};Bf.codeToName=new Map;Bf.nameToCode=new Map;Bf.registerCodec({code:237,name:"ed25519-pub"});Bf.registerCodec({code:4864,name:"ed25519-priv"});Bf.registerCodec({code:236,name:"x25519-pub"});Bf.registerCodec({code:4866,name:"x25519-priv"});Bf.registerCodec({code:231,name:"secp256k1-pub"});Bf.registerCodec({code:4865,name:"secp256k1-priv"});f();function JS(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&JS(t[e])})}f();var hGe=xt(m5(),1),sb=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};var G2=class{constructor(){this.store=new Map}clear(){return sb(this,void 0,void 0,function*(){this.store.clear()})}close(){return sb(this,void 0,void 0,function*(){})}delete(e){return sb(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return sb(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return sb(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return sb(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return sb(this,void 0,void 0,function*(){this.store.set(e,r)})}};f();f();var GXe=xt(A5(),1);var JXe=xt(A5(),1);f();f();var YXe=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},n_=class{static digest(e){return YXe(this,arguments,void 0,function*({data:r}){return To(r)})}};f();var qf=class{};var ZXe=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},FI=class extends qf{digest(e){return ZXe(this,arguments,void 0,function*({algorithm:r,data:n}){switch(r){case"SHA-256":return yield n_.digest({data:n})}})}};f();f();f();f();f();f();function Ym(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`Wrong positive integer: ${t}`)}function XXe(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function xp(t,...e){if(!XXe(t))throw new Error("Expected Uint8Array");if(e.length>0&&!e.includes(t.length))throw new Error(`Expected Uint8Array of length ${e}, not of length=${t.length}`)}function zI(t){if(typeof t!="function"||typeof t.create!="function")throw new Error("Hash should be wrapped by utils.wrapConstructor");Ym(t.outputLen),Ym(t.blockLen)}function i_(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function fge(t,e){xp(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}f();f();var o_=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;function eF(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}var Sp=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),pl=(t,e)=>t<<32-e|t>>>e,QXe=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!QXe)throw new Error("Non little-endian hardware is not supported");var eQe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function tF(t){if(!eF(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=eQe[t[r]];return e}var Ep={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function hge(t){if(t>=Ep._0&&t<=Ep._9)return t-Ep._0;if(t>=Ep._A&&t<=Ep._F)return t-(Ep._A-10);if(t>=Ep._a&&t<=Ep._f)return t-(Ep._a-10)}function pge(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let i=0,o=0;i<r;i++,o+=2){let s=hge(t.charCodeAt(o)),a=hge(t.charCodeAt(o+1));if(s===void 0||a===void 0){let d=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+o)}n[i]=s*16+a}return n}var tQe=async()=>{};async function yge(t,e,r){let n=Date.now();for(let i=0;i<t;i++){r(i);let o=Date.now()-n;o>=0&&o<e||(await tQe(),n+=o)}}function k5(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function Zm(t){if(typeof t=="string"&&(t=k5(t)),!eF(t))throw new Error(`expected Uint8Array, got ${typeof t}`);return t}function gb(...t){let e=0;for(let n=0;n<t.length;n++){let i=t[n];if(!eF(i))throw new Error("Uint8Array expected");e+=i.length}let r=new Uint8Array(e);for(let n=0,i=0;n<t.length;n++){let o=t[n];r.set(o,i),i+=o.length}return r}var s_=class{clone(){return this._cloneInto()}},rQe={}.toString;function mge(t,e){if(e!==void 0&&rQe.call(e)!=="[object Object]")throw new Error("Options should be object or undefined");return Object.assign(t,e)}function a_(t){let e=n=>t().update(Zm(n)).digest(),r=t();return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=()=>t(),e}function Tp(t=32){if(o_&&typeof o_.getRandomValues=="function")return o_.getRandomValues(new Uint8Array(t));throw new Error("crypto.getRandomValues must be defined")}function nQe(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),d=n?4:0,u=n?0:4;t.setUint32(e+d,s,n),t.setUint32(e+u,a,n)}var Xm=class extends s_{constructor(e,r,n,i){super(),this.blockLen=e,this.outputLen=r,this.padOffset=n,this.isLE=i,this.finished=!1,this.length=0,this.pos=0,this.destroyed=!1,this.buffer=new Uint8Array(e),this.view=Sp(this.buffer)}update(e){i_(this);let{view:r,buffer:n,blockLen:i}=this;e=Zm(e);let o=e.length;for(let s=0;s<o;){let a=Math.min(i-this.pos,o-s);if(a===i){let d=Sp(e);for(;i<=o-s;s+=i)this.process(d,s);continue}n.set(e.subarray(s,s+a),this.pos),this.pos+=a,s+=a,this.pos===i&&(this.process(r,0),this.pos=0)}return this.length+=e.length,this.roundClean(),this}digestInto(e){i_(this),fge(e,this),this.finished=!0;let{buffer:r,view:n,blockLen:i,isLE:o}=this,{pos:s}=this;r[s++]=128,this.buffer.subarray(s).fill(0),this.padOffset>i-s&&(this.process(n,0),s=0);for(let l=s;l<i;l++)r[l]=0;nQe(n,i-8,BigInt(this.length*8),o),this.process(n,0);let a=Sp(e),d=this.outputLen;if(d%4)throw new Error("_sha2: outputLen should be aligned to 32bit");let u=d/4,c=this.get();if(u>c.length)throw new Error("_sha2: outputLen bigger than state");for(let l=0;l<u;l++)a.setUint32(4*l,c[l],o)}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}_cloneInto(e){e||(e=new this.constructor),e.set(...this.get());let{blockLen:r,buffer:n,length:i,finished:o,destroyed:s,pos:a}=this;return e.length=i,e.pos=a,e.finished=o,e.destroyed=s,i%r&&e.buffer.set(n),e}};var iQe=(t,e,r)=>t&e^~t&r,oQe=(t,e,r)=>t&e^t&r^e&r,sQe=new Uint32Array([1116352408,1899447441,3049323471,3921009573,961987163,1508970993,2453635748,2870763221,3624381080,310598401,607225278,1426881987,1925078388,2162078206,2614888103,3248222580,3835390401,4022224774,264347078,604807628,770255983,1249150122,1555081692,1996064986,2554220882,2821834349,2952996808,3210313671,3336571891,3584528711,113926993,338241895,666307205,773529912,1294757372,1396182291,1695183700,1986661051,2177026350,2456956037,2730485921,2820302411,3259730800,3345764771,3516065817,3600352804,4094571909,275423344,430227734,506948616,659060556,883997877,958139571,1322822218,1537002063,1747873779,1955562222,2024104815,2227730452,2361852424,2428436474,2756734187,3204031479,3329325298]),Qm=new Uint32Array([1779033703,3144134277,1013904242,2773480762,1359893119,2600822924,528734635,1541459225]),e0=new Uint32Array(64),rF=class extends Xm{constructor(){super(64,32,8,!1),this.A=Qm[0]|0,this.B=Qm[1]|0,this.C=Qm[2]|0,this.D=Qm[3]|0,this.E=Qm[4]|0,this.F=Qm[5]|0,this.G=Qm[6]|0,this.H=Qm[7]|0}get(){let{A:e,B:r,C:n,D:i,E:o,F:s,G:a,H:d}=this;return[e,r,n,i,o,s,a,d]}set(e,r,n,i,o,s,a,d){this.A=e|0,this.B=r|0,this.C=n|0,this.D=i|0,this.E=o|0,this.F=s|0,this.G=a|0,this.H=d|0}process(e,r){for(let l=0;l<16;l++,r+=4)e0[l]=e.getUint32(r,!1);for(let l=16;l<64;l++){let h=e0[l-15],y=e0[l-2],g=pl(h,7)^pl(h,18)^h>>>3,v=pl(y,17)^pl(y,19)^y>>>10;e0[l]=v+e0[l-7]+g+e0[l-16]|0}let{A:n,B:i,C:o,D:s,E:a,F:d,G:u,H:c}=this;for(let l=0;l<64;l++){let h=pl(a,6)^pl(a,11)^pl(a,25),y=c+h+iQe(a,d,u)+sQe[l]+e0[l]|0,v=(pl(n,2)^pl(n,13)^pl(n,22))+oQe(n,i,o)|0;c=u,u=d,d=a,a=s+y|0,s=o,o=i,i=n,n=y+v|0}n=n+this.A|0,i=i+this.B|0,o=o+this.C|0,s=s+this.D|0,a=a+this.E|0,d=d+this.F|0,u=u+this.G|0,c=c+this.H|0,this.set(n,i,o,s,a,d,u,c)}roundClean(){e0.fill(0)}destroy(){this.set(0,0,0,0,0,0,0,0),this.buffer.fill(0)}};var ya=a_(()=>new rF);f();var HI={};Or(HI,{bitGet:()=>hQe,bitLen:()=>fQe,bitMask:()=>P5,bitSet:()=>pQe,bytesToHex:()=>kp,bytesToNumberBE:()=>Pp,bytesToNumberLE:()=>ml,concatBytes:()=>Rp,createHmacDrbg:()=>oF,ensureBytes:()=>Jn,equalBytes:()=>uQe,hexToBytes:()=>vb,hexToNumber:()=>iF,isBytes:()=>yl,numberToBytesBE:()=>Fn,numberToBytesLE:()=>Ip,numberToHexUnpadded:()=>wge,numberToVarBytesBE:()=>dQe,utf8ToBytes:()=>lQe,validateObject:()=>ou});f();var bge=BigInt(0),VI=BigInt(1),aQe=BigInt(2);function yl(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}var cQe=Array.from({length:256},(t,e)=>e.toString(16).padStart(2,"0"));function kp(t){if(!yl(t))throw new Error("Uint8Array expected");let e="";for(let r=0;r<t.length;r++)e+=cQe[t[r]];return e}function wge(t){let e=t.toString(16);return e.length&1?`0${e}`:e}function iF(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);return BigInt(t===""?"0":`0x${t}`)}var Ap={_0:48,_9:57,_A:65,_F:70,_a:97,_f:102};function gge(t){if(t>=Ap._0&&t<=Ap._9)return t-Ap._0;if(t>=Ap._A&&t<=Ap._F)return t-(Ap._A-10);if(t>=Ap._a&&t<=Ap._f)return t-(Ap._a-10)}function vb(t){if(typeof t!="string")throw new Error("hex string expected, got "+typeof t);let e=t.length,r=e/2;if(e%2)throw new Error("padded hex string expected, got unpadded hex of length "+e);let n=new Uint8Array(r);for(let i=0,o=0;i<r;i++,o+=2){let s=gge(t.charCodeAt(o)),a=gge(t.charCodeAt(o+1));if(s===void 0||a===void 0){let d=t[o]+t[o+1];throw new Error('hex string expected, got non-hex character "'+d+'" at index '+o)}n[i]=s*16+a}return n}function Pp(t){return iF(kp(t))}function ml(t){if(!yl(t))throw new Error("Uint8Array expected");return iF(kp(Uint8Array.from(t).reverse()))}function Fn(t,e){return vb(t.toString(16).padStart(e*2,"0"))}function Ip(t,e){return Fn(t,e).reverse()}function dQe(t){return vb(wge(t))}function Jn(t,e,r){let n;if(typeof e=="string")try{n=vb(e)}catch(o){throw new Error(`${t} must be valid hex string, got "${e}". Cause: ${o}`)}else if(yl(e))n=Uint8Array.from(e);else throw new Error(`${t} must be hex string or Uint8Array`);let i=n.length;if(typeof r=="number"&&i!==r)throw new Error(`${t} expected ${r} bytes, got ${i}`);return n}function Rp(...t){let e=0;for(let i=0;i<t.length;i++){let o=t[i];if(!yl(o))throw new Error("Uint8Array expected");e+=o.length}let r=new Uint8Array(e),n=0;for(let i=0;i<t.length;i++){let o=t[i];r.set(o,n),n+=o.length}return r}function uQe(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}function lQe(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function fQe(t){let e;for(e=0;t>bge;t>>=VI,e+=1);return e}function hQe(t,e){return t>>BigInt(e)&VI}var pQe=(t,e,r)=>t|(r?VI:bge)<<BigInt(e),P5=t=>(aQe<<BigInt(t-1))-VI,nF=t=>new Uint8Array(t),vge=t=>Uint8Array.from(t);function oF(t,e,r){if(typeof t!="number"||t<2)throw new Error("hashLen must be a number");if(typeof e!="number"||e<2)throw new Error("qByteLen must be a number");if(typeof r!="function")throw new Error("hmacFn must be a function");let n=nF(t),i=nF(t),o=0,s=()=>{n.fill(1),i.fill(0),o=0},a=(...l)=>r(i,n,...l),d=(l=nF())=>{i=a(vge([0]),l),n=a(),l.length!==0&&(i=a(vge([1]),l),n=a())},u=()=>{if(o++>=1e3)throw new Error("drbg: tried 1000 values");let l=0,h=[];for(;l<e;){n=a();let y=n.slice();h.push(y),l+=n.length}return Rp(...h)};return(l,h)=>{s(),d(l);let y;for(;!(y=h(u()));)d();return s(),y}}var yQe={bigint:t=>typeof t=="bigint",function:t=>typeof t=="function",boolean:t=>typeof t=="boolean",string:t=>typeof t=="string",stringOrUint8Array:t=>typeof t=="string"||yl(t),isSafeInteger:t=>Number.isSafeInteger(t),array:t=>Array.isArray(t),field:(t,e)=>e.Fp.isValid(t),hash:t=>typeof t=="function"&&Number.isSafeInteger(t.outputLen)};function ou(t,e,r={}){let n=(i,o,s)=>{let a=yQe[o];if(typeof a!="function")throw new Error(`Invalid validator "${o}", expected function`);let d=t[i];if(!(s&&d===void 0)&&!a(d,t))throw new Error(`Invalid param ${String(i)}=${d} (${typeof d}), expected ${o}`)};for(let[i,o]of Object.entries(e))n(i,o,!1);for(let[i,o]of Object.entries(r))n(i,o,!0);return t}var mo=BigInt(0),ii=BigInt(1),bb=BigInt(2),mQe=BigInt(3),sF=BigInt(4),_ge=BigInt(5),xge=BigInt(8),gQe=BigInt(9),vQe=BigInt(16);function on(t,e){let r=t%e;return r>=mo?r:e+r}function aF(t,e,r){if(r<=mo||e<mo)throw new Error("Expected power/modulo > 0");if(r===ii)return mo;let n=ii;for(;e>mo;)e&ii&&(n=n*t%r),t=t*t%r,e>>=ii;return n}function Yn(t,e,r){let n=t;for(;e-- >mo;)n*=n,n%=r;return n}function WI(t,e){if(t===mo||e<=mo)throw new Error(`invert: expected positive integers, got n=${t} mod=${e}`);let r=on(t,e),n=e,i=mo,o=ii,s=ii,a=mo;for(;r!==mo;){let u=n/r,c=n%r,l=i-s*u,h=o-a*u;n=r,r=c,i=s,o=a,s=l,a=h}if(n!==ii)throw new Error("invert: does not exist");return on(i,e)}function bQe(t){let e=(t-ii)/bb,r,n,i;for(r=t-ii,n=0;r%bb===mo;r/=bb,n++);for(i=bb;i<t&&aF(i,e,t)!==t-ii;i++);if(n===1){let s=(t+ii)/sF;return function(d,u){let c=d.pow(u,s);if(!d.eql(d.sqr(c),u))throw new Error("Cannot find square root");return c}}let o=(r+ii)/bb;return function(a,d){if(a.pow(d,e)===a.neg(a.ONE))throw new Error("Cannot find square root");let u=n,c=a.pow(a.mul(a.ONE,i),r),l=a.pow(d,o),h=a.pow(d,r);for(;!a.eql(h,a.ONE);){if(a.eql(h,a.ZERO))return a.ZERO;let y=1;for(let v=a.sqr(h);y<u&&!a.eql(v,a.ONE);y++)v=a.sqr(v);let g=a.pow(c,ii<<BigInt(u-y-1));c=a.sqr(g),l=a.mul(l,g),h=a.mul(h,c),u=y}return l}}function wQe(t){if(t%sF===mQe){let e=(t+ii)/sF;return function(n,i){let o=n.pow(i,e);if(!n.eql(n.sqr(o),i))throw new Error("Cannot find square root");return o}}if(t%xge===_ge){let e=(t-_ge)/xge;return function(n,i){let o=n.mul(i,bb),s=n.pow(o,e),a=n.mul(i,s),d=n.mul(n.mul(a,bb),s),u=n.mul(a,n.sub(d,n.ONE));if(!n.eql(n.sqr(u),i))throw new Error("Cannot find square root");return u}}return t%vQe,bQe(t)}var Ege=(t,e)=>(on(t,e)&ii)===ii,_Qe=["create","isValid","is0","neg","inv","sqrt","sqr","eql","add","sub","mul","pow","div","addN","subN","mulN","sqrN"];function cF(t){let e={ORDER:"bigint",MASK:"bigint",BYTES:"isSafeInteger",BITS:"isSafeInteger"},r=_Qe.reduce((n,i)=>(n[i]="function",n),e);return ou(t,r)}function xQe(t,e,r){if(r<mo)throw new Error("Expected power > 0");if(r===mo)return t.ONE;if(r===ii)return e;let n=t.ONE,i=e;for(;r>mo;)r&ii&&(n=t.mul(n,i)),i=t.sqr(i),r>>=ii;return n}function EQe(t,e){let r=new Array(e.length),n=e.reduce((o,s,a)=>t.is0(s)?o:(r[a]=o,t.mul(o,s)),t.ONE),i=t.inv(n);return e.reduceRight((o,s,a)=>t.is0(s)?o:(r[a]=t.mul(o,r[a]),t.mul(o,s)),i),r}function dF(t,e){let r=e!==void 0?e:t.toString(2).length,n=Math.ceil(r/8);return{nBitLength:r,nByteLength:n}}function c_(t,e,r=!1,n={}){if(t<=mo)throw new Error(`Expected Field ORDER > 0, got ${t}`);let{nBitLength:i,nByteLength:o}=dF(t,e);if(o>2048)throw new Error("Field lengths over 2048 bytes are not supported");let s=wQe(t),a=Object.freeze({ORDER:t,BITS:i,BYTES:o,MASK:P5(i),ZERO:mo,ONE:ii,create:d=>on(d,t),isValid:d=>{if(typeof d!="bigint")throw new Error(`Invalid field element: expected bigint, got ${typeof d}`);return mo<=d&&d<t},is0:d=>d===mo,isOdd:d=>(d&ii)===ii,neg:d=>on(-d,t),eql:(d,u)=>d===u,sqr:d=>on(d*d,t),add:(d,u)=>on(d+u,t),sub:(d,u)=>on(d-u,t),mul:(d,u)=>on(d*u,t),pow:(d,u)=>xQe(a,d,u),div:(d,u)=>on(d*WI(u,t),t),sqrN:d=>d*d,addN:(d,u)=>d+u,subN:(d,u)=>d-u,mulN:(d,u)=>d*u,inv:d=>WI(d,t),sqrt:n.sqrt||(d=>s(a,d)),invertBatch:d=>EQe(a,d),cmov:(d,u,c)=>c?u:d,toBytes:d=>r?Ip(d,o):Fn(d,o),fromBytes:d=>{if(d.length!==o)throw new Error(`Fp.fromBytes: expected ${o}, got ${d.length}`);return r?ml(d):Pp(d)}});return Object.freeze(a)}function Sge(t,e){if(!t.isOdd)throw new Error("Field doesn't have isOdd");let r=t.sqrt(e);return t.isOdd(r)?t.neg(r):r}function Tge(t){if(typeof t!="bigint")throw new Error("field order must be bigint");let e=t.toString(2).length;return Math.ceil(e/8)}function uF(t){let e=Tge(t);return e+Math.ceil(e/2)}function Age(t,e,r=!1){let n=t.length,i=Tge(e),o=uF(e);if(n<16||n<o||n>1024)throw new Error(`expected ${o}-1024 bytes of input, got ${n}`);let s=r?Pp(t):ml(t),a=on(s,e-ii)+ii;return r?Ip(a,i):Fn(a,i)}f();f();var TQe=BigInt(0),lF=BigInt(1);function GI(t,e){let r=(i,o)=>{let s=o.negate();return i?s:o},n=i=>{let o=Math.ceil(e/i)+1,s=2**(i-1);return{windows:o,windowSize:s}};return{constTimeNegate:r,unsafeLadder(i,o){let s=t.ZERO,a=i;for(;o>TQe;)o&lF&&(s=s.add(a)),a=a.double(),o>>=lF;return s},precomputeWindow(i,o){let{windows:s,windowSize:a}=n(o),d=[],u=i,c=u;for(let l=0;l<s;l++){c=u,d.push(c);for(let h=1;h<a;h++)c=c.add(u),d.push(c);u=c.double()}return d},wNAF(i,o,s){let{windows:a,windowSize:d}=n(i),u=t.ZERO,c=t.BASE,l=BigInt(2**i-1),h=2**i,y=BigInt(i);for(let g=0;g<a;g++){let v=g*d,x=Number(s&l);s>>=y,x>d&&(x-=h,s+=lF);let S=v,A=v+Math.abs(x)-1,T=g%2!==0,$=x<0;x===0?c=c.add(r(T,o[S])):u=u.add(r($,o[A]))}return{p:u,f:c}},wNAFCached(i,o,s,a){let d=i._WINDOW_SIZE||1,u=o.get(i);return u||(u=this.precomputeWindow(i,d),d!==1&&o.set(i,a(u))),this.wNAF(d,u,s)}}}function I5(t){return cF(t.Fp),ou(t,{n:"bigint",h:"bigint",Gx:"field",Gy:"field"},{nBitLength:"isSafeInteger",nByteLength:"isSafeInteger"}),Object.freeze({...dF(t.n,t.nBitLength),...t,p:t.Fp.ORDER})}function AQe(t){let e=I5(t);ou(e,{a:"field",b:"field"},{allowedPrivateKeyLengths:"array",wrapPrivateKey:"boolean",isTorsionFree:"function",clearCofactor:"function",allowInfinityPoint:"boolean",fromBytes:"function",toBytes:"function"});let{endo:r,Fp:n,a:i}=e;if(r){if(!n.eql(i,n.ZERO))throw new Error("Endomorphism can only be defined for Koblitz curves that have a=0");if(typeof r!="object"||typeof r.beta!="bigint"||typeof r.splitScalar!="function")throw new Error("Expected endomorphism with beta: bigint and splitScalar: function")}return Object.freeze({...e})}var{bytesToNumberBE:kQe,hexToBytes:PQe}=HI,wb={Err:class extends Error{constructor(e=""){super(e)}},_parseInt(t){let{Err:e}=wb;if(t.length<2||t[0]!==2)throw new e("Invalid signature integer tag");let r=t[1],n=t.subarray(2,r+2);if(!r||n.length!==r)throw new e("Invalid signature integer: wrong length");if(n[0]&128)throw new e("Invalid signature integer: negative");if(n[0]===0&&!(n[1]&128))throw new e("Invalid signature integer: unnecessary leading zero");return{d:kQe(n),l:t.subarray(r+2)}},toSig(t){let{Err:e}=wb,r=typeof t=="string"?PQe(t):t;if(!yl(r))throw new Error("ui8a expected");let n=r.length;if(n<2||r[0]!=48)throw new e("Invalid signature tag");if(r[1]!==n-2)throw new e("Invalid signature: incorrect length");let{d:i,l:o}=wb._parseInt(r.subarray(2)),{d:s,l:a}=wb._parseInt(o);if(a.length)throw new e("Invalid signature: left bytes after parsing");return{r:i,s}},hexFromSig(t){let e=u=>Number.parseInt(u[0],16)&8?"00"+u:u,r=u=>{let c=u.toString(16);return c.length&1?`0${c}`:c},n=e(r(t.s)),i=e(r(t.r)),o=n.length/2,s=i.length/2,a=r(o),d=r(s);return`30${r(s+o+4)}02${d}${i}02${a}${n}`}},Bp=BigInt(0),su=BigInt(1),VRt=BigInt(2),kge=BigInt(3),HRt=BigInt(4);function IQe(t){let e=AQe(t),{Fp:r}=e,n=e.toBytes||((g,v,x)=>{let S=v.toAffine();return Rp(Uint8Array.from([4]),r.toBytes(S.x),r.toBytes(S.y))}),i=e.fromBytes||(g=>{let v=g.subarray(1),x=r.fromBytes(v.subarray(0,r.BYTES)),S=r.fromBytes(v.subarray(r.BYTES,2*r.BYTES));return{x,y:S}});function o(g){let{a:v,b:x}=e,S=r.sqr(g),A=r.mul(S,g);return r.add(r.add(A,r.mul(g,v)),x)}if(!r.eql(r.sqr(e.Gy),o(e.Gx)))throw new Error("bad generator point: equation left != right");function s(g){return typeof g=="bigint"&&Bp<g&&g<e.n}function a(g){if(!s(g))throw new Error("Expected valid bigint: 0 < bigint < curve.n")}function d(g){let{allowedPrivateKeyLengths:v,nByteLength:x,wrapPrivateKey:S,n:A}=e;if(v&&typeof g!="bigint"){if(yl(g)&&(g=kp(g)),typeof g!="string"||!v.includes(g.length))throw new Error("Invalid key");g=g.padStart(x*2,"0")}let T;try{T=typeof g=="bigint"?g:Pp(Jn("private key",g,x))}catch{throw new Error(`private key must be ${x} bytes, hex or bigint, not ${typeof g}`)}return S&&(T=on(T,A)),a(T),T}let u=new Map;function c(g){if(!(g instanceof l))throw new Error("ProjectivePoint expected")}class l{constructor(v,x,S){if(this.px=v,this.py=x,this.pz=S,v==null||!r.isValid(v))throw new Error("x required");if(x==null||!r.isValid(x))throw new Error("y required");if(S==null||!r.isValid(S))throw new Error("z required")}static fromAffine(v){let{x,y:S}=v||{};if(!v||!r.isValid(x)||!r.isValid(S))throw new Error("invalid affine point");if(v instanceof l)throw new Error("projective point not allowed");let A=T=>r.eql(T,r.ZERO);return A(x)&&A(S)?l.ZERO:new l(x,S,r.ONE)}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static normalizeZ(v){let x=r.invertBatch(v.map(S=>S.pz));return v.map((S,A)=>S.toAffine(x[A])).map(l.fromAffine)}static fromHex(v){let x=l.fromAffine(i(Jn("pointHex",v)));return x.assertValidity(),x}static fromPrivateKey(v){return l.BASE.multiply(d(v))}_setWindowSize(v){this._WINDOW_SIZE=v,u.delete(this)}assertValidity(){if(this.is0()){if(e.allowInfinityPoint&&!r.is0(this.py))return;throw new Error("bad point: ZERO")}let{x:v,y:x}=this.toAffine();if(!r.isValid(v)||!r.isValid(x))throw new Error("bad point: x or y not FE");let S=r.sqr(x),A=o(v);if(!r.eql(S,A))throw new Error("bad point: equation left != right");if(!this.isTorsionFree())throw new Error("bad point: not in prime-order subgroup")}hasEvenY(){let{y:v}=this.toAffine();if(r.isOdd)return!r.isOdd(v);throw new Error("Field doesn't support isOdd")}equals(v){c(v);let{px:x,py:S,pz:A}=this,{px:T,py:$,pz:j}=v,K=r.eql(r.mul(x,j),r.mul(T,A)),F=r.eql(r.mul(S,j),r.mul($,A));return K&&F}negate(){return new l(this.px,r.neg(this.py),this.pz)}double(){let{a:v,b:x}=e,S=r.mul(x,kge),{px:A,py:T,pz:$}=this,j=r.ZERO,K=r.ZERO,F=r.ZERO,L=r.mul(A,A),V=r.mul(T,T),q=r.mul($,$),k=r.mul(A,T);return k=r.add(k,k),F=r.mul(A,$),F=r.add(F,F),j=r.mul(v,F),K=r.mul(S,q),K=r.add(j,K),j=r.sub(V,K),K=r.add(V,K),K=r.mul(j,K),j=r.mul(k,j),F=r.mul(S,F),q=r.mul(v,q),k=r.sub(L,q),k=r.mul(v,k),k=r.add(k,F),F=r.add(L,L),L=r.add(F,L),L=r.add(L,q),L=r.mul(L,k),K=r.add(K,L),q=r.mul(T,$),q=r.add(q,q),L=r.mul(q,k),j=r.sub(j,L),F=r.mul(q,V),F=r.add(F,F),F=r.add(F,F),new l(j,K,F)}add(v){c(v);let{px:x,py:S,pz:A}=this,{px:T,py:$,pz:j}=v,K=r.ZERO,F=r.ZERO,L=r.ZERO,V=e.a,q=r.mul(e.b,kge),k=r.mul(x,T),P=r.mul(S,$),B=r.mul(A,j),p=r.add(x,S),m=r.add(T,$);p=r.mul(p,m),m=r.add(k,P),p=r.sub(p,m),m=r.add(x,A);let w=r.add(T,j);return m=r.mul(m,w),w=r.add(k,B),m=r.sub(m,w),w=r.add(S,A),K=r.add($,j),w=r.mul(w,K),K=r.add(P,B),w=r.sub(w,K),L=r.mul(V,m),K=r.mul(q,B),L=r.add(K,L),K=r.sub(P,L),L=r.add(P,L),F=r.mul(K,L),P=r.add(k,k),P=r.add(P,k),B=r.mul(V,B),m=r.mul(q,m),P=r.add(P,B),B=r.sub(k,B),B=r.mul(V,B),m=r.add(m,B),k=r.mul(P,m),F=r.add(F,k),k=r.mul(w,m),K=r.mul(p,K),K=r.sub(K,k),k=r.mul(p,P),L=r.mul(w,L),L=r.add(L,k),new l(K,F,L)}subtract(v){return this.add(v.negate())}is0(){return this.equals(l.ZERO)}wNAF(v){return y.wNAFCached(this,u,v,x=>{let S=r.invertBatch(x.map(A=>A.pz));return x.map((A,T)=>A.toAffine(S[T])).map(l.fromAffine)})}multiplyUnsafe(v){let x=l.ZERO;if(v===Bp)return x;if(a(v),v===su)return this;let{endo:S}=e;if(!S)return y.unsafeLadder(this,v);let{k1neg:A,k1:T,k2neg:$,k2:j}=S.splitScalar(v),K=x,F=x,L=this;for(;T>Bp||j>Bp;)T&su&&(K=K.add(L)),j&su&&(F=F.add(L)),L=L.double(),T>>=su,j>>=su;return A&&(K=K.negate()),$&&(F=F.negate()),F=new l(r.mul(F.px,S.beta),F.py,F.pz),K.add(F)}multiply(v){a(v);let x=v,S,A,{endo:T}=e;if(T){let{k1neg:$,k1:j,k2neg:K,k2:F}=T.splitScalar(x),{p:L,f:V}=this.wNAF(j),{p:q,f:k}=this.wNAF(F);L=y.constTimeNegate($,L),q=y.constTimeNegate(K,q),q=new l(r.mul(q.px,T.beta),q.py,q.pz),S=L.add(q),A=V.add(k)}else{let{p:$,f:j}=this.wNAF(x);S=$,A=j}return l.normalizeZ([S,A])[0]}multiplyAndAddUnsafe(v,x,S){let A=l.BASE,T=(j,K)=>K===Bp||K===su||!j.equals(A)?j.multiplyUnsafe(K):j.multiply(K),$=T(this,x).add(T(v,S));return $.is0()?void 0:$}toAffine(v){let{px:x,py:S,pz:A}=this,T=this.is0();v==null&&(v=T?r.ONE:r.inv(A));let $=r.mul(x,v),j=r.mul(S,v),K=r.mul(A,v);if(T)return{x:r.ZERO,y:r.ZERO};if(!r.eql(K,r.ONE))throw new Error("invZ was invalid");return{x:$,y:j}}isTorsionFree(){let{h:v,isTorsionFree:x}=e;if(v===su)return!0;if(x)return x(l,this);throw new Error("isTorsionFree() has not been declared for the elliptic curve")}clearCofactor(){let{h:v,clearCofactor:x}=e;return v===su?this:x?x(l,this):this.multiplyUnsafe(e.h)}toRawBytes(v=!0){return this.assertValidity(),n(l,this,v)}toHex(v=!0){return kp(this.toRawBytes(v))}}l.BASE=new l(e.Gx,e.Gy,r.ONE),l.ZERO=new l(r.ZERO,r.ONE,r.ZERO);let h=e.nBitLength,y=GI(l,e.endo?Math.ceil(h/2):h);return{CURVE:e,ProjectivePoint:l,normPrivateKeyToScalar:d,weierstrassEquation:o,isWithinCurveOrder:s}}function RQe(t){let e=I5(t);return ou(e,{hash:"hash",hmac:"function",randomBytes:"function"},{bits2int:"function",bits2int_modN:"function",lowS:"boolean"}),Object.freeze({lowS:!0,...e})}function Pge(t){let e=RQe(t),{Fp:r,n}=e,i=r.BYTES+1,o=2*r.BYTES+1;function s(m){return Bp<m&&m<r.ORDER}function a(m){return on(m,n)}function d(m){return WI(m,n)}let{ProjectivePoint:u,normPrivateKeyToScalar:c,weierstrassEquation:l,isWithinCurveOrder:h}=IQe({...e,toBytes(m,w,E){let _=w.toAffine(),b=r.toBytes(_.x),C=Rp;return E?C(Uint8Array.from([w.hasEvenY()?2:3]),b):C(Uint8Array.from([4]),b,r.toBytes(_.y))},fromBytes(m){let w=m.length,E=m[0],_=m.subarray(1);if(w===i&&(E===2||E===3)){let b=Pp(_);if(!s(b))throw new Error("Point is not on curve");let C=l(b),N=r.sqrt(C),D=(N&su)===su;return(E&1)===1!==D&&(N=r.neg(N)),{x:b,y:N}}else if(w===o&&E===4){let b=r.fromBytes(_.subarray(0,r.BYTES)),C=r.fromBytes(_.subarray(r.BYTES,2*r.BYTES));return{x:b,y:C}}else throw new Error(`Point of length ${w} was invalid. Expected ${i} compressed bytes or ${o} uncompressed bytes`)}}),y=m=>kp(Fn(m,e.nByteLength));function g(m){let w=n>>su;return m>w}function v(m){return g(m)?a(-m):m}let x=(m,w,E)=>Pp(m.slice(w,E));class S{constructor(w,E,_){this.r=w,this.s=E,this.recovery=_,this.assertValidity()}static fromCompact(w){let E=e.nByteLength;return w=Jn("compactSignature",w,E*2),new S(x(w,0,E),x(w,E,2*E))}static fromDER(w){let{r:E,s:_}=wb.toSig(Jn("DER",w));return new S(E,_)}assertValidity(){if(!h(this.r))throw new Error("r must be 0 < r < CURVE.n");if(!h(this.s))throw new Error("s must be 0 < s < CURVE.n")}addRecoveryBit(w){return new S(this.r,this.s,w)}recoverPublicKey(w){let{r:E,s:_,recovery:b}=this,C=F(Jn("msgHash",w));if(b==null||![0,1,2,3].includes(b))throw new Error("recovery id invalid");let N=b===2||b===3?E+e.n:E;if(N>=r.ORDER)throw new Error("recovery id 2 or 3 invalid");let D=b&1?"03":"02",U=u.fromHex(D+y(N)),G=d(N),Y=a(-C*G),J=a(_*G),H=u.BASE.multiplyAndAddUnsafe(U,Y,J);if(!H)throw new Error("point at infinify");return H.assertValidity(),H}hasHighS(){return g(this.s)}normalizeS(){return this.hasHighS()?new S(this.r,a(-this.s),this.recovery):this}toDERRawBytes(){return vb(this.toDERHex())}toDERHex(){return wb.hexFromSig({r:this.r,s:this.s})}toCompactRawBytes(){return vb(this.toCompactHex())}toCompactHex(){return y(this.r)+y(this.s)}}let A={isValidPrivateKey(m){try{return c(m),!0}catch{return!1}},normPrivateKeyToScalar:c,randomPrivateKey:()=>{let m=uF(e.n);return Age(e.randomBytes(m),e.n)},precompute(m=8,w=u.BASE){return w._setWindowSize(m),w.multiply(BigInt(3)),w}};function T(m,w=!0){return u.fromPrivateKey(m).toRawBytes(w)}function $(m){let w=yl(m),E=typeof m=="string",_=(w||E)&&m.length;return w?_===i||_===o:E?_===2*i||_===2*o:m instanceof u}function j(m,w,E=!0){if($(m))throw new Error("first arg must be private key");if(!$(w))throw new Error("second arg must be public key");return u.fromHex(w).multiply(c(m)).toRawBytes(E)}let K=e.bits2int||function(m){let w=Pp(m),E=m.length*8-e.nBitLength;return E>0?w>>BigInt(E):w},F=e.bits2int_modN||function(m){return a(K(m))},L=P5(e.nBitLength);function V(m){if(typeof m!="bigint")throw new Error("bigint expected");if(!(Bp<=m&&m<L))throw new Error(`bigint expected < 2^${e.nBitLength}`);return Fn(m,e.nByteLength)}function q(m,w,E=k){if(["recovered","canonical"].some(te=>te in E))throw new Error("sign() legacy options not supported");let{hash:_,randomBytes:b}=e,{lowS:C,prehash:N,extraEntropy:D}=E;C==null&&(C=!0),m=Jn("msgHash",m),N&&(m=Jn("prehashed msgHash",_(m)));let U=F(m),G=c(w),Y=[V(G),V(U)];if(D!=null){let te=D===!0?b(r.BYTES):D;Y.push(Jn("extraEntropy",te))}let J=Rp(...Y),H=U;function X(te){let ne=K(te);if(!h(ne))return;let Q=d(ne),re=u.BASE.multiply(ne).toAffine(),ae=a(re.x);if(ae===Bp)return;let he=a(Q*a(H+ae*G));if(he===Bp)return;let ge=(re.x===ae?0:2)|Number(re.y&su),ie=he;return C&&g(he)&&(ie=v(he),ge^=1),new S(ae,ie,ge)}return{seed:J,k2sig:X}}let k={lowS:e.lowS,prehash:!1},P={lowS:e.lowS,prehash:!1};function B(m,w,E=k){let{seed:_,k2sig:b}=q(m,w,E),C=e;return oF(C.hash.outputLen,C.nByteLength,C.hmac)(_,b)}u.BASE._setWindowSize(8);function p(m,w,E,_=P){let b=m;if(w=Jn("msgHash",w),E=Jn("publicKey",E),"strict"in _)throw new Error("options.strict was renamed to lowS");let{lowS:C,prehash:N}=_,D,U;try{if(typeof b=="string"||yl(b))try{D=S.fromDER(b)}catch(re){if(!(re instanceof wb.Err))throw re;D=S.fromCompact(b)}else if(typeof b=="object"&&typeof b.r=="bigint"&&typeof b.s=="bigint"){let{r:re,s:ae}=b;D=new S(re,ae)}else throw new Error("PARSE");U=u.fromHex(E)}catch(re){if(re.message==="PARSE")throw new Error("signature must be Signature instance, Uint8Array or hex string");return!1}if(C&&D.hasHighS())return!1;N&&(w=e.hash(w));let{r:G,s:Y}=D,J=F(w),H=d(Y),X=a(J*H),te=a(G*H),ne=u.BASE.multiplyAndAddUnsafe(U,X,te)?.toAffine();return ne?a(ne.x)===G:!1}return{CURVE:e,getPublicKey:T,getSharedSecret:j,sign:B,verify:p,ProjectivePoint:u,Signature:S,utils:A}}f();f();var JI=class extends s_{constructor(e,r){super(),this.finished=!1,this.destroyed=!1,zI(e);let n=Zm(r);if(this.iHash=e.create(),typeof this.iHash.update!="function")throw new Error("Expected instance of class which extends utils.Hash");this.blockLen=this.iHash.blockLen,this.outputLen=this.iHash.outputLen;let i=this.blockLen,o=new Uint8Array(i);o.set(n.length>i?e.create().update(n).digest():n);for(let s=0;s<o.length;s++)o[s]^=54;this.iHash.update(o),this.oHash=e.create();for(let s=0;s<o.length;s++)o[s]^=106;this.oHash.update(o),o.fill(0)}update(e){return i_(this),this.iHash.update(e),this}digestInto(e){i_(this),xp(e,this.outputLen),this.finished=!0,this.iHash.digestInto(e),this.oHash.update(e),this.oHash.digestInto(e),this.destroy()}digest(){let e=new Uint8Array(this.oHash.outputLen);return this.digestInto(e),e}_cloneInto(e){e||(e=Object.create(Object.getPrototypeOf(this),{}));let{oHash:r,iHash:n,finished:i,destroyed:o,blockLen:s,outputLen:a}=this;return e=e,e.finished=i,e.destroyed=o,e.blockLen=s,e.outputLen=a,e.oHash=r._cloneInto(e.oHash),e.iHash=n._cloneInto(e.iHash),e}destroy(){this.destroyed=!0,this.oHash.destroy(),this.iHash.destroy()}},t0=(t,e,r)=>new JI(t,e).update(r).digest();t0.create=(t,e)=>new JI(t,e);function BQe(t){return{hash:t,hmac:(e,...r)=>t0(t,e,gb(...r)),randomBytes:Tp}}function YI(t,e){let r=n=>Pge({...t,...BQe(n)});return Object.freeze({...r(e),create:r})}var Bge=BigInt("0xfffffffffffffffffffffffffffffffffffffffffffffffffffffffefffffc2f"),Ige=BigInt("0xfffffffffffffffffffffffffffffffebaaedce6af48a03bbfd25e8cd0364141"),OQe=BigInt(1),fF=BigInt(2),Rge=(t,e)=>(t+e/fF)/e;function MQe(t){let e=Bge,r=BigInt(3),n=BigInt(6),i=BigInt(11),o=BigInt(22),s=BigInt(23),a=BigInt(44),d=BigInt(88),u=t*t*t%e,c=u*u*t%e,l=Yn(c,r,e)*c%e,h=Yn(l,r,e)*c%e,y=Yn(h,fF,e)*u%e,g=Yn(y,i,e)*y%e,v=Yn(g,o,e)*g%e,x=Yn(v,a,e)*v%e,S=Yn(x,d,e)*x%e,A=Yn(S,a,e)*v%e,T=Yn(A,r,e)*c%e,$=Yn(T,s,e)*g%e,j=Yn($,n,e)*u%e,K=Yn(j,fF,e);if(!hF.eql(hF.sqr(K),t))throw new Error("Cannot find square root");return K}var hF=c_(Bge,void 0,void 0,{sqrt:MQe}),br=YI({a:BigInt(0),b:BigInt(7),Fp:hF,n:Ige,Gx:BigInt("55066263022277343669578718895168534326250603453777594175500187360389116729240"),Gy:BigInt("32670510020758816978083085130507043184471273380659243275938904335757337482424"),h:BigInt(1),lowS:!0,endo:{beta:BigInt("0x7ae96a2b657c07106e64479eac3434e99cf0497512f58995c1396c28719501ee"),splitScalar:t=>{let e=Ige,r=BigInt("0x3086d221a7d46bcde86c90e49284eb15"),n=-OQe*BigInt("0xe4437ed6010e88286f547fa90abfe4c3"),i=BigInt("0x114ca50f7a8e2f3f657c1108d9d44cfd8"),o=r,s=BigInt("0x100000000000000000000000000000000"),a=Rge(o*t,e),d=Rge(-n*t,e),u=on(t-a*r-d*i,e),c=on(-a*n-d*o,e),l=u>s,h=c>s;if(l&&(u=e-u),h&&(c=e-c),u>s||c>s)throw new Error("splitScalar: Endomorphism failed, k="+t);return{k1neg:l,k1:u,k2neg:h,k2:c}}}},ya),aBt=BigInt(0);var cBt=br.ProjectivePoint;f();f();function Oge(t){let e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){let i=Object.keys(n).sort(),o={};for(let s of i)o[s]=e(n[s]);return o}return n},r=e(t);return JSON.stringify(r)}var DQe=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},pF="urn:jwk:";function wr(t){return DQe(this,arguments,void 0,function*({jwk:e}){let r=e.kty,n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);JS(n);let i=Oge(n),o=Se.string(i).toUint8Array(),s=yield n_.digest({data:o});return Se.uint8Array(s).toBase64Url()})}function Lf(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function d_(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function Ff(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function u_(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function Mge(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var Bs=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},CQe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Vo=class t{static adjustSignatureToLowS(e){return Bs(this,arguments,void 0,function*({signature:r}){let n=br.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return Bs(this,arguments,void 0,function*({privateKeyBytes:r}){let n=yield t.getCurvePoint({keyBytes:r}),i={kty:"EC",crv:"secp256k1",d:Se.uint8Array(r).toBase64Url(),x:Se.uint8Array(n.x).toBase64Url(),y:Se.uint8Array(n.y).toBase64Url()};return i.kid=yield wr({jwk:i}),i})}static bytesToPublicKey(e){return Bs(this,arguments,void 0,function*({publicKeyBytes:r}){let n=yield t.getCurvePoint({keyBytes:r}),i={kty:"EC",crv:"secp256k1",x:Se.uint8Array(n.x).toBase64Url(),y:Se.uint8Array(n.y).toBase64Url()};return i.kid=yield wr({jwk:i}),i})}static compressPublicKey(e){return Bs(this,arguments,void 0,function*({publicKeyBytes:r}){return br.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return Bs(this,arguments,void 0,function*({key:r}){let n=yield t.privateKeyToBytes({privateKey:r}),i=yield t.getCurvePoint({keyBytes:n}),o={kty:"EC",crv:"secp256k1",x:Se.uint8Array(i.x).toBase64Url(),y:Se.uint8Array(i.y).toBase64Url()};return o.kid=yield wr({jwk:o}),o})}static convertDerToCompactSignature(e){return Bs(this,arguments,void 0,function*({derSignature:r}){return br.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return Bs(this,arguments,void 0,function*({publicKeyBytes:r}){return br.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return Bs(this,void 0,void 0,function*(){let e=br.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield wr({jwk:r}),r})}static getPublicKey(e){return Bs(this,arguments,void 0,function*({key:r}){var n;if(!(Lf(r)&&r.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let{d:i}=r,o=CQe(r,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield wr({jwk:o})),o})}static privateKeyToBytes(e){return Bs(this,arguments,void 0,function*({privateKey:r}){if(!Lf(r))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return Se.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return Bs(this,arguments,void 0,function*({publicKey:r}){if(!(d_(r)&&r.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");let n=new Uint8Array([4]),i=Se.base64Url(r.x).toUint8Array(),o=Se.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...i,...o])})}static sharedSecret(e){return Bs(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let i=yield t.privateKeyToBytes({privateKey:r}),o=yield t.publicKeyToBytes({publicKey:n});return br.getSharedSecret(i,o,!0).slice(1)})}static sign(e){return Bs(this,arguments,void 0,function*({data:r,key:n}){let i=yield t.privateKeyToBytes({privateKey:n}),o=To(r);return br.sign(o,i).toCompactRawBytes()})}static validatePrivateKey(e){return Bs(this,arguments,void 0,function*({privateKeyBytes:r}){return br.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return Bs(this,arguments,void 0,function*({publicKeyBytes:r}){try{br.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return Bs(this,arguments,void 0,function*({key:r,signature:n,data:i}){let o=yield t.publicKeyToBytes({publicKey:r}),s=To(i);return br.verify(n,s,o,{lowS:!1})})}static getCurvePoint(e){return Bs(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=br.getPublicKey(r));let n=br.ProjectivePoint.fromHex(r),i=Fn(n.x,32),o=Fn(n.y,32);return{x:i,y:o}})}};f();f();var Dge=c_(BigInt("0xffffffff00000001000000000000000000000000ffffffffffffffffffffffff")),jQe=Dge.create(BigInt("-3")),$Qe=BigInt("0x5ac635d8aa3a93e7b3ebbd55769886bc651d06b0cc53b0f63bce3c3e27d2604b"),NQe=YI({a:jQe,b:$Qe,Fp:Dge,n:BigInt("0xffffffff00000000ffffffffffffffffbce6faada7179e84f3b9cac2fc632551"),Gx:BigInt("0x6b17d1f2e12c4247f8bce6e563a440f277037d812deb33a0f4a13945d898c296"),Gy:BigInt("0x4fe342e2fe1a7f9b8ee7eb4a7c0f9e162bce33576b315ececbb6406837bf51f5"),h:BigInt(1),lowS:!1},ya),kr=NQe;var Os=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},UQe=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Ms=class t{static adjustSignatureToLowS(e){return Os(this,arguments,void 0,function*({signature:r}){let n=kr.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return Os(this,arguments,void 0,function*({privateKeyBytes:r}){let n=yield t.getCurvePoint({keyBytes:r}),i={kty:"EC",crv:"P-256",d:Se.uint8Array(r).toBase64Url(),x:Se.uint8Array(n.x).toBase64Url(),y:Se.uint8Array(n.y).toBase64Url()};return i.kid=yield wr({jwk:i}),i})}static bytesToPublicKey(e){return Os(this,arguments,void 0,function*({publicKeyBytes:r}){let n=yield t.getCurvePoint({keyBytes:r}),i={kty:"EC",crv:"P-256",x:Se.uint8Array(n.x).toBase64Url(),y:Se.uint8Array(n.y).toBase64Url()};return i.kid=yield wr({jwk:i}),i})}static compressPublicKey(e){return Os(this,arguments,void 0,function*({publicKeyBytes:r}){return kr.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return Os(this,arguments,void 0,function*({key:r}){let n=yield t.privateKeyToBytes({privateKey:r}),i=yield t.getCurvePoint({keyBytes:n}),o={kty:"EC",crv:"P-256",x:Se.uint8Array(i.x).toBase64Url(),y:Se.uint8Array(i.y).toBase64Url()};return o.kid=yield wr({jwk:o}),o})}static convertDerToCompactSignature(e){return Os(this,arguments,void 0,function*({derSignature:r}){return kr.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return Os(this,arguments,void 0,function*({publicKeyBytes:r}){return kr.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return Os(this,void 0,void 0,function*(){let e=kr.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield wr({jwk:r}),r})}static getPublicKey(e){return Os(this,arguments,void 0,function*({key:r}){var n;if(!(Lf(r)&&r.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let{d:i}=r,o=UQe(r,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield wr({jwk:o})),o})}static privateKeyToBytes(e){return Os(this,arguments,void 0,function*({privateKey:r}){if(!Lf(r))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return Se.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return Os(this,arguments,void 0,function*({publicKey:r}){if(!(d_(r)&&r.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");let n=new Uint8Array([4]),i=Se.base64Url(r.x).toUint8Array(),o=Se.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...i,...o])})}static sharedSecret(e){return Os(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let i=yield t.privateKeyToBytes({privateKey:r}),o=yield t.publicKeyToBytes({publicKey:n});return kr.getSharedSecret(i,o,!0).slice(1)})}static sign(e){return Os(this,arguments,void 0,function*({data:r,key:n}){let i=yield t.privateKeyToBytes({privateKey:n}),o=To(r);return kr.sign(o,i).toCompactRawBytes()})}static validatePrivateKey(e){return Os(this,arguments,void 0,function*({privateKeyBytes:r}){return kr.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return Os(this,arguments,void 0,function*({publicKeyBytes:r}){try{kr.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return Os(this,arguments,void 0,function*({key:r,signature:n,data:i}){let o=yield t.publicKeyToBytes({publicKey:r}),s=To(i);return kr.verify(n,s,o,{lowS:!1})})}static getCurvePoint(e){return Os(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=kr.getPublicKey(r));let n=kr.ProjectivePoint.fromHex(r),i=Fn(n.x,32),o=Fn(n.y,32);return{x:i,y:o}})}};var R5=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},B5=class extends qf{computePublicKey(e){return R5(this,arguments,void 0,function*({key:r}){if(!Lf(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{let n=yield Vo.computePublicKey({key:r});return n.alg="ES256K",n}case"P-256":{let n=yield Ms.computePublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return R5(this,arguments,void 0,function*({algorithm:r}){switch(r){case"ES256K":case"secp256k1":{let n=yield Vo.generateKey();return n.alg="ES256K",n}case"ES256":case"secp256r1":{let n=yield Ms.generateKey();return n.alg="ES256",n}}})}getPublicKey(e){return R5(this,arguments,void 0,function*({key:r}){if(!Lf(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{let n=yield Vo.getPublicKey({key:r});return n.alg="ES256K",n}case"P-256":{let n=yield Ms.getPublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return R5(this,arguments,void 0,function*({key:r,data:n}){if(!Lf(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":return yield Vo.sign({key:r,data:n});case"P-256":return yield Ms.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return R5(this,arguments,void 0,function*({key:r,signature:n,data:i}){if(!d_(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(r.crv){case"secp256k1":return yield Vo.verify({key:r,signature:n,data:i});case"P-256":return yield Ms.verify({key:r,signature:n,data:i});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};f();f();f();f();f();var ZI=BigInt(4294967295),yF=BigInt(32);function Cge(t,e=!1){return e?{h:Number(t&ZI),l:Number(t>>yF&ZI)}:{h:Number(t>>yF&ZI)|0,l:Number(t&ZI)|0}}function KQe(t,e=!1){let r=new Uint32Array(t.length),n=new Uint32Array(t.length);for(let i=0;i<t.length;i++){let{h:o,l:s}=Cge(t[i],e);[r[i],n[i]]=[o,s]}return[r,n]}var qQe=(t,e)=>BigInt(t>>>0)<<yF|BigInt(e>>>0),LQe=(t,e,r)=>t>>>r,FQe=(t,e,r)=>t<<32-r|e>>>r,zQe=(t,e,r)=>t>>>r|e<<32-r,VQe=(t,e,r)=>t<<32-r|e>>>r,HQe=(t,e,r)=>t<<64-r|e>>>r-32,WQe=(t,e,r)=>t>>>r-32|e<<64-r,GQe=(t,e)=>e,JQe=(t,e)=>t,YQe=(t,e,r)=>t<<r|e>>>32-r,ZQe=(t,e,r)=>e<<r|t>>>32-r,XQe=(t,e,r)=>e<<r-32|t>>>64-r,QQe=(t,e,r)=>t<<r-32|e>>>64-r;function eet(t,e,r,n){let i=(e>>>0)+(n>>>0);return{h:t+r+(i/2**32|0)|0,l:i|0}}var tet=(t,e,r)=>(t>>>0)+(e>>>0)+(r>>>0),ret=(t,e,r,n)=>e+r+n+(t/2**32|0)|0,net=(t,e,r,n)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0),iet=(t,e,r,n,i)=>e+r+n+i+(t/2**32|0)|0,oet=(t,e,r,n,i)=>(t>>>0)+(e>>>0)+(r>>>0)+(n>>>0)+(i>>>0),set=(t,e,r,n,i,o)=>e+r+n+i+o+(t/2**32|0)|0;var aet={fromBig:Cge,split:KQe,toBig:qQe,shrSH:LQe,shrSL:FQe,rotrSH:zQe,rotrSL:VQe,rotrBH:HQe,rotrBL:WQe,rotr32H:GQe,rotr32L:JQe,rotlSH:YQe,rotlSL:ZQe,rotlBH:XQe,rotlBL:QQe,add:eet,add3L:tet,add3H:ret,add4L:net,add4H:iet,add5H:set,add5L:oet},sr=aet;var[cet,det]=sr.split(["0x428a2f98d728ae22","0x7137449123ef65cd","0xb5c0fbcfec4d3b2f","0xe9b5dba58189dbbc","0x3956c25bf348b538","0x59f111f1b605d019","0x923f82a4af194f9b","0xab1c5ed5da6d8118","0xd807aa98a3030242","0x12835b0145706fbe","0x243185be4ee4b28c","0x550c7dc3d5ffb4e2","0x72be5d74f27b896f","0x80deb1fe3b1696b1","0x9bdc06a725c71235","0xc19bf174cf692694","0xe49b69c19ef14ad2","0xefbe4786384f25e3","0x0fc19dc68b8cd5b5","0x240ca1cc77ac9c65","0x2de92c6f592b0275","0x4a7484aa6ea6e483","0x5cb0a9dcbd41fbd4","0x76f988da831153b5","0x983e5152ee66dfab","0xa831c66d2db43210","0xb00327c898fb213f","0xbf597fc7beef0ee4","0xc6e00bf33da88fc2","0xd5a79147930aa725","0x06ca6351e003826f","0x142929670a0e6e70","0x27b70a8546d22ffc","0x2e1b21385c26c926","0x4d2c6dfc5ac42aed","0x53380d139d95b3df","0x650a73548baf63de","0x766a0abb3c77b2a8","0x81c2c92e47edaee6","0x92722c851482353b","0xa2bfe8a14cf10364","0xa81a664bbc423001","0xc24b8b70d0f89791","0xc76c51a30654be30","0xd192e819d6ef5218","0xd69906245565a910","0xf40e35855771202a","0x106aa07032bbd1b8","0x19a4c116b8d2d0c8","0x1e376c085141ab53","0x2748774cdf8eeb99","0x34b0bcb5e19b48a8","0x391c0cb3c5c95a63","0x4ed8aa4ae3418acb","0x5b9cca4f7763e373","0x682e6ff3d6b2b8a3","0x748f82ee5defb2fc","0x78a5636f43172f60","0x84c87814a1f0ab72","0x8cc702081a6439ec","0x90befffa23631e28","0xa4506cebde82bde9","0xbef9a3f7b2c67915","0xc67178f2e372532b","0xca273eceea26619c","0xd186b8c721c0c207","0xeada7dd6cde0eb1e","0xf57d4f7fee6ed178","0x06f067aa72176fba","0x0a637dc5a2c898a6","0x113f9804bef90dae","0x1b710b35131c471b","0x28db77f523047d84","0x32caab7b40c72493","0x3c9ebe0a15c9bebc","0x431d67c49c100d4c","0x4cc5d4becb3e42b6","0x597f299cfc657e2a","0x5fcb6fab3ad6faec","0x6c44198c4a475817"].map(t=>BigInt(t))),r0=new Uint32Array(80),n0=new Uint32Array(80),mF=class extends Xm{constructor(){super(128,64,16,!1),this.Ah=1779033703,this.Al=-205731576,this.Bh=-1150833019,this.Bl=-2067093701,this.Ch=1013904242,this.Cl=-23791573,this.Dh=-1521486534,this.Dl=1595750129,this.Eh=1359893119,this.El=-1377402159,this.Fh=-1694144372,this.Fl=725511199,this.Gh=528734635,this.Gl=-79577749,this.Hh=1541459225,this.Hl=327033209}get(){let{Ah:e,Al:r,Bh:n,Bl:i,Ch:o,Cl:s,Dh:a,Dl:d,Eh:u,El:c,Fh:l,Fl:h,Gh:y,Gl:g,Hh:v,Hl:x}=this;return[e,r,n,i,o,s,a,d,u,c,l,h,y,g,v,x]}set(e,r,n,i,o,s,a,d,u,c,l,h,y,g,v,x){this.Ah=e|0,this.Al=r|0,this.Bh=n|0,this.Bl=i|0,this.Ch=o|0,this.Cl=s|0,this.Dh=a|0,this.Dl=d|0,this.Eh=u|0,this.El=c|0,this.Fh=l|0,this.Fl=h|0,this.Gh=y|0,this.Gl=g|0,this.Hh=v|0,this.Hl=x|0}process(e,r){for(let T=0;T<16;T++,r+=4)r0[T]=e.getUint32(r),n0[T]=e.getUint32(r+=4);for(let T=16;T<80;T++){let $=r0[T-15]|0,j=n0[T-15]|0,K=sr.rotrSH($,j,1)^sr.rotrSH($,j,8)^sr.shrSH($,j,7),F=sr.rotrSL($,j,1)^sr.rotrSL($,j,8)^sr.shrSL($,j,7),L=r0[T-2]|0,V=n0[T-2]|0,q=sr.rotrSH(L,V,19)^sr.rotrBH(L,V,61)^sr.shrSH(L,V,6),k=sr.rotrSL(L,V,19)^sr.rotrBL(L,V,61)^sr.shrSL(L,V,6),P=sr.add4L(F,k,n0[T-7],n0[T-16]),B=sr.add4H(P,K,q,r0[T-7],r0[T-16]);r0[T]=B|0,n0[T]=P|0}let{Ah:n,Al:i,Bh:o,Bl:s,Ch:a,Cl:d,Dh:u,Dl:c,Eh:l,El:h,Fh:y,Fl:g,Gh:v,Gl:x,Hh:S,Hl:A}=this;for(let T=0;T<80;T++){let $=sr.rotrSH(l,h,14)^sr.rotrSH(l,h,18)^sr.rotrBH(l,h,41),j=sr.rotrSL(l,h,14)^sr.rotrSL(l,h,18)^sr.rotrBL(l,h,41),K=l&y^~l&v,F=h&g^~h&x,L=sr.add5L(A,j,F,det[T],n0[T]),V=sr.add5H(L,S,$,K,cet[T],r0[T]),q=L|0,k=sr.rotrSH(n,i,28)^sr.rotrBH(n,i,34)^sr.rotrBH(n,i,39),P=sr.rotrSL(n,i,28)^sr.rotrBL(n,i,34)^sr.rotrBL(n,i,39),B=n&o^n&a^o&a,p=i&s^i&d^s&d;S=v|0,A=x|0,v=y|0,x=g|0,y=l|0,g=h|0,{h:l,l:h}=sr.add(u|0,c|0,V|0,q|0),u=a|0,c=d|0,a=o|0,d=s|0,o=n|0,s=i|0;let m=sr.add3L(q,P,p);n=sr.add3H(m,V,k,B),i=m|0}({h:n,l:i}=sr.add(this.Ah|0,this.Al|0,n|0,i|0)),{h:o,l:s}=sr.add(this.Bh|0,this.Bl|0,o|0,s|0),{h:a,l:d}=sr.add(this.Ch|0,this.Cl|0,a|0,d|0),{h:u,l:c}=sr.add(this.Dh|0,this.Dl|0,u|0,c|0),{h:l,l:h}=sr.add(this.Eh|0,this.El|0,l|0,h|0),{h:y,l:g}=sr.add(this.Fh|0,this.Fl|0,y|0,g|0),{h:v,l:x}=sr.add(this.Gh|0,this.Gl|0,v|0,x|0),{h:S,l:A}=sr.add(this.Hh|0,this.Hl|0,S|0,A|0),this.set(n,i,o,s,a,d,u,c,l,h,y,g,v,x,S,A)}roundClean(){r0.fill(0),n0.fill(0)}destroy(){this.buffer.fill(0),this.set(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0)}};var i0=a_(()=>new mF);f();var gl=BigInt(0),sd=BigInt(1),XI=BigInt(2),uet=BigInt(8),fet={zip215:!0};function het(t){let e=I5(t);return ou(t,{hash:"function",a:"bigint",d:"bigint",randomBytes:"function"},{adjustScalarBytes:"function",domain:"function",uvRatio:"function",mapToCurve:"function"}),Object.freeze({...e})}function QI(t){let e=het(t),{Fp:r,n,prehash:i,hash:o,randomBytes:s,nByteLength:a,h:d}=e,u=XI<<BigInt(a*8)-sd,c=r.create,l=e.uvRatio||((_,b)=>{try{return{isValid:!0,value:r.sqrt(_*r.inv(b))}}catch{return{isValid:!1,value:gl}}}),h=e.adjustScalarBytes||(_=>_),y=e.domain||((_,b,C)=>{if(b.length||C)throw new Error("Contexts/pre-hash are not supported");return _}),g=_=>typeof _=="bigint"&&gl<_,v=(_,b)=>g(_)&&g(b)&&_<b,x=_=>_===gl||v(_,u);function S(_,b){if(v(_,b))return _;throw new Error(`Expected valid scalar < ${b}, got ${typeof _} ${_}`)}function A(_){return _===gl?_:S(_,n)}let T=new Map;function $(_){if(!(_ instanceof j))throw new Error("ExtendedPoint expected")}class j{constructor(b,C,N,D){if(this.ex=b,this.ey=C,this.ez=N,this.et=D,!x(b))throw new Error("x required");if(!x(C))throw new Error("y required");if(!x(N))throw new Error("z required");if(!x(D))throw new Error("t required")}get x(){return this.toAffine().x}get y(){return this.toAffine().y}static fromAffine(b){if(b instanceof j)throw new Error("extended point not allowed");let{x:C,y:N}=b||{};if(!x(C)||!x(N))throw new Error("invalid affine point");return new j(C,N,sd,c(C*N))}static normalizeZ(b){let C=r.invertBatch(b.map(N=>N.ez));return b.map((N,D)=>N.toAffine(C[D])).map(j.fromAffine)}_setWindowSize(b){this._WINDOW_SIZE=b,T.delete(this)}assertValidity(){let{a:b,d:C}=e;if(this.is0())throw new Error("bad point: ZERO");let{ex:N,ey:D,ez:U,et:G}=this,Y=c(N*N),J=c(D*D),H=c(U*U),X=c(H*H),te=c(Y*b),ne=c(H*c(te+J)),Q=c(X+c(C*c(Y*J)));if(ne!==Q)throw new Error("bad point: equation left != right (1)");let re=c(N*D),ae=c(U*G);if(re!==ae)throw new Error("bad point: equation left != right (2)")}equals(b){$(b);let{ex:C,ey:N,ez:D}=this,{ex:U,ey:G,ez:Y}=b,J=c(C*Y),H=c(U*D),X=c(N*Y),te=c(G*D);return J===H&&X===te}is0(){return this.equals(j.ZERO)}negate(){return new j(c(-this.ex),this.ey,this.ez,c(-this.et))}double(){let{a:b}=e,{ex:C,ey:N,ez:D}=this,U=c(C*C),G=c(N*N),Y=c(XI*c(D*D)),J=c(b*U),H=C+N,X=c(c(H*H)-U-G),te=J+G,ne=te-Y,Q=J-G,re=c(X*ne),ae=c(te*Q),he=c(X*Q),ge=c(ne*te);return new j(re,ae,ge,he)}add(b){$(b);let{a:C,d:N}=e,{ex:D,ey:U,ez:G,et:Y}=this,{ex:J,ey:H,ez:X,et:te}=b;if(C===BigInt(-1)){let St=c((U-D)*(H+J)),Fe=c((U+D)*(H-J)),mt=c(Fe-St);if(mt===gl)return this.double();let In=c(G*XI*te),Pe=c(Y*XI*X),Te=Pe+In,Wt=Fe+St,Re=Pe-In,xe=c(Te*mt),qr=c(Wt*Re),We=c(Te*Re),Ye=c(mt*Wt);return new j(xe,qr,Ye,We)}let ne=c(D*J),Q=c(U*H),re=c(Y*N*te),ae=c(G*X),he=c((D+U)*(J+H)-ne-Q),ge=ae-re,ie=ae+re,pe=c(Q-C*ne),be=c(he*ge),Ue=c(ie*pe),ke=c(he*pe),it=c(ge*ie);return new j(be,Ue,it,ke)}subtract(b){return this.add(b.negate())}wNAF(b){return L.wNAFCached(this,T,b,j.normalizeZ)}multiply(b){let{p:C,f:N}=this.wNAF(S(b,n));return j.normalizeZ([C,N])[0]}multiplyUnsafe(b){let C=A(b);return C===gl?F:this.equals(F)||C===sd?this:this.equals(K)?this.wNAF(C).p:L.unsafeLadder(this,C)}isSmallOrder(){return this.multiplyUnsafe(d).is0()}isTorsionFree(){return L.unsafeLadder(this,n).is0()}toAffine(b){let{ex:C,ey:N,ez:D}=this,U=this.is0();b==null&&(b=U?uet:r.inv(D));let G=c(C*b),Y=c(N*b),J=c(D*b);if(U)return{x:gl,y:sd};if(J!==sd)throw new Error("invZ was invalid");return{x:G,y:Y}}clearCofactor(){let{h:b}=e;return b===sd?this:this.multiplyUnsafe(b)}static fromHex(b,C=!1){let{d:N,a:D}=e,U=r.BYTES;b=Jn("pointHex",b,U);let G=b.slice(),Y=b[U-1];G[U-1]=Y&-129;let J=ml(G);J===gl||(C?S(J,u):S(J,r.ORDER));let H=c(J*J),X=c(H-sd),te=c(N*H-D),{isValid:ne,value:Q}=l(X,te);if(!ne)throw new Error("Point.fromHex: invalid y coordinate");let re=(Q&sd)===sd,ae=(Y&128)!==0;if(!C&&Q===gl&&ae)throw new Error("Point.fromHex: x=0 and x_0=1");return ae!==re&&(Q=c(-Q)),j.fromAffine({x:Q,y:J})}static fromPrivateKey(b){return k(b).point}toRawBytes(){let{x:b,y:C}=this.toAffine(),N=Ip(C,r.BYTES);return N[N.length-1]|=b&sd?128:0,N}toHex(){return kp(this.toRawBytes())}}j.BASE=new j(e.Gx,e.Gy,sd,c(e.Gx*e.Gy)),j.ZERO=new j(gl,sd,sd,gl);let{BASE:K,ZERO:F}=j,L=GI(j,a*8);function V(_){return on(_,n)}function q(_){return V(ml(_))}function k(_){let b=a;_=Jn("private key",_,b);let C=Jn("hashed private key",o(_),2*b),N=h(C.slice(0,b)),D=C.slice(b,2*b),U=q(N),G=K.multiply(U),Y=G.toRawBytes();return{head:N,prefix:D,scalar:U,point:G,pointBytes:Y}}function P(_){return k(_).pointBytes}function B(_=new Uint8Array,...b){let C=Rp(...b);return q(o(y(C,Jn("context",_),!!i)))}function p(_,b,C={}){_=Jn("message",_),i&&(_=i(_));let{prefix:N,scalar:D,pointBytes:U}=k(b),G=B(C.context,N,_),Y=K.multiply(G).toRawBytes(),J=B(C.context,Y,U,_),H=V(G+J*D);A(H);let X=Rp(Y,Ip(H,r.BYTES));return Jn("result",X,a*2)}let m=fet;function w(_,b,C,N=m){let{context:D,zip215:U}=N,G=r.BYTES;_=Jn("signature",_,2*G),b=Jn("message",b),i&&(b=i(b));let Y=ml(_.slice(G,2*G)),J,H,X;try{J=j.fromHex(C,U),H=j.fromHex(_.slice(0,G),U),X=K.multiplyUnsafe(Y)}catch{return!1}if(!U&&J.isSmallOrder())return!1;let te=B(D,H.toRawBytes(),J.toRawBytes(),b);return H.add(J.multiplyUnsafe(te)).subtract(X).clearCofactor().equals(j.ZERO)}return K._setWindowSize(8),{CURVE:e,getPublicKey:P,sign:p,verify:w,ExtendedPoint:j,utils:{getExtendedPublicKey:k,randomPrivateKey:()=>s(r.BYTES),precompute(_=8,b=j.BASE){return b._setWindowSize(_),b.multiply(BigInt(3)),b}}}}f();var O5=BigInt(0),gF=BigInt(1);function pet(t){return ou(t,{a:"bigint"},{montgomeryBits:"isSafeInteger",nByteLength:"isSafeInteger",adjustScalarBytes:"function",domain:"function",powPminus2:"function",Gu:"bigint"}),Object.freeze({...t})}function jge(t){let e=pet(t),{P:r}=e,n=T=>on(T,r),i=e.montgomeryBits,o=Math.ceil(i/8),s=e.nByteLength,a=e.adjustScalarBytes||(T=>T),d=e.powPminus2||(T=>aF(T,r-BigInt(2),r));function u(T,$,j){let K=n(T*($-j));return $=n($-K),j=n(j+K),[$,j]}function c(T){if(typeof T=="bigint"&&O5<=T&&T<r)return T;throw new Error("Expected valid scalar 0 < scalar < CURVE.P")}let l=(e.a-BigInt(2))/BigInt(4);function h(T,$){let j=c(T),K=c($),F=j,L=gF,V=O5,q=j,k=gF,P=O5,B;for(let m=BigInt(i-1);m>=O5;m--){let w=K>>m&gF;P^=w,B=u(P,L,q),L=B[0],q=B[1],B=u(P,V,k),V=B[0],k=B[1],P=w;let E=L+V,_=n(E*E),b=L-V,C=n(b*b),N=_-C,D=q+k,U=q-k,G=n(U*E),Y=n(D*b),J=G+Y,H=G-Y;q=n(J*J),k=n(F*n(H*H)),L=n(_*C),V=n(N*(_+n(l*N)))}B=u(P,L,q),L=B[0],q=B[1],B=u(P,V,k),V=B[0],k=B[1];let p=d(V);return n(L*p)}function y(T){return Ip(n(T),o)}function g(T){let $=Jn("u coordinate",T,o);return s===32&&($[31]&=127),ml($)}function v(T){let $=Jn("scalar",T),j=$.length;if(j!==o&&j!==s)throw new Error(`Expected ${o} or ${s} bytes, got ${j}`);return ml(a($))}function x(T,$){let j=g($),K=v(T),F=h(j,K);if(F===O5)throw new Error("Invalid private or public key received");return y(F)}let S=y(e.Gu);function A(T){return x(T,S)}return{scalarMult:x,scalarMultBase:A,getSharedSecret:(T,$)=>x(T,$),getPublicKey:T=>A(T),utils:{randomPrivateKey:()=>e.randomBytes(e.nByteLength)},GuBytes:S}}var M5=BigInt("57896044618658097711785492504343953926634992332820282019728792003956564819949"),$ge=BigInt("19681161376707505956807079304988542015446066515923890162744021073123829784752"),u9t=BigInt(0),yet=BigInt(1),vF=BigInt(2),met=BigInt(5),Nge=BigInt(10),get=BigInt(20),vet=BigInt(40),Uge=BigInt(80);function Kge(t){let e=M5,n=t*t%e*t%e,i=Yn(n,vF,e)*n%e,o=Yn(i,yet,e)*t%e,s=Yn(o,met,e)*o%e,a=Yn(s,Nge,e)*s%e,d=Yn(a,get,e)*a%e,u=Yn(d,vet,e)*d%e,c=Yn(u,Uge,e)*u%e,l=Yn(c,Uge,e)*u%e,h=Yn(l,Nge,e)*s%e;return{pow_p_5_8:Yn(h,vF,e)*t%e,b2:n}}function qge(t){return t[0]&=248,t[31]&=127,t[31]|=64,t}function bet(t,e){let r=M5,n=on(e*e*e,r),i=on(n*n*e,r),o=Kge(t*i).pow_p_5_8,s=on(t*n*o,r),a=on(e*s*s,r),d=s,u=on(s*$ge,r),c=a===t,l=a===on(-t,r),h=a===on(-t*$ge,r);return c&&(s=d),(l||h)&&(s=u),Ege(s,r)&&(s=on(-s,r)),{isValid:c||l,value:s}}var au=c_(M5,void 0,!0),D5={a:BigInt(-1),d:BigInt("37095705934669439343138083508754565189542113879843219016388785533085940283555"),Fp:au,n:BigInt("7237005577332262213973186563042994240857116359379907606001950938285454250989"),h:BigInt(8),Gx:BigInt("15112221349535400772501151409588531511454012693041857206046113283949847762202"),Gy:BigInt("46316835694926478169428394003475163141307993866256225615783033603165251855960"),hash:i0,randomBytes:Tp,adjustScalarBytes:qge,uvRatio:bet},zn=QI(D5);function Lge(t,e,r){if(e.length>255)throw new Error("Context is too big");return gb(k5("SigEd25519 no Ed25519 collisions"),new Uint8Array([r?1:0,e.length]),e,t)}var l9t=QI({...D5,domain:Lge}),f9t=QI({...D5,domain:Lge,prehash:i0}),Li=jge({P:M5,a:BigInt(486662),montgomeryBits:255,nByteLength:32,Gu:BigInt(9),powPminus2:t=>{let e=M5,{pow_p_5_8:r,b2:n}=Kge(t);return on(Yn(r,BigInt(3),e)*n,e)},adjustScalarBytes:qge,randomBytes:Tp});function l_(t){let{y:e}=zn.ExtendedPoint.fromHex(t),r=BigInt(1);return au.toBytes(au.create((r+e)*au.inv(r-e)))}function f_(t){let e=D5.hash(t.subarray(0,32));return D5.adjustScalarBytes(e).subarray(0,32)}var wet=(au.ORDER+BigInt(3))/BigInt(8),h9t=au.pow(vF,wet),p9t=au.sqrt(au.neg(au.ONE)),y9t=(au.ORDER-BigInt(5))/BigInt(8),m9t=BigInt(486662);var g9t=Sge(au,au.neg(BigInt(486664)));var v9t=BigInt("25063068953384623474111414158702152701244531502492656460079210482610430750235"),b9t=BigInt("54469307008909316920995813868745141605393597292927456921205312896311721017578"),w9t=BigInt("1159843021668779879193775521855586647937357759715417654439879720876111806838"),_9t=BigInt("40440834346308536858101042469323190826248399146238708352240133220865137265952");var x9t=BigInt("0x7fffffffffffffffffffffffffffffffffffffffffffffffffffffffffffffff");var cu=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},_et=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},go=class t{static bytesToPrivateKey(e){return cu(this,arguments,void 0,function*({privateKeyBytes:r}){let n=zn.getPublicKey(r),i={crv:"Ed25519",d:Se.uint8Array(r).toBase64Url(),kty:"OKP",x:Se.uint8Array(n).toBase64Url()};return i.kid=yield wr({jwk:i}),i})}static bytesToPublicKey(e){return cu(this,arguments,void 0,function*({publicKeyBytes:r}){let n={kty:"OKP",crv:"Ed25519",x:Se.uint8Array(r).toBase64Url()};return n.kid=yield wr({jwk:n}),n})}static computePublicKey(e){return cu(this,arguments,void 0,function*({key:r}){let n=yield t.privateKeyToBytes({privateKey:r}),i=zn.getPublicKey(n),o={kty:"OKP",crv:"Ed25519",x:Se.uint8Array(i).toBase64Url()};return o.kid=yield wr({jwk:o}),o})}static convertPrivateKeyToX25519(e){return cu(this,arguments,void 0,function*({privateKey:r}){let n=yield t.privateKeyToBytes({privateKey:r}),i=f_(n),o=Li.getPublicKey(i),s={kty:"OKP",crv:"X25519",d:Se.uint8Array(i).toBase64Url(),x:Se.uint8Array(o).toBase64Url()};return s.kid=yield wr({jwk:s}),s})}static convertPublicKeyToX25519(e){return cu(this,arguments,void 0,function*({publicKey:r}){let n=yield t.publicKeyToBytes({publicKey:r});if(!(yield t.validatePublicKey({publicKeyBytes:n})))throw new Error("Ed25519: Invalid public key.");let o=l_(n),s={kty:"OKP",crv:"X25519",x:Se.uint8Array(o).toBase64Url()};return s.kid=yield wr({jwk:s}),s})}static generateKey(){return cu(this,void 0,void 0,function*(){let e=zn.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield wr({jwk:r}),r})}static getPublicKey(e){return cu(this,arguments,void 0,function*({key:r}){var n;if(!(Ff(r)&&r.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let{d:i}=r,o=_et(r,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield wr({jwk:o})),o})}static privateKeyToBytes(e){return cu(this,arguments,void 0,function*({privateKey:r}){if(!Ff(r))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return Se.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return cu(this,arguments,void 0,function*({publicKey:r}){if(!u_(r))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return Se.base64Url(r.x).toUint8Array()})}static sign(e){return cu(this,arguments,void 0,function*({key:r,data:n}){let i=yield t.privateKeyToBytes({privateKey:r});return zn.sign(n,i)})}static validatePublicKey(e){return cu(this,arguments,void 0,function*({publicKeyBytes:r}){try{zn.ExtendedPoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return cu(this,arguments,void 0,function*({key:r,signature:n,data:i}){let o=yield t.publicKeyToBytes({publicKey:r});return zn.verify(n,i,o)})}};var C5=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},eR=class extends qf{computePublicKey(e){return C5(this,arguments,void 0,function*({key:r}){if(!Ff(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{let n=yield go.computePublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return C5(this,arguments,void 0,function*({algorithm:r}){switch(r){case"Ed25519":{let n=yield go.generateKey();return n.alg="EdDSA",n}}})}getPublicKey(e){return C5(this,arguments,void 0,function*({key:r}){if(!Ff(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{let n=yield go.getPublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return C5(this,arguments,void 0,function*({key:r,data:n}){if(!Ff(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":return yield go.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return C5(this,arguments,void 0,function*({key:r,signature:n,data:i}){if(!u_(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(r.crv){case"Ed25519":return yield go.verify({key:r,signature:n,data:i});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};var Op=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},bF={Ed25519:{implementation:eR,names:["Ed25519"]},secp256k1:{implementation:B5,names:["ES256K","secp256k1"]},secp256r1:{implementation:B5,names:["ES256","secp256r1"]},"SHA-256":{implementation:FI,names:["SHA-256"]}},ma=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e?.keyStore)!==null&&r!==void 0?r:new G2}digest(e){return Op(this,arguments,void 0,function*({algorithm:r,data:n}){return yield this.getAlgorithm({algorithm:r}).digest({algorithm:r,data:n})})}exportKey(e){return Op(this,arguments,void 0,function*({keyUri:r}){return yield this.getPrivateKey({keyUri:r})})}generateKey(e){return Op(this,arguments,void 0,function*({algorithm:r}){let i=yield this.getAlgorithm({algorithm:r}).generateKey({algorithm:r});if(i?.kid===void 0)throw new Error("Generated key is missing a required property: kid");let o=`${pF}${i.kid}`;return yield this._keyStore.set(o,i),o})}getKeyUri(e){return Op(this,arguments,void 0,function*({key:r}){let n=yield wr({jwk:r});return`${pF}${n}`})}getPublicKey(e){return Op(this,arguments,void 0,function*({keyUri:r}){let n=yield this.getPrivateKey({keyUri:r}),i=this.getAlgorithmName({key:n});return yield this.getAlgorithm({algorithm:i}).getPublicKey({key:n})})}importKey(e){return Op(this,arguments,void 0,function*({key:r}){var n;if(!Mge(r))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");let i=structuredClone(r);(n=i.kid)!==null&&n!==void 0||(i.kid=yield wr({jwk:i}));let o=yield this.getKeyUri({key:i});return yield this._keyStore.set(o,i),o})}sign(e){return Op(this,arguments,void 0,function*({keyUri:r,data:n}){let i=yield this.getPrivateKey({keyUri:r}),o=this.getAlgorithmName({key:i});return this.getAlgorithm({algorithm:o}).sign({data:n,key:i})})}verify(e){return Op(this,arguments,void 0,function*({key:r,signature:n,data:i}){let o=this.getAlgorithmName({key:r});return this.getAlgorithm({algorithm:o}).verify({key:r,signature:n,data:i})})}getAlgorithm({algorithm:e}){var r;let n=(r=bF[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){let r=e.alg,n=e.crv;for(let i in bF){let o=bF[i];if(r&&o.names.includes(r))return i;if(n&&o.names.includes(n))return i}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey(e){return Op(this,arguments,void 0,function*({keyUri:r}){let n=yield this._keyStore.get(r);if(!n)throw new Error(`Key not found: ${r}`);return n})}};var rR={};Or(rR,{CryptoUtils:()=>xet,checkRequiredProperty:()=>Fge,checkValidProperty:()=>zge,getJoseSignatureAlgorithmFromPublicKey:()=>Vge,isWebCryptoSupported:()=>Hge,randomBytes:()=>tR,randomPin:()=>Gge,randomUuid:()=>Wge});f();function Fge(t){if(!t||t.property===void 0||t.inObject===void 0)throw new TypeError("One or more required parameters missing: 'property, properties'");let{property:e,inObject:r}=t;if(!(e in r))throw new TypeError(`Required parameter missing: '${e}'`)}function zge(t){if(!t||t.property===void 0||t.allowedProperties===void 0)throw new TypeError("One or more required parameters missing: 'property, allowedProperties'");let{property:e,allowedProperties:r}=t;if(Array.isArray(r)&&!r.includes(e)||r instanceof Set&&!r.has(e)||r instanceof Map&&!r.has(e)){let n=Array.from(r instanceof Map?r.keys():r).join(", ");throw new TypeError(`Out of range: '${e}'. Must be one of '${n}'`)}}function Vge(t){let e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(t.alg&&Object.values(e).includes(t.alg))return t.alg;if(t.crv&&Object.keys(e).includes(t.crv))return e[t.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${t.alg}, crv=${t.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}function Hge(){return!!(globalThis.crypto&&globalThis.crypto.subtle)}function tR(t){return pw(t)}function Wge(){return ly.randomUUID()}function Gge({length:t}){if(3>t||t>10)throw new Error("randomPin() can securely generate a PIN between 3 to 10 digits.");let e=Math.pow(10,t)-1,r;if(t<=6){let n=Math.pow(10,t);do{let i=tR(Math.ceil(t/2));r=new DataView(i.buffer).getUint16(0,!1)%n}while(r>e)}else{let n=Math.pow(10,10);do{let i=tR(4);r=new DataView(i.buffer).getUint32(0,!1)%n}while(r>e)}return r.toString().padStart(t,"0")}var xet={randomPin:Gge,randomUuid:Wge,randomBytes:tR,isWebCryptoSupported:Hge,getJoseSignatureAlgorithmFromPublicKey:Vge,checkValidProperty:zge,checkRequiredProperty:Fge};f();f();f();f();f();f();f();f();f();f();var o0=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Eet=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},h_=class t{static bytesToPrivateKey(e){return o0(this,arguments,void 0,function*({privateKeyBytes:r}){let n=Li.getPublicKey(r),i={kty:"OKP",crv:"X25519",d:Se.uint8Array(r).toBase64Url(),x:Se.uint8Array(n).toBase64Url()};return i.kid=yield wr({jwk:i}),i})}static bytesToPublicKey(e){return o0(this,arguments,void 0,function*({publicKeyBytes:r}){let n={kty:"OKP",crv:"X25519",x:Se.uint8Array(r).toBase64Url()};return n.kid=yield wr({jwk:n}),n})}static computePublicKey(e){return o0(this,arguments,void 0,function*({key:r}){let n=yield t.privateKeyToBytes({privateKey:r}),i=Li.getPublicKey(n),o={kty:"OKP",crv:"X25519",x:Se.uint8Array(i).toBase64Url()};return o.kid=yield wr({jwk:o}),o})}static generateKey(){return o0(this,void 0,void 0,function*(){let e=Li.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield wr({jwk:r}),r})}static getPublicKey(e){return o0(this,arguments,void 0,function*({key:r}){var n;if(!(Ff(r)&&r.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let{d:i}=r,o=Eet(r,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield wr({jwk:o})),o})}static privateKeyToBytes(e){return o0(this,arguments,void 0,function*({privateKey:r}){if(!Ff(r))throw new Error("X25519: The provided key is not a valid OKP private key.");return Se.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return o0(this,arguments,void 0,function*({publicKey:r}){if(!u_(r))throw new Error("X25519: The provided key is not a valid OKP public key.");return Se.base64Url(r.x).toUint8Array()})}static sharedSecret(e){return o0(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let i=yield t.privateKeyToBytes({privateKey:r}),o=yield t.publicKeyToBytes({publicKey:n});return Li.getSharedSecret(i,o)})}};f();f();f();f();f();var zf=xt(rq(),1);f();f();function Jge(t){return t.byteOffset!==0||t.byteLength!==t.buffer.byteLength}function Yge(t){return typeof t!="object"||t===null?!1:typeof t[Symbol.asyncIterator]=="function"}function Vf(t){let r=Object.prototype.toString.call(t).match(/\s([a-zA-Z0-9]+)/),[n,i]=r;return i}var j5=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Zge=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,d){s=t[o](s),i(a,d,s.done,s.value)})}}function i(o,s,a,d){Promise.resolve(d).then(function(u){o({value:u,done:a})},s)}},nR=new TextEncoder,_b=new TextDecoder,le=class t{constructor(e,r){this.data=e,this.format=r}static arrayBuffer(e){return new t(e,"ArrayBuffer")}static asyncIterable(e){if(!Yge(e))throw new TypeError("Input must be of type AsyncIterable.");return new t(e,"AsyncIterable")}static base32Z(e){return new t(e,"Base32Z")}static base58Btc(e){return new t(e,"Base58Btc")}static base64Url(e){return new t(e,"Base64Url")}static bufferSource(e){return new t(e,"BufferSource")}static hex(e){if(typeof e!="string")throw new TypeError("Hex input must be a string.");if(e.length%2!==0)throw new TypeError("Hex input must have an even number of characters.");return new t(e,"Hex")}static multibase(e){return new t(e,"Multibase")}static object(e){return new t(e,"Object")}static string(e){return new t(e,"String")}static uint8Array(e){return new t(e,"Uint8Array")}toArrayBuffer(){switch(this.format){case"Base58Btc":return nc.baseDecode(this.data).buffer;case"Base64Url":return Ea.baseDecode(this.data).buffer;case"BufferSource":{if(Vf(this.data)==="ArrayBuffer")return this.data;if(ArrayBuffer.isView(this.data))return Jge(this.data)?this.data.buffer.slice(this.data.byteOffset,this.data.byteOffset+this.data.byteLength):this.data.buffer;throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":return this.toUint8Array().buffer;case"String":return this.toUint8Array().buffer;case"Uint8Array":return this.data.buffer;default:throw new TypeError(`Conversion from ${this.format} to ArrayBuffer is not supported.`)}}toArrayBufferAsync(){return j5(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":return yield(yield this.toBlobAsync()).arrayBuffer();default:throw new TypeError(`Asynchronous conversion from ${this.format} to ArrayBuffer is not supported.`)}})}toBase32Z(){switch(this.format){case"Uint8Array":return zO.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Z is not supported.`)}}toBase58Btc(){switch(this.format){case"ArrayBuffer":{let e=new Uint8Array(this.data);return nc.baseEncode(e)}case"Multibase":return this.data.substring(1);case"Uint8Array":return nc.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base58Btc is not supported.`)}}toBase64Url(){switch(this.format){case"ArrayBuffer":{let e=new Uint8Array(this.data);return Ea.baseEncode(e)}case"BufferSource":{let e=this.toUint8Array();return Ea.baseEncode(e)}case"Object":{let e=JSON.stringify(this.data),r=nR.encode(e);return Ea.baseEncode(r)}case"String":{let e=nR.encode(this.data);return Ea.baseEncode(e)}case"Uint8Array":return Ea.baseEncode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Base64Url is not supported.`)}}toBlobAsync(){var e,r,n,i;return j5(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let d=[];try{for(var o=!0,s=Zge(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;let c=i;d.push(c)}}catch(c){r={error:c}}finally{try{!o&&!e&&(n=s.return)&&(yield n.call(s))}finally{if(r)throw r.error}}return new Blob(d)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Blob is not supported.`)}})}toHex(){let e=Array.from({length:256},(r,n)=>n.toString(16).padStart(2,"0"));switch(this.format){case"ArrayBuffer":{let r=this.toUint8Array();return t.uint8Array(r).toHex()}case"Base64Url":{let r=this.toUint8Array();return t.uint8Array(r).toHex()}case"Uint8Array":{let r="";for(let n=0;n<this.data.length;n++)r+=e[this.data[n]];return r}default:throw new TypeError(`Conversion from ${this.format} to Hex is not supported.`)}}toMultibase(){switch(this.format){case"Base58Btc":return`z${this.data}`;default:throw new TypeError(`Conversion from ${this.format} to Multibase is not supported.`)}}toObject(){switch(this.format){case"Base64Url":{let e=Ea.baseDecode(this.data),r=_b.decode(e);return JSON.parse(r)}case"String":return JSON.parse(this.data);case"Uint8Array":{let e=_b.decode(this.data);return JSON.parse(e)}default:throw new TypeError(`Conversion from ${this.format} to Object is not supported.`)}}toObjectAsync(){return j5(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let e=yield this.toStringAsync();return JSON.parse(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Object is not supported.`)}})}toString(){switch(this.format){case"ArrayBuffer":return _b.decode(this.data);case"Base64Url":{let e=Ea.baseDecode(this.data);return _b.decode(e)}case"Object":return JSON.stringify(this.data);case"Uint8Array":return _b.decode(this.data);default:throw new TypeError(`Conversion from ${this.format} to String is not supported.`)}}toStringAsync(){var e,r,n,i;return j5(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let d="";try{for(var o=!0,s=Zge(this.data),a;a=yield s.next(),e=a.done,!e;o=!0){i=a.value,o=!1;let u=i;typeof u=="string"?d+=u:d+=_b.decode(u,{stream:!0})}}catch(u){r={error:u}}finally{try{!o&&!e&&(n=s.return)&&(yield n.call(s))}finally{if(r)throw r.error}}return d+=_b.decode(void 0,{stream:!1}),d}default:throw new TypeError(`Asynchronous conversion from ${this.format} to String is not supported.`)}})}toUint8Array(){switch(this.format){case"ArrayBuffer":return new Uint8Array(this.data);case"Base32Z":return zO.baseDecode(this.data);case"Base58Btc":return nc.baseDecode(this.data);case"Base64Url":return Ea.baseDecode(this.data);case"BufferSource":{let e=Vf(this.data);if(e==="Uint8Array")return this.data;if(e==="ArrayBuffer")return new Uint8Array(this.data);if(ArrayBuffer.isView(this.data))return new Uint8Array(this.data.buffer,this.data.byteOffset,this.data.byteLength);throw new TypeError(`${this.format} value is not of type: ArrayBuffer, DataView, or TypedArray.`)}case"Hex":{let e=new Uint8Array(this.data.length/2);for(let r=0;r<this.data.length;r+=2){let n=parseInt(this.data.substring(r,r+2),16);if(isNaN(n))throw new TypeError("Input is not a valid hexadecimal string.");e[r/2]=n}return e}case"Object":{let e=JSON.stringify(this.data);return nR.encode(e)}case"String":return nR.encode(this.data);default:throw new TypeError(`Conversion from ${this.format} to Uint8Array is not supported.`)}}toUint8ArrayAsync(){return j5(this,void 0,void 0,function*(){switch(this.format){case"AsyncIterable":{let e=yield this.toArrayBufferAsync();return new Uint8Array(e)}default:throw new TypeError(`Asynchronous conversion from ${this.format} to Uint8Array is not supported.`)}})}};f();var An=class t{static addPrefix(e){var r;let{code:n,data:i,name:o}=e;if(!(o?!n:n))throw new Error("Either 'name' or 'code' must be defined, but not both.");if(n=t.codeToName.has(n)?n:t.nameToCode.get(o),n===void 0)throw new Error(`Unsupported multicodec: ${(r=e.name)!==null&&r!==void 0?r:e.code}`);let s=lh.encodingLength(n),a=new Uint8Array(s+i.byteLength);return a.set(i,s),lh.encodeTo(n,a),a}static getCodeFromData(e){let{prefixedData:r}=e,[n,i]=lh.decode(r);return n}static getCodeFromName(e){let{name:r}=e,n=t.nameToCode.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static getNameFromCode(e){let{code:r}=e,n=t.codeToName.get(r);if(n===void 0)throw new Error(`Unsupported multicodec: ${r}`);return n}static registerCodec(e){t.codeToName.set(e.code,e.name),t.nameToCode.set(e.name,e.code)}static removePrefix(e){let{prefixedData:r}=e,[n,i]=lh.decode(r),o=t.codeToName.get(n);if(o===void 0)throw new Error(`Unsupported multicodec: ${n}`);return{code:n,data:r.slice(i),name:o}}};An.codeToName=new Map;An.nameToCode=new Map;An.registerCodec({code:237,name:"ed25519-pub"});An.registerCodec({code:4864,name:"ed25519-priv"});An.registerCodec({code:236,name:"x25519-pub"});An.registerCodec({code:4866,name:"x25519-priv"});An.registerCodec({code:231,name:"secp256k1-pub"});An.registerCodec({code:4865,name:"secp256k1-priv"});f();function _F(t){Object.keys(t).forEach(e=>{t[e]===void 0?delete t[e]:typeof t[e]=="object"&&_F(t[e])})}f();var Qge=xt($5(),1),du=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},N5=class{constructor({db:e,location:r="DATASTORE"}={}){this.store=e??new Qge.Level(r)}clear(){return du(this,void 0,void 0,function*(){yield this.store.clear()})}close(){return du(this,void 0,void 0,function*(){yield this.store.close()})}delete(e){return du(this,void 0,void 0,function*(){yield this.store.del(e)})}get(e){return du(this,void 0,void 0,function*(){try{return yield this.store.get(e)}catch(r){if(r.notFound)return;throw r}})}set(e,r){return du(this,void 0,void 0,function*(){yield this.store.put(e,r)})}},xb=class{constructor(){this.store=new Map}clear(){return du(this,void 0,void 0,function*(){this.store.clear()})}close(){return du(this,void 0,void 0,function*(){})}delete(e){return du(this,void 0,void 0,function*(){return this.store.delete(e)})}get(e){return du(this,void 0,void 0,function*(){return this.store.get(e)})}has(e){return du(this,void 0,void 0,function*(){return this.store.has(e)})}list(){return du(this,void 0,void 0,function*(){return Array.from(this.store.values())})}set(e,r){return du(this,void 0,void 0,function*(){this.store.set(e,r)})}};f();var U5=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},K5=function(t){return this instanceof K5?(this.v=t,this):new K5(t)},Tet=function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(h){n[h]&&(i[h]=function(y){return new Promise(function(g,v){o.push([h,y,g,v])>1||a(h,y)})})}function a(h,y){try{d(n[h](y))}catch(g){l(o[0][3],g)}}function d(h){h.value instanceof K5?Promise.resolve(h.value.v).then(u,c):l(o[0][2],h)}function u(h){a("next",h)}function c(h){a("throw",h)}function l(h,y){h(y),o.shift(),o.length&&a(o[0][0],o[0][1])}},iR=class t{static asAsyncIterator(e){return Tet(this,arguments,function*(){let n=e.getReader();try{for(;;){let{done:i,value:o}=yield K5(n.read());if(i)break;yield yield K5(o)}}finally{n.releaseLock()}})}static consumeToArrayBuffer({readableStream:e}){return U5(this,void 0,void 0,function*(){let r=t.asAsyncIterator(e);return yield le.asyncIterable(r).toArrayBufferAsync()})}static consumeToBlob({readableStream:e}){return U5(this,void 0,void 0,function*(){let r=t.asAsyncIterator(e);return yield le.asyncIterable(r).toBlobAsync()})}static consumeToBytes({readableStream:e}){return U5(this,void 0,void 0,function*(){let r=t.asAsyncIterator(e);return yield le.asyncIterable(r).toUint8ArrayAsync()})}static consumeToJson({readableStream:e}){return U5(this,void 0,void 0,function*(){let r=t.asAsyncIterator(e);return yield le.asyncIterable(r).toObjectAsync()})}static consumeToText({readableStream:e}){return U5(this,void 0,void 0,function*(){let r=t.asAsyncIterator(e);return yield le.asyncIterable(r).toStringAsync()})}static generateByteStream({streamLength:e,chunkLength:r,fillValue:n}){let i=e??1/0,o;function s(){let a=Math.min(i,r??1/0);i-=a;let d;if(typeof n=="number")d=new Uint8Array(a).fill(n);else if(Array.isArray(n)){d=new Uint8Array(a);let[u,c]=n,l=c-u+1;for(let h=0;h<a;h++)d[h]=Math.floor(Math.random()*l)+u}else d=new Uint8Array(a);o.enqueue(d),i<=0&&o.close()}return new ReadableStream({start(a){o=a,s()},pull(){s()}})}static isReadable({readableStream:e}){if(!t.isReadableStream(e)||e.locked)return!1;try{return e.getReader().releaseLock(),!0}catch{return!1}}static isReadableStream(e){return typeof e=="object"&&e!==null&&"getReader"in e&&typeof e.getReader=="function"}static isStream(e){return t.isReadableStream(e)||t.isWritableStream(e)||t.isTransformStream(e)}static isTransformStream(e){return typeof e=="object"&&e!==null&&"readable"in e&&typeof e.readable=="object"&&"writable"in e&&typeof e.writable=="object"}static isWritableStream(e){return typeof e=="object"&&e!==null&&"getWriter"in e&&typeof e.getWriter=="function"&&"abort"in e&&typeof e.abort=="function"}};f();var eve=xt(A5(),1);var Aet=xt(A5(),1),q5=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Mp=class t{static consumeToArrayBuffer({readable:e}){return q5(this,void 0,void 0,function*(){return yield le.asyncIterable(e).toArrayBufferAsync()})}static consumeToBlob({readable:e}){return q5(this,void 0,void 0,function*(){return yield le.asyncIterable(e).toBlobAsync()})}static consumeToBytes({readable:e}){return q5(this,void 0,void 0,function*(){return yield le.asyncIterable(e).toUint8ArrayAsync()})}static consumeToJson({readable:e}){return q5(this,void 0,void 0,function*(){return yield le.asyncIterable(e).toObjectAsync()})}static consumeToText({readable:e}){return q5(this,void 0,void 0,function*(){return yield le.asyncIterable(e).toStringAsync()})}static fromWebReadable({readableStream:e,readableOptions:r}){if(!iR.isReadableStream(e))throw new TypeError("NodeStream.fromWebReadable: 'readableStream' is not a Web ReadableStream.");let n=e.getReader(),i=!1,o=new eve.Readable(Object.assign(Object.assign({},r),{read:function(){n.read().then(({done:s,value:a})=>{if(s)this.push(null);else if(!this.push(a))return}).catch(s=>{this.destroy(s)})},destroy:function(s,a){function d(){a(s)}if(!i){n.cancel(s).then(d).catch(d);return}d()}}));return n.closed.then(()=>{i=!0}).catch(s=>{i=!0,o.destroy(s)}),o}static isDestroyed({stream:e}){if(!t.isStream(e))throw new TypeError("NodeStream.isDestroyed: 'stream' is not a Node stream.");let r="_writableState"in e?e._writableState:void 0,n=e._readableState,i=r||n;return!!(e.destroyed||i.destroyed)}static isReadable({readable:e}){return t.isReadableStream(e)?e.readable&&typeof e._readableState.ended=="boolean"&&!e._readableState.ended&&typeof e._readableState.endEmitted=="boolean"&&!e._readableState.endEmitted&&!e.destroyed&&!e.isPaused():!1}static isReadableStream(e){return typeof e=="object"&&e!==null&&"pipe"in e&&typeof e.pipe=="function"&&"on"in e&&typeof e.on=="function"&&!("_writableState"in e)&&"_readableState"in e}static isStream(e){return typeof e=="object"&&e!==null&&("_readableState"in e||"_writableState"in e)}static toWebReadable({readable:e}){if(!t.isReadableStream(e))throw new TypeError("NodeStream.toWebReadable: 'readable' is not a Node Readable stream.");if(t.isDestroyed({stream:e})){let r=new ReadableStream;return r.cancel(),r}return new ReadableStream({start(r){e.on("data",n=>{r.enqueue(n)}),e.on("end",()=>{r.close()}),e.on("error",n=>{r.error(n)})},cancel(){e.destroy()}})}};function ad(t){if(typeof t=="string"&&t.length!==0)return t.split("#").pop()}function EF({didDocument:t}){var e,r;if(!t)throw new TypeError("Required parameter missing: 'didDocument'");let n=[];return n.push(...(r=(e=t.verificationMethod)===null||e===void 0?void 0:e.filter(xF))!==null&&r!==void 0?r:[]),Object.keys(zv).forEach(i=>{var o,s;n.push(...(s=(o=t[i])===null||o===void 0?void 0:o.filter(xF))!==null&&s!==void 0?s:[])}),n}function tve({didDocument:t}){let r=EF({didDocument:t}).map(n=>n.type);return[...new Set(r)]}function rve({didDocument:t,methodId:e}){let r=[];return Object.keys(zv).forEach(n=>{if(Array.isArray(t[n])){let i=t[n],o=ad(e);i.some(a=>{let d=ad(a)===o,u=xF(a)&&ad(a.id)===o;return d||u})&&r.push(n)}}),r}function xF(t){return!(!t||typeof t!="object"||t===null||!("id"in t&&"type"in t&&"controller"in t)||typeof t.id!="string"||typeof t.type!="string"||typeof t.controller!="string")}function SF({keyBytes:t,multicodecCode:e,multicodecName:r}){let n=An.addPrefix({code:e,data:t,name:r}),i=le.uint8Array(n).toBase58Btc();return le.base58Btc(i).toMultibase()}function TF({multibaseKeyId:t}){try{let e=le.multibase(t).toBase58Btc(),r=le.base58Btc(e).toUint8Array(),{code:n,data:i,name:o}=An.removePrefix({prefixedData:r});return{keyBytes:i,multicodecCode:n,multicodecName:o}}catch{throw new ct(tt.InvalidDid,`Invalid multibase identifier: ${t}`)}}var L5=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},wc=class t{constructor({uri:e,document:r,metadata:n,keyManager:i}){this.uri=e,this.document=r,this.metadata=n,this.keyManager=i}export(){return L5(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){let r=[];for(let n of this.document.verificationMethod){if(!n.publicKeyJwk)throw new Error(`Verification method '${n.id}' does not contain a public key in JWK format`);let i=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),o=yield this.keyManager.exportKey({keyUri:i});r.push(Object.assign({},o))}e.privateKeys=r}return e})}getSigner(e){return L5(this,void 0,void 0,function*(){var r;let n=(r=this.document.verificationMethod)===null||r===void 0?void 0:r.find(d=>{var u,c;return ad(d.id)===((u=ad(e?.methodId))!==null&&u!==void 0?u:ad((c=this.document.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(n&&n.publicKeyJwk))throw new ct(tt.InternalError,"A verification method intended for signing could not be determined from the DID Document");let i=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),o=yield this.keyManager.getPublicKey({keyUri:i}),s=this.keyManager;return{algorithm:rR.getJoseSignatureAlgorithmFromPublicKey(o),keyId:n.id,sign(d){return L5(this,arguments,void 0,function*({data:u}){return yield s.sign({data:u,keyUri:i})})},verify(d){return L5(this,arguments,void 0,function*({data:u,signature:c}){return yield s.verify({data:u,key:o,signature:c})})}}})}static import(e){return L5(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ma}){var i;let o=EF({didDocument:r.document});if(o.length===0)throw new ct(tt.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(i=r.privateKeys)!==null&&i!==void 0?i:[])yield n.importKey({key:a});for(let a of o){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);let d=yield n.getKeyUri({key:a.publicKeyJwk});yield n.getPublicKey({keyUri:d})}return new t({uri:r.uri,document:r.document,metadata:r.metadata,keyManager:n})})}};f();f();f();f();f();var AF="0123456789abcdef",ive=[],nve=[];for(let t=0;t<256;t++)ive[t]=AF[t>>4&15]+AF[t&15],t<16&&(t<10?nve[48+t]=t:nve[87+t]=t);var kF=t=>{let e=t.length,r="",n=0;for(;n<e;)r+=ive[t[n++]];return r};var ove=(t,e=0)=>{let r=t.length||0;if(!e){let s=r;for(;s--;)e+=t[s].length}let n=new Uint8Array(e),i=e,o=r;for(;o--;)i-=t[o].length,n.set(t[o],i);return n};f();var sve="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Pet=typeof Uint8Array>"u"?[]:new Uint8Array(256);for(F5=0;F5<sve.length;F5++)Pet[sve.charCodeAt(F5)]=F5;var F5;var Iet=new TextDecoder,PF=(t,e)=>e?new TextDecoder(e).decode(t):Iet.decode(t),Ret=new TextEncoder,uu=t=>Ret.encode(t);var ave=typeof window<"u"?window:self,cve=ave.crypto||ave.msCrypto||{},n7t=cve.subtle||cve.webkitSubtle;f();function p_(t){let e=t<0?1:0;return t=Math.abs(Number(t||1)),Math.floor(Math.log10(t))+1+e}function oR(t){return ArrayBuffer.isView(t)?"arraybufferview":Array.isArray(t)?"array":t instanceof Number?"number":t instanceof Boolean?"boolean":t instanceof Set?"set":t instanceof Map?"map":t instanceof String?"string":t instanceof ArrayBuffer?"arraybuffer":typeof t}function sn(t,e,r){let n=[],i=null;return sn._encode(n,t),i=ove(n),sn.bytes=i.length,ArrayBuffer.isView(e)?(e.set(i,r),e):i}sn.bytes=-1;sn._floatConversionDetected=!1;sn._encode=function(t,e){if(e!=null)switch(oR(e)){case"object":sn.dict(t,e);break;case"map":sn.dictMap(t,e);break;case"array":sn.list(t,e);break;case"set":sn.listSet(t,e);break;case"string":sn.string(t,e);break;case"number":sn.number(t,e);break;case"boolean":sn.number(t,e);break;case"arraybufferview":sn.buffer(t,new Uint8Array(e.buffer,e.byteOffset,e.byteLength));break;case"arraybuffer":sn.buffer(t,new Uint8Array(e));break}};var sR=new Uint8Array([101]),dve=new Uint8Array([100]),uve=new Uint8Array([108]);sn.buffer=function(t,e){t.push(uu(e.length+":"),e)};sn.string=function(t,e){t.push(uu(uu(e).byteLength+":"+e))};sn.number=function(t,e){if(Number.isInteger(e))return t.push(uu("i"+BigInt(e)+"e"));let r=2147483648,n=e/r<<0,i=e%r<<0,o=n*r+i;t.push(uu("i"+o+"e")),o!==e&&!sn._floatConversionDetected&&(sn._floatConversionDetected=!0,console.warn('WARNING: Possible data corruption detected with value "'+e+'":','Bencoding only defines support for integers, value was converted to "'+o+'"'),console.trace())};sn.dict=function(t,e){t.push(dve);let r=0,n,i=Object.keys(e).sort(),o=i.length;for(;r<o;r++)n=i[r],e[n]!=null&&(sn.string(t,n),sn._encode(t,e[n]));t.push(sR)};sn.dictMap=function(t,e){t.push(dve);let r=Array.from(e.keys()).sort();for(let n of r)e.get(n)!=null&&(ArrayBuffer.isView(n)?sn._encode(t,n):sn.string(t,String(n)),sn._encode(t,e.get(n)));t.push(sR)};sn.list=function(t,e){let r=0,n=e.length;for(t.push(uve);r<n;r++)e[r]!=null&&sn._encode(t,e[r]);t.push(sR)};sn.listSet=function(t,e){t.push(uve);for(let r of e)r!=null&&sn._encode(t,r);t.push(sR)};var lve=sn;f();var Bet=105,Oet=58,Met=100,Det=108,IF=101;function fve(t,e,r){let n=0,i=1;for(let o=e;o<r;o++){let s=t[o];if(s<58&&s>=48){n=n*10+(s-48);continue}if(!(o===e&&s===43)){if(o===e&&s===45){i=-1;continue}if(s===46)break;throw new Error("not a number: buffer["+o+"] = "+s)}}return n*i}function Mt(t,e,r,n){return t==null||t.length===0?null:(typeof e!="number"&&n==null&&(n=e,e=void 0),typeof r!="number"&&n==null&&(n=r,r=void 0),Mt.position=0,Mt.encoding=n||null,Mt.data=ArrayBuffer.isView(t)?new Uint8Array(t.slice(e,r)):uu(t),Mt.bytes=Mt.data.length,Mt.next())}Mt.bytes=0;Mt.position=0;Mt.data=null;Mt.encoding=null;Mt.next=function(){switch(Mt.data[Mt.position]){case Met:return Mt.dictionary();case Det:return Mt.list();case Bet:return Mt.integer();default:return Mt.buffer()}};Mt.find=function(t){let e=Mt.position,r=Mt.data.length,n=Mt.data;for(;e<r;){if(n[e]===t)return e;e++}throw new Error('Invalid data: Missing delimiter "'+String.fromCharCode(t)+'" [0x'+t.toString(16)+"]")};Mt.dictionary=function(){Mt.position++;let t={};for(;Mt.data[Mt.position]!==IF;){let e=Mt.buffer(),r=PF(e);r.includes("\uFFFD")&&(r=kF(e)),t[r]=Mt.next()}return Mt.position++,t};Mt.list=function(){Mt.position++;let t=[];for(;Mt.data[Mt.position]!==IF;)t.push(Mt.next());return Mt.position++,t};Mt.integer=function(){let t=Mt.find(IF),e=fve(Mt.data,Mt.position+1,t);return Mt.position+=t+1-Mt.position,e};Mt.buffer=function(){let t=Mt.find(Oet),e=fve(Mt.data,Mt.position,t),r=++t+e;return Mt.position=r,Mt.encoding?PF(Mt.data.slice(t,r)):Mt.data.slice(t,r)};var hve=Mt;f();function Cet(t){let e=2;for(let r of t)e+=aR(r);return e}function jet(t){let e=2;for(let[r,n]of t){let i=uu(r).byteLength;e+=p_(i)+1+i,e+=aR(n)}return e}function $et(t){let e=2,r=Object.keys(t);for(let n=0;n<r.length;n++){let i=uu(r[n]).byteLength;e+=p_(i)+1+i,e+=aR(t[r[n]])}return e}function Net(t){let e=uu(t).byteLength;return p_(e)+1+e}function Uet(t){let e=t.byteLength-t.byteOffset;return p_(e)+1+e}function aR(t){if(t==null)return 0;let r=oR(t);switch(r){case"arraybufferview":return Uet(t);case"string":return Net(t);case"array":case"set":return Cet(t);case"number":return 1+p_(Math.floor(t))+1;case"bigint":return 1+t.toString().length+1;case"object":return $et(t);case"map":return jet(t);default:throw new TypeError(`Unsupported value of type "${r}"`)}}var RF=aR;var Ket=RF,Dp={encode:lve,decode:hve,byteLength:RF,encodingLength:Ket};f();f();var qet=/^(\d{1,3}\.){3,3}\d{1,3}$/;var Let=/^(::)?(((\d{1,3}\.){3}(\d{1,3}){1})?([0-9a-f]){0,4}:{0,2}){1,8}(::)?$/i;var vl={name:"v4",size:4,isFormat:t=>qet.test(t),encode(t,e,r){r=~~r,e=e||new Uint8Array(r+4);let n=t.length,i=0;for(let o=0;o<n;){let s=t.charCodeAt(o++);s===46?(e[r++]=i,i=0):i=i*10+(s-48)}return e[r]=i,e},decode(t,e){return e=~~e,`${t[e++]}.${t[e++]}.${t[e++]}.${t[e]}`}},Cp={name:"v6",size:16,isFormat:t=>t.length>0&&Let.test(t),encode(t,e,r){r=~~r;let n=r+16,i=-1,o=0,s=0,a=!0,d=!1;e=e||new Uint8Array(r+16);for(let u=0;u<t.length;u++){let c=t.charCodeAt(u);c===58?(a?i!==-1?(r<n&&(e[r]=0),r<n-1&&(e[r+1]=0),r+=2):r<n&&(i=r):(d===!0?(r<n&&(e[r]=s),r++):(r<n&&(e[r]=o>>8),r<n-1&&(e[r+1]=o&255),r+=2),o=0,s=0),a=!0,d=!1):c===46?(r<n&&(e[r]=s),r++,s=0,o=0,a=!1,d=!0):(a=!1,c>=97?c-=87:c>=65?c-=55:(c-=48,s=s*10+c),o=(o<<4)+c)}if(a===!1)d===!0?(r<n&&(e[r]=s),r++):(r<n&&(e[r]=o>>8),r<n-1&&(e[r+1]=o&255),r+=2);else if(i===0)r<n&&(e[r]=0),r<n-1&&(e[r+1]=0),r+=2;else if(i!==-1){r+=2;for(let u=Math.min(r-1,n-1);u>=i+2;u--)e[u]=e[u-2];e[i]=0,e[i+1]=0,i=r}if(i!==r&&i!==-1)for(r>n-2&&(r=n-2);n>i;)e[--n]=r<n&&r>i?e[--r]:0;else for(;r<n;)e[r++]=0;return e},decode(t,e){e=~~e;let r="";for(let n=0;n<16;n+=2)n!==0&&(r+=":"),r+=(t[e+n]<<8|t[e+n+1]).toString(16);return r.replace(/(^|:)0(:0)*:0(:|$)/,"$1::$3").replace(/:{3,4}/,"::")}};function pve(t){if(vl.isFormat(t))return vl.size;if(Cp.isFormat(t))return Cp.size;throw Error(`Invalid ip address: ${t}`)}function yve(t){return pve(t)===vl.size?1:2}function mve(t,e,r){r=~~r;let n=pve(t);return typeof e=="function"&&(e=e(r+n)),n===vl.size?vl.encode(t,e,r):Cp.encode(t,e,r)}function gve(t,e,r){if(e=~~e,r=r||t.length-e,r===vl.size)return vl.decode(t,e,r);if(r===Cp.size)return Cp.decode(t,e,r);throw Error(`Invalid buffer size needs to be ${vl.size} for v4 or ${Cp.size} for v6.`)}f();function z5(t){switch(t){case 1:return"A";case 10:return"NULL";case 28:return"AAAA";case 18:return"AFSDB";case 42:return"APL";case 257:return"CAA";case 60:return"CDNSKEY";case 59:return"CDS";case 37:return"CERT";case 5:return"CNAME";case 49:return"DHCID";case 32769:return"DLV";case 39:return"DNAME";case 48:return"DNSKEY";case 43:return"DS";case 55:return"HIP";case 13:return"HINFO";case 45:return"IPSECKEY";case 25:return"KEY";case 36:return"KX";case 29:return"LOC";case 15:return"MX";case 35:return"NAPTR";case 2:return"NS";case 47:return"NSEC";case 50:return"NSEC3";case 51:return"NSEC3PARAM";case 12:return"PTR";case 46:return"RRSIG";case 17:return"RP";case 24:return"SIG";case 6:return"SOA";case 99:return"SPF";case 33:return"SRV";case 44:return"SSHFP";case 32768:return"TA";case 249:return"TKEY";case 52:return"TLSA";case 250:return"TSIG";case 16:return"TXT";case 252:return"AXFR";case 251:return"IXFR";case 41:return"OPT";case 255:return"ANY"}return"UNKNOWN_"+t}function y_(t){switch(t.toUpperCase()){case"A":return 1;case"NULL":return 10;case"AAAA":return 28;case"AFSDB":return 18;case"APL":return 42;case"CAA":return 257;case"CDNSKEY":return 60;case"CDS":return 59;case"CERT":return 37;case"CNAME":return 5;case"DHCID":return 49;case"DLV":return 32769;case"DNAME":return 39;case"DNSKEY":return 48;case"DS":return 43;case"HIP":return 55;case"HINFO":return 13;case"IPSECKEY":return 45;case"KEY":return 25;case"KX":return 36;case"LOC":return 29;case"MX":return 15;case"NAPTR":return 35;case"NS":return 2;case"NSEC":return 47;case"NSEC3":return 50;case"NSEC3PARAM":return 51;case"PTR":return 12;case"RRSIG":return 46;case"RP":return 17;case"SIG":return 24;case"SOA":return 6;case"SPF":return 99;case"SRV":return 33;case"SSHFP":return 44;case"TA":return 32768;case"TKEY":return 249;case"TLSA":return 52;case"TSIG":return 250;case"TXT":return 16;case"AXFR":return 252;case"IXFR":return 251;case"OPT":return 41;case"ANY":return 255;case"*":return 255}return t.toUpperCase().startsWith("UNKNOWN_")?parseInt(t.slice(8)):0}f();function vve(t){switch(t){case 0:return"NOERROR";case 1:return"FORMERR";case 2:return"SERVFAIL";case 3:return"NXDOMAIN";case 4:return"NOTIMP";case 5:return"REFUSED";case 6:return"YXDOMAIN";case 7:return"YXRRSET";case 8:return"NXRRSET";case 9:return"NOTAUTH";case 10:return"NOTZONE";case 11:return"RCODE_11";case 12:return"RCODE_12";case 13:return"RCODE_13";case 14:return"RCODE_14";case 15:return"RCODE_15"}return"RCODE_"+t}f();function bve(t){switch(t){case 0:return"QUERY";case 1:return"IQUERY";case 2:return"STATUS";case 3:return"OPCODE_3";case 4:return"NOTIFY";case 5:return"UPDATE";case 6:return"OPCODE_6";case 7:return"OPCODE_7";case 8:return"OPCODE_8";case 9:return"OPCODE_9";case 10:return"OPCODE_10";case 11:return"OPCODE_11";case 12:return"OPCODE_12";case 13:return"OPCODE_13";case 14:return"OPCODE_14";case 15:return"OPCODE_15"}return"OPCODE_"+t}f();function BF(t){switch(t){case 1:return"IN";case 2:return"CS";case 3:return"CH";case 4:return"HS";case 255:return"ANY"}return"UNKNOWN_"+t}function OF(t){switch(t.toUpperCase()){case"IN":return 1;case"CS":return 2;case"CH":return 3;case"HS":return 4;case"ANY":return 255}return 0}f();function wve(t){switch(t){case 1:return"LLQ";case 2:return"UL";case 3:return"NSID";case 5:return"DAU";case 6:return"DHU";case 7:return"N3U";case 8:return"CLIENT_SUBNET";case 9:return"EXPIRE";case 10:return"COOKIE";case 11:return"TCP_KEEPALIVE";case 12:return"PADDING";case 13:return"CHAIN";case 14:return"KEY_TAG";case 26946:return"DEVICEID"}return t<0?null:`OPTION_${t}`}function MF(t){if(typeof t=="number")return t;if(!t)return-1;switch(t.toUpperCase()){case"OPTION_0":return 0;case"LLQ":return 1;case"UL":return 2;case"NSID":return 3;case"OPTION_4":return 4;case"DAU":return 5;case"DHU":return 6;case"N3U":return 7;case"CLIENT_SUBNET":return 8;case"EXPIRE":return 9;case"COOKIE":return 10;case"TCP_KEEPALIVE":return 11;case"PADDING":return 12;case"CHAIN":return 13;case"KEY_TAG":return 14;case"DEVICEID":return 26946;case"OPTION_65535":return 65535}let e=t.match(/_(\d+)$/);return e?parseInt(e[1],10):-1}f();f();function DF(t){let e=0,r=t.length;for(let n=0;n<r;n+=1){let i=t.charCodeAt(n);if(i<=127)e+=1;else if(i<=2047)e+=2;else if((i&63488)!==55296)e+=3;else{let o=n+1;o===r||i>=56320||(t.charCodeAt(o)&64512)!==56320?e+=3:(n=o,e+=4)}}return e}function m_(t,e,r){let n=t.length;r==null&&(r=0),e===void 0&&(e=new Uint8Array(DF(t)+r));let i=r;for(let o=0;o<n;o+=1){let s=t.charCodeAt(o);if(s<=127)e[i++]=s;else if(s<=2047)e[i++]=192|(s&1984)>>6,e[i++]=128|s&63;else if((s&63488)!==55296)e[i++]=224|(s&61440)>>12,e[i++]=128|(s&4032)>>6,e[i++]=128|s&63;else{let a=o+1;if(a===n||s>=56320)e[i++]=239,e[i++]=191,e[i++]=189;else{let d=t.charCodeAt(a);(d&64512)!==56320?(e[i++]=239,e[i++]=191,e[i++]=189):(o=a,s=65536|(s&1023)<<10|d&1023,e[i++]=240|(s&1835008)>>18,e[i++]=128|(s&258048)>>12,e[i++]=128|(s&4032)>>6,e[i++]=128|s&63)}}}return m_.bytes=i-r,e}m_.bytes=0;function g_(t,e,r){let n="";e==null&&(e=0),r==null&&(r=t.length);for(let i=e;i<r;){let o=t[i++],s;if(o<=128)s=o;else if(o>191&&o<224)s=(o&31)<<6|t[i++]&63;else if(o>239&&o<365){s=((o&7)<<18|(t[i++]&63)<<12|(t[i++]&63)<<6|t[i++]&63)-65536;let a=55296|s>>10&1023;n+=String.fromCharCode(a),s=56320|s&1023}else s=(o&15)<<12|(t[i++]&63)<<6|t[i++]&63;n+=String.fromCharCode(s)}return g_.bytes=r-e,n}g_.bytes=0;var s0=t=>t instanceof Uint8Array;function jp(t){return typeof t=="string"?DF(t):t.byteLength}function cR(t){return t instanceof Uint8Array?t:Array.isArray(t)?new Uint8Array(t):m_(t)}function dR(t,e,r){if(typeof e!="string")throw new Error("unknown input type");return m_(e,t,r),m_.bytes}var V5={},_ve=new Array(255);for(let t=0;t<=15;t+=1){let e=t.toString(16),r=e.toUpperCase();for(let n=0;n<=15;n+=1){let i=n.toString(16),o=i.toUpperCase(),s=t<<4|n,a=`${e}${i}`;_ve[s]=a,V5[a]=s,V5[`${r}${i}`]=s,V5[`${e}${o}`]=s,V5[`${r}${o}`]=s}}function xve(t,e,r){let n="";for(let i=e;i<r;){let o=t[i++];n+=_ve[o]}return n}function CF(t){return t.length>>>1}function Eve(t,e,r,n){let i=0;for(;r<n;){let o=e.substr(i,2),s=V5[o];if(s===void 0)return;t[r++]=s,i+=2}return t}var Yet=Math.pow(2,24),Zet=Math.pow(2,16),Xet=Math.pow(2,8),Hf=(t,e)=>t[e]*Yet+t[e+1]*Zet+t[e+2]*Xet+t[e+3],ar=(t,e)=>t[e]<<8|t[e+1],Wf=(t,e,r)=>(e=+e,t[r+3]=e,e=e>>>8,t[r+2]=e,e=e>>>8,t[r+1]=e,e=e>>>8,t[r]=e,r+4),wt=(t,e,r)=>(t[r]=e>>8,t[r+1]=e&255,r+2);function _c(t,e,r,n,i){return r<0&&(n-=r,r=0),n<0&&(n=0),i<0?new Uint8Array(0):r>=e.length||n>=i?0:Qet(t,e,r,n,i)}function Qet(t,e,r,n,i){i-n>e.length-r&&(i=n+e.length-r);let o=i-n,s=t.length-n;return o>s&&(o=s),(n!==0||i<t.length)&&(t=new Uint8Array(t.buffer,t.byteOffset+n,o)),e.set(t,r),o}var ttt=0,Sve=32768,$F=32768,rtt=~$F,Ave=32768,ntt=~Ave;function jn({bytes:t=0,encode:e,decode:r,encodingLength:n}){return e.bytes=t,r.bytes=t,{encode:e,decode:r,encodingLength:n||(()=>t)}}var st=jn({encode(t,e,r){e||(e=new Uint8Array(st.encodingLength(t))),r||(r=0);let n=r,i=t.replace(/^\.|\.$/gm,"");if(i.length){let o=i.split(".");for(let s=0;s<o.length;s++){let a=dR(e,o[s],r+1);e[r]=a,r+=a+1}}return e[r++]=0,st.encode.bytes=r-n,e},decode(t,e){e||(e=0);let r=[],n=e,i=0,o=0,s=!1;for(;;){if(e>=t.length)throw new Error("Cannot decode name (buffer overflow)");let a=t[e++];if(o+=s?0:1,a===0)break;if(a&192)if((a&192)===192){if(e+1>t.length)throw new Error("Cannot decode name (buffer overflow)");let d=ar(t,e-1)-49152;if(d>=n)throw new Error("Cannot decode name (bad pointer)");e=d,n=d,o+=s?0:1,s=!0}else throw new Error("Cannot decode name (bad label)");else{if(e+a>t.length)throw new Error("Cannot decode name (buffer overflow)");if(i+=a+1,i>254)throw new Error("Cannot decode name (name too long)");r.push(g_(t,e,e+a)),e+=a,o+=s?0:a}}return st.decode.bytes=o,r.length===0?".":r.join(".")},encodingLength(t){return t==="."||t===".."?1:jp(t.replace(/^\.|\.$/gm,""))+2}}),vo=jn({encode(t,e,r){e||(e=new Uint8Array(vo.encodingLength(t))),r||(r=0);let n=dR(e,t,r+1);return e[r]=n,vo.encode.bytes=n+1,e},decode(t,e){e||(e=0);let r=t[e],n=g_(t,e+1,e+1+r);return vo.decode.bytes=r+1,n},encodingLength(t){return jp(t)+1}}),v_=jn({bytes:12,encode(t,e,r){e||(e=new Uint8Array(v_.encodingLength(t))),r||(r=0);let n=(t.flags||0)&32767,i=t.type==="response"?Sve:ttt;return wt(e,t.id||0,r),wt(e,n|i,r+2),wt(e,t.questions.length,r+4),wt(e,t.answers.length,r+6),wt(e,t.authorities.length,r+8),wt(e,t.additionals.length,r+10),e},decode(t,e){if(e||(e=0),t.length<12)throw new Error("Header must be 12 bytes");let r=ar(t,e+2);return{id:ar(t,e),type:r&Sve?"response":"query",flags:r&32767,flag_qr:(r>>15&1)===1,opcode:bve(r>>11&15),flag_aa:(r>>10&1)===1,flag_tc:(r>>9&1)===1,flag_rd:(r>>8&1)===1,flag_ra:(r>>7&1)===1,flag_z:(r>>6&1)===1,flag_ad:(r>>5&1)===1,flag_cd:(r>>4&1)===1,rcode:vve(r&15),questions:new Array(ar(t,e+4)),answers:new Array(ar(t,e+6)),authorities:new Array(ar(t,e+8)),additionals:new Array(ar(t,e+10))}},encodingLength(){return 12}}),lR=jn({encode(t,e,r){e||(e=new Uint8Array(lR.encodingLength(t))),r||(r=0);let n=t.length;return wt(e,n,r),_c(t,e,r+2,0,n),lR.encode.bytes=n+2,e},decode(t,e){e||(e=0);let r=ar(t,e),n=t.slice(e+2,e+2+r);return lR.decode.bytes=r+2,n},encodingLength(t){return t.length+2}}),fR=jn({encode(t,e,r){return e||(e=new Uint8Array(fR.encodingLength(t))),r||(r=0),st.encode(t,e,r+2),wt(e,st.encode.bytes,r),fR.encode.bytes=st.encode.bytes+2,e},decode(t,e){e||(e=0);let r=ar(t,e),n=st.decode(t,e+2);return fR.decode.bytes=r+2,n},encodingLength(t){return st.encodingLength(t)+2}}),hR=jn({encode(t,e,r){e||(e=new Uint8Array(hR.encodingLength(t))),r||(r=0);let n=r;return r+=2,st.encode(t.mname,e,r),r+=st.encode.bytes,st.encode(t.rname,e,r),r+=st.encode.bytes,Wf(e,t.serial||0,r),r+=4,Wf(e,t.refresh||0,r),r+=4,Wf(e,t.retry||0,r),r+=4,Wf(e,t.expire||0,r),r+=4,Wf(e,t.minimum||0,r),r+=4,wt(e,r-n-2,n),hR.encode.bytes=r-n,e},decode(t,e){e||(e=0);let r=e,n={};return e+=2,n.mname=st.decode(t,e),e+=st.decode.bytes,n.rname=st.decode(t,e),e+=st.decode.bytes,n.serial=Hf(t,e),e+=4,n.refresh=Hf(t,e),e+=4,n.retry=Hf(t,e),e+=4,n.expire=Hf(t,e),e+=4,n.minimum=Hf(t,e),e+=4,hR.decode.bytes=e-r,n},encodingLength(t){return 22+st.encodingLength(t.mname)+st.encodingLength(t.rname)}}),pR=jn({encode(t,e,r){Array.isArray(t)||(t=[t]);for(let i=0;i<t.length;i++)if(typeof t[i]=="string"&&(t[i]=cR(t[i])),!s0(t[i]))throw new Error("Must be a Buffer");e||(e=new Uint8Array(pR.encodingLength(t))),r||(r=0);let n=r;return r+=2,t.forEach(function(i){e[r++]=i.length,_c(i,e,r,0,i.length),r+=i.length}),wt(e,r-n-2,n),pR.encode.bytes=r-n,e},decode(t,e){e||(e=0);let r=e,n=ar(t,e);e+=2;let i=[];for(;n>0;){let o=t[e++];if(--n,n<o)throw new Error("Buffer overflow");i.push(t.slice(e,e+o)),e+=o,n-=o}return pR.decode.bytes=e-r,i},encodingLength(t){Array.isArray(t)||(t=[t]);let e=2;return t.forEach(function(r){typeof r=="string"?e+=jp(r)+1:e+=r.length+1}),e}}),yR=jn({encode(t,e,r){e||(e=new Uint8Array(yR.encodingLength(t))),r||(r=0),typeof t=="string"&&(t=cR(t)),t||(t=new Uint8Array(0));let n=r;r+=2;let i=t.length;return _c(t,e,r,0,i),r+=i,wt(e,r-n-2,n),yR.encode.bytes=r-n,e},decode(t,e){e||(e=0);let r=e,n=ar(t,e);e+=2;let i=t.slice(e,e+n);return e+=n,yR.decode.bytes=e-r,i},encodingLength(t){return t?(s0(t)?t.length:jp(t))+2:2}}),mR=jn({encode(t,e,r){e||(e=new Uint8Array(mR.encodingLength(t))),r||(r=0);let n=r;return r+=2,vo.encode(t.cpu,e,r),r+=vo.encode.bytes,vo.encode(t.os,e,r),r+=vo.encode.bytes,wt(e,r-n-2,n),mR.encode.bytes=r-n,e},decode(t,e){e||(e=0);let r=e,n={};return e+=2,n.cpu=vo.decode(t,e),e+=vo.decode.bytes,n.os=vo.decode(t,e),e+=vo.decode.bytes,mR.decode.bytes=e-r,n},encodingLength(t){return vo.encodingLength(t.cpu)+vo.encodingLength(t.os)+2}}),__=jn({encode(t,e,r){return e||(e=new Uint8Array(__.encodingLength(t))),r||(r=0),st.encode(t,e,r+2),wt(e,st.encode.bytes,r),__.encode.bytes=st.encode.bytes+2,e},decode(t,e){e||(e=0);let r=st.decode(t,e+2);return __.decode.bytes=st.decode.bytes+2,r},encodingLength(t){return st.encodingLength(t)+2}}),gR=jn({encode(t,e,r){e||(e=new Uint8Array(gR.encodingLength(t))),r||(r=0),wt(e,t.priority||0,r+2),wt(e,t.weight||0,r+4),wt(e,t.port||0,r+6),st.encode(t.target,e,r+8);let n=st.encode.bytes+6;return wt(e,n,r),gR.encode.bytes=n+2,e},decode(t,e){e||(e=0);let r=ar(t,e),n={};return n.priority=ar(t,e+2),n.weight=ar(t,e+4),n.port=ar(t,e+6),n.target=st.decode(t,e+8),gR.decode.bytes=r+2,n},encodingLength(t){return 8+st.encodingLength(t.target)}}),a0=jn({encode(t,e,r){let n=a0.encodingLength(t);return e||(e=new Uint8Array(a0.encodingLength(t))),r||(r=0),t.issuerCritical&&(t.flags=a0.ISSUER_CRITICAL),wt(e,n-2,r),r+=2,e[r]=t.flags||0,r+=1,vo.encode(t.tag,e,r),r+=vo.encode.bytes,dR(e,t.value,r),r+=jp(t.value),a0.encode.bytes=n,e},decode(t,e){e||(e=0);let r=ar(t,e);e+=2;let n=e,i={};return i.flags=t[e],e+=1,i.tag=vo.decode(t,e),e+=vo.decode.bytes,i.value=g_(t,e,n+r),i.issuerCritical=!!(i.flags&a0.ISSUER_CRITICAL),a0.decode.bytes=r+2,i},encodingLength(t){return vo.encodingLength(t.tag)+vo.encodingLength(t.value)+2}});a0.ISSUER_CRITICAL=128;var vR=jn({encode(t,e,r){e||(e=new Uint8Array(vR.encodingLength(t))),r||(r=0);let n=r;return r+=2,wt(e,t.preference||0,r),r+=2,st.encode(t.exchange,e,r),r+=st.encode.bytes,wt(e,r-n-2,n),vR.encode.bytes=r-n,e},decode(t,e){e||(e=0);let r=e,n={};return e+=2,n.preference=ar(t,e),e+=2,n.exchange=st.decode(t,e),e+=st.decode.bytes,vR.decode.bytes=e-r,n},encodingLength(t){return 4+st.encodingLength(t.exchange)}}),kve=jn({encode(t,e,r){return e||(e=new Uint8Array(kve.encodingLength(t))),r||(r=0),wt(e,4,r),r+=2,vl.encode(t,e,r),e},decode(t,e){return e||(e=0),e+=2,vl.decode(t,e)},bytes:6}),bR=jn({encode(t,e,r){return e||(e=new Uint8Array(bR.encodingLength(t))),r||(r=0),wt(e,16,r),r+=2,Cp.encode(t,e,r),bR.encode.bytes=18,e},decode(t,e){e||(e=0),e+=2;let r=Cp.decode(t,e);return bR.decode.bytes=18,r},bytes:18}),Tve=t=>new Uint8Array(t),$p=jn({encode(t,e,r){e||(e=new Uint8Array($p.encodingLength(t))),r||(r=0);let n=r,i=MF(t.code);if(wt(e,i,r),r+=2,t.data)wt(e,t.data.length,r),r+=2,_c(t.data,e,r),r+=t.data.length;else switch(i){case 8:{let o=t.sourcePrefixLength||0,s=t.family||yve(t.ip,Tve),a=mve(t.ip,Tve),d=Math.ceil(o/8);wt(e,d+4,r),r+=2,wt(e,s,r),r+=2,e[r++]=o,e[r++]=t.scopePrefixLength||0,_c(a,e,r,0,d),r+=d}break;case 11:t.timeout?(wt(e,2,r),r+=2,wt(e,t.timeout,r),r+=2):(wt(e,0,r),r+=2);break;case 12:{let o=t.length||0;wt(e,o,r),r+=2,e.fill(0,r,r+o),r+=o}break;case 14:{let o=t.tags.length*2;wt(e,o,r),r+=2;for(let s of t.tags)wt(e,s,r),r+=2}break;default:throw new Error(`Unknown roption code: ${t.code}`)}return $p.encode.bytes=r-n,e},decode(t,e){e||(e=0);let r={};r.code=ar(t,e),r.type=wve(r.code),e+=2;let n=ar(t,e);switch(e+=2,r.data=t.slice(e,e+n),r.code){case 8:r.family=ar(t,e),e+=2,r.sourcePrefixLength=t[e++],r.scopePrefixLength=t[e++];{let i=new Uint8Array(r.family===1?4:16);_c(t,i,0,e,e+n-4),r.ip=gve(i)}break;case 11:n>0&&(r.timeout=ar(t,e),e+=2);break;case 14:r.tags=[];for(let i=0;i<n;i+=2)r.tags.push(ar(t,e)),e+=2}return $p.decode.bytes=n+4,r},encodingLength(t){if(t.data)return t.data.length+4;switch(MF(t.code)){case 8:{let r=t.sourcePrefixLength||0;return Math.ceil(r/8)+8}case 11:return typeof t.timeout=="number"?6:4;case 12:return t.length+4;case 14:return 4+t.tags.length*2}throw new Error(`Unknown roption code: ${t.code}`)}}),c0=jn({encode(t,e,r){e||(e=new Uint8Array(c0.encodingLength(t))),r||(r=0);let n=r,i=w_(t,$p);return wt(e,i,r),r=Z5(t,$p,e,r+2),c0.encode.bytes=r-n,e},decode(t,e){e||(e=0);let r=e,n=[],i=ar(t,e);e+=2;let o=0;for(;i>0;)n[o++]=$p.decode(t,e),e+=$p.decode.bytes,i-=$p.decode.bytes;return c0.decode.bytes=e-r,n},encodingLength(t){return 2+w_(t||[],$p)}}),Gf=jn({encode(t,e,r){e||(e=new Uint8Array(Gf.encodingLength(t))),r||(r=0);let n=r,i=t.key;if(!s0(i))throw new Error("Key must be a Buffer");return r+=2,wt(e,t.flags,r),r+=2,e[r]=Gf.PROTOCOL_DNSSEC,r+=1,e[r]=t.algorithm,r+=1,_c(i,e,r,0,i.length),r+=i.length,Gf.encode.bytes=r-n,wt(e,Gf.encode.bytes-2,n),e},decode(t,e){e||(e=0);let r=e,n={},i=ar(t,e);if(e+=2,n.flags=ar(t,e),e+=2,t[e]!==Gf.PROTOCOL_DNSSEC)throw new Error("Protocol must be 3");return e+=1,n.algorithm=t[e],e+=1,n.key=t.slice(e,r+i+2),e+=n.key.length,Gf.decode.bytes=e-r,n},encodingLength(t){return 6+jp(t.key)}});Gf.PROTOCOL_DNSSEC=3;Gf.ZONE_KEY=128;Gf.SECURE_ENTRYPOINT=32768;var H5=jn({encode(t,e,r){e||(e=new Uint8Array(H5.encodingLength(t))),r||(r=0);let n=r,i=t.signature;if(!s0(i))throw new Error("Signature must be a Buffer");return r+=2,wt(e,y_(t.typeCovered),r),r+=2,e[r]=t.algorithm,r+=1,e[r]=t.labels,r+=1,Wf(e,t.originalTTL,r),r+=4,Wf(e,t.expiration,r),r+=4,Wf(e,t.inception,r),r+=4,wt(e,t.keyTag,r),r+=2,st.encode(t.signersName,e,r),r+=st.encode.bytes,_c(i,e,r,0,i.length),r+=i.length,H5.encode.bytes=r-n,wt(e,H5.encode.bytes-2,n),e},decode(t,e){e||(e=0);let r=e,n={},i=ar(t,e);return e+=2,n.typeCovered=z5(ar(t,e)),e+=2,n.algorithm=t[e],e+=1,n.labels=t[e],e+=1,n.originalTTL=Hf(t,e),e+=4,n.expiration=Hf(t,e),e+=4,n.inception=Hf(t,e),e+=4,n.keyTag=ar(t,e),e+=2,n.signersName=st.decode(t,e),e+=st.decode.bytes,n.signature=t.slice(e,r+i+2),e+=n.signature.length,H5.decode.bytes=e-r,n},encodingLength(t){return 20+st.encodingLength(t.signersName)+jp(t.signature)}}),W5=jn({encode(t,e,r){e||(e=new Uint8Array(W5.encodingLength(t))),r||(r=0);let n=r;return r+=2,st.encode(t.mbox||".",e,r),r+=st.encode.bytes,st.encode(t.txt||".",e,r),r+=st.encode.bytes,W5.encode.bytes=r-n,wt(e,W5.encode.bytes-2,n),e},decode(t,e){e||(e=0);let r=e,n={};return e+=2,n.mbox=st.decode(t,e)||".",e+=st.decode.bytes,n.txt=st.decode(t,e)||".",e+=st.decode.bytes,W5.decode.bytes=e-r,n},encodingLength(t){return 2+st.encodingLength(t.mbox||".")+st.encodingLength(t.txt||".")}}),cd=jn({encode(t,e,r){e||(e=new Uint8Array(cd.encodingLength(t))),r||(r=0);let n=r,i=[];for(let o=0;o<t.length;o++){let s=y_(t[o]);i[s>>8]===void 0&&(i[s>>8]=[]),i[s>>8][s>>3&31]|=1<<7-(s&7)}for(let o=0;o<i.length;o++)if(i[o]!==void 0){let s=cR(i[o]);e[r]=o,r+=1,e[r]=s.length,r+=1,_c(s,e,r,0,s.length),r+=s.length}return cd.encode.bytes=r-n,e},decode(t,e,r){e||(e=0);let n=e,i=[];for(;e-n<r;){let o=t[e];e+=1;let s=t[e];e+=1;for(let a=0;a<s;a++){let d=t[e+a];for(let u=0;u<8;u++)if(d&1<<7-u){let c=z5(o<<8|a<<3|u);i.push(c)}}e+=s}return cd.decode.bytes=e-n,i},encodingLength(t){let e=[];for(let n=0;n<t.length;n++){let i=y_(t[n]);e[i>>8]=Math.max(e[i>>8]||0,i&255)}let r=0;for(let n=0;n<e.length;n++)e[n]!==void 0&&(r+=2+Math.ceil((e[n]+1)/8));return r}}),G5=jn({encode(t,e,r){e||(e=new Uint8Array(G5.encodingLength(t))),r||(r=0);let n=r;return r+=2,st.encode(t.nextDomain,e,r),r+=st.encode.bytes,cd.encode(t.rrtypes,e,r),r+=cd.encode.bytes,G5.encode.bytes=r-n,wt(e,G5.encode.bytes-2,n),e},decode(t,e){e||(e=0);let r=e,n={},i=ar(t,e);return e+=2,n.nextDomain=st.decode(t,e),e+=st.decode.bytes,n.rrtypes=cd.decode(t,e,i-(e-r)),e+=cd.decode.bytes,G5.decode.bytes=e-r,n},encodingLength(t){return 2+st.encodingLength(t.nextDomain)+cd.encodingLength(t.rrtypes)}}),J5=jn({encode(t,e,r){e||(e=new Uint8Array(J5.encodingLength(t))),r||(r=0);let n=r,i=t.salt;if(!s0(i))throw new Error("salt must be a Buffer");let o=t.nextDomain;if(!s0(o))throw new Error("nextDomain must be a Buffer");return r+=2,e[r]=t.algorithm,r+=1,e[r]=t.flags,r+=1,wt(e,t.iterations,r),r+=2,e[r]=i.length,r+=1,_c(i,e,r,0,i.length),r+=i.length,e[r]=o.length,r+=1,_c(o,e,r,0,o.length),r+=o.length,cd.encode(t.rrtypes,e,r),r+=cd.encode.bytes,J5.encode.bytes=r-n,wt(e,J5.encode.bytes-2,n),e},decode(t,e){e||(e=0);let r=e,n={},i=ar(t,e);e+=2,n.algorithm=t[e],e+=1,n.flags=t[e],e+=1,n.iterations=ar(t,e),e+=2;let o=t[e];e+=1,n.salt=t.slice(e,e+o),e+=o;let s=t[e];return e+=1,n.nextDomain=t.slice(e,e+s),e+=s,n.rrtypes=cd.decode(t,e,i-(e-r)),e+=cd.decode.bytes,J5.decode.bytes=e-r,n},encodingLength(t){return 8+t.salt.length+t.nextDomain.length+cd.encodingLength(t.rrtypes)}}),Y5=jn({encode(t,e,r){e||(e=new Uint8Array(Y5.encodingLength(t))),r||(r=0);let n=r,i=t.digest;if(!s0(i))throw new Error("Digest must be a Buffer");return r+=2,wt(e,t.keyTag,r),r+=2,e[r]=t.algorithm,r+=1,e[r]=t.digestType,r+=1,_c(i,e,r,0,i.length),r+=i.length,Y5.encode.bytes=r-n,wt(e,Y5.encode.bytes-2,n),e},decode(t,e){e||(e=0);let r=e,n={},i=ar(t,e);return e+=2,n.keyTag=ar(t,e),e+=2,n.algorithm=t[e],e+=1,n.digestType=t[e],e+=1,n.digest=t.slice(e,r+i+2),e+=n.digest.length,Y5.decode.bytes=e-r,n},encodingLength(t){return 6+jp(t.digest)}}),b_=jn({encode(t,e,r){e||(e=new Uint8Array(b_.encodingLength(t))),r||(r=0);let n=r;r+=2,e[r]=t.algorithm,r+=1,e[r]=t.hash,r+=1;let i=CF(t.fingerprint),o=NF(t.hash);if(i!==o)throw new Error(`Invalid length of fingerprint "${t.fingerprint}" for hashType=${t.hash}: ${i} != ${o}`);return Eve(e,t.fingerprint,r,r+=i),b_.encode.bytes=r-n,wt(e,b_.encode.bytes-2,n),e},decode(t,e){e||(e=0);let r=e,n={};e+=2,n.algorithm=t[e],e+=1,n.hash=t[e],e+=1;let i=NF(n.hash);return n.fingerprint=xve(t,e,e+i),e+=i,b_.decode.bytes=e-r,n},encodingLength(t){return 4+CF(t.fingerprint)}});function NF(t){if(t===1)return 20;if(t===2)return 32;throw new Error(`Invalid hashType=${t}, supported=1,2`)}b_.getFingerprintLengthForHashType=NF;function jF(t){switch(t.toUpperCase()){case"A":return kve;case"PTR":return __;case"CNAME":return __;case"DNAME":return __;case"TXT":return pR;case"NULL":return yR;case"AAAA":return bR;case"SRV":return gR;case"HINFO":return mR;case"CAA":return a0;case"NS":return fR;case"SOA":return hR;case"MX":return vR;case"OPT":return c0;case"DNSKEY":return Gf;case"RRSIG":return H5;case"RP":return W5;case"NSEC":return G5;case"NSEC3":return J5;case"SSHFP":return b_;case"DS":return Y5}return lR}var lu=jn({encode(t,e,r){e||(e=new Uint8Array(lu.encodingLength(t))),r||(r=0);let n=r;if(st.encode(t.name,e,r),r+=st.encode.bytes,wt(e,y_(t.type),r),t.type.toUpperCase()==="OPT"){if(t.name!==".")throw new Error("OPT name must be root.");wt(e,t.udpPayloadSize||4096,r+2),e[r+4]=t.extendedRcode||0,e[r+5]=t.ednsVersion||0,wt(e,t.flags||0,r+6),r+=8,c0.encode(t.options||[],e,r),r+=c0.encode.bytes}else{let i=OF(t.class===void 0?"IN":t.class);t.flush&&(i|=$F),wt(e,i,r+2),Wf(e,t.ttl||0,r+4),r+=8;let o=jF(t.type);o.encode(t.data,e,r),r+=o.encode.bytes}return lu.encode.bytes=r-n,e},decode(t,e){e||(e=0);let r={},n=e;if(r.name=st.decode(t,e),e+=st.decode.bytes,r.type=z5(ar(t,e)),r.type==="OPT")r.udpPayloadSize=ar(t,e+2),r.extendedRcode=t[e+4],r.ednsVersion=t[e+5],r.flags=ar(t,e+6),r.flag_do=(r.flags>>15&1)===1,r.options=c0.decode(t,e+8),e+=8+c0.decode.bytes;else{let i=ar(t,e+2);r.ttl=Hf(t,e+4),r.class=BF(i&rtt),r.flush=!!(i&$F);let o=jF(r.type);r.data=o.decode(t,e+8),e+=8+o.decode.bytes}return lu.decode.bytes=e-n,r},encodingLength(t){let e=t.data!==null&&t.data!==void 0?t.data:t.options;return st.encodingLength(t.name)+8+jF(t.type).encodingLength(e)}}),x_=jn({encode(t,e,r){e||(e=new Uint8Array(x_.encodingLength(t))),r||(r=0);let n=r;return st.encode(t.name,e,r),r+=st.encode.bytes,wt(e,y_(t.type),r),r+=2,wt(e,OF(t.class===void 0?"IN":t.class),r),r+=2,x_.encode.bytes=r-n,t},decode(t,e){e||(e=0);let r=e,n={};return n.name=st.decode(t,e),e+=st.decode.bytes,n.type=z5(ar(t,e)),e+=2,n.class=BF(ar(t,e)),e+=2,!!(n.class&Ave)&&(n.class&=ntt),x_.decode.bytes=e-r,n},encodingLength(t){return st.encodingLength(t.name)+4}});var E_=1024;var Ds={encode:function(t,e,r){let n=!e;n&&(e=new Uint8Array(itt(t))),r||(r=0);let i=r;return t.questions||(t.questions=[]),t.answers||(t.answers=[]),t.authorities||(t.authorities=[]),t.additionals||(t.additionals=[]),v_.encode(t,e,r),r+=v_.encode.bytes,r=Z5(t.questions,x_,e,r),r=Z5(t.answers,lu,e,r),r=Z5(t.authorities,lu,e,r),r=Z5(t.additionals,lu,e,r),Ds.encode.bytes=r-i,n&&Np.bytes!==e.length?e.slice(0,Np.bytes):e},decode:function(t,e){e||(e=0);let r=e,n=v_.decode(t,e);return e+=v_.decode.bytes,e=uR(n.questions,x_,t,e),e=uR(n.answers,lu,t,e),e=uR(n.authorities,lu,t,e),e=uR(n.additionals,lu,t,e),Ds.decode.bytes=e-r,n},encodingLength:function(t){return v_.encodingLength(t)+w_(t.questions||[],x_)+w_(t.answers||[],lu)+w_(t.authorities||[],lu)+w_(t.additionals||[],lu)}};Ds.encode.bytes=0;Ds.decode.bytes=0;function wR(t,e){if(t.questions)throw new Error("Only one .question object expected instead of a .questions array!");let r=Object.assign({type:e},t);return r.question&&(r.questions=[r.question],delete r.question),r}var _R={encode:function(t,e,r){return e=Ds.encode(wR(t,"query"),e,r),_R.encode.bytes=Ds.encode.bytes,e},decode:function(t,e){let r=Ds.decode(t,e);return _R.decode.bytes=Ds.decode.bytes,r.questions&&(r.question=r.questions[0],delete r.questions),r},encodingLength:function(t){return Ds.encodingLength(wR(t,"query"))}};_R.encode.bytes=0;_R.decode.bytes=0;var xR={encode:function(t,e,r){return e=Ds.encode(wR(t,"response"),e,r),xR.encode.bytes=Ds.encode.bytes,e},decode:function(t,e){let r=Ds.decode(t,e);return xR.decode.bytes=Ds.decode.bytes,r.questions&&(r.question=r.questions[0],delete r.questions),r},encodingLength:function(t){return Ds.encodingLength(wR(t,"response"))}};xR.encode.bytes=0;xR.decode.bytes=0;var Np=Ds.encode,d0=Ds.decode,itt=Ds.encodingLength;function Pve(t){let e=Np(t),r=new Uint8Array(2+e.byteLength);return wt(r,e.byteLength),_c(e,r,2,0,e.length),Pve.bytes=r.byteLength,r}Pve.bytes=0;function Ive(t){let e=ar(t,0);if(t.byteLength<e+2)return null;let r=d0(t.slice(2));return Ive.bytes=d0.bytes,r}Ive.bytes=0;function w_(t,e){let r=0;for(let n=0;n<t.length;n++)r+=e.encodingLength(t[n]);return r}function Z5(t,e,r,n){for(let i=0;i<t.length;i++)e.encode(t[i],r,n),n+=e.encode.bytes;return n}function uR(t,e,r,n){for(let i=0;i<t.length;i++)t[i]=e.decode(r,n),n+=e.decode.bytes;return n}f();var Rve=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},fu=class{static getSigningMethod(e){return Rve(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,r){return Rve(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}};var Wo=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Bve=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Ove="https://diddht.tbddev.org",ott=0,u0=7200,ER=";",Ha=",",UF;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(UF||(UF={}));var Wa;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(Wa||(Wa={}));var KF;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(KF||(KF={}));var Dve={Ed25519:Wa.Ed25519,ES256K:Wa.secp256k1,ES256:Wa.secp256r1,"P-256":Wa.secp256r1,secp256k1:Wa.secp256k1,secp256r1:Wa.secp256r1,X25519:Wa.X25519},Mve={[Wa.Ed25519]:"EdDSA",[Wa.secp256k1]:"ES256K",[Wa.secp256r1]:"ES256",[Wa.X25519]:"ECDH-ES+A256KW"},Eb=class t extends fu{static create(){return Wo(this,arguments,void 0,function*({keyManager:e=new ma,options:r={}}={}){var n,i,o,s,a,d,u,c,l,h,y;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(j=>!(j.algorithm in Dve)))throw new Error("One or more verification method algorithms are not supported");let g=(i=r.verificationMethods)===null||i===void 0?void 0:i.filter(j=>"id"in j).map(j=>j.id);if(g&&g.length!==new Set(g).size)throw new Error("One or more verification method IDs are not unique");if(!((o=r.services)===null||o===void 0)&&o.some(j=>!j.id||!j.type||!j.serviceEndpoint))throw new Error("One or more services are missing required properties");let v=yield e.generateKey({algorithm:"Ed25519"}),x=yield e.getPublicKey({keyUri:v}),S=yield Ho.identityKeyToIdentifier({identityKey:x}),A=Object.assign(Object.assign({id:S},r.alsoKnownAs&&{alsoKnownAs:r.alsoKnownAs}),r.controllers&&{controller:r.controllers}),T=[...(s=r.verificationMethods)!==null&&s!==void 0?s:[]];T?.some(j=>{var K;return((K=j.id)===null||K===void 0?void 0:K.split("#").pop())==="0"})||T.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(let j of T){let K=j.id&&j.id.split("#").pop()==="0"?v:yield e.generateKey({algorithm:j.algorithm}),F=yield e.getPublicKey({keyUri:K}),L=(d=(a=j.id)!==null&&a!==void 0?a:F.kid)!==null&&d!==void 0?d:yield wr({jwk:F});L=`${S}#${ad(L)}`,(u=A.verificationMethod)!==null&&u!==void 0||(A.verificationMethod=[]),A.verificationMethod.push({id:L,type:"JsonWebKey",controller:(c=j.controller)!==null&&c!==void 0?c:S,publicKeyJwk:F});for(let V of(l=j.purposes)!==null&&l!==void 0?l:[])A[V]||(A[V]=[]),A[V].push(L)}(h=r.services)===null||h===void 0||h.forEach(j=>{var K;(K=A.service)!==null&&K!==void 0||(A.service=[]),j.id=`${S}#${j.id.split("#").pop()}`,A.service.push(j)});let $=new wc({uri:S,document:A,metadata:Object.assign({published:!1},r.types&&{types:r.types}),keyManager:e});if(!((y=r.publish)!==null&&y!==void 0)||y){let j=yield t.publish({did:$,gatewayUri:r.gatewayUri});$.metadata=j.didDocumentMetadata}return $})}static import(e){return Wo(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ma}){var i;let o=Tr.parse(r.uri);if(o?.method!==t.methodName)throw new ct(tt.MethodNotSupported,"Method not supported");let s=yield wc.import({portableDid:r,keyManager:n});if(!(!((i=s.document.verificationMethod)===null||i===void 0)&&i.some(a=>{var d;return((d=a.id)===null||d===void 0?void 0:d.split("#").pop())==="0"})))throw new ct(tt.InvalidDidDocument,"DID document must contain an Identity Key");return s})}static getSigningMethod(e){return Wo(this,arguments,void 0,function*({didDocument:r,methodId:n="#0"}){var i;let o=Tr.parse(r.id);if(o&&o.method!==this.methodName)throw new ct(tt.MethodNotSupported,`Method not supported: ${o.method}`);let s=(i=r.verificationMethod)===null||i===void 0?void 0:i.find(a=>{var d,u;return ad(a.id)===((d=ad(n))!==null&&d!==void 0?d:ad((u=r.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(s&&s.publicKeyJwk))throw new ct(tt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static publish(e){return Wo(this,arguments,void 0,function*({did:r,gatewayUri:n=Ove}){return yield SR.put({did:r,gatewayUri:n})})}static resolve(e){return Wo(this,arguments,void 0,function*(r,n={}){var i;let o=(i=n?.gatewayUri)!==null&&i!==void 0?i:Ove;try{yield Ho.identifierToIdentityKey({didUri:r});let{didDocument:s,didDocumentMetadata:a}=yield SR.get({didUri:r,gatewayUri:o});return Object.assign(Object.assign({},hi),{didDocument:s,didDocumentMetadata:a})}catch(s){if(!(s instanceof ct))throw new Error(s);return Object.assign(Object.assign({},hi),{didResolutionMetadata:Object.assign({error:s.code},s.message&&{errorMessage:s.message})})}})}};Eb.methodName="dht";var SR=class t{static get(e){return Wo(this,arguments,void 0,function*({didUri:r,gatewayUri:n}){let i=Ho.identifierToIdentityKeyBytes({didUri:r}),o=yield t.pkarrGet({gatewayUri:n,publicKeyBytes:i}),s=yield Ho.parseBep44GetMessage({bep44Message:o}),a=yield t.fromDnsPacket({didUri:r,dnsPacket:s});return a.didDocumentMetadata.versionId=o.seq.toString(),a})}static put(e){return Wo(this,arguments,void 0,function*({did:r,gatewayUri:n}){let i=yield t.toDnsPacket({didDocument:r.document,didMetadata:r.metadata,authoritativeGatewayUris:[n]}),o=yield Ho.createBep44PutMessage({dnsPacket:i,publicKeyBytes:Ho.identifierToIdentityKeyBytes({didUri:r.uri}),signer:yield r.getSigner({methodId:"0"})}),s=yield t.pkarrPut({gatewayUri:n,bep44Message:o});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:s,versionId:o.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return Wo(this,arguments,void 0,function*({gatewayUri:r,publicKeyBytes:n}){let i=le.uint8Array(n).toBase32Z(),o=new URL(i,r).href,s;try{if(s=yield fetch(o,{method:"GET"}),!s.ok)throw new ct(tt.NotFound,`Pkarr record not found for: ${i}`)}catch(u){throw u instanceof ct?u:new ct(tt.InternalError,`Failed to fetch Pkarr record: ${u.message}`)}let a=yield s.arrayBuffer();if(!a)throw new ct(tt.NotFound,`Pkarr record not found for: ${i}`);if(a.byteLength<72)throw new ct(tt.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new ct(tt.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:n,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return Wo(this,arguments,void 0,function*({gatewayUri:r,bep44Message:n}){let i=le.uint8Array(n.k).toBase32Z(),o=new URL(i,r).href,s=new Uint8Array(n.v.length+72);s.set(n.sig,0),new DataView(s.buffer).setBigUint64(n.sig.length,BigInt(n.seq)),s.set(n.v,n.sig.length+8);let a;try{a=yield fetch(o,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:s})}catch(d){throw new ct(tt.InternalError,`Failed to put Pkarr record for identifier ${i}: ${d.message}`)}return a.ok})}static fromDnsPacket(e){return Wo(this,arguments,void 0,function*({didUri:r,dnsPacket:n}){var i,o,s;let a={id:r},d={published:!0},u=new Map;for(let c of(i=n?.answers)!==null&&i!==void 0?i:[]){if(c.type!=="TXT")continue;let l=c.name.split(".")[0].substring(1);switch(!0){case l.startsWith("aka"):{let h=Ho.parseTxtDataToString(c.data);a.alsoKnownAs=h.split(Ha);break}case l.startsWith("cnt"):{let h=Ho.parseTxtDataToString(c.data);a.controller=h.includes(Ha)?h.split(Ha):h;break}case l.startsWith("k"):{let{id:h,t:y,k:g,c:v,a:x}=Ho.parseTxtDataToObject(c.data),S=le.base64Url(g).toUint8Array(),A=Wa[Number(y)],T=yield Ho.keyConverter(A).bytesToPublicKey({publicKeyBytes:S});T.alg=x||Mve[Number(y)];let $=l==="k0"?"0":h!==void 0?h:yield wr({jwk:T});(o=a.verificationMethod)!==null&&o!==void 0||(a.verificationMethod=[]);let j=`${r}#${$}`;a.verificationMethod.push({id:j,type:"JsonWebKey",controller:v??r,publicKeyJwk:T}),u.set(l,j);break}case l.startsWith("s"):{let h=Ho.parseTxtDataToObject(c.data),{id:y,t:g,se:v}=h,x=Bve(h,["id","t","se"]),S=v.includes(Ha)?v.split(Ha):[v],A=Object.fromEntries(Object.entries(x).map(([T,$])=>[T,$.includes(Ha)?$.split(Ha):$]));(s=a.service)!==null&&s!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},A),{id:`${r}#${y}`,type:g,serviceEndpoint:S}));break}case l.startsWith("typ"):{let{id:h}=Ho.parseTxtDataToObject(c.data);d.types=h.split(Ha).map(y=>Number(y));break}case l.startsWith("did"):{let h=A=>A.split(Ha).map(T=>u.get(T)).filter(T=>typeof T=="string"),{auth:y,asm:g,del:v,inv:x,agm:S}=Ho.parseTxtDataToObject(c.data);y&&(a.authentication=h(y)),g&&(a.assertionMethod=h(g)),v&&(a.capabilityDelegation=h(v)),x&&(a.capabilityInvocation=h(x)),S&&(a.keyAgreement=h(S));break}}}return{didDocument:a,didDocumentMetadata:d,didResolutionMetadata:{}}})}static toDnsPacket(e){return Wo(this,arguments,void 0,function*({didDocument:r,didMetadata:n,authoritativeGatewayUris:i,previousDidProof:o}){var s,a,d,u,c;let l=[],h=[],y=new Map,g=[],v=[];if(o!==void 0){let{signature:A,previousDid:T}=o;yield Ho.validatePreviousDidProof({newDid:r.id,previousDidProof:o}),l.push({type:"TXT",name:"_prv._did.",ttl:u0,data:`id=${T};s=${A}`})}if(r.alsoKnownAs&&l.push({type:"TXT",name:"_aka._did.",ttl:u0,data:r.alsoKnownAs.join(Ha)}),r.controller){let A=Array.isArray(r.controller)?r.controller.join(Ha):r.controller;l.push({type:"TXT",name:"_cnt._did.",ttl:u0,data:A})}for(let[A,T]of(a=(s=r.verificationMethod)===null||s===void 0?void 0:s.entries())!==null&&a!==void 0?a:[]){let $=`k${A}`;v.push($);let j=T.id.split("#").pop();y.set(j,$);let K=T.publicKeyJwk;if(!(K?.crv&&K.crv in Dve))throw new ct(tt.InvalidPublicKeyType,`Verification method '${T.id}' contains an unsupported key type: ${(d=K?.crv)!==null&&d!==void 0?d:"undefined"}`);let F=Wa[K.crv],L=yield Ho.keyConverter(K.crv).publicKeyToBytes({publicKey:K}),V=le.uint8Array(L).toBase64Url(),q=[`t=${F}`,`k=${V}`];j!=="0"&&(yield wr({jwk:K}))!==j&&q.unshift(`id=${j}`),K.alg!==Mve[F]&&q.push(`a=${K.alg}`),T.controller!==r.id&&q.push(`c=${T.controller}`),l.push({type:"TXT",name:`_${$}._did.`,ttl:u0,data:q.join(ER)})}(u=r.service)===null||u===void 0||u.forEach((A,T)=>{let $=`s${T}`;g.push($);let{id:j,type:K,serviceEndpoint:F}=A,L=Bve(A,["id","type","serviceEndpoint"]);j=ad(j),F=Array.isArray(F)?F.join(","):F;let q=Object.entries(Object.assign({id:j,t:K,se:F},L)).map(([P,B])=>`${P}=${B}`).join(ER),k=Ho.chunkDataIfNeeded(q);l.push({type:"TXT",name:`_${$}._did.`,ttl:u0,data:k})});let x=[`v=${ott}`];if(v.length&&x.push(`vm=${v.join(Ha)}`),Object.keys(zv).forEach(A=>{var T;let $=(T=r[A])===null||T===void 0?void 0:T.map(j=>y.get(j.split("#").pop()));if($){let j=KF[A];x.push(`${j}=${$.join(Ha)}`)}}),g.length&&x.push(`svc=${g.join(Ha)}`),!((c=n.types)===null||c===void 0)&&c.length){let T=n.types.map($=>typeof $=="string"?UF[$]:$);l.push({type:"TXT",name:"_typ._did.",ttl:u0,data:`id=${T.join(Ha)}`})}l.push({type:"TXT",name:"_did."+t.getUniqueDidSuffix(r.id)+".",ttl:u0,data:x.join(ER)});for(let A of i||[])h.push({type:"NS",name:"_did."+t.getUniqueDidSuffix(r.id)+".",ttl:u0,data:A+"."});return{id:0,type:"response",flags:E_,answers:[...l,...h]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}},Ho=class t{static createBep44PutMessage(e){return Wo(this,arguments,void 0,function*({dnsPacket:r,publicKeyBytes:n,signer:i}){let o=Math.ceil(Date.now()/1e3),s=Np(r),a=Dp.encode({seq:o,v:s}).subarray(1,-1);if(a.length>1e3)throw new ct(tt.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);let d=yield i.sign({data:a});return{k:n,seq:o,sig:d,v:s}})}static identifierToIdentityKey(e){return Wo(this,arguments,void 0,function*({didUri:r}){let n=t.identifierToIdentityKeyBytes({didUri:r});return yield go.bytesToPublicKey({publicKeyBytes:n})})}static identifierToIdentityKeyBytes({didUri:e}){let r=Tr.parse(e);if(!r)throw new ct(tt.InvalidDid,`Invalid DID URI: ${e}`);if(r.method!==Eb.methodName)throw new ct(tt.MethodNotSupported,`Method not supported: ${r.method}`);let n;try{n=le.base32Z(r.id).toUint8Array()}catch{throw new ct(tt.InvalidPublicKey,"Failed to decode method-specific identifier")}if(n.length!==32)throw new ct(tt.InvalidPublicKeyLength,`Invalid public key length: ${n.length}`);return n}static identityKeyToIdentifier(e){return Wo(this,arguments,void 0,function*({identityKey:r}){let n=yield go.publicKeyToBytes({publicKey:r}),i=le.uint8Array(n).toBase32Z();return`did:${Eb.methodName}:${i}`})}static keyConverter(e){let n={Ed25519:go,"P-256":{publicKeyToBytes:i=>Wo(this,[i],void 0,function*({publicKey:o}){let s=yield Ms.publicKeyToBytes({publicKey:o});return yield Ms.compressPublicKey({publicKeyBytes:s})}),bytesToPublicKey:Ms.bytesToPublicKey,privateKeyToBytes:Ms.privateKeyToBytes,bytesToPrivateKey:Ms.bytesToPrivateKey},secp256k1:{publicKeyToBytes:i=>Wo(this,[i],void 0,function*({publicKey:o}){let s=yield Vo.publicKeyToBytes({publicKey:o});return yield Vo.compressPublicKey({publicKeyBytes:s})}),bytesToPublicKey:Vo.bytesToPublicKey,privateKeyToBytes:Vo.privateKeyToBytes,bytesToPrivateKey:Vo.bytesToPrivateKey},X25519:h_}[e];if(!n)throw new ct(tt.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static parseBep44GetMessage(e){return Wo(this,arguments,void 0,function*({bep44Message:r}){let n=yield go.bytesToPublicKey({publicKeyBytes:r.k}),i=Dp.encode({seq:r.seq,v:r.v}).subarray(1,-1);if(!(yield go.verify({key:n,signature:r.sig,data:i})))throw new ct(tt.InvalidSignature,"Invalid signature for DHT BEP44 message");return d0(r.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(ER).reduce((r,n)=>{let[i,o]=n.split("=");return r[i]=o,r},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return le.uint8Array(e).toString();if(Array.isArray(e))return e.map(r=>this.parseTxtDataToString(r)).join("");throw new ct(tt.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return Wo(this,arguments,void 0,function*({newDid:r,previousDidProof:n}){let i=yield t.identifierToIdentityKey({didUri:n.previousDid}),o=t.identifierToIdentityKeyBytes({didUri:r}),s=le.base64Url(n.signature).toUint8Array();if(!(yield go.verify({key:i,data:o,signature:s})))throw new ct(tt.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;let r=[];for(let n=0;n<e.length;n+=255)r.push(e.slice(n,n+255));return r}};f();f();f();f();f();var Zn={DeltaExceedsMaximumSize:"DeltaExceedsMaximumSize",DidDocumentPublicKeyIdDuplicated:"DidDocumentPublicKeyIdDuplicated",DidDocumentPublicKeyMissingOrIncorrectType:"DidDocumentPublicKeyMissingOrIncorrectType",DidDocumentServiceIdDuplicated:"DidDocumentServiceIdDuplicated",DidSuffixIncorrectLength:"DidSuffixIncorrectLength",EncodedStringIncorrectEncoding:"EncodedStringIncorrectEncoding",IdNotUsingBase64UrlCharacterSet:"IdNotUsingBase64UrlCharacterSet",IdTooLong:"IdTooLong",JwkEs256kMissingOrInvalidCrv:"JwkEs256kMissingOrInvalidCrv",JwkEs256kMissingOrInvalidKty:"JwkEs256kMissingOrInvalidKty",JwkEs256kHasIncorrectLengthOfX:"JwkEs256kHasIncorrectLengthOfX",JwkEs256kHasIncorrectLengthOfY:"JwkEs256kHasIncorrectLengthOfY",JwkEs256kHasIncorrectLengthOfD:"JwkEs256kHasIncorrectLengthOfD",MultihashStringNotAMultihash:"MultihashStringNotAMultihash",MultihashUnsupportedHashAlgorithm:"MultihashUnsupportedHashAlgorithm",PublicKeyJwkEs256kHasUnexpectedProperty:"PublicKeyJwkEs256kHasUnexpectedProperty",PublicKeyPurposeDuplicated:"PublicKeyPurposeDuplicated",ServiceEndpointCannotBeAnArray:"ServiceEndpointCannotBeAnArray",ServiceEndpointStringNotValidUri:"ServiceEndpointStringNotValidUri",ServiceTypeTooLong:"ServiceTypeTooLong"};f();var kn=class extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,Object.setPrototypeOf(this,new.target.prototype)}};var xc=class t{static encode(e){return Lw.baseEncode(e)}static decodeAsBytes(e,r){if(!t.isBase64UrlString(e))throw new kn(Zn.EncodedStringIncorrectEncoding,`Given ${r} must be base64url string.`);return Lw.baseDecode(e)}static decodeAsString(e,r){let n=t.decodeAsBytes(e,r);return t.bytesToString(n)}static isBase64UrlString(e){return/^[A-Za-z0-9_-]+$/.test(e)}static stringToBytes(e){return new TextEncoder().encode(e)}static bytesToString(e){return new TextDecoder().decode(e)}};f();var Nve=xt(LU(),1);f();f();var qF;(function(t){t.Public="public",t.Private="private"})(qF||(qF={}));var dd=qF;var bo=class{static validateEs256kOperationKey(e,r){let n=new Set(["kty","crv","x","y"]);r===dd.Private&&n.add("d");for(let i in e)if(!n.has(i))throw new kn(Zn.PublicKeyJwkEs256kHasUnexpectedProperty,`SECP256K1 JWK key has unexpected property '${i}'.`);if(e.crv!=="secp256k1")throw new kn(Zn.JwkEs256kMissingOrInvalidCrv,`SECP256K1 JWK 'crv' property must be 'secp256k1' but got '${e.crv}.'`);if(e.kty!=="EC")throw new kn(Zn.JwkEs256kMissingOrInvalidKty,`SECP256K1 JWK 'kty' property must be 'EC' but got '${e.kty}.'`);if(e.x.length!==43)throw new kn(Zn.JwkEs256kHasIncorrectLengthOfX,"SECP256K1 JWK 'x' property must be 43 bytes.");if(e.y.length!==43)throw new kn(Zn.JwkEs256kHasIncorrectLengthOfY,"SECP256K1 JWK 'y' property must be 43 bytes.");if(r===dd.Private&&(e.d===void 0||e.d.length!==43))throw new kn(Zn.JwkEs256kHasIncorrectLengthOfD,"SECP256K1 JWK 'd' property must be 43 bytes.")}static validateId(e){if(e.length>50)throw new kn(Zn.IdTooLong,`Key ID length ${e.length} exceed max allowed length of 50.`);if(!xc.isBase64UrlString(e))throw new kn(Zn.IdNotUsingBase64UrlCharacterSet,`Key ID '${e}' is not a Base64URL string.`)}static validatePublicKeyPurposes(e){if(e===void 0)return;let r=new Set;for(let n of e){if(r.has(n))throw new kn(Zn.PublicKeyPurposeDuplicated,`Public key purpose '${n}' already specified.`);r.add(n)}}};f();var X5=class{};X5.hashAlgorithmInMultihashCode=18;X5.maxCanonicalizedDeltaSizeInBytes=1e3;var Ga=X5;f();var $ve=xt(jve(),1);var bl=class t{static canonicalizeAsBytes(e){let r=t.removeAllUndefinedProperties(e),n=$ve.default(r);return xc.stringToBytes(n)}static removeAllUndefinedProperties(e){for(let r in e)typeof e[r]=="object"?t.removeAllUndefinedProperties(e[r]):e[r]===void 0&&delete e[r];return e}};f();var Q5=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Go=class t{static hash(e,r){return Q5(this,void 0,void 0,function*(){let n;switch(r){case 18:n=(yield tE.digest(e)).bytes;break;default:throw new kn(Zn.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${r} is not supported.`)}return n})}static hashAsNonMultihashBytes(e,r){return Q5(this,void 0,void 0,function*(){let n;switch(r){case 18:n=yield tE.encode(e);break;default:throw new kn(Zn.MultihashUnsupportedHashAlgorithm,`Hash algorithm defined in multihash code ${r} is not supported.`)}return n})}static canonicalizeThenHashThenEncode(e,r){return Q5(this,void 0,void 0,function*(){let n=bl.canonicalizeAsBytes(e);return yield t.hashThenEncode(n,r)})}static canonicalizeThenDoubleHashThenEncode(e,r){return Q5(this,void 0,void 0,function*(){let n=bl.canonicalizeAsBytes(e),i=yield t.hashAsNonMultihashBytes(n,r);return yield t.hashThenEncode(i,r)})}static hashThenEncode(e,r){return Q5(this,void 0,void 0,function*(){let n=yield t.hash(e,r);return xc.encode(n)})}static validateEncodedHashComputedUsingSupportedHashAlgorithm(e,r){let n,i=xc.decodeAsBytes(e,r);try{n=H8(i)}catch{throw new kn(Zn.MultihashStringNotAMultihash,`Given ${r} string '${e}' is not a multihash after decoding.`)}let o=Ga.hashAlgorithmInMultihashCode;if(o!==n.code)throw new kn(Zn.MultihashUnsupportedHashAlgorithm,`Given ${r} uses unsupported multihash algorithm with code ${n.code}, should use ${o} or change IonSdkConfig to desired hashing algorithm.`)}};f();var LF;(function(t){t.Create="create",t.Update="update",t.Deactivate="deactivate",t.Recover="recover"})(LF||(LF={}));var e3=LF;f();var FF;(function(t){t.Replace="replace",t.AddPublicKeys="add-public-keys",t.RemovePublicKeys="remove-public-keys",t.AddServices="add-services",t.RemoveServices="remove-services"})(FF||(FF={}));var Sb=FF;var TR=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},hu=class t{static createCreateRequest(e){return TR(this,void 0,void 0,function*(){let r=e.recoveryKey,n=e.updateKey,i=e.document.publicKeys,o=e.document.services;bo.validateEs256kOperationKey(r,dd.Public),bo.validateEs256kOperationKey(n,dd.Public),t.validateDidDocumentKeys(i),t.validateServices(o);let s=Ga.hashAlgorithmInMultihashCode,a=[{action:Sb.Replace,document:e.document}],d={updateCommitment:yield Go.canonicalizeThenDoubleHashThenEncode(n,s),patches:a};t.validateDeltaSize(d);let c={deltaHash:yield Go.canonicalizeThenHashThenEncode(d,s),recoveryCommitment:yield Go.canonicalizeThenDoubleHashThenEncode(r,s)};return{type:e3.Create,suffixData:c,delta:d}})}static createDeactivateRequest(e){return TR(this,void 0,void 0,function*(){t.validateDidSuffix(e.didSuffix),bo.validateEs256kOperationKey(e.recoveryPublicKey,dd.Public);let r=Ga.hashAlgorithmInMultihashCode,n=yield Go.canonicalizeThenHashThenEncode(e.recoveryPublicKey,r),i={didSuffix:e.didSuffix,recoveryKey:e.recoveryPublicKey},o=yield e.signer.sign({alg:"ES256K"},i);return{type:e3.Deactivate,didSuffix:e.didSuffix,revealValue:n,signedData:o}})}static createRecoverRequest(e){return TR(this,void 0,void 0,function*(){t.validateDidSuffix(e.didSuffix),bo.validateEs256kOperationKey(e.recoveryPublicKey,dd.Public),bo.validateEs256kOperationKey(e.nextRecoveryPublicKey,dd.Public),bo.validateEs256kOperationKey(e.nextUpdatePublicKey,dd.Public),t.validateDidDocumentKeys(e.document.publicKeys),t.validateServices(e.document.services);let r=Ga.hashAlgorithmInMultihashCode,n=yield Go.canonicalizeThenHashThenEncode(e.recoveryPublicKey,r),i=[{action:Sb.Replace,document:e.document}],o=yield Go.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,r),s={patches:i,updateCommitment:o},a=yield Go.canonicalizeThenHashThenEncode(s,r),u={recoveryCommitment:yield Go.canonicalizeThenDoubleHashThenEncode(e.nextRecoveryPublicKey,r),recoveryKey:e.recoveryPublicKey,deltaHash:a},c=yield e.signer.sign({alg:"ES256K"},u);return{type:e3.Recover,didSuffix:e.didSuffix,revealValue:n,delta:s,signedData:c}})}static createUpdateRequest(e){return TR(this,void 0,void 0,function*(){if(t.validateDidSuffix(e.didSuffix),bo.validateEs256kOperationKey(e.updatePublicKey,dd.Public),bo.validateEs256kOperationKey(e.nextUpdatePublicKey,dd.Public),t.validateServices(e.servicesToAdd),t.validateDidDocumentKeys(e.publicKeysToAdd),e.idsOfServicesToRemove!==void 0)for(let g of e.idsOfServicesToRemove)bo.validateId(g);if(e.idsOfPublicKeysToRemove!==void 0)for(let g of e.idsOfPublicKeysToRemove)bo.validateId(g);let r=[],n=e.servicesToAdd;if(n!==void 0&&n.length>0){let g={action:Sb.AddServices,services:n};r.push(g)}let i=e.idsOfServicesToRemove;if(i!==void 0&&i.length>0){let g={action:Sb.RemoveServices,ids:i};r.push(g)}let o=e.publicKeysToAdd;if(o!==void 0&&o.length>0){let g={action:Sb.AddPublicKeys,publicKeys:o};r.push(g)}let s=e.idsOfPublicKeysToRemove;if(s!==void 0&&s.length>0){let g={action:Sb.RemovePublicKeys,ids:s};r.push(g)}let a=Ga.hashAlgorithmInMultihashCode,d=yield Go.canonicalizeThenHashThenEncode(e.updatePublicKey,a),u=yield Go.canonicalizeThenDoubleHashThenEncode(e.nextUpdatePublicKey,a),c={patches:r,updateCommitment:u},l=yield Go.canonicalizeThenHashThenEncode(c,a),h={updateKey:e.updatePublicKey,deltaHash:l},y=yield e.signer.sign({alg:"ES256K"},h);return{type:e3.Update,didSuffix:e.didSuffix,revealValue:d,delta:c,signedData:y}})}static validateDidSuffix(e){Go.validateEncodedHashComputedUsingSupportedHashAlgorithm(e,"didSuffix")}static validateDidDocumentKeys(e){if(e===void 0)return;let r=new Set;for(let n of e){if(Array.isArray(n.publicKeyJwk))throw new kn(Zn.DidDocumentPublicKeyMissingOrIncorrectType,"DID Document key 'publicKeyJwk' property is not a non-array object.");if(bo.validateId(n.id),r.has(n.id))throw new kn(Zn.DidDocumentPublicKeyIdDuplicated,`DID Document key with ID '${n.id}' already exists.`);r.add(n.id),bo.validatePublicKeyPurposes(n.purposes)}}static validateServices(e){if(e!==void 0&&e.length!==0){let r=new Set;for(let n of e){if(t.validateService(n),r.has(n.id))throw new kn(Zn.DidDocumentServiceIdDuplicated,"Service id has to be unique");r.add(n.id)}}}static validateService(e){bo.validateId(e.id);let r=30;if(e.type.length>r){let n=`Service endpoint type length ${e.type.length} exceeds max allowed length of ${r}.`;throw new kn(Zn.ServiceTypeTooLong,n)}if(Array.isArray(e.serviceEndpoint)){let n="Service endpoint value cannot be an array.";throw new kn(Zn.ServiceEndpointCannotBeAnArray,n)}if(typeof e.serviceEndpoint=="string"&&Nve.parse(e.serviceEndpoint).error!==void 0)throw new kn(Zn.ServiceEndpointStringNotValidUri,`Service endpoint string '${e.serviceEndpoint}' is not a URI.`)}static validateDeltaSize(e){let r=bl.canonicalizeAsBytes(e);if(r.length>Ga.maxCanonicalizedDeltaSizeInBytes){let n=`Delta of ${r.length} bytes exceeded limit of ${Ga.maxCanonicalizedDeltaSizeInBytes} bytes.`;throw new kn(Zn.DeltaExceedsMaximumSize,n)}}};var Uve=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Jf=class t{static createLongFormDid(e){return Uve(this,void 0,void 0,function*(){let r=yield hu.createCreateRequest(e),n=yield t.computeDidUniqueSuffix(r.suffixData),i;Ga.network===void 0||Ga.network==="mainnet"?i=`did:ion:${n}`:i=`did:ion:${Ga.network}:${n}`;let o={suffixData:r.suffixData,delta:r.delta},s=bl.canonicalizeAsBytes(o),a=xc.encode(s);return`${i}:${a}`})}static computeDidUniqueSuffix(e){return Uve(this,void 0,void 0,function*(){let r=bl.canonicalizeAsBytes(e),n=yield Go.hash(r,Ga.hashAlgorithmInMultihashCode);return xc.encode(n)})}};f();f();var Kve;(function(t){t.Mainnet="mainnet",t.Testnet="test"})(Kve||(Kve={}));f();var qve;(function(t){t.Authentication="authentication",t.AssertionMethod="assertionMethod",t.CapabilityInvocation="capabilityInvocation",t.CapabilityDelegation="capabilityDelegation",t.KeyAgreement="keyAgreement"})(qve||(qve={}));f();var l0=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Yf;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Yf||(Yf={}));var stt={Ed25519:Yf.Ed25519,ES256K:Yf.secp256k1,ES256:Yf.secp256r1,"P-256":Yf.secp256r1,secp256k1:Yf.secp256k1,secp256r1:Yf.secp256r1},Lve="https://ion.tbd.engineering",zF=class t extends fu{static create(){return l0(this,arguments,void 0,function*({keyManager:e=new ma,options:r={}}={}){var n,i,o,s,a,d,u;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(j=>!(j.algorithm in stt)))throw new Error("One or more verification method algorithms are not supported");let c=(i=r.verificationMethods)===null||i===void 0?void 0:i.filter(j=>"id"in j).map(j=>j.id);if(c&&c.length!==new Set(c).size)throw new Error("One or more verification method IDs are not unique");if(!((o=r.services)===null||o===void 0)&&o.some(j=>!j.id||!j.type||!j.serviceEndpoint))throw new Error("One or more services are missing required properties");let l={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},h=[];for(let j of(s=r.verificationMethods)!==null&&s!==void 0?s:[l]){let K=yield e.generateKey({algorithm:j.algorithm}),F=yield e.getPublicKey({keyUri:K});h.push({id:j.id,publicKeyJwk:F,purposes:(a=j.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}let y=yield e.generateKey({algorithm:Yf.secp256k1}),g=yield e.getPublicKey({keyUri:y}),v=yield e.generateKey({algorithm:Yf.secp256k1}),x=yield e.getPublicKey({keyUri:v}),S=yield Tb.computeLongFormDidUri({recoveryKey:g,updateKey:x,services:(d=r.services)!==null&&d!==void 0?d:[],verificationMethods:h}),{didDocument:A,didResolutionMetadata:T}=yield t.resolve(S,{gatewayUri:r.gatewayUri});if(A===null)throw new Error(`Unable to resolve DID during creation: ${T?.error}`);let $=new wc({uri:S,document:A,metadata:{published:!1,canonicalId:S.split(":",3).join(":"),recoveryKey:g,updateKey:x},keyManager:e});if(!((u=r.publish)!==null&&u!==void 0)||u){let j=yield t.publish({did:$,gatewayUri:r.gatewayUri});$.metadata=j.didDocumentMetadata}return $})}static getSigningMethod(e){return l0(this,arguments,void 0,function*({didDocument:r,methodId:n}){var i;let o=Tr.parse(r.id);if(o&&o.method!==this.methodName)throw new ct(tt.MethodNotSupported,`Method not supported: ${o.method}`);let s=(i=r.verificationMethod)===null||i===void 0?void 0:i.find(a=>{var d;return a.id===(n??((d=r.assertionMethod)===null||d===void 0?void 0:d[0]))});if(!(s&&s.publicKeyJwk))throw new ct(tt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static import(e){return l0(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ma}){let i=Tr.parse(r.uri);if(i?.method!==t.methodName)throw new ct(tt.MethodNotSupported,"Method not supported");return yield wc.import({portableDid:r,keyManager:n})})}static publish(e){return l0(this,arguments,void 0,function*({did:r,gatewayUri:n=Lve}){var i,o,s;let a=(o=(i=r.document.verificationMethod)===null||i===void 0?void 0:i.map(c=>({id:c.id,publicKeyJwk:c.publicKeyJwk,purposes:rve({didDocument:r.document,methodId:c.id})})))!==null&&o!==void 0?o:[],d=yield Tb.createIonDocument({services:(s=r.document.service)!==null&&s!==void 0?s:[],verificationMethods:a}),u=yield Tb.constructCreateRequest({ionDocument:d,recoveryKey:r.metadata.recoveryKey,updateKey:r.metadata.updateKey});try{let c=Tb.appendPathToUrl({baseUrl:n,path:"/operations"}),l=yield fetch(c,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:l.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:tt.InternalError,errorMessage:`Failed to publish DID document for: ${r.uri}`}}}})}static resolve(e){return l0(this,arguments,void 0,function*(r,n={}){var i,o;let s=Tr.parse(r);if(!s)return Object.assign(Object.assign({},hi),{didResolutionMetadata:{error:"invalidDid"}});if(s.method!==t.methodName)return Object.assign(Object.assign({},hi),{didResolutionMetadata:{error:"methodNotSupported"}});let a=(i=n?.gatewayUri)!==null&&i!==void 0?i:Lve;try{let d=Tb.appendPathToUrl({baseUrl:a,path:`/identifiers/${r}`}),u=yield fetch(d);if(!u.ok)throw new ct(tt.NotFound,`Unable to find DID document for: ${r}`);let{didDocument:c,didDocumentMetadata:l}=yield u.json();return Object.assign(Object.assign(Object.assign({},hi),c&&{didDocument:c}),{didDocumentMetadata:Object.assign({published:(o=l?.method)===null||o===void 0?void 0:o.published},l)})}catch(d){if(!(d instanceof ct))throw new Error(d);return Object.assign(Object.assign({},hi),{didResolutionMetadata:Object.assign({error:d.code},d.message&&{errorMessage:d.message})})}})}};zF.methodName="ion";var Tb=class t{static appendPathToUrl({baseUrl:e,path:r}){let n=new URL(e);return n.pathname=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",n.pathname+=r.startsWith("/")?r.substring(1):r,n.toString()}static computeLongFormDidUri(e){return l0(this,arguments,void 0,function*({recoveryKey:r,updateKey:n,services:i,verificationMethods:o}){let s=yield t.createIonDocument({services:i,verificationMethods:o}),a=t.normalizeJwk(r),d=t.normalizeJwk(n);return yield Jf.createLongFormDid({document:s,recoveryKey:a,updateKey:d})})}static constructCreateRequest(e){return l0(this,arguments,void 0,function*({ionDocument:r,recoveryKey:n,updateKey:i}){return yield hu.createCreateRequest({document:r,recoveryKey:t.normalizeJwk(n),updateKey:t.normalizeJwk(i)})})}static createIonDocument(e){return l0(this,arguments,void 0,function*({services:r,verificationMethods:n}){var i,o;let s=[];for(let u of n){let c=(o=(i=u.id)!==null&&i!==void 0?i:u.publicKeyJwk.kid)!==null&&o!==void 0?o:yield wr({jwk:u.publicKeyJwk});c=`${c.split("#").pop()}`;let l={id:c,publicKeyJwk:t.normalizeJwk(u.publicKeyJwk),purposes:u.purposes,type:"JsonWebKey2020"};s.push(l)}let a=r.map(u=>Object.assign(Object.assign({},u),{id:`${u.id.split("#").pop()}`}));return{publicKeys:s,services:a}})}static normalizeJwk(e){let r=e.kty,n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);return n}};f();var AR=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},t3=class t extends fu{static create(){return AR(this,arguments,void 0,function*({keyManager:e=new ma,options:r={}}={}){var n,i,o,s;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");let a=(s=(n=r.algorithm)!==null&&n!==void 0?n:(o=(i=r.verificationMethods)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.algorithm)!==null&&s!==void 0?s:"Ed25519",d=yield e.generateKey({algorithm:a}),u=yield e.getPublicKey({keyUri:d}),c=le.object(u).toBase64Url(),l=`did:${t.methodName}:${c}`,y=(yield t.resolve(l)).didDocument;return new wc({uri:l,document:y,metadata:{},keyManager:e})})}static getSigningMethod(e){return AR(this,arguments,void 0,function*({didDocument:r}){var n;let i=Tr.parse(r.id);if(i&&i.method!==this.methodName)throw new ct(tt.MethodNotSupported,`Method not supported: ${i.method}`);let[o]=(n=r.verificationMethod)!==null&&n!==void 0?n:[];if(!(o&&o.publicKeyJwk))throw new ct(tt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return AR(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ma}){let i=Tr.parse(r.uri);if(i?.method!==t.methodName)throw new ct(tt.MethodNotSupported,"Method not supported");let o=yield wc.import({portableDid:r,keyManager:n});if(o.document.verificationMethod.length!==1)throw new ct(tt.InvalidDidDocument,"DID document must contain exactly one verification method");return o})}static resolve(e,r){return AR(this,void 0,void 0,function*(){let n=Tr.parse(e),i;try{i=le.base64Url(n.id).toObject()}catch{}if(!n||!i)return Object.assign(Object.assign({},hi),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==t.methodName)return Object.assign(Object.assign({},hi),{didResolutionMetadata:{error:"methodNotSupported"}});let o={"@context":["https://www.w3.org/ns/did/v1"],id:n.uri},s=`${o.id}#0`;switch(o.verificationMethod=[{id:s,type:"JsonWebKey",controller:o.id,publicKeyJwk:i}],o.authentication=[s],o.assertionMethod=[s],o.capabilityInvocation=[s],o.capabilityDelegation=[s],o.keyAgreement=[s],i.use){case"sig":{delete o.keyAgreement;break}case"enc":{delete o.authentication,delete o.assertionMethod,delete o.capabilityInvocation,delete o.capabilityDelegation;break}}return Object.assign(Object.assign({},hi),{didDocument:o})})}};t3.methodName="jwk";f();var wl=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Up;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Up||(Up={}));var VF={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},att={Ed25519:Up.Ed25519,ES256K:Up.secp256k1,ES256:Up.secp256r1,"P-256":Up.secp256r1,secp256k1:Up.secp256k1,secp256r1:Up.secp256r1,X25519:Up.X25519},S_=class t extends fu{static create(){return wl(this,arguments,void 0,function*({keyManager:e=new ma,options:r={}}={}){var n,i,o,s;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");let a=(s=(n=r.algorithm)!==null&&n!==void 0?n:(o=(i=r.verificationMethods)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.algorithm)!==null&&s!==void 0?s:"Ed25519",d=yield e.generateKey({algorithm:a}),u=yield e.getPublicKey({keyUri:d}),c=yield Ec.publicKeyToMultibaseId({publicKey:u}),l=`did:${t.methodName}:${c}`,y=(yield t.resolve(l,r)).didDocument;return new wc({uri:l,document:y,metadata:{},keyManager:e})})}static getSigningMethod(e){return wl(this,arguments,void 0,function*({didDocument:r}){var n;let i=Tr.parse(r.id);if(i&&i.method!==this.methodName)throw new ct(tt.MethodNotSupported,`Method not supported: ${i.method}`);let[o]=r.assertionMethod||[],s=(n=r.verificationMethod)===null||n===void 0?void 0:n.find(a=>a.id===o);if(!(s&&s.publicKeyJwk))throw new ct(tt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static import(e){return wl(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ma}){let i=Tr.parse(r.uri);if(i?.method!==t.methodName)throw new ct(tt.MethodNotSupported,"Method not supported");let o=yield wc.import({portableDid:r,keyManager:n});if(o.document.verificationMethod.length!==1)throw new ct(tt.InvalidDidDocument,"DID document must contain exactly one verification method");return o})}static resolve(e,r){return wl(this,void 0,void 0,function*(){try{let n=yield t.createDocument({didUri:e,options:r});return Object.assign(Object.assign({},hi),{didDocument:n})}catch(n){if(!(n instanceof ct))throw new Error(n);return Object.assign(Object.assign({},hi),{didResolutionMetadata:Object.assign({error:n.code},n.message&&{errorMessage:n.message})})}})}static createDocument(e){return wl(this,arguments,void 0,function*({didUri:r,options:n={}}){let{defaultContext:i="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:o=!1,enableExperimentalPublicKeyTypes:s=!1,publicKeyFormat:a="JsonWebKey2020"}=n,d={id:""},u=Tr.parse(r);if(!u)throw new ct(tt.InvalidDid,`Invalid DID URI: ${r}`);let c=u.id;if(u.method!==t.methodName)throw new ct(tt.MethodNotSupported,`Method not supported: ${u.method}`);if(!t.validateIdentifier(u))throw new ct(tt.InvalidDid,`Invalid DID URI: ${r}`);let l=yield t.createSignatureMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:s,publicKeyFormat:a}});if(d.id=u.uri,d.verificationMethod=[l],d.authentication=[l.id],d.assertionMethod=[l.id],d.capabilityInvocation=[l.id],d.capabilityDelegation=[l.id],o===!0){let g=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",v=yield this.createEncryptionMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:s,publicKeyFormat:g}});d.verificationMethod.push(v),d.keyAgreement=[v.id]}let h=[i];return tve({didDocument:d}).forEach(g=>{let v=VF[g];h.push(v)}),d["@context"]=h,d})}static createEncryptionMethod(e){return wl(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:i}){let{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}=i,a={id:"",type:"",controller:""},{keyBytes:d,multicodecCode:u}=yield t.deriveEncryptionKey({multibaseValue:n}),c=d.byteLength,l=Ec.MULTICODEC_PUBLIC_KEY_LENGTH[u];if(c!==l)throw new ct(tt.InvalidPublicKeyLength,`Expected ${c} bytes. Actual: ${l}`);let h=SF({keyBytes:d,multicodecCode:u});a.id=`${r}#${h}`;try{new URL(a.id)}catch{throw new ct(tt.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(s in VF))throw new ct(tt.UnsupportedPublicKeyType,`Unsupported format: ${s}`);if(o===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(s))throw new ct(tt.InvalidPublicKeyType,`Specified '${s}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=s,a.controller=r,s==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=h),s==="JsonWebKey2020"){let{crv:g}=yield Ec.multicodecToJwk({code:u});a.publicKeyJwk=yield Ec.keyConverter(g).bytesToPublicKey({publicKeyBytes:d})}return a})}static createSignatureMethod(e){return wl(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:i}){let{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}=i,a={id:"",type:"",controller:""},{keyBytes:d,multicodecCode:u,multicodecName:c}=TF({multibaseKeyId:n}),l=d.byteLength,h=Ec.MULTICODEC_PUBLIC_KEY_LENGTH[u];if(l!==h)throw new ct(tt.InvalidPublicKeyLength,`Expected ${l} bytes. Actual: ${h}`);let y=!1;switch(c){case"secp256k1-pub":y=yield Vo.validatePublicKey({publicKeyBytes:d});break;case"ed25519-pub":y=yield go.validatePublicKey({publicKeyBytes:d});break;case"x25519-pub":y=!0;break}if(!y)throw new ct(tt.InvalidPublicKey,"Invalid public key detected.");a.id=`${r}#${n}`;try{new URL(a.id)}catch{throw new ct(tt.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(s in VF))throw new ct(tt.UnsupportedPublicKeyType,`Unsupported format: ${s}`);if(o===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(s))throw new ct(tt.InvalidPublicKeyType,`Specified '${s}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=s,a.controller=r,s==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=n),s==="JsonWebKey2020"){let{crv:v}=yield Ec.multicodecToJwk({code:u});a.publicKeyJwk=yield Ec.keyConverter(v).bytesToPublicKey({publicKeyBytes:d})}return a})}static deriveEncryptionKey(e){return wl(this,arguments,void 0,function*({multibaseValue:r}){let n={keyBytes:new Uint8Array,multicodecCode:0},{keyBytes:i,multicodecCode:o}=TF({multibaseKeyId:r});if(o===237){let s=yield Ec.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:i}),a=yield go.convertPublicKeyToX25519({publicKey:s});n={keyBytes:yield Ec.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return n})}static validateIdentifier(e){let{method:r,id:n}=e,[i]=e.uri.split(":",1);return i==="did"&&r==="key"&&Number("1")>0&&Vf(n)==="String"&&n.startsWith("z")}};S_.methodName="key";var Ec=class t{static jwkToMulticodec(e){return wl(this,arguments,void 0,function*({jwk:r}){let n=[];r.crv&&(n.push(r.crv),r.d?n.push("private"):n.push("public"));let i=n.join(":"),o=t.JWK_TO_MULTICODEC[i];if(o===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${i}'`);return{code:An.getCodeFromName({name:o}),name:o}})}static keyCompressor(e){let n={"P-256":Ms.compressPublicKey,secp256k1:Vo.compressPublicKey}[e];if(!n)throw new ct(tt.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static keyConverter(e){let n={Ed25519:go,"P-256":Ms,secp256k1:Vo,X25519:h_}[e];if(!n)throw new ct(tt.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static multicodecToJwk(e){return wl(this,arguments,void 0,function*({code:r,name:n}){if(!(n?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");n=n===void 0?An.getNameFromCode({code:r}):n;let i=n,o=t.MULTICODEC_TO_JWK[i];if(o===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},o)})}static publicKeyToMultibaseId(e){return wl(this,arguments,void 0,function*({publicKey:r}){var n;if(!(r?.crv&&r.crv in att))throw new ct(tt.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(n=r?.crv)!==null&&n!==void 0?n:"undefined"}`);let i=yield t.keyConverter(r.crv).publicKeyToBytes({publicKey:r});/^(secp256k1|P-256|P-384|P-521)$/.test(r.crv)&&(i=yield t.keyCompressor(r.crv)({publicKeyBytes:i}));let{name:o}=yield t.jwkToMulticodec({jwk:r});return SF({keyBytes:i,multicodecName:o})})}};Ec.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};Ec.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};Ec.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};f();var ctt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},HF=class t extends fu{static resolve(e,r){return ctt(this,void 0,void 0,function*(){let n=Tr.parse(e);if(!n)return Object.assign(Object.assign({},hi),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==t.methodName)return Object.assign(Object.assign({},hi),{didResolutionMetadata:{error:"methodNotSupported"}});let i=`https://${n.id.replace(/:/g,"/")}`;i=decodeURIComponent(i);let o=n.id.includes(":")?`${i}/did.json`:`${i}/.well-known/did.json`;try{let s=yield fetch(o);if(!s.ok)throw new Error("HTTP error status code returned");let a=yield s.json();return Object.assign(Object.assign({},hi),{didDocument:a})}catch{return Object.assign(Object.assign({},hi),{didResolutionMetadata:{error:"notFound"}})}})}};HF.methodName="web";f();var zve=xt(f0(),1),Vve=xt(m5(),1),ptt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},PR=class{constructor({db:e,location:r="DATA/DID_RESOLVERCACHE",ttl:n="15m"}={}){this.cache=e??new Vve.Level(r),this.ttl=(0,zve.default)(n)}get(e){return ptt(this,void 0,void 0,function*(){try{let r=yield this.cache.get(e),n=JSON.parse(r);if(Date.now()>=n.ttlMillis){this.cache.nextTick(()=>this.cache.del(e));return}else return n.value}catch(r){if(r.notFound)return;throw r}})}set(e,r){let n={ttlMillis:Date.now()+this.ttl,value:r},i=JSON.stringify(n);return this.cache.put(e,i)}delete(e){return this.cache.del(e)}clear(){return this.cache.clear()}close(){return this.cache.close()}};f();var Hve={get:function(t){return null},set:function(t,e){return null},delete:function(t){return null},clear:function(){return null},close:function(){return null}};f();var Wve=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},IR=class{constructor({cache:e,didResolvers:r}){this.didResolvers=new Map,this.cache=e||Hve;for(let n of r)this.didResolvers.set(n.methodName,n)}resolve(e,r){return Wve(this,void 0,void 0,function*(){let n=Tr.parse(e);if(!n)return Object.assign(Object.assign({},hi),{didResolutionMetadata:{error:tt.InvalidDid,errorMessage:`Invalid DID URI: ${e}`}});let i=this.didResolvers.get(n.method);if(!i)return Object.assign(Object.assign({},hi),{didResolutionMetadata:{error:tt.MethodNotSupported,errorMessage:`Method not supported: ${n.method}`}});let o=yield this.cache.get(n.uri);if(o)return o;{let s=yield i.resolve(n.uri,r);return s.didResolutionMetadata.error||(yield this.cache.set(n.uri,s)),s}})}dereference(e,r){return Wve(this,void 0,void 0,function*(){let n=Tr.parse(e);if(!n)return{dereferencingMetadata:{error:tt.InvalidDidUrl},contentStream:null,contentMetadata:{}};let{didDocument:i,didResolutionMetadata:o,didDocumentMetadata:s}=yield this.resolve(n.uri);if(!i)return{dereferencingMetadata:{error:o.error},contentStream:null,contentMetadata:{}};if(!n.fragment||n.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:i,contentMetadata:s};let{service:a=[],verificationMethod:d=[]}=i,u=new Set([e,n.fragment,`#${n.fragment}`]),c;for(let l of d)if(u.has(l.id)){c=l;break}for(let l of a)if(u.has(l.id)){c=l;break}return c?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:c,contentMetadata:o}:{dereferencingMetadata:{error:tt.NotFound},contentStream:null,contentMetadata:{}}})}};var P_=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},r3=class t{constructor(e){this.didResolver=e.didResolver,this.tenantGate=e.tenantGate,this.eventStream=e.eventStream,this.messageStore=e.messageStore,this.dataStore=e.dataStore,this.resumableTaskStore=e.resumableTaskStore,this.eventLog=e.eventLog,this.eventStream=e.eventStream,this.storageController=new $2({messageStore:this.messageStore,dataStore:this.dataStore,eventLog:this.eventLog,eventStream:this.eventStream}),this.resumableTaskManager=new zS(e.resumableTaskStore,this.storageController),this.methodHandlers={[Oe.Messages+Ae.Query]:new eP(this.didResolver,this.messageStore,this.eventLog),[Oe.Messages+Ae.Read]:new tP(this.didResolver,this.messageStore,this.dataStore),[Oe.Messages+Ae.Subscribe]:new rP(this.didResolver,this.messageStore,this.eventStream),[Oe.Protocols+Ae.Configure]:new CP(this.didResolver,this.messageStore,this.eventLog,this.eventStream),[Oe.Protocols+Ae.Query]:new jP(this.didResolver,this.messageStore,this.dataStore),[Oe.Records+Ae.Delete]:new $P(this.didResolver,this.messageStore,this.resumableTaskManager),[Oe.Records+Ae.Query]:new NP(this.didResolver,this.messageStore,this.dataStore),[Oe.Records+Ae.Read]:new UP(this.didResolver,this.messageStore,this.dataStore),[Oe.Records+Ae.Subscribe]:new qP(this.didResolver,this.messageStore,this.eventStream),[Oe.Records+Ae.Write]:new LP(this.didResolver,this.messageStore,this.dataStore,this.eventLog,this.eventStream)}}static create(e){var r,n;return P_(this,void 0,void 0,function*(){(r=e.didResolver)!==null&&r!==void 0||(e.didResolver=new IR({didResolvers:[Eb,t3,S_],cache:new PR({location:"RESOLVERCACHE"})})),(n=e.tenantGate)!==null&&n!==void 0||(e.tenantGate=new uS);let i=new t(e);return yield i.open(),i})}open(){var e;return P_(this,void 0,void 0,function*(){yield this.messageStore.open(),yield this.dataStore.open(),yield this.resumableTaskStore.open(),yield this.eventLog.open(),yield(e=this.eventStream)===null||e===void 0?void 0:e.open(),yield this.resumableTaskManager.resumeTasksAndWaitForCompletion()})}close(){var e;return P_(this,void 0,void 0,function*(){yield(e=this.eventStream)===null||e===void 0?void 0:e.close(),yield this.messageStore.close(),yield this.dataStore.close(),yield this.resumableTaskStore.close(),yield this.eventLog.close()})}processMessage(e,r,n={}){var i;return P_(this,void 0,void 0,function*(){let o=(i=yield this.validateTenant(e))!==null&&i!==void 0?i:yield this.validateMessageIntegrity(r);if(o!==void 0)return o;let{dataStream:s,subscriptionHandler:a}=n,d=r.descriptor.interface+r.descriptor.method;return yield this.methodHandlers[d].handle({tenant:e,message:r,dataStream:s,subscriptionHandler:a})})}validateTenant(e){var r;return P_(this,void 0,void 0,function*(){let n=yield this.tenantGate.isActiveTenant(e);if(!n.isActiveTenant)return{status:{code:401,detail:(r=n.detail)!==null&&r!==void 0?r:`DID ${e} is not an active tenant.`}}})}validateMessageIntegrity(e){var r,n;return P_(this,void 0,void 0,function*(){let i=(r=e?.descriptor)===null||r===void 0?void 0:r.interface,o=(n=e?.descriptor)===null||n===void 0?void 0:n.method;if(i===void 0||o===void 0)return{status:{code:400,detail:`Both interface and method must be present, interface: ${i}, method: ${o}`}};try{_e.validateJsonSchema(e)}catch(s){return gr(s,400)}})}};f();var ytt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};function mtt(t){return new Promise((e,r)=>{if(t.aborted){r(t.reason);return}t.addEventListener("abort",()=>{r(t.reason)})})}function to(t,e){return ytt(this,void 0,void 0,function*(){return e?Promise.race([t,mtt(e)]):t})}f();f();f();f();var Jve=xt($5(),1),ud=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},_l=function(t){return this instanceof _l?(this.v=t,this):new _l(t)},WF=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,d){s=t[o](s),i(a,d,s.done,s.value)})}}function i(o,s,a,d){Promise.resolve(d).then(function(u){o({value:u,done:a})},s)}},Gve=function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(h){n[h]&&(i[h]=function(y){return new Promise(function(g,v){o.push([h,y,g,v])>1||a(h,y)})})}function a(h,y){try{d(n[h](y))}catch(g){l(o[0][3],g)}}function d(h){h.value instanceof _l?Promise.resolve(h.value.v).then(u,c):l(o[0][2],h)}function u(h){a("next",h)}function c(h){a("throw",h)}function l(h,y){h(y),o.shift(),o.length&&a(o[0][0],o[0][1])}};function ld(t,e){return ud(this,void 0,void 0,function*(){return new Jve.Level(t,Object.assign(Object.assign({},e),{keyEncoding:"utf8"}))})}var h0=class t{constructor(e,r){this.config=Object.assign({createLevelDatabase:ld},e),this.db=r}open(){return ud(this,void 0,void 0,function*(){switch(yield this.createLevelDatabase(),this.db.status){case"open":return;case"opening":return new Promise(e=>{this.db.once("open",e)});case"closing":return new Promise((e,r)=>{let n=()=>{this.db.open().then(e).catch(r)};this.db.once("closed",n)});case"closed":return this.db.open()}})}close(){return ud(this,void 0,void 0,function*(){if(this.db)switch(this.db.status){case"open":return this.db.close();case"opening":return new Promise((e,r)=>{let n=()=>{this.db.close().then(e).catch(r)};this.db.once("open",n)});case"closing":return new Promise(e=>{this.db.once("closed",e)});case"closed":return}})}partition(e){return ud(this,void 0,void 0,function*(){return yield this.createLevelDatabase(),new t(this.config,this.db.sublevel(e,{keyEncoding:"utf8",valueEncoding:this.config.valueEncoding}))})}get(e,r){var n;return ud(this,void 0,void 0,function*(){(n=r?.signal)===null||n===void 0||n.throwIfAborted(),yield to(this.createLevelDatabase(),r?.signal);try{return yield to(this.db.get(String(e)),r?.signal)}catch(i){if(i.code==="LEVEL_NOT_FOUND")return;throw i}})}has(e,r){return ud(this,void 0,void 0,function*(){return!!(yield this.get(e,r))})}keys(e){var r,n;return Gve(this,arguments,function*(){var o,s,a,d;(r=e?.signal)===null||r===void 0||r.throwIfAborted(),yield _l(to(this.createLevelDatabase(),e?.signal));try{for(var u=!0,c=WF(this.db.keys()),l;l=yield _l(c.next()),o=l.done,!o;u=!0){d=l.value,u=!1;let h=d;(n=e?.signal)===null||n===void 0||n.throwIfAborted(),yield yield _l(h)}}catch(h){s={error:h}}finally{try{!u&&!o&&(a=c.return)&&(yield _l(a.call(c)))}finally{if(s)throw s.error}}})}iterator(e,r){var n,i;return Gve(this,arguments,function*(){var s,a,d,u;(n=r?.signal)===null||n===void 0||n.throwIfAborted(),yield _l(to(this.createLevelDatabase(),r?.signal));try{for(var c=!0,l=WF(this.db.iterator(e)),h;h=yield _l(l.next()),s=h.done,!s;c=!0){u=h.value,c=!1;let y=u;(i=r?.signal)===null||i===void 0||i.throwIfAborted(),yield yield _l(y)}}catch(y){a={error:y}}finally{try{!c&&!s&&(d=l.return)&&(yield _l(d.call(l)))}finally{if(a)throw a.error}}})}put(e,r,n){var i;return ud(this,void 0,void 0,function*(){return(i=n?.signal)===null||i===void 0||i.throwIfAborted(),yield to(this.createLevelDatabase(),n?.signal),to(this.db.put(String(e),r),n?.signal)})}delete(e,r){var n;return ud(this,void 0,void 0,function*(){return(n=r?.signal)===null||n===void 0||n.throwIfAborted(),yield to(this.createLevelDatabase(),r?.signal),to(this.db.del(String(e)),r?.signal)})}isEmpty(e){var r,n,i,o;return ud(this,void 0,void 0,function*(){try{for(var s=!0,a=WF(this.keys(e)),d;d=yield a.next(),r=d.done,!r;s=!0){o=d.value,s=!1;let u=o;return!1}}catch(u){n={error:u}}finally{try{!s&&!r&&(i=a.return)&&(yield i.call(a))}finally{if(n)throw n.error}}return!0})}clear(){return ud(this,void 0,void 0,function*(){yield this.createLevelDatabase(),yield this.db.clear(),yield this.compactUnderlyingStorage()})}batch(e,r){var n;return ud(this,void 0,void 0,function*(){return(n=r?.signal)===null||n===void 0||n.throwIfAborted(),yield to(this.createLevelDatabase(),r?.signal),to(this.db.batch(e),r?.signal)})}createPartitionOperation(e,r){return Object.assign(Object.assign({},r),{sublevel:this.db.sublevel(e,{keyEncoding:"utf8",valueEncoding:this.config.valueEncoding})})}compactUnderlyingStorage(e){var r,n,i;return ud(this,void 0,void 0,function*(){(r=e?.signal)===null||r===void 0||r.throwIfAborted(),yield to(this.createLevelDatabase(),e?.signal);let o=this.sublevelRange;if(!o)return;let s=this.root;if(s.db.supports.additionalMethods.compactRange)return to((i=(n=s.db).compactRange)===null||i===void 0?void 0:i.call(n,...o),e?.signal)})}get sublevelRange(){let e=this.db.prefix;if(!e)return;let r=e.slice(0,-1)+String.fromCharCode(e.charCodeAt(e.length-1)+1);return[e,r]}get root(){let e=this.db;for(let r=e.db;r&&r!==e;)e=r;return new t(this.config,e)}createLevelDatabase(){var e;return ud(this,void 0,void 0,function*(){(e=this.db)!==null&&e!==void 0||(this.db=yield this.config.createLevelDatabase(this.config.location,{keyEncoding:"utf8",valueEncoding:this.config.valueEncoding}))})}};var Kp=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},RR=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,d){s=t[o](s),i(a,d,s.done,s.value)})}}function i(o,s,a,d){Promise.resolve(d).then(function(u){o({value:u,done:a})},s)}},Jo=function(t){return this instanceof Jo?(this.v=t,this):new Jo(t)},BR=function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(h){n[h]&&(i[h]=function(y){return new Promise(function(g,v){o.push([h,y,g,v])>1||a(h,y)})})}function a(h,y){try{d(n[h](y))}catch(g){l(o[0][3],g)}}function d(h){h.value instanceof Jo?Promise.resolve(h.value.v).then(u,c):l(o[0][2],h)}function u(h){a("next",h)}function c(h){a("throw",h)}function l(h,y){h(y),o.shift(),o.length&&a(o[0][0],o[0][1])}},I_=class t{constructor(e,r){this.config=Object.assign({createLevelDatabase:ld},e),this.db=r??new h0(Object.assign(Object.assign({},this.config),{valueEncoding:"binary"}))}open(){return Kp(this,void 0,void 0,function*(){return this.db.open()})}close(){return Kp(this,void 0,void 0,function*(){return this.db.close()})}partition(e){return Kp(this,void 0,void 0,function*(){let r=yield this.db.partition(e);return new t(Object.assign(Object.assign({},this.config),{location:""}),r)})}put(e,r,n){return Kp(this,void 0,void 0,function*(){return yield this.db.put(String(e),r,n),Fr.parse(e.toString())})}get(e,r){return Kp(this,void 0,void 0,function*(){return yield this.db.get(String(e),r)})}has(e,r){return Kp(this,void 0,void 0,function*(){return this.db.has(String(e),r)})}delete(e,r){return Kp(this,void 0,void 0,function*(){return this.db.delete(String(e),r)})}isEmpty(e){return Kp(this,void 0,void 0,function*(){return this.db.isEmpty(e)})}putMany(e,r){return BR(this,arguments,function*(){var i,o,s,a;try{for(var d=!0,u=RR(e),c;c=yield Jo(u.next()),i=c.done,!i;d=!0){a=c.value,d=!1;let l=a;yield Jo(this.put(l.cid,l.block,r)),yield yield Jo(l.cid)}}catch(l){o={error:l}}finally{try{!d&&!i&&(s=u.return)&&(yield Jo(s.call(u)))}finally{if(o)throw o.error}}})}getMany(e,r){return BR(this,arguments,function*(){var i,o,s,a;try{for(var d=!0,u=RR(e),c;c=yield Jo(u.next()),i=c.done,!i;d=!0){a=c.value,d=!1;let l=a;yield yield Jo({cid:l,block:yield Jo(this.get(l,r))})}}catch(l){o={error:l}}finally{try{!d&&!i&&(s=u.return)&&(yield Jo(s.call(u)))}finally{if(o)throw o.error}}})}getAll(e){return BR(this,arguments,function*(){var n,i,o,s;let a=this.db.iterator({keys:!0,keyEncoding:"buffer"},e);try{for(var d=!0,u=RR(a),c;c=yield Jo(u.next()),n=c.done,!n;d=!0){s=c.value,d=!1;let[l,h]=s;yield yield Jo({cid:Fr.decode(l),block:h})}}catch(l){i={error:l}}finally{try{!d&&!n&&(o=u.return)&&(yield Jo(o.call(u)))}finally{if(i)throw i.error}}})}deleteMany(e,r){return BR(this,arguments,function*(){var i,o,s,a;try{for(var d=!0,u=RR(e),c;c=yield Jo(u.next()),i=c.done,!i;d=!0){a=c.value,d=!1;let l=a;yield Jo(this.delete(l,r)),yield yield Jo(l)}}catch(l){o={error:l}}finally{try{!d&&!i&&(s=u.return)&&(yield Jo(s.call(u)))}finally{if(o)throw o.error}}})}clear(){return Kp(this,void 0,void 0,function*(){return this.db.clear()})}};f();var rB=xt(Uc(),1);f();function gtt(t){return t[Symbol.asyncIterator]!=null}function vtt(t){if(gtt(t))return(async()=>{let r;for await(let n of t)r=n;return r})();let e;for(let r of t)e=r;return e}var Yve=vtt;f();f();f();f();f();var btt=["string","number","bigint","symbol"],wtt=["Function","Generator","AsyncGenerator","GeneratorFunction","AsyncGeneratorFunction","AsyncFunction","Observable","Array","Buffer","Object","RegExp","Date","Error","Map","Set","WeakMap","WeakSet","ArrayBuffer","SharedArrayBuffer","DataView","Promise","URL","HTMLElement","Int8Array","Uint8Array","Uint8ClampedArray","Int16Array","Uint16Array","Int32Array","Uint32Array","Float32Array","Float64Array","BigInt64Array","BigUint64Array"];function Zve(t){if(t===null)return"null";if(t===void 0)return"undefined";if(t===!0||t===!1)return"boolean";let e=typeof t;if(btt.includes(e))return e;if(e==="function")return"Function";if(Array.isArray(t))return"Array";if(_tt(t))return"Buffer";let r=xtt(t);return r||"Object"}function _tt(t){return t&&t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer.call(null,t)}function xtt(t){let e=Object.prototype.toString.call(t).slice(8,-1);if(wtt.includes(e))return e}f();var we=class{constructor(e,r,n){this.major=e,this.majorEncoded=e<<5,this.name=r,this.terminal=n}toString(){return`Type[${this.major}].${this.name}`}compare(e){return this.major<e.major?-1:this.major>e.major?1:0}};we.uint=new we(0,"uint",!0);we.negint=new we(1,"negint",!0);we.bytes=new we(2,"bytes",!0);we.string=new we(3,"string",!0);we.array=new we(4,"array",!1);we.map=new we(5,"map",!1);we.tag=new we(6,"tag",!1);we.float=new we(7,"float",!0);we.false=new we(7,"false",!0);we.true=new we(7,"true",!0);we.null=new we(7,"null",!0);we.undefined=new we(7,"undefined",!0);we.break=new we(7,"break",!0);var Je=class{constructor(e,r,n){this.type=e,this.value=r,this.encodedLength=n,this.encodedBytes=void 0,this.byteValue=void 0}toString(){return`Token[${this.type}].${this.value}`}};f();f();var R_=globalThis.process&&!globalThis.process.browser&&globalThis.Buffer&&typeof globalThis.Buffer.isBuffer=="function",Ett=new TextDecoder,Stt=new TextEncoder;function OR(t){return R_&&globalThis.Buffer.isBuffer(t)}function tbe(t){return t instanceof Uint8Array?OR(t)?new Uint8Array(t.buffer,t.byteOffset,t.byteLength):t:Uint8Array.from(t)}var rbe=R_?(t,e,r)=>r-e>64?globalThis.Buffer.from(t.subarray(e,r)).toString("utf8"):Qve(t,e,r):(t,e,r)=>r-e>64?Ett.decode(t.subarray(e,r)):Qve(t,e,r),nbe=R_?t=>t.length>64?globalThis.Buffer.from(t):Xve(t):t=>t.length>64?Stt.encode(t):Xve(t);var B_=R_?(t,e,r)=>OR(t)?new Uint8Array(t.subarray(e,r)):t.slice(e,r):(t,e,r)=>t.slice(e,r),ibe=R_?(t,e)=>(t=t.map(r=>r instanceof Uint8Array?r:globalThis.Buffer.from(r)),tbe(globalThis.Buffer.concat(t,e))):(t,e)=>{let r=new Uint8Array(e),n=0;for(let i of t)n+i.length>r.length&&(i=i.subarray(0,r.length-n)),r.set(i,n),n+=i.length;return r},obe=R_?t=>globalThis.Buffer.allocUnsafe(t):t=>new Uint8Array(t);function sbe(t,e){if(OR(t)&&OR(e))return t.compare(e);for(let r=0;r<t.length;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return 0}function Xve(t){let e=[],r=0;for(let n=0;n<t.length;n++){let i=t.charCodeAt(n);i<128?e[r++]=i:i<2048?(e[r++]=i>>6|192,e[r++]=i&63|128):(i&64512)===55296&&n+1<t.length&&(t.charCodeAt(n+1)&64512)===56320?(i=65536+((i&1023)<<10)+(t.charCodeAt(++n)&1023),e[r++]=i>>18|240,e[r++]=i>>12&63|128,e[r++]=i>>6&63|128,e[r++]=i&63|128):(e[r++]=i>>12|224,e[r++]=i>>6&63|128,e[r++]=i&63|128)}return e}function Qve(t,e,r){let n=[];for(;e<r;){let i=t[e],o=null,s=i>239?4:i>223?3:i>191?2:1;if(e+s<=r){let a,d,u,c;switch(s){case 1:i<128&&(o=i);break;case 2:a=t[e+1],(a&192)===128&&(c=(i&31)<<6|a&63,c>127&&(o=c));break;case 3:a=t[e+1],d=t[e+2],(a&192)===128&&(d&192)===128&&(c=(i&15)<<12|(a&63)<<6|d&63,c>2047&&(c<55296||c>57343)&&(o=c));break;case 4:a=t[e+1],d=t[e+2],u=t[e+3],(a&192)===128&&(d&192)===128&&(u&192)===128&&(c=(i&15)<<18|(a&63)<<12|(d&63)<<6|u&63,c>65535&&c<1114112&&(o=c))}}o===null?(o=65533,s=1):o>65535&&(o-=65536,n.push(o>>>10&1023|55296),o=56320|o&1023),n.push(o),e+=s}return Ttt(n)}var ebe=4096;function Ttt(t){let e=t.length;if(e<=ebe)return String.fromCharCode.apply(String,t);let r="",n=0;for(;n<e;)r+=String.fromCharCode.apply(String,t.slice(n,n+=ebe));return r}var Att=256,MR=class{constructor(e=Att){this.chunkSize=e,this.cursor=0,this.maxCursor=-1,this.chunks=[],this._initReuseChunk=null}reset(){this.cursor=0,this.maxCursor=-1,this.chunks.length&&(this.chunks=[]),this._initReuseChunk!==null&&(this.chunks.push(this._initReuseChunk),this.maxCursor=this._initReuseChunk.length-1)}push(e){let r=this.chunks[this.chunks.length-1];if(this.cursor+e.length<=this.maxCursor+1){let i=r.length-(this.maxCursor-this.cursor)-1;r.set(e,i)}else{if(r){let i=r.length-(this.maxCursor-this.cursor)-1;i<r.length&&(this.chunks[this.chunks.length-1]=r.subarray(0,i),this.maxCursor=this.cursor-1)}e.length<64&&e.length<this.chunkSize?(r=obe(this.chunkSize),this.chunks.push(r),this.maxCursor+=r.length,this._initReuseChunk===null&&(this._initReuseChunk=r),r.set(e,0)):(this.chunks.push(e),this.maxCursor+=e.length)}this.cursor+=e.length}toBytes(e=!1){let r;if(this.chunks.length===1){let n=this.chunks[0];e&&this.cursor>n.length/2?(r=this.cursor===n.length?n:n.subarray(0,this.cursor),this._initReuseChunk=null,this.chunks=[]):r=B_(n,0,this.cursor)}else r=ibe(this.chunks,this.cursor);return e&&this.reset(),r}};f();var Ht="CBOR decode error:",GF="CBOR encode error:",n3=[];n3[23]=1;n3[24]=2;n3[25]=3;n3[26]=5;n3[27]=9;function qp(t,e,r){if(t.length-e<r)throw new Error(`${Ht} not enough data for type`)}f();f();var Yo=[24,256,65536,4294967296,BigInt("18446744073709551616")];function fd(t,e,r){qp(t,e,1);let n=t[e];if(r.strict===!0&&n<Yo[0])throw new Error(`${Ht} integer encoded in more bytes than necessary (strict decode)`);return n}function hd(t,e,r){qp(t,e,2);let n=t[e]<<8|t[e+1];if(r.strict===!0&&n<Yo[1])throw new Error(`${Ht} integer encoded in more bytes than necessary (strict decode)`);return n}function pd(t,e,r){qp(t,e,4);let n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3];if(r.strict===!0&&n<Yo[2])throw new Error(`${Ht} integer encoded in more bytes than necessary (strict decode)`);return n}function yd(t,e,r){qp(t,e,8);let n=t[e]*16777216+(t[e+1]<<16)+(t[e+2]<<8)+t[e+3],i=t[e+4]*16777216+(t[e+5]<<16)+(t[e+6]<<8)+t[e+7],o=(BigInt(n)<<BigInt(32))+BigInt(i);if(r.strict===!0&&o<Yo[3])throw new Error(`${Ht} integer encoded in more bytes than necessary (strict decode)`);if(o<=Number.MAX_SAFE_INTEGER)return Number(o);if(r.allowBigInt===!0)return o;throw new Error(`${Ht} integers outside of the safe integer range are not supported`)}function abe(t,e,r,n){return new Je(we.uint,fd(t,e+1,n),2)}function cbe(t,e,r,n){return new Je(we.uint,hd(t,e+1,n),3)}function dbe(t,e,r,n){return new Je(we.uint,pd(t,e+1,n),5)}function ube(t,e,r,n){return new Je(we.uint,yd(t,e+1,n),9)}function pu(t,e){return Cs(t,0,e.value)}function Cs(t,e,r){if(r<Yo[0]){let n=Number(r);t.push([e|n])}else if(r<Yo[1]){let n=Number(r);t.push([e|24,n])}else if(r<Yo[2]){let n=Number(r);t.push([e|25,n>>>8,n&255])}else if(r<Yo[3]){let n=Number(r);t.push([e|26,n>>>24&255,n>>>16&255,n>>>8&255,n&255])}else{let n=BigInt(r);if(n<Yo[4]){let i=[e|27,0,0,0,0,0,0,0],o=Number(n&BigInt(4294967295)),s=Number(n>>BigInt(32)&BigInt(4294967295));i[8]=o&255,o=o>>8,i[7]=o&255,o=o>>8,i[6]=o&255,o=o>>8,i[5]=o&255,i[4]=s&255,s=s>>8,i[3]=s&255,s=s>>8,i[2]=s&255,s=s>>8,i[1]=s&255,t.push(i)}else throw new Error(`${Ht} encountered BigInt larger than allowable range`)}}pu.encodedSize=function(e){return Cs.encodedSize(e.value)};Cs.encodedSize=function(e){return e<Yo[0]?1:e<Yo[1]?2:e<Yo[2]?3:e<Yo[3]?5:9};pu.compareTokens=function(e,r){return e.value<r.value?-1:e.value>r.value?1:0};f();function lbe(t,e,r,n){return new Je(we.negint,-1-fd(t,e+1,n),2)}function fbe(t,e,r,n){return new Je(we.negint,-1-hd(t,e+1,n),3)}function hbe(t,e,r,n){return new Je(we.negint,-1-pd(t,e+1,n),5)}var JF=BigInt(-1),pbe=BigInt(1);function ybe(t,e,r,n){let i=yd(t,e+1,n);if(typeof i!="bigint"){let o=-1-i;if(o>=Number.MIN_SAFE_INTEGER)return new Je(we.negint,o,9)}if(n.allowBigInt!==!0)throw new Error(`${Ht} integers outside of the safe integer range are not supported`);return new Je(we.negint,JF-BigInt(i),9)}function DR(t,e){let r=e.value,n=typeof r=="bigint"?r*JF-pbe:r*-1-1;Cs(t,e.type.majorEncoded,n)}DR.encodedSize=function(e){let r=e.value,n=typeof r=="bigint"?r*JF-pbe:r*-1-1;return n<Yo[0]?1:n<Yo[1]?2:n<Yo[2]?3:n<Yo[3]?5:9};DR.compareTokens=function(e,r){return e.value<r.value?1:e.value>r.value?-1:0};f();function i3(t,e,r,n){qp(t,e,r+n);let i=B_(t,e+r,e+r+n);return new Je(we.bytes,i,r+n)}function mbe(t,e,r,n){return i3(t,e,1,r)}function gbe(t,e,r,n){return i3(t,e,2,fd(t,e+1,n))}function vbe(t,e,r,n){return i3(t,e,3,hd(t,e+1,n))}function bbe(t,e,r,n){return i3(t,e,5,pd(t,e+1,n))}function wbe(t,e,r,n){let i=yd(t,e+1,n);if(typeof i=="bigint")throw new Error(`${Ht} 64-bit integer bytes lengths not supported`);return i3(t,e,9,i)}function CR(t){return t.encodedBytes===void 0&&(t.encodedBytes=t.type===we.string?nbe(t.value):t.value),t.encodedBytes}function O_(t,e){let r=CR(e);Cs(t,e.type.majorEncoded,r.length),t.push(r)}O_.encodedSize=function(e){let r=CR(e);return Cs.encodedSize(r.length)+r.length};O_.compareTokens=function(e,r){return Ptt(CR(e),CR(r))};function Ptt(t,e){return t.length<e.length?-1:t.length>e.length?1:sbe(t,e)}f();function o3(t,e,r,n,i){let o=r+n;qp(t,e,o);let s=new Je(we.string,rbe(t,e+r,e+o),o);return i.retainStringBytes===!0&&(s.byteValue=B_(t,e+r,e+o)),s}function _be(t,e,r,n){return o3(t,e,1,r,n)}function xbe(t,e,r,n){return o3(t,e,2,fd(t,e+1,n),n)}function Ebe(t,e,r,n){return o3(t,e,3,hd(t,e+1,n),n)}function Sbe(t,e,r,n){return o3(t,e,5,pd(t,e+1,n),n)}function Tbe(t,e,r,n){let i=yd(t,e+1,n);if(typeof i=="bigint")throw new Error(`${Ht} 64-bit integer string lengths not supported`);return o3(t,e,9,i,n)}var Abe=O_;f();function M_(t,e,r,n){return new Je(we.array,n,r)}function kbe(t,e,r,n){return M_(t,e,1,r)}function Pbe(t,e,r,n){return M_(t,e,2,fd(t,e+1,n))}function Ibe(t,e,r,n){return M_(t,e,3,hd(t,e+1,n))}function Rbe(t,e,r,n){return M_(t,e,5,pd(t,e+1,n))}function Bbe(t,e,r,n){let i=yd(t,e+1,n);if(typeof i=="bigint")throw new Error(`${Ht} 64-bit integer array lengths not supported`);return M_(t,e,9,i)}function Obe(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${Ht} indefinite length items not allowed`);return M_(t,e,1,1/0)}function jR(t,e){Cs(t,we.array.majorEncoded,e.value)}jR.compareTokens=pu.compareTokens;jR.encodedSize=function(e){return Cs.encodedSize(e.value)};f();function D_(t,e,r,n){return new Je(we.map,n,r)}function Mbe(t,e,r,n){return D_(t,e,1,r)}function Dbe(t,e,r,n){return D_(t,e,2,fd(t,e+1,n))}function Cbe(t,e,r,n){return D_(t,e,3,hd(t,e+1,n))}function jbe(t,e,r,n){return D_(t,e,5,pd(t,e+1,n))}function $be(t,e,r,n){let i=yd(t,e+1,n);if(typeof i=="bigint")throw new Error(`${Ht} 64-bit integer map lengths not supported`);return D_(t,e,9,i)}function Nbe(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${Ht} indefinite length items not allowed`);return D_(t,e,1,1/0)}function $R(t,e){Cs(t,we.map.majorEncoded,e.value)}$R.compareTokens=pu.compareTokens;$R.encodedSize=function(e){return Cs.encodedSize(e.value)};f();function Ube(t,e,r,n){return new Je(we.tag,r,1)}function Kbe(t,e,r,n){return new Je(we.tag,fd(t,e+1,n),2)}function qbe(t,e,r,n){return new Je(we.tag,hd(t,e+1,n),3)}function Lbe(t,e,r,n){return new Je(we.tag,pd(t,e+1,n),5)}function Fbe(t,e,r,n){return new Je(we.tag,yd(t,e+1,n),9)}function NR(t,e){Cs(t,we.tag.majorEncoded,e.value)}NR.compareTokens=pu.compareTokens;NR.encodedSize=function(e){return Cs.encodedSize(e.value)};f();var Dtt=20,Ctt=21,jtt=22,$tt=23;function zbe(t,e,r,n){if(n.allowUndefined===!1)throw new Error(`${Ht} undefined values are not supported`);return n.coerceUndefinedToNull===!0?new Je(we.null,null,1):new Je(we.undefined,void 0,1)}function Vbe(t,e,r,n){if(n.allowIndefinite===!1)throw new Error(`${Ht} indefinite length items not allowed`);return new Je(we.break,void 0,1)}function YF(t,e,r){if(r){if(r.allowNaN===!1&&Number.isNaN(t))throw new Error(`${Ht} NaN values are not supported`);if(r.allowInfinity===!1&&(t===1/0||t===-1/0))throw new Error(`${Ht} Infinity values are not supported`)}return new Je(we.float,t,e)}function Hbe(t,e,r,n){return YF(ZF(t,e+1),3,n)}function Wbe(t,e,r,n){return YF(XF(t,e+1),5,n)}function Gbe(t,e,r,n){return YF(Xbe(t,e+1),9,n)}function UR(t,e,r){let n=e.value;if(n===!1)t.push([we.float.majorEncoded|Dtt]);else if(n===!0)t.push([we.float.majorEncoded|Ctt]);else if(n===null)t.push([we.float.majorEncoded|jtt]);else if(n===void 0)t.push([we.float.majorEncoded|$tt]);else{let i,o=!1;(!r||r.float64!==!0)&&(Ybe(n),i=ZF(xl,1),n===i||Number.isNaN(n)?(xl[0]=249,t.push(xl.slice(0,3)),o=!0):(Zbe(n),i=XF(xl,1),n===i&&(xl[0]=250,t.push(xl.slice(0,5)),o=!0))),o||(Ntt(n),i=Xbe(xl,1),xl[0]=251,t.push(xl.slice(0,9)))}}UR.encodedSize=function(e,r){let n=e.value;if(n===!1||n===!0||n===null||n===void 0)return 1;if(!r||r.float64!==!0){Ybe(n);let i=ZF(xl,1);if(n===i||Number.isNaN(n))return 3;if(Zbe(n),i=XF(xl,1),n===i)return 5}return 9};var Jbe=new ArrayBuffer(9),yu=new DataView(Jbe,1),xl=new Uint8Array(Jbe,0);function Ybe(t){if(t===1/0)yu.setUint16(0,31744,!1);else if(t===-1/0)yu.setUint16(0,64512,!1);else if(Number.isNaN(t))yu.setUint16(0,32256,!1);else{yu.setFloat32(0,t);let e=yu.getUint32(0),r=(e&2139095040)>>23,n=e&8388607;if(r===255)yu.setUint16(0,31744,!1);else if(r===0)yu.setUint16(0,(t&2147483648)>>16|n>>13,!1);else{let i=r-127;i<-24?yu.setUint16(0,0):i<-14?yu.setUint16(0,(e&2147483648)>>16|1<<24+i,!1):yu.setUint16(0,(e&2147483648)>>16|i+15<<10|n>>13,!1)}}}function ZF(t,e){if(t.length-e<2)throw new Error(`${Ht} not enough data for float16`);let r=(t[e]<<8)+t[e+1];if(r===31744)return 1/0;if(r===64512)return-1/0;if(r===32256)return NaN;let n=r>>10&31,i=r&1023,o;return n===0?o=i*2**-24:n!==31?o=(i+1024)*2**(n-25):o=i===0?1/0:NaN,r&32768?-o:o}function Zbe(t){yu.setFloat32(0,t,!1)}function XF(t,e){if(t.length-e<4)throw new Error(`${Ht} not enough data for float32`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,4).getFloat32(0,!1)}function Ntt(t){yu.setFloat64(0,t,!1)}function Xbe(t,e){if(t.length-e<8)throw new Error(`${Ht} not enough data for float64`);let r=(t.byteOffset||0)+e;return new DataView(t.buffer,r,8).getFloat64(0,!1)}UR.compareTokens=pu.compareTokens;function Qr(t,e,r){throw new Error(`${Ht} encountered invalid minor (${r}) for major ${t[e]>>>5}`)}function KR(t){return()=>{throw new Error(`${Ht} ${t}`)}}var Ce=[];for(let t=0;t<=23;t++)Ce[t]=Qr;Ce[24]=abe;Ce[25]=cbe;Ce[26]=dbe;Ce[27]=ube;Ce[28]=Qr;Ce[29]=Qr;Ce[30]=Qr;Ce[31]=Qr;for(let t=32;t<=55;t++)Ce[t]=Qr;Ce[56]=lbe;Ce[57]=fbe;Ce[58]=hbe;Ce[59]=ybe;Ce[60]=Qr;Ce[61]=Qr;Ce[62]=Qr;Ce[63]=Qr;for(let t=64;t<=87;t++)Ce[t]=mbe;Ce[88]=gbe;Ce[89]=vbe;Ce[90]=bbe;Ce[91]=wbe;Ce[92]=Qr;Ce[93]=Qr;Ce[94]=Qr;Ce[95]=KR("indefinite length bytes/strings are not supported");for(let t=96;t<=119;t++)Ce[t]=_be;Ce[120]=xbe;Ce[121]=Ebe;Ce[122]=Sbe;Ce[123]=Tbe;Ce[124]=Qr;Ce[125]=Qr;Ce[126]=Qr;Ce[127]=KR("indefinite length bytes/strings are not supported");for(let t=128;t<=151;t++)Ce[t]=kbe;Ce[152]=Pbe;Ce[153]=Ibe;Ce[154]=Rbe;Ce[155]=Bbe;Ce[156]=Qr;Ce[157]=Qr;Ce[158]=Qr;Ce[159]=Obe;for(let t=160;t<=183;t++)Ce[t]=Mbe;Ce[184]=Dbe;Ce[185]=Cbe;Ce[186]=jbe;Ce[187]=$be;Ce[188]=Qr;Ce[189]=Qr;Ce[190]=Qr;Ce[191]=Nbe;for(let t=192;t<=215;t++)Ce[t]=Ube;Ce[216]=Kbe;Ce[217]=qbe;Ce[218]=Lbe;Ce[219]=Fbe;Ce[220]=Qr;Ce[221]=Qr;Ce[222]=Qr;Ce[223]=Qr;for(let t=224;t<=243;t++)Ce[t]=KR("simple values are not supported");Ce[244]=Qr;Ce[245]=Qr;Ce[246]=Qr;Ce[247]=zbe;Ce[248]=KR("simple values are not supported");Ce[249]=Hbe;Ce[250]=Wbe;Ce[251]=Gbe;Ce[252]=Qr;Ce[253]=Qr;Ce[254]=Qr;Ce[255]=Vbe;var El=[];for(let t=0;t<24;t++)El[t]=new Je(we.uint,t,1);for(let t=-1;t>=-24;t--)El[31-t]=new Je(we.negint,t,1);El[64]=new Je(we.bytes,new Uint8Array(0),1);El[96]=new Je(we.string,"",1);El[128]=new Je(we.array,0,1);El[160]=new Je(we.map,0,1);El[244]=new Je(we.false,!1,1);El[245]=new Je(we.true,!0,1);El[246]=new Je(we.null,null,1);function Ktt(){let t=[];return t[we.uint.major]=pu,t[we.negint.major]=DR,t[we.bytes.major]=O_,t[we.string.major]=Abe,t[we.array.major]=jR,t[we.map.major]=$R,t[we.tag.major]=NR,t[we.float.major]=UR,t}var bNt=Ktt(),wNt=new MR,qR=class t{constructor(e,r){this.obj=e,this.parent=r}includes(e){let r=this;do if(r.obj===e)return!0;while(r=r.parent);return!1}static createCheck(e,r){if(e&&e.includes(r))throw new Error(`${GF} object contains circular references`);return new t(r,e)}},p0={null:new Je(we.null,null),undefined:new Je(we.undefined,void 0),true:new Je(we.true,!0),false:new Je(we.false,!1),emptyArray:new Je(we.array,0),emptyMap:new Je(we.map,0)},y0={number(t,e,r,n){return!Number.isInteger(t)||!Number.isSafeInteger(t)?new Je(we.float,t):t>=0?new Je(we.uint,t):new Je(we.negint,t)},bigint(t,e,r,n){return t>=BigInt(0)?new Je(we.uint,t):new Je(we.negint,t)},Uint8Array(t,e,r,n){return new Je(we.bytes,t)},string(t,e,r,n){return new Je(we.string,t)},boolean(t,e,r,n){return t?p0.true:p0.false},null(t,e,r,n){return p0.null},undefined(t,e,r,n){return p0.undefined},ArrayBuffer(t,e,r,n){return new Je(we.bytes,new Uint8Array(t))},DataView(t,e,r,n){return new Je(we.bytes,new Uint8Array(t.buffer,t.byteOffset,t.byteLength))},Array(t,e,r,n){if(!t.length)return r.addBreakTokens===!0?[p0.emptyArray,new Je(we.break)]:p0.emptyArray;n=qR.createCheck(n,t);let i=[],o=0;for(let s of t)i[o++]=QF(s,r,n);return r.addBreakTokens?[new Je(we.array,t.length),i,new Je(we.break)]:[new Je(we.array,t.length),i]},Object(t,e,r,n){let i=e!=="Object",o=i?t.keys():Object.keys(t),s=i?t.size:o.length;if(!s)return r.addBreakTokens===!0?[p0.emptyMap,new Je(we.break)]:p0.emptyMap;n=qR.createCheck(n,t);let a=[],d=0;for(let u of o)a[d++]=[QF(u,r,n),QF(i?t.get(u):t[u],r,n)];return qtt(a,r),r.addBreakTokens?[new Je(we.map,s),a,new Je(we.break)]:[new Je(we.map,s),a]}};y0.Map=y0.Object;y0.Buffer=y0.Uint8Array;for(let t of"Uint8Clamped Uint16 Uint32 Int8 Int16 Int32 BigUint64 BigInt64 Float32 Float64".split(" "))y0[`${t}Array`]=y0.DataView;function QF(t,e={},r){let n=Zve(t),i=e&&e.typeEncoders&&e.typeEncoders[n]||y0[n];if(typeof i=="function"){let s=i(t,n,e,r);if(s!=null)return s}let o=y0[n];if(!o)throw new Error(`${GF} unsupported type: ${n}`);return o(t,n,e,r)}function qtt(t,e){e.mapSorter&&t.sort(e.mapSorter)}f();var Ltt={strict:!1,allowIndefinite:!0,allowUndefined:!0,allowBigInt:!0},LR=class{constructor(e,r={}){this._pos=0,this.data=e,this.options=r}pos(){return this._pos}done(){return this._pos>=this.data.length}next(){let e=this.data[this._pos],r=El[e];if(r===void 0){let n=Ce[e];if(!n)throw new Error(`${Ht} no decoder for major type ${e>>>5} (byte 0x${e.toString(16).padStart(2,"0")})`);let i=e&31;r=n(this.data,this._pos,i,this.options)}return this._pos+=r.encodedLength,r}},s3=Symbol.for("DONE"),FR=Symbol.for("BREAK");function Ftt(t,e,r){let n=[];for(let i=0;i<t.value;i++){let o=C_(e,r);if(o===FR){if(t.value===1/0)break;throw new Error(`${Ht} got unexpected break to lengthed array`)}if(o===s3)throw new Error(`${Ht} found array but not enough entries (got ${i}, expected ${t.value})`);n[i]=o}return n}function ztt(t,e,r){let n=r.useMaps===!0,i=n?void 0:{},o=n?new Map:void 0;for(let s=0;s<t.value;s++){let a=C_(e,r);if(a===FR){if(t.value===1/0)break;throw new Error(`${Ht} got unexpected break to lengthed map`)}if(a===s3)throw new Error(`${Ht} found map but not enough entries (got ${s} [no key], expected ${t.value})`);if(n!==!0&&typeof a!="string")throw new Error(`${Ht} non-string keys not supported (got ${typeof a})`);if(r.rejectDuplicateMapKeys===!0&&(n&&o.has(a)||!n&&a in i))throw new Error(`${Ht} found repeat map key "${a}"`);let d=C_(e,r);if(d===s3)throw new Error(`${Ht} found map but not enough entries (got ${s} [no value], expected ${t.value})`);n?o.set(a,d):i[a]=d}return n?o:i}function C_(t,e){if(t.done())return s3;let r=t.next();if(r.type===we.break)return FR;if(r.type.terminal)return r.value;if(r.type===we.array)return Ftt(r,t,e);if(r.type===we.map)return ztt(r,t,e);if(r.type===we.tag){if(e.tags&&typeof e.tags[r.value]=="function"){let n=C_(t,e);return e.tags[r.value](n)}throw new Error(`${Ht} tag not supported (${r.value})`)}throw new Error("unsupported")}function Qbe(t,e){if(!(t instanceof Uint8Array))throw new Error(`${Ht} data to decode must be a Uint8Array`);e=Object.assign({},Ltt,e);let r=e.tokenizer||new LR(t,e),n=C_(r,e);if(n===s3)throw new Error(`${Ht} did not find any content to decode`);if(n===FR)throw new Error(`${Ht} got unexpected break`);return[n,t.subarray(r.pos())]}function ez(t,e){let[r,n]=Qbe(t,e);if(n.length>0)throw new Error(`${Ht} too many terminals, data makes no sense`);return r}var Wtt=42;function Gtt(t){if(t[0]!==0)throw new Error("Invalid CID for CBOR tag 42; expected leading 0x00");return wh.decode(t.subarray(1))}var ewe={allowIndefinite:!1,coerceUndefinedToNull:!0,allowNaN:!1,allowInfinity:!1,allowBigInt:!0,strict:!0,useMaps:!1,rejectDuplicateMapKeys:!0,tags:[]};ewe.tags[Wtt]=Gtt;var twe=113;var rwe=t=>ez(t,ewe);var $we=xt(Uc(),1);f();var iwe=0,Jtt="identity",owe=Eu,Ytt=t=>G0(iwe,owe(t)),swe={code:iwe,name:Jtt,encode:owe,digest:Ytt};f();var awe=xt(Uc(),1);var Ztt=async(t,e,r,n,i,o,s,a)=>{let d=await s.get(t,a),u=rwe(d),c=u,l=r;for(;n.length>0;){let h=n[0];if(h in c){n.shift(),l=`${l}/${h}`;let y=Fr.asCID(c[h]);if(y!=null)return{entry:{type:"object",name:e,path:r,cid:t,node:d,depth:o,size:BigInt(d.length),content:async function*(){yield u}},next:{cid:y,name:h,path:l,toResolve:n}};c=c[h]}else throw(0,awe.default)(new Error(`No property named ${h} found in cbor node ${t}`),"ERR_NO_PROP")}return{entry:{type:"object",name:e,path:r,cid:t,node:d,depth:o,size:BigInt(d.length),content:async function*(){yield u}}}},cwe=Ztt;f();var dwe=xt(Uc(),1);f();function Xtt(t,e,r,n){let i=BigInt(t.length),o=BigInt(e+i);return r>=o||n<e?new Uint8Array(0):(n>=e&&n<o&&(t=t.subarray(0,Number(n-e))),r>=e&&r<o&&(t=t.subarray(Number(r-e))),t)}var Pb=Xtt;f();var a3=xt(Uc(),1),Qtt=(t,e=0,r=t)=>{let n=BigInt(t),i=BigInt(e??0),o=BigInt(r);if(o!==n&&(o=i+o),o>n&&(o=n),i<0n)throw(0,a3.default)(new Error("Offset must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(i>n)throw(0,a3.default)(new Error("Offset must be less than the file size"),"ERR_INVALID_PARAMS");if(o<0n)throw(0,a3.default)(new Error("Length must be greater than or equal to 0"),"ERR_INVALID_PARAMS");if(o>n)throw(0,a3.default)(new Error("Length must be less than the file size"),"ERR_INVALID_PARAMS");return{start:i,end:o}},j_=Qtt;var ert=t=>{async function*e(r={}){let{start:n,end:i}=j_(t.length,r.offset,r.length),o=Pb(t,0n,n,i);r.onProgress?.(new xi("unixfs:exporter:progress:identity",{bytesRead:BigInt(o.byteLength),totalBytes:i-n,fileSize:BigInt(t.byteLength)})),yield o}return e},trt=async(t,e,r,n,i,o,s,a)=>{if(n.length>0)throw(0,dwe.default)(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let d=w8(t.multihash.bytes);return{entry:{type:"identity",name:e,path:r,cid:t,content:ert(d.digest),depth:o,size:BigInt(d.digest.length),node:d.digest}}},uwe=trt;f();var lwe=xt(Uc(),1);var rrt=t=>{async function*e(r={}){let{start:n,end:i}=j_(t.length,r.offset,r.length),o=Pb(t,0n,n,i);r.onProgress?.(new xi("unixfs:exporter:progress:raw",{bytesRead:BigInt(o.byteLength),totalBytes:i-n,fileSize:BigInt(t.byteLength)})),yield o}return e},nrt=async(t,e,r,n,i,o,s,a)=>{if(n.length>0)throw(0,lwe.default)(new Error(`No link named ${r} found in raw node ${t}`),"ERR_NOT_FOUND");let d=await s.get(t,a);return{entry:{type:"raw",name:e,path:r,cid:t,content:rrt(d),depth:o,size:BigInt(d.length),node:d}}},fwe=nrt;f();var y3=xt(Uc(),1);f();var irt=async function(t){return(await iT.encode(t)).slice(0,8).reverse()},ort=async(t,e,r)=>{await Promise.all(t.map(async n=>{if(n.Name==null)throw new Error("Unexpected Link without a Name");if(n.Name.length===2){let i=parseInt(n.Name,16);e._putObjectAt(i,new Ll({hash:r._options.hash,bits:r._options.bits},e,i));return}await r.put(n.Name.substring(2),!0)}))},hwe=t=>t.toString(16).toUpperCase().padStart(2,"0").substring(0,2),srt=t=>{let e=t.bucket,r=[];for(;e._parent!=null;)r.push(e),e=e._parent;return r.push(e),r.reverse()},pwe=async(t,e,r,n,i)=>{if(n==null){let c=aT({hashFn:irt});n={rootBucket:c,hamtDepth:1,lastBucket:c}}await ort(t.Links,n.lastBucket,n.rootBucket);let o=await n.rootBucket._findNewBucketAndPos(e),s=hwe(o.pos),a=srt(o);a.length>n.hamtDepth&&(n.lastBucket=a[n.hamtDepth],s=hwe(n.lastBucket._posAtParent));let d=t.Links.find(c=>{if(c.Name==null)return!1;let l=c.Name.substring(0,2),h=c.Name.substring(2);return!(l!==s||h!==""&&h!==e)});if(d==null)return;if(d.Name!=null&&d.Name.substring(2)===e)return d.Hash;n.hamtDepth++;let u=await r.get(d.Hash,i);return t=_h(u),pwe(t,e,r,n,i)},ywe=pwe;f();f();f();function art(t){let[e,r]=t[Symbol.asyncIterator]!=null?[t[Symbol.asyncIterator](),Symbol.asyncIterator]:[t[Symbol.iterator](),Symbol.iterator],n=[];return{peek:()=>e.next(),push:i=>{n.push(i)},next:()=>n.length>0?{done:!1,value:n.shift()}:e.next(),[r](){return this}}}var zR=art;function crt(t){return t[Symbol.asyncIterator]!=null}function drt(t,e){let r=0;if(crt(t))return async function*(){for await(let d of t)await e(d,r++)&&(yield d)}();let n=zR(t),{value:i,done:o}=n.next();if(o===!0)return function*(){}();let s=e(i,r++);if(typeof s.then=="function")return async function*(){await s&&(yield i);for await(let d of n)await e(d,r++)&&(yield d)}();let a=e;return function*(){s===!0&&(yield i);for(let d of n)a(d,r++)&&(yield d)}()}var mwe=drt;f();function urt(t){return t[Symbol.asyncIterator]!=null}function lrt(t,e){let r=0;if(urt(t))return async function*(){for await(let d of t)yield e(d,r++)}();let n=zR(t),{value:i,done:o}=n.next();if(o===!0)return function*(){}();let s=e(i,r++);if(typeof s.then=="function")return async function*(){yield await s;for await(let d of n)yield e(d,r++)}();let a=e;return function*(){yield s;for(let d of n)yield a(d,r++)}()}var $_=lrt;f();f();function Lp(){let t={};return t.promise=new Promise((e,r)=>{t.resolve=e,t.reject=r}),t}var VR=globalThis.CustomEvent??Event;async function*Ib(t,e={}){let r=e.concurrency??1/0;r<1&&(r=1/0);let n=e.ordered==null?!1:e.ordered,i=new EventTarget,o=[],s=Lp(),a=Lp(),d=!1,u,c=!1;i.addEventListener("task-complete",()=>{a.resolve()}),Promise.resolve().then(async()=>{try{for await(let g of t){if(o.length===r&&(s=Lp(),await s.promise),c)break;let v={done:!1};o.push(v),g().then(x=>{v.done=!0,v.ok=!0,v.value=x,i.dispatchEvent(new VR("task-complete"))},x=>{v.done=!0,v.err=x,i.dispatchEvent(new VR("task-complete"))})}d=!0,i.dispatchEvent(new VR("task-complete"))}catch(g){u=g,i.dispatchEvent(new VR("task-complete"))}});function l(){return n?o[0]?.done:!!o.find(g=>g.done)}function*h(){for(;o.length>0&&o[0].done;){let g=o[0];if(o.shift(),g.ok)yield g.value;else throw c=!0,s.resolve(),g.err;s.resolve()}}function*y(){for(;l();)for(let g=0;g<o.length;g++)if(o[g].done){let v=o[g];if(o.splice(g,1),g--,v.ok)yield v.value;else throw c=!0,s.resolve(),v.err;s.resolve()}}for(;;){if(l()||(a=Lp(),await a.promise),u!=null)throw u;if(n?yield*h():yield*y(),d&&o.length===0)break}}f();f();f();var HR=class{buffer;mask;top;btm;next;constructor(e){if(!(e>0)||e-1&e)throw new Error("Max size for a FixedFIFO should be a power of two");this.buffer=new Array(e),this.mask=e-1,this.top=0,this.btm=0,this.next=null}push(e){return this.buffer[this.top]!==void 0?!1:(this.buffer[this.top]=e,this.top=this.top+1&this.mask,!0)}shift(){let e=this.buffer[this.btm];if(e!==void 0)return this.buffer[this.btm]=void 0,this.btm=this.btm+1&this.mask,e}isEmpty(){return this.buffer[this.btm]===void 0}},N_=class{size;hwm;head;tail;constructor(e={}){this.hwm=e.splitLimit??16,this.head=new HR(this.hwm),this.tail=this.head,this.size=0}calculateSize(e){return e?.byteLength!=null?e.byteLength:1}push(e){if(e?.value!=null&&(this.size+=this.calculateSize(e.value)),!this.head.push(e)){let r=this.head;this.head=r.next=new HR(2*this.head.buffer.length),this.head.push(e)}}shift(){let e=this.tail.shift();if(e===void 0&&this.tail.next!=null){let r=this.tail.next;this.tail.next=null,this.tail=r,e=this.tail.shift()}return e?.value!=null&&(this.size-=this.calculateSize(e.value)),e}isEmpty(){return this.head.isEmpty()}};var tz=class extends Error{type;code;constructor(e,r){super(e??"The operation was aborted"),this.type="aborted",this.code=r??"ABORT_ERR"}};function U_(t={}){return frt(r=>{let n=r.shift();if(n==null)return{done:!0};if(n.error!=null)throw n.error;return{done:n.done===!0,value:n.value}},t)}function frt(t,e){e=e??{};let r=e.onEnd,n=new N_,i,o,s,a=Lp(),d=async()=>{try{return n.isEmpty()?s?{done:!0}:await new Promise((x,S)=>{o=A=>{o=null,n.push(A);try{x(t(n))}catch(T){S(T)}return i}}):t(n)}finally{n.isEmpty()&&queueMicrotask(()=>{a.resolve(),a=Lp()})}},u=x=>o!=null?o(x):(n.push(x),i),c=x=>(n=new N_,o!=null?o({error:x}):(n.push({error:x}),i)),l=x=>{if(s)return i;if(e?.objectMode!==!0&&x?.byteLength==null)throw new Error("objectMode was not true but tried to push non-Uint8Array value");return u({done:!1,value:x})},h=x=>s?i:(s=!0,x!=null?c(x):u({done:!0})),y=()=>(n=new N_,h(),{done:!0}),g=x=>(h(x),{done:!0});if(i={[Symbol.asyncIterator](){return this},next:d,return:y,throw:g,push:l,end:h,get readableLength(){return n.size},onEmpty:async x=>{let S=x?.signal;if(S?.throwIfAborted(),n.isEmpty())return;let A,T;S!=null&&(A=new Promise(($,j)=>{T=()=>{j(new tz)},S.addEventListener("abort",T)}));try{await Promise.race([a.promise,A])}finally{T!=null&&S!=null&&S?.removeEventListener("abort",T)}}},r==null)return i;let v=i;return i={[Symbol.asyncIterator](){return this},next(){return v.next()},throw(x){return v.throw(x),r!=null&&(r(x),r=void 0),{done:!0}},return(){return v.return(),r!=null&&(r(),r=void 0),{done:!0}},push:l,end(x){return v.end(x),r!=null&&(r(x),r=void 0),i},get readableLength(){return v.readableLength},onEmpty:x=>v.onEmpty(x)},i}f();function hrt(t){return t[Symbol.asyncIterator]!=null}function prt(...t){let e=[];for(let r of t)hrt(r)||e.push(r);return e.length===t.length?function*(){for(let r of e)yield*r}():async function*(){let r=U_({objectMode:!0});Promise.resolve().then(async()=>{try{await Promise.all(t.map(async n=>{for await(let i of n)r.push(i)})),r.end()}catch(n){r.end(n)}}),yield*r}()}var gwe=prt;function K_(t,...e){if(t==null)throw new Error("Empty pipeline");if(rz(t)){let n=t;t=()=>n.source}else if(bwe(t)||vwe(t)){let n=t;t=()=>n}let r=[t,...e];if(r.length>1&&rz(r[r.length-1])&&(r[r.length-1]=r[r.length-1].sink),r.length>2)for(let n=1;n<r.length-1;n++)rz(r[n])&&(r[n]=mrt(r[n]));return yrt(...r)}var yrt=(...t)=>{let e;for(;t.length>0;)e=t.shift()(e);return e},vwe=t=>t?.[Symbol.asyncIterator]!=null,bwe=t=>t?.[Symbol.iterator]!=null,rz=t=>t==null?!1:t.sink!=null&&t.source!=null,mrt=t=>e=>{let r=t.sink(e);if(r?.then!=null){let n=U_({objectMode:!0});r.then(()=>{n.end()},s=>{n.end(s)});let i,o=t.source;if(vwe(o))i=async function*(){yield*o,n.end()};else if(bwe(o))i=function*(){yield*o,n.end()};else throw new Error("Unknown duplex source type - must be Iterable or AsyncIterable");return gwe(n,i())}return t.source};var grt=(t,e,r,n,i,o,s)=>{async function*a(d={}){let u=d.offset??0,c=d.length??e.Links.length,l=e.Links.slice(u,c);d.onProgress?.(new xi("unixfs:exporter:walk:directory",{cid:t})),yield*K_(l,h=>$_(h,y=>async()=>{let g=y.Name??"",v=`${n}/${g}`;return(await i(y.Hash,g,v,[],o+1,s,d)).entry}),h=>Ib(h,{ordered:!0}),h=>mwe(h,y=>y!=null))}return a},wwe=grt;f();var Bb=xt(Uc(),1);f();f();var iz=xt(xwe(),1);f();var d3=class extends Error{constructor(e){super(e),this.name="TimeoutError"}},oz=class extends Error{constructor(e){super(),this.name="AbortError",this.message=e}},Ewe=t=>globalThis.DOMException===void 0?new oz(t):new DOMException(t),Swe=t=>{let e=t.reason===void 0?Ewe("This operation was aborted."):t.reason;return e instanceof Error?e:Ewe(e)};function sz(t,e,r,n){let i,o=new Promise((s,a)=>{if(typeof e!="number"||Math.sign(e)!==1)throw new TypeError(`Expected \`milliseconds\` to be a positive number, got \`${e}\``);if(e===Number.POSITIVE_INFINITY){s(t);return}if(n={customTimers:{setTimeout,clearTimeout},...n},n.signal){let{signal:d}=n;d.aborted&&a(Swe(d)),d.addEventListener("abort",()=>{a(Swe(d))})}i=n.customTimers.setTimeout.call(void 0,()=>{if(typeof r=="function"){try{s(r())}catch(c){a(c)}return}let d=typeof r=="string"?r:`Promise timed out after ${e} milliseconds`,u=r instanceof Error?r:new d3(d);typeof t.cancel=="function"&&t.cancel(),a(u)},e),(async()=>{try{s(await t)}catch(d){a(d)}finally{n.customTimers.clearTimeout.call(void 0,i)}})()});return o.clear=()=>{clearTimeout(i),i=void 0},o}f();f();function az(t,e,r){let n=0,i=t.length;for(;i>0;){let o=Math.trunc(i/2),s=n+o;r(t[s],e)<=0?(n=++s,i-=o+1):i=o}return n}var Rb=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Fp,cz=class{constructor(){Fp.set(this,[])}enqueue(e,r){r={priority:0,...r};let n={priority:r.priority,run:e};if(this.size&&Rb(this,Fp,"f")[this.size-1].priority>=r.priority){Rb(this,Fp,"f").push(n);return}let i=az(Rb(this,Fp,"f"),n,(o,s)=>s.priority-o.priority);Rb(this,Fp,"f").splice(i,0,n)}dequeue(){let e=Rb(this,Fp,"f").shift();return e?.run}filter(e){return Rb(this,Fp,"f").filter(r=>r.priority===e.priority).map(r=>r.run)}get size(){return Rb(this,Fp,"f").length}};Fp=new WeakMap;var Twe=cz;var yi=function(t,e,r,n,i){if(n==="m")throw new TypeError("Private method is not writable");if(n==="a"&&!i)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!i:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return n==="a"?i.call(t,r):i?i.value=r:e.set(t,r),r},dt=function(t,e,r,n){if(r==="a"&&!n)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!n:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return r==="m"?n:r==="a"?n.call(t):n?n.value:e.get(t)},Fi,l3,f3,g0,QR,h3,GR,Sl,u3,md,JR,gd,p3,m0,YR,Awe,kwe,Rwe,Pwe,Iwe,ZR,dz,uz,eB,Bwe,XR,tB=class extends Error{},lz=class extends iz.default{constructor(e){var r,n,i,o;if(super(),Fi.add(this),l3.set(this,void 0),f3.set(this,void 0),g0.set(this,0),QR.set(this,void 0),h3.set(this,void 0),GR.set(this,0),Sl.set(this,void 0),u3.set(this,void 0),md.set(this,void 0),JR.set(this,void 0),gd.set(this,0),p3.set(this,void 0),m0.set(this,void 0),YR.set(this,void 0),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e={carryoverConcurrencyCount:!1,intervalCap:Number.POSITIVE_INFINITY,interval:0,concurrency:Number.POSITIVE_INFINITY,autoStart:!0,queueClass:Twe,...e},!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(n=(r=e.intervalCap)===null||r===void 0?void 0:r.toString())!==null&&n!==void 0?n:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(o=(i=e.interval)===null||i===void 0?void 0:i.toString())!==null&&o!==void 0?o:""}\` (${typeof e.interval})`);yi(this,l3,e.carryoverConcurrencyCount,"f"),yi(this,f3,e.intervalCap===Number.POSITIVE_INFINITY||e.interval===0,"f"),yi(this,QR,e.intervalCap,"f"),yi(this,h3,e.interval,"f"),yi(this,md,new e.queueClass,"f"),yi(this,JR,e.queueClass,"f"),this.concurrency=e.concurrency,this.timeout=e.timeout,yi(this,YR,e.throwOnTimeout===!0,"f"),yi(this,m0,e.autoStart===!1,"f")}get concurrency(){return dt(this,p3,"f")}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);yi(this,p3,e,"f"),dt(this,Fi,"m",eB).call(this)}async add(e,r={}){return r={timeout:this.timeout,throwOnTimeout:dt(this,YR,"f"),...r},new Promise((n,i)=>{dt(this,md,"f").enqueue(async()=>{var o,s,a;yi(this,gd,(s=dt(this,gd,"f"),s++,s),"f"),yi(this,g0,(a=dt(this,g0,"f"),a++,a),"f");try{if(!((o=r.signal)===null||o===void 0)&&o.aborted)throw new tB("The task was aborted.");let d=e({signal:r.signal});r.timeout&&(d=sz(Promise.resolve(d),r.timeout)),r.signal&&(d=Promise.race([d,dt(this,Fi,"m",Bwe).call(this,r.signal)]));let u=await d;n(u),this.emit("completed",u)}catch(d){if(d instanceof d3&&!r.throwOnTimeout){n();return}i(d),this.emit("error",d)}finally{dt(this,Fi,"m",Rwe).call(this)}},r),this.emit("add"),dt(this,Fi,"m",ZR).call(this)})}async addAll(e,r){return Promise.all(e.map(async n=>this.add(n,r)))}start(){return dt(this,m0,"f")?(yi(this,m0,!1,"f"),dt(this,Fi,"m",eB).call(this),this):this}pause(){yi(this,m0,!0,"f")}clear(){yi(this,md,new(dt(this,JR,"f")),"f")}async onEmpty(){dt(this,md,"f").size!==0&&await dt(this,Fi,"m",XR).call(this,"empty")}async onSizeLessThan(e){dt(this,md,"f").size<e||await dt(this,Fi,"m",XR).call(this,"next",()=>dt(this,md,"f").size<e)}async onIdle(){dt(this,gd,"f")===0&&dt(this,md,"f").size===0||await dt(this,Fi,"m",XR).call(this,"idle")}get size(){return dt(this,md,"f").size}sizeBy(e){return dt(this,md,"f").filter(e).length}get pending(){return dt(this,gd,"f")}get isPaused(){return dt(this,m0,"f")}};l3=new WeakMap,f3=new WeakMap,g0=new WeakMap,QR=new WeakMap,h3=new WeakMap,GR=new WeakMap,Sl=new WeakMap,u3=new WeakMap,md=new WeakMap,JR=new WeakMap,gd=new WeakMap,p3=new WeakMap,m0=new WeakMap,YR=new WeakMap,Fi=new WeakSet,Awe=function(){return dt(this,f3,"f")||dt(this,g0,"f")<dt(this,QR,"f")},kwe=function(){return dt(this,gd,"f")<dt(this,p3,"f")},Rwe=function(){var e;yi(this,gd,(e=dt(this,gd,"f"),e--,e),"f"),dt(this,Fi,"m",ZR).call(this),this.emit("next")},Pwe=function(){dt(this,Fi,"m",uz).call(this),dt(this,Fi,"m",dz).call(this),yi(this,u3,void 0,"f")},Iwe=function(){let e=Date.now();if(dt(this,Sl,"f")===void 0){let r=dt(this,GR,"f")-e;if(r<0)yi(this,g0,dt(this,l3,"f")?dt(this,gd,"f"):0,"f");else return dt(this,u3,"f")===void 0&&yi(this,u3,setTimeout(()=>{dt(this,Fi,"m",Pwe).call(this)},r),"f"),!0}return!1},ZR=function(){if(dt(this,md,"f").size===0)return dt(this,Sl,"f")&&clearInterval(dt(this,Sl,"f")),yi(this,Sl,void 0,"f"),this.emit("empty"),dt(this,gd,"f")===0&&this.emit("idle"),!1;if(!dt(this,m0,"f")){let e=!dt(this,Fi,"a",Iwe);if(dt(this,Fi,"a",Awe)&&dt(this,Fi,"a",kwe)){let r=dt(this,md,"f").dequeue();return r?(this.emit("active"),r(),e&&dt(this,Fi,"m",dz).call(this),!0):!1}}return!1},dz=function(){dt(this,f3,"f")||dt(this,Sl,"f")!==void 0||(yi(this,Sl,setInterval(()=>{dt(this,Fi,"m",uz).call(this)},dt(this,h3,"f")),"f"),yi(this,GR,Date.now()+dt(this,h3,"f"),"f"))},uz=function(){dt(this,g0,"f")===0&&dt(this,gd,"f")===0&&dt(this,Sl,"f")&&(clearInterval(dt(this,Sl,"f")),yi(this,Sl,void 0,"f")),yi(this,g0,dt(this,l3,"f")?dt(this,gd,"f"):0,"f"),dt(this,Fi,"m",eB).call(this)},eB=function(){for(;dt(this,Fi,"m",ZR).call(this););},Bwe=async function(e){return new Promise((r,n)=>{e.addEventListener("abort",()=>{n(new tB("The task was aborted."))},{once:!0})})},XR=async function(e,r){return new Promise(n=>{let i=()=>{r&&!r()||(this.off(e,i),n())};this.on(e,i)})};var Owe=lz;async function Mwe(t,e,r,n,i,o,s){if(e instanceof Uint8Array){let u=Pb(e,n,i,o);r.push(u);return}if(e.Data==null)throw(0,Bb.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");let a;try{a=Bo.unmarshal(e.Data)}catch(u){throw(0,Bb.default)(u,"ERR_NOT_UNIXFS")}if(a.data!=null){let u=a.data,c=Pb(u,n,i,o);r.push(c),n+=BigInt(c.byteLength)}let d=[];if(e.Links.length!==a.blockSizes.length)throw(0,Bb.default)(new Error("Inconsistent block sizes and dag links"),"ERR_NOT_UNIXFS");for(let u=0;u<e.Links.length;u++){let c=e.Links[u],l=n,h=l+a.blockSizes[u];if((i>=l&&i<h||o>=l&&o<=h||i<l&&o>h)&&d.push({link:c,blockStart:n}),n=h,n>o)break}await K_(d,u=>$_(u,c=>async()=>{let l=await t.get(c.link.Hash,s);return{...c,block:l}}),u=>Ib(u,{ordered:!0}),async u=>{for await(let{link:c,block:l,blockStart:h}of u){let y;switch(c.Hash.code){case Gx:y=_h(l);break;case Py:y=l;break;default:r.end((0,Bb.default)(new Error(`Unsupported codec: ${c.Hash.code}`),"ERR_NOT_UNIXFS"));return}let g=new Owe({concurrency:1});g.on("error",v=>{r.end(v)}),g.add(async()=>{s.onProgress?.(new xi("unixfs:exporter:walk:file",{cid:c.Hash})),await Mwe(t,y,r,h,i,o,s)}),await g.onIdle()}}),n>=o&&r.end()}var wrt=(t,e,r,n,i,o,s)=>{async function*a(d={}){let u=r.fileSize();if(u===void 0)throw new Error("File was a directory");let{start:c,end:l}=j_(u,d.offset,d.length);if(l===0n)return;let h=0n,y=l-c,g=U_();d.onProgress?.(new xi("unixfs:exporter:walk:file",{cid:t})),Mwe(s,e,g,0n,c,l,d).catch(v=>{g.end(v)});for await(let v of g)if(v!=null){if(h+=BigInt(v.byteLength),h>y)throw g.end(),(0,Bb.default)(new Error("Read too many bytes - the file size reported by the UnixFS data in the root node may be incorrect"),"ERR_OVER_READ");h===y&&g.end(),d.onProgress?.(new xi("unixfs:exporter:progress:unixfs:file",{bytesRead:h,totalBytes:y,fileSize:u})),yield v}if(h<y)throw(0,Bb.default)(new Error("Traversed entire DAG but did not read enough bytes"),"ERR_UNDER_READ")}return a},fz=wrt;f();var _rt=(t,e,r,n,i,o,s)=>{function a(d={}){return d.onProgress?.(new xi("unixfs:exporter:walk:hamt-sharded-directory",{cid:t})),Dwe(e,n,i,o,s,d)}return a};async function*Dwe(t,e,r,n,i,o){let s=t.Links,a=K_(s,d=>$_(d,u=>async()=>{let c=u.Name!=null?u.Name.substring(2):null;if(c!=null&&c!==""){let l=await r(u.Hash,c,`${e}/${c}`,[],n+1,i,o);return{entries:l.entry==null?[]:[l.entry]}}else{let l=await i.get(u.Hash,o);return t=_h(l),o.onProgress?.(new xi("unixfs:exporter:walk:hamt-sharded-directory",{cid:u.Hash})),{entries:Dwe(t,e,r,n,i,o)}}}),d=>Ib(d,{ordered:!0}));for await(let{entries:d}of a)yield*d}var Cwe=_rt;var xrt=(t,e)=>t.Links.find(n=>n.Name===e)?.Hash,Ert={raw:fz,file:fz,directory:wwe,"hamt-sharded-directory":Cwe,metadata:(t,e,r,n,i,o,s)=>()=>[],symlink:(t,e,r,n,i,o,s)=>()=>[]},Srt=async(t,e,r,n,i,o,s,a)=>{let d=await s.get(t,a),u=_h(d),c,l;if(e==null&&(e=t.toString()),u.Data==null)throw(0,y3.default)(new Error("no data in PBNode"),"ERR_NOT_UNIXFS");try{c=Bo.unmarshal(u.Data)}catch(y){throw(0,y3.default)(y,"ERR_NOT_UNIXFS")}if(r==null&&(r=e),n.length>0){let y;if(c?.type==="hamt-sharded-directory"?y=await ywe(u,n[0],s):y=xrt(u,n[0]),y==null)throw(0,y3.default)(new Error("file does not exist"),"ERR_NOT_FOUND");let g=n.shift(),v=`${r}/${g}`;l={cid:y,toResolve:n,name:g??"",path:v}}let h=Ert[c.type](t,u,c,r,i,o,s);if(h==null)throw(0,y3.default)(new Error("could not find content exporter"),"ERR_NOT_FOUND");return c.isDirectory()?{entry:{type:"directory",name:e,path:r,cid:t,content:h,unixfs:c,depth:o,node:u,size:c.fileSize()},next:l}:{entry:{type:"file",name:e,path:r,cid:t,content:h,unixfs:c,depth:o,node:u,size:c.fileSize()},next:l}},jwe=Srt;var Trt={[Gx]:jwe,[Py]:fwe,[twe]:cwe,[swe.code]:uwe},Nwe=async(t,e,r,n,i,o,s)=>{let a=Trt[t.code];if(a==null)throw(0,$we.default)(new Error(`No resolver for code ${t.code}`),"ERR_NO_RESOLVER");return a(t,e,r,n,Nwe,i,o,s)},Uwe=Nwe;var Art=(t="")=>(t.trim().match(/([^\\^/]|\\\/)+/g)??[]).filter(Boolean),krt=t=>{if(t instanceof Uint8Array)return{cid:Fr.decode(t),toResolve:[]};let e=Fr.asCID(t);if(e!=null)return{cid:e,toResolve:[]};if(typeof t=="string"){t.indexOf("/ipfs/")===0&&(t=t.substring(6));let r=Art(t);return{cid:Fr.parse(r[0]),toResolve:r.slice(1)}}throw(0,rB.default)(new Error(`Unknown path type ${t}`),"ERR_BAD_PATH")};async function*Prt(t,e,r={}){let{cid:n,toResolve:i}=krt(t),o=n.toString(),s=o,a=i.length;for(;;){let d=await Uwe(n,o,s,i,a,e,r);if(d.entry==null&&d.next==null)throw(0,rB.default)(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");if(d.entry!=null&&(yield d.entry),d.next==null)return;i=d.next.toResolve,n=d.next.cid,o=d.next.name,s=d.next.path}}async function Kwe(t,e,r={}){let n=await Yve(Prt(t,e,r));if(n==null)throw(0,rB.default)(new Error(`Could not resolve ${t}`),"ERR_NOT_FOUND");return n}var qwe=xt(dk(),1),v0=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Irt=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,d){s=t[o](s),i(a,d,s.done,s.value)})}}function i(o,s,a,d){Promise.resolve(d).then(function(u){o({value:u,done:a})},s)}},q_=class{constructor(e={}){this.config=Object.assign({blockstoreLocation:"DATASTORE",createLevelDatabase:ld},e),this.blockstore=new I_({location:this.config.blockstoreLocation,createLevelDatabase:this.config.createLevelDatabase})}open(){return v0(this,void 0,void 0,function*(){yield this.blockstore.open()})}close(){return v0(this,void 0,void 0,function*(){yield this.blockstore.close()})}put(e,r,n,i){var o,s,a,d,u,c;return v0(this,void 0,void 0,function*(){let l=yield this.getBlockstoreForStoringData(e,r,n),h=oE([{content:i}],l,{cidVersion:1}),y;try{for(var g=!0,v=Irt(h),x;x=yield v.next(),o=x.done,!o;g=!0)d=x.value,g=!1,y=d}catch(S){s={error:S}}finally{try{!g&&!o&&(a=v.return)&&(yield a.call(v))}finally{if(s)throw s.error}}return{dataSize:Number((c=(u=y.unixfs)===null||u===void 0?void 0:u.fileSize())!==null&&c!==void 0?c:y.size)}})}get(e,r,n){return v0(this,void 0,void 0,function*(){let i=yield this.getBlockstoreForStoringData(e,r,n);if(!(yield i.has(n)))return;let s=yield Kwe(n,i),a=s.content(),d=new qwe.Readable({read(){return v0(this,void 0,void 0,function*(){let c=yield a.next();c.done?this.push(null):this.push(c.value)})}}),u=s.size;return(s.type==="file"||s.type==="directory")&&(u=s.unixfs.fileSize()),{dataSize:Number(u),dataStream:d}})}delete(e,r,n){return v0(this,void 0,void 0,function*(){yield(yield this.getBlockstoreForStoringData(e,r,n)).clear()})}clear(){return v0(this,void 0,void 0,function*(){yield this.blockstore.clear()})}getBlockstoreForStoringData(e,r,n){return v0(this,void 0,void 0,function*(){let i="data";return yield(yield(yield(yield this.blockstore.partition(i)).partition(e)).partition(r)).partition(n)})}};f();f();var wo=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},m3=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,d){s=t[o](s),i(a,d,s.done,s.value)})}}function i(o,s,a,d){Promise.resolve(d).then(function(u){o({value:u,done:a})},s)}},Ob=function(t){return this instanceof Ob?(this.v=t,this):new Ob(t)},Rrt=function(t,e,r){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var n=r.apply(t,e||[]),i,o=[];return i={},s("next"),s("throw"),s("return"),i[Symbol.asyncIterator]=function(){return this},i;function s(h){n[h]&&(i[h]=function(y){return new Promise(function(g,v){o.push([h,y,g,v])>1||a(h,y)})})}function a(h,y){try{d(n[h](y))}catch(g){l(o[0][3],g)}}function d(h){h.value instanceof Ob?Promise.resolve(h.value.v).then(u,c):l(o[0][2],h)}function u(h){a("next",h)}function c(h){a("throw",h)}function l(h,y){h(y),o.shift(),o.length&&a(o[0][0],o[0][1])}},Lwe="index",zp=class t{constructor(e){this.config=Object.assign({createLevelDatabase:ld},e),this.db=new h0({location:this.config.location,createLevelDatabase:this.config.createLevelDatabase,keyEncoding:"utf8"})}open(){return wo(this,void 0,void 0,function*(){yield this.db.open()})}close(){return wo(this,void 0,void 0,function*(){yield this.db.close()})}clear(){return wo(this,void 0,void 0,function*(){yield this.db.clear()})}put(e,r,n,i){return wo(this,void 0,void 0,function*(){if(M6(n))throw new de(se.IndexMissingIndexableProperty,"Index must include at least one valid indexable property");let o={messageCid:r,indexes:n},s=[];for(let c in n){let l=n[c];if(Array.isArray(l))for(let h of l){let y=this.createPutIndexedItemOperation(e,o,c,h);s.push(y)}else{let h=this.createPutIndexedItemOperation(e,o,c,l);s.push(h)}}let a=this.createOperationForIndexesLookupPartition(e,{type:"put",key:r,value:JSON.stringify(n)});s.push(a);let d=yield Promise.all(s);yield(yield this.db.partition(e)).batch(d,i)})}delete(e,r,n){return wo(this,void 0,void 0,function*(){let i=[],o=yield this.getIndexes(e,r);if(o===void 0)return;let s=this.createOperationForIndexesLookupPartition(e,{type:"del",key:r});i.push(s);for(let u in o){let c=o[u];if(Array.isArray(c))for(let l of c){let h=this.createDeleteIndexedItemOperation(e,r,u,l);i.push(h)}else{let l=this.createDeleteIndexedItemOperation(e,r,u,c);i.push(l)}}let a=yield Promise.all(i);yield(yield this.db.partition(e)).batch(a,n)})}createPutIndexedItemOperation(e,r,n,i){return wo(this,void 0,void 0,function*(){let{messageCid:o}=r,s=t.keySegmentJoin(t.encodeValue(i),o);return this.createOperationForIndexPartition(e,n,{type:"put",key:s,value:JSON.stringify(r)})})}createDeleteIndexedItemOperation(e,r,n,i){return wo(this,void 0,void 0,function*(){let o=t.keySegmentJoin(t.encodeValue(i),r);return this.createOperationForIndexPartition(e,n,{type:"del",key:o})})}createOperationForIndexPartition(e,r,n){return wo(this,void 0,void 0,function*(){let i=yield this.db.partition(e),o=t.getIndexPartitionName(r);return i.createPartitionOperation(o,n)})}createOperationForIndexesLookupPartition(e,r){return wo(this,void 0,void 0,function*(){return(yield this.db.partition(e)).createPartitionOperation(Lwe,r)})}static getIndexPartitionName(e){return`__${e}__`}getIndexPartition(e,r){return wo(this,void 0,void 0,function*(){let n=t.getIndexPartitionName(r);return(yield this.db.partition(e)).partition(n)})}getIndexesLookupPartition(e){return wo(this,void 0,void 0,function*(){return(yield this.db.partition(e)).partition(Lwe)})}query(e,r,n,i){return wo(this,void 0,void 0,function*(){return t.shouldQueryWithInMemoryPaging(r,n)?this.queryWithInMemoryPaging(e,r,n,i):this.queryWithIteratorPaging(e,r,n,i)})}queryWithIteratorPaging(e,r,n,i){var o,s,a,d;return wo(this,void 0,void 0,function*(){let{cursor:u,limit:c}=n,l=u?this.createStartingKeyFromCursor(u):"",h=[];try{for(var y=!0,g=m3(this.getIndexIterator(e,l,n,i)),v;v=yield g.next(),o=v.done,!o;y=!0){d=v.value,y=!1;let x=d;if(c!==void 0&&c===h.length)break;let{indexes:S}=x;ti.matchAnyFilter(S,r)&&h.push(x)}}catch(x){s={error:x}}finally{try{!y&&!o&&(a=g.return)&&(yield a.call(g))}finally{if(s)throw s.error}}return h})}getIndexIterator(e,r,n,i){return Rrt(this,arguments,function*(){var s,a,d,u;let{sortProperty:c,sortDirection:l=Is.Ascending,cursor:h}=n,y={gt:r};l===Is.Descending&&(y.reverse=!0,h!==void 0&&(y.lt=r,delete y.gt));let g=yield Ob(this.getIndexPartition(e,c));try{for(var v=!0,x=m3(g.iterator(y,i)),S;S=yield Ob(x.next()),s=S.done,!s;v=!0){u=S.value,v=!1;let[A,T]=u,{indexes:$,messageCid:j}=JSON.parse(T);yield yield Ob({indexes:$,messageCid:j})}}catch(A){a={error:A}}finally{try{!v&&!s&&(d=x.return)&&(yield Ob(d.call(x)))}finally{if(a)throw a.error}}})}createStartingKeyFromCursor(e){let{messageCid:r,value:n}=e;return t.keySegmentJoin(t.encodeValue(n),r)}static createCursorFromLastArrayItem(e,r){if(e.length>0)return this.createCursorFromItem(e.at(-1),r)}static createCursorFromItem(e,r){let{messageCid:n,indexes:i}=e,o=i[r];if(o===void 0)throw new de(se.IndexInvalidCursorSortProperty,`the sort property '${r}' is not defined within the given item.`);if(typeof o=="boolean"||Array.isArray(o))throw new de(se.IndexInvalidCursorValueType,`only string or number values are supported for cursors, a(n) ${typeof o} was given.`);return{messageCid:n,value:o}}queryWithInMemoryPaging(e,r,n,i){return wo(this,void 0,void 0,function*(){let{sortProperty:o,sortDirection:s=Is.Ascending,cursor:a,limit:d}=n,u=a?this.createStartingKeyFromCursor(a):void 0,c=new Map;r.length===0&&(r=[{}]);try{yield Promise.all(r.map(g=>this.executeSingleFilterQuery(e,g,o,c,i)))}catch(g){if(g.code===se.IndexInvalidSortPropertyInMemory)return[]}let l=[...c.values()].sort((g,v)=>this.sortItems(g,v,o,s)),h=u!==void 0?this.findCursorStartingIndex(l,s,o,u):0;if(h<0)return[];let y=d!==void 0?h+d:void 0;return l.slice(h,y)})}executeSingleFilterQuery(e,r,n,i,o){return wo(this,void 0,void 0,function*(){let s=[];if(M6(r)){let d=this.getAllItems(e,n);s.push(d)}let a=pk.reduceFilter(r);for(let d in a){let u=a[d];if(ti.isEqualFilter(u)){let c=this.filterExactMatches(e,d,u,o);s.push(c)}else if(ti.isOneOfFilter(u))for(let c of new Set(u)){let l=this.filterExactMatches(e,d,c,o);s.push(l)}else if(ti.isRangeFilter(u)){let c=this.filterRangeMatches(e,d,u,o);s.push(c)}}for(let d of s){let u=yield d;for(let c of u)if(!(i.has(c.messageCid)||!ti.matchFilter(c.indexes,r))){if(c.indexes[n]===void 0)throw new de(se.IndexInvalidSortPropertyInMemory,`invalid sort property ${n}`);i.set(c.messageCid,c)}}})}getAllItems(e,r){var n,i,o,s;return wo(this,void 0,void 0,function*(){let a=yield this.getIndexPartition(e,r),d=[];try{for(var u=!0,c=m3(a.iterator()),l;l=yield c.next(),n=l.done,!n;u=!0){s=l.value,u=!1;let[h,y]=s;d.push(JSON.parse(y))}}catch(h){i={error:h}}finally{try{!u&&!n&&(o=c.return)&&(yield o.call(c))}finally{if(i)throw i.error}}return d})}filterExactMatches(e,r,n,i){var o,s,a,d;return wo(this,void 0,void 0,function*(){let u=t.keySegmentJoin(t.encodeValue(n)),c={gt:u},l=yield this.getIndexPartition(e,r),h=[];try{for(var y=!0,g=m3(l.iterator(c,i)),v;v=yield g.next(),o=v.done,!o;y=!0){d=v.value,y=!1;let[x,S]=d;if(!x.startsWith(u))break;h.push(JSON.parse(S))}}catch(x){s={error:x}}finally{try{!y&&!o&&(a=g.return)&&(yield a.call(g))}finally{if(s)throw s.error}}return h})}filterRangeMatches(e,r,n,i){var o,s,a,d;return wo(this,void 0,void 0,function*(){let u={};for(let v in n){let x=v;u[x]=t.encodeValue(n[x])}u.gt===void 0&&u.gte===void 0&&(u.reverse=!0);let c=[],l=yield this.getIndexPartition(e,r);try{for(var h=!0,y=m3(l.iterator(u,i)),g;g=yield y.next(),o=g.done,!o;h=!0){d=g.value,h=!1;let[v,x]=d;"gt"in n&&this.extractIndexValueFromKey(v)===t.encodeValue(n.gt)||c.push(JSON.parse(x))}}catch(v){s={error:v}}finally{try{!h&&!o&&(a=y.return)&&(yield a.call(y))}finally{if(s)throw s.error}}if("lte"in n)for(let v of yield this.filterExactMatches(e,r,n.lte,i))c.push(v);return c})}sortItems(e,r,n,i){let o=e.indexes[n],s=r.indexes[n],a=t.encodeValue(o)+e.messageCid,d=t.encodeValue(s)+r.messageCid;return i===Is.Ascending?O6(a,d):O6(d,a)}findCursorStartingIndex(e,r,n,i){let o=s=>{let{messageCid:a,indexes:d}=s,u=d[n],c=t.keySegmentJoin(t.encodeValue(u),a);return r===Is.Ascending?c>i:c<i};return e.findIndex(o)}getIndexes(e,r){return wo(this,void 0,void 0,function*(){let i=yield(yield this.getIndexesLookupPartition(e)).get(r);if(i!==void 0)return JSON.parse(i)})}extractIndexValueFromKey(e){let[r]=e.split(t.delimiter);return r}static keySegmentJoin(...e){return e.join(t.delimiter)}static encodeNumberValue(e){let r=Number.MAX_SAFE_INTEGER,n="!",i=String(Number.MAX_SAFE_INTEGER).length,o=e<0?n:"",s=e<0?r:0;return o+String(e+s).padStart(i,"0")}static encodeValue(e){switch(typeof e){case"number":return this.encodeNumberValue(e);default:return JSON.stringify(e)}}static shouldQueryWithInMemoryPaging(e,r){for(let n of e)if(!t.isFilterConcise(n,r))return!1;return!0}static isFilterConcise(e,r){return e.recordId!==void 0?!0:r.cursor!==void 0?!1:e.protocolPath!==void 0||e.contextId!==void 0||e.parentId!==void 0||e.schema!==void 0}};zp.delimiter="\0";f();f();f();f();function g3(t){if(!L_(t))throw new Error("Parameter was not an error")}function L_(t){return Brt(t)==="[object Error]"||t instanceof Error}function Brt(t){return Object.prototype.toString.call(t)}f();function Fwe(t){let e,r="";if(t.length===0)e={};else if(L_(t[0]))e={cause:t[0]},r=t.slice(1).join(" ")||"";else if(t[0]&&typeof t[0]=="object")e=Object.assign({},t[0]),r=t.slice(1).join(" ")||"";else if(typeof t[0]=="string")e={},r=r=t.join(" ")||"";else throw new Error("Invalid arguments passed to Layerr");return{options:e,shortMessage:r}}var Tl=class t extends Error{constructor(e,r){let n=[...arguments],{options:i,shortMessage:o}=Fwe(n),s=o;if(i.cause&&(s=`${s}: ${i.cause.message}`),super(s),this.message=s,i.name&&typeof i.name=="string"?this.name=i.name:this.name="Layerr",i.cause&&Object.defineProperty(this,"_cause",{value:i.cause}),Object.defineProperty(this,"_info",{value:{}}),i.info&&typeof i.info=="object"&&Object.assign(this._info,i.info),Error.captureStackTrace){let a=i.constructorOpt||this.constructor;Error.captureStackTrace(this,a)}}static cause(e){return g3(e),e._cause&&L_(e._cause)?e._cause:null}static fullStack(e){g3(e);let r=t.cause(e);return r?`${e.stack}
caused by: ${t.fullStack(r)}`:e.stack}static info(e){g3(e);let r={},n=t.cause(e);return n&&Object.assign(r,t.info(n)),e._info&&Object.assign(r,e._info),r}cause(){return t.cause(this)}toString(){let e=this.name||this.constructor.name||this.constructor.prototype.name;return this.message&&(e=`${e}: ${this.message}`),e}};f();var v3="0123456789ABCDEFGHJKMNPQRSTVWXYZ",F_=32,zwe=0xffffffffffff,Vwe=10,Ort=16,Mb=Object.freeze({source:"ulid"});function Mrt(t){let e=t||Drt(),r=e&&(e.crypto||e.msCrypto)||null;if(typeof r?.getRandomValues=="function")return()=>{let n=new Uint8Array(1);return r.getRandomValues(n),n[0]/255};if(typeof r?.randomBytes=="function")return()=>r.randomBytes(1).readUInt8()/255;throw new Tl({info:{code:"PRNG_DETECT",...Mb}},"Failed to find a reliable PRNG")}function Drt(){return $rt()?self:typeof window<"u"?window:typeof globalThis<"u"||typeof globalThis<"u"?globalThis:null}function Crt(t,e){let r="";for(;t>0;t--)r=Nrt(e)+r;return r}function Hwe(t,e){if(isNaN(t))throw new Tl({info:{code:"ENC_TIME_NAN",...Mb}},`Time must be a number: ${t}`);if(t>zwe)throw new Tl({info:{code:"ENC_TIME_SIZE_EXCEED",...Mb}},`Cannot encode a time larger than ${zwe}: ${t}`);if(t<0)throw new Tl({info:{code:"ENC_TIME_NEG",...Mb}},`Time must be positive: ${t}`);if(Number.isInteger(t)===!1)throw new Tl({info:{code:"ENC_TIME_TYPE",...Mb}},`Time must be an integer: ${t}`);let r,n="";for(let i=e;i>0;i--)r=t%F_,n=v3.charAt(r)+n,t=(t-r)/F_;return n}function jrt(t){let e,r=t.length,n,i,o=t,s=F_-1;for(;!e&&r-->=0;){if(n=o[r],i=v3.indexOf(n),i===-1)throw new Tl({info:{code:"B32_INC_ENC",...Mb}},"Incorrectly encoded string");if(i===s){o=Wwe(o,r,v3[0]);continue}e=Wwe(o,r,v3[i+1])}if(typeof e=="string")return e;throw new Tl({info:{code:"B32_INC_INVALID",...Mb}},"Failed incrementing string")}function $rt(){return typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope}function nB(t){let e=t||Mrt(),r=0,n;return function(o){let s=isNaN(o)?Date.now():o;if(s<=r){let d=n=jrt(n);return Hwe(r,Vwe)+d}r=s;let a=n=Crt(Ort,e);return Hwe(s,Vwe)+a}}function Nrt(t){let e=Math.floor(t()*F_);return e===F_&&(e=F_-1),v3.charAt(e)}function Wwe(t,e,r){return e>t.length-1?t:t.substr(0,e)+r+t.substr(e+1)}var Db=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},z_=class{constructor(e){this.index=new zp(Object.assign({location:"EVENTLOG",createLevelDatabase:ld},e)),this.ulidFactory=nB()}open(){return Db(this,void 0,void 0,function*(){return this.index.open()})}close(){return Db(this,void 0,void 0,function*(){return this.index.close()})}clear(){return Db(this,void 0,void 0,function*(){return this.index.clear()})}append(e,r,n){return Db(this,void 0,void 0,function*(){let i=this.ulidFactory();yield this.index.put(e,r,Object.assign(Object.assign({},n),{watermark:i}))})}queryEvents(e,r,n){return Db(this,void 0,void 0,function*(){let i=yield this.index.query(e,r,{sortProperty:"watermark",cursor:n});return{events:i.map(({messageCid:o})=>o),cursor:zp.createCursorFromLastArrayItem(i,"watermark")}})}getEvents(e,r){return Db(this,void 0,void 0,function*(){return this.queryEvents(e,[],r)})}deleteEventsByCid(e,r){return Db(this,void 0,void 0,function*(){let n=[];for(let i of r)n.push(this.index.delete(e,i));yield Promise.all(n)})}};f();f();function iB({enumerable:t=!0,configurable:e=!1}={}){return{enumerable:t,configurable:e,writable:!1}}function*Urt(t,e){if(e!=null&&typeof e=="object")if(Array.isArray(e))for(let[r,n]of e.entries()){let i=[...t,r],o=Fr.asCID(n);o?yield[i.join("/"),o]:typeof n=="object"&&(yield*hz(n,i))}else{let r=Fr.asCID(e);r?yield[t.join("/"),r]:yield*hz(e,t)}}function*hz(t,e){if(t==null||t instanceof Uint8Array)return;let r=Fr.asCID(t);r&&(yield[e.join("/"),r]);for(let[n,i]of Object.entries(t)){let o=[...e,n];yield*Urt(o,i)}}function*Krt(t,e){if(Array.isArray(e))for(let[r,n]of e.entries()){let i=[...t,r];yield i.join("/"),typeof n=="object"&&!Fr.asCID(n)&&(yield*pz(n,i))}else yield*pz(e,t)}function*pz(t,e){if(!(t==null||typeof t!="object"))for(let[r,n]of Object.entries(t)){let i=[...e,r];yield i.join("/"),n!=null&&!(n instanceof Uint8Array)&&typeof n=="object"&&!Fr.asCID(n)&&(yield*Krt(i,n))}}function qrt(t,e){let r=t;for(let[n,i]of e.entries()){if(r=r[i],r==null)throw new Error(`Object has no property at ${e.slice(0,n+1).map(s=>`[${JSON.stringify(s)}]`).join("")}`);let o=Fr.asCID(r);if(o)return{value:o,remaining:e.slice(n+1).join("/")}}return{value:r}}var oB=class{constructor({cid:e,bytes:r,value:n}){if(!e||!r||typeof n>"u")throw new Error("Missing required argument");this.cid=e,this.bytes=r,this.value=n,this.asBlock=this,Object.defineProperties(this,{cid:iB(),bytes:iB(),value:iB(),asBlock:iB()})}links(){return hz(this.value,[])}tree(){return pz(this.value,[])}get(e="/"){return qrt(this.value,e.split("/").filter(Boolean))}};async function Gwe({value:t,codec:e,hasher:r}){if(typeof t>"u")throw new Error('Missing required argument "value"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");let n=e.encode(t),i=await r.digest(n),o=Fr.create(1,e.code,i);return new oB({value:t,bytes:n,cid:o})}async function Jwe({bytes:t,codec:e,hasher:r}){if(!t)throw new Error('Missing required argument "bytes"');if(!e||!r)throw new Error("Missing required argument: codec or hasher");let n=e.decode(t),i=await r.digest(t),o=Fr.create(1,e.code,i);return new oB({value:n,bytes:t,cid:o})}var Cb=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},V_=class t{constructor(e={}){this.config=Object.assign({blockstoreLocation:"MESSAGESTORE",indexLocation:"INDEX",createLevelDatabase:ld},e),this.blockstore=new I_({location:this.config.blockstoreLocation,createLevelDatabase:this.config.createLevelDatabase}),this.index=new zp({location:this.config.indexLocation,createLevelDatabase:this.config.createLevelDatabase})}open(){return Cb(this,void 0,void 0,function*(){yield this.blockstore.open(),yield this.index.open()})}close(){return Cb(this,void 0,void 0,function*(){yield this.blockstore.close(),yield this.index.close()})}get(e,r,n){var i;return Cb(this,void 0,void 0,function*(){(i=n?.signal)===null||i===void 0||i.throwIfAborted();let o=yield to(this.blockstore.partition(e),n?.signal),s=Fr.parse(r),a=yield o.get(s,n);return a?(yield to(Jwe({bytes:a,codec:fg,hasher:Vs}),n?.signal)).value:void 0})}query(e,r,n,i,o){var s;return Cb(this,void 0,void 0,function*(){(s=o?.signal)===null||s===void 0||s.throwIfAborted();let a=t.buildQueryOptions(n,i),d=yield this.index.query(e,r,a,o),u;i?.limit!==void 0&&i.limit<d.length&&(d.splice(-1),u=zp.createCursorFromLastArrayItem(d,a.sortProperty));let c=[];for(let l=0;l<d.length;l++){let{messageCid:h}=d[l],y=yield this.get(e,h,o);y&&c.push(y)}return{messages:c,cursor:u}})}static buildQueryOptions(e={},r={}){let{limit:n,cursor:i}=r,{dateCreated:o,datePublished:s,messageTimestamp:a}=e,d=Is.Ascending,u="messageTimestamp";return o!==void 0?u="dateCreated":s!==void 0?u="datePublished":a!==void 0&&(u="messageTimestamp"),e[u]!==void 0&&(d=e[u]),n!==void 0&&n>0&&(n=n+1),{sortDirection:d,sortProperty:u,limit:n,cursor:i}}delete(e,r,n){var i;return Cb(this,void 0,void 0,function*(){(i=n?.signal)===null||i===void 0||i.throwIfAborted();let o=yield to(this.blockstore.partition(e),n?.signal),s=Fr.parse(r);yield o.delete(s,n),yield this.index.delete(e,r,n)})}put(e,r,n,i){var o;return Cb(this,void 0,void 0,function*(){(o=i?.signal)===null||o===void 0||o.throwIfAborted();let s=yield to(this.blockstore.partition(e),i?.signal),a=yield to(Gwe({value:r,codec:fg,hasher:Vs}),i?.signal),d=vn.parseCid(yield _e.getCid(r));yield s.put(d,a.bytes,i);let u=d.toString();yield this.index.put(e,u,n,i)})}clear(){return Cb(this,void 0,void 0,function*(){yield this.blockstore.clear(),yield this.index.clear()})}};f();var b0=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Frt=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,d){s=t[o](s),i(a,d,s.done,s.value)})}}function i(o,s,a,d){Promise.resolve(d).then(function(u){o({value:u,done:a})},s)}},jb=class t{constructor(e){this.config=Object.assign({location:"RESUMABLE-TASK-STORE",createLevelDatabase:ld},e),this.db=new h0({location:this.config.location,createLevelDatabase:this.config.createLevelDatabase,keyEncoding:"utf8"})}open(){return b0(this,void 0,void 0,function*(){yield this.db.open()})}close(){return b0(this,void 0,void 0,function*(){yield this.db.close()})}register(e,r){return b0(this,void 0,void 0,function*(){let n=yield vn.computeCid(e),i={id:n,timeout:Date.now()+r*1e3,retryCount:0,task:e};return yield this.db.put(n,JSON.stringify(i)),i})}grab(e){var r,n,i,o;return b0(this,void 0,void 0,function*(){let s=[];try{for(var a=!0,d=Frt(this.db.iterator()),u;u=yield d.next(),r=u.done,!r;a=!0){o=u.value,a=!1;let[c,l]=o,h=JSON.parse(l);if(Date.now()>=h.timeout&&(h.timeout=Date.now()+t.taskTimeoutInSeconds*1e3,h.retryCount++,yield this.db.put(h.id,JSON.stringify(h)),s.push(h)),s.length>=e)break}}catch(c){n={error:c}}finally{try{!a&&!r&&(i=d.return)&&(yield i.call(d))}finally{if(n)throw n.error}}return s})}read(e){return b0(this,void 0,void 0,function*(){let r=yield this.db.get(e);if(r)return JSON.parse(r)})}extend(e,r){return b0(this,void 0,void 0,function*(){let n=yield this.db.get(e);if(n){let i=JSON.parse(n);i.timeout=Date.now()+r*1e3,yield this.db.put(i.id,JSON.stringify(i))}})}delete(e){return b0(this,void 0,void 0,function*(){return this.db.delete(e)})}clear(){return b0(this,void 0,void 0,function*(){yield this.db.clear()})}};jb.taskTimeoutInSeconds=60;f();var zrt=xt(Ba(),1);f();f();var Vrt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},b3=class t{static pollUntilSuccessOrTimeout(e,r=t.pollRetrySleep,n=t.pollTimeout){return Vrt(this,void 0,void 0,function*(){let i=Date.now();for(;;)try{return yield e()}catch{if(Date.now()-i>=n)throw new Error("Operation timed out");yield mr.sleep(r)}})}};b3.pollRetrySleep=20;b3.pollTimeout=2e3;var Ct;(function(t){t.MessagesQuery="MessagesQuery",t.MessagesRead="MessagesRead",t.MessagesSubscribe="MessagesSubscribe",t.ProtocolsConfigure="ProtocolsConfigure",t.ProtocolsQuery="ProtocolsQuery",t.RecordsDelete="RecordsDelete",t.RecordsQuery="RecordsQuery",t.RecordsRead="RecordsRead",t.RecordsSubscribe="RecordsSubscribe",t.RecordsWrite="RecordsWrite"})(Ct||(Ct={}));var yz={[Ct.MessagesQuery]:Tm,[Ct.MessagesRead]:Am,[Ct.MessagesSubscribe]:km,[Ct.ProtocolsConfigure]:jm,[Ct.ProtocolsQuery]:$m,[Ct.RecordsDelete]:If,[Ct.RecordsQuery]:xm,[Ct.RecordsRead]:Lv,[Ct.RecordsSubscribe]:Nm,[Ct.RecordsWrite]:Vr};f();f();f();var $b;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})($b||($b={}));f();var mi={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};f();var cr=class t{constructor({method:e,id:r,path:n,query:i,fragment:o,params:s}){this.uri=`did:${e}:${r}`,this.method=e,this.id=r,this.path=n,this.query=i,this.fragment=o,this.params=s}static parse(e){if(!e)return null;let r=t.DID_URI_PATTERN.exec(e);if(!r||!r.groups)return null;let{method:n,id:i,path:o,query:s,fragment:a}=r.groups,d={uri:`did:${n}:${i}`,method:n,id:i};if(o&&(d.path=o),s&&(d.query=s.slice(1)),a&&(d.fragment=a.slice(1)),s){let u={},c=s.slice(1).split("&");for(let l of c){let[h,y]=l.split("=");u[h]=y}d.params=u}return d}};cr.METHOD_PATTERN="([a-z0-9]+)";cr.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";cr.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${cr.PCT_ENCODED_PATTERN})`;cr.METHOD_ID_PATTERN=`((?:${cr.ID_CHAR_PATTERN}*:)*(${cr.ID_CHAR_PATTERN}+))`;cr.PATH_PATTERN="(/[^#?]*)?";cr.QUERY_PATTERN="([?][^#]*)?";cr.FRAGMENT_PATTERN="(#.*)?";cr.DID_URI_PATTERN=new RegExp(`^did:(?<method>${cr.METHOD_PATTERN}):(?<id>${cr.METHOD_ID_PATTERN})(?<path>${cr.PATH_PATTERN})(?<query>${cr.QUERY_PATTERN})(?<fragment>${cr.FRAGMENT_PATTERN})$`);f();var ut=class t extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t)}},rt;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(rt||(rt={}));f();f();f();f();f();var Wrt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},w0=class{static digest(e){return Wrt(this,arguments,void 0,function*({data:r}){return To(r)})}};f();var gi=class{};var Grt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},_0=class extends gi{digest(e){return Grt(this,arguments,void 0,function*({algorithm:r,data:n}){switch(r){case"SHA-256":return yield w0.digest({data:n})}})}};f();f();f();f();function Ywe(t){let e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){let i=Object.keys(n).sort(),o={};for(let s of i)o[s]=e(n[s]);return o}return n},r=e(t);return JSON.stringify(r)}var Jrt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Nb="urn:jwk:";function vt(t){return Jrt(this,arguments,void 0,function*({jwk:e}){let r=e.kty,n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);JS(n);let i=Ywe(n),o=Se.string(i).toUint8Array(),s=yield w0.digest({data:o});return Se.uint8Array(s).toBase64Url()})}function Sc(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function x0(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function Ub(t){return!(!t||typeof t!="object"||!("kty"in t&&"k"in t)||t.kty!=="oct"||typeof t.k!="string")}function Tc(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function E0(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function H_(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var js=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Yrt=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Pn=class t{static adjustSignatureToLowS(e){return js(this,arguments,void 0,function*({signature:r}){let n=br.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return js(this,arguments,void 0,function*({privateKeyBytes:r}){let n=yield t.getCurvePoint({keyBytes:r}),i={kty:"EC",crv:"secp256k1",d:Se.uint8Array(r).toBase64Url(),x:Se.uint8Array(n.x).toBase64Url(),y:Se.uint8Array(n.y).toBase64Url()};return i.kid=yield vt({jwk:i}),i})}static bytesToPublicKey(e){return js(this,arguments,void 0,function*({publicKeyBytes:r}){let n=yield t.getCurvePoint({keyBytes:r}),i={kty:"EC",crv:"secp256k1",x:Se.uint8Array(n.x).toBase64Url(),y:Se.uint8Array(n.y).toBase64Url()};return i.kid=yield vt({jwk:i}),i})}static compressPublicKey(e){return js(this,arguments,void 0,function*({publicKeyBytes:r}){return br.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return js(this,arguments,void 0,function*({key:r}){let n=yield t.privateKeyToBytes({privateKey:r}),i=yield t.getCurvePoint({keyBytes:n}),o={kty:"EC",crv:"secp256k1",x:Se.uint8Array(i.x).toBase64Url(),y:Se.uint8Array(i.y).toBase64Url()};return o.kid=yield vt({jwk:o}),o})}static convertDerToCompactSignature(e){return js(this,arguments,void 0,function*({derSignature:r}){return br.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return js(this,arguments,void 0,function*({publicKeyBytes:r}){return br.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return js(this,void 0,void 0,function*(){let e=br.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield vt({jwk:r}),r})}static getPublicKey(e){return js(this,arguments,void 0,function*({key:r}){var n;if(!(Sc(r)&&r.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let{d:i}=r,o=Yrt(r,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield vt({jwk:o})),o})}static privateKeyToBytes(e){return js(this,arguments,void 0,function*({privateKey:r}){if(!Sc(r))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return Se.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return js(this,arguments,void 0,function*({publicKey:r}){if(!(x0(r)&&r.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");let n=new Uint8Array([4]),i=Se.base64Url(r.x).toUint8Array(),o=Se.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...i,...o])})}static sharedSecret(e){return js(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let i=yield t.privateKeyToBytes({privateKey:r}),o=yield t.publicKeyToBytes({publicKey:n});return br.getSharedSecret(i,o,!0).slice(1)})}static sign(e){return js(this,arguments,void 0,function*({data:r,key:n}){let i=yield t.privateKeyToBytes({privateKey:n}),o=To(r);return br.sign(o,i).toCompactRawBytes()})}static validatePrivateKey(e){return js(this,arguments,void 0,function*({privateKeyBytes:r}){return br.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return js(this,arguments,void 0,function*({publicKeyBytes:r}){try{br.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return js(this,arguments,void 0,function*({key:r,signature:n,data:i}){let o=yield t.publicKeyToBytes({publicKey:r}),s=To(i);return br.verify(n,s,o,{lowS:!1})})}static getCurvePoint(e){return js(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=br.getPublicKey(r));let n=br.ProjectivePoint.fromHex(r),i=Fn(n.x,32),o=Fn(n.y,32);return{x:i,y:o}})}};f();var $s=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Zrt=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},$n=class t{static adjustSignatureToLowS(e){return $s(this,arguments,void 0,function*({signature:r}){let n=kr.Signature.fromCompact(r);return n.hasHighS()?n.normalizeS().toCompactRawBytes():r})}static bytesToPrivateKey(e){return $s(this,arguments,void 0,function*({privateKeyBytes:r}){let n=yield t.getCurvePoint({keyBytes:r}),i={kty:"EC",crv:"P-256",d:Se.uint8Array(r).toBase64Url(),x:Se.uint8Array(n.x).toBase64Url(),y:Se.uint8Array(n.y).toBase64Url()};return i.kid=yield vt({jwk:i}),i})}static bytesToPublicKey(e){return $s(this,arguments,void 0,function*({publicKeyBytes:r}){let n=yield t.getCurvePoint({keyBytes:r}),i={kty:"EC",crv:"P-256",x:Se.uint8Array(n.x).toBase64Url(),y:Se.uint8Array(n.y).toBase64Url()};return i.kid=yield vt({jwk:i}),i})}static compressPublicKey(e){return $s(this,arguments,void 0,function*({publicKeyBytes:r}){return kr.ProjectivePoint.fromHex(r).toRawBytes(!0)})}static computePublicKey(e){return $s(this,arguments,void 0,function*({key:r}){let n=yield t.privateKeyToBytes({privateKey:r}),i=yield t.getCurvePoint({keyBytes:n}),o={kty:"EC",crv:"P-256",x:Se.uint8Array(i.x).toBase64Url(),y:Se.uint8Array(i.y).toBase64Url()};return o.kid=yield vt({jwk:o}),o})}static convertDerToCompactSignature(e){return $s(this,arguments,void 0,function*({derSignature:r}){return kr.Signature.fromDER(r).toCompactRawBytes()})}static decompressPublicKey(e){return $s(this,arguments,void 0,function*({publicKeyBytes:r}){return kr.ProjectivePoint.fromHex(r).toRawBytes(!1)})}static generateKey(){return $s(this,void 0,void 0,function*(){let e=kr.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield vt({jwk:r}),r})}static getPublicKey(e){return $s(this,arguments,void 0,function*({key:r}){var n;if(!(Sc(r)&&r.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let{d:i}=r,o=Zrt(r,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield vt({jwk:o})),o})}static privateKeyToBytes(e){return $s(this,arguments,void 0,function*({privateKey:r}){if(!Sc(r))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return Se.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return $s(this,arguments,void 0,function*({publicKey:r}){if(!(x0(r)&&r.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");let n=new Uint8Array([4]),i=Se.base64Url(r.x).toUint8Array(),o=Se.base64Url(r.y).toUint8Array();return new Uint8Array([...n,...i,...o])})}static sharedSecret(e){return $s(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let i=yield t.privateKeyToBytes({privateKey:r}),o=yield t.publicKeyToBytes({publicKey:n});return kr.getSharedSecret(i,o,!0).slice(1)})}static sign(e){return $s(this,arguments,void 0,function*({data:r,key:n}){let i=yield t.privateKeyToBytes({privateKey:n}),o=To(r);return kr.sign(o,i).toCompactRawBytes()})}static validatePrivateKey(e){return $s(this,arguments,void 0,function*({privateKeyBytes:r}){return kr.utils.isValidPrivateKey(r)})}static validatePublicKey(e){return $s(this,arguments,void 0,function*({publicKeyBytes:r}){try{kr.ProjectivePoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return $s(this,arguments,void 0,function*({key:r,signature:n,data:i}){let o=yield t.publicKeyToBytes({publicKey:r}),s=To(i);return kr.verify(n,s,o,{lowS:!1})})}static getCurvePoint(e){return $s(this,arguments,void 0,function*({keyBytes:r}){r.byteLength===32&&(r=kr.getPublicKey(r));let n=kr.ProjectivePoint.fromHex(r),i=Fn(n.x,32),o=Fn(n.y,32);return{x:i,y:o}})}};var w3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},S0=class extends gi{computePublicKey(e){return w3(this,arguments,void 0,function*({key:r}){if(!Sc(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{let n=yield Pn.computePublicKey({key:r});return n.alg="ES256K",n}case"P-256":{let n=yield $n.computePublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return w3(this,arguments,void 0,function*({algorithm:r}){switch(r){case"ES256K":case"secp256k1":{let n=yield Pn.generateKey();return n.alg="ES256K",n}case"ES256":case"secp256r1":{let n=yield $n.generateKey();return n.alg="ES256",n}}})}getPublicKey(e){return w3(this,arguments,void 0,function*({key:r}){if(!Sc(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":{let n=yield Pn.getPublicKey({key:r});return n.alg="ES256K",n}case"P-256":{let n=yield $n.getPublicKey({key:r});return n.alg="ES256",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return w3(this,arguments,void 0,function*({key:r,data:n}){if(!Sc(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(r.crv){case"secp256k1":return yield Pn.sign({key:r,data:n});case"P-256":return yield $n.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return w3(this,arguments,void 0,function*({key:r,signature:n,data:i}){if(!x0(r))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(r.crv){case"secp256k1":return yield Pn.verify({key:r,signature:n,data:i});case"P-256":return yield $n.verify({key:r,signature:n,data:i});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};f();f();var mu=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Xrt=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},en=class t{static bytesToPrivateKey(e){return mu(this,arguments,void 0,function*({privateKeyBytes:r}){let n=zn.getPublicKey(r),i={crv:"Ed25519",d:Se.uint8Array(r).toBase64Url(),kty:"OKP",x:Se.uint8Array(n).toBase64Url()};return i.kid=yield vt({jwk:i}),i})}static bytesToPublicKey(e){return mu(this,arguments,void 0,function*({publicKeyBytes:r}){let n={kty:"OKP",crv:"Ed25519",x:Se.uint8Array(r).toBase64Url()};return n.kid=yield vt({jwk:n}),n})}static computePublicKey(e){return mu(this,arguments,void 0,function*({key:r}){let n=yield t.privateKeyToBytes({privateKey:r}),i=zn.getPublicKey(n),o={kty:"OKP",crv:"Ed25519",x:Se.uint8Array(i).toBase64Url()};return o.kid=yield vt({jwk:o}),o})}static convertPrivateKeyToX25519(e){return mu(this,arguments,void 0,function*({privateKey:r}){let n=yield t.privateKeyToBytes({privateKey:r}),i=f_(n),o=Li.getPublicKey(i),s={kty:"OKP",crv:"X25519",d:Se.uint8Array(i).toBase64Url(),x:Se.uint8Array(o).toBase64Url()};return s.kid=yield vt({jwk:s}),s})}static convertPublicKeyToX25519(e){return mu(this,arguments,void 0,function*({publicKey:r}){let n=yield t.publicKeyToBytes({publicKey:r});if(!(yield t.validatePublicKey({publicKeyBytes:n})))throw new Error("Ed25519: Invalid public key.");let o=l_(n),s={kty:"OKP",crv:"X25519",x:Se.uint8Array(o).toBase64Url()};return s.kid=yield vt({jwk:s}),s})}static generateKey(){return mu(this,void 0,void 0,function*(){let e=zn.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield vt({jwk:r}),r})}static getPublicKey(e){return mu(this,arguments,void 0,function*({key:r}){var n;if(!(Tc(r)&&r.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let{d:i}=r,o=Xrt(r,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield vt({jwk:o})),o})}static privateKeyToBytes(e){return mu(this,arguments,void 0,function*({privateKey:r}){if(!Tc(r))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return Se.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return mu(this,arguments,void 0,function*({publicKey:r}){if(!E0(r))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return Se.base64Url(r.x).toUint8Array()})}static sign(e){return mu(this,arguments,void 0,function*({key:r,data:n}){let i=yield t.privateKeyToBytes({privateKey:r});return zn.sign(n,i)})}static validatePublicKey(e){return mu(this,arguments,void 0,function*({publicKeyBytes:r}){try{zn.ExtendedPoint.fromHex(r).assertValidity()}catch{return!1}return!0})}static verify(e){return mu(this,arguments,void 0,function*({key:r,signature:n,data:i}){let o=yield t.publicKeyToBytes({publicKey:r});return zn.verify(n,i,o)})}};var _3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Kb=class extends gi{computePublicKey(e){return _3(this,arguments,void 0,function*({key:r}){if(!Tc(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{let n=yield en.computePublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}generateKey(e){return _3(this,arguments,void 0,function*({algorithm:r}){switch(r){case"Ed25519":{let n=yield en.generateKey();return n.alg="EdDSA",n}}})}getPublicKey(e){return _3(this,arguments,void 0,function*({key:r}){if(!Tc(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":{let n=yield en.getPublicKey({key:r});return n.alg="EdDSA",n}default:throw new Error(`Unsupported curve: ${r.crv}`)}})}sign(e){return _3(this,arguments,void 0,function*({key:r,data:n}){if(!Tc(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(r.crv){case"Ed25519":return yield en.sign({key:r,data:n});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}verify(e){return _3(this,arguments,void 0,function*({key:r,signature:n,data:i}){if(!E0(r))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(r.crv){case"Ed25519":return yield en.verify({key:r,signature:n,data:i});default:throw new Error(`Unsupported curve: ${r.crv}`)}})}};var Vp=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},mz={Ed25519:{implementation:Kb,names:["Ed25519"]},secp256k1:{implementation:S0,names:["ES256K","secp256k1"]},secp256r1:{implementation:S0,names:["ES256","secp256r1"]},"SHA-256":{implementation:_0,names:["SHA-256"]}},oi=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e?.keyStore)!==null&&r!==void 0?r:new G2}digest(e){return Vp(this,arguments,void 0,function*({algorithm:r,data:n}){return yield this.getAlgorithm({algorithm:r}).digest({algorithm:r,data:n})})}exportKey(e){return Vp(this,arguments,void 0,function*({keyUri:r}){return yield this.getPrivateKey({keyUri:r})})}generateKey(e){return Vp(this,arguments,void 0,function*({algorithm:r}){let i=yield this.getAlgorithm({algorithm:r}).generateKey({algorithm:r});if(i?.kid===void 0)throw new Error("Generated key is missing a required property: kid");let o=`${Nb}${i.kid}`;return yield this._keyStore.set(o,i),o})}getKeyUri(e){return Vp(this,arguments,void 0,function*({key:r}){let n=yield vt({jwk:r});return`${Nb}${n}`})}getPublicKey(e){return Vp(this,arguments,void 0,function*({keyUri:r}){let n=yield this.getPrivateKey({keyUri:r}),i=this.getAlgorithmName({key:n});return yield this.getAlgorithm({algorithm:i}).getPublicKey({key:n})})}importKey(e){return Vp(this,arguments,void 0,function*({key:r}){var n;if(!H_(r))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");let i=structuredClone(r);(n=i.kid)!==null&&n!==void 0||(i.kid=yield vt({jwk:i}));let o=yield this.getKeyUri({key:i});return yield this._keyStore.set(o,i),o})}sign(e){return Vp(this,arguments,void 0,function*({keyUri:r,data:n}){let i=yield this.getPrivateKey({keyUri:r}),o=this.getAlgorithmName({key:i});return this.getAlgorithm({algorithm:o}).sign({data:n,key:i})})}verify(e){return Vp(this,arguments,void 0,function*({key:r,signature:n,data:i}){let o=this.getAlgorithmName({key:r});return this.getAlgorithm({algorithm:o}).verify({key:r,signature:n,data:i})})}getAlgorithm({algorithm:e}){var r;let n=(r=mz[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){let r=e.alg,n=e.crv;for(let i in mz){let o=mz[i];if(r&&o.names.includes(r))return i;if(n&&o.names.includes(n))return i}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey(e){return Vp(this,arguments,void 0,function*({keyUri:r}){let n=yield this._keyStore.get(r);if(!n)throw new Error(`Key not found: ${r}`);return n})}};f();function Qrt(t){let e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(t.alg&&Object.values(e).includes(t.alg))return t.alg;if(t.crv&&Object.keys(e).includes(t.crv))return e[t.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${t.alg}, crv=${t.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}function gz(t){return pw(t)}function ent(){return ly.randomUUID()}function tnt({length:t}){if(3>t||t>10)throw new Error("randomPin() can securely generate a PIN between 3 to 10 digits.");let e=Math.pow(10,t)-1,r;if(t<=6){let n=Math.pow(10,t);do{let i=gz(Math.ceil(t/2));r=new DataView(i.buffer).getUint16(0,!1)%n}while(r>e)}else{let n=Math.pow(10,10);do{let i=gz(4);r=new DataView(i.buffer).getUint32(0,!1)%n}while(r>e)}return r.toString().padStart(t,"0")}var ro={randomPin:tnt,randomUuid:ent,randomBytes:gz,getJoseSignatureAlgorithmFromPublicKey:Qrt};f();f();f();f();var x3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},rnt=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},sB=96,Zwe=[128,192,256],aB=[96,104,112,120,128],gu=class{static bytesToPrivateKey(e){return x3(this,arguments,void 0,function*({privateKeyBytes:r}){let n={k:Se.uint8Array(r).toBase64Url(),kty:"oct"};return n.kid=yield vt({jwk:n}),n})}static decrypt(e){return x3(this,arguments,void 0,function*({key:r,data:n,iv:i,additionalData:o,tagLength:s}){if(i.byteLength!==sB/8)throw new TypeError(`The initialization vector must be ${sB} bits in length`);if(s&&!aB.includes(s))throw new RangeError(`The tag length is invalid: Must be ${aB.join(", ")} bits`);let a=hs(),d=yield a.importKey("jwk",r,{name:"AES-GCM"},!0,["decrypt"]),u=Object.assign(Object.assign({name:"AES-GCM",iv:i},s&&{tagLength:s}),o&&{additionalData:o}),c=yield a.decrypt(u,d,n);return new Uint8Array(c)})}static encrypt(e){return x3(this,arguments,void 0,function*({data:r,iv:n,key:i,additionalData:o,tagLength:s}){if(n.byteLength!==sB/8)throw new TypeError(`The initialization vector must be ${sB} bits in length`);if(s&&!aB.includes(s))throw new RangeError(`The tag length is invalid: Must be ${aB.join(", ")} bits`);let a=hs(),d=yield a.importKey("jwk",i,{name:"AES-GCM"},!0,["encrypt"]),u=Object.assign(Object.assign({name:"AES-GCM",iv:n},s&&{tagLength:s}),o&&{additionalData:o}),c=yield a.encrypt(u,d,r);return new Uint8Array(c)})}static generateKey(e){return x3(this,arguments,void 0,function*({length:r}){if(!Zwe.includes(r))throw new RangeError(`The key length is invalid: Must be ${Zwe.join(", ")} bits`);let n=hs(),i=yield n.generateKey({name:"AES-GCM",length:r},!0,["encrypt"]),o=yield n.exportKey("jwk",i),{ext:s,key_ops:a}=o,d=rnt(o,["ext","key_ops"]);return d.kid=yield vt({jwk:d}),d})}static privateKeyToBytes(e){return x3(this,arguments,void 0,function*({privateKey:r}){if(!Ub(r))throw new Error("AesGcm: The provided key is not a valid oct private key.");return Se.base64Url(r.k).toUint8Array()})}};var vz=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},cB=class extends gi{decrypt(e){return vz(this,void 0,void 0,function*(){return gu.decrypt(e)})}encrypt(e){return vz(this,void 0,void 0,function*(){return gu.encrypt(e)})}generateKey(e){return vz(this,arguments,void 0,function*({algorithm:r}){let n={A128GCM:128,A192GCM:192,A256GCM:256}[r],i=yield gu.generateKey({length:n});return i.alg=r,i})}};f();f();f();f();f();f();var T0=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},nnt=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},qb=class t{static bytesToPrivateKey(e){return T0(this,arguments,void 0,function*({privateKeyBytes:r}){let n=Li.getPublicKey(r),i={kty:"OKP",crv:"X25519",d:Se.uint8Array(r).toBase64Url(),x:Se.uint8Array(n).toBase64Url()};return i.kid=yield vt({jwk:i}),i})}static bytesToPublicKey(e){return T0(this,arguments,void 0,function*({publicKeyBytes:r}){let n={kty:"OKP",crv:"X25519",x:Se.uint8Array(r).toBase64Url()};return n.kid=yield vt({jwk:n}),n})}static computePublicKey(e){return T0(this,arguments,void 0,function*({key:r}){let n=yield t.privateKeyToBytes({privateKey:r}),i=Li.getPublicKey(n),o={kty:"OKP",crv:"X25519",x:Se.uint8Array(i).toBase64Url()};return o.kid=yield vt({jwk:o}),o})}static generateKey(){return T0(this,void 0,void 0,function*(){let e=Li.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield vt({jwk:r}),r})}static getPublicKey(e){return T0(this,arguments,void 0,function*({key:r}){var n;if(!(Tc(r)&&r.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let{d:i}=r,o=nnt(r,["d"]);return(n=o.kid)!==null&&n!==void 0||(o.kid=yield vt({jwk:o})),o})}static privateKeyToBytes(e){return T0(this,arguments,void 0,function*({privateKey:r}){if(!Tc(r))throw new Error("X25519: The provided key is not a valid OKP private key.");return Se.base64Url(r.d).toUint8Array()})}static publicKeyToBytes(e){return T0(this,arguments,void 0,function*({publicKey:r}){if(!E0(r))throw new Error("X25519: The provided key is not a valid OKP public key.");return Se.base64Url(r.x).toUint8Array()})}static sharedSecret(e){return T0(this,arguments,void 0,function*({privateKeyA:r,publicKeyB:n}){if("x"in r&&"x"in n&&r.x===n.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let i=yield t.privateKeyToBytes({privateKey:r}),o=yield t.publicKeyToBytes({publicKey:n});return Li.getSharedSecret(i,o)})}};f();f();var fB={};Or(fB,{extractDidFragment:()=>Ac,getServices:()=>ont,getVerificationMethodByKey:()=>snt,getVerificationMethodTypes:()=>bz,getVerificationMethods:()=>E3,getVerificationRelationshipsById:()=>wz,isDidService:()=>Xwe,isDidVerificationMethod:()=>dB,isDwnDidService:()=>ant,keyBytesToMultibaseId:()=>uB,multibaseIdToKeyBytes:()=>lB});f();var int=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};function Ac(t){if(typeof t=="string"&&t.length!==0)return t.split("#").pop()}function ont({didDocument:t,id:e,type:r}){var n,i;return(i=(n=t?.service)===null||n===void 0?void 0:n.filter(o=>!(e&&o.id!==e||r&&o.type!==r)))!==null&&i!==void 0?i:[]}function snt(t){return int(this,arguments,void 0,function*({didDocument:e,publicKeyJwk:r,publicKeyMultibase:n}){let i=E3({didDocument:e});for(let o of i)if(r&&o.publicKeyJwk){if((yield vt({jwk:r}))===(yield vt({jwk:o.publicKeyJwk})))return o}else if(n&&o.publicKeyMultibase&&n===o.publicKeyMultibase)return o;return null})}function E3({didDocument:t}){var e,r;if(!t)throw new TypeError("Required parameter missing: 'didDocument'");let n=[];return n.push(...(r=(e=t.verificationMethod)===null||e===void 0?void 0:e.filter(dB))!==null&&r!==void 0?r:[]),Object.keys($b).forEach(i=>{var o,s;n.push(...(s=(o=t[i])===null||o===void 0?void 0:o.filter(dB))!==null&&s!==void 0?s:[])}),n}function bz({didDocument:t}){let r=E3({didDocument:t}).map(n=>n.type);return[...new Set(r)]}function wz({didDocument:t,methodId:e}){let r=[];return Object.keys($b).forEach(n=>{if(Array.isArray(t[n])){let i=t[n],o=Ac(e);i.some(a=>{let d=Ac(a)===o,u=dB(a)&&Ac(a.id)===o;return d||u})&&r.push(n)}}),r}function Xwe(t){return!t||typeof t!="object"||t===null?!1:"id"in t&&"type"in t&&"serviceEndpoint"in t}function ant(t){if(!Xwe(t)||t.type!=="DecentralizedWebNode"||!("enc"in t&&"sig"in t))return!1;let e=r=>typeof r=="string"||Array.isArray(r)&&r.every(n=>typeof n=="string");return e(t.enc)&&e(t.sig)}function dB(t){return!(!t||typeof t!="object"||t===null||!("id"in t&&"type"in t&&"controller"in t)||typeof t.id!="string"||typeof t.type!="string"||typeof t.controller!="string")}function uB({keyBytes:t,multicodecCode:e,multicodecName:r}){let n=An.addPrefix({code:e,data:t,name:r}),i=le.uint8Array(n).toBase58Btc();return le.base58Btc(i).toMultibase()}function lB({multibaseKeyId:t}){try{let e=le.multibase(t).toBase58Btc(),r=le.base58Btc(e).toUint8Array(),{code:n,data:i,name:o}=An.removePrefix({prefixedData:r});return{keyBytes:i,multicodecCode:n,multicodecName:o}}catch{throw new ut(rt.InvalidDid,`Invalid multibase identifier: ${t}`)}}var S3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},_o=class t{constructor({uri:e,document:r,metadata:n,keyManager:i}){this.uri=e,this.document=r,this.metadata=n,this.keyManager=i}export(){return S3(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){let r=[];for(let n of this.document.verificationMethod){if(!n.publicKeyJwk)throw new Error(`Verification method '${n.id}' does not contain a public key in JWK format`);let i=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),o=yield this.keyManager.exportKey({keyUri:i});r.push(Object.assign({},o))}e.privateKeys=r}return e})}getSigner(e){return S3(this,void 0,void 0,function*(){var r;let n=(r=this.document.verificationMethod)===null||r===void 0?void 0:r.find(d=>{var u,c;return Ac(d.id)===((u=Ac(e?.methodId))!==null&&u!==void 0?u:Ac((c=this.document.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(n&&n.publicKeyJwk))throw new ut(rt.InternalError,"A verification method intended for signing could not be determined from the DID Document");let i=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),o=yield this.keyManager.getPublicKey({keyUri:i}),s=this.keyManager;return{algorithm:ro.getJoseSignatureAlgorithmFromPublicKey(o),keyId:n.id,sign(d){return S3(this,arguments,void 0,function*({data:u}){return yield s.sign({data:u,keyUri:i})})},verify(d){return S3(this,arguments,void 0,function*({data:u,signature:c}){return yield s.verify({data:u,key:o,signature:c})})}}})}static import(e){return S3(this,arguments,void 0,function*({portableDid:r,keyManager:n=new oi}){var i;let o=E3({didDocument:r.document});if(o.length===0)throw new ut(rt.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(i=r.privateKeys)!==null&&i!==void 0?i:[])yield n.importKey({key:a});for(let a of o){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);let d=yield n.getKeyUri({key:a.publicKeyJwk});yield n.getPublicKey({keyUri:d})}return new t({uri:r.uri,document:r.document,metadata:r.metadata,keyManager:n})})}};f();f();var Qwe=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},vu=class{static getSigningMethod(e){return Qwe(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,r){return Qwe(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}};var Xo=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},e1e=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},t1e="https://diddht.tbddev.org",cnt=0,A0=7200,hB=";",Ya=",",_z;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(_z||(_z={}));var Za;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(Za||(Za={}));var xz;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(xz||(xz={}));var n1e={Ed25519:Za.Ed25519,ES256K:Za.secp256k1,ES256:Za.secp256r1,"P-256":Za.secp256r1,secp256k1:Za.secp256k1,secp256r1:Za.secp256r1,X25519:Za.X25519},r1e={[Za.Ed25519]:"EdDSA",[Za.secp256k1]:"ES256K",[Za.secp256r1]:"ES256",[Za.X25519]:"ECDH-ES+A256KW"},Zf=class t extends vu{static create(){return Xo(this,arguments,void 0,function*({keyManager:e=new oi,options:r={}}={}){var n,i,o,s,a,d,u,c,l,h,y;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(j=>!(j.algorithm in n1e)))throw new Error("One or more verification method algorithms are not supported");let g=(i=r.verificationMethods)===null||i===void 0?void 0:i.filter(j=>"id"in j).map(j=>j.id);if(g&&g.length!==new Set(g).size)throw new Error("One or more verification method IDs are not unique");if(!((o=r.services)===null||o===void 0)&&o.some(j=>!j.id||!j.type||!j.serviceEndpoint))throw new Error("One or more services are missing required properties");let v=yield e.generateKey({algorithm:"Ed25519"}),x=yield e.getPublicKey({keyUri:v}),S=yield Zo.identityKeyToIdentifier({identityKey:x}),A=Object.assign(Object.assign({id:S},r.alsoKnownAs&&{alsoKnownAs:r.alsoKnownAs}),r.controllers&&{controller:r.controllers}),T=[...(s=r.verificationMethods)!==null&&s!==void 0?s:[]];T?.some(j=>{var K;return((K=j.id)===null||K===void 0?void 0:K.split("#").pop())==="0"})||T.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(let j of T){let K=j.id&&j.id.split("#").pop()==="0"?v:yield e.generateKey({algorithm:j.algorithm}),F=yield e.getPublicKey({keyUri:K}),L=(d=(a=j.id)!==null&&a!==void 0?a:F.kid)!==null&&d!==void 0?d:yield vt({jwk:F});L=`${S}#${Ac(L)}`,(u=A.verificationMethod)!==null&&u!==void 0||(A.verificationMethod=[]),A.verificationMethod.push({id:L,type:"JsonWebKey",controller:(c=j.controller)!==null&&c!==void 0?c:S,publicKeyJwk:F});for(let V of(l=j.purposes)!==null&&l!==void 0?l:[])A[V]||(A[V]=[]),A[V].push(L)}(h=r.services)===null||h===void 0||h.forEach(j=>{var K;(K=A.service)!==null&&K!==void 0||(A.service=[]),j.id=`${S}#${j.id.split("#").pop()}`,A.service.push(j)});let $=new _o({uri:S,document:A,metadata:Object.assign({published:!1},r.types&&{types:r.types}),keyManager:e});if(!((y=r.publish)!==null&&y!==void 0)||y){let j=yield t.publish({did:$,gatewayUri:r.gatewayUri});$.metadata=j.didDocumentMetadata}return $})}static import(e){return Xo(this,arguments,void 0,function*({portableDid:r,keyManager:n=new oi}){var i;let o=cr.parse(r.uri);if(o?.method!==t.methodName)throw new ut(rt.MethodNotSupported,"Method not supported");let s=yield _o.import({portableDid:r,keyManager:n});if(!(!((i=s.document.verificationMethod)===null||i===void 0)&&i.some(a=>{var d;return((d=a.id)===null||d===void 0?void 0:d.split("#").pop())==="0"})))throw new ut(rt.InvalidDidDocument,"DID document must contain an Identity Key");return s})}static getSigningMethod(e){return Xo(this,arguments,void 0,function*({didDocument:r,methodId:n="#0"}){var i;let o=cr.parse(r.id);if(o&&o.method!==this.methodName)throw new ut(rt.MethodNotSupported,`Method not supported: ${o.method}`);let s=(i=r.verificationMethod)===null||i===void 0?void 0:i.find(a=>{var d,u;return Ac(a.id)===((d=Ac(n))!==null&&d!==void 0?d:Ac((u=r.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(s&&s.publicKeyJwk))throw new ut(rt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static publish(e){return Xo(this,arguments,void 0,function*({did:r,gatewayUri:n=t1e}){return yield pB.put({did:r,gatewayUri:n})})}static resolve(e){return Xo(this,arguments,void 0,function*(r,n={}){var i;let o=(i=n?.gatewayUri)!==null&&i!==void 0?i:t1e;try{yield Zo.identifierToIdentityKey({didUri:r});let{didDocument:s,didDocumentMetadata:a}=yield pB.get({didUri:r,gatewayUri:o});return Object.assign(Object.assign({},mi),{didDocument:s,didDocumentMetadata:a})}catch(s){if(!(s instanceof ut))throw new Error(s);return Object.assign(Object.assign({},mi),{didResolutionMetadata:Object.assign({error:s.code},s.message&&{errorMessage:s.message})})}})}};Zf.methodName="dht";var pB=class t{static get(e){return Xo(this,arguments,void 0,function*({didUri:r,gatewayUri:n}){let i=Zo.identifierToIdentityKeyBytes({didUri:r}),o=yield t.pkarrGet({gatewayUri:n,publicKeyBytes:i}),s=yield Zo.parseBep44GetMessage({bep44Message:o}),a=yield t.fromDnsPacket({didUri:r,dnsPacket:s});return a.didDocumentMetadata.versionId=o.seq.toString(),a})}static put(e){return Xo(this,arguments,void 0,function*({did:r,gatewayUri:n}){let i=yield t.toDnsPacket({didDocument:r.document,didMetadata:r.metadata,authoritativeGatewayUris:[n]}),o=yield Zo.createBep44PutMessage({dnsPacket:i,publicKeyBytes:Zo.identifierToIdentityKeyBytes({didUri:r.uri}),signer:yield r.getSigner({methodId:"0"})}),s=yield t.pkarrPut({gatewayUri:n,bep44Message:o});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:s,versionId:o.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return Xo(this,arguments,void 0,function*({gatewayUri:r,publicKeyBytes:n}){let i=le.uint8Array(n).toBase32Z(),o=new URL(i,r).href,s;try{if(s=yield fetch(o,{method:"GET"}),!s.ok)throw new ut(rt.NotFound,`Pkarr record not found for: ${i}`)}catch(u){throw u instanceof ut?u:new ut(rt.InternalError,`Failed to fetch Pkarr record: ${u.message}`)}let a=yield s.arrayBuffer();if(!a)throw new ut(rt.NotFound,`Pkarr record not found for: ${i}`);if(a.byteLength<72)throw new ut(rt.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new ut(rt.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:n,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return Xo(this,arguments,void 0,function*({gatewayUri:r,bep44Message:n}){let i=le.uint8Array(n.k).toBase32Z(),o=new URL(i,r).href,s=new Uint8Array(n.v.length+72);s.set(n.sig,0),new DataView(s.buffer).setBigUint64(n.sig.length,BigInt(n.seq)),s.set(n.v,n.sig.length+8);let a;try{a=yield fetch(o,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:s})}catch(d){throw new ut(rt.InternalError,`Failed to put Pkarr record for identifier ${i}: ${d.message}`)}return a.ok})}static fromDnsPacket(e){return Xo(this,arguments,void 0,function*({didUri:r,dnsPacket:n}){var i,o,s;let a={id:r},d={published:!0},u=new Map;for(let c of(i=n?.answers)!==null&&i!==void 0?i:[]){if(c.type!=="TXT")continue;let l=c.name.split(".")[0].substring(1);switch(!0){case l.startsWith("aka"):{let h=Zo.parseTxtDataToString(c.data);a.alsoKnownAs=h.split(Ya);break}case l.startsWith("cnt"):{let h=Zo.parseTxtDataToString(c.data);a.controller=h.includes(Ya)?h.split(Ya):h;break}case l.startsWith("k"):{let{id:h,t:y,k:g,c:v,a:x}=Zo.parseTxtDataToObject(c.data),S=le.base64Url(g).toUint8Array(),A=Za[Number(y)],T=yield Zo.keyConverter(A).bytesToPublicKey({publicKeyBytes:S});T.alg=x||r1e[Number(y)];let $=l==="k0"?"0":h!==void 0?h:yield vt({jwk:T});(o=a.verificationMethod)!==null&&o!==void 0||(a.verificationMethod=[]);let j=`${r}#${$}`;a.verificationMethod.push({id:j,type:"JsonWebKey",controller:v??r,publicKeyJwk:T}),u.set(l,j);break}case l.startsWith("s"):{let h=Zo.parseTxtDataToObject(c.data),{id:y,t:g,se:v}=h,x=e1e(h,["id","t","se"]),S=v.includes(Ya)?v.split(Ya):[v],A=Object.fromEntries(Object.entries(x).map(([T,$])=>[T,$.includes(Ya)?$.split(Ya):$]));(s=a.service)!==null&&s!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},A),{id:`${r}#${y}`,type:g,serviceEndpoint:S}));break}case l.startsWith("typ"):{let{id:h}=Zo.parseTxtDataToObject(c.data);d.types=h.split(Ya).map(y=>Number(y));break}case l.startsWith("did"):{let h=A=>A.split(Ya).map(T=>u.get(T)).filter(T=>typeof T=="string"),{auth:y,asm:g,del:v,inv:x,agm:S}=Zo.parseTxtDataToObject(c.data);y&&(a.authentication=h(y)),g&&(a.assertionMethod=h(g)),v&&(a.capabilityDelegation=h(v)),x&&(a.capabilityInvocation=h(x)),S&&(a.keyAgreement=h(S));break}}}return{didDocument:a,didDocumentMetadata:d,didResolutionMetadata:{}}})}static toDnsPacket(e){return Xo(this,arguments,void 0,function*({didDocument:r,didMetadata:n,authoritativeGatewayUris:i,previousDidProof:o}){var s,a,d,u,c;let l=[],h=[],y=new Map,g=[],v=[];if(o!==void 0){let{signature:A,previousDid:T}=o;yield Zo.validatePreviousDidProof({newDid:r.id,previousDidProof:o}),l.push({type:"TXT",name:"_prv._did.",ttl:A0,data:`id=${T};s=${A}`})}if(r.alsoKnownAs&&l.push({type:"TXT",name:"_aka._did.",ttl:A0,data:r.alsoKnownAs.join(Ya)}),r.controller){let A=Array.isArray(r.controller)?r.controller.join(Ya):r.controller;l.push({type:"TXT",name:"_cnt._did.",ttl:A0,data:A})}for(let[A,T]of(a=(s=r.verificationMethod)===null||s===void 0?void 0:s.entries())!==null&&a!==void 0?a:[]){let $=`k${A}`;v.push($);let j=T.id.split("#").pop();y.set(j,$);let K=T.publicKeyJwk;if(!(K?.crv&&K.crv in n1e))throw new ut(rt.InvalidPublicKeyType,`Verification method '${T.id}' contains an unsupported key type: ${(d=K?.crv)!==null&&d!==void 0?d:"undefined"}`);let F=Za[K.crv],L=yield Zo.keyConverter(K.crv).publicKeyToBytes({publicKey:K}),V=le.uint8Array(L).toBase64Url(),q=[`t=${F}`,`k=${V}`];j!=="0"&&(yield vt({jwk:K}))!==j&&q.unshift(`id=${j}`),K.alg!==r1e[F]&&q.push(`a=${K.alg}`),T.controller!==r.id&&q.push(`c=${T.controller}`),l.push({type:"TXT",name:`_${$}._did.`,ttl:A0,data:q.join(hB)})}(u=r.service)===null||u===void 0||u.forEach((A,T)=>{let $=`s${T}`;g.push($);let{id:j,type:K,serviceEndpoint:F}=A,L=e1e(A,["id","type","serviceEndpoint"]);j=Ac(j),F=Array.isArray(F)?F.join(","):F;let q=Object.entries(Object.assign({id:j,t:K,se:F},L)).map(([P,B])=>`${P}=${B}`).join(hB),k=Zo.chunkDataIfNeeded(q);l.push({type:"TXT",name:`_${$}._did.`,ttl:A0,data:k})});let x=[`v=${cnt}`];if(v.length&&x.push(`vm=${v.join(Ya)}`),Object.keys($b).forEach(A=>{var T;let $=(T=r[A])===null||T===void 0?void 0:T.map(j=>y.get(j.split("#").pop()));if($){let j=xz[A];x.push(`${j}=${$.join(Ya)}`)}}),g.length&&x.push(`svc=${g.join(Ya)}`),!((c=n.types)===null||c===void 0)&&c.length){let T=n.types.map($=>typeof $=="string"?_z[$]:$);l.push({type:"TXT",name:"_typ._did.",ttl:A0,data:`id=${T.join(Ya)}`})}l.push({type:"TXT",name:"_did."+t.getUniqueDidSuffix(r.id)+".",ttl:A0,data:x.join(hB)});for(let A of i||[])h.push({type:"NS",name:"_did."+t.getUniqueDidSuffix(r.id)+".",ttl:A0,data:A+"."});return{id:0,type:"response",flags:E_,answers:[...l,...h]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}},Zo=class t{static createBep44PutMessage(e){return Xo(this,arguments,void 0,function*({dnsPacket:r,publicKeyBytes:n,signer:i}){let o=Math.ceil(Date.now()/1e3),s=Np(r),a=Dp.encode({seq:o,v:s}).subarray(1,-1);if(a.length>1e3)throw new ut(rt.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);let d=yield i.sign({data:a});return{k:n,seq:o,sig:d,v:s}})}static identifierToIdentityKey(e){return Xo(this,arguments,void 0,function*({didUri:r}){let n=t.identifierToIdentityKeyBytes({didUri:r});return yield en.bytesToPublicKey({publicKeyBytes:n})})}static identifierToIdentityKeyBytes({didUri:e}){let r=cr.parse(e);if(!r)throw new ut(rt.InvalidDid,`Invalid DID URI: ${e}`);if(r.method!==Zf.methodName)throw new ut(rt.MethodNotSupported,`Method not supported: ${r.method}`);let n;try{n=le.base32Z(r.id).toUint8Array()}catch{throw new ut(rt.InvalidPublicKey,"Failed to decode method-specific identifier")}if(n.length!==32)throw new ut(rt.InvalidPublicKeyLength,`Invalid public key length: ${n.length}`);return n}static identityKeyToIdentifier(e){return Xo(this,arguments,void 0,function*({identityKey:r}){let n=yield en.publicKeyToBytes({publicKey:r}),i=le.uint8Array(n).toBase32Z();return`did:${Zf.methodName}:${i}`})}static keyConverter(e){let n={Ed25519:en,"P-256":{publicKeyToBytes:i=>Xo(this,[i],void 0,function*({publicKey:o}){let s=yield $n.publicKeyToBytes({publicKey:o});return yield $n.compressPublicKey({publicKeyBytes:s})}),bytesToPublicKey:$n.bytesToPublicKey,privateKeyToBytes:$n.privateKeyToBytes,bytesToPrivateKey:$n.bytesToPrivateKey},secp256k1:{publicKeyToBytes:i=>Xo(this,[i],void 0,function*({publicKey:o}){let s=yield Pn.publicKeyToBytes({publicKey:o});return yield Pn.compressPublicKey({publicKeyBytes:s})}),bytesToPublicKey:Pn.bytesToPublicKey,privateKeyToBytes:Pn.privateKeyToBytes,bytesToPrivateKey:Pn.bytesToPrivateKey},X25519:qb}[e];if(!n)throw new ut(rt.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static parseBep44GetMessage(e){return Xo(this,arguments,void 0,function*({bep44Message:r}){let n=yield en.bytesToPublicKey({publicKeyBytes:r.k}),i=Dp.encode({seq:r.seq,v:r.v}).subarray(1,-1);if(!(yield en.verify({key:n,signature:r.sig,data:i})))throw new ut(rt.InvalidSignature,"Invalid signature for DHT BEP44 message");return d0(r.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(hB).reduce((r,n)=>{let[i,o]=n.split("=");return r[i]=o,r},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return le.uint8Array(e).toString();if(Array.isArray(e))return e.map(r=>this.parseTxtDataToString(r)).join("");throw new ut(rt.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return Xo(this,arguments,void 0,function*({newDid:r,previousDidProof:n}){let i=yield t.identifierToIdentityKey({didUri:n.previousDid}),o=t.identifierToIdentityKeyBytes({didUri:r}),s=le.base64Url(n.signature).toUint8Array();if(!(yield en.verify({key:i,data:o,signature:s})))throw new ut(rt.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;let r=[];for(let n=0;n<e.length;n+=255)r.push(e.slice(n,n+255));return r}};f();var k0=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Xf;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Xf||(Xf={}));var dnt={Ed25519:Xf.Ed25519,ES256K:Xf.secp256k1,ES256:Xf.secp256r1,"P-256":Xf.secp256r1,secp256k1:Xf.secp256k1,secp256r1:Xf.secp256r1},i1e="https://ion.tbd.engineering",Ez=class t extends vu{static create(){return k0(this,arguments,void 0,function*({keyManager:e=new oi,options:r={}}={}){var n,i,o,s,a,d,u;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(j=>!(j.algorithm in dnt)))throw new Error("One or more verification method algorithms are not supported");let c=(i=r.verificationMethods)===null||i===void 0?void 0:i.filter(j=>"id"in j).map(j=>j.id);if(c&&c.length!==new Set(c).size)throw new Error("One or more verification method IDs are not unique");if(!((o=r.services)===null||o===void 0)&&o.some(j=>!j.id||!j.type||!j.serviceEndpoint))throw new Error("One or more services are missing required properties");let l={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},h=[];for(let j of(s=r.verificationMethods)!==null&&s!==void 0?s:[l]){let K=yield e.generateKey({algorithm:j.algorithm}),F=yield e.getPublicKey({keyUri:K});h.push({id:j.id,publicKeyJwk:F,purposes:(a=j.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}let y=yield e.generateKey({algorithm:Xf.secp256k1}),g=yield e.getPublicKey({keyUri:y}),v=yield e.generateKey({algorithm:Xf.secp256k1}),x=yield e.getPublicKey({keyUri:v}),S=yield Lb.computeLongFormDidUri({recoveryKey:g,updateKey:x,services:(d=r.services)!==null&&d!==void 0?d:[],verificationMethods:h}),{didDocument:A,didResolutionMetadata:T}=yield t.resolve(S,{gatewayUri:r.gatewayUri});if(A===null)throw new Error(`Unable to resolve DID during creation: ${T?.error}`);let $=new _o({uri:S,document:A,metadata:{published:!1,canonicalId:S.split(":",3).join(":"),recoveryKey:g,updateKey:x},keyManager:e});if(!((u=r.publish)!==null&&u!==void 0)||u){let j=yield t.publish({did:$,gatewayUri:r.gatewayUri});$.metadata=j.didDocumentMetadata}return $})}static getSigningMethod(e){return k0(this,arguments,void 0,function*({didDocument:r,methodId:n}){var i;let o=cr.parse(r.id);if(o&&o.method!==this.methodName)throw new ut(rt.MethodNotSupported,`Method not supported: ${o.method}`);let s=(i=r.verificationMethod)===null||i===void 0?void 0:i.find(a=>{var d;return a.id===(n??((d=r.assertionMethod)===null||d===void 0?void 0:d[0]))});if(!(s&&s.publicKeyJwk))throw new ut(rt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static import(e){return k0(this,arguments,void 0,function*({portableDid:r,keyManager:n=new oi}){let i=cr.parse(r.uri);if(i?.method!==t.methodName)throw new ut(rt.MethodNotSupported,"Method not supported");return yield _o.import({portableDid:r,keyManager:n})})}static publish(e){return k0(this,arguments,void 0,function*({did:r,gatewayUri:n=i1e}){var i,o,s;let a=(o=(i=r.document.verificationMethod)===null||i===void 0?void 0:i.map(c=>({id:c.id,publicKeyJwk:c.publicKeyJwk,purposes:wz({didDocument:r.document,methodId:c.id})})))!==null&&o!==void 0?o:[],d=yield Lb.createIonDocument({services:(s=r.document.service)!==null&&s!==void 0?s:[],verificationMethods:a}),u=yield Lb.constructCreateRequest({ionDocument:d,recoveryKey:r.metadata.recoveryKey,updateKey:r.metadata.updateKey});try{let c=Lb.appendPathToUrl({baseUrl:n,path:"/operations"}),l=yield fetch(c,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:l.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:rt.InternalError,errorMessage:`Failed to publish DID document for: ${r.uri}`}}}})}static resolve(e){return k0(this,arguments,void 0,function*(r,n={}){var i,o;let s=cr.parse(r);if(!s)return Object.assign(Object.assign({},mi),{didResolutionMetadata:{error:"invalidDid"}});if(s.method!==t.methodName)return Object.assign(Object.assign({},mi),{didResolutionMetadata:{error:"methodNotSupported"}});let a=(i=n?.gatewayUri)!==null&&i!==void 0?i:i1e;try{let d=Lb.appendPathToUrl({baseUrl:a,path:`/identifiers/${r}`}),u=yield fetch(d);if(!u.ok)throw new ut(rt.NotFound,`Unable to find DID document for: ${r}`);let{didDocument:c,didDocumentMetadata:l}=yield u.json();return Object.assign(Object.assign(Object.assign({},mi),c&&{didDocument:c}),{didDocumentMetadata:Object.assign({published:(o=l?.method)===null||o===void 0?void 0:o.published},l)})}catch(d){if(!(d instanceof ut))throw new Error(d);return Object.assign(Object.assign({},mi),{didResolutionMetadata:Object.assign({error:d.code},d.message&&{errorMessage:d.message})})}})}};Ez.methodName="ion";var Lb=class t{static appendPathToUrl({baseUrl:e,path:r}){let n=new URL(e);return n.pathname=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",n.pathname+=r.startsWith("/")?r.substring(1):r,n.toString()}static computeLongFormDidUri(e){return k0(this,arguments,void 0,function*({recoveryKey:r,updateKey:n,services:i,verificationMethods:o}){let s=yield t.createIonDocument({services:i,verificationMethods:o}),a=t.normalizeJwk(r),d=t.normalizeJwk(n);return yield Jf.createLongFormDid({document:s,recoveryKey:a,updateKey:d})})}static constructCreateRequest(e){return k0(this,arguments,void 0,function*({ionDocument:r,recoveryKey:n,updateKey:i}){return yield hu.createCreateRequest({document:r,recoveryKey:t.normalizeJwk(n),updateKey:t.normalizeJwk(i)})})}static createIonDocument(e){return k0(this,arguments,void 0,function*({services:r,verificationMethods:n}){var i,o;let s=[];for(let u of n){let c=(o=(i=u.id)!==null&&i!==void 0?i:u.publicKeyJwk.kid)!==null&&o!==void 0?o:yield vt({jwk:u.publicKeyJwk});c=`${c.split("#").pop()}`;let l={id:c,publicKeyJwk:t.normalizeJwk(u.publicKeyJwk),purposes:u.purposes,type:"JsonWebKey2020"};s.push(l)}let a=r.map(u=>Object.assign(Object.assign({},u),{id:`${u.id.split("#").pop()}`}));return{publicKeys:s,services:a}})}static normalizeJwk(e){let r=e.kty,n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);return n}};f();var yB=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},P0=class t extends vu{static create(){return yB(this,arguments,void 0,function*({keyManager:e=new oi,options:r={}}={}){var n,i,o,s;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");let a=(s=(n=r.algorithm)!==null&&n!==void 0?n:(o=(i=r.verificationMethods)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.algorithm)!==null&&s!==void 0?s:"Ed25519",d=yield e.generateKey({algorithm:a}),u=yield e.getPublicKey({keyUri:d}),c=le.object(u).toBase64Url(),l=`did:${t.methodName}:${c}`,y=(yield t.resolve(l)).didDocument;return new _o({uri:l,document:y,metadata:{},keyManager:e})})}static getSigningMethod(e){return yB(this,arguments,void 0,function*({didDocument:r}){var n;let i=cr.parse(r.id);if(i&&i.method!==this.methodName)throw new ut(rt.MethodNotSupported,`Method not supported: ${i.method}`);let[o]=(n=r.verificationMethod)!==null&&n!==void 0?n:[];if(!(o&&o.publicKeyJwk))throw new ut(rt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return yB(this,arguments,void 0,function*({portableDid:r,keyManager:n=new oi}){let i=cr.parse(r.uri);if(i?.method!==t.methodName)throw new ut(rt.MethodNotSupported,"Method not supported");let o=yield _o.import({portableDid:r,keyManager:n});if(o.document.verificationMethod.length!==1)throw new ut(rt.InvalidDidDocument,"DID document must contain exactly one verification method");return o})}static resolve(e,r){return yB(this,void 0,void 0,function*(){let n=cr.parse(e),i;try{i=le.base64Url(n.id).toObject()}catch{}if(!n||!i)return Object.assign(Object.assign({},mi),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==t.methodName)return Object.assign(Object.assign({},mi),{didResolutionMetadata:{error:"methodNotSupported"}});let o={"@context":["https://www.w3.org/ns/did/v1"],id:n.uri},s=`${o.id}#0`;switch(o.verificationMethod=[{id:s,type:"JsonWebKey",controller:o.id,publicKeyJwk:i}],o.authentication=[s],o.assertionMethod=[s],o.capabilityInvocation=[s],o.capabilityDelegation=[s],o.keyAgreement=[s],i.use){case"sig":{delete o.keyAgreement;break}case"enc":{delete o.authentication,delete o.assertionMethod,delete o.capabilityInvocation,delete o.capabilityDelegation;break}}return Object.assign(Object.assign({},mi),{didDocument:o})})}};P0.methodName="jwk";f();var Al=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Hp;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(Hp||(Hp={}));var Sz={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},unt={Ed25519:Hp.Ed25519,ES256K:Hp.secp256k1,ES256:Hp.secp256r1,"P-256":Hp.secp256r1,secp256k1:Hp.secp256k1,secp256r1:Hp.secp256r1,X25519:Hp.X25519},Tz=class t extends vu{static create(){return Al(this,arguments,void 0,function*({keyManager:e=new oi,options:r={}}={}){var n,i,o,s;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");let a=(s=(n=r.algorithm)!==null&&n!==void 0?n:(o=(i=r.verificationMethods)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.algorithm)!==null&&s!==void 0?s:"Ed25519",d=yield e.generateKey({algorithm:a}),u=yield e.getPublicKey({keyUri:d}),c=yield kc.publicKeyToMultibaseId({publicKey:u}),l=`did:${t.methodName}:${c}`,y=(yield t.resolve(l,r)).didDocument;return new _o({uri:l,document:y,metadata:{},keyManager:e})})}static getSigningMethod(e){return Al(this,arguments,void 0,function*({didDocument:r}){var n;let i=cr.parse(r.id);if(i&&i.method!==this.methodName)throw new ut(rt.MethodNotSupported,`Method not supported: ${i.method}`);let[o]=r.assertionMethod||[],s=(n=r.verificationMethod)===null||n===void 0?void 0:n.find(a=>a.id===o);if(!(s&&s.publicKeyJwk))throw new ut(rt.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static import(e){return Al(this,arguments,void 0,function*({portableDid:r,keyManager:n=new oi}){let i=cr.parse(r.uri);if(i?.method!==t.methodName)throw new ut(rt.MethodNotSupported,"Method not supported");let o=yield _o.import({portableDid:r,keyManager:n});if(o.document.verificationMethod.length!==1)throw new ut(rt.InvalidDidDocument,"DID document must contain exactly one verification method");return o})}static resolve(e,r){return Al(this,void 0,void 0,function*(){try{let n=yield t.createDocument({didUri:e,options:r});return Object.assign(Object.assign({},mi),{didDocument:n})}catch(n){if(!(n instanceof ut))throw new Error(n);return Object.assign(Object.assign({},mi),{didResolutionMetadata:Object.assign({error:n.code},n.message&&{errorMessage:n.message})})}})}static createDocument(e){return Al(this,arguments,void 0,function*({didUri:r,options:n={}}){let{defaultContext:i="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:o=!1,enableExperimentalPublicKeyTypes:s=!1,publicKeyFormat:a="JsonWebKey2020"}=n,d={id:""},u=cr.parse(r);if(!u)throw new ut(rt.InvalidDid,`Invalid DID URI: ${r}`);let c=u.id;if(u.method!==t.methodName)throw new ut(rt.MethodNotSupported,`Method not supported: ${u.method}`);if(!t.validateIdentifier(u))throw new ut(rt.InvalidDid,`Invalid DID URI: ${r}`);let l=yield t.createSignatureMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:s,publicKeyFormat:a}});if(d.id=u.uri,d.verificationMethod=[l],d.authentication=[l.id],d.assertionMethod=[l.id],d.capabilityInvocation=[l.id],d.capabilityDelegation=[l.id],o===!0){let g=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",v=yield this.createEncryptionMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:s,publicKeyFormat:g}});d.verificationMethod.push(v),d.keyAgreement=[v.id]}let h=[i];return bz({didDocument:d}).forEach(g=>{let v=Sz[g];h.push(v)}),d["@context"]=h,d})}static createEncryptionMethod(e){return Al(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:i}){let{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}=i,a={id:"",type:"",controller:""},{keyBytes:d,multicodecCode:u}=yield t.deriveEncryptionKey({multibaseValue:n}),c=d.byteLength,l=kc.MULTICODEC_PUBLIC_KEY_LENGTH[u];if(c!==l)throw new ut(rt.InvalidPublicKeyLength,`Expected ${c} bytes. Actual: ${l}`);let h=uB({keyBytes:d,multicodecCode:u});a.id=`${r}#${h}`;try{new URL(a.id)}catch{throw new ut(rt.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(s in Sz))throw new ut(rt.UnsupportedPublicKeyType,`Unsupported format: ${s}`);if(o===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(s))throw new ut(rt.InvalidPublicKeyType,`Specified '${s}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=s,a.controller=r,s==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=h),s==="JsonWebKey2020"){let{crv:g}=yield kc.multicodecToJwk({code:u});a.publicKeyJwk=yield kc.keyConverter(g).bytesToPublicKey({publicKeyBytes:d})}return a})}static createSignatureMethod(e){return Al(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:i}){let{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}=i,a={id:"",type:"",controller:""},{keyBytes:d,multicodecCode:u,multicodecName:c}=lB({multibaseKeyId:n}),l=d.byteLength,h=kc.MULTICODEC_PUBLIC_KEY_LENGTH[u];if(l!==h)throw new ut(rt.InvalidPublicKeyLength,`Expected ${l} bytes. Actual: ${h}`);let y=!1;switch(c){case"secp256k1-pub":y=yield Pn.validatePublicKey({publicKeyBytes:d});break;case"ed25519-pub":y=yield en.validatePublicKey({publicKeyBytes:d});break;case"x25519-pub":y=!0;break}if(!y)throw new ut(rt.InvalidPublicKey,"Invalid public key detected.");a.id=`${r}#${n}`;try{new URL(a.id)}catch{throw new ut(rt.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(s in Sz))throw new ut(rt.UnsupportedPublicKeyType,`Unsupported format: ${s}`);if(o===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(s))throw new ut(rt.InvalidPublicKeyType,`Specified '${s}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=s,a.controller=r,s==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=n),s==="JsonWebKey2020"){let{crv:v}=yield kc.multicodecToJwk({code:u});a.publicKeyJwk=yield kc.keyConverter(v).bytesToPublicKey({publicKeyBytes:d})}return a})}static deriveEncryptionKey(e){return Al(this,arguments,void 0,function*({multibaseValue:r}){let n={keyBytes:new Uint8Array,multicodecCode:0},{keyBytes:i,multicodecCode:o}=lB({multibaseKeyId:r});if(o===237){let s=yield kc.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:i}),a=yield en.convertPublicKeyToX25519({publicKey:s});n={keyBytes:yield kc.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return n})}static validateIdentifier(e){let{method:r,id:n}=e,[i]=e.uri.split(":",1);return i==="did"&&r==="key"&&Number("1")>0&&Vf(n)==="String"&&n.startsWith("z")}};Tz.methodName="key";var kc=class t{static jwkToMulticodec(e){return Al(this,arguments,void 0,function*({jwk:r}){let n=[];r.crv&&(n.push(r.crv),r.d?n.push("private"):n.push("public"));let i=n.join(":"),o=t.JWK_TO_MULTICODEC[i];if(o===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${i}'`);return{code:An.getCodeFromName({name:o}),name:o}})}static keyCompressor(e){let n={"P-256":$n.compressPublicKey,secp256k1:Pn.compressPublicKey}[e];if(!n)throw new ut(rt.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static keyConverter(e){let n={Ed25519:en,"P-256":$n,secp256k1:Pn,X25519:qb}[e];if(!n)throw new ut(rt.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static multicodecToJwk(e){return Al(this,arguments,void 0,function*({code:r,name:n}){if(!(n?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");n=n===void 0?An.getNameFromCode({code:r}):n;let i=n,o=t.MULTICODEC_TO_JWK[i];if(o===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},o)})}static publicKeyToMultibaseId(e){return Al(this,arguments,void 0,function*({publicKey:r}){var n;if(!(r?.crv&&r.crv in unt))throw new ut(rt.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(n=r?.crv)!==null&&n!==void 0?n:"undefined"}`);let i=yield t.keyConverter(r.crv).publicKeyToBytes({publicKey:r});/^(secp256k1|P-256|P-384|P-521)$/.test(r.crv)&&(i=yield t.keyCompressor(r.crv)({publicKeyBytes:i}));let{name:o}=yield t.jwkToMulticodec({jwk:r});return uB({keyBytes:i,multicodecName:o})})}};kc.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};kc.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};kc.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};f();var lnt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Az=class t extends vu{static resolve(e,r){return lnt(this,void 0,void 0,function*(){let n=cr.parse(e);if(!n)return Object.assign(Object.assign({},mi),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==t.methodName)return Object.assign(Object.assign({},mi),{didResolutionMetadata:{error:"methodNotSupported"}});let i=`https://${n.id.replace(/:/g,"/")}`;i=decodeURIComponent(i);let o=n.id.includes(":")?`${i}/did.json`:`${i}/.well-known/did.json`;try{let s=yield fetch(o);if(!s.ok)throw new Error("HTTP error status code returned");let a=yield s.json();return Object.assign(Object.assign({},mi),{didDocument:a})}catch{return Object.assign(Object.assign({},mi),{didResolutionMetadata:{error:"notFound"}})}})}};Az.methodName="web";f();var o1e=xt(f0(),1),s1e=xt(m5(),1),fnt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},W_=class{constructor({db:e,location:r="DATA/DID_RESOLVERCACHE",ttl:n="15m"}={}){this.cache=e??new s1e.Level(r),this.ttl=(0,o1e.default)(n)}get(e){return fnt(this,void 0,void 0,function*(){try{let r=yield this.cache.get(e),n=JSON.parse(r);if(Date.now()>=n.ttlMillis){this.cache.nextTick(()=>this.cache.del(e));return}else return n.value}catch(r){if(r.notFound)return;throw r}})}set(e,r){let n={ttlMillis:Date.now()+this.ttl,value:r},i=JSON.stringify(n);return this.cache.put(e,i)}delete(e){return this.cache.del(e)}clear(){return this.cache.clear()}close(){return this.cache.close()}};f();var a1e={get:function(t){return null},set:function(t,e){return null},delete:function(t){return null},clear:function(){return null},close:function(){return null}};f();var c1e=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},G_=class{constructor({cache:e,didResolvers:r}){this.didResolvers=new Map,this.cache=e||a1e;for(let n of r)this.didResolvers.set(n.methodName,n)}resolve(e,r){return c1e(this,void 0,void 0,function*(){let n=cr.parse(e);if(!n)return Object.assign(Object.assign({},mi),{didResolutionMetadata:{error:rt.InvalidDid,errorMessage:`Invalid DID URI: ${e}`}});let i=this.didResolvers.get(n.method);if(!i)return Object.assign(Object.assign({},mi),{didResolutionMetadata:{error:rt.MethodNotSupported,errorMessage:`Method not supported: ${n.method}`}});let o=yield this.cache.get(n.uri);if(o)return o;{let s=yield i.resolve(n.uri,r);return s.didResolutionMetadata.error||(yield this.cache.set(n.uri,s)),s}})}dereference(e,r){return c1e(this,void 0,void 0,function*(){let n=cr.parse(e);if(!n)return{dereferencingMetadata:{error:rt.InvalidDidUrl},contentStream:null,contentMetadata:{}};let{didDocument:i,didResolutionMetadata:o,didDocumentMetadata:s}=yield this.resolve(n.uri);if(!i)return{dereferencingMetadata:{error:o.error},contentStream:null,contentMetadata:{}};if(!n.fragment||n.query)return{dereferencingMetadata:{contentType:"application/did+json"},contentStream:i,contentMetadata:s};let{service:a=[],verificationMethod:d=[]}=i,u=new Set([e,n.fragment,`#${n.fragment}`]),c;for(let l of d)if(u.has(l.id)){c=l;break}for(let l of a)if(u.has(l.id)){c=l;break}return c?{dereferencingMetadata:{contentType:"application/did+json"},contentStream:c,contentMetadata:o}:{dereferencingMetadata:{error:rt.NotFound},contentStream:null,contentMetadata:{}}})}};var hnt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Fb=class extends W_{constructor({agent:e,db:r,location:n,ttl:i}){super({db:r,location:n,ttl:i}),this._resolving=new Map,this._agent=e}get agent(){if(!this._agent)throw new Error("Agent not initialized");return this._agent}set agent(e){this._agent=e}get(e){return hnt(this,void 0,void 0,function*(){try{let r=yield this.cache.get(e),n=JSON.parse(r);if(!this._resolving.has(e)&&Date.now()>=n.ttlMillis)if(this._resolving.set(e,!0),this.agent.agentDid.uri===e||typeof(yield this.agent.identity.get({didUri:e}))<"u")try{let i=yield this.agent.did.resolve(e);i.didResolutionMetadata.error||this.set(e,i)}finally{this._resolving.delete(e)}else this._resolving.delete(e),this.cache.nextTick(()=>this.cache.del(e));return n.value}catch(r){if(r.notFound)return;throw r}})}};f();var pnt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},zb=class{constructor({did:e,metadata:r}){this.did=e,this.metadata=r}export(){return pnt(this,void 0,void 0,function*(){return{portableDid:yield this.did.export(),metadata:this.metadata}})}};f();f();f();f();var u1e=xt(d1e(),1);var mnt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};function Pz(t){return vB(t.stream())}function gB(t,e){return mnt(this,void 0,void 0,function*(){let r=yield e.dereference(`${t}#dwn`);if(r.dereferencingMetadata.error)throw new Error(`Failed to dereference '${t}#dwn': ${r.dereferencingMetadata.error}`);if(fB.isDwnDidService(r.contentStream)){let{serviceEndpoint:n}=r.contentStream,i=typeof n=="string"?[n]:Array.isArray(n)&&n.every(o=>typeof o=="string")?n:[];if(i.length>0)return i}return[]})}function Vb(t){return!t||typeof t!="object"||t===null?!1:"message"in t&&typeof t.message=="object"&&t.message!==null&&"descriptor"in t.message&&typeof t.message.descriptor=="object"&&t.message.descriptor!==null&&"interface"in t.message.descriptor&&t.message.descriptor.interface===Oe.Records&&"method"in t.message.descriptor&&t.message.descriptor.method===Ae.Write}function vB(t){return new u1e.ReadableWebToNodeStream(t)}var Wp=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};function gnt(t,e){return t.messageType===e}function l1e(t){return t===Ct.RecordsDelete||t===Ct.RecordsQuery||t===Ct.RecordsRead||t===Ct.RecordsSubscribe||t===Ct.RecordsWrite}var J_=class{constructor({agent:e,dwn:r}){this._agent=e,this._dwn=r}get agent(){if(this._agent===void 0)throw new Error("AgentDwnApi: Unable to determine agent execution context.");return this._agent}set agent(e){this._agent=e}get node(){return this._dwn}static createDwn({dataPath:e,dataStore:r,didResolver:n,eventLog:i,eventStream:o,messageStore:s,tenantGate:a,resumableTaskStore:d}){return Wp(this,void 0,void 0,function*(){return r??(r=new q_({blockstoreLocation:`${e}/DWN_DATASTORE`})),n??(n=new G_({didResolvers:[Zf,P0],cache:new W_({location:`${e}/DID_RESOLVERCACHE`})})),i??(i=new z_({location:`${e}/DWN_EVENTLOG`})),s??(s=new V_({blockstoreLocation:`${e}/DWN_MESSAGESTORE`,indexLocation:`${e}/DWN_MESSAGEINDEX`})),d??(d=new jb({location:`${e}/DWN_RESUMABLETASKSTORE`})),yield r3.create({dataStore:r,didResolver:n,eventLog:i,eventStream:o,messageStore:s,tenantGate:a,resumableTaskStore:d})})}processRequest(e){return Wp(this,void 0,void 0,function*(){let{message:r,dataStream:n}=yield this.constructDwnMessage({request:e}),{subscriptionHandler:i}=e;return{reply:e.store!==!1?yield this._dwn.processMessage(e.target,r,{dataStream:n,subscriptionHandler:i}):{status:{code:202,detail:"Accepted"}},message:r,messageCid:yield _e.getCid(r)}})}sendRequest(e){return Wp(this,void 0,void 0,function*(){let r=yield gB(e.target,this.agent.did);if(r.length===0)throw new Error(`AgentDwnApi: DID Service is missing or malformed: ${e.target}#dwn`);let n,i,o,s;if("messageCid"in e)({message:i,data:o}=yield this.getDwnMessage({author:e.author,messageCid:e.messageCid,messageType:e.messageType})),n=e.messageCid;else{if({message:i}=yield this.constructDwnMessage({request:e}),e.dataStream&&!(e.dataStream instanceof Blob))throw new Error("AgentDwnApi: DataStream must be provided as a Blob");o=e.dataStream,s=e.subscriptionHandler}let a=yield this.sendDwnRpcRequest({targetDid:e.target,dwnEndpointUrls:r,message:i,data:o,subscriptionHandler:s});return n??(n=yield _e.getCid(i)),{reply:a,message:i,messageCid:n}})}sendDwnRpcRequest({targetDid:e,dwnEndpointUrls:r,message:n,data:i,subscriptionHandler:o}){return Wp(this,void 0,void 0,function*(){let s=[];if(n.descriptor.method===Ae.Subscribe&&o===void 0)throw new Error("AgentDwnApi: Subscription handler is required for subscription requests.");for(let a of r)try{if(o!==void 0){if(!(yield this.agent.rpc.getServerInfo(a)).webSocketSupport){s.push({url:a,message:"WebSocket support is not enabled on the server."});continue}let c=new URL(a);c.protocol=c.protocol==="http:"?"ws:":"wss:",a=c.toString()}return yield this.agent.rpc.sendDwnRequest({dwnUrl:a,targetDid:e,message:n,data:i,subscriptionHandler:o})}catch(d){s.push({url:a,message:d instanceof Error?d.message:"Unknown error"})}throw new Error(`Failed to send DWN RPC request: ${JSON.stringify(s)}`)})}constructDwnMessage({request:e}){var r;return Wp(this,void 0,void 0,function*(){if(e.granteeDid&&!this.hasGrantParams(e.messageParams))throw new Error("AgentDwnApi: Requested to sign with a permission but no grant messageParams were provided in the request");let n=e.rawMessage,i;if(gnt(e,Ct.RecordsWrite)){let a=e.messageParams;if(e.dataStream&&!a?.data){let{dataStream:d}=e,u;if(d instanceof Blob)u=Pz(d),i=Pz(d);else if(d instanceof ReadableStream){let[c,l]=d.tee();u=vB(c),i=vB(l)}n||(a.dataCid=yield vn.computeDagPbCidFromStream(u),(r=a.dataSize)!==null&&r!==void 0||(a.dataSize=u.bytesRead))}}let o,s=yz[e.messageType];if(n){if(o=yield s.parse(n),Vb(o)&&e.signAsOwner){let a=yield this.getSigner(e.author);yield o.signAsOwner(a)}else if(e.granteeDid&&Vb(o)&&e.signAsOwnerDelegate){let a=yield this.getSigner(e.granteeDid),d=e.messageParams;yield o.signAsOwnerDelegate(a,d.delegatedGrant)}}else{let a=e.granteeDid?yield this.getSigner(e.granteeDid):yield this.getSigner(e.author);o=yield s.create(Object.assign(Object.assign({},e.messageParams),{signer:a}))}return{message:o.message,dataStream:i}})}hasGrantParams(e){return e!==void 0&&("permissionGrantId"in e&&e.permissionGrantId!==void 0||"delegatedGrant"in e&&e.delegatedGrant!==void 0)}getSigner(e){return Wp(this,void 0,void 0,function*(){if(e===this.agent.agentDid.uri){let r=yield this.agent.agentDid.getSigner();return{algorithm:r.algorithm,keyId:r.keyId,sign:n=>Wp(this,void 0,void 0,function*(){return yield r.sign({data:n})})}}else try{let r=yield this.agent.did.getSigningMethod({didUri:e});if(!r.publicKeyJwk)throw new Error(`Verification method '${r.id}' does not contain a public key in JWK format`);let n=yield this.agent.keyManager.getKeyUri({key:r.publicKeyJwk}),i=yield this.agent.keyManager.getPublicKey({keyUri:n}),o=this.agent.keyManager;return{algorithm:ro.getJoseSignatureAlgorithmFromPublicKey(i),keyId:r.id,sign:s=>Wp(this,void 0,void 0,function*(){return yield o.sign({data:s,keyUri:n})})}}catch(r){throw new Error(`AgentDwnApi: Unable to get signer for author '${e}': ${r.message}`)}})}getDwnMessage({author:e,messageCid:r}){return Wp(this,void 0,void 0,function*(){let n=yield this.getSigner(e),i=yield yz[Ct.MessagesRead].create({messageCid:r,signer:n}),o=yield this._dwn.processMessage(e,i.message);if(o.status.code!==200)throw new Error(`AgentDwnApi: Failed to read message, response status: ${o.status.code} - ${o.status.detail}`);let s=o.entry,d={message:s.message};if(Vb(s)&&s.data){let u=yield Mp.consumeToBytes({readable:s.data});d.data=new Blob([u],{type:s.message.descriptor.dataFormat})}return d})}};var Hb=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},f1e=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Gp=class{get agent(){if(!this._agent)throw new Error("AgentPermissionsApi: Agent is not set");return this._agent}set agent(e){this._agent=e}constructor({agent:e}={}){this._agent=e}fetchGrants({author:e,target:r,grantee:n,grantor:i,protocol:o,remote:s=!1}){return Hb(this,void 0,void 0,function*(){let a=o?{protocol:o}:void 0,d={author:e,target:r,messageType:Ct.RecordsQuery,messageParams:{filter:{author:i,recipient:n,protocol:gt.uri,protocolPath:gt.grantPath,tags:a}}},{reply:u}=s?yield this.agent.sendDwnRequest(d):yield this.agent.processDwnRequest(d);if(u.status.code!==200)throw new Error(`PermissionsApi: Failed to fetch grants: ${u.status.detail}`);let c=[];for(let l of u.entries){let h=yield ei.parse(l);c.push({grant:h,message:l})}return c})}fetchRequests({author:e,target:r,protocol:n,remote:i=!1}){return Hb(this,void 0,void 0,function*(){let o=n?{protocol:n}:void 0,s={author:e,target:r,messageType:Ct.RecordsQuery,messageParams:{filter:{protocol:gt.uri,protocolPath:gt.requestPath,tags:o}}},{reply:a}=i?yield this.agent.sendDwnRequest(s):yield this.agent.processDwnRequest(s);if(a.status.code!==200)throw new Error(`PermissionsApi: Failed to fetch requests: ${a.status.detail}`);let d=[];for(let u of a.entries){let c=yield sp.parse(u);d.push({request:c,message:u})}return d})}isGrantRevoked({author:e,target:r,grantRecordId:n,remote:i=!1}){return Hb(this,void 0,void 0,function*(){let o={author:e,target:r,messageType:Ct.RecordsRead,messageParams:{filter:{parentId:n,protocol:gt.uri,protocolPath:gt.revocationPath}}},{reply:s}=i?yield this.agent.sendDwnRequest(o):yield this.agent.processDwnRequest(o);if(s.status.code===404)return!1;if(s.status.code===200)return!0;throw new Error(`PermissionsApi: Failed to check if grant is revoked: ${s.status.detail}`)})}createGrant(e){return Hb(this,void 0,void 0,function*(){let{author:r,store:n=!1,delegated:i=!1}=e,o=f1e(e,["author","store","delegated"]),s;gt.hasProtocolScope(o.scope)&&(s={protocol:o.scope.protocol});let a={dateExpires:o.dateExpires,requestId:o.requestId,description:o.description,delegated:i,scope:o.scope},d=le.object(a).toUint8Array(),u={recipient:o.grantedTo,protocol:gt.uri,protocolPath:gt.grantPath,dataFormat:"application/json",tags:s},{reply:c,message:l}=yield this.agent.processDwnRequest({store:n,author:r,target:r,messageType:Ct.RecordsWrite,messageParams:u,dataStream:new Blob([d])});if(c.status.code!==202)throw new Error(`PermissionsApi: Failed to create grant: ${c.status.detail}`);let h=Object.assign(Object.assign({},l),{encodedData:le.uint8Array(d).toBase64Url()});return{grant:yield ei.parse(h),message:h}})}createRequest(e){return Hb(this,void 0,void 0,function*(){let{author:r,store:n=!1,delegated:i=!1}=e,o=f1e(e,["author","store","delegated"]),s;gt.hasProtocolScope(o.scope)&&(s={protocol:o.scope.protocol});let a={description:o.description,delegated:i,scope:o.scope},d=le.object(a).toUint8Array(),u={protocol:gt.uri,protocolPath:gt.requestPath,dataFormat:"application/json",tags:s},{reply:c,message:l}=yield this.agent.processDwnRequest({store:n,author:r,target:r,messageType:Ct.RecordsWrite,messageParams:u,dataStream:new Blob([d])});if(c.status.code!==202)throw new Error(`PermissionsApi: Failed to create request: ${c.status.detail}`);let h=Object.assign(Object.assign({},l),{encodedData:le.uint8Array(d).toBase64Url()});return{request:yield sp.parse(h),message:h}})}createRevocation(e){return Hb(this,void 0,void 0,function*(){let{author:r,store:n=!1,grant:i,description:o}=e,s={description:o},a=le.object(s).toUint8Array(),d;gt.hasProtocolScope(i.scope)&&(d={protocol:i.scope.protocol});let u={parentContextId:i.id,protocol:gt.uri,protocolPath:gt.revocationPath,dataFormat:"application/json",tags:d},{reply:c,message:l}=yield this.agent.processDwnRequest({store:n,author:r,target:r,messageType:Ct.RecordsWrite,messageParams:u,dataStream:new Blob([a])});if(c.status.code!==202)throw new Error(`PermissionsApi: Failed to create revocation: ${c.status.detail}`);return{message:Object.assign(Object.assign({},l),{encodedData:le.uint8Array(a).toBase64Url()})}})}static matchGrantFromArray(e,r,n,i,o=!1){return Hb(this,void 0,void 0,function*(){for(let s of i){let{grant:a,message:d}=s;if(o===!0&&a.delegated!==!0)continue;let{messageType:u,protocol:c,protocolPath:l,contextId:h}=n;if(this.matchScopeFromGrant(e,r,u,a,c,l,h))return{grant:a,message:d}}})}static matchScopeFromGrant(e,r,n,i,o,s,a){if(i.grantee!==r||i.grantor!==e)return!1;let d=i.scope;if(d.interface+d.method===n)if(l1e(n)){let c=d;if(!this.matchesProtocol(c,o))return!1;if(this.isUnrestrictedProtocolScope(c)||c.protocolPath!==void 0&&c.protocolPath===s||c.contextId!==void 0&&a?.startsWith(c.contextId))return!0}else{let c=d;return this.protocolScopeUnrestricted(c)?!0:this.matchesProtocol(c,o)?this.isUnrestrictedProtocolScope(c):!1}return!1}static matchesProtocol(e,r){return e.protocol!==void 0&&e.protocol===r}static protocolScopeUnrestricted(e){return e.protocol===void 0}static isUnrestrictedProtocolScope(e){return e.contextId===void 0&&e.protocolPath===void 0}};var h1e=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},T3=class{constructor({agent:e,cachedDefault:r}){this.cachedPermissions=new zf.default({ttl:60*1e3}),this.permissionsApi=new Gp({agent:e}),this.cachedDefault=r??!1}getPermission({connectedDid:e,delegateDid:r,delegate:n,messageType:i,protocol:o,cached:s=this.cachedDefault}){return h1e(this,void 0,void 0,function*(){let a=[e,r,i,o].join("~"),d=s?this.cachedPermissions.get(a):void 0;if(d)return d;let u=yield this.permissionsApi.fetchGrants({author:r,target:r,grantor:e,grantee:r}),c=yield Gp.matchGrantFromArray(e,r,{messageType:i,protocol:o},u,n);if(!c)throw new Error(`CachedPermissions: No permissions found for ${i}: ${o}`);return this.cachedPermissions.set(a,c),c})}clear(){return h1e(this,void 0,void 0,function*(){this.cachedPermissions.clear()})}};f();f();f();var vnt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},bB=class{static deriveKeyBytes({baseKeyBytes:e,length:r,hash:n,salt:i,info:o=new Uint8Array}){return vnt(this,void 0,void 0,function*(){let a=yield hs().importKey("raw",e,{name:"HKDF"},!1,["deriveBits"]);i=typeof i=="string"?le.string(i).toUint8Array():i,o=typeof o=="string"?le.string(o).toUint8Array():o;let d=yield crypto.subtle.deriveBits({name:"HKDF",hash:n,salt:i,info:o},a,r);return new Uint8Array(d)})}};var bnt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},wnt=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},wB=class extends gi{deriveKeyBytes(e){var{algorithm:r}=e,n=wnt(e,["algorithm"]);return bnt(this,void 0,void 0,function*(){let i={"HKDF-256":"SHA-256","HKDF-384":"SHA-384","HKDF-512":"SHA-512"}[r];return yield bB.deriveKeyBytes(Object.assign(Object.assign({},n),{hash:i}))})}};f();f();var at=class t extends Error{constructor(e,r){super(r),this.code=e,this.name="CryptoError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t)}},nt;(function(t){t.AlgorithmNotSupported="algorithmNotSupported",t.EncodingError="encodingError",t.InvalidJwe="invalidJwe",t.InvalidJwk="invalidJwk",t.OperationNotSupported="operationNotSupported"})(nt||(nt={}));var Jp=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},A3=class extends gi{bytesToPrivateKey({algorithm:e,privateKeyBytes:r}){return Jp(this,void 0,void 0,function*(){switch(e){case"ES256K":case"secp256k1":{let n=yield Pn.bytesToPrivateKey({privateKeyBytes:r});return n.alg="EdDSA",n}case"ES256":case"secp256r1":{let n=yield $n.bytesToPrivateKey({privateKeyBytes:r});return n.alg="EdDSA",n}default:throw new at(nt.AlgorithmNotSupported,`Algorithm not supported: ${e}`)}})}bytesToPublicKey({algorithm:e,publicKeyBytes:r}){return Jp(this,void 0,void 0,function*(){switch(e){case"ES256K":case"secp256k1":{let n=yield Pn.bytesToPublicKey({publicKeyBytes:r});return n.alg="EdDSA",n}case"ES256":case"secp256r1":{let n=yield $n.bytesToPublicKey({publicKeyBytes:r});return n.alg="EdDSA",n}default:throw new at(nt.AlgorithmNotSupported,`Algorithm not supported: ${e}`)}})}computePublicKey({key:e}){return Jp(this,void 0,void 0,function*(){if(!Sc(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{let r=yield Pn.computePublicKey({key:e});return r.alg="ES256K",r}case"P-256":{let r=yield $n.computePublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return Jp(this,void 0,void 0,function*(){switch(e){case"ES256K":case"secp256k1":{let r=yield Pn.generateKey();return r.alg="ES256K",r}case"ES256":case"secp256r1":{let r=yield $n.generateKey();return r.alg="ES256",r}}})}getPublicKey({key:e}){return Jp(this,void 0,void 0,function*(){if(!Sc(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{let r=yield Pn.getPublicKey({key:e});return r.alg="ES256K",r}case"P-256":{let r=yield $n.getPublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}privateKeyToBytes({privateKey:e}){return Jp(this,void 0,void 0,function*(){switch(e.crv){case"secp256k1":return yield Pn.privateKeyToBytes({privateKey:e});case"P-256":return yield $n.privateKeyToBytes({privateKey:e});default:throw new at(nt.AlgorithmNotSupported,`Curve not supported: ${e.crv}`)}})}publicKeyToBytes({publicKey:e}){return Jp(this,void 0,void 0,function*(){switch(e.crv){case"secp256k1":return yield Pn.publicKeyToBytes({publicKey:e});case"P-256":return yield $n.publicKeyToBytes({publicKey:e});default:throw new at(nt.AlgorithmNotSupported,`Curve not supported: ${e.crv}`)}})}sign({key:e,data:r}){return Jp(this,void 0,void 0,function*(){if(!Sc(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":return yield Pn.sign({key:e,data:r});case"P-256":return yield $n.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return Jp(this,void 0,void 0,function*(){if(!x0(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(e.crv){case"secp256k1":return yield Pn.verify({key:e,signature:r,data:n});case"P-256":return yield $n.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};f();var Yp=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},_B=class extends gi{bytesToPrivateKey({algorithm:e,privateKeyBytes:r}){return Yp(this,void 0,void 0,function*(){switch(e){case"Ed25519":{let n=yield en.bytesToPrivateKey({privateKeyBytes:r});return n.alg="EdDSA",n}default:throw new at(nt.AlgorithmNotSupported,`Algorithm not supported: ${e}`)}})}bytesToPublicKey({algorithm:e,publicKeyBytes:r}){return Yp(this,void 0,void 0,function*(){switch(e){case"Ed25519":{let n=yield en.bytesToPublicKey({publicKeyBytes:r});return n.alg="EdDSA",n}default:throw new at(nt.AlgorithmNotSupported,`Algorithm not supported: ${e}`)}})}computePublicKey({key:e}){return Yp(this,void 0,void 0,function*(){if(!Tc(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{let r=yield en.computePublicKey({key:e});return r.alg="EdDSA",r}default:throw new at(nt.AlgorithmNotSupported,`Curve not supported: ${e.crv}`)}})}generateKey({algorithm:e}){return Yp(this,void 0,void 0,function*(){switch(e){case"Ed25519":{let r=yield en.generateKey();return r.alg="EdDSA",r}}})}getPublicKey({key:e}){return Yp(this,void 0,void 0,function*(){if(!Tc(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{let r=yield en.getPublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}privateKeyToBytes({privateKey:e}){return Yp(this,void 0,void 0,function*(){switch(e.crv){case"Ed25519":return yield en.privateKeyToBytes({privateKey:e});default:throw new at(nt.AlgorithmNotSupported,`Curve not supported: ${e.crv}`)}})}publicKeyToBytes({publicKey:e}){return Yp(this,void 0,void 0,function*(){switch(e.crv){case"Ed25519":return yield en.publicKeyToBytes({publicKey:e});default:throw new at(nt.AlgorithmNotSupported,`Curve not supported: ${e.crv}`)}})}sign({key:e,data:r}){return Yp(this,void 0,void 0,function*(){if(!Tc(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":return yield en.sign({key:e,data:r});default:throw new at(nt.AlgorithmNotSupported,`Curve not supported: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return Yp(this,void 0,void 0,function*(){if(!E0(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(e.crv){case"Ed25519":return yield en.verify({key:e,signature:r,data:n});default:throw new at(nt.AlgorithmNotSupported,`Curve not supported: ${e.crv}`)}})}};f();f();var k3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},p1e=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},y1e=[128,192,256],I0=class{static bytesToPrivateKey({privateKeyBytes:e}){return k3(this,void 0,void 0,function*(){let r={k:le.uint8Array(e).toBase64Url(),kty:"oct"};r.kid=yield vt({jwk:r});let n=e.length*8;return r.alg={128:"A128KW",192:"A192KW",256:"A256KW"}[n],r})}static generateKey({length:e}){return k3(this,void 0,void 0,function*(){if(!y1e.includes(e))throw new RangeError(`The key length is invalid: Must be ${y1e.join(", ")} bits`);let r=hs(),n=yield r.generateKey({name:"AES-KW",length:e},!0,["wrapKey","unwrapKey"]),i=yield r.exportKey("jwk",n),{ext:o,key_ops:s}=i,a=p1e(i,["ext","key_ops"]);return a.kid=yield vt({jwk:a}),a})}static privateKeyToBytes({privateKey:e}){return k3(this,void 0,void 0,function*(){if(!Ub(e))throw new Error("AesKw: The provided key is not a valid oct private key.");return le.base64Url(e.k).toUint8Array()})}static unwrapKey({wrappedKeyBytes:e,wrappedKeyAlgorithm:r,decryptionKey:n}){return k3(this,void 0,void 0,function*(){if(!("alg"in n&&n.alg))throw new at(nt.InvalidJwk,"The decryption key is missing the 'alg' property.");if(!["A128KW","A192KW","A256KW"].includes(n.alg))throw new at(nt.AlgorithmNotSupported,`The 'decryptionKey' algorithm is not supported: ${n.alg}`);let i=hs(),o=yield i.importKey("jwk",n,{name:"AES-KW"},!0,["unwrapKey"]),s={A128KW:"AES-KW",A192KW:"AES-KW",A256KW:"AES-KW",A128GCM:"AES-GCM",A192GCM:"AES-GCM",A256GCM:"AES-GCM"}[r];if(!s)throw new at(nt.AlgorithmNotSupported,`The 'wrappedKeyAlgorithm' is not supported: ${r}`);let a=yield i.unwrapKey("raw",e.buffer,o,"AES-KW",{name:s},!0,["unwrapKey"]),d=yield i.exportKey("jwk",a),{ext:u,key_ops:c}=d,h=p1e(d,["ext","key_ops"]);return h.kid=yield vt({jwk:h}),h})}static wrapKey({unwrappedKey:e,encryptionKey:r}){return k3(this,void 0,void 0,function*(){if(!("alg"in r&&r.alg))throw new at(nt.InvalidJwk,"The encryption key is missing the 'alg' property.");if(!["A128KW","A192KW","A256KW"].includes(r.alg))throw new at(nt.AlgorithmNotSupported,`The 'encryptionKey' algorithm is not supported: ${r.alg}`);if(!("alg"in e&&e.alg))throw new at(nt.InvalidJwk,"The private key to wrap is missing the 'alg' property.");let n=hs(),i=yield n.importKey("jwk",r,{name:"AES-KW"},!0,["wrapKey"]),o={A128KW:"AES-KW",A192KW:"AES-KW",A256KW:"AES-KW",A128GCM:"AES-GCM",A192GCM:"AES-GCM",A256GCM:"AES-GCM"}[e.alg];if(!o)throw new at(nt.AlgorithmNotSupported,`The 'unwrappedKey' algorithm is not supported: ${e.alg}`);let s=yield n.importKey("jwk",e,{name:o},!0,["unwrapKey"]),a=yield n.wrapKey("raw",s,i,"AES-KW");return new Uint8Array(a)})}};var P3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Y_=class extends gi{bytesToPrivateKey({privateKeyBytes:e}){return P3(this,void 0,void 0,function*(){let r=yield I0.bytesToPrivateKey({privateKeyBytes:e});return r.alg={16:"A128KW",24:"A192KW",32:"A256KW"}[e.length],r})}generateKey({algorithm:e}){return P3(this,void 0,void 0,function*(){let r={A128KW:128,A192KW:192,A256KW:256}[e],n=yield I0.generateKey({length:r});return n.alg=e,n})}privateKeyToBytes({privateKey:e}){return P3(this,void 0,void 0,function*(){return yield I0.privateKeyToBytes({privateKey:e})})}unwrapKey(e){return P3(this,void 0,void 0,function*(){return yield I0.unwrapKey(e)})}wrapKey(e){return P3(this,void 0,void 0,function*(){return I0.wrapKey(e)})}};f();f();var _nt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},xB=class{static deriveKeyBytes({baseKeyBytes:e,hash:r,salt:n,iterations:i,length:o}){return _nt(this,void 0,void 0,function*(){let s=hs(),a=yield s.importKey("raw",e,{name:"PBKDF2"},!1,["deriveBits"]),d=yield s.deriveBits({name:"PBKDF2",hash:r,salt:n,iterations:i},a,o);return new Uint8Array(d)})}};var xnt=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Ent=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},EB=class extends gi{deriveKeyBytes(e){var{algorithm:r}=e,n=Ent(e,["algorithm"]);return xnt(this,void 0,void 0,function*(){let[,i]=r.split(/[-+]/),o={HS256:"SHA-256",HS384:"SHA-384",HS512:"SHA-512"}[i];return yield xB.deriveKeyBytes(Object.assign(Object.assign({},n),{hash:o}))})}};f();var I3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},SB=class extends gi{bytesToPrivateKey({privateKeyBytes:e}){return I3(this,void 0,void 0,function*(){let r=yield gu.bytesToPrivateKey({privateKeyBytes:e});return r.alg={16:"A128GCM",24:"A192GCM",32:"A256GCM"}[e.length],r})}decrypt(e){return I3(this,void 0,void 0,function*(){return gu.decrypt(e)})}encrypt(e){return I3(this,void 0,void 0,function*(){return gu.encrypt(e)})}generateKey({algorithm:e}){return I3(this,void 0,void 0,function*(){let r={A128GCM:128,A192GCM:192,A256GCM:256}[e],n=yield gu.generateKey({length:r});return n.alg=e,n})}privateKeyToBytes({privateKey:e}){return I3(this,void 0,void 0,function*(){return yield gu.privateKeyToBytes({privateKey:e})})}};var va=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Iz={"AES-GCM":{implementation:SB,names:["A128GCM","A192GCM","A256GCM"],operations:["bytesToPrivateKey","decrypt","encrypt","generateKey"]},"AES-KW":{implementation:Y_,names:["A128KW","A192KW","A256KW"],operations:["bytesToPrivateKey","generateKey","privateKeyToBytes","wrapKey","unwrapKey"]},Ed25519:{implementation:_B,names:["Ed25519"],operations:["bytesToPrivateKey","bytesToPublicKey","generateKey","sign","verify"]},HKDF:{implementation:wB,names:["HKDF-256","HKDF-384","HKDF-512"],operations:["deriveKey","deriveKeyBytes"]},PBKDF2:{implementation:EB,names:["PBES2-HS256+A128KW","PBES2-HS384+A192KW","PBES2-HS512+A256KW"],operations:["deriveKey","deriveKeyBytes"]},secp256k1:{implementation:A3,names:["ES256K","secp256k1"],operations:["bytesToPrivateKey","bytesToPublicKey","generateKey","sign","verify"]},secp256r1:{implementation:A3,names:["ES256","secp256r1"],operations:["bytesToPrivateKey","bytesToPublicKey","generateKey","sign","verify"]},"SHA-256":{implementation:_0,names:["SHA-256"],operations:["digest"]}},vd=class{constructor(){this._algorithmInstances=new Map}bytesToPrivateKey({algorithm:e,privateKeyBytes:r}){return va(this,void 0,void 0,function*(){let n=this.getAlgorithmName({algorithm:e});return yield this.getAlgorithm({algorithm:n}).bytesToPrivateKey({algorithm:e,privateKeyBytes:r})})}bytesToPublicKey({algorithm:e,publicKeyBytes:r}){return va(this,void 0,void 0,function*(){let n=this.getAlgorithmName({algorithm:e});return yield this.getAlgorithm({algorithm:n}).bytesToPublicKey({algorithm:e,publicKeyBytes:r})})}decrypt(e){return va(this,void 0,void 0,function*(){let r=this.getAlgorithmName({key:e.key});return yield this.getAlgorithm({algorithm:r}).decrypt(e)})}deriveKey(e){var r,n;return va(this,void 0,void 0,function*(){let i=this.getAlgorithmName({algorithm:e.algorithm}),o=this.getAlgorithm({algorithm:i}),s;switch(e.algorithm){case"HKDF-256":case"HKDF-384":case"HKDF-512":{s=e.derivedKeyAlgorithm;break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{s=e.algorithm.split(/[-+]/)[2];break}default:throw new at(nt.AlgorithmNotSupported,`The specified "algorithm" is not supported: ${e.algorithm}`)}let a=+((n=(r=s.match(/\d+/))===null||r===void 0?void 0:r[0])!==null&&n!==void 0?n:-1);if(a===-1)throw new at(nt.AlgorithmNotSupported,`The derived key algorithm" is not supported: ${s}`);let d=yield o.deriveKeyBytes(Object.assign(Object.assign({},e),{length:a}));return yield this.bytesToPrivateKey({algorithm:s,privateKeyBytes:d})})}deriveKeyBytes(e){return va(this,void 0,void 0,function*(){let r=this.getAlgorithmName({algorithm:e.algorithm});return yield this.getAlgorithm({algorithm:r}).deriveKeyBytes(e)})}digest({algorithm:e,data:r}){return va(this,void 0,void 0,function*(){return yield this.getAlgorithm({algorithm:e}).digest({algorithm:e,data:r})})}encrypt(e){return va(this,void 0,void 0,function*(){let r=this.getAlgorithmName({key:e.key});return yield this.getAlgorithm({algorithm:r}).encrypt(e)})}generateKey(e){var r;return va(this,void 0,void 0,function*(){let n=this.getAlgorithmName({algorithm:e.algorithm}),o=yield this.getAlgorithm({algorithm:n}).generateKey({algorithm:e.algorithm});return(r=o.kid)!==null&&r!==void 0||(o.kid=yield vt({jwk:o})),o})}getKeyUri(e){return va(this,void 0,void 0,function*(){throw new Error("Method not implemented.")})}getPublicKey({key:e}){return va(this,void 0,void 0,function*(){let r=this.getAlgorithmName({key:e});return yield this.getAlgorithm({algorithm:r}).getPublicKey({key:e})})}privateKeyToBytes({privateKey:e}){return va(this,void 0,void 0,function*(){let r=this.getAlgorithmName({key:e});return yield this.getAlgorithm({algorithm:r}).privateKeyToBytes({privateKey:e})})}publicKeyToBytes({publicKey:e}){return va(this,void 0,void 0,function*(){let r=this.getAlgorithmName({key:e});return yield this.getAlgorithm({algorithm:r}).publicKeyToBytes({publicKey:e})})}sign({key:e,data:r}){return va(this,void 0,void 0,function*(){let n=this.getAlgorithmName({key:e});return this.getAlgorithm({algorithm:n}).sign({data:r,key:e})})}unwrapKey(e){return va(this,void 0,void 0,function*(){let r=this.getAlgorithmName({key:e.decryptionKey});return yield this.getAlgorithm({algorithm:r}).unwrapKey(e)})}verify({key:e,signature:r,data:n}){return va(this,void 0,void 0,function*(){let i=this.getAlgorithmName({key:e});return this.getAlgorithm({algorithm:i}).verify({key:e,signature:r,data:n})})}wrapKey(e){return va(this,void 0,void 0,function*(){let r=this.getAlgorithmName({key:e.encryptionKey});return yield this.getAlgorithm({algorithm:r}).wrapKey(e)})}getAlgorithm({algorithm:e}){var r;let n=(r=Iz[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new at(nt.AlgorithmNotSupported,`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({algorithm:e,key:r}){var n;let i=(n=r?.alg)!==null&&n!==void 0?n:e,o=r?.crv;for(let s of Object.keys(Iz)){let a=Iz[s].names;if(i&&a.includes(i))return s;if(o&&a.includes(o))return s}throw new at(nt.AlgorithmNotSupported,`Algorithm not supported based on provided input: alg=${i}, crv=${o}. Please check the documentation for the list of supported algorithms.`)}};f();f();f();var TB={protocol:"http://identity.foundation/protocols/web5/identity-store",published:!1,types:{portableDid:{schema:"https://identity.foundation/schemas/web5/portable-did",dataFormats:["application/json"]},identityMetadata:{schema:"https://identity.foundation/schemas/web5/identity-metadata",dataFormats:["application/json"]}},structure:{portableDid:{},identityMetadata:{}}},m1e={protocol:"http://identity.foundation/protocols/web5/jwk-store",published:!1,types:{privateJwk:{schema:"https://identity.foundation/schemas/web5/private-jwk",dataFormats:["application/json"]}},structure:{privateJwk:{}}};f();function R3(t){return!(!t||typeof t!="object"||t===null)&&"uri"in t&&"document"in t&&"metadata"in t&&(!("keyManager"in t)||t.keyManager===void 0)}f();var Z_=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Snt=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Ns="^",AB=class extends oi{constructor(){super(),this._predefinedKeys=new Map,this._keyGenerator=this._predefinedKeys.keys()}addPredefinedKeys({privateKeys:e}){var r;return Z_(this,void 0,void 0,function*(){let n={};for(let i of e){(r=i.kid)!==null&&r!==void 0||(i.kid=yield vt({jwk:i}));let o=yield this.getKeyUri({key:i});n[o]=i}this._predefinedKeys=new Map(Object.entries(n)),this._keyGenerator=this._predefinedKeys.keys()})}exportKey({keyUri:e}){return Z_(this,void 0,void 0,function*(){let r=this._predefinedKeys.get(e);if(!r)throw new Error(`DeterministicKeyGenerator.exportKey: Key not found: ${e}`);return r})}generateKey(e){return Z_(this,void 0,void 0,function*(){let{value:r,done:n}=this._keyGenerator.next();if(n)throw new Error("Ran out of predefined keys");return r})}getPublicKey({keyUri:e}){return Z_(this,void 0,void 0,function*(){let r=this._predefinedKeys.get(e);if(!r)throw new Error(`DeterministicKeyGenerator.getPublicKey: Key not found: ${e}`);let{d:n}=r;return Snt(r,["d"])})}sign({keyUri:e,data:r}){return Z_(this,void 0,void 0,function*(){let n=this._predefinedKeys.get(e);if(!n)throw new Error(`DeterministicKeyGenerator.sign: Key not found: ${e}`);return yield en.sign({data:r,key:n})})}};function Qf({agent:t,tenant:e,didUri:r}){return Z_(this,void 0,void 0,function*(){if(e)return e;if(t.agentDid)return t.agentDid.uri;if(!r)throw new Error("Failed to determine tenant DID: 'agent.agentDid', 'tenant', and 'didUri' are undefined");return r})}f();var kB=xt(f0(),1);var bd=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},R0=class{constructor(){this.name="DwnDataStore",this._cache=new zf.default({ttl:(0,kB.default)("15 minutes"),max:100}),this._index=new zf.default({ttl:(0,kB.default)("21 days"),max:1e3}),this._protocolInitializedCache=new zf.default({ttl:(0,kB.default)("21 days"),max:1e3}),this._recordProperties={dataFormat:"application/json"}}delete({id:e,agent:r,tenant:n}){return bd(this,void 0,void 0,function*(){let i=yield Qf({agent:r,tenant:n,didUri:e}),o=yield this.lookupRecordId({id:e,tenantDid:i,agent:r});if(!o)return!1;let{reply:{status:s}}=yield r.dwn.processRequest({author:i,target:i,messageType:Ct.RecordsDelete,messageParams:{recordId:o}});if(s.code===202)return this._index.delete(`${i}${Ns}${e}`),this._cache.delete(o),!0;throw new Error(`${this.name}: Failed to delete '${e}' from store: (${s.code}) ${s.detail}`)})}get({id:e,agent:r,tenant:n,useCache:i=!1}){return bd(this,void 0,void 0,function*(){let o=yield Qf({agent:r,tenant:n,didUri:e}),s=yield this.lookupRecordId({id:e,tenantDid:o,agent:r});if(s)return yield this.getRecord({recordId:s,tenantDid:o,agent:r,useCache:i})})}list({agent:e,tenant:r}){return bd(this,void 0,void 0,function*(){let n=yield Qf({tenant:r,agent:e});return yield this.getAllRecords({agent:e,tenantDid:n})})}set({id:e,data:r,tenant:n,agent:i,preventDuplicates:o=!0,useCache:s=!1}){return bd(this,void 0,void 0,function*(){let a=yield Qf({agent:i,tenant:n,didUri:e});if(yield this.initialize({tenant:a,agent:i}),o&&(yield this.lookupRecordId({id:e,tenantDid:a,agent:i})))throw new Error(`${this.name}: Import failed due to duplicate entry for: ${e}`);let d=le.object(r).toUint8Array(),{message:u,reply:{status:c}}=yield i.dwn.processRequest({author:a,target:a,messageType:Ct.RecordsWrite,messageParams:Object.assign({},this._recordProperties),dataStream:new Blob([d],{type:"application/json"})});if(!(u&&c.code===202))throw new Error(`${this.name}: Failed to write data to store for ${e}: ${c.detail}`);this._index.set(`${a}${Ns}${e}`,u.recordId),s&&this._cache.set(u.recordId,r)})}initialize({tenant:e,agent:r}){return bd(this,void 0,void 0,function*(){let n=yield Qf({agent:r,tenant:e});if(this._protocolInitializedCache.has(n))return;let{reply:{status:i,entries:o}}=yield r.dwn.processRequest({author:n,target:n,messageType:Ct.ProtocolsQuery,messageParams:{filter:{protocol:this._recordProtocolDefinition.protocol}}});if(i.code!==200)throw new Error(`Failed to query for protocols: ${i.code} - ${i.detail}`);o?.length===0&&(yield this.installProtocol(n,r)),this._protocolInitializedCache.set(n,!0)})}getAllRecords(e){return bd(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DwnDataStore must implement getAllRecords()")})}getRecord({recordId:e,tenantDid:r,agent:n,useCache:i}){var o;return bd(this,void 0,void 0,function*(){if(i){let d=this._cache.get(e);if(d)return d}let{reply:s}=yield n.dwn.processRequest({author:r,target:r,messageType:Ct.RecordsRead,messageParams:{filter:{recordId:e}}});if(!(!((o=s.record)===null||o===void 0)&&o.data))throw new Error(`${this.name}: Failed to read data from DWN for: ${e}`);let a=yield Mp.consumeToJson({readable:s.record.data});return i&&this._cache.set(e,a),a})}installProtocol(e,r){return bd(this,void 0,void 0,function*(){let{reply:{status:n}}=yield r.dwn.processRequest({author:e,target:e,messageType:Ct.ProtocolsConfigure,messageParams:{definition:this._recordProtocolDefinition}});if(n.code!==202)throw new Error(`Failed to install protocol: ${n.code} - ${n.detail}`)})}lookupRecordId({id:e,tenantDid:r,agent:n}){return bd(this,void 0,void 0,function*(){let i=this._index.get(`${r}${Ns}${e}`,{updateAgeOnGet:!0});return i||(yield this.getAllRecords({agent:n,tenantDid:r}),i=this._index.get(`${r}${Ns}${e}`)),i})}},B0=class{constructor(){this.name="InMemoryDataStore",this.store=new Map}delete({id:e,agent:r,tenant:n}){return bd(this,void 0,void 0,function*(){let i=yield Qf({agent:r,tenant:n,didUri:e});return this.store.has(`${i}${Ns}${e}`)?(this.store.delete(`${i}${Ns}${e}`),!0):!1})}get({id:e,agent:r,tenant:n}){return bd(this,void 0,void 0,function*(){let i=yield Qf({agent:r,tenant:n,didUri:e});return this.store.get(`${i}${Ns}${e}`)})}list({agent:e,tenant:r}){return bd(this,void 0,void 0,function*(){let n=yield Qf({tenant:r,agent:e}),i=[];for(let[o,s]of this.store.entries())o.startsWith(`${n}${Ns}`)&&i.push(s);return i})}set({id:e,data:r,tenant:n,agent:i,preventDuplicates:o}){return bd(this,void 0,void 0,function*(){let s=yield Qf({agent:i,tenant:n,didUri:e});if(o&&this.store.has(`${s}${Ns}${e}`))throw new Error(`${this.name}: Import failed due to duplicate entry for: ${e}`);let a=structuredClone(r);this.store.set(`${s}${Ns}${e}`,a)})}};var Zp=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},B3=class extends R0{constructor(){super(...arguments),this.name="DwnDidStore",this._recordProtocolDefinition=TB,this._recordProperties={dataFormat:"application/json",protocol:this._recordProtocolDefinition.protocol,protocolPath:"portableDid",schema:this._recordProtocolDefinition.types.portableDid.schema}}delete(e){let r=Object.create(null,{delete:{get:()=>super.delete}});return Zp(this,void 0,void 0,function*(){return yield r.delete.call(this,e)})}get(e){let r=Object.create(null,{get:{get:()=>super.get}});return Zp(this,void 0,void 0,function*(){return yield r.get.call(this,e)})}list(e){let r=Object.create(null,{list:{get:()=>super.list}});return Zp(this,void 0,void 0,function*(){return yield r.list.call(this,e)})}set(e){let r=Object.create(null,{set:{get:()=>super.set}});return Zp(this,void 0,void 0,function*(){return yield r.set.call(this,e)})}getAllRecords({agent:e,tenantDid:r}){var n;return Zp(this,void 0,void 0,function*(){this._index.clear();let{reply:i}=yield e.dwn.processRequest({author:r,target:r,messageType:Ct.RecordsQuery,messageParams:{filter:Object.assign({},this._recordProperties)}}),o=[];for(let s of(n=i.entries)!==null&&n!==void 0?n:[]){if(!s.encodedData)throw new Error(`${this.name}: Expected 'encodedData' to be present in the DWN query result entry`);let a=le.base64Url(s.encodedData).toObject();if(R3(a)){let d=`${r}${Ns}${a.uri}`;this._index.set(d,s.recordId),this._cache.set(s.recordId,a),o.push(a)}}return o})}},O3=class extends B0{constructor(){super(...arguments),this.name="InMemoryDidStore"}delete(e){let r=Object.create(null,{delete:{get:()=>super.delete}});return Zp(this,void 0,void 0,function*(){return yield r.delete.call(this,e)})}get(e){let r=Object.create(null,{get:{get:()=>super.get}});return Zp(this,void 0,void 0,function*(){return yield r.get.call(this,e)})}list(e){let r=Object.create(null,{list:{get:()=>super.list}});return Zp(this,void 0,void 0,function*(){return yield r.list.call(this,e)})}set(e){let r=Object.create(null,{set:{get:()=>super.set}});return Zp(this,void 0,void 0,function*(){return yield r.set.call(this,e)})}};var O0=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},PB;(function(t){t.Create="Create",t.Resolve="Resolve"})(PB||(PB={}));function g1e(t,e){return t.messageType===e}var M3=class extends G_{constructor({agent:e,didMethods:r,resolverCache:n,store:i}){if(!r)throw new TypeError("AgentDidApi: Required parameter missing: 'didMethods'");super({didResolvers:r,cache:n??new Fb({agent:e,location:"DATA/AGENT/DID_CACHE"})}),this._didMethods=new Map,this._agent=e,this._store=i??new O3;for(let o of r)this._didMethods.set(o.methodName,o)}get agent(){if(this._agent===void 0)throw new Error("AgentDidApi: Unable to determine agent execution context.");return this._agent}set agent(e){this._agent=e,"agent"in this.cache&&(this.cache.agent=e)}create({method:e,tenant:r,options:n,store:i}){return O0(this,void 0,void 0,function*(){let s=yield this.getMethod(e).create({keyManager:this.agent.keyManager,options:n});if(i??!0){let{uri:a,document:d,metadata:u}=s,c={uri:a,document:d,metadata:u};yield this._store.set({id:c.uri,data:c,agent:this.agent,tenant:r??c.uri,preventDuplicates:!1,useCache:!0})}return s})}export({didUri:e,tenant:r}){return O0(this,void 0,void 0,function*(){let n=yield this.get({didUri:e,tenant:r});if(!n)throw new Error(`AgentDidApi: Failed to export due to DID not found: ${e}`);return yield n.export()})}get({didUri:e,tenant:r}){return O0(this,void 0,void 0,function*(){let n=yield this._store.get({id:e,agent:this.agent,tenant:r,useCache:!0});return n?yield _o.import({portableDid:n,keyManager:this.agent.keyManager}):void 0})}getSigningMethod({didUri:e,methodId:r}){return O0(this,void 0,void 0,function*(){let n=cr.parse(e);if(!n)throw new Error(`Invalid DID URI: ${e}`);let i=this.getMethod(n.method),{didDocument:o,didResolutionMetadata:s}=yield this.resolve(e);if(!o)throw new Error(`DID resolution failed for '${e}': ${JSON.stringify(s)}`);return yield i.getSigningMethod({didDocument:o,methodId:r})})}import({portableDid:e,tenant:r}){return O0(this,void 0,void 0,function*(){let n=yield _o.import({keyManager:this.agent.keyManager,portableDid:e}),{uri:i,document:o,metadata:s}=n,a={uri:i,document:o,metadata:s};return yield this._store.set({id:a.uri,data:a,agent:this.agent,tenant:r??a.uri,preventDuplicates:!0,useCache:!0}),n})}delete({didUri:e,tenant:r,deleteKey:n=!0}){return O0(this,void 0,void 0,function*(){let i=yield this._store.get({id:e,agent:this.agent,tenant:r,useCache:!1});if(!i)throw new Error("AgentDidApi: Could not delete, DID not found");yield this._store.delete({id:e,agent:this.agent,tenant:r}),n&&(yield this.deleteKeys({portableDid:i}))})}deleteKeys({portableDid:e}){return O0(this,void 0,void 0,function*(){for(let r of e.document.verificationMethod||[]){if(!r.publicKeyJwk)continue;let n=yield this.agent.keyManager.getKeyUri({key:r.publicKeyJwk});yield this.agent.keyManager.deleteKey({keyUri:n})}})}processRequest(e){var r;return O0(this,void 0,void 0,function*(){if(g1e(e,PB.Create))try{let n=yield this.create(Object.assign({},e.messageParams));return{result:{uri:n.uri,document:n.document,metadata:n.metadata},ok:!0,status:{code:201,message:"Created"}}}catch(n){return{ok:!1,status:{code:500,message:(r=n.message)!==null&&r!==void 0?r:"Unknown error occurred"}}}if(g1e(e,PB.Resolve)){let{didUri:n,options:i}=e.messageParams;return{result:yield this.resolve(n,i),ok:!0,status:{code:200,message:"OK"}}}throw new Error(`AgentDidApi: Unsupported request type: ${e.messageType}`)})}getMethod(e){let r=this._didMethods.get(e);if(r===void 0)throw new Error(`DID Method not supported: ${e}`);return r}};f();f();f();f();var Ant=new Uint8Array([7,4,13,1,10,6,15,3,12,0,9,5,2,14,11,8]),b1e=Uint8Array.from({length:16},(t,e)=>e),knt=b1e.map(t=>(9*t+5)%16),Bz=[b1e],Oz=[knt];for(let t=0;t<4;t++)for(let e of[Bz,Oz])e.push(e[t].map(r=>Ant[r]));var w1e=[[11,14,15,12,5,8,7,9,11,13,14,15,6,7,9,8],[12,13,11,15,6,9,9,7,12,15,11,13,7,8,7,7],[13,15,14,11,7,7,6,8,13,14,13,12,5,5,6,9],[14,11,12,14,8,6,5,5,15,12,15,14,9,9,8,6],[15,12,13,13,9,5,8,6,14,11,12,11,8,6,5,5]].map(t=>new Uint8Array(t)),Pnt=Bz.map((t,e)=>t.map(r=>w1e[e][r])),Int=Oz.map((t,e)=>t.map(r=>w1e[e][r])),Rnt=new Uint32Array([0,1518500249,1859775393,2400959708,2840853838]),Bnt=new Uint32Array([1352829926,1548603684,1836072691,2053994217,0]),IB=(t,e)=>t<<e|t>>>32-e;function v1e(t,e,r,n){return t===0?e^r^n:t===1?e&r|~e&n:t===2?(e|~r)^n:t===3?e&n|r&~n:e^(r|~n)}var RB=new Uint32Array(16),Rz=class extends Xm{constructor(){super(64,20,8,!0),this.h0=1732584193,this.h1=-271733879,this.h2=-1732584194,this.h3=271733878,this.h4=-1009589776}get(){let{h0:e,h1:r,h2:n,h3:i,h4:o}=this;return[e,r,n,i,o]}set(e,r,n,i,o){this.h0=e|0,this.h1=r|0,this.h2=n|0,this.h3=i|0,this.h4=o|0}process(e,r){for(let y=0;y<16;y++,r+=4)RB[y]=e.getUint32(r,!0);let n=this.h0|0,i=n,o=this.h1|0,s=o,a=this.h2|0,d=a,u=this.h3|0,c=u,l=this.h4|0,h=l;for(let y=0;y<5;y++){let g=4-y,v=Rnt[y],x=Bnt[y],S=Bz[y],A=Oz[y],T=Pnt[y],$=Int[y];for(let j=0;j<16;j++){let K=IB(n+v1e(y,o,a,u)+RB[S[j]]+v,T[j])+l|0;n=l,l=u,u=IB(a,10)|0,a=o,o=K}for(let j=0;j<16;j++){let K=IB(i+v1e(g,s,d,c)+RB[A[j]]+x,$[j])+h|0;i=h,h=c,c=IB(d,10)|0,d=s,s=K}}this.set(this.h1+a+c|0,this.h2+u+h|0,this.h3+l+i|0,this.h4+n+s|0,this.h0+o+d|0)}roundClean(){RB.fill(0)}destroy(){this.destroyed=!0,this.buffer.fill(0),this.set(0,0,0,0,0)}},_1e=a_(()=>new Rz);var Ont=k5("ed25519 seed"),Mz=2147483648,x1e=new Uint8Array([0]);function E1e(t,...e){return typeof t=="string"&&(t=pge(t)),xp(t,...e),t}var Mnt=t=>_1e(ya(t)),Dnt=t=>Sp(t).getUint32(0,!1),Dz=t=>{if(!Number.isSafeInteger(t)||t<0||t>2**32-1)throw new Error(`Invalid number=${t}. Should be from 0 to 2 ** 32 - 1`);let e=new Uint8Array(4);return Sp(e).setUint32(0,t,!1),e},BB=class t{get publicKeyRaw(){return zn.getPublicKey(this.privateKey)}get publicKey(){return gb(x1e,this.publicKeyRaw)}get pubHash(){return Mnt(this.publicKey)}get fingerprint(){return Dnt(this.pubHash)}get fingerprintHex(){return tF(Dz(this.fingerprint))}get parentFingerprintHex(){return tF(Dz(this.parentFingerprint))}static fromMasterSeed(e){if(e=E1e(e),8*e.length<128||8*e.length>512)throw new Error(`HDKey: wrong seed length=${e.length}. Should be between 128 and 512 bits; 256 bits is advised)`);let r=t0(i0,Ont,e);return new t({privateKey:r.slice(0,32),chainCode:r.slice(32)})}constructor(e){if(this.depth=0,this.index=0,this.parentFingerprint=0,!e||typeof e!="object")throw new Error("HDKey.constructor must not be called directly");if(xp(e.privateKey,32),xp(e.chainCode,32),this.depth=e.depth||0,this.index=e.index||0,this.parentFingerprint=e.parentFingerprint||0,!this.depth&&(this.parentFingerprint||this.index))throw new Error("HDKey: zero depth with non-zero index/parent fingerprint");this.chainCode=e.chainCode,this.privateKey=e.privateKey}derive(e,r=!1){if(!/^[mM]'?/.test(e))throw new Error('Path must start with "m" or "M"');if(/^[mM]'?$/.test(e))return this;let n=e.replace(/^[mM]'?\//,"").split("/"),i=this;for(let o of n){let s=/^(\d+)('?)$/.exec(o);if(!s||s.length!==3)throw new Error(`Invalid child index: ${o}`);let a=+s[1];if(!Number.isSafeInteger(a)||a>=Mz)throw new Error("Invalid index");(r||s[2]==="'")&&(a+=Mz),i=i.deriveChild(a)}return i}deriveChild(e){if(e<Mz)throw new Error(`Non-hardened child derivation not possible for Ed25519 (index=${e})`);let r=gb(x1e,this.privateKey,Dz(e)),n=t0(i0,this.chainCode,r);return new t({chainCode:n.slice(32),depth:this.depth+1,parentFingerprint:this.fingerprint,index:e,privateKey:n.slice(0,32)})}sign(e){return zn.sign(e,this.privateKey)}verify(e,r){return r=E1e(r,64),zn.verify(r,e,this.publicKeyRaw)}};f();var Cz=`abandon
ability
able
about
above
absent
absorb
abstract
absurd
abuse
access
accident
account
accuse
achieve
acid
acoustic
acquire
across
act
action
actor
actress
actual
adapt
add
addict
address
adjust
admit
adult
advance
advice
aerobic
affair
afford
afraid
again
age
agent
agree
ahead
aim
air
airport
aisle
alarm
album
alcohol
alert
alien
all
alley
allow
almost
alone
alpha
already
also
alter
always
amateur
amazing
among
amount
amused
analyst
anchor
ancient
anger
angle
angry
animal
ankle
announce
annual
another
answer
antenna
antique
anxiety
any
apart
apology
appear
apple
approve
april
arch
arctic
area
arena
argue
arm
armed
armor
army
around
arrange
arrest
arrive
arrow
art
artefact
artist
artwork
ask
aspect
assault
asset
assist
assume
asthma
athlete
atom
attack
attend
attitude
attract
auction
audit
august
aunt
author
auto
autumn
average
avocado
avoid
awake
aware
away
awesome
awful
awkward
axis
baby
bachelor
bacon
badge
bag
balance
balcony
ball
bamboo
banana
banner
bar
barely
bargain
barrel
base
basic
basket
battle
beach
bean
beauty
because
become
beef
before
begin
behave
behind
believe
below
belt
bench
benefit
best
betray
better
between
beyond
bicycle
bid
bike
bind
biology
bird
birth
bitter
black
blade
blame
blanket
blast
bleak
bless
blind
blood
blossom
blouse
blue
blur
blush
board
boat
body
boil
bomb
bone
bonus
book
boost
border
boring
borrow
boss
bottom
bounce
box
boy
bracket
brain
brand
brass
brave
bread
breeze
brick
bridge
brief
bright
bring
brisk
broccoli
broken
bronze
broom
brother
brown
brush
bubble
buddy
budget
buffalo
build
bulb
bulk
bullet
bundle
bunker
burden
burger
burst
bus
business
busy
butter
buyer
buzz
cabbage
cabin
cable
cactus
cage
cake
call
calm
camera
camp
can
canal
cancel
candy
cannon
canoe
canvas
canyon
capable
capital
captain
car
carbon
card
cargo
carpet
carry
cart
case
cash
casino
castle
casual
cat
catalog
catch
category
cattle
caught
cause
caution
cave
ceiling
celery
cement
census
century
cereal
certain
chair
chalk
champion
change
chaos
chapter
charge
chase
chat
cheap
check
cheese
chef
cherry
chest
chicken
chief
child
chimney
choice
choose
chronic
chuckle
chunk
churn
cigar
cinnamon
circle
citizen
city
civil
claim
clap
clarify
claw
clay
clean
clerk
clever
click
client
cliff
climb
clinic
clip
clock
clog
close
cloth
cloud
clown
club
clump
cluster
clutch
coach
coast
coconut
code
coffee
coil
coin
collect
color
column
combine
come
comfort
comic
common
company
concert
conduct
confirm
congress
connect
consider
control
convince
cook
cool
copper
copy
coral
core
corn
correct
cost
cotton
couch
country
couple
course
cousin
cover
coyote
crack
cradle
craft
cram
crane
crash
crater
crawl
crazy
cream
credit
creek
crew
cricket
crime
crisp
critic
crop
cross
crouch
crowd
crucial
cruel
cruise
crumble
crunch
crush
cry
crystal
cube
culture
cup
cupboard
curious
current
curtain
curve
cushion
custom
cute
cycle
dad
damage
damp
dance
danger
daring
dash
daughter
dawn
day
deal
debate
debris
decade
december
decide
decline
decorate
decrease
deer
defense
define
defy
degree
delay
deliver
demand
demise
denial
dentist
deny
depart
depend
deposit
depth
deputy
derive
describe
desert
design
desk
despair
destroy
detail
detect
develop
device
devote
diagram
dial
diamond
diary
dice
diesel
diet
differ
digital
dignity
dilemma
dinner
dinosaur
direct
dirt
disagree
discover
disease
dish
dismiss
disorder
display
distance
divert
divide
divorce
dizzy
doctor
document
dog
doll
dolphin
domain
donate
donkey
donor
door
dose
double
dove
draft
dragon
drama
drastic
draw
dream
dress
drift
drill
drink
drip
drive
drop
drum
dry
duck
dumb
dune
during
dust
dutch
duty
dwarf
dynamic
eager
eagle
early
earn
earth
easily
east
easy
echo
ecology
economy
edge
edit
educate
effort
egg
eight
either
elbow
elder
electric
elegant
element
elephant
elevator
elite
else
embark
embody
embrace
emerge
emotion
employ
empower
empty
enable
enact
end
endless
endorse
enemy
energy
enforce
engage
engine
enhance
enjoy
enlist
enough
enrich
enroll
ensure
enter
entire
entry
envelope
episode
equal
equip
era
erase
erode
erosion
error
erupt
escape
essay
essence
estate
eternal
ethics
evidence
evil
evoke
evolve
exact
example
excess
exchange
excite
exclude
excuse
execute
exercise
exhaust
exhibit
exile
exist
exit
exotic
expand
expect
expire
explain
expose
express
extend
extra
eye
eyebrow
fabric
face
faculty
fade
faint
faith
fall
false
fame
family
famous
fan
fancy
fantasy
farm
fashion
fat
fatal
father
fatigue
fault
favorite
feature
february
federal
fee
feed
feel
female
fence
festival
fetch
fever
few
fiber
fiction
field
figure
file
film
filter
final
find
fine
finger
finish
fire
firm
first
fiscal
fish
fit
fitness
fix
flag
flame
flash
flat
flavor
flee
flight
flip
float
flock
floor
flower
fluid
flush
fly
foam
focus
fog
foil
fold
follow
food
foot
force
forest
forget
fork
fortune
forum
forward
fossil
foster
found
fox
fragile
frame
frequent
fresh
friend
fringe
frog
front
frost
frown
frozen
fruit
fuel
fun
funny
furnace
fury
future
gadget
gain
galaxy
gallery
game
gap
garage
garbage
garden
garlic
garment
gas
gasp
gate
gather
gauge
gaze
general
genius
genre
gentle
genuine
gesture
ghost
giant
gift
giggle
ginger
giraffe
girl
give
glad
glance
glare
glass
glide
glimpse
globe
gloom
glory
glove
glow
glue
goat
goddess
gold
good
goose
gorilla
gospel
gossip
govern
gown
grab
grace
grain
grant
grape
grass
gravity
great
green
grid
grief
grit
grocery
group
grow
grunt
guard
guess
guide
guilt
guitar
gun
gym
habit
hair
half
hammer
hamster
hand
happy
harbor
hard
harsh
harvest
hat
have
hawk
hazard
head
health
heart
heavy
hedgehog
height
hello
helmet
help
hen
hero
hidden
high
hill
hint
hip
hire
history
hobby
hockey
hold
hole
holiday
hollow
home
honey
hood
hope
horn
horror
horse
hospital
host
hotel
hour
hover
hub
huge
human
humble
humor
hundred
hungry
hunt
hurdle
hurry
hurt
husband
hybrid
ice
icon
idea
identify
idle
ignore
ill
illegal
illness
image
imitate
immense
immune
impact
impose
improve
impulse
inch
include
income
increase
index
indicate
indoor
industry
infant
inflict
inform
inhale
inherit
initial
inject
injury
inmate
inner
innocent
input
inquiry
insane
insect
inside
inspire
install
intact
interest
into
invest
invite
involve
iron
island
isolate
issue
item
ivory
jacket
jaguar
jar
jazz
jealous
jeans
jelly
jewel
job
join
joke
journey
joy
judge
juice
jump
jungle
junior
junk
just
kangaroo
keen
keep
ketchup
key
kick
kid
kidney
kind
kingdom
kiss
kit
kitchen
kite
kitten
kiwi
knee
knife
knock
know
lab
label
labor
ladder
lady
lake
lamp
language
laptop
large
later
latin
laugh
laundry
lava
law
lawn
lawsuit
layer
lazy
leader
leaf
learn
leave
lecture
left
leg
legal
legend
leisure
lemon
lend
length
lens
leopard
lesson
letter
level
liar
liberty
library
license
life
lift
light
like
limb
limit
link
lion
liquid
list
little
live
lizard
load
loan
lobster
local
lock
logic
lonely
long
loop
lottery
loud
lounge
love
loyal
lucky
luggage
lumber
lunar
lunch
luxury
lyrics
machine
mad
magic
magnet
maid
mail
main
major
make
mammal
man
manage
mandate
mango
mansion
manual
maple
marble
march
margin
marine
market
marriage
mask
mass
master
match
material
math
matrix
matter
maximum
maze
meadow
mean
measure
meat
mechanic
medal
media
melody
melt
member
memory
mention
menu
mercy
merge
merit
merry
mesh
message
metal
method
middle
midnight
milk
million
mimic
mind
minimum
minor
minute
miracle
mirror
misery
miss
mistake
mix
mixed
mixture
mobile
model
modify
mom
moment
monitor
monkey
monster
month
moon
moral
more
morning
mosquito
mother
motion
motor
mountain
mouse
move
movie
much
muffin
mule
multiply
muscle
museum
mushroom
music
must
mutual
myself
mystery
myth
naive
name
napkin
narrow
nasty
nation
nature
near
neck
need
negative
neglect
neither
nephew
nerve
nest
net
network
neutral
never
news
next
nice
night
noble
noise
nominee
noodle
normal
north
nose
notable
note
nothing
notice
novel
now
nuclear
number
nurse
nut
oak
obey
object
oblige
obscure
observe
obtain
obvious
occur
ocean
october
odor
off
offer
office
often
oil
okay
old
olive
olympic
omit
once
one
onion
online
only
open
opera
opinion
oppose
option
orange
orbit
orchard
order
ordinary
organ
orient
original
orphan
ostrich
other
outdoor
outer
output
outside
oval
oven
over
own
owner
oxygen
oyster
ozone
pact
paddle
page
pair
palace
palm
panda
panel
panic
panther
paper
parade
parent
park
parrot
party
pass
patch
path
patient
patrol
pattern
pause
pave
payment
peace
peanut
pear
peasant
pelican
pen
penalty
pencil
people
pepper
perfect
permit
person
pet
phone
photo
phrase
physical
piano
picnic
picture
piece
pig
pigeon
pill
pilot
pink
pioneer
pipe
pistol
pitch
pizza
place
planet
plastic
plate
play
please
pledge
pluck
plug
plunge
poem
poet
point
polar
pole
police
pond
pony
pool
popular
portion
position
possible
post
potato
pottery
poverty
powder
power
practice
praise
predict
prefer
prepare
present
pretty
prevent
price
pride
primary
print
priority
prison
private
prize
problem
process
produce
profit
program
project
promote
proof
property
prosper
protect
proud
provide
public
pudding
pull
pulp
pulse
pumpkin
punch
pupil
puppy
purchase
purity
purpose
purse
push
put
puzzle
pyramid
quality
quantum
quarter
question
quick
quit
quiz
quote
rabbit
raccoon
race
rack
radar
radio
rail
rain
raise
rally
ramp
ranch
random
range
rapid
rare
rate
rather
raven
raw
razor
ready
real
reason
rebel
rebuild
recall
receive
recipe
record
recycle
reduce
reflect
reform
refuse
region
regret
regular
reject
relax
release
relief
rely
remain
remember
remind
remove
render
renew
rent
reopen
repair
repeat
replace
report
require
rescue
resemble
resist
resource
response
result
retire
retreat
return
reunion
reveal
review
reward
rhythm
rib
ribbon
rice
rich
ride
ridge
rifle
right
rigid
ring
riot
ripple
risk
ritual
rival
river
road
roast
robot
robust
rocket
romance
roof
rookie
room
rose
rotate
rough
round
route
royal
rubber
rude
rug
rule
run
runway
rural
sad
saddle
sadness
safe
sail
salad
salmon
salon
salt
salute
same
sample
sand
satisfy
satoshi
sauce
sausage
save
say
scale
scan
scare
scatter
scene
scheme
school
science
scissors
scorpion
scout
scrap
screen
script
scrub
sea
search
season
seat
second
secret
section
security
seed
seek
segment
select
sell
seminar
senior
sense
sentence
series
service
session
settle
setup
seven
shadow
shaft
shallow
share
shed
shell
sheriff
shield
shift
shine
ship
shiver
shock
shoe
shoot
shop
short
shoulder
shove
shrimp
shrug
shuffle
shy
sibling
sick
side
siege
sight
sign
silent
silk
silly
silver
similar
simple
since
sing
siren
sister
situate
six
size
skate
sketch
ski
skill
skin
skirt
skull
slab
slam
sleep
slender
slice
slide
slight
slim
slogan
slot
slow
slush
small
smart
smile
smoke
smooth
snack
snake
snap
sniff
snow
soap
soccer
social
sock
soda
soft
solar
soldier
solid
solution
solve
someone
song
soon
sorry
sort
soul
sound
soup
source
south
space
spare
spatial
spawn
speak
special
speed
spell
spend
sphere
spice
spider
spike
spin
spirit
split
spoil
sponsor
spoon
sport
spot
spray
spread
spring
spy
square
squeeze
squirrel
stable
stadium
staff
stage
stairs
stamp
stand
start
state
stay
steak
steel
stem
step
stereo
stick
still
sting
stock
stomach
stone
stool
story
stove
strategy
street
strike
strong
struggle
student
stuff
stumble
style
subject
submit
subway
success
such
sudden
suffer
sugar
suggest
suit
summer
sun
sunny
sunset
super
supply
supreme
sure
surface
surge
surprise
surround
survey
suspect
sustain
swallow
swamp
swap
swarm
swear
sweet
swift
swim
swing
switch
sword
symbol
symptom
syrup
system
table
tackle
tag
tail
talent
talk
tank
tape
target
task
taste
tattoo
taxi
teach
team
tell
ten
tenant
tennis
tent
term
test
text
thank
that
theme
then
theory
there
they
thing
this
thought
three
thrive
throw
thumb
thunder
ticket
tide
tiger
tilt
timber
time
tiny
tip
tired
tissue
title
toast
tobacco
today
toddler
toe
together
toilet
token
tomato
tomorrow
tone
tongue
tonight
tool
tooth
top
topic
topple
torch
tornado
tortoise
toss
total
tourist
toward
tower
town
toy
track
trade
traffic
tragic
train
transfer
trap
trash
travel
tray
treat
tree
trend
trial
tribe
trick
trigger
trim
trip
trophy
trouble
truck
true
truly
trumpet
trust
truth
try
tube
tuition
tumble
tuna
tunnel
turkey
turn
turtle
twelve
twenty
twice
twin
twist
two
type
typical
ugly
umbrella
unable
unaware
uncle
uncover
under
undo
unfair
unfold
unhappy
uniform
unique
unit
universe
unknown
unlock
until
unusual
unveil
update
upgrade
uphold
upon
upper
upset
urban
urge
usage
use
used
useful
useless
usual
utility
vacant
vacuum
vague
valid
valley
valve
van
vanish
vapor
various
vast
vault
vehicle
velvet
vendor
venture
venue
verb
verify
version
very
vessel
veteran
viable
vibrant
vicious
victory
video
view
village
vintage
violin
virtual
virus
visa
visit
visual
vital
vivid
vocal
voice
void
volcano
volume
vote
voyage
wage
wagon
wait
walk
wall
walnut
want
warfare
warm
warrior
wash
wasp
waste
water
wave
way
wealth
weapon
wear
weasel
weather
web
wedding
weekend
weird
welcome
west
wet
whale
what
wheat
wheel
when
where
whip
whisper
wide
width
wife
wild
will
win
window
wine
wing
wink
winner
winter
wire
wisdom
wise
wish
witness
wolf
woman
wonder
wood
wool
word
work
world
worry
worth
wrap
wreck
wrestle
wrist
write
wrong
yard
year
yellow
you
young
youth
zebra
zero
zone
zoo`.split(`
`);f();f();function Cnt(t,e,r,n){zI(t);let i=mge({dkLen:32,asyncTick:10},n),{c:o,dkLen:s,asyncTick:a}=i;if(Ym(o),Ym(s),Ym(a),o<1)throw new Error("PBKDF2: iterations (c) should be >= 1");let d=Zm(e),u=Zm(r),c=new Uint8Array(s),l=t0.create(t,d),h=l._cloneInto().update(u);return{c:o,dkLen:s,asyncTick:a,DK:c,PRF:l,PRFSalt:h}}function jnt(t,e,r,n,i){return t.destroy(),e.destroy(),n&&n.destroy(),i.fill(0),r}async function S1e(t,e,r,n){let{c:i,dkLen:o,asyncTick:s,DK:a,PRF:d,PRFSalt:u}=Cnt(t,e,r,n),c,l=new Uint8Array(4),h=Sp(l),y=new Uint8Array(d.outputLen);for(let g=1,v=0;v<o;g++,v+=d.outputLen){let x=a.subarray(v,v+d.outputLen);h.setInt32(0,g,!1),(c=u._cloneInto(c)).update(l).digestInto(y),x.set(y.subarray(0,x.length)),await yge(i-1,s,()=>{d._cloneInto(c).update(y).digestInto(y);for(let S=0;S<x.length;S++)x[S]^=y[S]})}return jnt(d,u,a,c,y)}f();function Wb(t){if(!Number.isSafeInteger(t))throw new Error(`Wrong integer: ${t}`)}function OB(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}function $nt(...t){let e=o=>o,r=(o,s)=>a=>o(s(a)),n=t.map(o=>o.encode).reduceRight(r,e),i=t.map(o=>o.decode).reduce(r,e);return{encode:n,decode:i}}function Nnt(t){return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("alphabet.encode input should be an array of numbers");return e.map(r=>{if(r<0||r>=t.length)throw new Error(`Digit index outside alphabet: ${r} (alphabet: ${t.length})`);return t[r]})},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("alphabet.decode input should be array of strings");return e.map(r=>{if(typeof r!="string")throw new Error(`alphabet.decode: not string element=${r}`);let n=t.indexOf(r);if(n===-1)throw new Error(`Unknown letter: "${r}". Allowed: ${t}`);return n})}}}function Unt(t=""){if(typeof t!="string")throw new Error("join separator should be string");return{encode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="string")throw new Error("join.encode input should be array of strings");for(let r of e)if(typeof r!="string")throw new Error(`join.encode: non-string input=${r}`);return e.join(t)},decode:e=>{if(typeof e!="string")throw new Error("join.decode input should be string");return e.split(t)}}}function Knt(t,e="="){if(typeof e!="string")throw new Error("padding chr should be string");return{encode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let n of r)if(typeof n!="string")throw new Error(`padding.encode: non-string input=${n}`);for(;r.length*t%8;)r.push(e);return r},decode(r){if(!Array.isArray(r)||r.length&&typeof r[0]!="string")throw new Error("padding.encode input should be array of strings");for(let i of r)if(typeof i!="string")throw new Error(`padding.decode: non-string input=${i}`);let n=r.length;if(n*t%8)throw new Error("Invalid padding: string should have whole number of bytes");for(;n>0&&r[n-1]===e;n--)if(!((n-1)*t%8))throw new Error("Invalid padding: string has too much padding");return r.slice(0,n)}}}function jz(t,e,r){if(e<2)throw new Error(`convertRadix: wrong from=${e}, base cannot be less than 2`);if(r<2)throw new Error(`convertRadix: wrong to=${r}, base cannot be less than 2`);if(!Array.isArray(t))throw new Error("convertRadix: data should be array");if(!t.length)return[];let n=0,i=[],o=Array.from(t);for(o.forEach(s=>{if(s<0||s>=e)throw new Error(`Wrong integer: ${s}`)});;){let s=0,a=!0;for(let d=n;d<o.length;d++){let u=o[d],c=e*s+u;if(!Number.isSafeInteger(c)||e*s/e!==s||c-u!==e*s)throw new Error("convertRadix: carry overflow");s=c%r;let l=Math.floor(c/r);if(o[d]=l,!Number.isSafeInteger(l)||l*r+s!==c)throw new Error("convertRadix: carry overflow");if(a)l?a=!1:n=d;else continue}if(i.push(s),a)break}for(let s=0;s<t.length-1&&t[s]===0;s++)i.push(0);return i.reverse()}var T1e=(t,e)=>e?T1e(e,t%e):t,MB=(t,e)=>t+(e-T1e(t,e));function $z(t,e,r,n){if(!Array.isArray(t))throw new Error("convertRadix2: data should be array");if(e<=0||e>32)throw new Error(`convertRadix2: wrong from=${e}`);if(r<=0||r>32)throw new Error(`convertRadix2: wrong to=${r}`);if(MB(e,r)>32)throw new Error(`convertRadix2: carry overflow from=${e} to=${r} carryBits=${MB(e,r)}`);let i=0,o=0,s=2**r-1,a=[];for(let d of t){if(d>=2**e)throw new Error(`convertRadix2: invalid data word=${d} from=${e}`);if(i=i<<e|d,o+e>32)throw new Error(`convertRadix2: carry overflow pos=${o} from=${e}`);for(o+=e;o>=r;o-=r)a.push((i>>o-r&s)>>>0);i&=2**o-1}if(i=i<<r-o&s,!n&&o>=e)throw new Error("Excess padding");if(!n&&i)throw new Error(`Non-zero padding: ${i}`);return n&&o>0&&a.push(i>>>0),a}function qnt(t){return{encode:e=>{if(!OB(e))throw new Error("radix.encode input should be Uint8Array");return jz(Array.from(e),2**8,t)},decode:e=>{if(!Array.isArray(e)||e.length&&typeof e[0]!="number")throw new Error("radix.decode input should be array of numbers");return Uint8Array.from(jz(e,t,2**8))}}}function Lnt(t,e=!1){if(t<=0||t>32)throw new Error("radix2: bits should be in (0..32]");if(MB(8,t)>32||MB(t,8)>32)throw new Error("radix2: carry overflow");return{encode:r=>{if(!OB(r))throw new Error("radix2.encode input should be Uint8Array");return $z(Array.from(r),8,t,!e)},decode:r=>{if(!Array.isArray(r)||r.length&&typeof r[0]!="number")throw new Error("radix2.decode input should be array of numbers");return Uint8Array.from($z(r,t,8,e))}}}function Fnt(t,e){if(typeof e!="function")throw new Error("checksum fn should be function");return{encode(r){if(!OB(r))throw new Error("checksum.encode: input should be Uint8Array");let n=e(r).slice(0,t),i=new Uint8Array(r.length+t);return i.set(r),i.set(n,r.length),i},decode(r){if(!OB(r))throw new Error("checksum.decode: input should be Uint8Array");let n=r.slice(0,-t),i=e(n).slice(0,t),o=r.slice(-t);for(let s=0;s<t;s++)if(i[s]!==o[s])throw new Error("Invalid checksum");return n}}}var D3={alphabet:Nnt,chain:$nt,checksum:Fnt,convertRadix:jz,convertRadix2:$z,radix:qnt,radix2:Lnt,join:Unt,padding:Knt};var znt=t=>t[0]==="\u3042\u3044\u3053\u304F\u3057\u3093";function A1e(t){if(typeof t!="string")throw new TypeError(`Invalid mnemonic type: ${typeof t}`);return t.normalize("NFKD")}function k1e(t){let e=A1e(t),r=e.split(" ");if(![12,15,18,21,24].includes(r.length))throw new Error("Invalid mnemonic");return{nfkd:e,words:r}}function P1e(t){xp(t,16,20,24,28,32)}function I1e(t,e=128){if(Ym(e),e%32!==0||e>256)throw new TypeError("Invalid entropy");return Wnt(Tp(e/8),t)}var Vnt=t=>{let e=8-t.length/4;return new Uint8Array([ya(t)[0]>>e<<e])};function R1e(t){if(!Array.isArray(t)||t.length!==2048||typeof t[0]!="string")throw new Error("Wordlist: expected array of 2048 strings");return t.forEach(e=>{if(typeof e!="string")throw new Error(`Wordlist: non-string element: ${e}`)}),D3.chain(D3.checksum(1,Vnt),D3.radix2(11,!0),D3.alphabet(t))}function Hnt(t,e){let{words:r}=k1e(t),n=R1e(e).decode(r);return P1e(n),n}function Wnt(t,e){return P1e(t),R1e(e).encode(t).join(znt(e)?"\u3000":" ")}function B1e(t,e){try{Hnt(t,e)}catch{return!1}return!0}var Gnt=t=>A1e(`mnemonic${t}`);function O1e(t,e=""){return S1e(i0,k1e(t).nfkd,Gnt(e),{c:2048,dkLen:64})}f();f();var Xp=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},C3=class extends R0{constructor(){super(...arguments),this.name="DwnKeyStore",this._recordProtocolDefinition=m1e,this._recordProperties={dataFormat:"application/json",protocol:this._recordProtocolDefinition.protocol,protocolPath:"privateJwk",schema:this._recordProtocolDefinition.types.privateJwk.schema}}delete(e){let r=Object.create(null,{delete:{get:()=>super.delete}});return Xp(this,void 0,void 0,function*(){return yield r.delete.call(this,e)})}get(e){let r=Object.create(null,{get:{get:()=>super.get}});return Xp(this,void 0,void 0,function*(){return yield r.get.call(this,e)})}set(e){let r=Object.create(null,{set:{get:()=>super.set}});return Xp(this,void 0,void 0,function*(){yield r.set.call(this,e)})}list(e){let r=Object.create(null,{list:{get:()=>super.list}});return Xp(this,void 0,void 0,function*(){return yield r.list.call(this,e)})}getAllRecords({agent:e,tenantDid:r}){var n;return Xp(this,void 0,void 0,function*(){this._index.clear();let{reply:i}=yield e.dwn.processRequest({author:r,target:r,messageType:Ct.RecordsQuery,messageParams:{filter:Object.assign({},this._recordProperties)}}),o=[];for(let s of(n=i.entries)!==null&&n!==void 0?n:[]){if(!s.encodedData)throw new Error(`${this.name}: Expected 'encodedData' to be present in the DWN query result entry`);let a=le.base64Url(s.encodedData).toObject();if(H_(a)){let d=`${r}${Ns}${Nb}${a.kid}`;this._index.set(d,s.recordId),this._cache.set(s.recordId,a),o.push(a)}}return o})}},j3=class extends B0{constructor(){super(...arguments),this.name="InMemoryKeyStore"}delete(e){let r=Object.create(null,{delete:{get:()=>super.delete}});return Xp(this,void 0,void 0,function*(){return yield r.delete.call(this,e)})}get(e){let r=Object.create(null,{get:{get:()=>super.get}});return Xp(this,void 0,void 0,function*(){return yield r.get.call(this,e)})}list(e){let r=Object.create(null,{list:{get:()=>super.list}});return Xp(this,void 0,void 0,function*(){return yield r.list.call(this,e)})}set(e){let r=Object.create(null,{set:{get:()=>super.set}});return Xp(this,void 0,void 0,function*(){return yield r.set.call(this,e)})}};var wd=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},M1e=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Nz={"AES-GCM":{implementation:cB,names:["A128GCM","A192GCM","A256GCM"]},"AES-KW":{implementation:Y_,names:["A128KW","A192KW","A256KW"]},Ed25519:{implementation:Kb,names:["Ed25519"]},secp256k1:{implementation:S0,names:["ES256K","secp256k1"]},secp256r1:{implementation:S0,names:["ES256","secp256r1"]},"SHA-256":{implementation:_0,names:["SHA-256"]}},bu=class{constructor({agent:e,keyStore:r}={}){this._algorithmInstances=new Map,this._agent=e,this._keyStore=r??new j3}get agent(){if(this._agent===void 0)throw new Error("LocalKeyManager: Unable to determine agent execution context.");return this._agent}set agent(e){this._agent=e}decrypt(e){var{keyUri:r}=e,n=M1e(e,["keyUri"]);return wd(this,void 0,void 0,function*(){let i=yield this.getPrivateKey({keyUri:r}),o=this.getAlgorithmName({key:i});return yield this.getAlgorithm({algorithm:o}).decrypt(Object.assign({key:i},n))})}digest(e){throw new Error("Method not implemented.")}encrypt(e){var{keyUri:r}=e,n=M1e(e,["keyUri"]);return wd(this,void 0,void 0,function*(){let i=yield this.getPrivateKey({keyUri:r}),o=this.getAlgorithmName({key:i});return yield this.getAlgorithm({algorithm:o}).encrypt(Object.assign({key:i},n))})}exportKey({keyUri:e}){return wd(this,void 0,void 0,function*(){return yield this.getPrivateKey({keyUri:e})})}generateKey({algorithm:e}){var r;return wd(this,void 0,void 0,function*(){let n=this.getAlgorithmName({key:{alg:e}}),o=yield this.getAlgorithm({algorithm:n}).generateKey({algorithm:e});(r=o.kid)!==null&&r!==void 0||(o.kid=yield vt({jwk:o}));let s=yield this.getKeyUri({key:o});return yield this._keyStore.set({id:s,data:o,agent:this.agent,preventDuplicates:!1,useCache:!0}),s})}getKeyUri({key:e}){return wd(this,void 0,void 0,function*(){let r=yield vt({jwk:e});return`${Nb}${r}`})}getPublicKey({keyUri:e}){return wd(this,void 0,void 0,function*(){let r=yield this.getPrivateKey({keyUri:e}),n=this.getAlgorithmName({key:r});return yield this.getAlgorithm({algorithm:n}).getPublicKey({key:r})})}importKey({key:e}){var r;return wd(this,void 0,void 0,function*(){if(!H_(e))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");let n=structuredClone(e);(r=n.kid)!==null&&r!==void 0||(n.kid=yield vt({jwk:n}));let i=yield this.getKeyUri({key:n});return yield this._keyStore.set({id:i,data:n,agent:this.agent,preventDuplicates:!0,useCache:!0}),i})}sign({keyUri:e,data:r}){return wd(this,void 0,void 0,function*(){let n=yield this.getPrivateKey({keyUri:e}),i=this.getAlgorithmName({key:n});return this.getAlgorithm({algorithm:i}).sign({data:r,key:n})})}unwrapKey({wrappedKeyBytes:e,wrappedKeyAlgorithm:r,decryptionKeyUri:n}){return wd(this,void 0,void 0,function*(){let i=yield this.getPrivateKey({keyUri:n}),o=this.getAlgorithmName({key:i});return yield this.getAlgorithm({algorithm:o}).unwrapKey({wrappedKeyBytes:e,wrappedKeyAlgorithm:r,decryptionKey:i})})}verify({key:e,signature:r,data:n}){return wd(this,void 0,void 0,function*(){let i=this.getAlgorithmName({key:e});return this.getAlgorithm({algorithm:i}).verify({key:e,signature:r,data:n})})}wrapKey({unwrappedKey:e,encryptionKeyUri:r}){return wd(this,void 0,void 0,function*(){let n=yield this.getPrivateKey({keyUri:r}),i=this.getAlgorithmName({key:n});return yield this.getAlgorithm({algorithm:i}).wrapKey({unwrappedKey:e,encryptionKey:n})})}deleteKey({keyUri:e}){return wd(this,void 0,void 0,function*(){if(!(yield this._keyStore.get({id:e,agent:this.agent,useCache:!0})))throw new Error(`Key not found: ${e}`);yield this._keyStore.delete({id:e,agent:this.agent})})}getAlgorithm({algorithm:e}){var r;let n=(r=Nz[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new at(nt.AlgorithmNotSupported,`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){let r=e.alg,n=e.crv;for(let i of Object.keys(Nz)){let o=Nz[i].names;if(r&&o.includes(r))return i;if(n&&o.includes(n))return i}throw new at(nt.AlgorithmNotSupported,`Algorithm not supported based on provided input: alg=${r}, crv=${n}. Please check the documentation for the list of supported algorithms.`)}getPrivateKey({keyUri:e}){return wd(this,void 0,void 0,function*(){let r=yield this._keyStore.get({id:e,agent:this.agent,useCache:!0});if(!r)throw new Error(`Key not found: ${e}`);return r})}};f();f();var D1e=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};function N3(t){return typeof t=="object"&&t!==null&&"alg"in t&&t.alg!==void 0&&"enc"in t&&t.enc!==void 0}var $3=class{static decrypt({key:e,encryptedKey:r,joseHeader:n,crypto:i}){return D1e(this,void 0,void 0,function*(){switch(n.alg){case"dir":{if(r!==void 0)throw new at(nt.InvalidJwe,'JWE "encrypted_key" is not allowed when using "dir" (Direct Encryption Mode).');if(e instanceof Uint8Array)throw new at(nt.InvalidJwe,'Key management "key" must be a Key URI or JWK when using "dir" (Direct Encryption Mode).');return e}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(typeof n.p2c!="number")throw new at(nt.InvalidJwe,'JOSE Header "p2c" (PBES2 Count) is missing or not a number.');if(typeof n.p2s!="string")throw new at(nt.InvalidJwe,'JOSE Header "p2s" (PBES2 salt) is missing or not a string.');if(!(e instanceof Uint8Array))throw new at(nt.InvalidJwe,'Key management "key" must be a Uint8Array when using "PBES2" (Key Encryption Mode).');if(r===void 0)throw new at(nt.InvalidJwe,'JWE "encrypted_key" is required when using "PBES2" (Key Encryption Mode).');let o;try{o=new Uint8Array([...le.string(n.alg).toUint8Array(),0,...le.base64Url(n.p2s).toUint8Array()])}catch{throw new at(nt.EncodingError,'Failed to decode the JOSE Header "p2s" (PBES2 salt) value.')}let s=yield i.deriveKey({algorithm:n.alg,baseKeyBytes:e,iterations:n.p2c,salt:o});if(!(s.alg&&["A128KW","A192KW","A256KW"].includes(s.alg)))throw new at(nt.AlgorithmNotSupported,`Unsupported Key Encryption Algorithm (alg) value: ${s.alg}`);return yield i.unwrapKey({decryptionKey:s,wrappedKeyBytes:r,wrappedKeyAlgorithm:n.enc})}default:throw new at(nt.AlgorithmNotSupported,`Unsupported "alg" (Algorithm) Header Parameter value: ${n.alg}`)}})}static encrypt({key:e,joseHeader:r,crypto:n}){return D1e(this,void 0,void 0,function*(){let i,o;switch(r.alg){case"dir":{if(o!==void 0)throw new at(nt.InvalidJwe,'JWE "encrypted_key" is not allowed when using "dir" (Direct Encryption Mode).');if(e instanceof Uint8Array)throw new at(nt.InvalidJwe,'Key management "key" must be a Key URI or JWK when using "dir" (Direct Encryption Mode).');i=e;break}case"PBES2-HS256+A128KW":case"PBES2-HS384+A192KW":case"PBES2-HS512+A256KW":{if(typeof r.p2c!="number")throw new at(nt.InvalidJwe,'JOSE Header "p2c" (PBES2 Count) is missing or not a number.');if(typeof r.p2s!="string")throw new at(nt.InvalidJwe,'JOSE Header "p2s" (PBES2 salt) is missing or not a string.');if(!(e instanceof Uint8Array))throw new at(nt.InvalidJwe,'Key management "key" must be a Uint8Array when using "PBES2" (Key Encryption Mode).');i=yield n.generateKey({algorithm:r.enc});let s;try{s=new Uint8Array([...le.string(r.alg).toUint8Array(),0,...le.base64Url(r.p2s).toUint8Array()])}catch{throw new at(nt.EncodingError,'Failed to decode the JOSE Header "p2s" (PBES2 salt) value.')}let a=yield n.deriveKey({algorithm:r.alg,baseKeyBytes:e,iterations:r.p2c,salt:s});o=yield n.wrapKey({encryptionKey:a,unwrappedKey:i});break}default:throw new at(nt.AlgorithmNotSupported,`Unsupported "alg" (Algorithm) Header Parameter value: ${r.alg}`)}return{cek:i,encryptedKey:o}})}};f();f();function U3(t){return t!==null&&typeof t=="object"&&"encrypt"in t&&typeof t.encrypt=="function"&&"decrypt"in t&&typeof t.decrypt=="function"}f();function Uz(...t){let e=new Set,r=t.filter(Boolean);for(let n of r)for(let i in n){if(e.has(i))return!0;e.add(i)}return!1}var C1e=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};function Kz(t,e){if(e!==void 0)try{if(typeof e!="string")throw new Error;return le.base64Url(e).toUint8Array()}catch{throw new at(nt.InvalidJwe,`Failed to decode the JWE Header parameter '${t}' from Base64 URL format to Uint8Array. Ensure the value is properly encoded in Base64 URL format without padding.`)}}var K3=class t{constructor(e){this.ciphertext="",Object.assign(this,e)}static decrypt({jwe:e,key:r,keyManager:n=new oi,crypto:i=new vd,options:o={}}){var s,a;return C1e(this,void 0,void 0,function*(){if(!U3(i))throw new at(nt.OperationNotSupported,'Crypto API does not support the "encrypt" operation.');if(!U3(n))throw new at(nt.OperationNotSupported,'Key Manager does not support the "decrypt" operation.');if(!e.protected&&!e.header&&!e.unprotected)throw new at(nt.InvalidJwe,'JWE is missing the required JOSE header parameters. Please provide at least one of the following: "protected", "header", or "unprotected"');if(typeof e.ciphertext!="string")throw new at(nt.InvalidJwe,"JWE Ciphertext is missing or not a string.");let d;if(e.protected)try{d=le.base64Url(e.protected).toObject()}catch{throw new Error("JWE Protected Header is invalid")}if(Uz(d,e.header,e.unprotected))throw new Error('Duplicate properties detected. Please ensure that each parameter is defined only once across the JWE "header", "protected", and "unprotected" objects.');let u=Object.assign(Object.assign(Object.assign({},d),e.header),e.unprotected);if(!N3(u))throw new Error('JWE Header is missing required "alg" (Algorithm) and/or "enc" (Encryption) Header Parameters');if(Array.isArray(o.allowedAlgValues)&&!o.allowedAlgValues.includes(u.alg))throw new Error(`"alg" (Algorithm) Header Parameter value not allowed: ${u.alg}`);if(Array.isArray(o.allowedEncValues)&&!o.allowedEncValues.includes(u.enc))throw new Error(`"enc" (Encryption Algorithm) Header Parameter value not allowed: ${u.enc}`);let c;try{let x=e.encrypted_key?le.base64Url(e.encrypted_key).toUint8Array():void 0;c=yield $3.decrypt({key:r,encryptedKey:x,joseHeader:u,keyManager:n,crypto:i})}catch(x){if(x instanceof at&&(x.code===nt.InvalidJwe||x.code===nt.AlgorithmNotSupported))throw x;c=typeof r=="string"?yield n.generateKey({algorithm:u.enc}):yield i.generateKey({algorithm:u.enc})}let l=Kz("iv",e.iv),h=Kz("tag",e.tag),y=h!==void 0?new Uint8Array([...le.base64Url(e.ciphertext).toUint8Array(),...h??[]]):le.base64Url(e.ciphertext).toUint8Array(),g=e.aad!==void 0?new Uint8Array([...le.string((s=e.protected)!==null&&s!==void 0?s:"").toUint8Array(),...le.string(".").toUint8Array(),...le.string(e.aad).toUint8Array()]):le.string((a=e.protected)!==null&&a!==void 0?a:"").toUint8Array();return{plaintext:typeof c=="string"?yield n.decrypt({keyUri:c,data:y,iv:l,additionalData:g}):yield i.decrypt({key:c,data:y,iv:l,additionalData:g}),protectedHeader:d,additionalAuthenticatedData:Kz("aad",e.aad),sharedUnprotectedHeader:e.unprotected,unprotectedHeader:e.header}})}static encrypt({key:e,plaintext:r,additionalAuthenticatedData:n,protectedHeader:i,sharedUnprotectedHeader:o,unprotectedHeader:s,keyManager:a=new oi,crypto:d=new vd}){return C1e(this,void 0,void 0,function*(){if(!U3(d))throw new at(nt.OperationNotSupported,'Crypto API does not support the "encrypt" operation.');if(!U3(a))throw new at(nt.OperationNotSupported,'Key Manager does not support the "decrypt" operation.');if(!i&&!o&&!s)throw new at(nt.InvalidJwe,'JWE is missing the required JOSE header parameters. Please provide at least one of the following: "protectedHeader", "sharedUnprotectedHeader", or "unprotectedHeader"');if(!(r instanceof Uint8Array))throw new at(nt.InvalidJwe,"Plaintext is missing or not a byte array.");if(Uz(i,o,s))throw new Error('Duplicate properties detected. Please ensure that each parameter is defined only once across the JWE "protectedHeader", "sharedUnprotectedHeader", and "unprotectedHeader" objects.');let u=Object.assign(Object.assign(Object.assign({},i),o),s);if(!N3(u))throw new Error('JWE Header is missing required "alg" (Algorithm) and/or "enc" (Encryption) Header Parameters');let{cek:c,encryptedKey:l}=yield $3.encrypt({key:e,joseHeader:u,keyManager:a,crypto:d}),h;switch(u.enc){case"A128GCM":case"A192GCM":case"A256GCM":h=ro.randomBytes(12);break;default:h=new Uint8Array(0)}let y=i?le.object(i).toBase64Url():"",g,v;n?(v=le.uint8Array(n).toBase64Url(),g=le.string(y+"."+v).toUint8Array()):g=le.string(y).toUint8Array();let x=typeof c=="string"?yield a.encrypt({keyUri:c,data:r,iv:h,additionalData:g}):yield d.encrypt({key:c,data:r,iv:h,additionalData:g}),S=x.slice(0,-16),A=x.slice(-16),T=new t({ciphertext:le.uint8Array(S).toBase64Url()});return l&&(T.encrypted_key=le.uint8Array(l).toBase64Url()),i&&(T.protected=y),o&&(T.unprotected=o),s&&(T.header=s),h&&(T.iv=le.uint8Array(h).toBase64Url()),v&&(T.aad=v),A&&(T.tag=le.uint8Array(A).toBase64Url()),T})}};var j1e=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Qp=class{static decrypt({jwe:e,key:r,keyManager:n=new oi,crypto:i=new vd,options:o={}}){return j1e(this,void 0,void 0,function*(){if(typeof e!="string")throw new at(nt.InvalidJwe,"Invalid JWE format. JWE must be a string.");let{0:s,1:a,2:d,3:u,4:c,length:l}=e.split(".");if(l!==5)throw new at(nt.InvalidJwe,"Invalid JWE format. JWE must have 5 parts.");let h=yield K3.decrypt({jwe:{ciphertext:u,encrypted_key:a||void 0,iv:d||void 0,protected:s,tag:c||void 0},key:r,keyManager:n,crypto:i,options:o});if(!N3(h.protectedHeader))throw new at(nt.InvalidJwe,"Decrypt operation failed due to missing or malformed JWE Protected Header");return{plaintext:h.plaintext,protectedHeader:h.protectedHeader}})}static encrypt({plaintext:e,protectedHeader:r,key:n,keyManager:i=new oi,crypto:o=new vd,options:s={}}){return j1e(this,void 0,void 0,function*(){let a=yield K3.encrypt({plaintext:e,protectedHeader:r,key:n,keyManager:i,crypto:o,options:s});return[a.protected,a.encrypted_key,a.iv,a.ciphertext,a.tag].join(".")})}};var wu=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};function $1e(t){return typeof t!="string"||t.trim().length===0}function Jnt(t){return typeof t=="object"&&t!==null&&"dateCreated"in t&&typeof t.dateCreated=="string"&&"size"in t&&typeof t.size=="number"&&"data"in t&&typeof t.data=="string"}function Ynt(t){return typeof t=="object"&&t!==null&&"initialized"in t&&typeof t.initialized=="boolean"&&"lastBackup"in t&&"lastRestore"in t}var q3=class{constructor({keyDerivationWorkFactor:e,store:r}={}){this.crypto=new vd,this._keyDerivationWorkFactor=e??21e4,this._store=r??new xb}backup(){return wu(this,void 0,void 0,function*(){if(this.isLocked()||(yield this.isInitialized())===!1)throw new Error("HdIdentityVault: Unable to proceed with the backup operation because the identity vault has not been initialized and unlocked. Please ensure the vault is properly initialized with a secure password before attempting to backup its contents.");let e={did:yield this.getStoredDid(),contentEncryptionKey:yield this.getStoredContentEncryptionKey(),status:yield this.getStatus()},r=le.object(e).toBase64Url(),n={data:r,dateCreated:new Date().toISOString(),size:r.length};return yield this.setStatus({lastBackup:n.dateCreated}),n})}changePassword({oldPassword:e,newPassword:r}){return wu(this,void 0,void 0,function*(){if((yield this.isInitialized())===!1)throw new Error("HdIdentityVault: Unable to proceed with the change password operation because the identity vault has not been initialized. Please ensure the vault is properly initialized with a secure password before trying again.");yield this.lock();let n=yield this.getStoredContentEncryptionKey(),i,o;try{let a;({plaintext:a,protectedHeader:i}=yield Qp.decrypt({jwe:n,key:le.string(e).toUint8Array(),crypto:this.crypto,keyManager:new bu})),o=le.uint8Array(a).toObject()}catch{throw new Error("HdIdentityVault: Unable to change the vault password due to an incorrectly entered old password.")}let s=yield Qp.encrypt({key:le.string(r).toUint8Array(),protectedHeader:i,plaintext:le.object(o).toUint8Array(),crypto:this.crypto,keyManager:new bu});yield this._store.set("contentEncryptionKey",s),this._contentEncryptionKey=o})}getDid(){return wu(this,void 0,void 0,function*(){if(this.isLocked())throw new Error("HdIdentityVault: Vault has not been initialized and unlocked.");let e=yield this.getStoredDid(),{plaintext:r}=yield Qp.decrypt({jwe:e,key:this._contentEncryptionKey,crypto:this.crypto,keyManager:new bu}),n=le.uint8Array(r).toObject();if(!R3(n))throw new Error("HdIdentityVault: Unable to decode malformed DID in identity vault");return yield _o.import({portableDid:n})})}getStatus(){return wu(this,void 0,void 0,function*(){let e=yield this._store.get("vaultStatus");if(!e)return{initialized:!1,lastBackup:null,lastRestore:null};let r=le.string(e).toObject();if(!Ynt(r))throw new Error("HdIdentityVault: Invalid IdentityVaultStatus object in store");return r})}initialize({password:e,recoveryPhrase:r}){return wu(this,void 0,void 0,function*(){if(yield this.isInitialized())throw new Error("HdIdentityVault: Vault has already been initialized.");if($1e(e))throw new Error(`HdIdentityVault: The password is required and cannot be blank. Please provide a ' +
        'valid, non-empty password.`);if(r&&$1e(r))throw new Error(`HdIdentityVault: The password is required and cannot be blank. Please provide a ' +
        'valid, non-empty password.`);if(r??(r=I1e(Cz,128)),!B1e(r,Cz))throw new Error("HdIdentityVault: The provided recovery phrase is invalid. Please ensure that the recovery phrase is a correctly formatted series of 12 words.");let n=yield O1e(r),i=BB.fromMasterSeed(n),o=i.derive("m/44'/0'/0'/0'/0'"),s=yield this.crypto.deriveKey({algorithm:"HKDF-512",baseKeyBytes:o.privateKey,salt:"",info:"vault_cek",derivedKeyAlgorithm:"A256GCM"}),a=yield this.crypto.deriveKeyBytes({algorithm:"HKDF-512",baseKeyBytes:o.publicKey,salt:"",info:"vault_unlock_salt",length:256}),d={alg:"PBES2-HS512+A256KW",enc:"A256GCM",cty:"text/plain",p2c:this._keyDerivationWorkFactor,p2s:le.uint8Array(a).toBase64Url()},u=yield Qp.encrypt({key:le.string(e).toUint8Array(),protectedHeader:d,plaintext:le.object(s).toUint8Array(),crypto:this.crypto,keyManager:new bu});yield this._store.set("contentEncryptionKey",u);let c=i.derive("m/44'/0'/1708523827'/0'/0'"),l=yield this.crypto.bytesToPrivateKey({algorithm:"Ed25519",privateKeyBytes:c.privateKey}),h=i.derive("m/44'/0'/1708523827'/0'/1'"),y=yield this.crypto.bytesToPrivateKey({algorithm:"Ed25519",privateKeyBytes:h.privateKey}),g=new AB;yield g.addPredefinedKeys({privateKeys:[l,y]});let x=yield(yield Zf.create({keyManager:g,options:{verificationMethods:[{algorithm:"Ed25519",id:"sig",purposes:["assertionMethod","authentication"]}]}})).export(),S={alg:"dir",enc:"A256GCM",cty:"json"},A=yield Qp.encrypt({key:s,plaintext:le.object(x).toUint8Array(),protectedHeader:S,crypto:this.crypto,keyManager:new bu});return yield this._store.set("did",A),this._contentEncryptionKey=s,yield this.setStatus({initialized:!0}),r})}isInitialized(){return wu(this,void 0,void 0,function*(){return this.getStatus().then(({initialized:e})=>e)})}isLocked(){return!this._contentEncryptionKey}lock(){return wu(this,void 0,void 0,function*(){if((yield this.isInitialized())===!1)throw new Error("HdIdentityVault: Lock operation failed. Vault has not been initialized.");this._contentEncryptionKey&&(this._contentEncryptionKey.k=""),this._contentEncryptionKey=void 0})}restore({backup:e,password:r}){return wu(this,void 0,void 0,function*(){if(!Jnt(e))throw new Error("HdIdentityVault: Restore operation failed due to invalid backup object.");let n,i,o;try{o=yield this.getStoredDid(),i=yield this.getStoredContentEncryptionKey(),n=yield this.getStatus()}catch{throw new Error("HdIdentityVault: The restore operation cannot proceed because the existing vault contents are missing or inaccessible. If the problem persists consider re-initializing the vault and retrying the restore.")}try{let s=le.base64Url(e.data).toObject();yield this._store.set("did",s.did),yield this._store.set("contentEncryptionKey",s.contentEncryptionKey),yield this.setStatus(s.status),yield this.unlock({password:r})}catch{throw yield this.setStatus(n),yield this._store.set("contentEncryptionKey",i),yield this._store.set("did",o),new Error("HdIdentityVault: Restore operation failed due to invalid backup data or an incorrect password. Please verify the password is correct for the provided backup and try again.")}yield this.setStatus({lastRestore:new Date().toISOString()})})}unlock({password:e}){return wu(this,void 0,void 0,function*(){yield this.lock();let r=yield this.getStoredContentEncryptionKey();try{let{plaintext:n}=yield Qp.decrypt({jwe:r,key:le.string(e).toUint8Array(),crypto:this.crypto,keyManager:new bu}),i=le.uint8Array(n).toObject();this._contentEncryptionKey=i}catch{throw new Error("HdIdentityVault: Unable to unlock the vault due to an incorrect password.")}})}getStoredDid(){return wu(this,void 0,void 0,function*(){let e=yield this._store.get("did");if(!e)throw new Error("HdIdentityVault: Unable to retrieve the DID record from the vault. Please check the vault status and if the problem persists consider re-initializing the vault and restoring the contents from a previous backup.");return e})}getStoredContentEncryptionKey(){return wu(this,void 0,void 0,function*(){let e=yield this._store.get("contentEncryptionKey");if(!e)throw new Error("HdIdentityVault: Unable to retrieve the Content Encryption Key record from the vault. Please check the vault status and if the problem persists consider re-initializing the vault and restoring the contents from a previous backup.");return e})}setStatus({initialized:e,lastBackup:r,lastRestore:n}){return wu(this,void 0,void 0,function*(){let i=yield this.getStatus();return i.initialized=e??i.initialized,i.lastBackup=r??i.lastBackup,i.lastRestore=n??i.lastRestore,yield this._store.set("vaultStatus",JSON.stringify(i)),!0})}};f();f();var ey=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};function Znt(t){return!(!t||typeof t!="object"||t===null)&&"name"in t}var L3=class extends R0{constructor(){super(...arguments),this.name="DwnIdentityStore",this._recordProtocolDefinition=TB,this._recordProperties={dataFormat:"application/json",protocol:this._recordProtocolDefinition.protocol,protocolPath:"identityMetadata",schema:this._recordProtocolDefinition.types.identityMetadata.schema}}delete(e){let r=Object.create(null,{delete:{get:()=>super.delete}});return ey(this,void 0,void 0,function*(){return yield r.delete.call(this,e)})}get(e){let r=Object.create(null,{get:{get:()=>super.get}});return ey(this,void 0,void 0,function*(){return yield r.get.call(this,e)})}set(e){let r=Object.create(null,{set:{get:()=>super.set}});return ey(this,void 0,void 0,function*(){return yield r.set.call(this,e)})}list(e){let r=Object.create(null,{list:{get:()=>super.list}});return ey(this,void 0,void 0,function*(){return yield r.list.call(this,e)})}getAllRecords({agent:e,tenantDid:r}){var n;return ey(this,void 0,void 0,function*(){this._index.clear();let{reply:i}=yield e.dwn.processRequest({author:r,target:r,messageType:Ct.RecordsQuery,messageParams:{filter:Object.assign({},this._recordProperties)}}),o=[];for(let s of(n=i.entries)!==null&&n!==void 0?n:[]){if(!s.encodedData)throw new Error(`${this.name}: Expected 'encodedData' to be present in the DWN query result entry`);let a=le.base64Url(s.encodedData).toObject();if(Znt(a)){let d=`${r}${Ns}${a.uri}`;this._index.set(d,s.recordId),this._cache.set(s.recordId,a),o.push(a)}}return o})}},F3=class extends B0{constructor(){super(...arguments),this.name="InMemoryIdentityStore"}delete(e){let r=Object.create(null,{delete:{get:()=>super.delete}});return ey(this,void 0,void 0,function*(){return yield r.delete.call(this,e)})}get(e){let r=Object.create(null,{get:{get:()=>super.get}});return ey(this,void 0,void 0,function*(){return yield r.get.call(this,e)})}list(e){let r=Object.create(null,{list:{get:()=>super.list}});return ey(this,void 0,void 0,function*(){return yield r.list.call(this,e)})}set(e){let r=Object.create(null,{set:{get:()=>super.set}});return ey(this,void 0,void 0,function*(){return yield r.set.call(this,e)})}};var ty=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})};var z3=class{constructor({agent:e,store:r}={}){this._agent=e,this._store=r??new F3}get agent(){if(this._agent===void 0)throw new Error("AgentIdentityApi: Unable to determine agent execution context.");return this._agent}set agent(e){this._agent=e}create({metadata:e,didMethod:r="dht",didOptions:n,store:i,tenant:o}){return ty(this,void 0,void 0,function*(){let s=yield this.agent.did.create({method:r,options:n,store:i,tenant:o}),a=new zb({did:s,metadata:Object.assign(Object.assign({},e),{uri:s.uri,tenant:o??s.uri})});return(i??!0)&&(yield this._store.set({id:a.did.uri,data:a.metadata,agent:this.agent,tenant:a.metadata.tenant,preventDuplicates:!1,useCache:!0})),a})}export({didUri:e,tenant:r}){return ty(this,void 0,void 0,function*(){let n=yield this.get({didUri:e,tenant:r});if(!n)throw new Error(`AgentIdentityApi: Failed to export due to Identity not found: ${e}`);return yield n.export()})}get({didUri:e,tenant:r}){return ty(this,void 0,void 0,function*(){let n=yield this._store.get({id:e,agent:this.agent,tenant:r,useCache:!0});if(!n)return;let i=yield this.agent.did.get({didUri:e,tenant:n.tenant});if(!i)throw new Error(`AgentIdentityApi: Identity is present in the store but DID is missing: ${e}`);return new zb({did:i,metadata:n})})}import({portableIdentity:e}){return ty(this,void 0,void 0,function*(){let r=yield this.agent.did.import({portableDid:e.portableDid,tenant:e.metadata.tenant});if(!r)throw new Error(`AgentIdentityApi: Failed to import Identity: ${e.metadata.uri}`);let n=new zb({did:r,metadata:e.metadata});return yield this._store.set({id:n.did.uri,data:n.metadata,agent:this.agent,tenant:n.metadata.tenant,preventDuplicates:!0,useCache:!0}),n})}list({tenant:e}={}){return ty(this,void 0,void 0,function*(){let r=yield this._store.list({agent:this.agent,tenant:e});return(yield Promise.all(r.map(i=>ty(this,void 0,void 0,function*(){return this.get({didUri:i.uri,tenant:i.tenant})})))).filter(i=>typeof i<"u")})}manage({portableIdentity:e}){return ty(this,void 0,void 0,function*(){let r=yield this.agent.did.get({didUri:e.metadata.uri,tenant:e.metadata.tenant});if(!r)throw new Error(`AgentIdentityApi: Failed to manage Identity: ${e.metadata.uri}`);let n=new zb({did:r,metadata:e.metadata});return yield this._store.set({id:n.did.uri,data:n.metadata,agent:this.agent,preventDuplicates:!0,useCache:!0}),n})}delete({didUri:e,tenant:r}){return ty(this,void 0,void 0,function*(){if(!(yield this._store.get({id:e,agent:this.agent,tenant:r,useCache:!0})))throw new Error(`AgentIdentityApi: Failed to purge due to Identity not found: ${e}`);yield this._store.delete({id:e,agent:this.agent,tenant:r})})}connectedIdentity({connectedDid:e}={}){return ty(this,void 0,void 0,function*(){let r=yield this.list();if(!(r.length<1))return e?r.find(n=>n.metadata.connectedDid===e):r.find(n=>n.metadata.connectedDid!==void 0)})}};f();f();var N1e;(function(t){t[t.InvalidRequest=-32600]="InvalidRequest",t[t.MethodNotFound=-32601]="MethodNotFound",t[t.InvalidParams=-32602]="InvalidParams",t[t.InternalError=-32603]="InternalError",t[t.ParseError=-32700]="ParseError",t[t.TransportError=-32300]="TransportError",t[t.BadRequest=-50400]="BadRequest",t[t.Unauthorized=-50401]="Unauthorized",t[t.Forbidden=-50403]="Forbidden",t[t.Conflict=-50409]="Conflict"})(N1e||(N1e={}));var X_=(t,e,r)=>({jsonrpc:"2.0",id:t,method:e,params:r}),DB=(t,e,r,n)=>({jsonrpc:"2.0",id:t,method:`rpc.subscribe.${e}`,params:n,subscription:{id:r}});function Q_(t){try{return JSON.parse(t)}catch{return null}}f();f();var U1e=xt(f0(),1);var V3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},CB=class{constructor({ttl:e="15m"}={}){this.cache=new zf.default({ttl:(0,U1e.default)(e)})}get(e){return V3(this,void 0,void 0,function*(){return this.cache.get(e)})}set(e,r){return V3(this,void 0,void 0,function*(){this.cache.set(e,r)})}delete(e){return V3(this,void 0,void 0,function*(){this.cache.delete(e)})}clear(){return V3(this,void 0,void 0,function*(){this.cache.clear()})}close(){return V3(this,void 0,void 0,function*(){})}};var K1e=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},jB=class{constructor(e){this.serverInfoCache=e??new CB}get transportProtocols(){return["http:","https:"]}sendDwnRequest(e){return K1e(this,void 0,void 0,function*(){let r=ro.randomUuid(),n=X_(r,"dwn.processMessage",{target:e.targetDid,message:e.message}),i={method:"POST",headers:{"dwn-request":JSON.stringify(n)}};e.data&&(i.headers["content-type"]="application/octet-stream",i.body=e.data);let o=yield fetch(e.dwnUrl,i),s,a,{headers:d}=o;if(d.has("dwn-response")){let c=Q_(d.get("dwn-response"));if(c==null)throw new Error(`failed to parse json rpc response. dwn url: ${e.dwnUrl}`);a=o.body,s=c}else{let c=yield o.text();s=JSON.parse(c)}if(s.error){let{code:c,message:l}=s.error;throw new Error(`(${c}) - ${l}`)}let{reply:u}=s.result;return a&&u.record?u.record.data=a:a&&u.entry&&(u.entry.data=a),u})}getServerInfo(e){return K1e(this,void 0,void 0,function*(){let r=yield this.serverInfoCache.get(e);if(r)return r;let n=new URL(e);n.pathname.endsWith("/")?n.pathname+="info":n.pathname+="/info";try{let i=yield fetch(n.toString());if(i.ok){let o=yield i.json(),s={registrationRequirements:o.registrationRequirements,maxFileSize:o.maxFileSize,webSocketSupport:o.webSocketSupport};return this.serverInfoCache.set(e,s),s}else throw new Error(`HTTP (${i.status}) - ${i.statusText}`)}catch(i){throw new Error(`Error encountered while processing response from ${n.toString()}: ${i.message}`)}})}};f();f();f();var ex=null;typeof WebSocket<"u"?ex=WebSocket:typeof MozWebSocket<"u"?ex=MozWebSocket:typeof globalThis<"u"?ex=globalThis.WebSocket||globalThis.MozWebSocket:typeof window<"u"?ex=window.WebSocket||window.MozWebSocket:typeof self<"u"&&(ex=self.WebSocket||self.MozWebSocket);var q1e=ex;var $B=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Xnt=3e3,Qnt=3e4,NB=class t{constructor(e,r){this.socket=e,this.responseTimeout=r,this.messageHandlers=new Map}static connect(e,r={}){return $B(this,void 0,void 0,function*(){let{connectTimeout:n=Xnt,responseTimeout:i=Qnt,onclose:o,onerror:s}=r,a=new q1e(e);return o?a.onclose=o:a.onclose=()=>{console.info(`JSON RPC Socket close ${e}`)},s?a.onerror=s:a.onerror=d=>{console.error(`JSON RPC Socket error ${e}`,d)},new Promise((d,u)=>{a.addEventListener("open",()=>{let c=new t(a,i);a.addEventListener("message",l=>{let h=Q_(l.data),y=c.messageHandlers.get(h.id);y&&y(l)}),d(c)}),a.addEventListener("error",c=>{u(c)}),setTimeout(()=>u,n)})})}close(){this.socket.close()}request(e){return $B(this,void 0,void 0,function*(){return new Promise((r,n)=>{var i;(i=e.id)!==null&&i!==void 0||(e.id=ro.randomUuid());let o=s=>{let a=Q_(s.data);if(a.id===e.id)return this.messageHandlers.delete(e.id),r(a)};this.messageHandlers.set(e.id,o),this.send(e),setTimeout(()=>{this.messageHandlers.delete(e.id),n(new Error("request timed out"))},this.responseTimeout)})})}subscribe(e,r){return $B(this,void 0,void 0,function*(){if(!e.method.startsWith("rpc.subscribe."))throw new Error("subscribe rpc requests must include the `rpc.subscribe` prefix");if(!e.subscription)throw new Error("subscribe rpc requests must include subscribe options");let n=e.subscription.id,i=a=>{let d=Q_(a.data.toString());d.id===n&&(d.error!==void 0&&(this.messageHandlers.delete(n),this.closeSubscription(n)),r(d))};this.messageHandlers.set(n,i);let o=yield this.request(e);return o.error?(this.messageHandlers.delete(n),{response:o}):{response:o,close:()=>$B(this,void 0,void 0,function*(){this.messageHandlers.delete(n),yield this.closeSubscription(n)})}})}closeSubscription(e){let r=ro.randomUuid(),n=DB(r,"close",e,{});return this.request(n)}send(e){this.socket.send(JSON.stringify(e))}};var qz=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},H3=class t{get transportProtocols(){return["ws:","wss:"]}sendDwnRequest(e,r){return qz(this,void 0,void 0,function*(){let n=new URL(e.dwnUrl);if(n.protocol!=="ws:"&&n.protocol!=="wss:")throw new Error(`Invalid websocket protocol ${n.protocol}`);if(!t.connections.has(n.host))try{let u=yield NB.connect(n.toString(),r),c=new Map;t.connections.set(n.host,{socket:u,subscriptions:c})}catch(u){throw new Error(`Error connecting to ${n.host}: ${u.message}`)}let o=t.connections.get(n.host),{targetDid:s,message:a,subscriptionHandler:d}=e;return d?t.subscriptionRequest(o,s,a,d):t.processMessage(o,s,a)})}static processMessage(e,r,n){return qz(this,void 0,void 0,function*(){let i=ro.randomUuid(),o=X_(i,"dwn.processMessage",{target:r,message:n}),{socket:s}=e,a=yield s.request(o),{error:d,result:u}=a;if(d!==void 0)throw new Error(`error sending DWN request: ${d.message}`);return u.reply})}static subscriptionRequest(e,r,n,i){return qz(this,void 0,void 0,function*(){let o=ro.randomUuid(),s=ro.randomUuid(),a=DB(o,"dwn.processMessage",s,{target:r,message:n}),{socket:d,subscriptions:u}=e,{response:c,close:l}=yield d.subscribe(a,v=>{let{result:x,error:S}=v;if(S){let T=u.get(s);T&&T.close(),u.delete(s);return}let{event:A}=x;i(A)}),{error:h,result:y}=c;if(h)throw new Error(`could not subscribe via jsonrpc socket: ${h.message}`);let{reply:g}=y;return g.subscription&&l&&(u.set(s,Object.assign(Object.assign({},g.subscription),{close:l})),g.subscription.close=l),g})}};H3.connections=new Map;var W3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},L1e;(function(t){t.Create="did.create",t.Resolve="did.resolve"})(L1e||(L1e={}));var G3=class{constructor(e=[]){this.transportClients=new Map,e=[new Lz,new Fz,...e];for(let r of e)for(let n of r.transportProtocols)this.transportClients.set(n,r)}get transportProtocols(){return Array.from(this.transportClients.keys())}sendDidRequest(e){return W3(this,void 0,void 0,function*(){let r=new URL(e.url),n=this.transportClients.get(r.protocol);if(!n){let i=new Error(`no ${r.protocol} transport client available`);throw i.name="NO_TRANSPORT_CLIENT",i}return n.sendDidRequest(e)})}sendDwnRequest(e){let r=new URL(e.dwnUrl),n=this.transportClients.get(r.protocol);if(!n){let i=new Error(`no ${r.protocol} transport client available`);throw i.name="NO_TRANSPORT_CLIENT",i}return n.sendDwnRequest(e)}getServerInfo(e){return W3(this,void 0,void 0,function*(){let r=new URL(e),n=this.transportClients.get(r.protocol);if(!n){let i=new Error(`no ${r.protocol} transport client available`);throw i.name="NO_TRANSPORT_CLIENT",i}return n.getServerInfo(e)})}},Lz=class extends jB{sendDidRequest(e){return W3(this,void 0,void 0,function*(){let r=ro.randomUuid(),n=X_(r,e.method,{data:e.data}),i=new Request(e.url,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),o;try{let s=yield fetch(i);if(s.ok){if(o=yield s.json(),o.error){let{code:a,message:d}=o.error;throw new Error(`JSON RPC (${a}) - ${d}`)}}else throw new Error(`HTTP (${s.status}) - ${s.statusText}`)}catch(s){throw new Error(`Error encountered while processing response from ${e.url}: ${s.message}`)}return o.result})}},Fz=class extends H3{sendDidRequest(e){return W3(this,void 0,void 0,function*(){throw new Error(`not implemented for transports [${this.transportProtocols.join(", ")}]`)})}getServerInfo(e){return W3(this,void 0,void 0,function*(){throw new Error(`not implemented for transports [${this.transportProtocols.join(", ")}]`)})}};f();var eit=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},J3=class{constructor({agent:e,syncEngine:r}){this._syncEngine=r,this._agent=e}get agent(){if(this._agent===void 0)throw new Error("AgentSyncApi: Unable to determine agent execution context.");return this._agent}set agent(e){this._agent=e,this._syncEngine.agent=e}registerIdentity(e){return eit(this,void 0,void 0,function*(){yield this._syncEngine.registerIdentity(e)})}sync(e){return this._syncEngine.sync(e)}startSync(e){return this._syncEngine.startSync(e)}stopSync(){this._syncEngine.stopSync()}};f();var F1e=xt(f0(),1),z1e=xt($5(),1);var Xa=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},tit=function(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],r;return e?e.call(t):(t=typeof __values=="function"?__values(t):t[Symbol.iterator](),r={},n("next"),n("throw"),n("return"),r[Symbol.asyncIterator]=function(){return this},r);function n(o){r[o]=t[o]&&function(s){return new Promise(function(a,d){s=t[o](s),i(a,d,s.done,s.value)})}}function i(o,s,a,d){Promise.resolve(d).then(function(u){o({value:u,done:a})},s)}},Y3=class t{constructor({agent:e,dataPath:r,db:n}){this._agent=e,this._cachedPermissionsApi=new T3({agent:e,cachedDefault:!0}),this._db=n||new z1e.Level(r??"DATA/AGENT/SYNC_STORE"),this._ulidFactory=nB()}get agent(){if(this._agent===void 0)throw new Error("SyncEngineLevel: Unable to determine agent execution context.");return this._agent}set agent(e){this._agent=e,this._cachedPermissionsApi=new T3({agent:e,cachedDefault:!0})}clear(){return Xa(this,void 0,void 0,function*(){yield this._cachedPermissionsApi.clear(),yield this._db.clear()})}close(){return Xa(this,void 0,void 0,function*(){yield this._db.close()})}pull(){var e;return Xa(this,void 0,void 0,function*(){let r=yield this.getSyncPeerState({syncDirection:"pull"});yield this.enqueueOperations({syncDirection:"pull",syncPeerState:r});let n=this.getPullQueue(),i=yield n.iterator().all(),o=[],s=new Set;for(let a of i){let[d]=a,{did:u,dwnUrl:c,messageCid:l,delegateDid:h,protocol:y}=t.parseSyncMessageParamsKey(d);if(s.has(c))continue;if(yield this.messageExists(u,l)){o.push({type:"del",key:d});continue}let v,x;if(h)try{v=(yield this._cachedPermissionsApi.getPermission({connectedDid:u,messageType:Ct.MessagesRead,delegateDid:h,protocol:y})).grant.id,x=h}catch(F){console.error("SyncEngineLevel: pull - Error fetching MessagesRead permission grant for delegate DID",F);continue}let S=yield this.agent.processDwnRequest({store:!1,author:u,target:u,messageType:Ct.MessagesRead,granteeDid:x,messageParams:{messageCid:l,permissionGrantId:v}}),A;try{A=yield this.agent.rpc.sendDwnRequest({dwnUrl:c,targetDid:u,message:S.message})}catch{s.add(c);continue}if(A.status.code!==200||!(!((e=A.entry)===null||e===void 0)&&e.message)){yield this.addMessage(u,l),o.push({type:"del",key:d});continue}let T=A.entry,$=T.message,j=Vb(T)&&T.data?Mp.fromWebReadable({readableStream:T.data}):void 0,K=yield this.agent.dwn.node.processMessage(u,$,{dataStream:j});t.syncMessageReplyIsSuccessful(K)&&(yield this.addMessage(u,l),o.push({type:"del",key:d}))}yield n.batch(o)})}push(){return Xa(this,void 0,void 0,function*(){let e=yield this.getSyncPeerState({syncDirection:"push"});yield this.enqueueOperations({syncDirection:"push",syncPeerState:e});let r=this.getPushQueue(),n=yield r.iterator().all(),i=[],o=new Set;for(let s of n){let[a]=s,{did:d,delegateDid:u,protocol:c,dwnUrl:l,messageCid:h}=t.parseSyncMessageParamsKey(a);if(o.has(l))continue;let y=yield this.getDwnMessage({author:d,messageCid:h,delegateDid:u,protocol:c});if(!y){i.push({type:"del",key:a}),yield this.addMessage(d,h);continue}try{let g=yield this.agent.rpc.sendDwnRequest({dwnUrl:l,targetDid:d,data:y.data,message:y.message});t.syncMessageReplyIsSuccessful(g)&&(yield this.addMessage(d,h),i.push({type:"del",key:a}))}catch{o.add(l)}}yield r.batch(i)})}registerIdentity({did:e,options:r}){return Xa(this,void 0,void 0,function*(){let n=this._db.sublevel("registeredIdentities");r??(r={protocols:[]}),yield n.put(e,JSON.stringify(r))})}sync(e){return Xa(this,void 0,void 0,function*(){if(this._syncIntervalId)throw new Error("SyncEngineLevel: Cannot call sync while a sync interval is active. Call `stopSync()` first.");(!e||e==="push")&&(yield this.push()),(!e||e==="pull")&&(yield this.pull())})}startSync({interval:e}){let r=(0,F1e.default)(e);return new Promise((n,i)=>{let o=()=>Xa(this,void 0,void 0,function*(){this._syncIntervalId&&clearInterval(this._syncIntervalId);try{yield this.push(),yield this.pull()}catch(s){this.stopSync(),i(s)}this._syncIntervalId=setInterval(o,r)});this._syncIntervalId=setInterval(o,r)})}stopSync(){this._syncIntervalId&&(clearInterval(this._syncIntervalId),this._syncIntervalId=void 0)}static syncMessageReplyIsSuccessful(e){var r,n;return e.status.code===202||e.status.code===204||e.status.code===409||((r=e.entry)===null||r===void 0?void 0:r.message.descriptor.interface)===Oe.Records&&((n=e.entry)===null||n===void 0?void 0:n.message.descriptor.method)===Ae.Delete&&e.status.code===404}enqueueOperations({syncDirection:e,syncPeerState:r}){return Xa(this,void 0,void 0,function*(){for(let n of r){let i=yield this.getDwnEventLog({did:n.did,delegateDid:n.delegateDid,dwnUrl:n.dwnUrl,cursor:n.cursor,protocol:n.protocol,syncDirection:e}),o=[];for(let s of i){let a=this._ulidFactory(),d=t.generateSyncMessageParamsKey(Object.assign(Object.assign({},n),{watermark:a,messageCid:s}));o.push({type:"put",key:d,value:""})}o.length>0&&(yield(e==="pull"?this.getPullQueue():this.getPushQueue()).batch(o))}})}static generateSyncMessageParamsKey({did:e,delegateDid:r,dwnUrl:n,protocol:i,watermark:o,messageCid:s}){return[e,r,n,i,o,s].join("~")}static parseSyncMessageParamsKey(e){let[r,n,i,o,s,a]=e.split("~");return{did:r,delegateDid:n===""?void 0:n,dwnUrl:i,watermark:s,messageCid:a,protocol:o===""?void 0:o}}getDwnEventLog({did:e,delegateDid:r,dwnUrl:n,syncDirection:i,cursor:o,protocol:s}){var a;return Xa(this,void 0,void 0,function*(){let d={},u;if(r)try{u=(yield this._cachedPermissionsApi.getPermission({connectedDid:e,messageType:Ct.MessagesQuery,delegateDid:r,protocol:s})).grant.id}catch(l){return console.error("SyncEngineLevel: Error fetching MessagesQuery permission grant for delegate DID",l),[]}if(i==="pull"){let l=s?[{protocol:s}]:[],h=yield this.agent.dwn.processRequest({store:!1,target:e,author:e,messageType:Ct.MessagesQuery,granteeDid:r,messageParams:{filters:l,cursor:o,permissionGrantId:u}});try{d=yield this.agent.rpc.sendDwnRequest({dwnUrl:n,targetDid:e,message:h.message})}catch{}}else if(i==="push"){let l=s?[{protocol:s}]:[];d=(yield this.agent.dwn.processRequest({author:e,target:e,messageType:Ct.MessagesQuery,granteeDid:r,messageParams:{filters:l,cursor:o,permissionGrantId:u}})).reply}let c=(a=d.entries)!==null&&a!==void 0?a:[];return d.cursor&&this.setCursor(e,n,i,d.cursor,s),c})}getDwnMessage({author:e,delegateDid:r,protocol:n,messageCid:i}){return Xa(this,void 0,void 0,function*(){let o;if(r)try{o=(yield this._cachedPermissionsApi.getPermission({connectedDid:e,messageType:Ct.MessagesRead,delegateDid:r,protocol:n})).grant.id}catch(u){console.error("SyncEngineLevel: push - Error fetching MessagesRead permission grant for delegate DID",u);return}let{reply:s}=yield this.agent.dwn.processRequest({author:e,target:e,messageType:Ct.MessagesRead,granteeDid:r,messageParams:{messageCid:i,permissionGrantId:o}});if(s.status.code!==200||!s.entry)return;let a=s.entry,d={message:a.message};if(Vb(a)&&a.data){let u=yield Mp.consumeToBytes({readable:a.data});d.data=new Blob([u],{type:a.message.descriptor.dataFormat})}return d})}getSyncPeerState({syncDirection:e}){var r,n,i,o;return Xa(this,void 0,void 0,function*(){let s=[];try{for(var a=!0,d=tit(this._db.sublevel("registeredIdentities").iterator()),u;u=yield d.next(),r=u.done,!r;a=!0){o=u.value,a=!1;let[c,l]=o,{protocols:h,delegateDid:y}=JSON.parse(l),g=yield gB(c,this.agent.did);if(g.length!==0)for(let v of g)if(h.length===0){let x=yield this.getCursor(c,v,e);s.push({did:c,delegateDid:y,dwnUrl:v,cursor:x})}else for(let x of h){let S=yield this.getCursor(c,v,e,x);s.push({did:c,delegateDid:y,dwnUrl:v,cursor:S,protocol:x})}}}catch(c){n={error:c}}finally{try{!a&&!r&&(i=d.return)&&(yield i.call(d))}finally{if(n)throw n.error}}return s})}getCursor(e,r,n,i){return Xa(this,void 0,void 0,function*(){let o=i?`${e}~${r}~${n}-${i}`:`${e}~${r}~${n}`,s=this.getCursorStore();try{let a=yield s.get(o);if(a)return JSON.parse(a)}catch(a){if(a.notFound)return}})}setCursor(e,r,n,i,o){return Xa(this,void 0,void 0,function*(){let s=o?`${e}~${r}~${n}-${o}`:`${e}~${r}~${n}`;yield this.getCursorStore().put(s,JSON.stringify(i))})}messageExists(e,r){return Xa(this,void 0,void 0,function*(){let n=this.getMessageStore(e);try{return yield n.get(r),!0}catch(i){if(i.notFound)return!1;throw i}})}addMessage(e,r){return Xa(this,void 0,void 0,function*(){return yield this.getMessageStore(e).put(r,"")})}getMessageStore(e){return this._db.sublevel("history").sublevel(e).sublevel("messages")}getCursorStore(){return this._db.sublevel("cursors")}getPushQueue(){return this._db.sublevel("pushQueue")}getPullQueue(){return this._db.sublevel("pullQueue")}};f();var nit=xt($5(),1);f();var rit=xt(f0(),1);f();f();f();f();var Gb;(function(t){t.authentication="authentication",t.assertionMethod="assertionMethod",t.keyAgreement="keyAgreement",t.capabilityInvocation="capabilityInvocation",t.capabilityDelegation="capabilityDelegation"})(Gb||(Gb={}));f();var zi={"@context":"https://w3id.org/did-resolution/v1",didResolutionMetadata:{},didDocument:null,didDocumentMetadata:{}};f();var $r=class t{constructor({method:e,id:r,path:n,query:i,fragment:o,params:s}){this.uri=`did:${e}:${r}`,this.method=e,this.id=r,this.path=n,this.query=i,this.fragment=o,this.params=s}static parse(e){if(!e)return null;let r=t.DID_URI_PATTERN.exec(e);if(!r||!r.groups)return null;let{method:n,id:i,path:o,query:s,fragment:a}=r.groups,d={uri:`did:${n}:${i}`,method:n,id:i};if(o&&(d.path=o),s&&(d.query=s.slice(1)),a&&(d.fragment=a.slice(1)),s){let u={},c=s.slice(1).split("&");for(let l of c){let[h,y]=l.split("=");u[h]=y}d.params=u}return d}};$r.METHOD_PATTERN="([a-z0-9]+)";$r.PCT_ENCODED_PATTERN="(?:%[0-9a-fA-F]{2})";$r.ID_CHAR_PATTERN=`(?:[a-zA-Z0-9._-]|${$r.PCT_ENCODED_PATTERN})`;$r.METHOD_ID_PATTERN=`((?:${$r.ID_CHAR_PATTERN}*:)*(${$r.ID_CHAR_PATTERN}+))`;$r.PATH_PATTERN="(/[^#?]*)?";$r.QUERY_PATTERN="([?][^#]*)?";$r.FRAGMENT_PATTERN="(#.*)?";$r.DID_URI_PATTERN=new RegExp(`^did:(?<method>${$r.METHOD_PATTERN}):(?<id>${$r.METHOD_ID_PATTERN})(?<path>${$r.PATH_PATTERN})(?<query>${$r.QUERY_PATTERN})(?<fragment>${$r.FRAGMENT_PATTERN})$`);f();var lt=class t extends Error{constructor(e,r){super(`${e}: ${r}`),this.code=e,this.name="DidError",Object.setPrototypeOf(this,new.target.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,t)}},ht;(function(t){t.InvalidDid="invalidDid",t.MethodNotSupported="methodNotSupported",t.InternalError="internalError",t.InvalidDidDocument="invalidDidDocument",t.InvalidDidDocumentLength="invalidDidDocumentLength",t.InvalidDidUrl="invalidDidUrl",t.InvalidPreviousDidProof="invalidPreviousDidProof",t.InvalidPublicKey="invalidPublicKey",t.InvalidPublicKeyLength="invalidPublicKeyLength",t.InvalidPublicKeyType="invalidPublicKeyType",t.InvalidSignature="invalidSignature",t.NotFound="notFound",t.RepresentationNotSupported="representationNotSupported",t.UnsupportedPublicKeyType="unsupportedPublicKeyType"})(ht||(ht={}));f();f();f();f();f();var iit=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},tx=class{static digest({data:e}){return iit(this,void 0,void 0,function*(){return ya(e)})}};f();var eh=class{};var oit=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},UB=class extends eh{digest({algorithm:e,data:r}){return oit(this,void 0,void 0,function*(){switch(e){case"SHA-256":return yield tx.digest({data:r})}})}};f();f();f();f();function V1e(t){let e=n=>{if(n!==null&&typeof n=="object"&&!Array.isArray(n)){let i=Object.keys(n).sort(),o={};for(let s of i)o[s]=e(n[s]);return o}return n},r=e(t);return JSON.stringify(r)}var sit=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},zz="urn:jwk:";function _r({jwk:t}){return sit(this,void 0,void 0,function*(){let e=t.kty,r;if(e==="EC")r={crv:t.crv,kty:t.kty,x:t.x,y:t.y};else if(e==="oct")r={k:t.k,kty:t.kty};else if(e==="OKP")r={crv:t.crv,kty:t.kty,x:t.x};else if(e==="RSA")r={e:t.e,kty:t.kty,n:t.n};else throw new Error(`Unsupported key type: ${e}`);_F(r);let n=V1e(r),i=le.string(n).toUint8Array(),o=yield tx.digest({data:i});return le.uint8Array(o).toBase64Url()})}function th(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="EC"||typeof t.d!="string"||typeof t.x!="string")}function rx(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t)||"d"in t||t.kty!=="EC"||typeof t.x!="string")}function rh(t){return!(!t||typeof t!="object"||!("kty"in t&&"crv"in t&&"x"in t&&"d"in t)||t.kty!=="OKP"||typeof t.d!="string"||typeof t.x!="string")}function nx(t){return!(!t||typeof t!="object"||"d"in t||!("kty"in t&&"crv"in t&&"x"in t)||t.kty!=="OKP"||typeof t.x!="string")}function H1e(t){if(!t||typeof t!="object")return!1;switch(t.kty){case"EC":case"OKP":case"RSA":return"d"in t;case"oct":return"k"in t;default:return!1}}var Us=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},ait=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},Qo=class t{static adjustSignatureToLowS({signature:e}){return Us(this,void 0,void 0,function*(){let r=br.Signature.fromCompact(e);return r.hasHighS()?r.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return Us(this,void 0,void 0,function*(){let r=yield t.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"secp256k1",d:le.uint8Array(e).toBase64Url(),x:le.uint8Array(r.x).toBase64Url(),y:le.uint8Array(r.y).toBase64Url()};return n.kid=yield _r({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return Us(this,void 0,void 0,function*(){let r=yield t.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"secp256k1",x:le.uint8Array(r.x).toBase64Url(),y:le.uint8Array(r.y).toBase64Url()};return n.kid=yield _r({jwk:n}),n})}static compressPublicKey({publicKeyBytes:e}){return Us(this,void 0,void 0,function*(){return br.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return Us(this,void 0,void 0,function*(){let r=yield t.privateKeyToBytes({privateKey:e}),n=yield t.getCurvePoint({keyBytes:r}),i={kty:"EC",crv:"secp256k1",x:le.uint8Array(n.x).toBase64Url(),y:le.uint8Array(n.y).toBase64Url()};return i.kid=yield _r({jwk:i}),i})}static convertDerToCompactSignature({derSignature:e}){return Us(this,void 0,void 0,function*(){return br.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return Us(this,void 0,void 0,function*(){return br.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return Us(this,void 0,void 0,function*(){let e=br.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield _r({jwk:r}),r})}static getPublicKey({key:e}){var r;return Us(this,void 0,void 0,function*(){if(!(th(e)&&e.crv==="secp256k1"))throw new Error("Secp256k1: The provided key is not a secp256k1 private JWK.");let{d:n}=e,i=ait(e,["d"]);return(r=i.kid)!==null&&r!==void 0||(i.kid=yield _r({jwk:i})),i})}static privateKeyToBytes({privateKey:e}){return Us(this,void 0,void 0,function*(){if(!th(e))throw new Error("Secp256k1: The provided key is not a valid EC private key.");return le.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return Us(this,void 0,void 0,function*(){if(!(rx(e)&&e.y))throw new Error("Secp256k1: The provided key is not a valid EC public key.");let r=new Uint8Array([4]),n=le.base64Url(e.x).toUint8Array(),i=le.base64Url(e.y).toUint8Array();return new Uint8Array([...r,...n,...i])})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return Us(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("Secp256k1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let n=yield t.privateKeyToBytes({privateKey:e}),i=yield t.publicKeyToBytes({publicKey:r});return br.getSharedSecret(n,i,!0).slice(1)})}static sign({data:e,key:r}){return Us(this,void 0,void 0,function*(){let n=yield t.privateKeyToBytes({privateKey:r}),i=ya(e);return br.sign(i,n).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return Us(this,void 0,void 0,function*(){return br.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return Us(this,void 0,void 0,function*(){try{br.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return Us(this,void 0,void 0,function*(){let i=yield t.publicKeyToBytes({publicKey:e}),o=ya(n);return br.verify(r,o,i,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return Us(this,void 0,void 0,function*(){e.byteLength===32&&(e=br.getPublicKey(e));let r=br.ProjectivePoint.fromHex(e),n=Fn(r.x,32),i=Fn(r.y,32);return{x:n,y:i}})}};f();var Ks=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},cit=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},qs=class t{static adjustSignatureToLowS({signature:e}){return Ks(this,void 0,void 0,function*(){let r=kr.Signature.fromCompact(e);return r.hasHighS()?r.normalizeS().toCompactRawBytes():e})}static bytesToPrivateKey({privateKeyBytes:e}){return Ks(this,void 0,void 0,function*(){let r=yield t.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"P-256",d:le.uint8Array(e).toBase64Url(),x:le.uint8Array(r.x).toBase64Url(),y:le.uint8Array(r.y).toBase64Url()};return n.kid=yield _r({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return Ks(this,void 0,void 0,function*(){let r=yield t.getCurvePoint({keyBytes:e}),n={kty:"EC",crv:"P-256",x:le.uint8Array(r.x).toBase64Url(),y:le.uint8Array(r.y).toBase64Url()};return n.kid=yield _r({jwk:n}),n})}static compressPublicKey({publicKeyBytes:e}){return Ks(this,void 0,void 0,function*(){return kr.ProjectivePoint.fromHex(e).toRawBytes(!0)})}static computePublicKey({key:e}){return Ks(this,void 0,void 0,function*(){let r=yield t.privateKeyToBytes({privateKey:e}),n=yield t.getCurvePoint({keyBytes:r}),i={kty:"EC",crv:"P-256",x:le.uint8Array(n.x).toBase64Url(),y:le.uint8Array(n.y).toBase64Url()};return i.kid=yield _r({jwk:i}),i})}static convertDerToCompactSignature({derSignature:e}){return Ks(this,void 0,void 0,function*(){return kr.Signature.fromDER(e).toCompactRawBytes()})}static decompressPublicKey({publicKeyBytes:e}){return Ks(this,void 0,void 0,function*(){return kr.ProjectivePoint.fromHex(e).toRawBytes(!1)})}static generateKey(){return Ks(this,void 0,void 0,function*(){let e=kr.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield _r({jwk:r}),r})}static getPublicKey({key:e}){var r;return Ks(this,void 0,void 0,function*(){if(!(th(e)&&e.crv==="P-256"))throw new Error("Secp256r1: The provided key is not a 'P-256' private JWK.");let{d:n}=e,i=cit(e,["d"]);return(r=i.kid)!==null&&r!==void 0||(i.kid=yield _r({jwk:i})),i})}static privateKeyToBytes({privateKey:e}){return Ks(this,void 0,void 0,function*(){if(!th(e))throw new Error("Secp256r1: The provided key is not a valid EC private key.");return le.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return Ks(this,void 0,void 0,function*(){if(!(rx(e)&&e.y))throw new Error("Secp256r1: The provided key is not a valid EC public key.");let r=new Uint8Array([4]),n=le.base64Url(e.x).toUint8Array(),i=le.base64Url(e.y).toUint8Array();return new Uint8Array([...r,...n,...i])})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return Ks(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("Secp256r1: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let n=yield t.privateKeyToBytes({privateKey:e}),i=yield t.publicKeyToBytes({publicKey:r});return kr.getSharedSecret(n,i,!0).slice(1)})}static sign({data:e,key:r}){return Ks(this,void 0,void 0,function*(){let n=yield t.privateKeyToBytes({privateKey:r}),i=ya(e);return kr.sign(i,n).toCompactRawBytes()})}static validatePrivateKey({privateKeyBytes:e}){return Ks(this,void 0,void 0,function*(){return kr.utils.isValidPrivateKey(e)})}static validatePublicKey({publicKeyBytes:e}){return Ks(this,void 0,void 0,function*(){try{kr.ProjectivePoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return Ks(this,void 0,void 0,function*(){let i=yield t.publicKeyToBytes({publicKey:e}),o=ya(n);return kr.verify(r,o,i,{lowS:!1})})}static getCurvePoint({keyBytes:e}){return Ks(this,void 0,void 0,function*(){e.byteLength===32&&(e=kr.getPublicKey(e));let r=kr.ProjectivePoint.fromHex(e),n=Fn(r.x,32),i=Fn(r.y,32);return{x:n,y:i}})}};var Z3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},X3=class extends eh{computePublicKey({key:e}){return Z3(this,void 0,void 0,function*(){if(!th(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{let r=yield Qo.computePublicKey({key:e});return r.alg="ES256K",r}case"P-256":{let r=yield qs.computePublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return Z3(this,void 0,void 0,function*(){switch(e){case"ES256K":case"secp256k1":{let r=yield Qo.generateKey();return r.alg="ES256K",r}case"ES256":case"secp256r1":{let r=yield qs.generateKey();return r.alg="ES256",r}}})}getPublicKey({key:e}){return Z3(this,void 0,void 0,function*(){if(!th(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":{let r=yield Qo.getPublicKey({key:e});return r.alg="ES256K",r}case"P-256":{let r=yield qs.getPublicKey({key:e});return r.alg="ES256",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:r}){return Z3(this,void 0,void 0,function*(){if(!th(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) private key.");switch(e.crv){case"secp256k1":return yield Qo.sign({key:e,data:r});case"P-256":return yield qs.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return Z3(this,void 0,void 0,function*(){if(!rx(e))throw new TypeError("Invalid key provided. Must be an elliptic curve (EC) public key.");switch(e.crv){case"secp256k1":return yield Qo.verify({key:e,signature:r,data:n});case"P-256":return yield qs.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};f();f();var _u=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},dit=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},xo=class t{static bytesToPrivateKey({privateKeyBytes:e}){return _u(this,void 0,void 0,function*(){let r=zn.getPublicKey(e),n={crv:"Ed25519",d:le.uint8Array(e).toBase64Url(),kty:"OKP",x:le.uint8Array(r).toBase64Url()};return n.kid=yield _r({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return _u(this,void 0,void 0,function*(){let r={kty:"OKP",crv:"Ed25519",x:le.uint8Array(e).toBase64Url()};return r.kid=yield _r({jwk:r}),r})}static computePublicKey({key:e}){return _u(this,void 0,void 0,function*(){let r=yield t.privateKeyToBytes({privateKey:e}),n=zn.getPublicKey(r),i={kty:"OKP",crv:"Ed25519",x:le.uint8Array(n).toBase64Url()};return i.kid=yield _r({jwk:i}),i})}static convertPrivateKeyToX25519({privateKey:e}){return _u(this,void 0,void 0,function*(){let r=yield t.privateKeyToBytes({privateKey:e}),n=f_(r),i=Li.getPublicKey(n),o={kty:"OKP",crv:"X25519",d:le.uint8Array(n).toBase64Url(),x:le.uint8Array(i).toBase64Url()};return o.kid=yield _r({jwk:o}),o})}static convertPublicKeyToX25519({publicKey:e}){return _u(this,void 0,void 0,function*(){let r=yield t.publicKeyToBytes({publicKey:e});if(!(yield t.validatePublicKey({publicKeyBytes:r})))throw new Error("Ed25519: Invalid public key.");let i=l_(r),o={kty:"OKP",crv:"X25519",x:le.uint8Array(i).toBase64Url()};return o.kid=yield _r({jwk:o}),o})}static generateKey(){return _u(this,void 0,void 0,function*(){let e=zn.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield _r({jwk:r}),r})}static getPublicKey({key:e}){var r;return _u(this,void 0,void 0,function*(){if(!(rh(e)&&e.crv==="Ed25519"))throw new Error("Ed25519: The provided key is not an Ed25519 private JWK.");let{d:n}=e,i=dit(e,["d"]);return(r=i.kid)!==null&&r!==void 0||(i.kid=yield _r({jwk:i})),i})}static privateKeyToBytes({privateKey:e}){return _u(this,void 0,void 0,function*(){if(!rh(e))throw new Error("Ed25519: The provided key is not a valid OKP private key.");return le.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return _u(this,void 0,void 0,function*(){if(!nx(e))throw new Error("Ed25519: The provided key is not a valid OKP public key.");return le.base64Url(e.x).toUint8Array()})}static sign({key:e,data:r}){return _u(this,void 0,void 0,function*(){let n=yield t.privateKeyToBytes({privateKey:e});return zn.sign(r,n)})}static validatePublicKey({publicKeyBytes:e}){return _u(this,void 0,void 0,function*(){try{zn.ExtendedPoint.fromHex(e).assertValidity()}catch{return!1}return!0})}static verify({key:e,signature:r,data:n}){return _u(this,void 0,void 0,function*(){let i=yield t.publicKeyToBytes({publicKey:e});return zn.verify(r,n,i)})}};var Q3=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},KB=class extends eh{computePublicKey({key:e}){return Q3(this,void 0,void 0,function*(){if(!rh(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{let r=yield xo.computePublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}generateKey({algorithm:e}){return Q3(this,void 0,void 0,function*(){switch(e){case"Ed25519":{let r=yield xo.generateKey();return r.alg="EdDSA",r}}})}getPublicKey({key:e}){return Q3(this,void 0,void 0,function*(){if(!rh(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":{let r=yield xo.getPublicKey({key:e});return r.alg="EdDSA",r}default:throw new Error(`Unsupported curve: ${e.crv}`)}})}sign({key:e,data:r}){return Q3(this,void 0,void 0,function*(){if(!rh(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) private key.");switch(e.crv){case"Ed25519":return yield xo.sign({key:e,data:r});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}verify({key:e,signature:r,data:n}){return Q3(this,void 0,void 0,function*(){if(!nx(e))throw new TypeError("Invalid key provided. Must be an octet key pair (OKP) public key.");switch(e.crv){case"Ed25519":return yield xo.verify({key:e,signature:r,data:n});default:throw new Error(`Unsupported curve: ${e.crv}`)}})}};var ry=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Vz={Ed25519:{implementation:KB,names:["Ed25519"]},secp256k1:{implementation:X3,names:["ES256K","secp256k1"]},secp256r1:{implementation:X3,names:["ES256","secp256r1"]},"SHA-256":{implementation:UB,names:["SHA-256"]}},ba=class{constructor(e){var r;this._algorithmInstances=new Map,this._keyStore=(r=e?.keyStore)!==null&&r!==void 0?r:new xb}digest({algorithm:e,data:r}){return ry(this,void 0,void 0,function*(){return yield this.getAlgorithm({algorithm:e}).digest({algorithm:e,data:r})})}exportKey({keyUri:e}){return ry(this,void 0,void 0,function*(){return yield this.getPrivateKey({keyUri:e})})}generateKey({algorithm:e}){return ry(this,void 0,void 0,function*(){let n=yield this.getAlgorithm({algorithm:e}).generateKey({algorithm:e});if(n?.kid===void 0)throw new Error("Generated key is missing a required property: kid");let i=`${zz}${n.kid}`;return yield this._keyStore.set(i,n),i})}getKeyUri({key:e}){return ry(this,void 0,void 0,function*(){let r=yield _r({jwk:e});return`${zz}${r}`})}getPublicKey({keyUri:e}){return ry(this,void 0,void 0,function*(){let r=yield this.getPrivateKey({keyUri:e}),n=this.getAlgorithmName({key:r});return yield this.getAlgorithm({algorithm:n}).getPublicKey({key:r})})}importKey({key:e}){var r;return ry(this,void 0,void 0,function*(){if(!H1e(e))throw new TypeError("Invalid key provided. Must be a private key in JWK format.");let n=structuredClone(e);(r=n.kid)!==null&&r!==void 0||(n.kid=yield _r({jwk:n}));let i=yield this.getKeyUri({key:n});return yield this._keyStore.set(i,n),i})}sign({keyUri:e,data:r}){return ry(this,void 0,void 0,function*(){let n=yield this.getPrivateKey({keyUri:e}),i=this.getAlgorithmName({key:n});return this.getAlgorithm({algorithm:i}).sign({data:r,key:n})})}verify({key:e,signature:r,data:n}){return ry(this,void 0,void 0,function*(){let i=this.getAlgorithmName({key:e});return this.getAlgorithm({algorithm:i}).verify({key:e,signature:r,data:n})})}getAlgorithm({algorithm:e}){var r;let n=(r=Vz[e])===null||r===void 0?void 0:r.implementation;if(!n)throw new Error(`Algorithm not supported: ${e}`);return this._algorithmInstances.has(n)||this._algorithmInstances.set(n,new n),this._algorithmInstances.get(n)}getAlgorithmName({key:e}){let r=e.alg,n=e.crv;for(let i in Vz){let o=Vz[i];if(r&&o.names.includes(r))return i;if(n&&o.names.includes(n))return i}throw new Error(`Unable to determine algorithm based on provided input: alg=${r}, crv=${n}`)}getPrivateKey({keyUri:e}){return ry(this,void 0,void 0,function*(){let r=yield this._keyStore.get(e);if(!r)throw new Error(`Key not found: ${e}`);return r})}};var qB={};Or(qB,{checkRequiredProperty:()=>uit,checkValidProperty:()=>lit,getJoseSignatureAlgorithmFromPublicKey:()=>fit,isWebCryptoSupported:()=>hit,randomBytes:()=>pit,randomUuid:()=>yit});f();function uit(t){if(!t||t.property===void 0||t.inObject===void 0)throw new TypeError("One or more required parameters missing: 'property, properties'");let{property:e,inObject:r}=t;if(!(e in r))throw new TypeError(`Required parameter missing: '${e}'`)}function lit(t){if(!t||t.property===void 0||t.allowedProperties===void 0)throw new TypeError("One or more required parameters missing: 'property, allowedProperties'");let{property:e,allowedProperties:r}=t;if(Array.isArray(r)&&!r.includes(e)||r instanceof Set&&!r.has(e)||r instanceof Map&&!r.has(e)){let n=Array.from(r instanceof Map?r.keys():r).join(", ");throw new TypeError(`Out of range: '${e}'. Must be one of '${n}'`)}}function fit(t){let e={Ed25519:"EdDSA","P-256":"ES256","P-384":"ES384","P-521":"ES512",secp256k1:"ES256K"};if(t.alg&&Object.values(e).includes(t.alg))return t.alg;if(t.crv&&Object.keys(e).includes(t.crv))return e[t.crv];throw new Error(`Unable to determine algorithm based on provided input: alg=${t.alg}, crv=${t.crv}. Supported 'alg' values: ${Object.values(e).join(", ")}. Supported 'crv' values: ${Object.keys(e).join(", ")}.`)}function hit(){return!!(globalThis.crypto&&globalThis.crypto.subtle)}function pit(t){return Tp(t)}function yit(){return o_.randomUUID()}f();f();f();f();var mit=typeof globalThis=="object"&&"crypto"in globalThis?globalThis.crypto:void 0;f();var ny=t=>new Uint32Array(t.buffer,t.byteOffset,Math.floor(t.byteLength/4));function W1e(t){return t instanceof Uint8Array||t!=null&&typeof t=="object"&&t.constructor.name==="Uint8Array"}var G1e=t=>new DataView(t.buffer,t.byteOffset,t.byteLength),git=new Uint8Array(new Uint32Array([287454020]).buffer)[0]===68;if(!git)throw new Error("Non little-endian hardware is not supported");function LB(t){if(typeof t!="string")throw new Error(`utf8ToBytes expected string, got ${typeof t}`);return new Uint8Array(new TextEncoder().encode(t))}function FB(t){if(typeof t=="string")t=LB(t);else if(W1e(t))t=t.slice();else throw new Error(`expected Uint8Array, got ${typeof t}`);return t}var vit=t=>Object.prototype.toString.call(t)==="[object Object]"&&t.constructor===Object;function J1e(t,e){if(e!==void 0&&(typeof e!="object"||!vit(e)))throw new Error("options must be object or undefined");return Object.assign(t,e)}function Jb(t,e){if(!W1e(t))throw new Error("Uint8Array expected");if(typeof e=="number"&&t.length!==e)throw new Error(`Uint8Array length ${e} expected`)}function Y1e(t,e){if(t.length!==e.length)return!1;let r=0;for(let n=0;n<t.length;n++)r|=t[n]^e[n];return r===0}var Hz=(t,e)=>(Object.assign(e,t),e);function Wz(t,e,r,n){if(typeof t.setBigUint64=="function")return t.setBigUint64(e,r,n);let i=BigInt(32),o=BigInt(4294967295),s=Number(r>>i&o),a=Number(r&o),d=n?4:0,u=n?0:4;t.setUint32(e+d,s,n),t.setUint32(e+u,a,n)}f();function e8(t){if(!Number.isSafeInteger(t)||t<0)throw new Error(`wrong positive integer: ${t}`)}function Gz(t){if(typeof t!="boolean")throw new Error(`boolean expected, not ${t}`)}function bit(t){return t!=null&&typeof t=="object"&&(t instanceof Uint8Array||t.constructor.name==="Uint8Array")}function ix(t,...e){if(!bit(t))throw new Error("Uint8Array expected");if(e.length>0&&!e.includes(t.length))throw new Error(`Uint8Array expected of length ${e}, not of length=${t.length}`)}function Jz(t,e=!0){if(t.destroyed)throw new Error("Hash instance has been destroyed");if(e&&t.finished)throw new Error("Hash#digest() has already been called")}function Z1e(t,e){ix(t);let r=e.outputLen;if(t.length<r)throw new Error(`digestInto() expects output buffer of length at least ${r}`)}f();f();f();f();f();f();f();f();var M0=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},wit=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},ox=class t{static bytesToPrivateKey({privateKeyBytes:e}){return M0(this,void 0,void 0,function*(){let r=Li.getPublicKey(e),n={kty:"OKP",crv:"X25519",d:le.uint8Array(e).toBase64Url(),x:le.uint8Array(r).toBase64Url()};return n.kid=yield _r({jwk:n}),n})}static bytesToPublicKey({publicKeyBytes:e}){return M0(this,void 0,void 0,function*(){let r={kty:"OKP",crv:"X25519",x:le.uint8Array(e).toBase64Url()};return r.kid=yield _r({jwk:r}),r})}static computePublicKey({key:e}){return M0(this,void 0,void 0,function*(){let r=yield t.privateKeyToBytes({privateKey:e}),n=Li.getPublicKey(r),i={kty:"OKP",crv:"X25519",x:le.uint8Array(n).toBase64Url()};return i.kid=yield _r({jwk:i}),i})}static generateKey(){return M0(this,void 0,void 0,function*(){let e=Li.utils.randomPrivateKey(),r=yield t.bytesToPrivateKey({privateKeyBytes:e});return r.kid=yield _r({jwk:r}),r})}static getPublicKey({key:e}){var r;return M0(this,void 0,void 0,function*(){if(!(rh(e)&&e.crv==="X25519"))throw new Error("X25519: The provided key is not an X25519 private JWK.");let{d:n}=e,i=wit(e,["d"]);return(r=i.kid)!==null&&r!==void 0||(i.kid=yield _r({jwk:i})),i})}static privateKeyToBytes({privateKey:e}){return M0(this,void 0,void 0,function*(){if(!rh(e))throw new Error("X25519: The provided key is not a valid OKP private key.");return le.base64Url(e.d).toUint8Array()})}static publicKeyToBytes({publicKey:e}){return M0(this,void 0,void 0,function*(){if(!nx(e))throw new Error("X25519: The provided key is not a valid OKP public key.");return le.base64Url(e.x).toUint8Array()})}static sharedSecret({privateKeyA:e,publicKeyB:r}){return M0(this,void 0,void 0,function*(){if("x"in e&&"x"in r&&e.x===r.x)throw new Error("X25519: ECDH shared secret cannot be computed from a single key pair's public and private keys.");let n=yield t.privateKeyToBytes({privateKey:e}),i=yield t.publicKeyToBytes({publicKey:r});return Li.getSharedSecret(n,i)})}};f();f();f();var Ls=(t,e)=>t[e++]&255|(t[e++]&255)<<8,Xz=class{constructor(e){this.blockLen=16,this.outputLen=16,this.buffer=new Uint8Array(16),this.r=new Uint16Array(10),this.h=new Uint16Array(10),this.pad=new Uint16Array(8),this.pos=0,this.finished=!1,e=FB(e),Jb(e,32);let r=Ls(e,0),n=Ls(e,2),i=Ls(e,4),o=Ls(e,6),s=Ls(e,8),a=Ls(e,10),d=Ls(e,12),u=Ls(e,14);this.r[0]=r&8191,this.r[1]=(r>>>13|n<<3)&8191,this.r[2]=(n>>>10|i<<6)&7939,this.r[3]=(i>>>7|o<<9)&8191,this.r[4]=(o>>>4|s<<12)&255,this.r[5]=s>>>1&8190,this.r[6]=(s>>>14|a<<2)&8191,this.r[7]=(a>>>11|d<<5)&8065,this.r[8]=(d>>>8|u<<8)&8191,this.r[9]=u>>>5&127;for(let c=0;c<8;c++)this.pad[c]=Ls(e,16+2*c)}process(e,r,n=!1){let i=n?0:2048,{h:o,r:s}=this,a=s[0],d=s[1],u=s[2],c=s[3],l=s[4],h=s[5],y=s[6],g=s[7],v=s[8],x=s[9],S=Ls(e,r+0),A=Ls(e,r+2),T=Ls(e,r+4),$=Ls(e,r+6),j=Ls(e,r+8),K=Ls(e,r+10),F=Ls(e,r+12),L=Ls(e,r+14),V=o[0]+(S&8191),q=o[1]+((S>>>13|A<<3)&8191),k=o[2]+((A>>>10|T<<6)&8191),P=o[3]+((T>>>7|$<<9)&8191),B=o[4]+(($>>>4|j<<12)&8191),p=o[5]+(j>>>1&8191),m=o[6]+((j>>>14|K<<2)&8191),w=o[7]+((K>>>11|F<<5)&8191),E=o[8]+((F>>>8|L<<8)&8191),_=o[9]+(L>>>5|i),b=0,C=b+V*a+q*(5*x)+k*(5*v)+P*(5*g)+B*(5*y);b=C>>>13,C&=8191,C+=p*(5*h)+m*(5*l)+w*(5*c)+E*(5*u)+_*(5*d),b+=C>>>13,C&=8191;let N=b+V*d+q*a+k*(5*x)+P*(5*v)+B*(5*g);b=N>>>13,N&=8191,N+=p*(5*y)+m*(5*h)+w*(5*l)+E*(5*c)+_*(5*u),b+=N>>>13,N&=8191;let D=b+V*u+q*d+k*a+P*(5*x)+B*(5*v);b=D>>>13,D&=8191,D+=p*(5*g)+m*(5*y)+w*(5*h)+E*(5*l)+_*(5*c),b+=D>>>13,D&=8191;let U=b+V*c+q*u+k*d+P*a+B*(5*x);b=U>>>13,U&=8191,U+=p*(5*v)+m*(5*g)+w*(5*y)+E*(5*h)+_*(5*l),b+=U>>>13,U&=8191;let G=b+V*l+q*c+k*u+P*d+B*a;b=G>>>13,G&=8191,G+=p*(5*x)+m*(5*v)+w*(5*g)+E*(5*y)+_*(5*h),b+=G>>>13,G&=8191;let Y=b+V*h+q*l+k*c+P*u+B*d;b=Y>>>13,Y&=8191,Y+=p*a+m*(5*x)+w*(5*v)+E*(5*g)+_*(5*y),b+=Y>>>13,Y&=8191;let J=b+V*y+q*h+k*l+P*c+B*u;b=J>>>13,J&=8191,J+=p*d+m*a+w*(5*x)+E*(5*v)+_*(5*g),b+=J>>>13,J&=8191;let H=b+V*g+q*y+k*h+P*l+B*c;b=H>>>13,H&=8191,H+=p*u+m*d+w*a+E*(5*x)+_*(5*v),b+=H>>>13,H&=8191;let X=b+V*v+q*g+k*y+P*h+B*l;b=X>>>13,X&=8191,X+=p*c+m*u+w*d+E*a+_*(5*x),b+=X>>>13,X&=8191;let te=b+V*x+q*v+k*g+P*y+B*h;b=te>>>13,te&=8191,te+=p*l+m*c+w*u+E*d+_*a,b+=te>>>13,te&=8191,b=(b<<2)+b|0,b=b+C|0,C=b&8191,b=b>>>13,N+=b,o[0]=C,o[1]=N,o[2]=D,o[3]=U,o[4]=G,o[5]=Y,o[6]=J,o[7]=H,o[8]=X,o[9]=te}finalize(){let{h:e,pad:r}=this,n=new Uint16Array(10),i=e[1]>>>13;e[1]&=8191;for(let a=2;a<10;a++)e[a]+=i,i=e[a]>>>13,e[a]&=8191;e[0]+=i*5,i=e[0]>>>13,e[0]&=8191,e[1]+=i,i=e[1]>>>13,e[1]&=8191,e[2]+=i,n[0]=e[0]+5,i=n[0]>>>13,n[0]&=8191;for(let a=1;a<10;a++)n[a]=e[a]+i,i=n[a]>>>13,n[a]&=8191;n[9]-=8192;let o=(i^1)-1;for(let a=0;a<10;a++)n[a]&=o;o=~o;for(let a=0;a<10;a++)e[a]=e[a]&o|n[a];e[0]=(e[0]|e[1]<<13)&65535,e[1]=(e[1]>>>3|e[2]<<10)&65535,e[2]=(e[2]>>>6|e[3]<<7)&65535,e[3]=(e[3]>>>9|e[4]<<4)&65535,e[4]=(e[4]>>>12|e[5]<<1|e[6]<<14)&65535,e[5]=(e[6]>>>2|e[7]<<11)&65535,e[6]=(e[7]>>>5|e[8]<<8)&65535,e[7]=(e[8]>>>8|e[9]<<5)&65535;let s=e[0]+r[0];e[0]=s&65535;for(let a=1;a<8;a++)s=(e[a]+r[a]|0)+(s>>>16)|0,e[a]=s&65535}update(e){Jz(this);let{buffer:r,blockLen:n}=this;e=FB(e);let i=e.length;for(let o=0;o<i;){let s=Math.min(n-this.pos,i-o);if(s===n){for(;n<=i-o;o+=n)this.process(e,o);continue}r.set(e.subarray(o,o+s),this.pos),this.pos+=s,o+=s,this.pos===n&&(this.process(r,0,!1),this.pos=0)}return this}destroy(){this.h.fill(0),this.r.fill(0),this.buffer.fill(0),this.pad.fill(0)}digestInto(e){Jz(this),Z1e(e,this),this.finished=!0;let{buffer:r,h:n}=this,{pos:i}=this;if(i){for(r[i++]=1;i<16;i++)r[i]=0;this.process(r,0,!0)}this.finalize();let o=0;for(let s=0;s<8;s++)e[o++]=n[s]>>>0,e[o++]=n[s]>>>8;return e}digest(){let{buffer:e,outputLen:r}=this;this.digestInto(e);let n=e.slice(0,r);return this.destroy(),n}};function _it(t){let e=(n,i)=>t(i).update(FB(n)).digest(),r=t(new Uint8Array(32));return e.outputLen=r.outputLen,e.blockLen=r.blockLen,e.create=n=>t(n),e}var X1e=_it(t=>new Xz(t));f();var xit=LB("expand 16-byte k"),Eit=LB("expand 32-byte k"),Sit=ny(xit),Tit=ny(Eit);function Qe(t,e){return t<<e|t>>>32-e}function Qz(t){return t.byteOffset%4===0}var zB=64,Ait=16,e2e=2**32-1,Q1e=new Uint32Array;function kit(t,e,r,n,i,o,s,a){let d=i.length,u=new Uint8Array(zB),c=ny(u),l=Qz(i)&&Qz(o),h=l?ny(i):Q1e,y=l?ny(o):Q1e;for(let g=0;g<d;s++){if(t(e,r,n,c,s,a),s>=e2e)throw new Error("arx: counter overflow");let v=Math.min(zB,d-g);if(l&&v===zB){let x=g/4;if(g%4!==0)throw new Error("arx: invalid block position");for(let S=0,A;S<Ait;S++)A=x+S,y[A]=h[A]^c[S];g+=zB;continue}for(let x=0,S;x<v;x++)S=g+x,o[S]=i[S]^u[x];g+=v}}function eV(t,e){let{allowShortKeys:r,extendNonceFn:n,counterLength:i,counterRight:o,rounds:s}=J1e({allowShortKeys:!1,counterLength:8,counterRight:!1,rounds:20},e);if(typeof t!="function")throw new Error("core must be a function");return e8(i),e8(s),Gz(o),Gz(r),(a,d,u,c,l=0)=>{ix(a),ix(d),ix(u);let h=u.length;if(c||(c=new Uint8Array(h)),ix(c),e8(l),l<0||l>=e2e)throw new Error("arx: counter overflow");if(c.length<h)throw new Error(`arx: output (${c.length}) is shorter than data (${h})`);let y=[],g=a.length,v,x;if(g===32)v=a.slice(),y.push(v),x=Tit;else if(g===16&&r)v=new Uint8Array(32),v.set(a),v.set(a,16),x=Sit,y.push(v);else throw new Error(`arx: invalid 32-byte key, got length=${g}`);Qz(d)||(d=d.slice(),y.push(d));let S=ny(v);if(n){if(d.length!==24)throw new Error("arx: extended nonce must be 24 bytes");n(x,S,ny(d.subarray(0,16)),S),d=d.subarray(16)}let A=16-i;if(A!==d.length)throw new Error(`arx: nonce must be ${A} or 16 bytes`);if(A!==12){let $=new Uint8Array(12);$.set(d,o?0:12-d.length),d=$,y.push(d)}let T=ny(d);for(kit(t,x,S,T,u,c,l,s);y.length>0;)y.pop().fill(0);return c}}function n2e(t,e,r,n,i,o=20){let s=t[0],a=t[1],d=t[2],u=t[3],c=e[0],l=e[1],h=e[2],y=e[3],g=e[4],v=e[5],x=e[6],S=e[7],A=i,T=r[0],$=r[1],j=r[2],K=s,F=a,L=d,V=u,q=c,k=l,P=h,B=y,p=g,m=v,w=x,E=S,_=A,b=T,C=$,N=j;for(let U=0;U<o;U+=2)K=K+q|0,_=Qe(_^K,16),p=p+_|0,q=Qe(q^p,12),K=K+q|0,_=Qe(_^K,8),p=p+_|0,q=Qe(q^p,7),F=F+k|0,b=Qe(b^F,16),m=m+b|0,k=Qe(k^m,12),F=F+k|0,b=Qe(b^F,8),m=m+b|0,k=Qe(k^m,7),L=L+P|0,C=Qe(C^L,16),w=w+C|0,P=Qe(P^w,12),L=L+P|0,C=Qe(C^L,8),w=w+C|0,P=Qe(P^w,7),V=V+B|0,N=Qe(N^V,16),E=E+N|0,B=Qe(B^E,12),V=V+B|0,N=Qe(N^V,8),E=E+N|0,B=Qe(B^E,7),K=K+k|0,N=Qe(N^K,16),w=w+N|0,k=Qe(k^w,12),K=K+k|0,N=Qe(N^K,8),w=w+N|0,k=Qe(k^w,7),F=F+P|0,_=Qe(_^F,16),E=E+_|0,P=Qe(P^E,12),F=F+P|0,_=Qe(_^F,8),E=E+_|0,P=Qe(P^E,7),L=L+B|0,b=Qe(b^L,16),p=p+b|0,B=Qe(B^p,12),L=L+B|0,b=Qe(b^L,8),p=p+b|0,B=Qe(B^p,7),V=V+q|0,C=Qe(C^V,16),m=m+C|0,q=Qe(q^m,12),V=V+q|0,C=Qe(C^V,8),m=m+C|0,q=Qe(q^m,7);let D=0;n[D++]=s+K|0,n[D++]=a+F|0,n[D++]=d+L|0,n[D++]=u+V|0,n[D++]=c+q|0,n[D++]=l+k|0,n[D++]=h+P|0,n[D++]=y+B|0,n[D++]=g+p|0,n[D++]=v+m|0,n[D++]=x+w|0,n[D++]=S+E|0,n[D++]=A+_|0,n[D++]=T+b|0,n[D++]=$+C|0,n[D++]=j+N|0}function Pit(t,e,r,n){let i=t[0],o=t[1],s=t[2],a=t[3],d=e[0],u=e[1],c=e[2],l=e[3],h=e[4],y=e[5],g=e[6],v=e[7],x=r[0],S=r[1],A=r[2],T=r[3];for(let j=0;j<20;j+=2)i=i+d|0,x=Qe(x^i,16),h=h+x|0,d=Qe(d^h,12),i=i+d|0,x=Qe(x^i,8),h=h+x|0,d=Qe(d^h,7),o=o+u|0,S=Qe(S^o,16),y=y+S|0,u=Qe(u^y,12),o=o+u|0,S=Qe(S^o,8),y=y+S|0,u=Qe(u^y,7),s=s+c|0,A=Qe(A^s,16),g=g+A|0,c=Qe(c^g,12),s=s+c|0,A=Qe(A^s,8),g=g+A|0,c=Qe(c^g,7),a=a+l|0,T=Qe(T^a,16),v=v+T|0,l=Qe(l^v,12),a=a+l|0,T=Qe(T^a,8),v=v+T|0,l=Qe(l^v,7),i=i+u|0,T=Qe(T^i,16),g=g+T|0,u=Qe(u^g,12),i=i+u|0,T=Qe(T^i,8),g=g+T|0,u=Qe(u^g,7),o=o+c|0,x=Qe(x^o,16),v=v+x|0,c=Qe(c^v,12),o=o+c|0,x=Qe(x^o,8),v=v+x|0,c=Qe(c^v,7),s=s+l|0,S=Qe(S^s,16),h=h+S|0,l=Qe(l^h,12),s=s+l|0,S=Qe(S^s,8),h=h+S|0,l=Qe(l^h,7),a=a+d|0,A=Qe(A^a,16),y=y+A|0,d=Qe(d^y,12),a=a+d|0,A=Qe(A^a,8),y=y+A|0,d=Qe(d^y,7);let $=0;n[$++]=i,n[$++]=o,n[$++]=s,n[$++]=a,n[$++]=x,n[$++]=S,n[$++]=A,n[$++]=T}var Iit=eV(n2e,{counterRight:!1,counterLength:4,allowShortKeys:!1}),i2e=eV(n2e,{counterRight:!1,counterLength:8,extendNonceFn:Pit,allowShortKeys:!1});var Rit=new Uint8Array(16),t2e=(t,e)=>{t.update(e);let r=e.length%16;r&&t.update(Rit.subarray(r))},Bit=new Uint8Array(32);function r2e(t,e,r,n,i){let o=t(e,r,Bit),s=X1e.create(o);i&&t2e(s,i),t2e(s,n);let a=new Uint8Array(16),d=G1e(a);Wz(d,0,BigInt(i?i.length:0),!0),Wz(d,8,BigInt(n.length),!0),s.update(a);let u=s.digest();return o.fill(0),u}var o2e=t=>(e,r,n)=>(Jb(e,32),Jb(r),{encrypt:(o,s)=>{let a=o.length,d=a+16;s?Jb(s,d):s=new Uint8Array(d),t(e,r,o,s,1);let u=r2e(t,e,r,s.subarray(0,-16),n);return s.set(u,a),s},decrypt:(o,s)=>{let a=o.length,d=a-16;if(a<16)throw new Error("encrypted data must be at least 16 bytes");s?Jb(s,d):s=new Uint8Array(d);let u=o.subarray(0,-16),c=o.subarray(-16),l=r2e(t,e,r,u,n);if(!Y1e(c,l))throw new Error("invalid tag");return t(e,r,u,s,1),s}}),ftr=Hz({blockSize:64,nonceLength:12,tagLength:16},o2e(Iit)),Oit=Hz({blockSize:64,nonceLength:24,tagLength:16},o2e(i2e));f();f();function _d(t){if(typeof t=="string"&&t.length!==0)return t.split("#").pop()}function rV({didDocument:t}){var e,r;if(!t)throw new TypeError("Required parameter missing: 'didDocument'");let n=[];return n.push(...(r=(e=t.verificationMethod)===null||e===void 0?void 0:e.filter(tV))!==null&&r!==void 0?r:[]),Object.keys(Gb).forEach(i=>{var o,s;n.push(...(s=(o=t[i])===null||o===void 0?void 0:o.filter(tV))!==null&&s!==void 0?s:[])}),n}function s2e({didDocument:t}){let r=rV({didDocument:t}).map(n=>n.type);return[...new Set(r)]}function a2e({didDocument:t,methodId:e}){let r=[];return Object.keys(Gb).forEach(n=>{if(Array.isArray(t[n])){let i=t[n],o=_d(e);i.some(a=>{let d=_d(a)===o,u=tV(a)&&_d(a.id)===o;return d||u})&&r.push(n)}}),r}function tV(t){return!(!t||typeof t!="object"||t===null||!("id"in t&&"type"in t&&"controller"in t)||typeof t.id!="string"||typeof t.type!="string"||typeof t.controller!="string")}function nV({keyBytes:t,multicodecCode:e,multicodecName:r}){let n=An.addPrefix({code:e,data:t,name:r}),i=le.uint8Array(n).toBase58Btc();return le.base58Btc(i).toMultibase()}function iV({multibaseKeyId:t}){try{let e=le.multibase(t).toBase58Btc(),r=le.base58Btc(e).toUint8Array(),{code:n,data:i,name:o}=An.removePrefix({prefixedData:r});return{keyBytes:i,multicodecCode:n,multicodecName:o}}catch{throw new lt(ht.InvalidDid,`Invalid multibase identifier: ${t}`)}}var t8=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},Pc=class t{constructor({uri:e,document:r,metadata:n,keyManager:i}){this.uri=e,this.document=r,this.metadata=n,this.keyManager=i}export(){return t8(this,void 0,void 0,function*(){if(!(Array.isArray(this.document.verificationMethod)&&this.document.verificationMethod.length>0))throw new Error(`DID document for '${this.uri}' is missing verification methods`);let e={uri:this.uri,document:this.document,metadata:this.metadata};if("exportKey"in this.keyManager&&typeof this.keyManager.exportKey=="function"){let r=[];for(let n of this.document.verificationMethod){if(!n.publicKeyJwk)throw new Error(`Verification method '${n.id}' does not contain a public key in JWK format`);let i=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),o=yield this.keyManager.exportKey({keyUri:i});r.push(Object.assign({},o))}e.privateKeys=r}return e})}getSigner(e){return t8(this,void 0,void 0,function*(){var r;let n=(r=this.document.verificationMethod)===null||r===void 0?void 0:r.find(d=>{var u,c;return _d(d.id)===((u=_d(e?.methodId))!==null&&u!==void 0?u:_d((c=this.document.assertionMethod)===null||c===void 0?void 0:c[0]))});if(!(n&&n.publicKeyJwk))throw new lt(ht.InternalError,"A verification method intended for signing could not be determined from the DID Document");let i=yield this.keyManager.getKeyUri({key:n.publicKeyJwk}),o=yield this.keyManager.getPublicKey({keyUri:i}),s=this.keyManager;return{algorithm:qB.getJoseSignatureAlgorithmFromPublicKey(o),keyId:n.id,sign(d){return t8(this,arguments,void 0,function*({data:u}){return yield s.sign({data:u,keyUri:i})})},verify(d){return t8(this,arguments,void 0,function*({data:u,signature:c}){return yield s.verify({data:u,key:o,signature:c})})}}})}static import(e){return t8(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ba}){var i;let o=rV({didDocument:r.document});if(o.length===0)throw new lt(ht.InvalidDidDocument,"At least one verification method is required but 0 were given");for(let a of(i=r.privateKeys)!==null&&i!==void 0?i:[])yield n.importKey({key:a});for(let a of o){if(!a.publicKeyJwk)throw new Error(`Verification method '${a.id}' does not contain a public key in JWK format`);let d=yield n.getKeyUri({key:a.publicKeyJwk});yield n.getPublicKey({keyUri:d})}return new t({uri:r.uri,document:r.document,metadata:r.metadata,keyManager:n})})}};f();f();var c2e=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},xu=class{static getSigningMethod(e){return c2e(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement getSigningMethod()")})}static resolve(e,r){return c2e(this,void 0,void 0,function*(){throw new Error("Not implemented: Classes extending DidMethod must implement resolve()")})}};var ts=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},d2e=function(t,e){var r={};for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.indexOf(n)<0&&(r[n]=t[n]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var i=0,n=Object.getOwnPropertySymbols(t);i<n.length;i++)e.indexOf(n[i])<0&&Object.prototype.propertyIsEnumerable.call(t,n[i])&&(r[n[i]]=t[n[i]]);return r},u2e="https://diddht.tbddev.org",Dit=0,D0=7200,VB=";",Qa=",",oV;(function(t){t[t.Discoverable=0]="Discoverable",t[t.Organization=1]="Organization",t[t.Government=2]="Government",t[t.Corporation=3]="Corporation",t[t.LocalBusiness=4]="LocalBusiness",t[t.SoftwarePackage=5]="SoftwarePackage",t[t.WebApp=6]="WebApp",t[t.FinancialInstitution=7]="FinancialInstitution"})(oV||(oV={}));var ec;(function(t){t[t.Ed25519=0]="Ed25519",t[t.secp256k1=1]="secp256k1",t[t.secp256r1=2]="secp256r1",t[t.X25519=3]="X25519"})(ec||(ec={}));var sV;(function(t){t.authentication="auth",t.assertionMethod="asm",t.capabilityDelegation="del",t.capabilityInvocation="inv",t.keyAgreement="agm"})(sV||(sV={}));var f2e={Ed25519:ec.Ed25519,ES256K:ec.secp256k1,ES256:ec.secp256r1,"P-256":ec.secp256r1,secp256k1:ec.secp256k1,secp256r1:ec.secp256r1,X25519:ec.X25519},l2e={[ec.Ed25519]:"Ed25519",[ec.secp256k1]:"ES256K",[ec.secp256r1]:"ES256",[ec.X25519]:"ECDH-ES+A256KW"},Yb=class t extends xu{static create(){return ts(this,arguments,void 0,function*({keyManager:e=new ba,options:r={}}={}){var n,i,o,s,a,d,u,c,l,h,y;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(j=>!(j.algorithm in f2e)))throw new Error("One or more verification method algorithms are not supported");let g=(i=r.verificationMethods)===null||i===void 0?void 0:i.filter(j=>"id"in j).map(j=>j.id);if(g&&g.length!==new Set(g).size)throw new Error("One or more verification method IDs are not unique");if(!((o=r.services)===null||o===void 0)&&o.some(j=>!j.id||!j.type||!j.serviceEndpoint))throw new Error("One or more services are missing required properties");let v=yield e.generateKey({algorithm:"Ed25519"}),x=yield e.getPublicKey({keyUri:v}),S=yield es.identityKeyToIdentifier({identityKey:x}),A=Object.assign(Object.assign({id:S},r.alsoKnownAs&&{alsoKnownAs:r.alsoKnownAs}),r.controllers&&{controller:r.controllers}),T=[...(s=r.verificationMethods)!==null&&s!==void 0?s:[]];T?.some(j=>{var K;return((K=j.id)===null||K===void 0?void 0:K.split("#").pop())==="0"})||T.unshift({algorithm:"Ed25519",id:"0",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]});for(let j of T){let K=j.id&&j.id.split("#").pop()==="0"?v:yield e.generateKey({algorithm:j.algorithm}),F=yield e.getPublicKey({keyUri:K}),L=(d=(a=j.id)!==null&&a!==void 0?a:F.kid)!==null&&d!==void 0?d:yield _r({jwk:F});L=`${S}#${_d(L)}`,(u=A.verificationMethod)!==null&&u!==void 0||(A.verificationMethod=[]),A.verificationMethod.push({id:L,type:"JsonWebKey",controller:(c=j.controller)!==null&&c!==void 0?c:S,publicKeyJwk:F});for(let V of(l=j.purposes)!==null&&l!==void 0?l:[])A[V]||(A[V]=[]),A[V].push(L)}(h=r.services)===null||h===void 0||h.forEach(j=>{var K;(K=A.service)!==null&&K!==void 0||(A.service=[]),j.id=`${S}#${j.id.split("#").pop()}`,A.service.push(j)});let $=new Pc({uri:S,document:A,metadata:Object.assign({published:!1},r.types&&{types:r.types}),keyManager:e});if(!((y=r.publish)!==null&&y!==void 0)||y){let j=yield t.publish({did:$,gatewayUri:r.gatewayUri});$.metadata=j.didDocumentMetadata}return $})}static import(e){return ts(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ba}){var i;let o=$r.parse(r.uri);if(o?.method!==t.methodName)throw new lt(ht.MethodNotSupported,"Method not supported");let s=yield Pc.import({portableDid:r,keyManager:n});if(!(!((i=s.document.verificationMethod)===null||i===void 0)&&i.some(a=>{var d;return((d=a.id)===null||d===void 0?void 0:d.split("#").pop())==="0"})))throw new lt(ht.InvalidDidDocument,"DID document must contain an Identity Key");return s})}static getSigningMethod(e){return ts(this,arguments,void 0,function*({didDocument:r,methodId:n="#0"}){var i;let o=$r.parse(r.id);if(o&&o.method!==this.methodName)throw new lt(ht.MethodNotSupported,`Method not supported: ${o.method}`);let s=(i=r.verificationMethod)===null||i===void 0?void 0:i.find(a=>{var d,u;return _d(a.id)===((d=_d(n))!==null&&d!==void 0?d:_d((u=r.assertionMethod)===null||u===void 0?void 0:u[0]))});if(!(s&&s.publicKeyJwk))throw new lt(ht.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static publish(e){return ts(this,arguments,void 0,function*({did:r,gatewayUri:n=u2e}){return yield HB.put({did:r,gatewayUri:n})})}static resolve(e){return ts(this,arguments,void 0,function*(r,n={}){var i;let o=(i=n?.gatewayUri)!==null&&i!==void 0?i:u2e;try{yield es.identifierToIdentityKey({didUri:r});let{didDocument:s,didDocumentMetadata:a}=yield HB.get({didUri:r,gatewayUri:o});return Object.assign(Object.assign({},zi),{didDocument:s,didDocumentMetadata:a})}catch(s){if(!(s instanceof lt))throw new Error(s);return Object.assign(Object.assign({},zi),{didResolutionMetadata:Object.assign({error:s.code},s.message&&{errorMessage:s.message})})}})}};Yb.methodName="dht";var HB=class t{static get(e){return ts(this,arguments,void 0,function*({didUri:r,gatewayUri:n}){let i=es.identifierToIdentityKeyBytes({didUri:r}),o=yield t.pkarrGet({gatewayUri:n,publicKeyBytes:i}),s=yield es.parseBep44GetMessage({bep44Message:o}),a=yield t.fromDnsPacket({didUri:r,dnsPacket:s});return a.didDocumentMetadata.versionId=o.seq.toString(),a})}static put(e){return ts(this,arguments,void 0,function*({did:r,gatewayUri:n}){let i=yield t.toDnsPacket({didDocument:r.document,didMetadata:r.metadata,authoritativeGatewayUris:[n]}),o=yield es.createBep44PutMessage({dnsPacket:i,publicKeyBytes:es.identifierToIdentityKeyBytes({didUri:r.uri}),signer:yield r.getSigner({methodId:"0"})}),s=yield t.pkarrPut({gatewayUri:n,bep44Message:o});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:s,versionId:o.seq.toString()}),didRegistrationMetadata:{}}})}static pkarrGet(e){return ts(this,arguments,void 0,function*({gatewayUri:r,publicKeyBytes:n}){let i=le.uint8Array(n).toBase32Z(),o=new URL(i,r).href,s;try{if(s=yield fetch(o,{method:"GET"}),!s.ok)throw new lt(ht.NotFound,`Pkarr record not found for: ${i}`)}catch(u){throw u instanceof lt?u:new lt(ht.InternalError,`Failed to fetch Pkarr record: ${u.message}`)}let a=yield s.arrayBuffer();if(!a)throw new lt(ht.NotFound,`Pkarr record not found for: ${i}`);if(a.byteLength<72)throw new lt(ht.InvalidDidDocumentLength,`Pkarr response must be at least 72 bytes but got: ${a.byteLength}`);if(a.byteLength>1072)throw new lt(ht.InvalidDidDocumentLength,`Pkarr response exceeds 1000 byte limit: ${a.byteLength}`);return{k:n,seq:Number(new DataView(a).getBigUint64(64)),sig:new Uint8Array(a,0,64),v:new Uint8Array(a,72)}})}static pkarrPut(e){return ts(this,arguments,void 0,function*({gatewayUri:r,bep44Message:n}){let i=le.uint8Array(n.k).toBase32Z(),o=new URL(i,r).href,s=new Uint8Array(n.v.length+72);s.set(n.sig,0),new DataView(s.buffer).setBigUint64(n.sig.length,BigInt(n.seq)),s.set(n.v,n.sig.length+8);let a;try{a=yield fetch(o,{method:"PUT",headers:{"Content-Type":"application/octet-stream"},body:s})}catch(d){throw new lt(ht.InternalError,`Failed to put Pkarr record for identifier ${i}: ${d.message}`)}return a.ok})}static fromDnsPacket(e){return ts(this,arguments,void 0,function*({didUri:r,dnsPacket:n}){var i,o,s;let a={id:r},d={published:!0},u=new Map;for(let c of(i=n?.answers)!==null&&i!==void 0?i:[]){if(c.type!=="TXT")continue;let l=c.name.split(".")[0].substring(1);switch(!0){case l.startsWith("aka"):{let h=es.parseTxtDataToString(c.data);a.alsoKnownAs=h.split(Qa);break}case l.startsWith("cnt"):{let h=es.parseTxtDataToString(c.data);a.controller=h.includes(Qa)?h.split(Qa):h;break}case l.startsWith("k"):{let{id:h,t:y,k:g,c:v,a:x}=es.parseTxtDataToObject(c.data),S=le.base64Url(g).toUint8Array(),A=ec[Number(y)],T=yield es.keyConverter(A).bytesToPublicKey({publicKeyBytes:S});T.alg=x||l2e[Number(y)];let $=l==="k0"?"0":h!==void 0?h:yield _r({jwk:T});(o=a.verificationMethod)!==null&&o!==void 0||(a.verificationMethod=[]);let j=`${r}#${$}`;a.verificationMethod.push({id:j,type:"JsonWebKey",controller:v??r,publicKeyJwk:T}),u.set(l,j);break}case l.startsWith("s"):{let h=es.parseTxtDataToObject(c.data),{id:y,t:g,se:v}=h,x=d2e(h,["id","t","se"]),S=v.includes(Qa)?v.split(Qa):[v],A=Object.fromEntries(Object.entries(x).map(([T,$])=>[T,$.includes(Qa)?$.split(Qa):$]));(s=a.service)!==null&&s!==void 0||(a.service=[]),a.service.push(Object.assign(Object.assign({},A),{id:`${r}#${y}`,type:g,serviceEndpoint:S}));break}case l.startsWith("typ"):{let{id:h}=es.parseTxtDataToObject(c.data);d.types=h.split(Qa).map(y=>Number(y));break}case l.startsWith("did"):{let h=A=>A.split(Qa).map(T=>u.get(T)).filter(T=>typeof T=="string"),{auth:y,asm:g,del:v,inv:x,agm:S}=es.parseTxtDataToObject(c.data);y&&(a.authentication=h(y)),g&&(a.assertionMethod=h(g)),v&&(a.capabilityDelegation=h(v)),x&&(a.capabilityInvocation=h(x)),S&&(a.keyAgreement=h(S));break}}}return{didDocument:a,didDocumentMetadata:d,didResolutionMetadata:{}}})}static toDnsPacket(e){return ts(this,arguments,void 0,function*({didDocument:r,didMetadata:n,authoritativeGatewayUris:i,previousDidProof:o}){var s,a,d,u,c;let l=[],h=[],y=new Map,g=[],v=[];if(o!==void 0){let{signature:A,previousDid:T}=o;yield es.validatePreviousDidProof({newDid:r.id,previousDidProof:o}),l.push({type:"TXT",name:"_prv._did.",ttl:D0,data:`id=${T};s=${A}`})}if(r.alsoKnownAs&&l.push({type:"TXT",name:"_aka._did.",ttl:D0,data:r.alsoKnownAs.join(Qa)}),r.controller){let A=Array.isArray(r.controller)?r.controller.join(Qa):r.controller;l.push({type:"TXT",name:"_cnt._did.",ttl:D0,data:A})}for(let[A,T]of(a=(s=r.verificationMethod)===null||s===void 0?void 0:s.entries())!==null&&a!==void 0?a:[]){let $=`k${A}`;v.push($);let j=T.id.split("#").pop();y.set(j,$);let K=T.publicKeyJwk;if(!(K?.crv&&K.crv in f2e))throw new lt(ht.InvalidPublicKeyType,`Verification method '${T.id}' contains an unsupported key type: ${(d=K?.crv)!==null&&d!==void 0?d:"undefined"}`);let F=ec[K.crv],L=yield es.keyConverter(K.crv).publicKeyToBytes({publicKey:K}),V=le.uint8Array(L).toBase64Url(),q=[`t=${F}`,`k=${V}`];j!=="0"&&(yield _r({jwk:K}))!==j&&q.unshift(`id=${j}`),K.alg!==l2e[F]&&q.push(`a=${K.alg}`),T.controller!==r.id&&q.push(`c=${T.controller}`),l.push({type:"TXT",name:`_${$}._did.`,ttl:D0,data:q.join(VB)})}(u=r.service)===null||u===void 0||u.forEach((A,T)=>{let $=`s${T}`;g.push($);let{id:j,type:K,serviceEndpoint:F}=A,L=d2e(A,["id","type","serviceEndpoint"]);j=_d(j),F=Array.isArray(F)?F.join(","):F;let q=Object.entries(Object.assign({id:j,t:K,se:F},L)).map(([P,B])=>`${P}=${B}`).join(VB),k=es.chunkDataIfNeeded(q);l.push({type:"TXT",name:`_${$}._did.`,ttl:D0,data:k})});let x=[`v=${Dit}`];if(v.length&&x.push(`vm=${v.join(Qa)}`),Object.keys(Gb).forEach(A=>{var T;let $=(T=r[A])===null||T===void 0?void 0:T.map(j=>y.get(j.split("#").pop()));if($){let j=sV[A];x.push(`${j}=${$.join(Qa)}`)}}),g.length&&x.push(`svc=${g.join(Qa)}`),!((c=n.types)===null||c===void 0)&&c.length){let T=n.types.map($=>typeof $=="string"?oV[$]:$);l.push({type:"TXT",name:"_typ._did.",ttl:D0,data:`id=${T.join(Qa)}`})}l.push({type:"TXT",name:"_did."+t.getUniqueDidSuffix(r.id)+".",ttl:D0,data:x.join(VB)});for(let A of i||[])h.push({type:"NS",name:"_did."+t.getUniqueDidSuffix(r.id)+".",ttl:D0,data:A+"."});return{id:0,type:"response",flags:E_,answers:[...l,...h]}})}static getUniqueDidSuffix(e){return e.split(":")[2]}},es=class t{static createBep44PutMessage(e){return ts(this,arguments,void 0,function*({dnsPacket:r,publicKeyBytes:n,signer:i}){let o=Math.ceil(Date.now()/1e3),s=Np(r),a=Dp.encode({seq:o,v:s}).subarray(1,-1);if(a.length>1e3)throw new lt(ht.InvalidDidDocumentLength,`DNS packet exceeds the 1000 byte maximum size: ${a.length} bytes`);let d=yield i.sign({data:a});return{k:n,seq:o,sig:d,v:s}})}static identifierToIdentityKey(e){return ts(this,arguments,void 0,function*({didUri:r}){let n=t.identifierToIdentityKeyBytes({didUri:r});return yield xo.bytesToPublicKey({publicKeyBytes:n})})}static identifierToIdentityKeyBytes({didUri:e}){let r=$r.parse(e);if(!r)throw new lt(ht.InvalidDid,`Invalid DID URI: ${e}`);if(r.method!==Yb.methodName)throw new lt(ht.MethodNotSupported,`Method not supported: ${r.method}`);let n;try{n=le.base32Z(r.id).toUint8Array()}catch{throw new lt(ht.InvalidPublicKey,"Failed to decode method-specific identifier")}if(n.length!==32)throw new lt(ht.InvalidPublicKeyLength,`Invalid public key length: ${n.length}`);return n}static identityKeyToIdentifier(e){return ts(this,arguments,void 0,function*({identityKey:r}){let n=yield xo.publicKeyToBytes({publicKey:r}),i=le.uint8Array(n).toBase32Z();return`did:${Yb.methodName}:${i}`})}static keyConverter(e){let n={Ed25519:xo,"P-256":{publicKeyToBytes:i=>ts(this,[i],void 0,function*({publicKey:o}){let s=yield qs.publicKeyToBytes({publicKey:o});return yield qs.compressPublicKey({publicKeyBytes:s})}),bytesToPublicKey:qs.bytesToPublicKey,privateKeyToBytes:qs.privateKeyToBytes,bytesToPrivateKey:qs.bytesToPrivateKey},secp256k1:{publicKeyToBytes:i=>ts(this,[i],void 0,function*({publicKey:o}){let s=yield Qo.publicKeyToBytes({publicKey:o});return yield Qo.compressPublicKey({publicKeyBytes:s})}),bytesToPublicKey:Qo.bytesToPublicKey,privateKeyToBytes:Qo.privateKeyToBytes,bytesToPrivateKey:Qo.bytesToPrivateKey},X25519:ox}[e];if(!n)throw new lt(ht.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static parseBep44GetMessage(e){return ts(this,arguments,void 0,function*({bep44Message:r}){let n=yield xo.bytesToPublicKey({publicKeyBytes:r.k}),i=Dp.encode({seq:r.seq,v:r.v}).subarray(1,-1);if(!(yield xo.verify({key:n,signature:r.sig,data:i})))throw new lt(ht.InvalidSignature,"Invalid signature for DHT BEP44 message");return d0(r.v)})}static parseTxtDataToObject(e){return this.parseTxtDataToString(e).split(VB).reduce((r,n)=>{let[i,o]=n.split("=");return r[i]=o,r},{})}static parseTxtDataToString(e){if(typeof e=="string")return e;if(e instanceof Uint8Array)return le.uint8Array(e).toString();if(Array.isArray(e))return e.map(r=>this.parseTxtDataToString(r)).join("");throw new lt(ht.InternalError,"Pkarr returned DNS TXT record with invalid data type")}static validatePreviousDidProof(e){return ts(this,arguments,void 0,function*({newDid:r,previousDidProof:n}){let i=yield t.identifierToIdentityKey({didUri:n.previousDid}),o=t.identifierToIdentityKeyBytes({didUri:r}),s=le.base64Url(n.signature).toUint8Array();if(!(yield xo.verify({key:i,data:o,signature:s})))throw new lt(ht.InvalidPreviousDidProof,"The previous DID proof is invalid.")})}static chunkDataIfNeeded(e){if(e.length<=255)return e;let r=[];for(let n=0;n<e.length;n+=255)r.push(e.slice(n,n+255));return r}};f();var C0=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},nh;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(nh||(nh={}));var Cit={Ed25519:nh.Ed25519,ES256K:nh.secp256k1,ES256:nh.secp256r1,"P-256":nh.secp256r1,secp256k1:nh.secp256k1,secp256r1:nh.secp256r1},h2e="https://ion.tbd.engineering",aV=class t extends xu{static create(){return C0(this,arguments,void 0,function*({keyManager:e=new ba,options:r={}}={}){var n,i,o,s,a,d,u;if(!((n=r.verificationMethods)===null||n===void 0)&&n.some(j=>!(j.algorithm in Cit)))throw new Error("One or more verification method algorithms are not supported");let c=(i=r.verificationMethods)===null||i===void 0?void 0:i.filter(j=>"id"in j).map(j=>j.id);if(c&&c.length!==new Set(c).size)throw new Error("One or more verification method IDs are not unique");if(!((o=r.services)===null||o===void 0)&&o.some(j=>!j.id||!j.type||!j.serviceEndpoint))throw new Error("One or more services are missing required properties");let l={algorithm:"Ed25519",purposes:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]},h=[];for(let j of(s=r.verificationMethods)!==null&&s!==void 0?s:[l]){let K=yield e.generateKey({algorithm:j.algorithm}),F=yield e.getPublicKey({keyUri:K});h.push({id:j.id,publicKeyJwk:F,purposes:(a=j.purposes)!==null&&a!==void 0?a:["authentication","assertionMethod","capabilityDelegation","capabilityInvocation"]})}let y=yield e.generateKey({algorithm:nh.secp256k1}),g=yield e.getPublicKey({keyUri:y}),v=yield e.generateKey({algorithm:nh.secp256k1}),x=yield e.getPublicKey({keyUri:v}),S=yield Zb.computeLongFormDidUri({recoveryKey:g,updateKey:x,services:(d=r.services)!==null&&d!==void 0?d:[],verificationMethods:h}),{didDocument:A,didResolutionMetadata:T}=yield t.resolve(S,{gatewayUri:r.gatewayUri});if(A===null)throw new Error(`Unable to resolve DID during creation: ${T?.error}`);let $=new Pc({uri:S,document:A,metadata:{published:!1,canonicalId:S.split(":",3).join(":"),recoveryKey:g,updateKey:x},keyManager:e});if(!((u=r.publish)!==null&&u!==void 0)||u){let j=yield t.publish({did:$,gatewayUri:r.gatewayUri});$.metadata=j.didDocumentMetadata}return $})}static getSigningMethod(e){return C0(this,arguments,void 0,function*({didDocument:r,methodId:n}){var i;let o=$r.parse(r.id);if(o&&o.method!==this.methodName)throw new lt(ht.MethodNotSupported,`Method not supported: ${o.method}`);let s=(i=r.verificationMethod)===null||i===void 0?void 0:i.find(a=>{var d;return a.id===(n??((d=r.assertionMethod)===null||d===void 0?void 0:d[0]))});if(!(s&&s.publicKeyJwk))throw new lt(ht.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static import(e){return C0(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ba}){let i=$r.parse(r.uri);if(i?.method!==t.methodName)throw new lt(ht.MethodNotSupported,"Method not supported");return yield Pc.import({portableDid:r,keyManager:n})})}static publish(e){return C0(this,arguments,void 0,function*({did:r,gatewayUri:n=h2e}){var i,o,s;let a=(o=(i=r.document.verificationMethod)===null||i===void 0?void 0:i.map(c=>({id:c.id,publicKeyJwk:c.publicKeyJwk,purposes:a2e({didDocument:r.document,methodId:c.id})})))!==null&&o!==void 0?o:[],d=yield Zb.createIonDocument({services:(s=r.document.service)!==null&&s!==void 0?s:[],verificationMethods:a}),u=yield Zb.constructCreateRequest({ionDocument:d,recoveryKey:r.metadata.recoveryKey,updateKey:r.metadata.updateKey});try{let c=Zb.appendPathToUrl({baseUrl:n,path:"/operations"}),l=yield fetch(c,{method:"POST",mode:"cors",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)});return{didDocument:r.document,didDocumentMetadata:Object.assign(Object.assign({},r.metadata),{published:l.ok}),didRegistrationMetadata:{}}}catch{return{didDocument:null,didDocumentMetadata:{published:!1},didRegistrationMetadata:{error:ht.InternalError,errorMessage:`Failed to publish DID document for: ${r.uri}`}}}})}static resolve(e){return C0(this,arguments,void 0,function*(r,n={}){var i,o;let s=$r.parse(r);if(!s)return Object.assign(Object.assign({},zi),{didResolutionMetadata:{error:"invalidDid"}});if(s.method!==t.methodName)return Object.assign(Object.assign({},zi),{didResolutionMetadata:{error:"methodNotSupported"}});let a=(i=n?.gatewayUri)!==null&&i!==void 0?i:h2e;try{let d=Zb.appendPathToUrl({baseUrl:a,path:`/identifiers/${r}`}),u=yield fetch(d);if(!u.ok)throw new lt(ht.NotFound,`Unable to find DID document for: ${r}`);let{didDocument:c,didDocumentMetadata:l}=yield u.json();return Object.assign(Object.assign(Object.assign({},zi),c&&{didDocument:c}),{didDocumentMetadata:Object.assign({published:(o=l?.method)===null||o===void 0?void 0:o.published},l)})}catch(d){if(!(d instanceof lt))throw new Error(d);return Object.assign(Object.assign({},zi),{didResolutionMetadata:Object.assign({error:d.code},d.message&&{errorMessage:d.message})})}})}};aV.methodName="ion";var Zb=class t{static appendPathToUrl({baseUrl:e,path:r}){let n=new URL(e);return n.pathname=n.pathname.endsWith("/")?n.pathname:n.pathname+"/",n.pathname+=r.startsWith("/")?r.substring(1):r,n.toString()}static computeLongFormDidUri(e){return C0(this,arguments,void 0,function*({recoveryKey:r,updateKey:n,services:i,verificationMethods:o}){let s=yield t.createIonDocument({services:i,verificationMethods:o}),a=t.normalizeJwk(r),d=t.normalizeJwk(n);return yield Jf.createLongFormDid({document:s,recoveryKey:a,updateKey:d})})}static constructCreateRequest(e){return C0(this,arguments,void 0,function*({ionDocument:r,recoveryKey:n,updateKey:i}){return yield hu.createCreateRequest({document:r,recoveryKey:t.normalizeJwk(n),updateKey:t.normalizeJwk(i)})})}static createIonDocument(e){return C0(this,arguments,void 0,function*({services:r,verificationMethods:n}){var i,o;let s=[];for(let u of n){let c=(o=(i=u.id)!==null&&i!==void 0?i:u.publicKeyJwk.kid)!==null&&o!==void 0?o:yield _r({jwk:u.publicKeyJwk});c=`${c.split("#").pop()}`;let l={id:c,publicKeyJwk:t.normalizeJwk(u.publicKeyJwk),purposes:u.purposes,type:"JsonWebKey2020"};s.push(l)}let a=r.map(u=>Object.assign(Object.assign({},u),{id:`${u.id.split("#").pop()}`}));return{publicKeys:s,services:a}})}static normalizeJwk(e){let r=e.kty,n;if(r==="EC")n={crv:e.crv,kty:e.kty,x:e.x,y:e.y};else if(r==="oct")n={k:e.k,kty:e.kty};else if(r==="OKP")n={crv:e.crv,kty:e.kty,x:e.x};else if(r==="RSA")n={e:e.e,kty:e.kty,n:e.n};else throw new Error(`Unsupported key type: ${r}`);return n}};f();var WB=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},r8=class t extends xu{static create(){return WB(this,arguments,void 0,function*({keyManager:e=new ba,options:r={}}={}){var n,i,o,s;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");let a=(s=(n=r.algorithm)!==null&&n!==void 0?n:(o=(i=r.verificationMethods)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.algorithm)!==null&&s!==void 0?s:"Ed25519",d=yield e.generateKey({algorithm:a}),u=yield e.getPublicKey({keyUri:d}),c=le.object(u).toBase64Url(),l=`did:${t.methodName}:${c}`,y=(yield t.resolve(l)).didDocument;return new Pc({uri:l,document:y,metadata:{},keyManager:e})})}static getSigningMethod(e){return WB(this,arguments,void 0,function*({didDocument:r}){var n;let i=$r.parse(r.id);if(i&&i.method!==this.methodName)throw new lt(ht.MethodNotSupported,`Method not supported: ${i.method}`);let[o]=(n=r.verificationMethod)!==null&&n!==void 0?n:[];if(!(o&&o.publicKeyJwk))throw new lt(ht.InternalError,"A verification method intended for signing could not be determined from the DID Document");return o})}static import(e){return WB(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ba}){let i=$r.parse(r.uri);if(i?.method!==t.methodName)throw new lt(ht.MethodNotSupported,"Method not supported");let o=yield Pc.import({portableDid:r,keyManager:n});if(o.document.verificationMethod.length!==1)throw new lt(ht.InvalidDidDocument,"DID document must contain exactly one verification method");return o})}static resolve(e,r){return WB(this,void 0,void 0,function*(){let n=$r.parse(e),i;try{i=le.base64Url(n.id).toObject()}catch{}if(!n||!i)return Object.assign(Object.assign({},zi),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==t.methodName)return Object.assign(Object.assign({},zi),{didResolutionMetadata:{error:"methodNotSupported"}});let o={"@context":["https://www.w3.org/ns/did/v1"],id:n.uri},s=`${o.id}#0`;switch(o.verificationMethod=[{id:s,type:"JsonWebKey",controller:o.id,publicKeyJwk:i}],o.authentication=[s],o.assertionMethod=[s],o.capabilityInvocation=[s],o.capabilityDelegation=[s],o.keyAgreement=[s],i.use){case"sig":{delete o.keyAgreement;break}case"enc":{delete o.authentication,delete o.assertionMethod,delete o.capabilityInvocation,delete o.capabilityDelegation;break}}return Object.assign(Object.assign({},zi),{didDocument:o})})}};r8.methodName="jwk";f();var kl=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},iy;(function(t){t.Ed25519="Ed25519",t.secp256k1="secp256k1",t.secp256r1="secp256r1",t.X25519="X25519"})(iy||(iy={}));var cV={Ed25519VerificationKey2020:"https://w3id.org/security/suites/ed25519-2020/v1",JsonWebKey2020:"https://w3id.org/security/suites/jws-2020/v1",X25519KeyAgreementKey2020:"https://w3id.org/security/suites/x25519-2020/v1"},jit={Ed25519:iy.Ed25519,ES256K:iy.secp256k1,ES256:iy.secp256r1,"P-256":iy.secp256r1,secp256k1:iy.secp256k1,secp256r1:iy.secp256r1,X25519:iy.X25519},dV=class t extends xu{static create(){return kl(this,arguments,void 0,function*({keyManager:e=new ba,options:r={}}={}){var n,i,o,s;if(r.algorithm&&r.verificationMethods)throw new Error("The 'algorithm' and 'verificationMethods' options are mutually exclusive");if(r.verificationMethods&&r.verificationMethods.length!==1)throw new Error("The 'verificationMethods' option must contain exactly one entry");let a=(s=(n=r.algorithm)!==null&&n!==void 0?n:(o=(i=r.verificationMethods)===null||i===void 0?void 0:i[0])===null||o===void 0?void 0:o.algorithm)!==null&&s!==void 0?s:"Ed25519",d=yield e.generateKey({algorithm:a}),u=yield e.getPublicKey({keyUri:d}),c=yield Ic.publicKeyToMultibaseId({publicKey:u}),l=`did:${t.methodName}:${c}`,y=(yield t.resolve(l,r)).didDocument;return new Pc({uri:l,document:y,metadata:{},keyManager:e})})}static getSigningMethod(e){return kl(this,arguments,void 0,function*({didDocument:r}){var n;let i=$r.parse(r.id);if(i&&i.method!==this.methodName)throw new lt(ht.MethodNotSupported,`Method not supported: ${i.method}`);let[o]=r.assertionMethod||[],s=(n=r.verificationMethod)===null||n===void 0?void 0:n.find(a=>a.id===o);if(!(s&&s.publicKeyJwk))throw new lt(ht.InternalError,"A verification method intended for signing could not be determined from the DID Document");return s})}static import(e){return kl(this,arguments,void 0,function*({portableDid:r,keyManager:n=new ba}){let i=$r.parse(r.uri);if(i?.method!==t.methodName)throw new lt(ht.MethodNotSupported,"Method not supported");let o=yield Pc.import({portableDid:r,keyManager:n});if(o.document.verificationMethod.length!==1)throw new lt(ht.InvalidDidDocument,"DID document must contain exactly one verification method");return o})}static resolve(e,r){return kl(this,void 0,void 0,function*(){try{let n=yield t.createDocument({didUri:e,options:r});return Object.assign(Object.assign({},zi),{didDocument:n})}catch(n){if(!(n instanceof lt))throw new Error(n);return Object.assign(Object.assign({},zi),{didResolutionMetadata:Object.assign({error:n.code},n.message&&{errorMessage:n.message})})}})}static createDocument(e){return kl(this,arguments,void 0,function*({didUri:r,options:n={}}){let{defaultContext:i="https://www.w3.org/ns/did/v1",enableEncryptionKeyDerivation:o=!1,enableExperimentalPublicKeyTypes:s=!1,publicKeyFormat:a="JsonWebKey2020"}=n,d={id:""},u=$r.parse(r);if(!u)throw new lt(ht.InvalidDid,`Invalid DID URI: ${r}`);let c=u.id;if(u.method!==t.methodName)throw new lt(ht.MethodNotSupported,`Method not supported: ${u.method}`);if(!t.validateIdentifier(u))throw new lt(ht.InvalidDid,`Invalid DID URI: ${r}`);let l=yield t.createSignatureMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:s,publicKeyFormat:a}});if(d.id=u.uri,d.verificationMethod=[l],d.authentication=[l.id],d.assertionMethod=[l.id],d.capabilityInvocation=[l.id],d.capabilityDelegation=[l.id],o===!0){let g=a==="Ed25519VerificationKey2020"?"X25519KeyAgreementKey2020":"JsonWebKey2020",v=yield this.createEncryptionMethod({didUri:r,multibaseValue:c,options:{enableExperimentalPublicKeyTypes:s,publicKeyFormat:g}});d.verificationMethod.push(v),d.keyAgreement=[v.id]}let h=[i];return s2e({didDocument:d}).forEach(g=>{let v=cV[g];h.push(v)}),d["@context"]=h,d})}static createEncryptionMethod(e){return kl(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:i}){let{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}=i,a={id:"",type:"",controller:""},{keyBytes:d,multicodecCode:u}=yield t.deriveEncryptionKey({multibaseValue:n}),c=d.byteLength,l=Ic.MULTICODEC_PUBLIC_KEY_LENGTH[u];if(c!==l)throw new lt(ht.InvalidPublicKeyLength,`Expected ${c} bytes. Actual: ${l}`);let h=nV({keyBytes:d,multicodecCode:u});a.id=`${r}#${h}`;try{new URL(a.id)}catch{throw new lt(ht.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(s in cV))throw new lt(ht.UnsupportedPublicKeyType,`Unsupported format: ${s}`);if(o===!1&&!["Multikey","JsonWebKey2020","X25519KeyAgreementKey2020"].includes(s))throw new lt(ht.InvalidPublicKeyType,`Specified '${s}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=s,a.controller=r,s==="X25519KeyAgreementKey2020"&&(a.publicKeyMultibase=h),s==="JsonWebKey2020"){let{crv:g}=yield Ic.multicodecToJwk({code:u});a.publicKeyJwk=yield Ic.keyConverter(g).bytesToPublicKey({publicKeyBytes:d})}return a})}static createSignatureMethod(e){return kl(this,arguments,void 0,function*({didUri:r,multibaseValue:n,options:i}){let{enableExperimentalPublicKeyTypes:o,publicKeyFormat:s}=i,a={id:"",type:"",controller:""},{keyBytes:d,multicodecCode:u,multicodecName:c}=iV({multibaseKeyId:n}),l=d.byteLength,h=Ic.MULTICODEC_PUBLIC_KEY_LENGTH[u];if(l!==h)throw new lt(ht.InvalidPublicKeyLength,`Expected ${l} bytes. Actual: ${h}`);let y=!1;switch(c){case"secp256k1-pub":y=yield Qo.validatePublicKey({publicKeyBytes:d});break;case"ed25519-pub":y=yield xo.validatePublicKey({publicKeyBytes:d});break;case"x25519-pub":y=!0;break}if(!y)throw new lt(ht.InvalidPublicKey,"Invalid public key detected.");a.id=`${r}#${n}`;try{new URL(a.id)}catch{throw new lt(ht.InvalidDidUrl,"Verification Method ID is not a valid DID URL.")}if(!(s in cV))throw new lt(ht.UnsupportedPublicKeyType,`Unsupported format: ${s}`);if(o===!1&&!["Multikey","JsonWebKey2020","Ed25519VerificationKey2020"].includes(s))throw new lt(ht.InvalidPublicKeyType,`Specified '${s}' without setting enableExperimentalPublicKeyTypes to true.`);if(a.type=s,a.controller=r,s==="Ed25519VerificationKey2020"&&(a.publicKeyMultibase=n),s==="JsonWebKey2020"){let{crv:v}=yield Ic.multicodecToJwk({code:u});a.publicKeyJwk=yield Ic.keyConverter(v).bytesToPublicKey({publicKeyBytes:d})}return a})}static deriveEncryptionKey(e){return kl(this,arguments,void 0,function*({multibaseValue:r}){let n={keyBytes:new Uint8Array,multicodecCode:0},{keyBytes:i,multicodecCode:o}=iV({multibaseKeyId:r});if(o===237){let s=yield Ic.keyConverter("Ed25519").bytesToPublicKey({publicKeyBytes:i}),a=yield xo.convertPublicKeyToX25519({publicKey:s});n={keyBytes:yield Ic.keyConverter("Ed25519").publicKeyToBytes({publicKey:a}),multicodecCode:236}}return n})}static validateIdentifier(e){let{method:r,id:n}=e,[i]=e.uri.split(":",1);return i==="did"&&r==="key"&&Number("1")>0&&Vf(n)==="String"&&n.startsWith("z")}};dV.methodName="key";var Ic=class t{static jwkToMulticodec(e){return kl(this,arguments,void 0,function*({jwk:r}){let n=[];r.crv&&(n.push(r.crv),r.d?n.push("private"):n.push("public"));let i=n.join(":"),o=t.JWK_TO_MULTICODEC[i];if(o===void 0)throw new Error(`Unsupported JWK to Multicodec conversion: '${i}'`);return{code:An.getCodeFromName({name:o}),name:o}})}static keyCompressor(e){let n={"P-256":qs.compressPublicKey,secp256k1:Qo.compressPublicKey}[e];if(!n)throw new lt(ht.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static keyConverter(e){let n={Ed25519:xo,"P-256":qs,secp256k1:Qo,X25519:ox}[e];if(!n)throw new lt(ht.InvalidPublicKeyType,`Unsupported curve: ${e}`);return n}static multicodecToJwk(e){return kl(this,arguments,void 0,function*({code:r,name:n}){if(!(n?!r:r))throw new Error("Either 'name' or 'code' must be defined, but not both.");n=n===void 0?An.getNameFromCode({code:r}):n;let i=n,o=t.MULTICODEC_TO_JWK[i];if(o===void 0)throw new Error("Unsupported Multicodec to JWK conversion");return Object.assign({},o)})}static publicKeyToMultibaseId(e){return kl(this,arguments,void 0,function*({publicKey:r}){var n;if(!(r?.crv&&r.crv in jit))throw new lt(ht.InvalidPublicKeyType,`Public key contains an unsupported key type: ${(n=r?.crv)!==null&&n!==void 0?n:"undefined"}`);let i=yield t.keyConverter(r.crv).publicKeyToBytes({publicKey:r});/^(secp256k1|P-256|P-384|P-521)$/.test(r.crv)&&(i=yield t.keyCompressor(r.crv)({publicKeyBytes:i}));let{name:o}=yield t.jwkToMulticodec({jwk:r});return nV({keyBytes:i,multicodecName:o})})}};Ic.JWK_TO_MULTICODEC={"Ed25519:public":"ed25519-pub","Ed25519:private":"ed25519-priv","secp256k1:public":"secp256k1-pub","secp256k1:private":"secp256k1-priv","X25519:public":"x25519-pub","X25519:private":"x25519-priv"};Ic.MULTICODEC_PUBLIC_KEY_LENGTH={231:33,236:32,237:32};Ic.MULTICODEC_TO_JWK={"ed25519-pub":{crv:"Ed25519",kty:"OKP",x:""},"ed25519-priv":{crv:"Ed25519",kty:"OKP",x:"",d:""},"secp256k1-pub":{crv:"secp256k1",kty:"EC",x:"",y:""},"secp256k1-priv":{crv:"secp256k1",kty:"EC",x:"",y:"",d:""},"x25519-pub":{crv:"X25519",kty:"OKP",x:""},"x25519-priv":{crv:"X25519",kty:"OKP",x:"",d:""}};f();var $it=function(t,e,r,n){function i(o){return o instanceof r?o:new r(function(s){s(o)})}return new(r||(r=Promise))(function(o,s){function a(c){try{u(n.next(c))}catch(l){s(l)}}function d(c){try{u(n.throw(c))}catch(l){s(l)}}function u(c){c.done?o(c.value):i(c.value).then(a,d)}u((n=n.apply(t,e||[])).next())})},uV=class t extends xu{static resolve(e,r){return $it(this,void 0,void 0,function*(){let n=$r.parse(e);if(!n)return Object.assign(Object.assign({},zi),{didResolutionMetadata:{error:"invalidDid"}});if(n.method!==t.methodName)return Object.assign(Object.assign({},zi),{didResolutionMetadata:{error:"methodNotSupported"}});let i=`https://${n.id.replace(/:/g,"/")}`;i=decodeURIComponent(i);let o=n.id.includes(":")?`${i}/did.json`:`${i}/.well-known/did.json`;try{let s=yield fetch(o);if(!s.ok)throw new Error("HTTP error status code returned");let a=yield s.json();return Object.assign(Object.assign({},zi),{didDocument:a})}catch{return Object.assign(Object.assign({},zi),{didResolutionMetadata:{error:"notFound"}})}})}};uV.methodName="web";f();var Nit=xt(f0(),1),Uit=xt(m5(),1);f();f();var lV=class t{constructor(e){this._agentDid=e.agentDid,this.crypto=e.cryptoApi,this.did=e.didApi,this.dwn=e.dwnApi,this.identity=e.identityApi,this.keyManager=e.keyManager,this.permissions=e.permissionsApi,this.rpc=e.rpcClient,this.sync=e.syncApi,this.vault=e.agentVault,this.did.agent=this,this.dwn.agent=this,this.identity.agent=this,this.keyManager.agent=this,this.permissions.agent=this,this.sync.agent=this}get agentDid(){if(this._agentDid===void 0)throw new Error('Web5UserAgent: The "agentDid" property is not set. Ensure the agent is properly initialized and a DID is assigned.');return this._agentDid}set agentDid(e){this._agentDid=e}static async create({dataPath:e="DATA/AGENT",agentDid:r,agentVault:n,cryptoApi:i,didApi:o,dwnApi:s,identityApi:a,keyManager:d,permissionsApi:u,rpcClient:c,syncApi:l}={}){return n??=new q3({keyDerivationWorkFactor:21e4,store:new N5({location:`${e}/VAULT_STORE`})}),i??=new vd,o??=new M3({didMethods:[Yb,r8],resolverCache:new Fb({location:`${e}/DID_RESOLVERCACHE`}),store:new B3}),s??=new J_({dwn:await J_.createDwn({dataPath:e,didResolver:o})}),a??=new z3({store:new L3}),d??=new bu({keyStore:new C3}),u??=new Gp,c??=new G3,l??=new J3({syncEngine:new Y3({dataPath:e})}),new t({agentDid:r,agentVault:n,cryptoApi:i,didApi:o,dwnApi:s,keyManager:d,permissionsApi:u,identityApi:a,rpcClient:c,syncApi:l})}async firstLaunch(){return await this.vault.isInitialized()===!1}async initialize({password:e,recoveryPhrase:r}){return r=await this.vault.initialize({password:e,recoveryPhrase:r}),r}async processDidRequest(e){return this.did.processRequest(e)}async processDwnRequest(e){return this.dwn.processRequest(e)}async processVcRequest(e){throw new Error("Not implemented")}async sendDidRequest(e){throw new Error("Not implemented")}async sendDwnRequest(e){return this.dwn.sendRequest(e)}async sendVcRequest(e){throw new Error("Not implemented")}async start({password:e}){this.vault.isLocked()&&await this.vault.unlock({password:e}),this.agentDid=await this.vault.getDid()}};return P2e(Kit);})();
/*! Bundled license information:

ieee754/index.js:
  (*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

buffer/index.js:
  (*!
   * The buffer module from node.js, for the browser.
   *
   * @author   Feross Aboukhadijeh <https://feross.org>
   * @license  MIT
   *)

safe-buffer/index.js:
  (*! safe-buffer. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

@noble/ciphers/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/hashes/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

uri-js/dist/es5/uri.all.js:
  (** @license URI.js v4.4.1 (c) 2011 Gary Court. License: http://github.com/garycourt/uri-js *)

queue-microtask/index.js:
  (*! queue-microtask. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

run-parallel-limit/index.js:
  (*! run-parallel-limit. MIT License. Feross Aboukhadijeh <https://feross.org/opensource> *)

@noble/ed25519/index.js:
  (*! noble-ed25519 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/secp256k1/index.js:
  (*! noble-secp256k1 - MIT License (c) 2019 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/p256.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/hashes/esm/utils.js:
  (*! noble-hashes - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/modular.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/curve.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/weierstrass.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/_shortw_utils.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/secp256k1.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/p256.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/edwards.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/abstract/montgomery.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@noble/curves/esm/ed25519.js:
  (*! noble-curves - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

uint8-util/util.js:
  (* Common package for dealing with hex/string/uint8 conversions (and sha1 hashing)
  *
  * @author   Jimmy Wärting <jimmy@warting.se> (https://jimmy.warting.se/opensource)
  * @license  MIT
  *)

ed25519-keygen/hdkey.js:
  (*! micro-ed25519-hdkey - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@scure/base/lib/esm/index.js:
  (*! scure-base - MIT License (c) 2022 Paul Miller (paulmillr.com) *)

@scure/bip39/esm/index.js:
  (*! scure-bip39 - MIT License (c) 2022 Patricio Palladino, Paul Miller (paulmillr.com) *)

@noble/ciphers/esm/utils.js:
  (*! noble-ciphers - MIT License (c) 2023 Paul Miller (paulmillr.com) *)
*/
//# sourceMappingURL=browser.js.map
